{"Annotations": {"text": "GMS Tutorials   Annotation Tools   \n Page 1 of 7 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nAnnotation Tools  \nUse scale bars, North arrows, floating images, text boxes, lines, and shapes . \nObjectives   \nGMS includes a number of annotation tools that can be used to visually enhance a project. These are \noften used to help prepare images and print copies for reports. This tutorial introduces the se tools and \nshows how they work.  \n \nPrerequisite Tutorials  \n\uf0b7 Getting Started  Required Components  \n\uf0b7 GMS Core  \n Time  \n\uf0b7 10\u201320 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   Annotation Tools   \n Page 2 of 7 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Working with Annotations  ................................ ................................ ................................ .. 2 \n2.1 Images  ................................ ................................ ................................ ..........................  3 \n2.2 North Arrow ................................ ................................ ................................ ...................  4 \n2.3 Scale Bar  ................................ ................................ ................................ ......................  4 \n2.4 Lines, Shapes, and Text  ................................ ................................ ...............................  5 \n3 Importing and Exporting Annotations  ................................ ................................ ...............  6 \n4 Conclusion  ................................ ................................ ................................ ...........................  7 \n \n1 Introduction  \nThe annotation tools in GMS facilitate the creation and display of annotation objects, \nwhich can be used to document, highlight, and assist with the presentation of data. \nAvailable annotation objects include screen space images, north arrows, scale bars, text, \nand shapes.  \nThis tutorial demonstrates how the various annotation objects can be used in a project:  \n\uf0b7 Use an annotation image to add a logo to the Graphics Window.  \n\uf0b7 Add a north arrow to the Graphics Window.  \n\uf0b7 Add a scale bar to the Graphics Window.  \n\uf0b7 Add text, lines, arrows, and shapes to the Graphics Window.  \n\uf0b7 Create a project file with annotations and then import th ose annotations into \nanother project.  \n1.1 Getting Started  \nTo get started, do the following:  \n1. If necessary, launch GMS.   \n2. If GMS is already running,  select File | New\u2026  to ensure that the program settings \nare restored to their default state.  \n3. If a dialog appears asking to save the current project and settings, click No to \nclose the dialog.  \n4. Select File | Open\u2026 to bring up the Open  dialog.  \n5. Select \u201cProject  Files (*.gpr)\u201d from the Files of type  drop-down.  \n6. Browse to the annotations  directory.  \n7. Select \u201cstart.gpr\u201d and click Open  to import the file and close the Open  dialog.  \nA map showing Olele Point will appear in the Graphics Window.  \n2 Working with Annotations  \nThere are a variety of annotation objects which can be added, including images, north \narrows, scale bars, text, and shapes. Annotation data is contained within a unique folder \nin the Project Explorer . Annotation data are further orga nized into layers. Every  \nannotation object belongs to a layer . There are two types of annotation layers: screen \nspace  and world space .  \nGMS Tutorials   Annotation Tools  \n \n Page 3 of 7 \u00a9 Aquaveo 2024  Objects created in a Screen Space   layer are anchored to certain locations in the \nmain Graphics Window . When zoom, pan, or rotate operations are performed, objects in \nscreen  space layers do not move.  \nIn World Space   layers, objects are anchored to world space locations. These objects \nare always drawn based at their world space  locations when panning or zooming the \ndisplay.   \n2.1 Images  \nAn annotation image is an image that is anchored in screen space. This is useful for \nadding various images to a project, such as a company logo. Multiple annotation images \ncan be added, and common image file formats (BMP, JPG, TIF, PNG) are supporte d.  \nAdd an annotation image for a company logo at the top right of the graphic by doing the \nfollowing:  \n1. Right -click in the Project Explorer and select New | Annotation Layer \u2013 Screen \nSpace . \nNotice that an \u201c  Annotation Data\u201d folder appears in the Project Ex plorer with \u201c  Layer \n#1\u201d listed underneath it. A screen space layer was created because annotation images \nare only anchored in screen space and thus not available in world space layers.  \n2. Using the Add Annotation Image   tool, drag a box anywhere in the main \nGraphics Window. An Open  dialog will appear.  \n3. Make sure Files of type  is set to \u201cImages\u201d or \u201cPNG File.\u201d  \n4. Select \u201cAquaveo.png\u201d and click Open  to close the Open  dialog.  \nThe imported image appears and is anchored to the screen coordinates where the box \nwas created. The image can be moved, stretched, and resized by selecting the image \nand editing the properties. Since the annotation is a company logo, it may look best \nancho red to the lower right corner of the screen.  \nTo move and adjust the image, do the following:  \n5. Using the Select Annotation Objects   tool, select the Aquaveo logo and drag \nit to the lower right corner of the Graphics Window . \n6. Resize the image by dragging a corner.  \n7. With the image selected, right -click on it and select Properties\u2026  to bring up the \nImage Properties  dialog.  \nBy default, the aspect ratio for an annotation image is fixed. The aspect ratio can be \nunlocked and modified by turning off the  Fixed aspect ratio  option. This allows the image \nto be stretched in a single direction. Transparency options can also be set for the image. \nThis is useful if the background color of the image doesn\u2019t match the background color of \nthe main Graphics Window.  \n8. In the Transparency options  section, turn on Use transparency  and Specify color . \n9. Click on the Specify color  drop-down menu (the down arrow next to the wide \ncolor button) beside the option to reveal the color palette of the logo image.  \nThe palette is dynamic and populated with colors from the selected annotation image. In \nthis case, a range of colors is shown: from white and light blue to black.  \n10. Select the first dark black color.  \n\nGMS Tutorials   Annotation Tools  \n \n Page 4 of 7 \u00a9 Aquaveo 2024  Notice that the black letters in the logo are now transpa rent and the Graphics Window \nbackground color shows through. Since the background color of our logo already \nmatches well with the Graphics Window background color, the transparency options are \nnot necessary in this case.  \n11. Click Cancel  to close the Image Properties  dialog  without making any changes.  \n2.2 North Arrow  \nNorth arrows are used to orient data displayed in the Graphics Window. As the display is \nrotated, the north arrow will always align with the Y -axis. To add a north arrow as seen in \nFigure  1, do the following:  \n1. Using the Create Annotation North Arrow   tool, drag a box in the upper left -\nhand corner. An Open  dialog will appear.  \n2. Select \u201cnorth -arrow.jpg\u201d and click Open  to import the image and close the Open  \ndialog.  \n3. Use the Rotate   tool to rotate the display. Notice that the north arrow is fixed \nto the Y -axis. \n4. Click the Plan View   macro to return the display to its original orient ation.  \nThe Graphics Window should appear as in Figure  1. \n \nFigure  1      Inserting a logo and a north arrow  \n2.3 Scale Bar  \nScale bars are used to provide context for world space in the Graphics Window. The \nunits will automatically correspond with the current project units (meters). To create a \nscale bar, follow these steps:  \n1. Using the Create Annotation Scale Bar   tool, drag a box near the lower left \ncorner of the screen to bring up the Scale Bar Properties  dialog.  \n\nGMS Tutorials   Annotation Tools  \n \n Page 5 of 7 \u00a9 Aquaveo 2024  Various settings can be adjusted that affect the appearance of the scale bar, font type, \ndivision widths, and background fills.  \n2. Click OK to accept the def ault settings and close the Scale Bar Properties  dialog.  \nA scale bar will appear in the space where the box was drawn. As with other annotation \nobjects, scale bars can be moved and resized as needed.  \n \n2.4 Lines,  Shapes , and Text  \nAnnotation text and shapes are created to add labels and descriptions to a project. They \ncan be created in screen or world space layers. Since these objects will be used to label \ncertain locations in the view, a world space layer is used for this example. As with other \nannotation objects, shapes can be moved and edited with the Select Annotations \nObject   tool.  \nTo create a line object, do the following:  \n1. Right -click on \u201c  Annotation Data\u201d in the Project Explorer and select Create \nWorld Space Layer  from the menu.  \n2. Select \u201c  Layer #2\u201d to make it active.  \n3. Using the Create Line Object   tool, click once to begin and double -click to end \na line that points to any location in the image to bring up the Line Properties  \ndialog. If desired, use Figure 2 as reference.  \n4. On the Line tab in the Line section, enter \u201c3\u201d in the Width  field.  \n5. Click on the drop -down arrow to the right of the wide Line color  button and select \n\u201cRed\u201d.  \n6. In the Arrowheads  section, select \u201cEnd\u201d from the drop -down to place an \narrowhead at the end of th e line.  \n7. Click OK to exit the Line Properties  dialog.  \nTo create a circle or oval, follow these steps:  \n8. Using  the Create Oval Object   tool, hold down the left -click button and drag \nthe cursor over an area where the circle is desired to bring up the Rectang le/Oval \nProperties  dialog.  \n9. On the Rectangle/Oval  tab in the Line section, select the Dashed  radio button.  \n10. Enter \u201c3\u201d as the Width .  \n11. Click on the drop -down arrow to the right of the wide Line color  button and select \n\u201cBlue\u201d.  \n12. In the Fill section, select the Fill radio button.  \n13. Click on the drop -down arrow to the right of the wide Fill button and select \n\u201cGreen\u201d.  \n14. Click OK to close the Rectangle/Oval Properties  dialog.  \nTo create a rectangle, do the following:  \n15. Using the Create Rectangle Obj ect  tool, hold down the left -click button and \ndrag the cursor over an area where the rectangle is desired to bring up the \nRectangle/Oval Properties  dialog.  \n\nGMS Tutorials   Annotation Tools  \n \n Page 6 of 7 \u00a9 Aquaveo 2024  16. The Rectangle/Oval Properties  dialog will appear.  \n17. On the Rectangle/Oval  tab in the Line section, select the Dashed  radio button.  \n18. Enter \u201c3\u201d as the Width .  \n19. Click on the drop -down arrow to the right of the wide Line color button and select \n\u201cBlue\u201d.  \n20. In the Fill section, select the No fill  radio button.  \n21. Click OK to close the Rectangle/Oval Properties  dialog.  \nTo add annotation text to the project as seen in Figure 2, do the following:  \n22. Using the Create Text Object   tool, click near the line arrow created \npreviously to bring up the Text Properties  dialog.  \n23. Enter \u201cLocation A\u201d in the Text field.  \n24. Click on the wide Font button  (AaBb ) to bring up the Font dialog. The font, font \nstyle, and font size can be changed here.  \n25. Select \u201c14\u201d in the Size field and \u201cBold\u201d in the Font style  field.  \n26. Click OK to close the Font dialog.  \n27. Click on the drop -down arrow to the right of the wide Color  button and select \n\u201cGreen\u201d.  \n28. Click OK to exit the Text Properties  dialog. The Graphics Window will appear \nsimilar to Figure 2.  \n \nFigure  2      Project with annotation o bjects  \n3 Importing and Exporting Annotations  \nOnce annotations are set up in one project, they can be imported into any other project. \nThis can be accomplished by saving a  file containing only the annotations  from the \n\nGMS Tutorials   Annotation Tools  \n \n Page 7 of 7 \u00a9 Aquaveo 2024  project , and then importing the project\u2019s annotation s into another project. The steps \nbelow illustrate how to create a n annotation file containing only the newly added \nannotations and then how to import the new annotations into an existing project f ile.  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Enter \u201cannoImport. anno \u201d for the File name . \n3. From the Save as type  drop-down , select \u201cAnnotation Save/Load Files  (*.anno )\u201d. \n4. Click Save  to save the new annotation  file and close the Save As  dialog.  \nNow this project file\u2019s annotations can be imported into other projects. The next step is to \nopen another project file into which the annotations can be imported.  \n5. Click New  to close the  current  project.   \n6. If it asks to save the project, click Don\u2019t Save . \n7. Click Open   to bring up the Open  dialog.  \n8. Select \u201cstart.gpr\u201d and click Open  to open the project and close the Open  dialog.  \n9. Click Open   to bring up the Open dialog again.  \n10. From the Files of type  drop-down , select \u201c Annotation Save/Load Files  (*.anno )\u201d. \n11. Select \u201cannoImport. anno \u201d. \n12. Click Open  to import the annotations  file and close the Open  dialog.  \nAll the previously created annotations will now appear on the image.  \n4 Conclusion  \nThis concludes the \u201cAnnotation Tools \u201d tutorial . Key concepts in this tutorial  included  the \nfollowing:  \n\uf0b7 Creating both types of annotation layers . \n\uf0b7 Learning the difference between types of layers.  \n\uf0b7 Using annotation objects to document points of interest in the Graphics Window . \n\uf0b7 Editing using the Annotation toolbar . \n\uf0b7 Saving and e xporting the annotation layers for use in other projects.  \n \n\n", "filename": "Annotations.pdf", "pages": 7}, "DisplayThemes": {"text": "GMS Tutorials   Display Themes  \n Page 1 of 6 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nDisplay Themes  \nQuickly save and restore display options  \n \nObjectives   \nThis tutorial describes display themes. Display themes are a powerful way to create and save display \noptions for later use. Using display themes allows quickly changing the look of the data.  \n \nPrerequisite Tutorials  \n\uf0b7 Getting Started  Required Components  \n\uf0b7 GMS Basic  \n Time  \n\uf0b7 5\u201310 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   Display Themes  \n Page 2 of 6 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 GMS User Interface ................................ ................................ ................................ ..............  2 \n2.1 Creating a 2D Grid  ................................ ................................ ................................ ........  2 \n2.2 Creating a Default Display Theme  ................................ ................................ ................  3 \n2.3 Graphics Window  ................................ ................................ ................................ ..........  3 \n2.4 Creating the Display Theme  ................................ ................................ .........................  4 \n3 Theme Properties  ................................ ................................ ................................ ................  4 \n4 Online Maps  ................................ ................................ ................................ .........................  5 \n5 Automatically Loading Display Themes  ................................ ................................ ............  6 \n6 Saving the Pr oject  ................................ ................................ ................................ ...............  6 \n \n1 Introduction  \nGMS has many display options. Display options are used to change how data appears \nwithout actually changing the data. For example, it is possible to change the colors of the \nfeature objects \u2014the points, arcs, and polygons.  \nDisplay t hemes  are a way to save the current display options so that the user can quickly \nreturn to them again. This tutorial will show how to create a theme and then save it so it \ncan be loaded later.  \n2 GMS User Interface  \nTo get started, do the following:  \n1. Launch GMS.  \n2. If GMS is already run ning, select File | New to ensure that the program settings \nare restored to the default state.  \n2.1 Creating a 2D Grid  \nDo the following to create a 2D grid in order to see how it is affected by display themes:  \n1. Create a grid frame by right -clicking in the Projec t Explorer and selecting New | \nGrid Frame .  \nA grid frame will appear in the Graphics Window.  \n2. Map it to a 2D grid by right -clicking on \u201c  Grid Frame\u201d in the Project Explorer \nand selecting Map To | 2D Grid  to bring up the Create Finite Difference Grid  \ndialog . \n3. Click OK to accept the defaults, create the grid, and close the Create Finite \nDifference Grid  dialog.  \nA 2D grid will now be within the boundaries of the grid frame ( Figure 1). \n\nGMS Tutorials   Display Themes  \n \n Page 3 of 6 \u00a9 Aquaveo 2024   \n      Figure 1      The 2D grid within the grid frame  \n2.2 Creating a Default Display Theme  \nDo the following to create a new display theme:  \n1. Right -click on a blank space in the Project Explorer and select New | Display \nTheme\u2026  to bring up the Display Theme Properties  dialog.  \nThis dialog will be covered in more detail below.  \n2. Enter \u201cDefault\u201d in the Display Theme name  field.  \n3. Click OK to close the Display Theme Properties  dialog.  \nA new \u201c  Default\u201d entry will appear under \u201c  Display Themes\u201d in the Project Explorer.  \n2.3 Graphics Window  \nNow do the following to change the display options and create another display theme:  \n1. Click Display Options   to bring up  the Display Options  dialog.  \n2. Below the list on the left, select \u201cGreen\u201d from the Background color  drop-down \narrow button.  \n3. Enter \u201c100\u201d in the Triad size  field.  \n4. Select \u201c2D Grid Data\u201d from the list on the left.  \n5. On the 2D Grid  tab, select \u201cBlue\u201d from the Cell edges  drop-down arrow button.  \n6. Select \u201cSpecified\u201d from the Color drop-down below Cell edges . \n7. Click OK to close the Display Options  dialog.  \nThe background in the Graphics Window will now be green ( Figure 2). \n\nGMS Tutorials   Display Themes  \n \n Page 4 of 6 \u00a9 Aquaveo 2024   \n      Figure 2      The background is now green and the grid lines are blue  \n2.4 Creating the Display Theme  \n1. Right -click on a blank space in the Project Explorer and select New | Display \nTheme\u2026  to bring up the Display Theme Properties  dialog.  \n2. Enter \u201cGreen background\u201d in the Display Theme name  field.  \n3. Click OK to close the Display Theme Properties  dialog.  \nA new \u201c  Green background\u201d entry will appear under \u201c  Display Themes\u201d in the \nProject Explorer.  \n4. Select the \u201c  Default\u201d theme in the Project Explorer.  \n5. Select the \u201c  Green background\u201d theme in the Project Explorer.  \nSelecting on a display theme changes the display options to whatever they were when \nthat theme was created.  \n3 Theme Properties  \nThe properties of any display theme can be edited. To edit the \u201c  Green background\u201d \ntheme, do the following:  \n1. Right -click on the \u201c  Green background\u201d display theme and select Properties\u2026  \nto bring up the Display Theme Properties  dialog ( Figure 3). \nThere are two sections of this dial og. The Display Theme name  is listed on the left side. \nBelow that is a checkbox that allows the theme to be loaded when specific Project \nExplorer objects are selected. This will be discussed later in the tutorial.  \nThe Display settings to include with theme  section lists general, display options, and \ndataset rendering settings that can be turned on or off as desired. This allows themes to \ninclude only the desired settings.   \n\nGMS Tutorials   Display Themes  \n \n Page 5 of 6 \u00a9 Aquaveo 2024  For example, do the following:  \n2. In the General  column of the Display settings to incl ude with theme  section, turn \noff Background color . \n3. Click OK to close the Display Theme Properties  dialog.  \n4. Switch between the \u201c  Default\u201d and \u201c  Green background\u201d themes to see that \nthe background color no longer changes, but the grid color and the triad still do.  \n5. Right -click on the \u201c  Green background\u201d display theme and select Properties\u2026  \nto bring up the Display Theme Properties  dialog.  \n6. Turn on t he Background color  option and click OK to close the Display Theme \nProperties  dialog.  \n7. Switch between the \u201c  Default\u201d and \u201c  Green background\u201d themes to see that \nthe background color now changes to green again when the \u201c  Green \nbackground\u201d  theme is selected . \n \n      Figure 3      Display Theme Properties dialog  \n4 Online Maps  \nTo change the display options saved with a display theme, do the following:  \n1. Click on Display Options   to bring up the Display Options  dialog.  \n2. Below the list on the left, select \u201cRed\u201d from the Background color  drop-down \narrow button.  \n3. Click OK to exit the Display Options  dialog. The background will now be red.  \n4. Right -click on \u201c  Green background\u201d and select Update With Current Display . \n\nGMS Tutorials   Display Themes  \n \n Page 6 of 6 \u00a9 Aquaveo 2024  5. Switch betwe en \u201c  Default\u201d and \u201c  Green background\u201d to see that the red \nbackground color is now associated with \u201c  Green background\u201d.  \n5 Automatically Loading Display Themes  \nDisplay themes can be loaded automatically when the user selects other objects (objects \nother tha n display themes) in the Project Explorer.  \n1. Select \u201c  Default\u201d to restore the display options to the default values.  \n2. Right -click on \u201c  Green background\u201d  and select Properties\u2026  to bring up the \nDisplay Theme Properties  dialog.  \n3. On the left side, turn on Load t his theme when objects with the following names \nare selected in the Project Explorer . \n4. Enter \u201c2D Grid Data\u201d on line 1 of the list below that.  \n5. Click OK to close the Display Theme Properties  dialog.  \n6. Select \u201c  2D Grid Data\u201d in the Project Explorer.  \nNotice tha t the \u201c  Green Background\u201d theme (which is now red) was loaded.  \n7. Select \u201c  Default\u201d to restore the display options to the default values.  \n8. Click on any other entry in the Project Explorer (including the \u201c  grid\u201d below \u201c  \n2D Grid Data\u201d).  \nNotice that the \u201c  Green background\u201d theme is only loaded when the user clicks on the \u201c\n Green background\u201d theme or on the \u201c  2D Grid Data\u201d folder. The theme looks for the \nname of the item, not the type. For example, if a TIN was named \u201c  2D Grid Data,\u201d it \nwould also trigger the \u201c  Green background\u201d theme.  \n6 Saving the Project  \nThis concludes the \u201cDisplay Themes\u201d tutorial. Topics covered include using display \nthemes to quickly save and restore display options, including just a subset of display \noptions in a theme, and setting a theme to automatically load based on the name of an \nitem in the Project Explorer.  \n \n\n", "filename": "DisplayThemes.pdf", "pages": 6}, "FeatureObjects": {"text": "GMS Tutorials   Getting Started  \n Page 1 of 8 \u00a9 Aquaveo 2024   GMS 10. 8 Tutorial  \nFeature Objects  \nUse points, arcs, and polygons to make grid independent conceptual \nmodels  \n \nObjectives   \nThis tutorial demonstrates how to use feature objects \u2014points, nodes, vertices, arcs, and polygons \u2014to \nmake grid -independent conceptual models.  \n \nPrerequisite Tutorials  \n\uf0b7 Getting Started  Required Components  \n\uf0b7 GMS Core  \n Time  \n\uf0b7 10\u201315 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   Feature Objects  \n Page 2 of 8 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Registering GMS  ................................ ................................ ................................ ..........  2 \n2 Feature Objects  ................................ ................................ ................................ ...................  2 \n2.1 Definitions  ................................ ................................ ................................ .....................  3 \n2.2 Project Explorer  ................................ ................................ ................................ ............  3 \n2.3 Crea ting Feature Objects  ................................ ................................ ..............................  5 \n2.4 Selecting Feature Objects  ................................ ................................ ............................  6 \n2.5 Modifying Feature Objects  ................................ ................................ ............................  6 \n2.6 Modifying Feature Objects  ................................ ................................ ............................  7 \n3 Conclusion  ................................ ................................ ................................ ...........................  8 \n \n1 Introduction  \nThis tutorial gives an introduction to feature objects: points, nodes, vertices, arcs, and \npolygons. The following key topics are discussed and demonstrated:  \n\uf0b7 Creating coverages  \n\uf0b7 Creating conceptual models  \n\uf0b7 Creating feature objects  \n\uf0b7 Selecting and modifying feature objects.  \n1.1 Registering GMS  \nTo get started, do the following:  \n1. Launch GMS.  \n2. If GMS is already running, select File | New\u2026  to ensure that the program settings \nare restored to their default state.  \n  \n2 Feature Objects  \nFeature objects are patterned after Geographic Information Systems (GIS) objects and \ninclude points, nodes, vertices, arcs, and polygons ( Figure 1). Feature objects are used \nin many ways in GMS, and they are used in most tutorials.  \nGMS Tutorials   Feature Objects  \n \n Page 3 of 8 \u00a9 Aquaveo 2024  \nNode\nVertex\nArcPolygonsPoint \n      Figure 1      Examples of feature objects  \n2.1 Definitions  \nPoints  are xy locations that are not attached to an arc. Points have unique IDs and can \nbe assigned properties. Points are typically used to represent wells.  \nArcs  are sequences of line segments or edges that are grouped together as a single \npolyline entity. Arcs have u nique IDs and can be assigned properties.  \nNodes  are the two end points of an arc. Nodes have unique IDs and can be assigned \nproperties.   \nVertices  are the intermediate points between nodes on an arc. Vertices are used solely \nto define the geometry of the a rc and cannot be assigned properties.  \nA polygon  is a group of connected arcs that form a closed loop. A polygon can consist of \na single arc or multiple arcs. If two polygons are adjacent, the arc forming the boundary \nbetween the polygons is shared (not dup licated).  \nA coverage  represents a particular set of objects and the attributes associated with those \nobjects. Feature objects are grouped into coverages.  \n2.2 Project Explorer  \nBoth coverages and conceptual models require certain steps to be created. Coverages \nare created by following these steps:  \n1. In the Project Explorer, right -click and select New | Coverage\u2026  to add a new \ncoverage under the \u201c Map Data\u201d folder in the Project Explorer.  \n2. Right -click on \u201c new coverage\u201d and select Coverage Setup\u2026  to bring up the \nCover age Setup  dialog.  \nNotice that this is where Sources/Sinks/BCs, Areal Properties, and Observation Point   \n attributes can be t urned on and off. For this project, all options should be grayed out.  \n \n\nGMS Tutorials   Feature Objects  \n \n Page 4 of 8 \u00a9 Aquaveo 2024  3. Nothing needs to be changed in the Coverage Setup  dialog, so click Cancel to \nexit the dialog.  \nThe \u201c  new coverage\u201d  item is now the active coverage, meaning that feature objects are \ncreated in this coverage. Coverages can be duplicated. All the feature objects and \nattributes from the original coverage are  copied to the new coverage.  \n4. Right -click on \u201c  new coverage\u201d  and select Duplicate\u2026  to create a new \ncoverage named \u201c  Copy of new coverage\u201d.  \nNotice that the icon next to \u201c  new coverage\u201d is now grey indicating that \u201c  new \ncoverage\u201d is no longer the active c overage.  \n5. Right -click on \u201c  Copy of new coverage\u201d and select Delete  to remove it from the \nProject Explorer.  \nA conceptual model in GMS is an object that can be used to associate one or more \nrelated coverages. Conceptual models are created by doing the follow ing: \n6. Right -click in the Project Explorer and select New | Conceptual Model\u2026  to bring \nup the Conceptual Model Properties  dialog ( Figure 2). \n \n      Figure 2      Conceptual Model Properties dialog  \nConceptual models have a name and a type. The type corresponds with the type of \nmodel being created (MODFLOW, FEMWATER, etc.). The type determines the options \navailable in the spreadsheet section of the dialog.  \n1. Click OK to accept the defaults and close the Conceptual Model Properties  \ndialog.  \n\nGMS Tutorials   Feature Objects  \n \n Page 5 of 8 \u00a9 Aquaveo 2024  2. In the Project Explorer field, drag the \u201c  new coverage\u201d below the \u201c  New \nModel\u201d conceptual model.  \n3. Click Yes if a dialog appears regarding attributes.  \nThe attributes in a coverage depend on the settings in the conceptual model that the \ncoverage is associated with. The coverage should now appear below \u201c  New Model\u201d  \n(Figure 3). \n \n      Figure 3      The Project Explorer showing a new coverage below a conceptual model  \n2.3 Creating Feature Object s \nThe next step is to create some feature objects on the coverage.  \n1. Using the Create Point   tool, click with the mouse to create several points in \nany location in the graphics window.  \n2. Using the Create Arc   tool, create several arcs by clicking with the mo use. \nSingle -click to create arc vertices and double -click to end the arc.  \nAlthough one or more closed loop arcs may have been created, GMS does not recognize \na closed loop arcs as a polygon until the Build Polygons  command is used.  \n3. Using the Create Arc   tool, create one or more closed loop arcs.  \n4. Select Feature Objects | Build Polygons .  \nAny closed -loop arcs now have a gray fill, indicating they are polygons ( Figure 4). \n \n      Figure 4      Points, nodes, vertices, arcs, and polygons  \n\nGMS Tutorials   Feature Objects  \n \n Page 6 of 8 \u00a9 Aquaveo 2024  2.4 Selecting Feature Objects  \nThere are three different tools for creating feature objects and seven different tools for \nselecting feature objects ( Figure 5). The different selection tools select different types of \nobjects. The default location for the feature object toolbar is vertically between the Project \nExplor er and the Graphics Window. It is shown horizontally here for convenience.  \n \n      Figure 5      Seven selection tools (left) and three creation tools (right)  \n1. Hold the mouse cursor over a tool for a couple of seconds until the tool  name \nappears as shown in Figure 6.  \nThis can be used to identify the correct tool.  \n \n      Figure 6      Context sensitive help for tools  \nThe Select   tool can be used to select any feature object. Each type of feature object \nalso has a specific tool that will select only that type of feature object. The specific tools \ncan be used when necessary, such as when different types of objects are close to each  \nother.  \n2. Use the  Select  tool to select different types of feature objects.  \n3. Try out the other selection tools to select different types of feature objects.  \n2.5 Modifying Feature Objects  \nThere are several ways that feature objects can be modified using GMS. Som e feature \nobjects, like points and vertices, can be moved to other locations by dragging them with \nthe mouse. Other objects, like arcs and polygons, cannot be dragged, but it is possible to \nmove arcs and polygons by moving the nodes and vertices that are o n them.  \nTo drag points and nodes, do the following:  \n1. Use the  Select Points \\Nodes   tool to select one of the isolated points created \nearlier.  \n2. While holding down the left mouse button, drag the point to a different location.  \n3. Use the same Select Points \\Nodes  tool to drag a node on the arc created \nearlier.  \nThe vertices may not be visible. To make them visible, do the following:  \n1. Click Display Options   to bring up the Display Options  dialog.  \n2. Select \u201cMap Data\u201d from the list on the left.  \n3. On the Map tab, turn on Vertices . \n4. Click OK to close the Display Options  dialog.  \nVertices should now be visible in various locations along each arc.  \n\nGMS Tutorials   Feature Objects  \n \n Page 7 of 8 \u00a9 Aquaveo 2024  5. Using the Select Vertices  tool, select and drag a vertex on one of the arcs \ncreated earlier.  \nArcs can be modified by adding more v ertices.  \n6. Switch to the Create Vertex  tool. \n7. Click on one of the arcs to add one or more vertices to it.  \nBy adding vertices and dragging them where they are needed, it is possible to refine how \nthe arc looks. It is also possible to right -click on an arc and  redistribute the vertices. This \nis a faster way to create many vertices and space them evenly along the arc.  \n8. Using the Select Arcs   tool, select any arc.  \n9. Right -click on the selected arc and choose Redistribute Vertices\u2026  to bring up \nthe Redistribute Verti ces dialog.  \n10. Select \u201cSpecified spacing\u201d from the Specify  drop-down.  \n11. Enter \u201c10.0\u201d as the Average spacing . \n12. Click OK to close the Redistribute Vertices  dialog.  \nThe arc should now have a number of vertices evenly spaced along its length.  \n2.6 Modifying Feature Objects  \nGrid frames are used to build 2D and 3D grids. A grid frame defines the rectangular \nextent of the grid. Grid frames can be rotated and moved to better fit the desired \nmodeling area.  \n1. Select Feature Objects | New Grid Frame  to create a purple grid frame rectangle \non the screen.  \n2. Using the Select Grid Frame  tool, click on one of the borders of the grid \nframe to select it.  \n3. Click and drag on the interior of the grid frame to move  it to a new location.  \n \nFigure 7      Grid frame with handles  \nNotice the handles in the corners and the middle of the edges of the grid frame. In the \nbottom right corner, notice the circular handle used for rotation.  \n\nGMS Tutorials   Feature Objects  \n \n Page 8 of 8 \u00a9 Aquaveo 2024  1. Click on the handles of the grid frame to resize it and on th e circular handle to \nrotate it.  \nThe properties of the grid frame can also be entered manually.  \n2. Double -click on the grid frame in the Project Explorer to open the Grid Frame \nProperties  dialog.  \n3. Enter \u201c100\u201d for the Dimension x  and \u201c50\u201d for the Dimension y  attributes.  \n4. Click OK to close the Grid Frame Properties  dialog.  \nThe grid frame has now been resized to be 100 by 50.  \n3 Conclusion  \nThis concludes the \u201cFeature Objects\u201d tutorial. Topics covered in this tutorial include \ncreating coverages, conceptual models, and f eature objects, as well as selecting and \nmodifying feature objects.  \n \n \n", "filename": "FeatureObjects.pdf", "pages": 8}, "FEMWATER-FlowModel": {"text": "GMS Tutorials   FEMWATER \u2013 Flow Model  \n Page 1 of 22 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nFEMWATER \u2013 Flow Model  \nBuild a FEMWATER model to simulate flow  \n \nObjectives   \nThis tutorial shows how to build a 3D mesh and a FEMWATER flow model using the conceptual model \napproach. It will also review running the model and examining the results.  \n \nPrerequisite Tutorials  \n\uf0b7 Feature Objects  \n\uf0b7 Geostatist ics 2D  \n\uf0b7 Stratigraphy Modeling \u2013 \nTINs  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 FEMWATER  \n\uf0b7 Geostatistics  \n\uf0b7 Mesh  \n\uf0b7 Subsurface  \n Time  \n\uf0b7 45\u201365 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n Page 2 of 22 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  3 \n2 Building the Conceptual Model  ................................ ................................ ..........................  3 \n2.1 Importing the Background Image  ................................ ................................ ..................  3 \n2.2 Saving with a New Name  ................................ ................................ ..............................  3 \n2.3 Define the Units  ................................ ................................ ................................ ............  4 \n2.4 Initializing the FEMWATER Coverage  ................................ ................................ ..........  4 \n2.5 Creating the Boundary Arcs  ................................ ................................ ..........................  4 \n2.6 Redistributing the Arc Vertices ................................ ................................ ......................  5 \n2.7 Defining the Boundary Conditions  ................................ ................................ ................  6 \n2.8 Building the Polygon  ................................ ................................ ................................ ..... 6 \n2.9 Assigning the Recharge  ................................ ................................ ................................  7 \n2.10  Creating the Wells  ................................ ................................ ................................ ........  7 \n3 Building the 3D Mesh  ................................ ................................ ................................ ..........  8 \n3.1 Defining the Materials  ................................ ................................ ................................ ... 8 \n3.2 Building the 2D Projection Mesh  ................................ ................................ ...................  9 \n3.3 Building the TINS  ................................ ................................ ................................ ..........  9 \n3.4 Interpolating the Terrain Data  ................................ ................................ .....................  10 \n3.5 Interpolating the Layer Elevation Data  ................................ ................................ ........  11 \n3.6 Interpolating the Layer Elevation Data  ................................ ................................ ........  12 \n4 Converting the Conceptual Model ................................ ................................ ....................  13 \n5 Selecting the Analysis Options  ................................ ................................ ........................  14 \n5.1 Entering the Run Options  ................................ ................................ ...........................  14 \n5.2 Setting the Iteration Parameters  ................................ ................................ .................  15 \n5.3 Selecting Output Control  ................................ ................................ .............................  15 \n5.4 Defining the Fluid Properties ................................ ................................ .......................  15 \n6 Defining Initial Conditions  ................................ ................................ ................................  16 \n6.1 Digitizing the Scatter Point Set  ................................ ................................ ...................  16 \n6.2 Creating the Dataset  ................................ ................................ ................................ ... 17 \n7 Defining the Material Properties  ................................ ................................ .......................  18 \n8 Saving and Running the Model  ................................ ................................ ........................  18 \n9 Viewing the Solution  ................................ ................................ ................................ .........  19 \n9.1 Viewing Head Contours  ................................ ................................ ..............................  19 \n9.2 Viewing a Water Table Isosurface  ................................ ................................ ..............  20 \n9.3 Draping the TIFF Image on the Ground Surface ................................ .........................  21 \n10 Conclusion  ................................ ................................ ................................ .........................  22 \n \n1 Introduction  \nFEMWATER is a three -dimensional, finite element groundwater model. It can be used to \nsimulate flow and transport in both the saturated and the unsaturated zone. Furthermore, \nflow and transport can be coupled to simulate density -dependent problems such as \nsalinity intrus ion. This tutorial describes how to build a steady -state FEMWATER model \nto simulate flow only.  \nThe site being modeled in this tutorial is a small coastal aquifer with three production \nwells, each pumping at a rate of 2,830 m3/day. The no -flow boundary on t he upper -left \ncorresponds to a parallel -flow boundary, and the no -flow boundary on the left \ncorresponds to a thinning of the aquifer due to a high bedrock elevation. A stream \nprovides a specified head boundary on the lower -left and the remaining boundary i s a \ncoastal boundary simulated with a specified head condition.  \nThe stratigraphy of the site consists of an upper and lower aquifer. The upper aquifer has \na hydraulic conductivity of 3 m/day, and the lower aquifer has a hydraulic conductivity of \n9 m/day. T he wells extend to the lower aquifer. The recharge to the aquifer is about one \nfoot per year.  \nThis tutorial demonstrates and discusses importing a background image, defining \ncoverages and mapping them to a 2D mesh, creating TINs from the mesh, interpolati ng \nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 3 of 22 \u00a9 Aquaveo 2024  elevations from scatter points to TINs, building a 3D mesh from the TIN horizons, \nmapping the conceptual model to a FEMWATER simulation, defining additional \nconditions and running FEMWATER, viewing the water table as an isosurface, and \ndraping the TIFF image on the ground surface.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If GMS is not running, launch GMS.  \n2. If GMS is already running, select File | New to ensure the program settings are \nrestored to the default state. A dialog may appear asking to s ave changes. Click \nDon\u2019t Save  to clear all data. The graphics window of GMS should refresh to \nshow an empty space  \n2 Building the Conceptual Model  \nFEMWATER models can be constructed using the direct approach , or the conceptual \nmodel approach. With the direct approach, a mesh is constructed and the boundary \nconditions are assigned directly to the mesh by interactively selecting nodes and \nelements. With the conceptual model approach, feature objects (points, arcs, and \npolygons) are used to define the model domai n and boundary conditions. The mesh is \nthen automatically generated and the boundary conditions are automatically assigned. \nThe conceptual model approach will be used for this tutorial.  \n2.1 Importing the Background Image  \nBefore creating the feature objects, im port a scanned image of the site. The image was \ngenerated by scanning a section of a USGS quadrangle map on a desktop scanner. The \nimage has previously been imported to GMS and registered to real -world coordinates. \nThe registered image was then saved to a GMS project file.  \nDo the following to import the image:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the femwater/femwater  directory for this tutorial and select \u201cstart.gpr\u201d.  \n4. Click  Open  to import the project file and close the Open  dialog.  \n2.2 Saving with a New Name  \nCreate a new project by saving it with a new name:  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cfemmod.gpr\u201d as the File name . \n4. Click Save  to create the new project file and close the Save As  dialog.  \nIt is recommended to Save   periodically throughout the tutorial.  \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 4 of 22 \u00a9 Aquaveo 2024  2.3 Define the Units  \nNow define the units. GMS uses the selected units to plot helpfu l labels next to input edit \nfields.  \n1. Select Edit | Units\u2026  to bring up the Units dialog . \n2. Select \u201cd\u201d (days) from the Time  drop-down . \n3. Select \u201ckg\u201d (kilograms) from the  Mass  drop-down .  \nThe remaining units are for a transport simulation and can be ignored.  \n4. Click  OK to exit the Units  dialog . \n2.4 Initializing the FEMWATER Coverage  \nBefore creating the feature objects, first create a FEMWATER coverage.  \n1. In the Project Explorer , right -click on the empty space and select New | \nConceptual Model \u2026 to open the Conceptual Model Properties dialog . \n2. Enter  \u201cfemmod\u201d  as the Name . \n3. Select  \u201cFEMWATER \u201d from the Type  drop-down.   \n4. Click OK to close the Conceptual Model Properties dialog . \n5. Right -click on the  new \u201c femmod \u201d conceptual model  and select New \nCoverage \u2026 to open the Coverage Setup dialog . \n6. Enter \u201cfemwater\u201d  as the Coverage name. \n7. In the Sources/Sinks/BCs  column, t urn on Flow BC , Wells , and Refinement . \n8. In the Areal Properties  column, turn on Meshing options . \n9. Click  OK to close the Coverage Setup dialog . \n2.5 Creating the Boundary Arcs  \nIt is now possible to begin creating the arcs defining the boundary of the model. Notice \nthat the three boundaries on the left have been marked on the background image and are \ncolor -coded.  \n1. Select the \u201cfemwater\u201d coverage to make it active.  \n2. Using the Create Arc   tool, click out a series of vertices to create an arc for \nthe black line, double -clicking to end the arc (black line in Figure 1). \n3. Click out a series of vertices to create an arc for the red line, pressing Enter  to \nend the arc (red line in Figure 1). Make sure that the arcs are connected by \nstarting precisely at the ending point of the previous arc.  \n4. Click out a series of vertices to create an arc for the blue river line (blue line in \nFigure 1). Again, make sure that the arcs are connected  \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 5 of 22 \u00a9 Aquaveo 2024   \n      Figure 1      First three boundary arcs  \n5. Create an arc for the coastline boundary (between the arrows in Figure 2). Once \nagain, be sure that the arc is connected to the other boundary arcs.  \n \n      Figure 2      Coastline boundary arc  \n2.6 Redistributing the Arc Vertices  \nThe two end points of each arc are called nodes  and the intermediate points are called \nvertices . These arcs will be used to generate a 2D mesh that will be converted into a 3D \nmesh. The spacing of the line segments defined by the vertices will control the size and \nnumber of elements. Redistributing the vertices along each arc ensures that they are \nevenly spaced and of the correct length.  \n1. Using the Select Arcs   tool, select all four arcs by dragging a box that \nencloses all of the arcs.  \nBlack line  \nRed line  \nBlue line  \nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 6 of 22 \u00a9 Aquaveo 2024  2. Select Feature Objects | Redistribute Vertices\u2026  to open the Redistribute \nVertices dialog.  \n3. Enter \u201c90\u201d for the Average spacing.   \n4. Click OK to close the Redistribute Vertices dialog and redistribute the vertices.  \n2.7 Defining the Boundary Conditions  \nNow that the arcs are defined, assign b oundary conditions to the arcs. The two no -flow \nboundaries do not need to be altered since the default boundary type is no -flow. \nHowever, it\u2019s necessary to mark the stream arc and the coastline arc as constant -head \narcs.  \n1. Using the Select Arcs   tool, hold down the Shift key and select the coastline \narc and the stream arc (the blue one in Figure 1, above).  \n2. Click Properties   to open the Attribute Table dialog.  \n3. In the All row in the spreadsheet, select \u201cspec. head\u201d from the Flow bc column \ndrop-down to assign this to both arcs.  \n4. Click OK to close the Attribute Table dialog.  \nNo head values were assigned to the arcs because they are assigned to the nodes at th e \nends of the arc. This allows the head to vary linearly along the length of the arc. For the \ncoastline arc, the head at both ends is the same. Since the default head value is zero, no \nchanges need to be made. However, it is necessary to enter a head value  for the upper \nend of the stream. The head will vary linearly along the stream from the specified value at \nthe inland end (or top) to zero at the coast.  \n5. Using the Select Points \\Nodes   tool, double -click on the inland node of the \nstream arc to bring up the Attribute Table  dialog.  \n6. On the \u201cspec. head\u201d row, enter \u201c60.0\u201d in the Head (m)  column.  \n7. Click OK to close the Attribute Table dialog.  \n2.8 Building the Polygon  \nNow that the arcs are defined,  build a polygon defining the model domain. The polygon is \nnecessary because it is used to define the model domain when the mesh is generated, \nand it is used to assign the recharge. In many cases, the model domain is subdivided into \nmultiple recharge zones , each defined by a polygon. In this case, use only one polygon \nsince the model has a single recharge value.  \n1. Select Feature Objects  | Build Polygons . \n2. To view the polygon area, use the Select Polygons   tool to click on the center \nof the new polygon.  \nThe Graphics Window should appear similar to Figure 3. \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 7 of 22 \u00a9 Aquaveo 2024   \n      Figure 3      The polygon defining the model domain  \n2.9 Assigning t he Recharge  \nNest, assign the recharge value. There are two wasy to assign recharge in FEMWATER: \nusing a specified -flux-boundary or using a variable boundary. The variable boundary is \nmore accurate but is more time -consuming and less stable. To ensure that the tutorial \ncan be completed in a timely fashion, use the simpler specified -flux approach.  \n1. Using the Select Polygons   tool, double -click anywhere in the interior of the \nmodel domain to bring up the Attribute Table  dialog. . \n2. Select \u201cspec. flux\u201d from the Flow bc  drop-down.  \n3. Enter \u201c0.0009\u201d in the Flux rate  column. This value is in m/d and corresponds to \nabout 0.34 m/yr.  \n4. Click OK to close the Attribute Table  dialog.  \n5. . Click anywhere outside the polygon to deselect it.  \n2.10 Creating the Wells  \nThe final step in defini ng the conceptual model is to create the wells. It is necessary to \ncreate three wells in this case.  \nTo create the first well, do the following:  \n1. Using the Create Point   tool, create a point anywhere in the upper -right corner \nof the model.  \n2. Using the edit fi elds at the top of the Graphic Window, change the XYZ \ncoordinates of the point that was just created to \u201c1612,\u201d \u201c1282,\u201d \u201c14\u201d. Hit the Tab \nor Enter  key after entering each value.  \n3. With the point still selected, click Properties   to open the Attribute Table \ndialog.  \nA well point needs to be of the type \u201cwell\u201d. The pumping rate and elevation of the \nscreened interval need to be defined. The screened interval is used to determine which \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 8 of 22 \u00a9 Aquaveo 2024  3D mesh nodes need to have the pumping rate assigned. The pumping rate is fact ored \namong all nodes within the screened interval. In this case, there is only one node.  \n4. Scroll to the right if necessary to see the additional columns in the spreadsheet.  \n5. In the spreadsheet, select \u201cwell\u201d from the drop -down in the Type  column.  \n6. Enter \u201c -44\u201d in the Top scr.  column.  \n7. Enter \u201c -55\u201d in the Bot. scr.  column.  \n8. Enter \u201c -2830\u201d in the Flow rate (m^3/d)  column.  \n9. Turn on Refine .  \nThis refines the mesh around the well.  \n10. Enter \u201c45\u201d in the Elem. size  column.  \nThis controls the element size at the well. \n11. Click OK to exit the Attribute Table dialog.  \n12. Repeat steps 1 \u201311 to create the second and third wells with the properties given \nin the table below.  \nWell X Y Z Top \nscr. Bot. \nscr. Flow \nrate \n(m^3/d)  Elem. \nsize \n2 1175  925 23 -50.0 -62.0 -2830 .0 45.0 \n3 1532  571 14 -75.0 -90.0 -2830 .0 45.0 \n \n \n3 Building the 3D Mesh  \nAt this point, the conceptual model is complete and ready to be used to build the 3D \nfinite -element mesh. The mesh will consist of two zones: one for the upper aquifer and \none for the lower aquifer.  \nTo build the mesh, a 2D \u201cprojection\u201d mesh will first be created by using the feature \nobjects in the conceptual model. Three triangulated irregular networks (TINs) will then be \ncreated: one for the top (terrain) surface, one for the bottom of the upper aquifer, and one \nfor the bottom of the lower aquifer. Finall y, the 3D elements will be created by using the \nHorizons \u2192 3D Mesh  command.  \n3.1 Defining the Materials  \nBefore building the mesh, define a material for each of the aquifers. The materials are \nassigned to the TINs and, eventually, to each of the 3D elements.  \n1. Select Edit | Materials\u2026  to bring up the Materials  dialog.  \n2. In row 1, enter \u201cUpper Aquifer\u201d in the Name  column and press the Tab key. \n3. Select Green  from the drop -down in the Color/Pattern  column.  \n4. In row 2 (marked with * until this step is completed), create a new material by \nentering \u201cLower Aquifer\u201d in the Name  column, then press the Tab key. \n5. Select Red from the drop -down in the Color/Pattern  column.  \nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 9 of 22 \u00a9 Aquaveo 2024  6. Click OK to close the Materials  dialog.  \n3.2 Building the 2D Projection Mesh  \nThe 2D projection mesh can be constructed directly from the conceptual model:  \n1. Select Feature Objects | Map \u2192 2D Mesh . \nAfter a few seconds, the mesh should appear ( Figure 4). \n \n      Figure 4      The 2D mesh  \n3.3 Building the TINS  \nTo build the TINs defining the stratigraphic horizons, make three TINs where each TIN is \na copy of the 2D mesh. At first, these three TINs will have the same elevations (zero) as \nthe 2D mesh. After creating the TINs, use a set of scatter points and interpolate the \nproper elevations to the TINs.  \nTo create the top TIN:  \n1. Select the \u201c  2D Mesh Data\u201d folder in the Project Explorer to make it active.  \n2. Select Mesh  | Convert to  | TIN  to open the Properties dialog.  \n3. Enter \u201cterrain\u201d for the TIN name . \n4. Select \u201cUpper Aquifer\u201d from the TIN material  drop-down. This defines the \nmaterial below the TIN . \n5. Enter \u201c2\u201d for the Horizon ID . \n6. Click OK to close the Properties dialog.  \nTo create the second TIN:  \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 10 of 22 \u00a9 Aquaveo 2024  1. Select Mesh  | Convert to  | TIN  to open the Properties dialog.  \n2. Enter \u201cbottom upper aquifer\u201d for the TIN name . \n3. Select \u201cLower Aquifer\u201d from the TIN material  drop-down.  \n4. Enter \u201c1\u201d for the Horizon ID . \n5. Click OK to close the Properties dialog.  \nTo create the third TIN:  \n1. Select Mesh  | Convert to  | TIN  to open the Properties dialog.  \n2. Enter \u201cbottom lower aquifer\u201d for the TIN name . \n3. Select \u201cLower Aquifer\u201d from the TIN material  drop-down. This defines the \nmaterial below the TIN.  \n4. Enter \u201c0\u201d for the Horizon ID . \n5. Click OK to close the Properties dialog.  \n3.4 Interpolating the Terrain Data  \nNext, use the scatter points defining the terrain elevations to interpolate to the top TIN. \nThe terrain points were created by digitizing elevations from the contour map. Before \ninterpolating to the TIN, make sure the top TIN is active, and make some adjustments to \nthe interpolation options (based on the experience with these scatter point data).  \n1. From the Project Explorer, select the \u201c  terrain\u201d TIN.  \n2. Expand the \u201c  2D Scatter Data\u201d folder.  \n3. Select the \u201c  terrain\u201d scatter point set to make it active.  \n4. Select Interpolation | Interpolation Options\u2026  to open the 2D Interpolation \nOptions dialog.  \n5. In the Interpolation method  section, click Options\u2026  next to Inverse distance \nweighted  to open the 2D IDW Interpolation Options dialog.  \n6. In the Nodal function  section, select Constant (Shepard\u2019s method) . \n7. Click OK to exit the 2D IDW Interpolation Options dialog.  \n8. Click OK to exit the 2D Interpolation Options dialog.  \nTo interpolate from the scatter points to the TIN, do the following:  \n1. In the Project Explorer, right -click on the \u201c  terrain\u201d scatter point set and select \nInterpolate To | Active TIN  to bring up the Interp olate \u2192 Object  dialog.  \n2. Click OK to accept the defaults and close the Interpolate \u2192 Object  dialog.  \nThe Graphics Window will appear as in Figure 5. \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 11 of 22 \u00a9 Aquaveo 2024   \n      Figure 5      Terrain scatter data has been interpolated  \nTo view the interpolated elevations:  \n1. Switch to Oblique View  . \n2. Click Display Options   to bring up the Display Options  dialog.  \n3. In the section below the list on the left, enter \u201c4.0\u201d for the Z magnification.  \n4. Click OK to close the Display Options  dialog.  \nThe Graphics Window should appear similar to Figure 6. \n \n      Figure 6      Oblique view showing elevations on the terrain TIN  \n3.5 Interpolating the Layer Elevation Data  \nNext, interpolate the elevations defining the bottom of the upper and lower aquifers. \nThese elevations were obtained from a set of exploratory boreholes.  \n1. Select the \u201c  bottom upper aquifer\u201d TIN in the Project Explorer to make it active.  \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 12 of 22 \u00a9 Aquaveo 2024  2. Expand the \u201c  elevs\u201d dataset under \u201c  2D Scatter Data\u201d in the Project \nExplorer.  \nThis dataset contains two sets of data: a set of elevations for the bottom of the upper \naquifer, and a set for the bottom of the lower aquifer. First, interpolate the elevations for \nthe bottom of the upper aquifer.  \n3. Select the \u201c  bot of layer 1 \u201d dataset to make it active.  \nTo interpolate from the scatter points to the active TIN, do the following:  \n4. Right -click on the \u201celevs\u201d   scatter set and select Interpolate To | Active TIN  to \nbring up the Interpolate \u2192 Object  dialog.  \n5. Click OK to accept the defau lts and close the Interpolate \u2192 Object  dialog.  \nFinally, interpolate the elevations for the bottom TIN:  \n6. Select the \u201c  bottom lower aquifer\u201d TIN in the Project Explorer to make it active.  \n7. Select the \u201c  bot of layer 2 \u201d dataset to make it active.  \n8. Right -click o n the \u201celevs\u201d   scatter set and select Interpolate To | Active TIN  to \nbring up the Interpolate \u2192 Object  dialog.  \n9. Click OK to accept the defaults and close the Interpolate \u2192 Object  dialog.  \nAt this point, the correct elevations on all three TINs should be vis ible ( Figure 7). \n \n      Figure 7      All three TINs with elevations interpolated  \n \n3.6 Interpolating the Layer Elevation Data  \nNow construct the 3D mesh using the horizon method by doing the following:  \n1. Click on the \u201c  TIN Data\u201d folder in the Project Explorer.  \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 13 of 22 \u00a9 Aquaveo 2024  2. Select TINs  | Horizons \u2192 3D  Mesh\u2026  to bring up the Horizon Elevations  page of \nthe Horizons to Mesh  dialog.  \n3. Click Next >  to accept the defaults and go to the Top and Bottom Elevations  \npage of the Horizons to Mesh  dialog.  \n4. In the Top elevation  section, select TIN elevations  and then \u201cterrain\u201d from the \n\u201cTIN Data\u201d tree below that.  \n5. In the Bottom elevation  section, select TIN ele vations  and then \u201cbottom lower \naquifer\u201d from the \u201cTIN Data\u201d tree below that.  \n6. Click Next >  to go to the  Build Mesh  page of the Horizons to Mesh  dialog.  \n7. In the Meshing options  section, turn on Refine elements  and Subdivide material \nlayers . \n8. Select Refine all elements  below Refine elements .  \n9.  Select Target layer thickness  below  Subdivide material layers .  \n10. Enter \u201c10.0\u201d in the Max layer thickness  column of the Upper Aquifer  row. \n11. Enter \u201c20.0\u201d in the Max layer thickness  column of the Lower Aquifer  row. \n12. Click Finish  to close the Horizons to Mesh  dialog.  \nA 3D mesh will now be constructed between the TINS from the options that were \nselected ( Figure 8). \n \n      Figure 8      The 3D mesh between the TINs  \n4 Converting the Conceptual Model  \nBefore continuing, unclutter the display by hiding the objects that are no longer  needed. \nHide everything in the Project Explorer except for the feature objects and the 3D mesh by \ndoing the following:  \n1. Turn off \u201c  TIN Data\u201d, \u201c  2D Mesh Data\u201d, \u201c  2D Scatter Data\u201d, and \u201c  GIS \nLayers\u201d . \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 14 of 22 \u00a9 Aquaveo 2024  Now convert the conceptual model to the 3D mesh model.  This will assign all of the \nboundary conditions using the data defined on the feature objects.  \n2. Right -click \u201c  mesh (1)\u201d under \u201c  3D Mesh Data\u201d and select New \nFEMWATER \u2026 to bring up the FEMWATER Run Options  dialog.  \n3. Click OK to accept the defaults and close the FEMWATER Run Options  dialog.  \n4. Right -click on \u201c  femmod \u201d in the Project Explorer and select Map to \u2192 \nFEMWATER  to bring up the Map \u2192 Model  dialog.  \n5. Click OK to accept the defaults and close the Map \u2192 Model  dialog. Since the \nmodel has only one coverage, the choice here does not make a difference.  \n6. A warning dialog may appear saying there is no mesh assigned to a certain part \nof the model. This has no effect on the model working, so click OK to accept the \ndefaults. \nA set of symbols should appear indicating that the boundary conditions have been \nassigned ( Figure 9). \n \n      Figure 9      Conceptual model converted to 3D mesh FEMWATER model  \n5 Selecting the Analysis Options  \nThe next is to switch to the  3D Mesh  module and select which analysis options to \nuse. \n5.1 Entering the Run Options  \nTo set up a steady state flow simulation, do the foll owing:  \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 15 of 22 \u00a9 Aquaveo 2024  1. Select FEMWATER | Run Options\u2026  to open the FEMWATER Run Options \ndialog.  \n2. Select \u201cFlow only (10)\u201d from the Type of simulation (OP1)  drop-down.  \n3. In the Solver options (OP2)  section, select \u201cSteady state (0)\u201d from the Steady -\nstate vs. transient (KSSF)  drop-down.  \nThe problem to be solved has a very large, partially saturated region, mainly in the upper -\nleft corner of the model. The larger the unsaturated zone, the more difficult it is to get \nFEMWATER to converge. For these types of problems, the \u201cNodal/ Nodal\u201d option is a \ngood choice for quadrature. It is not as accurate as the default option \n(Gaussian/Gaussian ), but it is more stable.  \n4. Select \u201cNodal/Nodal (11)\u201d from the Quadrature (IQUAR)  drop-down.  \n5. Click OK to close the FEMWATER Run Options dialog.  \n5.2 Setting the Iteration Parameters  \nAdjust the iteration parameters next by doing the following:  \n1. Select FEMWATER | Iteration Parameters\u2026  to bring up the FEMWATER \nIteration Parameters dialog.  \n2. In the Flow simulation  section, enter \u201c100\u201d for the Max iterations for no n-linear \nequation . \n3. Enter \u201c1000\u201d for the Max iterations for linear equation . \n4. Enter \u201c0.003\u201d (m) for the Steady -state convergence criterion . \n5. Enter \u201c0.003\u201d (m) for the Transient convergence criterion . \n6. Click OK to close the FEMWATER Iteration Parameters dialog.  \n5.3 Selecting Output Control  \nThe next step is to select the output options. Choose to output a pressure head file only.  \n1. Select FEMWATER | Output Control\u2026  to open the FEMWATER Output Control \ndialog.  \n2. In the Save options (OC4)  section, turn off Save nodal moisture content (.mcn) \nfile (3), Save velocity (.vel) file (4), and Save flux (.flx)  file (2).  \n3. Turn on Save pressure head (.phd) (1)  file. \n4. Click OK to close the FEMWATER Output Control dialog.  \n5.4 Defining the Fluid Properties  \nFinally, define the fluid properties.  \n1. Select FEMWATER | Fluid Properties\u2026  to open the FEMWATER Fluid \nProperties dialog.  \nThe items in this dialog are dependent on the selected units. Since this is a steady state \nsolution, ignore the viscosity and compressibility options.  \n2. Enter \u201c1000.0\u201d for the Density of water . \n3. Click OK to close the FEMWATER Fluid Properties dialog.  \nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 16 of 22 \u00a9 Aquaveo 2024  6 Defining Initial Conditions  \nBecause FEMWATER uses non -linear equations to model flow in the unsaturated zone, it \nis more sensitive to initial conditions than s aturated flow models such as MODFLOW. If a \nset of initial conditions is defined that is significantly different than the final head \ndistribution, FEMWATER may be slow or even unable to converge.  \nFor a flow simulation, FEMWATER requires a set of pressure he ads as an initial \ncondition. The FEMWATER interface in GMS includes a command that can be used to \nautomatically create a set of pressure heads from a user -defined water table surface. The \nwater table surface is defined by a set of scatter points. A total h ead dataset is generated \nby interpolating head values from the scatter points to the nodes of the 3D mesh. Finally, \nthe pressure head dataset is created by subtracting the node elevations from the total \nhead values.  \n6.1 Digitizing the Scatter Point Set  \nTo defi ne the initial condition, a small set of points is used at the expected elevation of \nthe computed water table surface. In the interest of time, these points have already been \ncreated and are already in the project. The \u201cGeostatistics 2D\u201d tutorial  discusses  the \ncreation of scatter points in more detail.  \nBefore digitizing the points, turn off the flux boundary condition display options and turn \non and modify the labels for each point by doing the following:  \n1. Select FEMWATER | BC Display Options\u2026  to open the Display Options dialog. \nNotice that \u201c3D Mesh Data\u201d is already selected in the list on the left.  \n2. On the FEMWATER  tab, turn off Flux fluid (CB1) . \n3. Select \u201c2D Scatter Data\u201d from the list on the left.  \n4. On the 2D Scatter Point Set  tab, in the table below the Note, click on the large \nbutton (not the down arrow button) to the right of \u201cstartheads\u201d to bring up the \nSymbol Attributes  dialog.  \n5. Enter \u201c10\u201d for the Size. \n6. Click OK to close the Symbol Attributes  dialog.  \n7. Turn on Scatter point scalar values  and click the 123 button to the right to bring \nup the Font dialog.  \n8. Select \u201cArial\u201d from the Font list. \n9. Select \u201cRegular\u201d from the Font style  list. \n10. Select \u201c11\u201d from the Size list. \n11. Turn on Fill behind text  and select \u201cSpecified\u201d from the Color drop-down.  \n12. Click the down arrow to the right of Fill behind text  and select \u201cWhite\u201d from the list \nof colors.  \n13. Click OK to close the Font dialog.  \n14. Click OK to close the Display Options dialog. Notice that all the blue circles \ndisappeared from the top of the 3D Mesh.  \nTo view the scatter point set.  \n15. Switch to Plan View  . \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 17 of 22 \u00a9 Aquaveo 2024  16. In the Project Explorer, turn off the \u201c  3D Mesh Data\u201d folder.  \n17. Turn on the \u201c  startheads\u201d  scatter point set and the \u201c  GIS Layers\u201d folder.  \nThe scatter points should be located as shown in Figure 10. The value displayed to the \nright of each point shows its elevation.  \n \n      Figure 10      Point locations and elev ations  \n18. When finished viewing the scatter points, turn on the \u201c  3D Mesh Data\u201d folder in \nthe Project Explorer.  \n19. Switch to Oblique View  . \n20. Click Display Options   to bring up the Display Options  dialog.  \n21. Select \u201c2D Scatter Data\u201d from the list on the left.  \n22. On the 2D Scatter Point Set tab, turn off Scatter point scalar values . \n23. Click OK to close the Display Options  dialog.  \n6.2 Creating the Dataset  \nNow a pressure head dataset must be created and saved in order to define the initial \nconditions. The path to this file wil l be provided by GMS to FEMWATER when the \nsimulation is launched.  \n1. Select FEMWATER | Initial Conditions\u2026  to open the FEMWATER Initial \nConditions  dialog.  \n2. In the Pressure head (ICH)  section, select Spatially variable. Read from dataset \nfile (1) , then click Generate IC\u2026  to bring up the Generate Pressure Head Initial \nCondition  dialog.  \n3. Select \u201cstartheads\u201d from the Active 2D scatter point set  drop-down.  \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 18 of 22 \u00a9 Aquaveo 2024  4. Enter \u201c -60.0\u201d  for the Minimum pressure head . \n5. Click OK to close the Generate Pressure Head Initial Condition  dialog and bring \nup the Select name and path of pressure head file  dialog.  \n6. Enter \u201c starthd.phd\u201d for the File name . \n7. Select \u201cFEMWATER Pressure Head Files (*.phd)\u201d from the Save as type  drop-\ndown.  \n8. Click  Save  to save the new pressure head file and close the Select name and \npath of pressure head file  dialog.  \n9. Click OK to exit the FEMWATER Initial Conditions  dialog.  \n7 Defining the Material Properties  \nThe final step in setting up the model is to define the material properties. A hydraulic \nconductivity value and a s et of unsaturated zone curves must be set for each aquifer. Do \nthe following to define the material properties for the aquifers:  \n1. Select Edit | Materials\u2026  to open the Materials dialog.  \n2. On the Upper Aquifer  row, enter \u201c3.0\u201d in the Kxx, Kyy and Kzz columns.  \n3. With any cell in the Upper Aquifer  row selected, click Generate Unsat Curves\u2026  \nto open the van Genuchten Curve Generator dialog.  \n4. Select \u201cvan Genuchten equations\u201d from the Curve type  drop-down.  \n5. Enter \u201c1.8\u201d for Max. height above water table . \n6. Select Preset par ameter values  and select \u201cSilt\u201d from the drop -down.  \n7. Click Compute Curves . Notice that there are three curves below that button \nnow.  \n8. Click OK to close the van Genuchten Curve Generator dialog.  \n9. On the Lower Aquifer  row, enter \u201c9.0\u201d in the Kxx, Kyy and Kzz columns.  \n10. With any cell in the Lower Aquifer  row selected, click Generate Unsat Curves\u2026  \nto open the van Genuchten Curve Generator dialog.  \n11. Accept the defaults and click Compute Curves  to generate the three curves.  \n12. Click OK to close the van Genuchten Curve Gene rator dialog.  \n13. Click OK to exit the Materials  dialog.  \n8 Saving and Running the Model  \nSave and run the model.  \n1. Save   the project.  \n2. Select FEMWATER | Run FEMWATER\u2026  to bring up the FEMWATER  model \nwrapper dialog.  \nThe FEMWATER window will display information about  the progress of the model \nconvergence. The model should converge within a few minutes.  \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 19 of 22 \u00a9 Aquaveo 2024  3. When the model converges, turn on Read solution on exit  and click Close  to exit \nthe FEMWATER  model wrapper dialog.  \n9 Viewing the Solution  \n9.1 Viewing Head Contours  \nFirst, view a color fringe plot.  \n1. Click Display Options   to open the Display Options dialog.  \n2. Select \u201c3D Mesh Data\u201d from the list on the left.  \n3. On the 3D Mesh  tab, in the lower section, turn on Contours . \n4. Click the Options\u2026  button next to Contours  to open the Datase t Contour \nOptions \u2013 3D Mesh \u2013 pressure_head dialog.  \n5. In the Contour method  section, change the color of the line to blue by selecting \nSingle color  from the second drop -down and then selecting \u201cBlue\u201d from the color \nlist on the right.  \n6. Click OK to exit the Dataset Contour Options \u2013 3D Mesh \u2013 pressure_head  dialog.  \n7. On the FEMWATER  tab, turn off Specified  head (DB1) . \n8. Click OK to close the Display Options dialog.  \n9. Make certain the \u201c  3D Mesh Data\u201d is turned on.  \n10. Rotate the image using the Rotate   tool. \nThe Graphics Window should appear similar to Figure 11. \n \n      Figure 11      Head contours marked in blue  \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 20 of 22 \u00a9 Aquaveo 2024  9.2 Viewing a Water Table Isosurface  \nAnother way to view the solution is to generate an isosurface at a pressure head  of zero. \nThis creates a surface matching the computed water table. Further, if capping the \nisosurface on the side greater than zero, a color -shaded image will appear of the \npressure variation in the saturated zone.  \n1. In the Project Explorer, expand the \u201c  femmod (FEMWATER)\u201d solution and \nselect the \u201c  pressure_head\u201d dataset to make it active.  \n2. Click Display Options   to open the Display Options dialog.  \n3. Select \u201c3D Mesh Data\u201d from the list on the left.  \n4. On the 3D Mesh  tab, in the upper section, turn off Element e dges . \n5. In the lower section, turn off Contours  and turn on Isosurfaces . \n6. Click the Options\u2026  button to the right of Isosurfaces  to open the Isosurface \nOptions dialog.  \n7. Below the first section, enter \u201c1\u201d for the Number of isosurfaces . \n8. In row 1 of the spreadshee t, enter \u201c0.0\u201d in the Upper Value  column.  \n9. On row 2, turn on Fill Between  in order to fill between \u201c 0.0\u201d and the maximum \nvalue.  \n10. In the section on the right, turn on Isosurface faces  and Contour specified range . \n11. Enter \u201c0.0\u201d for the Minimum value  and \u201c140.0\u201d for the Maximum value . \n12. Click OK to close the Isosurface Options dialog.  \n13. Click OK to exit the Display Options dialog.  \nThe Graphics Window should appear similar to Figure 12. \n \n      Figure 12      Water table isosurface  \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 21 of 22 \u00a9 Aquaveo 2024  9.3 Draping the TIFF Image on the Ground Surface  \nThe TIFF image can be draped on the terrain surface to illustrate the spatial relationship \nbetween the c omputed water table surface and the ground surface. To do this, first \nunhide the top TIN.  \n1. Turn on and expand the \u201c  terrain\u201d TIN in the Project Explorer.  \n2. Select the \u201c  z_idw_const\u201d dataset to make it active.  \nNext, set the option to map the TIFF image to the TIN when shaded.  \n3. Click Display Options   to open the Display Options dialog.  \n4. Select \u201cTIN Data\u201d from the list on the left.  \n5. On the TIN tab, in the top section, turn on Texture map image to active TIN . \n6. Click OK to close the Display Options  dialog.  \n7. Make ce rtain that \u201c   GIS Layers\u201d is turned on.  \n8. Use the Rotate   tool to click and drag horizontally to the left side of the screen \nuntil the other side of the model is visible ( Figure 13). \n \n Figure 13      TIFF image draped and the 3D mesh rotated  \nFinally, try the smooth shade option.  \n9. Click Display Options   to open the Display Options dialog.  \n10. Select \u201cLighting Options\u201d from the list on the left.  \n11. On the Lighting  tab, in the Surface attributes for all lights section, turn on Smooth \nedges . \n12. Click OK to close the Display Options dialog.  \nNotice that the water table isosurface contour is smoother now ( Figure 14). \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 22 of 22 \u00a9 Aquaveo 2024   \n     Figure 14      TIFF image draped and the 3D mesh rotated, with smoothing  \n10 Conclusion  \nThis concludes the \u201cFEMWATER \u2013 Flow Model\u201d tutorial. The foll owing concepts were \ndiscussed and demonstrated:  \n\uf0b7 FEMWATER is a 3D finite element model that is more complex than MODFLOW \n(which is a 3D finite difference model).  \n\uf0b7 How to create a FEMWATER conceptual model  \n\uf0b7 How to use a conceptual model to create a 3D finite e lement mesh using a 2D \nmesh, TINs, and scatter points.  \n\uf0b7 How to set up FEMWATER initial conditions.  \n \n \n\n", "filename": "FEMWATER-FlowModel.pdf", "pages": 22}, "FEMWATER-TransportModel": {"text": "GMS Tutorials   FEMWATER \u2013 Flow Model  \n Page 1 of 8 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nFEMWATER \u2013 Transport Model  \nBuild a FEMWATER model to simulate salinity intrusion  \n \nObjectives   \nThis tutorial demonstrates building a FEMWATER transport model using the conceptual model approach. \nIt will review running the model and examining the results.  \n \nPrerequisite Tutorials  \n\uf0b7 FEMWATER \u2013 Flow Model  \n Required Components  \n\uf0b7 FEMWATER  \n\uf0b7 Geostatistics  \n\uf0b7 GMS Core  \n\uf0b7 Subsurface  \n Time  \n\uf0b7 20\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n Page 2 of 8 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  3 \n2 Opening the Flow Model  ................................ ................................ ................................ ..... 3 \n3 Building the Transport Model  ................................ ................................ .............................  4 \n3.1 Turning on the Transport Option  ................................ ................................ ...................  4 \n3.2 Defining the Boundary Conditions  ................................ ................................ ................  4 \n4 Converting the Conceptual Model ................................ ................................ ......................  5 \n5 Selecting the Analysis Options  ................................ ................................ ..........................  5 \n5.1 Run Options  ................................ ................................ ................................ ..................  5 \n5.2 Time Control  ................................ ................................ ................................ .................  6 \n5.3 Initial Conditions  ................................ ................................ ................................ ...........  6 \n5.4 Output Control  ................................ ................................ ................................ ..............  6 \n6 Saving and Running the Model  ................................ ................................ ..........................  6 \n6.1 Animating the Fresh -water Surface  ................................ ................................ ..............  7 \n7 Conclusion  ................................ ................................ ................................ ...........................  8 \n \n1 Introduction  \nFEMWATER is a three -dimensional finite element groundwater model. It can be used to \nsimulate flow and transport in both the saturated and unsaturated zones. Furthermore, \nthe flow and transport can be coupled to simulate density dependent problems such as \nsalinity intrusion.  \nThe site to be modeled in this tutorial is a small coastal aquifer with three production \nwells, each pumping at a rate of 2,830 m3/day ( Figure 1). The no -flow boundary on the \nupper left corresponds to a parallel flow boundary and the no -flow boundary on the left \ncorresponds to a thinning of the aquifer due to a high bedrock elevation. A stream \nprovides a specified head boundary on the lower left and the remaining boundary is a \ncoastal boundary simulated with a specified head condition. The coastline arc is assigned \nwith a specified concentration boundary of 19 mg/lite r of salt.  \nThe stratigraphy of the site consists of an upper and lower aquifer. The upper aquifer has \na hydraulic conductivity of 3 m/day, and the lower aquifer has a hydraulic conductivity of \n9 m/day. The wells extend to the lower aquifer. The recharge to  the aquifer is about one \nfoot per year. The objective of this tutorial is to create a transport model of the site to \nsimulate salinity intrusion from the coast line.  \nThis tutorial describes how to build a FEMWATER model to simulate salinity intrusion. It \nwill discuss and demonstrate importing an existing FEMWATER flow model, mapping the \nconceptual model to a FEMWATER simulation, defining additional conditions and running \nFEMWATER, viewing the water table as an isosurface, and draping the TIFF image on \nthe ground surface.  \n \nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 3 of 8 \u00a9 Aquaveo 2024  \n \nProduction Wells  \nSpecified Head  \nBoundary  No Flow  \nBoundary  \nSpecified \nConcentration \nBoundary   \n      Figure 1      Site to be modeled with FEMWATER  \n1.1 Getting Started  \nDo the following to get started:  \n1. If GMS is not running, launch GMS.  \n2. If GMS is already running, select File | New to ensure the program settings are \nrestored to the default state.  \n2 Opening the Flow Model  \nBefore setting up the FEMWATER transport simulation, there must first be a \nFEMWATER solution that will be used as the flow field for the transport simulation. In the \ninterest of time, import a previously created FEMWATER simulation.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the femwater -transport \\femwater -transport  directory and select \n\u201cfemmod.g pr\u201d. \n4. Click Open  to import the project file and close the Open  dialog.  \n5. Frame   the project.  \nThe Main Graphics Window should appear similar to Figure 2. \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 4 of 8 \u00a9 Aquaveo 2024   \n      Figure 2      Initial view of the imported project  \n3 Building the Transport Model  \nThe purpose of this model is to simulate salinity intrusion by assigning a salt \nconcentration to the coastline arc. The concentration can be assigned directly to the arc \nin the conceptual model.  \n3.1 Turning on the Transport Option  \n1. In the Project Explorer, right -click on \u201c  Map Data\u201d and select Expand All . \n2. Right -click on \u201c  femmod\u201d  and select Properties\u2026  to open the Conceptual \nModel Properties  dialo g. \n3. In the table, turn on Transport . \n4. Click OK to exit the Conceptual Model Properties  dialog.  \n5. Right -click on \u201c  femwater\u201d and select Coverage Setup\u2026  to open the \nCoverage Setup dialog.  \n6. In the Sources/Sinks/BCs  list, turn on Transport BC . \n7. Click OK to close the Coverage Setup dialog.  \n3.2 Defining the Boundary Conditions  \nAssign boundary conditions to the coastline arc.  \n1. Select \u201c  femwater\u201d to make it active.  \n2. Using the Select Arcs   tool, double -click on the coastline arc to bring up the \nAttribute Table  dialog.  \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 5 of 8 \u00a9 Aquaveo 2024  3. In row 4 in the table, select \u201cspec. conc.\u201d from the drop -down in the Transport bc \ncolumn.  \n4. Enter \u201c19.0\u201d in the Conc . (mg/l)  column (scroll to the right, if needed).  \n5. Click OK to close the Attribute Table  dialog.  \n4 Converting the Conceptual Model  \nNow it is possible to convert the conceptual model to the 3D mesh model. This will assign \nall of the boundary conditions using the data defined in the feature objects.  \n1. In the Project Explorer, right -click on \u201c  femmod\u201d and select Map To  | \nFEMWATER  to bring  up the Map \u2192 Model  dialog.  \n2. Click OK to accept the defaults and close the Map \u2192 Model  dialog.  \nA set of symbols should appear indicating that the boundary conditions have been \nassigned ( Figure 3). \n \n      Figure 3      Coastline arc shows the boundary conditions  \n5 Selecting the Analysis Options  \nNext, select the analysis options.  \n5.1 Run Options  \nFirst, indicate a steady -state flow simulation . \n1. Select FEMWATER | Run Options\u2026  to open the FEMWATER Run Options \ndialog.  \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 6 of 8 \u00a9 Aquaveo 2024  2. Select \u201cTransport only (1)\u201d for the Type of simulation (OP1) . \n3. Select \u201cNodal/Nodal (11)\u201d  for Quadrature (IQUAR) . \n4. Click OK to close the FEMWATER Run Options dialog.  \n5.2 Time Control  \nSecond, set the FEMWATER time control options.  \n1. Select FEMWATER | Time Control\u2026  to open the FEMWATER Time Control \ndialog.  \n2. Enter \u201c360.0\u201d as the Maximum simulation time . \n3. Enter \u201c30.0\u201d as the Constant time step . \n4. Click OK to close the FEMWATER Time Contr ol dialog.  \n5.3 Initial Conditions  \nThird, set the FEMWATER initial conditions.  \n1. Select FEMWATER | Initial Conditions\u2026  to open the FEMWATER Initial \nConditions dialog.  \n2. In the Files  section, click the Open   button to the right of Flow (press. head) \n(FLPH)  to bring up the Open  dialog.  \n3. Select \u201cPressure Head Files (*.phd)\u201d from the Files of type  drop-down.  \n4. Browse to the femwater -transport \\femwater -transport \\femmod_FEMWATER  \ndirectory and select \u201cfemmod.phd\u201d.  \n5. Click Open  to select the file and exit the Open  dialog. \n6. In the section on the right, under Flow file format (IVFILE) , select Binary (1) . \n7. Click OK to close the FEMWATER Initial Conditions dialog.  \n5.4 Output Control  \nFourth and finally, have GMS create the concentration dataset solution file.  \n1. Select FEMWATER | Output Control\u2026  to open the FEMWATER Output Control \ndialog.  \n2. In the Save options (OC4)  section, turn on Save concentration (.con) file (5) . \n3. Click OK to close the FEMWATER Output Control dialog.  \n6 Saving and Running the Model  \nNow to save and run the model : \n1. Click Save   to save the project file with all of the new settings.  \n2. Select FEMWATER | Run FEMWATER\u2026  to bring up the FEMWATER  model \nwrapper dialog.  \nThe FEMWATER  model wrapper dialog should appear showing information on the \nprogress of the model convergence.  The model should converge within a few minutes.  \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 7 of 8 \u00a9 Aquaveo 2024  3. When the model converges, turn on Read solution on exit  and click Close  to \nclose the FEMWATER  model wrapper dialog.  \n6.1 Animating the Fresh -water Surface  \nNow to animate the fresh -water isosurface over time : \n1. Right-click on \u201c  3D Mesh Data\u201d and select Expand All . \n2. Select \u201c  concentration\u201d under \u201c  femmod (FEMWATER)\u201d.  \n3. Select Display | Animate\u2026  to bring up the Options  page of the Animation Wizard  \ndialog.  \n4. Click Next  to accept the defaults and go to the Datasets  page of  the Animation \nWizard  dialog.  \n5. Click Finish  to close the Animation Wizard  dialog and create the animation. This \nprocess may take a minute or so, depending on the speed of the computer.  \nOpen a media player application outside of GMS and open the MP4 file. No tice how the \nfreshwater surface is affected by the pumping wells ( Figure 4). When finished, close the \napplication and return to GMS.  \n \n      Figure 4      The last frame of the animation  \n  \n\nGMS Tutorials   FEMWATER \u2013 Flow Model  \n \n Page 8 of 8 \u00a9 Aquaveo 2024  7 Conclusion  \nThis concludes the \u201cFEMWATER \u2013 Flow Model\u201d tutorial. The following key topics were \ndiscussed and demonstrated:  \n\uf0b7 FEMWATER is a 3D finite element model that is more complex than MODFLOW \n(which is a 3D finite difference model).  \n\uf0b7 Setting up a FEMWATER transport model  \n \n", "filename": "FEMWATER-TransportModel.pdf", "pages": 8}, "Geostatistics-2D": {"text": "GMS Tutorials   Geostatistics \u2013 2D  \n Page 1 of 17 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nGeostatistics \u2013 2D \nLearn the various 2D interpolation methods available in GMS  \n \nObjectives   \nThis tutorial introduces GMS and covers the basic  elements of the user interface. It is the first tutorial that \nnew users should complete.  \nPrerequisite Tutorials  \n\uf0b7 None  Required Components  \n\uf0b7 GMS Basic  \n\uf0b7 Geostatistics  \n Time  \n\uf0b7 30\u201345 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   Geostatistics \u2013 2D  \n Page 2 of 17 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Creating a Scatter Point Set  ................................ ................................ ...............................  2 \n3 Importing a Scatter Point Set  ................................ ................................ .............................  3 \n3.1 Open the File  ................................ ................................ ................................ ................  3 \n3.2 Import Wizard  ................................ ................................ ................................ ...............  3 \n3.3 Changing  the Display Options  ................................ ................................ ......................  5 \n3.4 Creating a Bounding Grid  ................................ ................................ .............................  6 \n4 Selecting an Interpolation Scheme  ................................ ................................ ....................  7 \n4.1 Linear Interpolation  ................................ ................................ ................................ ....... 7 \n4.2 Simple IDW Interpolation  ................................ ................................ ..............................  9 \n4.3 Kriging  ................................ ................................ ................................ ........................  14 \n5 Switching Datasets  ................................ ................................ ................................ ............  16 \n6 Using the Data Calculator  ................................ ................................ ................................ . 16 \n7 Conclusion  ................................ ................................ ................................ .........................  17  \n1 Introduction  \nTwo-dimensional geostatistics (interpolation) can be performed in GMS using the 2D \nScatter Point  module. The module is used to interpolate from sets of 2D scatter points to \nany of the other object types (meshes, grids, TINs). Several interpolation schemes are \nsupported, including kriging . Geostatistics are useful for setting up input data for analysi s \ncodes or for site characterization.  \nThe tools for manipulating scatter point sets and the interpolation schemes supported in \nGMS are demonstrated and discussed in this tutorial. This includes how to create a \nscatter point set from scratch, how to import scatter points from a file, creating a \nbounding grid, interpolating the scatter points using various interpolation methods, and \nusing the data calculator to compare interpolations. The interpolation schemes presented \nin this tutorial are defined in the Interpolation  section of the GMS Online Help . \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select the File | New command to ensure that the \nprogram settings are restored to their default state.  \n2 Creatin g a Scatter Point Set  \nInterpolation in GMS is performed using scatter points. A set of 2D scatter points is \ndefined by a set of xy coordinates. A group of scatter points is called a scatter point set. \nEach scatter point set may also have a dataset associat ed with it. Datasets are scalar or \nvector values \u2014one value at each scatter point.  \nThe scatter points represent the geometric objects while the datasets represent the data \nvalues at the points. The datasets may represent anything: elevation, heat \nmeasureme nts, concentration of a chemical, etc. The datasets can be interpolated to a \nTIN, mesh, or grid.  \nThe Create Scatter Points   tool is used to create 2D scatter point sets in GMS by \nusing the following steps:  \n\nGMS Tutorials   Geostatistics  \u2013 2D \n \n Page 3 of 17 \u00a9 Aquaveo 2024  1. Right -click on an empty space in the Project Exp lorer and select New | 2D \nScatter Point Set .  \nA new \u201c  set (1)\u201d scatter set will appear.  \n2. Using the Create Scatter Points   tool, create a number of new scatter points \nby clicking several times in the Graphics Window.  \nWhen creating each point, GMS automatically assigns a dataset value at the point. The \nsettings can be changed so that GMS gives a prompt for the dataset values.  \n3. Select Scatter Points | Scatter Point Settings\u2026  to bring up the Preferences  \ndialog. Notice that \u201cScatter sets\u201d is selected in  the list on the left.  \n4. In the 2D scatter  section, turn on Confirm dataset value  and click OK to close the \nPreferences  dialog.  \n5. Click anywhere in the Graphics Window to create a new scatter point and bring \nup the Scatter Point Dataset Value  dialog.  \nThis dialog will appear each time a new scatter point is created to allow the value to be \nverified or changed.  \n6. Click OK to exit the Scatter Point Dataset Value  dialog.  \nThe Create Scatter Points  tool only enters steady state data, which could also be \nimported fr om a file. To create a scatter point set with transient data, it must be imported \nfrom a file.  \n3 Importing a Scatter Point Set  \nScatter point sets can be imported from an existing file using the Text Import Wizard  \ndialog . This dialog allows importing data in to GMS from text files that are in columnar \nformat. The file to be imported here was generated as an Excel spreadsheet and \nexported from Excel as tab -delimited text. The file contains scatter points which represent \nlocations where the concentration of a co ntaminant has been estimated using a soil gas \nsurvey. The goal is to generate a map of the contaminant plume.  \n3.1 Open the File  \n1. Click New  to reset GMS, and select No when prompted to save changes.  \n2. Click Open   to bring up the Open  dialog.  \n3. Select \u201cText Files (*.txt,*.csv)\u201d from the Files of type  drop-down.  \n4. Browse to the geos2d  directory and select \u201cplumedat.txt\u201d.  \n5. Click Open  to close the Open  dialog and bring up the Step 1 of 2  page of the \nText Import Wizard  dialog.  \n3.2 Import Wizard  \nThe first st ep of the Text Import Wizard  dialog specifies how the data is delineated and \nwhere in the file the data should begin. For this file, the first row contains column \n\nGMS Tutorials   Geostatistics  \u2013 2D \n \n Page 4 of 17 \u00a9 Aquaveo 2024  headings. The first column contains the point labels, the second column contains the X \nvalues  of the points, the third column contains the Y values, and the fourth column \ncontains the dataset values for the points.  \n1. Below the File import options  section, turn on Heading row option (red arrow, \nFigure 1) and click Next  to go to the Step 2 of 2  page of the Text Import Wizard  \ndialog.  \n \n      Figure 1      Text Import Wizard with Heading row selected  \nThis page of the Text Import Wizard  allows specifying the meaning of the data in the file.  \n2. Select \u201c2D Scatter Points\u201d from the GMS data type  drop-down.  \nThe data associated with 2D scatter points is now displayed in the File preview  section. \nThe next step is to tell GMS what eac h column in the file means. This is done by \nselecting the correct data type using the drop -downs in the Type  row (the first row) of the \nspreadsheet for each column in the file. The options in the drop -downs change \ndepending on the selected GMS data type . Since the use of a heading row was specified \nin the first step, GMS looked at the headings and automatically found and mapped the X \nand Y columns by selecting the X and Y selection in the Type  row of the spreadsheet.  \n3. Select \u201cLabel\u201d from the Type  row drop -down in the first column.  \n4. Select \u201cDataset\u201d from the Type  row drop -down  in the fourth column.  \nThe dataset in this file represents concentrations of a contaminant. The No data  option \nnear the top of the dialog can be used to specify a key value in the file used to indicate a \nlack of information.  \nFor example, if no measurement was taken at one of the points, entering \u201c -999\u201d as the \nNo data  value in the Text Import Wizard  would t ell GMS to ignore these points when \ndoing the interpolation later. The key value can be any value that would not normally be \nencountered in the dataset. In this case, this option isn\u2019t needed.  \nThe dialog should now appear as in Figure 2.  \n5. Click Finish  to close the Text Import Wizard  dialog. A set of points should appear \non the screen.  \n\nGMS Tutorials   Geostatistics  \u2013 2D \n \n Page 5 of 17 \u00a9 Aquaveo 2024   \n      Figure 2      Text Import Wizard dia log, Step 2  \n3.3 Changing the Display Options  \nChange the appearance of the scatter points using the Display Options  dialog:  \n1. Click Display Options   to bring up the Display Options  dialog.  \n2. Select \u201c2D Scatter Data\u201d from the list on the left.  \n3. On the 2D Scatter Point Set  tab, turn on Scatter point symbols and Contours . \n4. Click OK to exit the Display Options  dialog.  \nEach of the points should now be displayed as a colored square ( Figure 3). The color of \nthe symbol represents the relative concentration of the contaminant at the point. When \ndisplaying colored symbols, it is useful to also display a color legend.  \n \n      Figure 3      Scatter  points with contour colors  \n1. Click Display Options   to bring up the Display Options  dialog.  \n\nGMS Tutorials   Geostatistics  \u2013 2D \n \n Page 6 of 17 \u00a9 Aquaveo 2024  2. Select \u201c  2D Scatter Data\u201d from the list on the left.  \n3. On the 2D Scatter Point Set  tab, click the Options\u2026  button to the right \nof Contours  to bring up the Dataset Contour Options \u2013 2D Scatter \nPoints - c dialog.  \n4. At the bottom left, turn on Legend  and click OK to close the Dataset \nContour Options \u2013 2D Scatter Points - c dialog.  \n5. Click OK to exit the Display Options dialog.  \nNotice that the concentrations vary from 0.0 to about 100.0 (see figure to right).  \n3.4 Creating a Bounding Grid  \nThe goal of this tutorial is to generate a series of contour plots illustrating the plume. It is \nfirst necessary to create a grid that bounds the scatter point set. This allows interpolating \nthe concentrations from the scatter points to the grid nodes. The grid is then contoured.  \n1. Right -click on \u201c  plumedat\u201d and select Bounding 2D Grid\u2026  to bring up the \nCreate Finite Difference Grid dialog . \nThe x and y dimensions of this grid are already defined. The default values shown in the \ndialog cause the grid to extend beyond the scatter points by 10% on each side.  \n2. In the X-Dimension  section, enter \u201c 60\u201d for the Number of cells . \n3. In the Y-Dimension  section, enter \u201c 40\u201d for the Number of cells . \n4. Click OK to close the Create Finite Difference Grid dialog.  \n5. Frame   the project . \nA grid should appear on the screen that encompasses only the scatter point set ( Figure \n4). \n \n      Figure 4      The grid encompassing the scatter points  \n\nGMS Tutorials   Geostatistics  \u2013 2D \n \n Page 7 of 17 \u00a9 Aquaveo 2024  4 Selecting an Interpolation Scheme  \nSeveral interpolation schemes are supported in GMS because each has different \nstrengths in different situations. Typicall y, the best approach is to try several schemes \nand then determine which scheme is giving the most reasonable results. GMS has been \nstructured in such a way that multiple schemes can be tested quickly and easily.  \n4.1 Linear Interpolation  \nDo the following to try  simple linear interpolation:  \n1. Select Interpolation  | Interpolation Options\u2026  to bring up the 2D Interpolation \nOptions dialog . \n2. In the Interpolation method  section, select the Linear  option.  \n3. Click OK to close the 2D Interpolation Options dialog.  \nTo interpolate to the grid, do the following:  \n4. Select Interpolation | Interpolate \u2192 2D Grid  to bring up the Interpolate \u2192 Object \ndialog.  \n5. Click OK to accept the defaults and close the Interpolate \u2192 Object dialog.  \nA series of contour lines will appear within th e grid ( Figure 5). \n \n      Figure 5      Contour lines after linear interpolation  \nViewing the Results  \nThe contours show that the concentrations have been interpolated to the grid.  \n1. Switch to Oblique View . \nNotice that the grid has been deformed to match the contours ( Figure 6). Color shading \nthe entire surface can provide an even more effective display of the grid.  \n\nGMS Tutorials   Geostatistics  \u2013 2D \n \n Page 8 of 17 \u00a9 Aquaveo 2024   \n      Figure 6      Oblique view  \n1. Click Display Options   to bring up the Display Options  dialog.  \n2. Select \u201c  2D Grid Data\u201d from the list on the left.  \n3. On the 2D Grid  tab, in the lower section, turn on Contours  and click Options...  to \nbring up the Dataset Contour Options \u2013 2D Grid \u2013 c_linear dialog.  \n4. In the Contour method  section, s elect \u201cColor Fill\u201d from the drop -down.  \n5. Click OK to close the Dataset Contour Options \u2013 2D Grid \u2013 c_linear dialog.  \n6. Click OK to exit the Display Options dialog.  \nThe 2D grid should appear similar to Figure 7. \n \n      Figure 7      Linear interpolation with color fill  \nThe outer part of the grid still has a concentration value equal to zero, as indicated by the \nflat, dark b lue contour coloring. When linear interpolation is performed, the scatter points \n\nGMS Tutorials   Geostatistics  \u2013 2D \n \n Page 9 of 17 \u00a9 Aquaveo 2024  are triangulated to form a temporary TIN. A plane equation is computed for each triangle \nin the TIN and the coefficients of the plane equation are used to interpolate to point s \ninside the triangle.  \nTherefore, linear interpolation cannot be performed for grid nodes outside the convex hull \nof the TIN (the boundary of the TIN). As a result, these nodes are assigned a value of \nzero. A value of zero is appropriate in this case sinc e the concentrations of the scatter \npoints on the perimeter of the scatter point set are zero.  \nViewing the Elliptical Control Function  \nThe scatter points were generated from an elliptical control function. This shows how the \ndifferent interpolation schemes  compare to the original control function. To view the \noriginal control function:  \n1. Right -click on \u201c  grid\u201d in the Project Explorer and select Import Dataset\u2026  to \nbring up the Dataset Filename dialog.  \n2. Select \u201cAll Files (*.*)\u201d from the Files of Type  drop-down.   \n3. Browse to the geos2d  directory and select \u201cellipse2g.dat\u201d.  \n4. Click Open  to import the dataset and close the Dataset Filename dialog.  \n5. Select the \u201c  control_function\u201d dataset in the Project Explorer to make it active.  \nThe Graphics Window should appear similar to Figure 8. \n \n      Figure 8      Interpolation scheme with original control function  \n4.2 Simple IDW Interpolation  \nThe next scheme to try is a simple form of inverse distance weighted ( IDW) interpolation.  \n1. Select \u201c  2D Scatter Data\u201d in the Project Explorer to make it active.  \n2. Select Interpolation  | Interpolation Options  to bring up the 2D Interpolation \nOptions  dialog.  \n3. In the Interpolation method section, select Inverse distance weighted . \n\nGMS Tutorials   Geostatistics  \u2013 2D \n \n Page 10 of 17 \u00a9 Aquaveo 2024  4. Click Options\u2026  to bring up the 2D IDW Interpolation Options  dialog.  \n5. In the Nodal function  section , select Constant  (Shepard\u2019s method) . \n6. Click OK to exit the 2D IDW Interpolation Options  dialog.  \n7. Click OK to exit the 2D Interpolation Options  dialog.  \n8. Select Interpolation | Interpolate \u2192 2D Grid  to bring up the Interpolate \u2192 Object \ndialog.  \n9. Click OK to acce pt the defaults and close the Interpolate \u2192 Object dialog.  \nThe Graphics Window should appear similar to Figure 9. \n \nFigure 9      Inverse distance weighted (IDW) interpolation  \nThe IDW scheme is a simple moving weighted averages scheme. To interpolate a value \nat a point, a weighted average of the nearby scatter points is used. The weights are an \ninverse function of distance. The  closer a scatter point is to the interpolation point, the \ngreater the weight given to the scatter point.  \nIDW Interpolation with Gradient Planes  \nOne of the problems with simple IDW interpolation is that the interpolated dataset always \ntends toward the mean  of the dataset in the voids between scatter points. As a result, \nlocal minima or maxima in the voids in the scatter point set are not properly inferred. To \novercome this problem, a nodal function can be computed at each scatter point.  \nA nodal function is  a plane or quadratic function that is forced to pass through the scatter \npoint and approximate the nearby scatter points in a least squares sense. When the \ninterpolation is performed, rather than computing an average of the dataset values at the \nscatter p oint locations, an average is computed of the nodal functions of the nearby \nscatter point evaluated at the interpolation point. This approach allows local trends to be \ninferred and often results in a more accurate interpolation.  \nThis is demonstrated throug h the following steps:  \n1. Select \u201c  2D Scatter Data\u201d in the Project Explorer to make it active.  \n2. Select Interpolation  | Interpolation Options\u2026  to bring up the 2D Interpolation \nOptions  dialog.  \n\nGMS Tutorials   Geostatistics  \u2013 2D \n \n Page 11 of 17 \u00a9 Aquaveo 2024  3. In the Interpolation method  section, click Options\u2026  to bring up the 2D IDW \nInterpolation Options  dialog.  \n4. In the Nodal function  section, select the Gradient plane  option.  \n5. Click OK to exit the 2D IDW Interpolation Options  dialog.  \n6. Click OK to exit the 2D Interpolation Options  dialog.  \n7. Select Interpolation | Interpolate \u2192 2D Gr id to bring up the Interpolate \u2192 Object \ndialog.  \n8. Click OK to accept the defaults and close the Interpolate \u2192 Object dialog.  \nThe Graphics Window should appear similar to Figure 10.  \n \n      Figure 10 IDW interpolation with gradient planar nodal functions  \nUsing the Horizontal Anisotropy Option  \nThe interpolation can be stretched in a horizontal d irection by using the horizontal \nanisotropy option in conjunction with a specified azimuth. One reason for using this \noption might be if it is known that a contaminant plume is elongated in a particular \ndirection due to groundwater flow.  \nDo the following t o change the horizontal anisotropy:  \n1. Switch to Plan View  . \n2. Select \u201c  2D Scatter Data\u201d in the Project Explorer to make it active.  \n3. Select Interpolation  | Interpolation Options\u2026  to bring up the 2D Interpolation \nOptions dialog . \n4. In the Anisotropy  section, enter \u201c2.0\u201d for the Horizontal  anisotropy . \n5. Enter \u201c90.0\u201d for the Azimuth . \n6. Click OK to close the 2D Interpolation Options dialog.  \n7. Select Interpolation | Interpolate \u2192 2D Grid  to bring up the Interpolate \u2192 Object \ndialog.  \n\nGMS Tutorials   Geostatistics  \u2013 2D \n \n Page 12 of 17 \u00a9 Aquaveo 2024  8. Enter \u201c c_idw_grad_h2\u201d  for th e Interpolated dataset name.  \n9. Click OK to close the Interpolate \u2192 Object dialog.  \nAs can be seen in Figure 11, the data has been stretched horizontally. If desired, \nexperiment with different values for the horizontal anisotropy.  \n \n      Figure 11      Horizontal anisotropy  \nIDW Interpolation with Quadratic Nodal Functions  \nThe nodal functions used in IDW interpolation can also be qua dratic functions which are \nconstrained to pass through the scatter point and approximate the neighboring scatter \npoints in a least -squares fashion. The averaging or blending of the quadratic functions \nduring the interpolation stage often results in a very smooth surface.  \n1. Switch to Oblique View  . \n2. Select Interpolation  | Interpolation Options\u2026  to bring up the 2D Interpolation \nOptions dialog . \n3. In the Interpolation method  section, click the Options\u2026  button to bring up the 2D \nIDW Interpolation Options  dialog.  \n4. In the Nodal function  section, select the Quadratic  option.  \n5. Click OK to exit the 2D IDW Interpolation Options  dialog.  \n6. Click OK to exit the  2D Interpolation Options  dialog.  \n7. Select Interpolation | Interpolate \u2192 2D Grid  to bring up the Interpolate \u2192 Object \ndialog.  \n8. Click OK to accept the defaults and close the Interpolate \u2192 Object dialog.  \nThe Graphics Window should appear similar to Figure 12. \n\nGMS Tutorials   Geostatistics  \u2013 2D \n \n Page 13 of 17 \u00a9 Aquaveo 2024   \n      Figure 12      Quadratic nodal functions  \nTruncation  \nNotice that the minimum value listed in the color legend is a negative number. This is \nimpossible since there is no such thing as a negative concentration. By inferring trends, \nthe no dal functions can sometimes project the plume values beyond zero and into the \nnegative range. This type of error can be easily fixed using truncation.  \n1. Select Interpolation  | Interpolation Options\u2026  to bring up the 2D Interpolation \nOptions dialog.  \n2. In the low er right section, turn on Truncate values . \n3. Select Truncate to specified range,  then enter \u201c 0.0\u201d for Min and \u201c 150.0\u201d  for Max. \n4. Click OK to close the 2D Interpolation Options dialog.  \nThe concentrations should not go below zero, but it is okay to allow the interpolation \nscheme to infer a maximum concentration greater than the maximum measured value.  \n5. Select Interpolation | Interpolate \u2192 2D Grid  to bring up the Interpolate \u2192 Object \ndialog.  \n6. Enter \u201c c_idw_quad_trunc\u201d  for the Interpolated dataset name . \n7. Click OK to close the Interpolate \u2192 Object dialog.  \nNotice that many of the concentrations around the perimeter of the map are now zero \n(Figur e 13). \n\nGMS Tutorials   Geostatistics  \u2013 2D \n \n Page 14 of 17 \u00a9 Aquaveo 2024   \n      Figur e 13      Truncated quadratic nodal functions  \n4.3 Kriging  \nThe last interpolation scheme to test is kriging. Kriging is based on the assumption that \npoints near each other have a certain degree of spatial correlation, but points that are \nwidely separated are statistically independent. Kriging is a set of linear regression \nroutines that minimizes estimation variance from a predefined covariance model.  \n1. Select Interpolation  | Interpolation Options\u2026  to bring up the 2D Interpolation \nOptions dialog.  \n2. In the Interpolation method section, select Kriging . \n3. Click the Options\u2026  button to bring up the Kriging Options dialog.  \nCreating the Experimental Variogram  \nThere are a large number of options to be specified in the Kriging O ptions  dialog. While a \nvariogram must always be defined, the defaults shown are adequate in most cases.  \n1. Click Edit Variograms\u2026  to bring up the Variogram Editor  dialog . \n2. In the Experimental variogram  section, click the New button to bring up the \nExperimental  Variogram dialog  . \n3. Click OK to accept the defaults and close the Experimental Variogram dialog.  \nA curve should appear in the upper window of the Variogram Editor  (Figure 14). This \ncurve is called an experimental variogram. The experimental variogram is found by \ncalculating the variance in dataset values of each scatter point in the set with respect to \neach of the other points and plotting the variances versus the distance bet ween the \npoints.  \n\nGMS Tutorials   Geostatistics  \u2013 2D \n \n Page 15 of 17 \u00a9 Aquaveo 2024   \n      Figure 14      The experimental variogram curve in the Variogram Editor dialog  \nAs can be seen in the plot of the experimental variogram, the shape of the variogram \nindicates that the variance is smaller at  short separation distances. In other words, points \nthat are close together have similar data values. The variance in the data values with \nmany datasets becomes somewhat random after a certain level of separation. The \nvariogram also oscillates around a val ue corresponding to the average variance. \nHowever, many of the points have zero values with concentration data and this tends to \npull the experimental variogram back down.  \nCreating the Model Variogram  \nOnce the experimental variogram is computed, the next s tep is to define a model \nvariogram. A model variogram is a simple mathematical function that models the trend in \nthe experimental variogram. The model variogram is used in the kriging computations.  \n1. In the Nested structure  section of  the Variogram Editor dialog, click the New \nbutton.  \nA red model variogram will appear in the variogram.  \n2. Select \u201c Gaussian\u201d from the  Model function  drop-down.  \nThe red variogram will change slightly.  \n3. Enter \u201c 25.0\u201d  in the field to the right of the Nugget  slider.  \n4. Enter  \u201c1965.0\u201d  in the field to the right of the Contribution  slider.  \n5. Enter \u201c 63.0\u201d  in the field to the right of the Range  slider .  \nAt this point, a reasonable fit should exist between the model variogram and the left half \nof the initial variogram. The right half is diffi cult to fit because of the zero values used in \nthis case.  \n6. Click OK to exit the Variogram Editor  dialog . \n7. Click OK to exit the Kriging Options  dialog.  \n8. Click OK to exit the 2D Interpolation Options  dialog.  \n9. Select Interpolation | Interpolate \u2192 2D Grid  to bring up the Interpolate \u2192 Object \ndialog.  \n10. Click OK to accept the defaults and close the Interpolate \u2192 Object dialog.  \nAs seen in Figure 15, notice t hat this interpolation scheme results in an upward curvature \ntowards the outside edges of the grid. This can be corrected by adding more scatter \npoints with a concentration of \u201c0.0\u201d in these outlying areas.  \n\nGMS Tutorials   Geostatistics  \u2013 2D \n \n Page 16 of 17 \u00a9 Aquaveo 2024   \n      Figure 15      Model variogram based on kriging interpolation  \n5 Switching Datasets  \nNow that the grid has been interpolated using several different interpolation schemes, \nreview the results by replotting some of the interpolated datasets. To do this, switch back \nto on e of the previous datasets using the  Project Explorer . \n1. Switch to Plan View  . \n2. Select the \u201cc_linear\u201d dataset under \u201c  grid\u201d in the \u201c  2D Grid Data\u201d folder in the \nProject Explorer . \n3. Use the Up and Down  keys to switch between the datasets. Notice the \ndifferenc es in the contours for each dataset.  \n6 Using the Data Calculator  \nThe Data Calculator   tool can be useful when  comparing two datasets generated by \ninterpolation. Use the Data Calculator  to compute the difference between the kriging and \nIDW quadratic datasets by doing the following:  \n1. Click Data Calculator   to bring up the Data Calculator  dialog.  \nThe available datasets are listed in the Datasets  section, where they are numbered from \n\u201cd1\u201d t o \u201cd10\u201d. Datasets are referenced in the mathematical expression using the \u201cd\u201d \nnumbers. The \u201cc_krig\u201d dataset should be numbered \u201cd10\u201d and the \u201cc_idw_quad\u201d dataset \nshould be labeled \u201cd7\u201d.  \n2. In the Expression  field, enter \u201c abs(d7 -d10)\u201d. \n3. In the Result  field, ent er \u201cDifference \u201d. \n4. Click Compute  to perform the calculation and create a new \u201cDifference\u201d dataset \nin the Project Explorer. It will also appear in the Datasets  section as entry \u201cd11\u201d.  \n\nGMS Tutorials   Geostatistics  \u2013 2D \n \n Page 17 of 17 \u00a9 Aquaveo 2024  This computes the difference between the two datasets. Any new dataset comp uted \nusing the Data Calculator  is automatically designated the active dataset. With that \ncalculation completed, it is helpful to view some basic statistics related to the new \ndataset.  \n5. Click Dataset Info\u2026  to bring up the Dataset Info dialog.  \nThis dialog dis plays basic statistics related to the selected dataset such as minimum, \nmaximum, and mean data values. Feel free to review the statistics.  \n6. Click OK to exit the Dataset Info  dialog.  \n7. Click Done  to exit the Data Calculator  dialog.  \n8. Switch to Oblique View  . \nThe contour plot now displayed represents the \u201c  Difference\u201d dataset that was just \ncomputed ( Figure 16).  \n \n      Figure 16      Difference contour in oblique view  \n7 Conclusion  \nThis concludes the \u201cGeostatistics \u2013 2D\u201d tutorial. Key concepts demonstrated and \ndiscussed in this tutorial include the following:  \n\uf0b7 Interpolating from a sparse set of points to a different set of points (usua lly more \ndense and surface -defining points) by using 2D scatter points.  \n\uf0b7 2D scatter points can be created manually or by importing them from a file.  \n\uf0b7 Several interpolation algorithms are available in GMS.  \n\uf0b7 Linear algorithms do not interpolate beyond the conve x hull of the scatter points.  \n\uf0b7 Anisotropy and truncation can be used to help control the interpolation process.  \n \n \n\n", "filename": "Geostatistics-2D.pdf", "pages": 17}, "Geostatistics-3D": {"text": "GMS Tutorials   Geostatistics \u2013 3D \n Page 1 of 14 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nGeostatistics \u2013 3D \nLearning the various 3D interpolation methods available in GMS  \n \nObjectives   \nExplore the various 3D interpolation algorithms available in GMS, including IDW and kriging. Visualize the \nresults of interpolation though cross sections and isosurfaces.  \n \nPrerequis ite Tutorials  \n\uf0b7 Geostatistics \u2013 2D \n Required Components  \n\uf0b7 Geostatistics  \n\uf0b7 GMS Basic  \n Time  \n\uf0b7 30\u201345 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   Geostatistics \u2013 3D \n Page 2 of 14 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Importing a Scatter Point Set  ................................ ................................ .............................  2 \n3 Display Data Colors  ................................ ................................ ................................ .............  3 \n4 Z Magnification  ................................ ................................ ................................ ....................  4 \n5 Creating a Bounding Grid  ................................ ................................ ................................ ... 4 \n6 Simple IDW Interpolation  ................................ ................................ ................................ .... 5 \n7 Displaying Isosurfaces  ................................ ................................ ................................ ........  6 \n7.1 Interior Edge Removal  ................................ ................................ ................................ .. 7 \n7.2 Specified Range  ................................ ................................ ................................ ...........  7 \n7.3 Using the Vertical Anisotropy Option  ................................ ................................ ............  7 \n8 Interpolation  ................................ ................................ ................................ .........................  9 \n8.1 IDW Interpolation with Gradient Planes  ................................ ................................ ........  9 \n8.2 IDW Interpolation with Quadratic Functions  ................................ ................................ .. 9 \n8.3 Other Interpolation Schemes  ................................ ................................ ......................  10 \n9 Viewing the Plumwe with a Cross Section  ................................ ................................ ...... 10 \n9.1 Using the Truncation Option  ................................ ................................ .......................  11 \n10 Setting up a moving Cross Section Animation  ................................ ...............................  12 \n10.1  Display Options  ................................ ................................ ................................ ...........  12 \n10.2  Setting Up and Playing the Animation  ................................ ................................ ........  13 \n11 Setting up a Moving Isosurface Animation  ................................ ................................ ..... 13 \n12 Conclusion  ................................ ................................ ................................ .........................  14 \n \n1 Introduction  \nThree -dimensional geostatistics (interpolation) can be performed in GMS using the 3D \nScatter Point module. The module is used to interpolate from sets of 3D scatter points to \n3D meshes and 3D grids. Several interpolation schemes are supported, including kriging. \nInterpolati on is useful for defining initial conditions for 3D ground water models or for 3D \nsite characterization.  \nThis tutorial describes and demonstrates the tools for manipulating 3D scatter point sets \nand the interpolation schemes supported in GMS. This includes  importing a scatter point \nset, creating a bounding grid, creating isosurfaces by interpolating scatter points to a 3D \ngrid using different interpolation methods, creating cross sections, making a moving cross \nsection animation, and making a moving isosurf ace animation.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2 Importing a Scatter Point Set  \nIt is first neces sary to import a 3D scatter point set. These are similar to 2D scatter point \nsets except that each point has a z coordinate (elevation) in addition to xy coordinates. \nAs with the 2D scatter point set, one or more scalar datasets can be associated with each  \nscatter point set. These can represent values such as contaminant concentration, \nporosity, hydraulic conductivity, and so on.  \nThe 3D scatter point set that will be imported and used with this tutorial has previously \nbeen exported to a text file using a s preadsheet application. The file was imported into \nGMS Tutorials   Geostatistics \u2013 3D \n \n Page 3 of 14 \u00a9 Aquaveo 2024  GMS using the Import Wizard , and then saved as a GMS project file. Refer to the \n\u201cGeostatistics \u2013 2D\u201d tutorial for details on using the Import Wizard.  \nTo import the project, do as follows:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cAll Files (*.*)\u201d from the Files of type  drop-down.  \n3. Browse to the geos3d  directory and select \u201ctank.gpr\u201d.  \n4. Click Open to import the project and close the Open  dialog.  \n5. Switch to Oblique View  . \nA set of points should appear on the screen ( Figure 1). \n \n      Figure 1      Oblique view of set of contaminant concentration points  \nNotice that the points  are arranged in vertical columns ( Figure 1). This hypothetical set of \npoints represents a set of measurements of contaminant concentration in the vici nity of a \nleaky underground storage tank. Each column of points corresponds to a borehole or the \npath of a penetrometer along which concentrations were measured at uniform intervals. \nThe goal of the tutorial is to use the tools for 3D geostatistics in GMS to interpolate from \nthe scatter points to a grid and generate a graphical representation of the plume.  \n3 Display Data Colors  \nNext, it is necessary to change the display options so that the color of each point is \nrepresentative of the concentration at that po int. \n1. Click Display Options   to bring up the Display Options  dialog.  \n2. Select \u201c3D Scatter Data\u201d item in the list on the left.  \n3. On the 3D Scatter Point Set  tab, turn on Contours . \n4. Click the Options\u2026  button to the right of Contours to bring up the Dataset \nContour Options \u2013 3D Scatter Points \u2013 c dialog.  \n5. At the bottom left of the dialog, turn on Legend . \n6. Click OK to exit the Dataset Contour Options \u2013 3D Scatter Points \u2013 c dialog.  \n\nGMS Tutorials   Geostatistics \u2013 3D \n \n Page 4 of 14 \u00a9 Aquaveo 2024  7. Click OK to exit the Display Options dialog.  \nNotice that most of the valu es are zero ( Figure 2). The nonzero values are all at about \nthe same depth in the holes. This pattern is fairly common when dealing with light non -\naque ous phase liquids (LNAPLs) that form a pancake -shaped plume and float on the \nwater table.  \n \n      Figure 2      Contaminant concentrations shown with contour coloring  \n4 Z Mag nification  \nIt is necessary to magnify the z coordinate so t hat the vertical variation in the data is \nmore apparent.  \n1. Click Display Options   to bring up the Display Options  dialog.  \n2. Below the list on the left, enter \u201c2.0\u201d for Z magnification . \n3. Click OK to close the Display Options  dialog.  \n4. Frame   the project.  \n5 Creating a Bounding Grid  \nTo generate a graphical representation of the contaminant plume, first create a grid that \nbounds the scatter point set. It will then be possible to interpolate the data from the \nscatter points to the grid nodes. The grid will be us ed to generate isosurfaces.  \nDo the following to create the grid:  \n1. In the Project Explorer, expand all of the entries.  \n2. Right -click on \u201c  tank.sp3\u201d and select Bounding 3D Grid\u2026  to bring up the \nCreate Finite Difference Grid  dialog.  \nNotice that the x, y, and z dimensions of the grid are already defined. The default values \nshown in the dialog cause the grid to extend beyond the scatter points by 10% on each \nside. Default values have also been entered for the number of cells in each direction.  \n\nGMS Tutorials   Geostatistics \u2013 3D \n \n Page 5 of 14 \u00a9 Aquaveo 2024  3. In the Orientatio n / type  section, select \u201c Mesh Centered\u201d from the Type  drop-\ndown . \nTwo types of grids are supported in GMS: cell -centered and mesh -centered. While cell -\ncentered is appropriate for groundwater models (MODFLOW), the mesh -centered \napproach is more appropriate when the grid will be used solely for interpolation.  \n4. Click OK to close the Create Finite Difference Grid  dialog.  \n5. Frame   the project.  \nA 3D bounding grid encompassing the scatter point set should appear ( Figure 3). \n \n      Figure 3      The 3D bounding grid  \n6 Simple IDW Interpolation  \nAn interpolation scheme needs to be selected next. First use the inverse distance \nweighted interpolation scheme ( IDW). \n1. Select \u201c  tank.sp3\u201d in the Project Explorer to make it active.  \n2. Select Interpolation  | Interpolation Options\u2026  to bring up the 3D Interpolation \nOptions  dialog.  \n3. In the Interpolation method  section, select Inverse distance weighted . \n4. Click Options\u2026  to bring up the 3D IDW Interpolation Options  dialog.  \n5. In the Nodal function  section, select Constant  (Shepard\u2019s method) . \n6. In the Computation of interpolation weights  section , select Use subset of points . \n7. Click the Subset\u2026 button to bring up the Subset Definition  dialog.  \n8. Select Use nearest ___ pts  and enter \u201c 64\u201d for the number of points.  \n9. Click OK to exit the Subset Definition  dialog.  \n10. Click OK to exit the 3D IDW Interpolation Options  dialog.  \n11. Click OK to exit the 3D Interpola tion Options dialog.  \n\nGMS Tutorials   Geostatistics \u2013 3D \n \n Page 6 of 14 \u00a9 Aquaveo 2024  12. Select Interpolation  | Interpolat e \u2192 3D Grid  to bring up the Interpolate \u2192 Object  \ndialog.  \n13. Click OK to accept the defaults and close the Interpolate \u2192 Object  dialog.  \n7 Displaying Isosurfaces  \nNow that interpolation has been completed on th e nodes of the 3D grid, there are several \nways to visualize the contaminant plume. One of the most effective ways is to use \nisosurfaces. Isosurfaces are the three -dimensional equivalent of contour lines \nrepresenting a surface of a constant value (contamina nt concentration, in this case).  \nTo define and display isosurfaces, do the following:  \n1. Click Display Options   to bring up the Display Options  dialog.  \n2. Select \u201c  3D Grid Data\u201d from the list on the left.  \n3. On the 3D Grid  tab in the top section, turn off Cell edges  and turn on Grid shell.  \n4. In the Active dataset  section, turn on Isosurfaces . \n5. Click the Options\u2026  button to the right of Isosurfaces  to bring up the Isosurface \nOptions dialog.  \n6. On the first row of the table, enter \u201c 3000.0\u201d  in the Upper Value  column.  \n7. On the second row, check the box in the Fill Between  column.  \n8. In the section on the right, turn on Isosurface faces . \n9. Click OK to exit the Isosurface Options  dialog.  \n10. Click OK to exit the Display Options  dialog.  \n11. Frame   the project.  \nThe isosurface  should now be visible ( Figure 4). \n \n      Figure 4      Visible isosurface  \n\nGMS Tutorials   Geostatistics \u2013 3D \n \n Page 7 of 14 \u00a9 Aquaveo 2024  7.1 Interior Edge Removal  \nA series of edges are drape d over the isosurface plot. These edges represent the \nintersection of the isosurface with the grid cells. The edges are displayed to help visualize \nthe spatial variation or relief in the isosurface. However, it is sometimes useful to inhibit \nthe display of  the edges in some areas. For example, in the regions where the plume \nintersects the grid, the isosurface is flat. It is advisable to turn off the display of the edges \nin this area since they provide little benefit.  \n1. Select the \u201c  3D Grid Data\u201d folder in th e Project Explorer to make it active.  \n2. Select Grid | Isosurface Options\u2026  to bring up the Isosurface Options  dialog.  \n3. In the section on the right, turn on  the Interior edge removal  option.  \nThis removes the edges between adjacent planar facets that are coplan ar. \n4. Click OK to close the Isosurface Options  dialog.  \n7.2 Specified Range  \nNotice that the shell of the isosurface is all one color, but the interior of the isosurface \n(where the isosurface intersects the grid boundary) varies in color according to the \ncontamina nt concentration. To show more distinct color variation, do the following:  \n1. Select Grid | Isosurface Options\u2026  to bring up the Isosurface Options  dialog.  \n2. In the section on the right, turn on Contour specified range,  enter \u201c 3000\u201d  for \nMinimum value , and \u201c 9000\u201d  for Maximum value . \n3. Click OK to close the Isosurface Options  dialog.  \nThe isosurface should appear similar to Figure 5. \n \n      Figure 5      Isosurface with contouring  \n7.3 Using the Vertical Anisotropy Option  \nThe scatter points being used were obtained along vertical traces. This means the \ndistances between scatter points along the vertical traces are significantly s maller than \n\nGMS Tutorials   Geostatistics \u2013 3D \n \n Page 8 of 14 \u00a9 Aquaveo 2024  the distances between scatter points along the horizontal plane. This disparity in scaling \ncauses clustering and can be a source of poor results in some interpolation methods.  \nThe effects of clustering along vertical traces can be minimized usi ng vertical anisotropy . \nThe z coordinate of each of the scatter points is multiplied by one over the vertical \nanisotropy parameter prior to interpolation. Thus, if the vertical anisotropy parameter is \nless than 1.0, scatter points along the same vertical a xis appear farther apart, and scatter \npoints in the same horizontal plane appear closer together.  \nAs a result, points in the same horizontal plane are given a higher relative weight than \npoints along the z axis. This can result in improved accuracy, especially in cases where \nthe horizontal correlation between scatter points is expected to be greater than the \nvertical correlation (e.g., horizontal layering of soils, spreading of the plume on the top of \nthe w ater table).  \nTo change the vertical anisotropy, do the following:  \n1. Select the \u201c  3D Scatter  Data\u201d folder in the Project Explorer to make it active.  \n2. Select Interpolation  | Interpolation Options\u2026  to bring up the 3D Interpolation \nOptions  dialog.  \n3. In the Anisotr opy section, enter \u201c0.4\u201d for the Vertical Anisotropy.   \n4. Click OK to close the 3D Interpolation Options  dialog.  \n5. Select Interpolation | Interpolate  \u2192 3D Grid  to bring up the Interpolate \u2192 Object  \ndialog.  \n6. Enter \u201c c_idw_const2\u201d  as the Interpolated dataset name . \n7. Click OK to close the Interpolate \u2192 Object  dialog.  \nMore correlation now exists in the horizontal direction ( Figure 6). \n \n      Figure 6      Isosurface contours using vertical anisotropy  \n \n\nGMS Tutorials   Geostatistics \u2013 3D \n \n Page 9 of 14 \u00a9 Aquaveo 2024  8 Interpolation  \n8.1 IDW Interpolation with Gradient Planes  \nAs discussed in the \u201cGeostatistics \u20142D\u201d tutorial, IDW interpolation can often be improved \nby defining higher order nodal func tions at the scatter points. The same is true in three \ndimensions. The next step will be to use IDW interpolation with gradient plane nodal \nfunctions.  \n1. Select Interpolation  | Interpolation Options\u2026  to bring up the 3D Interpolation \nOptions dialog.  \n2. In the Interpolation method  section, click the Options\u2026  button to the right of the \nInverse distance weighted  option to bring up the 3D IDW Interpolation Options  \ndialog.  \n3. In the Nodal function  section, select the Gradient plane option.  \n4. Click OK to exit the 3D IDW Interpolation Options  dialog.  \n5. Click OK to exit the 3D Interpolation Options  dialog.  \n6. Select Interpolation | Interpolate  \u2192 3D Grid  to bring up the Interpolate \u2192 Object \ndialog.  \n7. Click OK to accept the defaults and close the Interpolate \u2192 Object dialog.  \nThe Graphics Window will appear similar to Figure 7. \n \n      Figure 7      IDW with gradient planes  \n8.2 IDW Interpolation with Qua dratic Functions  \nNext, try IDW interpolation with quadratic nodal functions.  \n1. Select Interpolation  | Interpolation Options\u2026  to bring up the 3D Interpolation \nOptions dialog.  \n2. In the Interpolation method  section, click the Options\u2026  button to the right of \nInver se distance weighted  to bring up the 3D IDW Interpolation Options  dialog.  \n3. In the Nodal function  section, select Quadratic . \n\nGMS Tutorials   Geostatistics \u2013 3D \n \n Page 10 of 14 \u00a9 Aquaveo 2024  4. In the Computation of nodal function coefficients  section, select Use all points . \n5. Click OK to exit the 3D IDW Interpolation Options  dialog.  \n6. Click OK to exit the 3D Interpolation Options  dialog.  \n7. Select Interpolation | Interpolate  \u2192 3D Grid  to bring up the Interpolate \u2192 Object \ndialog.  \n8. Click OK to accept the defaults and close the Interpolate \u2192 Object dialog.  \nThe Graphics Window will app ear similar to Figure 8. Notice how the contour of the \nisosurface layers has changed slightly from that in the previous section.  \n \n      Figure 8      IDW using quadratic functions  \n8.3 Other Interpolation Schemes  \nTwo other 3D interpolation schemes (natural neighbor interpolation and kriging) are \nsupported in GMS. However, these schemes will not be reviewed in this tutorial. Feel free  \nto experiment with these techniques at a later time.  \n9 Viewing the Plumwe with a Cross Section  \nWhile isosurfaces  are effective for displaying contaminant plumes, it is often useful to use \ncolor -shaded cross sections to illustrate the variation in the contaminant concentration.  \nTo do this, first cut a horizontal cross section through the center of the plume:  \n1. In the Project Explorer, select the \u201c  3D Grid Data\u201d folder.  \n2. Switch to Side View  . \n3. Using the Create Cross Section   tool, cut a horizontal cross section through \nthe grid and the middle of the isosurface by clicking to the left of the grid, moving \nthe cursor to t he right of the grid, and double -clicking.  \n4. Switch to Oblique View  . \nTo turn off the display of the isosurfaces and make the contours visible on the cross \nsection, do the following:  \n\nGMS Tutorials   Geostatistics \u2013 3D \n \n Page 11 of 14 \u00a9 Aquaveo 2024  5. Click Display Options   to bring up the Display Options dialog.  \n6. Select \u201c3 D Grid Data\u201d from the list on the left.  \n7. On the 3D Grid  tab in the Active dataset  section, turn off Isosurfaces . \n8. Select \u201cCross Sections\u201d from the list on the left.  \n9. In the first section on the Cross Sections  tab, turn on Interior edge removal . \n10. In the 3D Grid  section, turn on Contours . \n11. Click the Options\u2026  button to the right of Contours to bring up the Dataset  \nContour Options \u2013 3D Grid \u2013 c_idw_quad  dialog.  \n12. In the Contour method section, select \u201cColor fill\u201d from the drop -down.  \n13. Click OK to close the Dataset Conto ur Options dialog.  \n14. Click OK to close the Display Options dialog.  \nThe isosurface will disappear, and the contours will be visible on the cross section. \n(Figure 9) \n \n      Figure 9      Cross section with contours  \n9.1 Using the Truncation Option  \nNotice the range of contaminant concentration values shown in the color legend at the \nupper left corner of the Graphics Window ( Figure 9). A large percentage of the values are \nnegative. This occurs due to the fact that a higher order noda l function was used. Both \nthe quadratic and the gradient plane nodal functions infer trends in the data and try to \npreserve those trends.  \nIn some regions of the grid, the values at the scatter points are decreasing when moving \naway from the center of the plume. This decreasing trend is preserved by the \ninterpolation scheme; moreover, the interpolated values approach zero and eventually \nbecome negative in some areas.  \nHowever, a negative concentration does not make sense. This problem can be avoided \nby trun cating the values in order to force all negative values to have a value of zero.  \n1. In the Project Explorer, select the \u201c  3D Scatter  Data\u201d folder.  \n2. Select Interpolation  | Interpolation Options\u2026  to bring up the 3D Interpolation \nOptions dialog.  \n\nGMS Tutorials   Geostatistics \u2013 3D \n \n Page 12 of 14 \u00a9 Aquaveo 2024  3. In the section on the lower right, turn on Truncate values . \n4. Select Truncate to min/max of dataset . \n5. Click OK to close the 3D Interpolation Options dialog.  \nBecause the interpolation options were changed, the data needs to be reinterpolated:  \n6. Select Interpolat ion | Interpolation  \u2192 3D Grid  to bring up the Interpolate \u2192 \nObject dialog.  \n7. Enter \u201c c_idw_quad_trunc\u201d  as the Interpolated dataset name . \n8. Click OK to close the Interpolate \u2192 Object dialog.  \nNotice that the minimum value listed in the color legend is zero ( Figure 10). \n \n      Figure 10      Truncated values   \n10 Setting up a moving Cross Section Animation  \nIt is possible to create several cross sections at different locations in the grid to illustrate \nthe spatial variation of the plume. This process can be automated using the animation  \nutility in GMS. An animation can be generated showing a color -shaded cros s section \nmoving through the grid.  \n10.1 Display Options  \nBefore setting up the animation, delete the existing cross section, turn off the color \nlegend, and reset the contour range.  \n1. In the Project Explorer, select the \u201c  3D Grid Data\u201d folder.  \n2. Using the Select Cro ss Sections   tool, select the cross section by clicking on \nit, then press the Delete  key. \n3. Select Grid | Isosurface Options\u2026  to bring up the Isosurface Options  dialog.  \n4. Turn on Contour specified range , then enter \u201c 1000.0\u201d  for Minimum value  and \n\u201c15000.0\u201d  for Maximum value . \n5. Click OK to close the Isosurface Options  dialog.  \n\nGMS Tutorials   Geostatistics \u2013 3D \n \n Page 13 of 14 \u00a9 Aquaveo 2024  10.2 Setting Up and Playing the Animation  \nTo set up the animation:  \n1. Select Display  | Animate\u2026  to bring up the Options  page of the Animation Wizard \ndialog.  \n2. In the Options  section, turn on Cross sections / Isosurfaces  and click Next  to go \nto the Cross Sections / Isosurfaces  page of the Animation Wizard dialog.  \n3. Turn on the Animate cutting plane over specified XYZ range  section.  \n4. Turn on Z. \n5. Click Finish  to close the Animation Wizard dialog.  \nOpen a media player application outside of GMS and open the mp4 file. Feel free to \nadjust the speed of the animation to allow more time to examine each cross section. \nWhen finished, close the application and return to GMS.  \n11 Setting up a Moving Isosurface Anima tion \nAnother effective way to visualize the plume model is to generate an animation showing a \nseries of isosurfaces corresponding to different isovalues.  \nTo set up the animation, do as follows:  \n1. Select Display  | Animate\u2026  to bring up the Options  page of the Animation Wizard  \ndialog.  \n2. In the Options  section, turn on Cross sections / Isosurfaces  and click Next  to go \nto the Cross Sections / Isosurfaces  page of the Animation Wizard dialog.  \n3. Turn off the Animate cutting plane over XYZ range  section . \n4. Turn on the Animate isosurface over specified data range  section.  \n5. Enter \u201c 1000.0\u201d  for the Begin value . \n6. Enter \u201c 15000.0\u201d  for the End value . \n7. Turn on Cap above  and Display values . \n8. Click Finish  to close the Animation Wizard dialog.  \nOpen a media player application outside of  GMS and open the mp4 file. Feel free to \nadjust the speed of the animation to allow more time to examine each layer of the \nisosurface. When finished, close the application and return to GMS.  \n  \nGMS Tutorials   Geostatistics \u2013 3D \n \n Page 14 of 14 \u00a9 Aquaveo 2024  12 Conclusion  \nThis concludes the \u201cGeostatistics \u2013 3D\u201d tutorial. Th e key concepts discussed and \ndemonstrated in this tutorial include the following:  \n\uf0b7 There are several 3D interpolation algorithms available in GMS.  \n\uf0b7 Mesh -centered grids are better than cell -centered grids if using interpolation and \nnot using MODFLOW.  \n\uf0b7 Isosurfa ces can be used to visualize the results of an interpolation.  \n\uf0b7 Vertical anisotropy can be used to help overcome the problem of grouping that is \ncommon with data collected from boreholes.  \n \n \n", "filename": "Geostatistics-3D.pdf", "pages": 14}, "GettingStarted": {"text": "GMS Tutorials   Getting Started  \n Page 1 of 20 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nGetting Started  \nAn introduction to GMS  \n \nObjectives   \nThis tutorial introduces GMS and covers the basic elements of the user interface. It is the first tutorial that \nnew users should complete.  \nPrerequisite Tutorials  \n\uf0b7 None  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 Subsurface  \n\uf0b7 Geostatistics  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 20\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   Getting Started  \n Page 2 of 20 \u00a9 Aquaveo 2024  1 Introduction and Getting Started  ................................ ................................ .......................  2 \n1.1 Registering GMS  ................................ ................................ ................................ ..........  2 \n2 GMS User  Interface ................................ ................................ ................................ ..............  4 \n2.1 Modules  ................................ ................................ ................................ ........................  5 \n2.2 Project Explorer  ................................ ................................ ................................ ............  6 \n2.3 Graphics Window  ................................ ................................ ................................ ..........  7 \n2.4 Static Tools  ................................ ................................ ................................ ...................  8 \n2.5 Tracking, Selection, Status Bar, and XYZS  ................................ ................................ .. 8 \n3 Projections  ................................ ................................ ................................ ...........................  9 \n4 Online Maps  ................................ ................................ ................................ .......................  10 \n5 Importing Data and Display Options  ................................ ................................ ................  11 \n6 Saving the Project  ................................ ................................ ................................ .............  13 \n7 Feature Objects  ................................ ................................ ................................ .................  13 \n8 Creating a UGrid  ................................ ................................ ................................ ................  15 \n9 Creating  a MODFLOW Simulation  ................................ ................................ ....................  15 \n10 Printing  ................................ ................................ ................................ ...............................  16 \n11 Stratigraphy Modeling  ................................ ................................ ................................ ....... 16 \n12 Geostatistics  ................................ ................................ ................................ ......................  17 \n13 Conclusion  ................................ ................................ ................................ .........................  20 \n \n1 Introduction and Getting Started  \nThis is the first tutorial all new GMS users should complete. It introduces the GMS user \ninterface and the most  commonly used tools and commands. Other tutorials build on the \ninformation introduced in this tutorial.  \nThis tutorial does not go in -depth on any one topic, but gives a general overview of \nseveral topics and refers to other tutorials for a more complete c overage. The purpose of \nthis tutorial is to familiarize the user with the GMS interface and capabilities.  \nThe following wi ll be introduced and briefly covered in this tutorial:  \n\uf0b7 The GMS user interface, static tools, and display options.  \n\uf0b7 The File | New\u2026  command . \n\uf0b7 Projections and coordinate systems.  \n\uf0b7 Importing an online map and importing a shapefile.  \n\uf0b7 Printing and saving the project.  \n\uf0b7 Creating feature objects, UGrids, and MODFLOW simulations.  \n\uf0b7 Stratigraphy modeling, including boreholes, cross sections, and sol ids. \n\uf0b7 Using geostatistics with scatter points.  \nTo get started, do the following:  \n1. Launch GMS.   \n2. If GMS is already running, select File | New\u2026  to ensure that the program \nsettings are restored to their default state. A dialog may appear asking to \nsave changes.  Click Don\u2019t Save  to clear all data. The graphics window of \nGMS should refresh to show an empty space.  \n1.1 Registering GMS  \nRegistering enables GMS with a valid license. Without a license, GMS runs as the free \n\"Community Edition\" and many features are not available. The user\u2019s license may not \nGMS Tutorials   Getting Started  \n \n Page 3 of 20 \u00a9 Aquaveo 2024  include all components covered in the tutorial.  A free evaluation license can be reque sted \nthat enables everything in GMS for two weeks, allowing completion of the tutorial.  \nIf GMS has not been registered, do the following to register GMS:  \n1. Select Help | Register\u2026  to bring up the Aquaveo  License Registration  \ndialog.  \n2. If the user has a valid l icense, the dialog will indicate that this copy of GMS is \nlicensed. If the user does not have a valid license, skip to step 6.  \nIf the user has a valid license, make sure the required components listed at the beginning \nof this tutorial are enabled by doing  the following:  \n3. Click on Advanced Options\u2026 to bring up the Aquaveo License Registration \n\u2013 Advanced dialog. The dialog will display the GMS release date in the title \nbar. \n4. Click on the Details\u2026 button for the relevant license to bring up the Aquaveo \nLicense Registration \u2013 License Details dialog.  \nIf the user has a valid license, the dialog should appear similar to Figure 1. If any of the \nrequired components are not enabled, enable them by requesting an evaluation license, \nor skip the parts of the tutorial that require them . \n \n      Figure 1      Enabled components  \n5. If an evaluation license is needed for components that aren\u2019t already \nenabled, click the Request License\u2026  button and skip to step 8. Otherwise , \nclick the  OK or Close  button s on all of the Aquaveo License Registration \ndialogs  and skip to the next section of the  tutorial.  \n6. If the copy of GMS is not licensed and the Aquaveo License Registration \ndialog indicates so, click on Advanced Options\u2026 to bring up the Aquaveo \nLicense Registration \u2013 Advanced dialog.  \n\nGMS Tutorials   Getting Started  \n \n Page 4 of 20 \u00a9 Aquaveo 2024  7. Click the Request License\u2026 button and continue to step 8.    \n8. In either case, clicking the Request License \u2026 button will open a web page \nin the default browser for requesting a software license. Click Evaluate and \ncomplete the form to request the license. After submitting, an email wi th the \nlicense code will be sent to the email address as entered in the form.  \n9. From the Aquaveo License Registration \u2013 Advanced dialog, click on Add \nLicense\u2026 to bring up the Aquaveo License Registration \u2013 Add License \ndialog (as seen in Figure 2) \n10. Enter the code from the email in the License code  field.  \n11. Click OK to close the Aquaveo License Registration \u2013 Add License  dialog . \n12. Click Close to close the Aquaveo License Registration \u2013 Advanced dialog.  \n13. Click OK to close the Aquaveo License Registration dialog.  \n \n      Figure 2       Aquaveo License Registration \u2013 Add License  dialog  \n2 GMS User Interface  \nStart with looking at the different parts of the GMS user interface ( Figure 3). \n\nGMS Tutorials   Getting Started  \n \n Page 5 of 20 \u00a9 Aquaveo 2024   \n      Figure 3      The GMS window  \nThe toolbars at the top can be grouped into three categories:  \n\uf0b7 Macro toolbars, most of which are shortcuts for various menu commands:  \n \n\uf0b7 The Module  toolbar : \n \n\uf0b7 The XYZS toolbar:  \n \nThe Project Explorer, Static Tools, Dynamic Tools, and the Graphics Window occupy the \nmiddle from left to right. Be aware that most toolbars can be moved around the GMS \nwindow. At the bottom are the Status Bar and the Mouse Tracking Bar.  \n2.1 Module s \nThere are currently twelve modules in GMS and each module focuses the user interface \non a different type of data.  Only one module is active at a time, so switching to a different \nmodule will cause different toolbars and menus to appear. If a tool or menu  command \ncan\u2019t be immediately located, it may be in a different module.  \n1. Click on UGrid   in the Module s toolbar.  \nNotice that the menus and dynamic tools change when changing modules . The menus \nand dynamic tools now look like this:  \nStatus Bar  Project Explorer  Graphics  Window  \nMouse Tracking Bar  Dynamic Tools  Static Tools  Macro Toolbars  Menus  \nGMS Tutorials   Getting Started  \n \n Page 6 of 20 \u00a9 Aquaveo 2024   \n \n      Figure 4      UGrid module menus and dynamic tool bar \nThese are the menus and tools that correspond with UGrid objects. A UGrid is an \nunstructured grid composed of 2D or 3D cells and the cells can be of any type (triangles, \nquadrilaterals , etc.).  \n2. Click on Map  in the Modules  toolbar.  \nNotice that the menus and dynamic tools have changed.  Now the menus and tools deal \nwith feature object data. This type of data will be discussed later.  \n \n \n      Figure 5      Map module menus and dynamic tools  \n2.2 Project Explorer  \nThe Project Explorer  displays the objects and data that are in the project.  \n1. Right -click in the Project Explorer  and select New | UGrid 3D\u2026  to bring up \nthe New UGrid  dialog . \n2. Click OK to accept the defaults and close the New UGrid  dialog . \nA new 3D UGrid will appear in the Graphics Window . Notice that GMS automatically \nswitched to the UGrid   module . A wireframe view of the UGrid will appear in the \nGraphics Window . A number of items  will also appear  in the Project Explo rer (Figure 6). \n \n      Figure 6      Project Explorer showing the UGrid item  \nIn the Project Explorer , the item at the top is the  Project  item and everything else \nappears  below it. The next item here is the \u201c UGrid Data \u201d folder. This folder is where \nall UGrids are placed as they are created. Clicking on this item switches  to the UGrid \nmodule , thus changing the menus and dynamic tools. This  is a way to change modules \nwithout  using the Modules  toolbar.  \nBelow the \u201c UGrid Data \u201d folder is the \u201c ugrid \u201d that was just  created, and below it are \ndataset s named \"  Point Z \", \u201c  Cell Top Z\u201d, and \u201c  Cell Bottom Z\u201d . The dataset s are \nsimply array s of val ues associated with a geometric object. A dataset can represent \nanything such as elevations, contaminant concentrations, head, and so forth. In this case, \nthere is one value in the dataset for every UGrid cell.  \n\nGMS Tutorials   Getting Started  \n \n Page 7 of 20 \u00a9 Aquaveo 2024  3. Turn off the display of the \u201c ugrid \u201d  by unchecking its box (  to  ) in the \nProject Explorer . The \u201c ugrid \u201d  is no longer visible  in the Graphics Window.  \n4. Turn on the \u201c  ugrid \u201d. It is visible again in the Graphics Window.  \n2.3 Graphics Window  \nThe Graphics Window  is the main window where things are di splayed. To see  how t he \nGraphics Window  displays 3D data , do the following:  \n1. Click  the Front View   macro . \n \n      Figure 7      UGrid in front view  \nThis is the view of the UGrid from the front ( Figure 7). The XYZ triad in the bottom -left \ncorner of the window shows the orientation of the current view. In this view, the UGrid \nhas three layers of cells.  \n2. Click  the Oblique View   macro . \n \n      Figure 8      Oblique view of UGrid  \nNow the UGrid is displayed from an oblique  angle , or a 3D view ( Figure 8). \n3. Switch back to Plan View  . This returns the project to the top -down view.  \n\nGMS Tutorials   Getting Started  \n \n Page 8 of 20 \u00a9 Aquaveo 2024  2.4 Static Tool s \nThe Static T ools are tools used  with the mouse in the Graphics Window. \"Static\" means \nthat they don't change as modules  change . There is always one tool active at any given \ntime, either one of the static tools or one of the dynamic tools.  The three most commonly \nused static tools  are covered below:  \n1. Select  the Pan  tool. \n2. Click and drag the mouse in any direction in the Graphics Window . Notice \nthat the UGrid moves as the mouse is dragged  around in the window.  \n3. Frame  , or center, the displayed objects in the window.  \n4. Switch to the Zoom   tool. \n5. Click somewhere in the Graphics Window  to zoo m in.  \n6. Right -click to zoom out.  \n7. Click and drag a box to zoom in to the area within the box.  Zooming can a lso \nbe done by moving the mouse wheel.  \n8. Frame   the display again.  \n9. Select  the Rotate   tool. \n10. Click and drag the mouse in the Graphics Window . Notice the UGrid rotates \nas the mouse  is dragged . \nThe Measure   tool is used to measure distances in the Graphics W indow  with the \nmouse. Feel free to  switch to Plan View and  try it out.  \n2.5 Tracking , Selection, Status Bar, and XYZS  \n1. Frame   the display  and s witch back to Plan View  . \n2. Using  the Select Cells   tool, move the mouse around inside the Graphics \nWindow .  \n3. If the UGrid is locked, right -click on \u201c  ugrid\u201d in the Project Explorer and \nselect Lock/Unlock Editing  from the menu.  \nNotice that the XYZ coordinates and the \"F\" and \"ID\" values in the Mouse Tracking  bar \nchange as the mouse  is moved ( Figure 9). The XYZ values are the real -world \ncoordinates of the mouse. The F value is the scalar value of the dataset  in the cell that \nthe mouse is currently over. The ID is the number of the cell the mouse is currently over.  \nIf the mouse is not currently over a cell then the F and ID values are not updated.  \n \n      Figure 9      Mouse Tracking bar show s XYZ coordinates, dataset  value , and cell  ID \nXYZ Coordinates  \nDataset value and ID \nof cell under cursor  \nGMS Tutorials   Getting Started  \n \n Page 9 of 20 \u00a9 Aquaveo 2024  4. Using  the Select Cells   tool, click on any of the cells in  the UGrid  (      \nFigure 10). Notice that  several items of information about the selected cell \nare displayed in the Status bar at the bottom of the main GMS screen.  \n      Figure 10      Status bar showing selected cell information  \nThe XYZS toolbar i s located above the Graphics Window  (Figure 11). \n \n      Figure 11      XYZS Toolbar  \nThe XYZ coordinates of the center of the cell are also d isplayed here. UGrids are not \neditable, so the XYZ fields are read -only. But the dataset value for the cell is displayed in \nthe \"S\" field and is editable. The \u201cS\u201d is the hydraulic head, the value for the liquid \npressure above a geodetic datum. The XYZS toolbar can be used to change selected \nobject locations or dataset values.  \n5. Enter a new value in the S field and press the Tab or Enter  key to set it.  \n3 Projections  \nGMS can display things in real -world projections, and many projections are supported. \nThe pro jection of any data added to a project will be recognized and displayed in its real -\nworld location.  \n1. Click on New , and click Don\u2019t Save  when asked to save changes.  \nIn a new project, the projection has not been set. The display project is set by doing the  \nfollowing:  \n2. Use the Display  | Display Projection \u2026 command to bring up the Display \nProject ion dialog.  \n3. In the dialog, turn on the Global projection  option. This will automatically \nopen the Horizontal Projection  dialog if this option was not previously \nselect ed.  \n4. In the Filter strings  field, enter, \u201cNAD 1983 UTM Zone 10N\u201d. This will reduce \nthe number of visible options in the data tree above.  \n5. In the data tree, open the Projected Coordinate Systems  folder, then the \nUTM  folder, and finally the NAD 1983  folder.  \n6. Select \u201cNAD 1983 UTM Zone 10N\u201d. This is the correct setting for the project.  \n7. Click OK to close the Horizontal Projection  dialog.  \n8. Click OK to close the Display Projection  dialog.  \nSelected Cell Info  \nGMS Tutorials   Getting Started  \n \n Page 10 of 20 \u00a9 Aquaveo 2024  9. Move the mouse around and notice that the mouse tracking now shows the \nlatitude and longitude as well as the UTM coordinates in meters. Also notice \nthe current display projection is shown in the status bar  (Figure 12). \n \nFigure 12      Latitude, longitude and projection displayed in status bars  \nData in a different projection will be reprojected on -the-fly to any selected display \nprojection so that all data is displayed together correctly. If the data is not in a projection, \nthe display projection can be set to No projection  and still allow work to be done.  \n4 Online Maps  \nGMS can be used for many purposes but the most typical purpose i s to build a \ngroundwater model. A good way to start building a model is to start with a map or aerial \nphoto of the site. Free internet imagery can be imported using the Online Maps  tool. \n1. Click the Add Online Maps   button  to open the Virtual Earth Map Loca tor \ndialog . This map window allows navigation to any location on the Earth \nquickly and easily.  \n2. In the Place to search for  field, type \u201cLake Tahoe , CA\u201d  and click Jump to \nSearch Location . After a moment, the edge of Lake Tahoe will appear in the \nVirtual Ear th Map Locator  dialog . \n3. Use the zoom and pan tools in the Virtual Earth Map Locator  dialog so that \nLake Tahoe is located in the center as shown in Figure 13. \n4. Click OK to close the Virtual Earth Map Locator  dialog and open the Get \nOnline Maps  dialog ( Figure 14). \n \n      Figure 13      Virtual Earth Map Locator dialog  \n\nGMS Tutorials   Getting Started  \n \n Page 11 of 20 \u00a9 Aquaveo 2024   \n     Figure 14      Get Online Maps dialog  \n5. Select  the World Imagery  item and click OK to close the Get Online Maps  \ndialog . \nDepending on the speed of the user\u2019s internet connection and the speed of the computer \nbeing used, a photo  of Lake Tahoe  should appear in the Graphics Window  after a short \ntime,  and a new GIS layer will appear  in the Project Explorer . With an internet \nconn ection, this map is dynamic and will update as it is panned and zoomed. It takes \nsome time to update the map because the image has to be retrieved from the internet \nevery time.  \nOnline maps are covered in more detail in another tutorial entitled Online Maps . \n5 Importing Data and Display Options  \nGMS can import lots of different types of data. A shapefile will be imported to illustrate.  \n1. Click the Open   macro to bring up the Open  dialog . \n2. Navigate to the GettingStarted/GettingStarted  folder.  \n3. Select \u201cAll Files (*. *)\u201d from the Files of type  drop-down.  \n4. Select \u201c watershed.shp \u201d and click the Open  button to import the file and close \nthe Open  dialog . \nThis simple shapefile contains a watershed boundary line. It's a black line so it is not \neasy to see against  a real photo.  \nTo fix that, do the following:  \n5. Click Display Options   to open the Display Options  dialog ( Figure 15).  \nThe Display Options  dialog allows  for the  changing and setting of many display options. \nThis dialog is used regularly.  \n\nGMS Tutorials   Getting Started  \n \n Page 12 of 20 \u00a9 Aquaveo 2024   \n      Figure 15      Display Options dialo g \n6. Select \u201cGIS Data \u201d from the list on the left.  \n7. On the GIS tab, click on the wide button to the right of Lines  (the button to \nthe left of the drop -down arrow button) to bring up the Line Properties  dialog \n(Figure 16). \n \n      Figure 16      Line Properties dialog  \n8. Select the Solid  radio button and enter \u201c2.0\u201d in the Width  field.  \n9. Click on the color button to the right of Line colo r to bring up th e Select  Color  \ndialog.  \n10. Select one of the orange  boxes from the color samples in the Basic colors  \nsection.  \n11. Click OK to close the Select  Color  dialog.  \n12. Click OK to close the Line Pro perties  dialog.  \n13. Click OK to close the Display Options  dialog.  \n\nGMS Tutorials   Getting Started  \n \n Page 13 of 20 \u00a9 Aquaveo 2024  The watershed boundary line should be more visible now. In addition to shapefiles, GMS \ncan import many different types of files, including CAD files, a variety of image file types, \nDEM data, and text CSV files. For more about using shapefiles, please refer  to the GIS \ntutorial.  \n6 Saving the Project  \nAll of the files which are part of the project (shapefiles, images, CAD files, etc.) are just \nreferenced in the project file, so it is a good practice to save the project where these \nexternal files are located. This  keeps all the files together in case the project needs to be \nshared or moved to another computer.  \nGMS project files have a GPR extension. It is recommended to save often as the project \nis being built. To save the project, do the following:  \n1. Click the Save   macro to bring up the Save As  dialog . \n2. Navigate to the GettingStarted/GettingStarted  folder, and enter \"tahoe.gpr\" in \nthe File name  field.  \n3. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down list.  \n4. Click Save  to save the project and close the Save As  dialog.  \n7 Feature Objects  \nThe most powerful way to build a groundwater model is by using a conceptual model \nmade of feature objects ( Figure 17). Feature objects are used to conceptually represent \nthe important parts of the model such as wells, rive rs, boundaries , etc. For more about \nfeature objects, please refer to the tutorial entitled Feature Objects . \n \n      Figure 17      Examples of feature objects  \nTo define the model boundary with an arc , do the following:  \n1. Turn off \u201c World Imagery \u201d in the Project Explorer  so that the watershed \nboundary is more visible.  \n2. Switch to the Map  module.  \n\nGMS Tutorials   Getting Started  \n \n Page 14 of 20 \u00a9 Aquaveo 2024  3. Using  the Create Arc   tool, create  a simple arc as shown in Figure 18 by \nclicking in the Graphics Window . Click on the starting point  (indicated by the \nred arrow in Figure 18) to close the arc to form a polygon. Hit the Backspace  \nkey to remove the last point clicked.  \nIf a mistake is made, select the arc with the Select Arc s  tool and delete it, then switch \nback t o the Create Arc   tool and start again.  There is no undo option in GMS.  \nThis illustrates the basic idea of feature objects which are used for many things in GMS. \nIn this case, the first part of the conceptual model \u2014the model boundary \u2014was created. If \na rea l model was being created, more precision in creating the boundary arc would be \nrequired.  \nCreating the boundary arc by converting the shapefile to feature objects directly is a very \neffective and precise method. For example, more detail can be added to th e conceptual \nmodel, including points for wells, arcs for rivers, and polygons for the lake boundary. \nAttributes would be added to these items such as pumping rates, depths, and recharge \nrates. For more information on how to build a groundwater model using a conceptual \nmodel, please see the tutorial MODFLOW \u2013 Conceptual Model Approach I . \n \n      Figure 18      Creating an arc for the watershed boundary  \nAlthough a closed polygon was formed with the arc, GMS doesn't know it is a polygon \nthere until the polygons are built . This allows  GMS to know  the model area.  \n4. Click the Build Polygons   macro.  \nThe interior of the polygon is now filled with a transparent grey color. If it doesn't look like \nthis, the arc is probably not closed an d there is a gap somewhere. Try creating it again.  \n\nGMS Tutorials   Getting Started  \n \n Page 15 of 20 \u00a9 Aquaveo 2024  8 Creating a UGrid  \nAfter the conceptual model is created using feature objects, create a grid for the \nnumerical model by doing the following:  \n1. Click the Map \u2192 UGrid   macro . This opens the Map \u2192 UGrid  dialog.  \n2. In the X-Dimension  section, select the Number of cells  radio button and enter \n\u201c20\u201d into  Number of cells . \n3. In the Y-Dimension  section, select the Number of cells  radio button and enter \n\u201c30\u201d into  Number of cells . \n4. Accept the defaults for everything else and c lick OK to close the Map \u2192 \nUGrid  dialog.  The project should appear similar to Figure 19. \n \n       Figure 19      UGrid  created in area of conceptual model  \nThis is the second way to create a UGrid discussed in this tutorial. There are other ways \nexplained in the UGrid Creation  tutorial. UGrids can be created so that they are refined \naround wells, rivers, and lakes (points,  arcs, and polygons) in the conceptual model.  \n9 Creating a MODFLOW Simulation  \nNow that a UGrid is completed, a MODFLOW simulation can be created. GMS supports \nother numerical models but MODFLOW is the most widely used.  \n1. In the Project Explorer , right -click o n the  \u201c ugrid \u201d item and select New \nMODFLOW\u2026  to bring up the MODFLOW Global/Basic Package  dialog . \nThis is where the fundamental aspects of the model  are set,  such as which packages to \nuse and whether the model is steady -state or transient.  \n\nGMS Tutorials   Getting Started  \n \n Page 16 of 20 \u00a9 Aquaveo 2024  2. Accept the defau lts and click OK to close the MODFLOW Global/Basic \nPackage  dialog . \nWith a  conceptual model, a UGrid, and a MODFLOW simulation  all created , the next step \nis mapping  the conceptual model to the UGrid using the Map\u2192MODFLOW  command. \nThis command intersects the feature objects with the UGrid cells, and transfers the \nattributes from the conceptual model to the UGrid.  The MODFLOW simulation can also \nbe edited directly on the grid in a cell -by-cell fashion.  \nFor the purposes of this tutorial, this is a s far as this project will be taken. There are a \nnumber of  tutorials on the Aquaveo website about the  building of MODFLOW model s.  \n10 Printing  \nA very common task is printing or otherwise getting image data out of GMS. There are a \nnumber of ways to get image d ata from GMS and there is a tutorial on the subject called \nPrinting and Exporting Images . \n1. Select File | Page Setup\u2026  to bring up the Page Setup  dialog.  \nThe Page Setup  dialog allows control over such things as the margins, paper size, and \norientation of the printed output.  \n2. Click Cancel  to close the Page Setup  dialog.  \n3. Click the Print   macro  to bring up the Print dialog . \nThe Print dialog allows selecting the printer to which the print job information will be sent, \nas well as a number of other options . \n4. Click Cancel  to close the Print dialog . \nBoth File | Save As\u2026  and Edit | Screen Capture...  capture the Graphics Window to an \nimage file . The second option creates a higher resolution image. All of this is reviewed in \nmore detail in the Printing and Exporting Imag es tutorial . \n11 Stratigraphy Modeling  \nAnother common use of GMS is for stratigraphy modeling. This involves creating a model \nof the geology of a site. This could be for the sole purpose of site characterization or for \nlater use in constructing a groundwater m odel.  \n1. Click the  New  macro. If prompted to save, select Save  to bring up the \nSave As  dialog.  \n2. Enter \"tahoe.gpr\" in the File name  field.  \n3. Select \u201cProject Files (*.gpr) from the Save as type  drop-down list.  \n4. Click Save  to save the project and close the Save As  dialog.  \n5. If asked to replace the existing file, click Yes.  \n6. Click the Open   macro to bring up the Open  dialog . \n7. Navigate to the GettingStarted/GettingStarted  folder  and select \u201cProject Files \n(*.gpr)\u201d from the Files of type  drop-down . \n8. Select  \u201cstratigraphy.gpr \u201d and click Open  to import the file and close the Open  \ndialog .  \n\nGMS Tutorials   Getting Started  \n \n Page 17 of 20 \u00a9 Aquaveo 2024  The Graphics Window will now appear similar to Figure . Boreholes and cross sections \nwill be visible.  \n \n      Figure 20      Boreholes and cross section s \n9. Use Rotate   and Zoom   to examine  the data.  \nFeel free to experiment with the various selection and creation tools in the Boreholes   \nmodule. Several tutorials explain how to create this sort of data, including TINs , \nBoreholes and Cross Sections , and Horizons and Solids . \n12 Geostatistics  \nThe last commonly used feature of GMS discussed here is geostatistics, otherwise \nknown as interpolation.  \n1. Click the  New  macro. If prompted to save, select Don\u2019t Save.   \n2. Click the Open   macro to bring up the Open  dialog . \n3. Navigate to the GettingStarted/GettingStarted  folder  and select \u201cProject Files \n(*.gpr)\u201d from the Files of type  drop-down . \n4. Select  \u201cgeos2d .gpr\u201d and click Open  to import the file and close the Open  \ndialog .  \nThe Graphics Window  should  now appear similar to  Figure 21, showing a 2D grid.  \n\nGMS Tutorials   Getting Started  \n \n Page 18 of 20 \u00a9 Aquaveo 2024   \n      Figure 21     2D g rid with interpolated values  \n5. Use Rotate   and Zoom   to examine  the data.  \nThis shows a 2D grid surface whose Z values have been warped to match dataset \nvalues. The datasets were generated by interpolating from a few scatter points to every \ngrid cell corner.  \n6. Switch to Plan View  . \n7. In the Project Explorer, right -click and select Expand All . Any collapsed \nfolders should now be fully expanded . \n8. Turn off \u201c grid\u201d in the Project Explorer.  \nThe scatter points, which are the source of the interpolation, are now visible. The points \nare colored according to their dataset value, with higher values color ed red and lower \nvalues colored blue. The dataset in this case could represent a contaminant plume but in \nthis case it is a perfectly elliptical plume derived from a mathematical function in order to \nillustrate how interpolation works.  \n9. Turn on \u201c grid\u201d. \n10. Right-click on the \u201c plumedat \u201d scatter point set and select Interpolate To  | \n2D Grid  to bring up the Interpolate \u2192 Object  dialog .  \nRight -clicking on items in the Project Explorer opens context menus with commands \nspecific to the item clicked.  \n\nGMS Tutorials   Getting Started  \n \n Page 19 of 20 \u00a9 Aquaveo 2024   \n   Figure 22      Interpolate \u2192 Object dialog  \n11. Click the Interpolation Options \u2026 button to bring up the 2D Interpolation \nOptions  dialog.  \nThis dialog allows choosing from many different interpolation options. Each interpolation \nmethod has its strengths and weaknesses. Inverse distance weighted will be used in this \ntutorial for simplicity.  \n12. In the Interpolation method  section, select the Inverse distance weighted  \nradio button . \n \n      Figure 23      2D Interpolation Optio ns dialog  \n13. Click OK to close the 2D Interpolation Options  dialog . \n14. Enter \"idw\"  in the Interpolated dataset name  field. \n15. Click OK to close the Interpolate \u2192 Object  dialog . \nA new dataset named \"  idw\" is added under the 2D grid and the contours change to \nreflec t the new dataset.  \n\nGMS Tutorials   Getting Started  \n \n Page 20 of 20 \u00a9 Aquaveo 2024  16. In the Project Explorer, click on the various datasets  under the grid and \nsee how the contours change.  \n17. Switch to Oblique View  . \n18. Again click on the various datasets  under the grid. The \u2191 Up and \u2193 Down  \narrow keys can also be used to c hange datasets  once the first dataset has \nbeen selected . \nThe Z values of the grid are warped to match the active dataset values. This is the default \nbehavior for 2D surfaces. GMS also supports 3D interpolation to 3D objects, such as a \nUGrid. To learn more about geostatistics and  interpolation, please refer to the \nGeostatistics \u2013 2D and Geostatistics \u2013 3D tutorials.  \n13 Conclusion  \nThis concludes the Getting Started  tutorial  for GMS . The following information was \ndiscussed in this tutorial:  \n\uf0b7 The GMS user interface, static tools, and display options.  \n\uf0b7 The File | New\u2026  command . \n\uf0b7 Projections and coordinate systems.  \n\uf0b7 Importing an online map, and importing a shapefile.  \n\uf0b7 Printing and saving the project.  \n\uf0b7 Creating feature objects, UGrids, and MODFLOW simu lations.  \n\uf0b7 Stratigraphy modeling, including boreholes, cross sections, and solids.  \n\uf0b7 Using geostatistics with scatter points.   \n \n\n", "filename": "GettingStarted.pdf", "pages": 20}, "GIS": {"text": "GMS Tutorials   GIS Module  \n Page 1 of 6 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nGIS Module  \nImporting, displaying, and converting shapefiles.  \n \nObjectives   \nLearn how to import and display shapefiles in GMS. Learn how to convert the shapefiles to GMS feature \nobjects.  \n \nPrerequisite Tutorials  \n\uf0b7 Getting Started  Required Components  \n\uf0b7 GMS Core  \n Time  \n\uf0b7 15\u201320 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   GIS Module  \n Page 2 of 6 \u00a9 Aquaveo 2024   \n1 Introduction and Getting Started  ................................ ................................ .......................  2 \n2 Importing the Shapefile  ................................ ................................ ................................ ....... 2 \n3 Viewing the Shapefile  ................................ ................................ ................................ ..........  3 \n4 Viewing the Attribute Table  ................................ ................................ ................................  4 \n5 Converting a Shapefile to 2D Scatter Points  ................................ ................................ ..... 4 \n6 Converting a Shapefile to Feature Objects  ................................ ................................ ....... 5 \n6.1 Creating the Conceptual Model  ................................ ................................ ....................  5 \n6.2 Mapping the GIS Data  ................................ ................................ ................................ .. 5 \n7 Conclusion  ................................ ................................ ................................ ...........................  6 \n1 Introduction and Getting Started  \nThis tutorial introduces the GIS module and shows some of the available features. The \nGIS module can be used to display data from a GIS database directly in GMS without \nhaving to convert that data to GMS data types. Native GMS data such as grids and \nboreho les can be displayed along with the GIS data.  \nThe GIS module can also be used to select a portion of the GIS data and convert it to \nGMS data types to be used in constructing a groundwater model. Currently, the GIS \nmodule can only be used for steady -state data. For a full list of the features available in \nthe different modules, refer to GMS Help . \nIn this tutorial, the following topics are discussed:  \n\uf0b7 Opening a shapefile  \n\uf0b7 Viewing the attribute table  \n\uf0b7 Converti ng the shapefile to scatter points  \n\uf0b7 Converting the shapefile into feature objects  \nTo get started, do the following:  \n1. Launch GMS.   \n2. If GMS is already running, select File | New\u2026  to ensure that the program settings \nare restored to their default state.  \nAfter st arting GMS, this tutorial will begin with importing a point shapefile containing well \ndata. This makes it possible to create scatter points from the shapefile points. Next, a \nGMS MODFLOW conceptual model will be created in the Map module, and a coverage \nwith well attributes will be created. The shapefile will then be converted to GMS wells \nuseful in building a model. This will illustrate how GIS data can be imported and \nconverted to GMS data.  \n2 Importing the Shapefile  \nImport the shapefile by doing the followi ng: \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cShapefiles (*.shp)\u201d from the Files of type  drop-down.  \n3. Browse to the Tutorials \\GIS\\gis directory and select \u201carcmap.shp\u201d.  \n4. Click Open  to import the shapefile and close the Open  dialog.  \n\nGMS Tutorials   GIS Module  \n \n Page 3 of 6 \u00a9 Aquaveo 2024  3 Viewing the Shapefile  \nA number of points representing wells are now visible in the Main Graphics Window \n(Figure 1). These are contained in the \u201c  arcmap.shp \u201d shapefile listed in t he  GIS \nLayers  folder in the Project Explorer. GMS provides  a limited set of options for displaying \nthe shapefile.  \n \n      Figure 1      Well points imported from the arcmap shapefile  \n1. Select the  GIS Layers folder in the Project Explorer . \n2. Click the Display Options   macro to bring up the Display Options  dialog.  \n3. Select \u201cGIS Data\u201d from the list on the left.  \n4. On the GIS tab, click the wide button to the right of Points  to bring up the Point \nProperties  dialog.  \n5. Enter \u201c10\u201d in the Radius  field.  \n6. From the down -arrow menu for Color , select \u201cRed\u201d.  \n7. Click OK to close the Point Properties dialog.  \n8. Click OK to close the Display Options dialog.  \nNotice that the size and color of the points have changed (Figure 2).  \n\nGMS Tutorials   GIS Module  \n \n Page 4 of 6 \u00a9 Aquaveo 2024   \n      Figure 2      Well points now colored red  \n4 Viewing the Attribute Table  \nThe shapefile has a number of attributes associated with each point. To view these \nattributes, do the following:  \n1. In the Project Explorer, right -click on \u201c arcmap.shp\u201d and select Attribute \nTable\u2026  to bring up the Attributes  dialog.  \n2. Resize the Attributes dialog by dragging the bottom right corner out so that more \nof the data is visible.  \nA number of attributes (columns) are associated with each point. Notice the data is not \neditable here.  \n3. Click OK to close the Attributes  dialog.  \n5 Converting a Shapefile to 2D Scatter Points  \nThe GIS data can be converted to 2D scatter points which can be used to perform \ninterpolations.  \n1. In the Project Explorer, right -click on \u201c  arcmap.shp\u201d and select Convert To  | 2D \nScatter Points . This converts the shapefile points to 2D scatter points which \nappear on top of the shapefile points (Figure 3).  \n2. If necessary, expand the \u201c  2D Scatter Data\u201d folder and the \u201c  arcmap.shp\u201d \nscatter set.  \n\nGMS Tutorials   GIS Module  \n \n Page 5 of 6 \u00a9 Aquaveo 2024   \n      Figure 3      Well points converted to scatter points  \nNotice that GMS automatically created a dataset from each numeric attribute in the \nattribute table. This procedure can be used to create scatter points , and then interpola te \nfrom the scatter points to a grid. Using water level information for each point, for example, \na starting head dataset could be created for the model.  \nThis tutorial won\u2019t do anything more with the scatter points, so it\u2019s time to delete them.  \n3. In the Proje ct Explorer, right -click on \u201c  2D Scatter Data\u201d and select Delete . \n6 Converting a Shapefile to Feature Objects  \nNow it is possible to convert the GIS data to GMS feature objects that could be used in \nbuilding a conceptual model. The first step is to create a default conceptual model and \ncoverage with the appropriate attributes.  \n6.1 Creating the Conceptual Model  \n1. Right -click on an empty space in the Project Explorer  and select New | \nConceptual Model\u2026  to bring up the Conceptual Model Properties dialog.  \n2. Enter \u201c Model1 \u201d in the Name  field.  \n3. Select \u201cMODFLOW \u201d from the Type  drop-down.  \n4. Click OK to close the Conceptual Model Properties dialog.  \n5. In the Project Explorer , right-click on \u201c  Model1 \u201d under  Map Data and select \nNew Coverage \u2026 to bring up the Coverage Setup dialog.  \n6. Enter \u201c coverage1 \u201d in the Coverage name  field.  \n7. Turn on Wells  in the list of Sources/Sinks/BCs . \n8. Click OK to close the Coverage Setup dialog.  \n6.2 Mapping the GIS Data  \n1. Select the  GIS Layers folder in the Project Explorer to make it active.  \n\nGMS Tutorials   GIS Module  \n \n Page 6 of 6 \u00a9 Aquaveo 2024  2. Make certain no points  are selected in the Graphics Window. If any points are \nselected, only those points will be converted to feature objects.  \n3. Select the GIS | Shapes \u2192 Feature Objects  command.  \nThe first page of the GIS to Feature Object Wizard  allows  for selecting which shapefile in \nthe GIS module to use and selecting which coverage will receive the shapefile data. \nSince there is only one coverage and one shapefile in the project, no changes need to be \nmade.  \n4. Click Next  to bring up the GIS to Feature Objec ts Wizard \u2013 Step 2 of 3  page of \nthe dialog.  \n5. In the WELLNAME  column, select \u201cName\u201d from the Mapping  drop-down.  \n6. In the PUMPRATE  column, select \u201cFlow rate\u201d from the Mapping  drop-down.  \n7. Click Next  to bring up the GIS to Feature Objects Wizard \u2013 Step 3 of 3 (Fin ished)  \npage of the dialog.  \n8. Click Finish  to close the GIS to Feature Objects Wizard \u2013 Step 3 of 3 (Finished)  \ndialog.  \nThis creates feature points in the same location as the GIS shapefile points. Depending \non the settings, they may or may not be visible.  \n9. Uncheck \u201c  arcmap.shp\u201d in the Project Explorer. This hides the shapefile points \nin the Graphics Window.  \n10. In the Project Explorer, right -click on \u201c  coverage1\u201d and select Attribute \nTable\u2026  to bring up the Attribute Table  dialog.  \nThis dialog shows the properties of all the feature points in the coverage. Notice that the \nnames and flow rates were transferred from the GIS attributes, just as specified. \nHowever, the type for all points is \u201cNONE.\u201d It is necessary to make them into wells.  \n11. Select \u201cwell\u201d from the drop -down in the Type  column of the All row. Since this is \nthe All row, all of the points are changed to wells.  \n12. Click OK to close the Attribute Table  dialog. All of the feature points are now \nwells.  \nAt this point, the well points could be used to construct a MODF LOW conceptual model. \nThis topic is discussed more thoroughly in the tutorials entitled \u201cMODFLOW \u2013 Conceptual \nModel Approach 2\u201d and will not be discussed further here.  \n7 Conclusion  \nThis concludes the \u201cGIS Module\u201d tutorial. The following topics were covered:  \n\uf0b7 Importing shapefiles into GMS  \n\uf0b7 Viewing shapefile attributes  \n\uf0b7 Converting shapefile data to GMS scatter points or feature objects  \n \n\n", "filename": "GIS.pdf", "pages": 6}, "HydroGeoSphere-olf-et": {"text": "GMS Tutorials   HydroGeoSphere \u2013 Surface Flow and ET  \n Page 1 of 13 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nHydroGeoS phere \u2013 Surface Flow and Evapotranspiration  \nBuild a HydroGeoSphere model in GMS  \n \nObjectives   \nThis tutorial demonstrates how to add surface flow and evapotranspiration to  a HydroGeoSphere model \nin GMS . \nPrerequisite Tutorials  \n\uf0b7 Getting Started  \n\uf0b7 HydroGeoSphere \u2013 Porous \nMedia Domain  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 HydroGeoSphere Model & \nInterface  \n Time  \n\uf0b7 25\u201345 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   HydroGeoSphere \u2013 Surface Flow and ET  \n Page 2 of 13 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Basic Workflow  ................................ ................................ ................................ ....................  3 \n3 Getting Started  ................................ ................................ ................................ .....................  4 \n3.1 Domains  ................................ ................................ ................................ .......................  5 \n4 Simulation Control ................................ ................................ ................................ ...............  5 \n5 Zones  ................................ ................................ ................................ ................................ .... 5 \n5.1 Surface Flow Domain  ................................ ................................ ................................ ... 6 \n5.2 ET Domain  ................................ ................................ ................................ ....................  7 \n6 Material Properties  ................................ ................................ ................................ ..............  8 \n6.1 Surface Flow Domain  ................................ ................................ ................................ ... 8 \n6.2 ET Domain  ................................ ................................ ................................ ....................  9 \n7 Boundary Conditions  ................................ ................................ ................................ ........  10 \n7.1 Surface Flow Domain  ................................ ................................ ................................ . 10 \n7.2 ET ................................ ................................ ................................ ...............................  12 \n8 Save the Project and Simulation  ................................ ................................ ......................  12 \n9 Run Grok  ................................ ................................ ................................ ............................  13 \n10 Run Phgs  ................................ ................................ ................................ ............................  13 \n11 Read the Solution  ................................ ................................ ................................ ..............  13 \n12 Conclusion  ................................ ................................ ................................ .........................  13 \n \n1 Introduction  \nThis tutorial demonstrates  how to build a HydroGeoSphere  (HGS)  model in GMS. It is \nbased off of the Intro to HydroGeoSphere  tutorial from Aquanty. Refer to that tutorial and \nthe HydroGeoSphere Reference Manual as needed.  \nIn the Intro to HydroGeoSphere  tutorial, the \u201cR5 Catchment\u201d m odel is developed. From \nthat tutorial:  \nThe model is quite simple compared to many \u2018real world\u2019 models that you may \nbuild. But it contains sufficient complexity that it is perfectly suited to demonstrate \nthe overall HydroGeoSphere workflow. The intention of  this tutorial is not to \nperfectly recreate the catchment, but to teach the process of creating a small \nwatershed model in HGS. In fact, several of the inputs for the R5 model are \ncompletely arbitrary (e.g. the delineation of soil types and associated hydr aulic \nproperties, boundary condition values, etc.).  \nThe R5 catchment covers a small (approximately 0.1 km2) rangeland catchment \nnear Oklahoma City (Figure 3). The defined model includes basic flow in the \nporous medium and surface/overland flow domains, and  includes \nevapotranspiration.1 \nThe HydroGeoSphere \u2013 Porous Media Domain  tutorial covers creating a model of the \nporous media domain, and this tutorial adds the surface flow and evapotranspiration \ndomains.  \n \n                                                      \n1 HydroGeoSphere Intro Tutorial, pg 13  \nGMS Tutorials   HydroGeoSphere \u2013 Surface Flow and ET  \n \n Page 3 of 13 \u00a9 Aquaveo 2024   \nFigure 1     HydroGeoSphere Intro Tutorial, figure 3, pg 14  \n2 Basic W orkflow  \nFrom the Intro to HydroGeoSphere  tutorial, t he basic H GS workflow consists of 5 steps : \n1. Data inputs are prepared (e.g. various GIS files, 2D grid/mesh files, etc.)  \n2. Configure an input data file (t he GROK  file) for the model pre -processor  \n3. Use executables (*.exe) to generate the model input files and solve the \nsimulation  \na. Grok.exe \u2013 compiles the GROK  file, generates input files for the \nnumerical simulator  \nb. Phgs.exe \u2013 reads model input files, performs t he numerical simulation \n(i.e. it \u2018solves\u2019 the model)  \nc. Hsplot.exe OR hgs2vtu.exe \u2013 reformats model outputs for visualization  \n4. Visualize, analyze and interpret model results  \n5. Iterate on the model to add complexity, perform scenario analysis, calibrate, etc .2 \nNote that a GROK  file is prepared and then  the grok.exe run s. During the run, grok.exe  \nreads the GROK  file and prepares the actual model input files. Only then can the model \n(phgs.exe) be run.  \nThe HydroGeoSphere workflow is followed pretty closely when using  GMS. The basic \nsteps to build an HGS model in GMS, and how these steps relate to the \nHydroGeoSphere workflow , are as follows:  \n1. Create the conceptual model (HGS step 1)  \n2. Create a 3D UGrid for the porous media domain   (HGS step 1)  \n                                                      \n2 HydroGeoSphere Intro Tutorial, pg 13  \n\nGMS Tutorials   HydroGeoSphere \u2013 Surface Flow and ET  \n Page 4 of 13 \u00a9 Aquaveo 2024  3. Create a 2D UGrid for the 2D  domains: surface flow, ET (HGS step 1)  \n4. Save the simulation, which creates the GROK  file (HGS step 2)  \n5. Run grok.exe on the GROK  file to prepare input files for phgs.exe (HGS step 3a)  \n6. Run phgs.exe (HGS step 3b)  \n7. Read the solution and visualize the results (HG S step 4)  \n8. Iterate on the model to add complexity, perform scenario analysis, calibrate, \netc\u2026 (HGS step 5, not covered in this tutorial)  \n3 Getting  Started  \nDo as follows to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n3. Click Open   to bring up the Open  dialog.  \n4. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n5. Browse to the hgs-olf_et\\ folder and select \u201cstart .gpr\u201d. \n6. Click Open to impo rt the project and exit the Open  dialog.  \nThe project should be visible in the Graphics Window ( Figure 2). The project contains a \n2D UGrid and a 3D UGrid.  The porous me dia domain and initial simulation has already \nbeen defined.  \n \nFigure 2      The initial project  \nBefore continuing, it is recommended to save the project with a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Browse  to the directory  for this tutorial . \n\nGMS Tutorials   HydroGeoSphere \u2013 Surface Flow and ET  \n \n Page 5 of 13 \u00a9 Aquaveo 2024  3. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n4. Enter \u201c hgs_olf_et .gpr\u201d as the File name . \n5. Click Save to save the project and close the Save As  dialog . \n3.1 Domains  \nHydroGeoSphere uses \u201cdomains\u201d to describe dif ferent parts of the hydrosphere. There \nare several domains , but the only ones used in this tutorial include:  \n\uf0b7 Surface flow or overland flow  (olf): fluid flow on the surface  \n\uf0b7 ET (et): evapotranspiration  \nAlthough the surface flow and ET domains are 2D in nature, HydroGeoSphere only use s \none 3 D grid. In GMS both a 3D grid and a 2D grid are used to help prepare the inputs \nand to display the results  when the surface flow and/or ET domains are being modeled . \nThe \u201c  top 2d\u201d UGrid will be used for the surface flow and ET domains.  \n1. Turn the \u201c  3d\u201d UGrid on and off to see that the \u201c  top 2d\u201d UGrid is simply a \n2D UGrid at the top of the \u201c  3d\u201d UGrid.  \n2. When done, switch to Plan View  . \n4 Simulation Control  \nSimulation parameters can now be assigned.  \n1. Right -click the \u201c R5\u201d simulation and select Simulation Control  to open  the \nSimulation Control  dialog . \nMany HydroGeoSphere inputs are set in the Simulation Control  dialog. Besides \nparameters that are traditionally associated with HydroGeoSphere simulation control, this \ndialog also includes time stepping, output, zones, and initial conditions.  \n2. Select  the General  tab and turn on the  following  options : \n\uf0b7 Surface flow  \n\uf0b7 ET \n3. Click OK to close the Simulation Control  dialog.  \n5 Zones \nHydroGeoSphere uses the idea of \u201czones\u201d to divide the model domain into different \nareas. Properties such as hydraulic conductivity are associated with one or more zones \nand thus can vary spatially. Dif ferent zones can be used for different domains (porous \nmedia domain, surface flow domain etc.)  \nIn GMS, zones are defined using cell -based datasets. These datasets can be created in \na variety of ways. Hydraulic conductivity and other properties are defined on \u201cmaterials\u201d, \nand materials are assigned to one or more zones.  \nThis tutorial will demonstrate zone datasets for the surface flow and ET  domains.  \n\nGMS Tutorials   HydroGeoSphere \u2013 Surface Flow and ET  \n Page 6 of 13 \u00a9 Aquaveo 2024  5.1 Surface Flow D omain \nThe 2D UGrid is used for the surface flow, (or overland flow) domain, and the ET domain. \nFor surface flow, there will be two zones. Most cells will be in zone 1 which will be \nassigned to a \u201cGrassland\u201d material. Cells around the roads will be assigned to zone 2 and \nassigned to a \u201c Ranch Road\u201d material.  \n1. Turn off the \u201c  3d\u201d UGrid . \n2. Select  the \u201c  top 2d\u201d UGrid  to make it active.  \n3. Right -click on the \u201c  top 2d\u201d UGrid and select Z Values \u2192 Cell Dataset . A new \ncell-based dataset named \u201c  elevation\u201d will appear in the Project Explorer.  \n4. Right -click on the \u201c  elevation\u201d dataset under \u201c  top 2d\u201d UGrid and s elect \nRename . \n5. Enter \u201csurface flow zones\u201d as the new name.  \n6. Right -click on the \u201c  top 2d\u201d UGrid and select Lock / Unlock Editing . \nNow to assign values for zone 1, \u201cGrassland\u201d , by doing the following:  \n7. With the  Select Cells   tool active, use  Ctrl + A  to select all cells . \n8. Change the dataset value S to \u201c1\u201d. \nNow to assign values for zone 2, \u201c Ranch Road\u201d, by doing the following:  \n9. Turn on and s elect the \u201c  zones\u201d coverage to make it active.  \n10. Using the Select Polygons   tool, s elect the polygon representing  the roads . \n11. Right -click and select the Select Intersecting Objects\u2026  command to open the \nSelect Objects of Type  dialog.  \n12. Select the Active UGrid cells  option and click OK to close the Select Objects of \nType  dialog.  \n13. Change dataset value S to \u201c2\u201d . \n14. Deselect the  polygon . \n15. Click the Contour Options   macro to open the Contour Options  dialog.  \n16. Change the Contour method  to \u201cBlock Fill\u201d.  \n17. Click OK to close the Contour Options  dialog.  \n18. Click Yes at the message to turn on contours . \nThe surface flow zones dataset now has values of 2 along  the roads , and a value of  1 \neverywhere else.  \n\nGMS Tutorials   HydroGeoSphere \u2013 Surface Flow and ET  \n \n Page 7 of 13 \u00a9 Aquaveo 2024   \nFigure 3      The surface flow dataset with assigned values  \nSet surface flow zones  by doing the following:  \n19. In the Project Explo rer, double -click on the \u201c  R5\u201d simulation to open the \nSimulation Control  dialog.  \n20. Select the Zones  tab. \n21. Turn on the Read surface flow zones from file  option.  \n22. Click the Select Dataset  button to open the Select Dataset  dialog.  \n23. Select the \u201csurface flo w zones\u201d dataset under the \u201ctop 2d\u201d UGrid. \n24. Click OK to close the Select Dataset  dialog.  \n25. Click OK to close the Simulation Control  dialog . \n5.2 ET D omain \nFor ET, the zone encompasses  all the top faces.  \nStart with creating  the ET zones dataset  by doing the following:  \n1. Right -click the \u201c  surface flow zones\u201d dataset  and select Duplicate . \n2. Right -click on the \u201c  surface flow zones (2)\u201d dataset and select Rename . \n3. Enter \u201cet zones\u201d as the new name.  \n4. With the Select Cells   tool active, use Ctrl + A  to select all cells.  \n5. Change the dataset value S value to \u201c1\u201d.  \nNow s et the ET zones  by doing the following:  \n\nGMS Tutorials   HydroGeoSphere \u2013 Surface Flow and ET  \n Page 8 of 13 \u00a9 Aquaveo 2024  6. Double -click on the \u201c  R5\u201d simulation to open the Simulation Control  dialog.  \n7. Select the Zones  tab. \n8. Turn on the Read E T zones from file  option.  \n9. Click  the Select Dataset  button to open the Select Dataset  dialog.  \n10. Select the \u201cet zones\u201d dataset u nder the 2d UG rid. \n11. Click OK to close the Select Dataset  dialog.  \n12. Click OK to close the Simulation Control  dialog.  \n6 Material P roperties  \nProperties such as hydraulic c onductivity are associated with HydroGeoSphere materials. \nThis idea is similar to  traditional GMS materials, but HydroGeoSphere materials are \ncompletely separate from the traditional GMS materials. Multiple HydroGeoSphere \nmaterials can be defined, and mate rials are assigned to domains and to one or more \nzones. Note that if material property values are not assigned, then a default value will be \napplied. This example  will create three materials. In this case, each material will be \nassigned to one zone, but a material can be assigned to multiple zones.  \n6.1 Surface Flow D omain \nNow define two materials with the surface flow domain.  \n1. Right -click on the \u201c  R5\u201d simulation and select Materials  to open the Materials  \ndialog.  \nCreate the \u201cGrassland\u201d Material  \n1. Click Add Row   to add a new material.  \n2. Change the new material name to \u201cGrassland\u201d.  \n3. Change the Domain  to \u201cSurface flow\u201d and change Zones  to \u201c1\u201d.  \n4. Turn on X friction  and enter  \u201c0.3\u201d. \n5. Turn on Y friction  and enter  \u201c0.3\u201d. \n6. Turn on Rill storage height  and enter  \u201c0.01\u201d. \n7. Turn on Coupling length  and enter  \u201c0.01\u201d. \nCreate the \u201c Ranch Road\u201d Material  \n1. Click Add Row   to add a new material.  \n2. Change the new material name to \u201c Ranch Road\u201d. \n3. Change the Domain  to \u201cSurface flow\u201d and change Zones  to \u201c2\u201d. \n4. Turn on X friction  and enter \u201c0. 03\u201d. \n5. Turn on Y friction  and enter \u201c0. 03\u201d. \n6. Turn on Rill storage height  and enter \u201c 0.002 \u201d. \n7. Turn on Coupling length  and enter \u201c0.01\u201d . \n\nGMS Tutorials   HydroGeoSphere \u2013 Surface Flow and ET  \n \n Page 9 of 13 \u00a9 Aquaveo 2024  6.2 ET D omain \nNow define  a material with the ET domain.  \n1. Click Add Row   to add a new material.  \n2. Change the new material name to \u201cet1\u201d.  \n3. Change the Domain  to \u201cET\u201d and change Zones  to \u201c1\u201d.  \n4. Turn on Evaporation depth  and set it to \u201c3\u201d. \n5. Turn on EDF quadratic decay function . \n6. Turn on Root depth  and set it to \u201c3\u201d. \n7. Turn on RDF quadratic  decay function . \n8. Turn on LAI tables  and click the Table  button  to open the XY Series Editor  \ndialog.  \n9. Change the Number of rows  to \u201c2\u201d.  \n10. Enter the following  into the table : \ntime  lai \n0.0 2.08  \n1e41  2.08  \n11. Click OK to close the XY Series Editor  dialog.  \n12. Turn on Transpiration fitting parameters  and enter the following values:  \na. C_1 set to  \u201c0.1\u201d. \nb. C_2 set to  \u201c0.05\u201d. \nc. C_3 set to  \u201c2.0\u201d. \n13. Turn on Transpiration limiting pressure head  and enter the following values:  \na. Hwp_et  set to  \u201c-150\u201d. \nb. Hfc_et  set to  \u201c-3.8\u201d. \nc. Ho_et  set to  \u201c0\u201d. \nd. Han_et  set to  \u201c0\u201d. \n14. Turn on Evaporation limiting pressure head  and enter the following values:  \na. He2_et  set to  \u201c-1.5\u201d. \nb. He1_et  set to  \u201c-0.5\u201d. \n15. Turn on Canopy storage parameter  and set the value to \u201c0.0\u201d. \n16. Turn on Initial interception storage  and set the value to \u201c0.0\u201d. \nAll the materials have now been set . \n17. Click OK to exit the Materials  dialog.  \n\nGMS Tutorials   HydroGeoSphere \u2013 Surface Flow and ET  \n Page 10 of 13 \u00a9 Aquaveo 2024  7 Boundary Conditions  \nBoundary conditions are defined on feature objects in GMS coverages. When the model \nis saved, GMS intersects the features with the UGrid to find the grid components (nodes, \ncells, faces, or segments) that should be associated with the boundary conditions, and \nwrites the boundary conditions to the GROK  file. \n7.1 Surface Flow D omain  \nThe surface flow domain includes critical depth boundary c onditions on the boundary \narcs, and a rain boundary condition over all the top faces.  \nStart with creating  a coverage that contains  the outer boundary . This coverage will be  \nreuse d for the surface flow and ET domains. To create the coverage:  \n1. In the Project Explorer, t urn off the UGrids. \n2. Right -click on  the \u201c zones \u201d coverage  and select Duplicate . \n3. Right -click on \u201c  Copy of zones\u201d and select Rename . \n4. Enter \u201couter boundary\u201d for the new name . \n5. Right -click on the \u201c  outer boundary\u201d coverage and select Coverage Type  | \nHydroGeoSphere  | Boundary Conditions . \n6. Using the Select Arc   tool, select the arc in the middle of the model that \ndefines the clay lens area  and press the Delete  key. \n7. Repeat the previous step to delete the arc representing the area of the roads so \nthat only the outer boundary arc remains . \n8. Select Feature Objects  | Build Polygons . \n To create the surface flow domain coverage:  \n9. Right -click on the \u201c  outer boundary \u201d coverage and select Duplicate . \n10. Right -click on \u201c  Copy of outer boundary \u201d and select Rename . \n11. Enter \u201csurface flow BCs \u201d for the new name.  \n12. In the Project Explorer, t urn off all the coverages  except for \u201c  surface flow \nBCs\u201d.  \nA boundary condition needs to be assigned to the top edge. To do this,  separate th e top  \nedge to be a feature arc.  \n13. Using the Select Vertices   tool, hold down the Shift key and select  the top left \nand right corners.  \n14. Right-click and select  Vertex \u2192 Node . \n15. Using the Select Points \\Nodes   tool, select all the other nodes . \n16. Right-click and select  Node \u2192 Vertex . \nTo define the critical depth boundary conditions : \n17. Using the Select Arc  tool, double -click the top arc  to open the Arc Properties  \ndialog . \n\nGMS Tutorials   HydroGeoSphere \u2013 Surface Flow and ET  \n \n Page 11 of 13 \u00a9 Aquaveo 2024  Different types of boundary conditions are listed on the left. Parameters for the boundary \ncondition are shown on the right. Only one boundary con dition can be assigned to each \nfeature object.  \n18. In the list on the left, t urn on Critical depth . \n19. For the Name , enter  \u201cCritDepth_outlet\u201d.  \n20. Turn on Map to grid boundary . \n21. Click OK to close the Arc Properties  dialog.   \nThis tells GMS that the arc is to be intersected with the outer boundary of the grid and not \nthe interior.  \n22. Using the Select Arc   tool, double -click the bottom arc to open the Arc \nProperties  dialog.   \n23. In the list on the left, t urn on Critical depth .  \n24. For the Name  enter  \u201cCritDepth_rest\u201d.  \n25. Turn on Map to grid boundary . \n26. Click OK to close the Arc Properties  dialog.  \nTo define the rain boundary condition : \n27. Using the Select Polygons   tool, d ouble -click the polygon  to open the \nPolygon Properties  dialog . \n28. In the list on the left, t urn on Rain. \n29. For the Name  enter  \u201cPrecip\u201d . \n30. For the Constant  value enter  \u201c5.555e -7\u201d. \n31. Click OK to close the Polygon Properties  dialog.  \nThe boundary conditions  are now defined  for the surface flow domain, but still need to  be \ninclude d in the \u201c R5\u201d simulation . \n32. Drag the \u201c  surface flow BCs\u201d coverage below the \u201c R5\u201d simulation.  \n \nFigure 4      The HydroGeoSphere Simulation in the Project Explorer  \n\nGMS Tutorials   HydroGeoSphere \u2013 Surface Flow and ET  \n Page 12 of 13 \u00a9 Aquaveo 2024  7.2 ET \nEvapotranspiration will be assigned as a boundary condition on all the top faces.  \n1. Right -click on the \u201couter boundary\u201d coverage and select  Duplicate . \n2. Right -click on \u201c  Copy of outer boundary\u201d and select Rename . \n3. Enter \u201cet BCs\u201d for the new name.  \n4. Using the Select Polygons   tool, double -click the polygon to open the \nPolygon Properties  dialog.  \n5. In the list on the left , turn on Potential evapotranspiration . \n6. For the Name  enter \u201cPET1\u201d . \n7. For the Constant  value enter  \u201c3e-8\u201d. \n8. Click OK to close the Polygon Properties  dialog.  \nThe boundary conditions for the evapotranspiration  have now been defined . \n9. Drag the \u201c  et BCs\u201d coverage below the \u201c  R5\u201d simulation.  \n \nFigure 5      The HydroGeoSphere simulation in the Project Explorer  \n8 Save the Project and S imulation  \nBefore continuing, complete the following:  \n1. Save   the project . \nThis saves the GMS project files, but not the HydroGeoSphere simulation files. To create \nthe files for the HydroGeoSphere simulation, the simulation needs to be saved.  \n2. Right -click on the \u201c  R5\u201d simulation and select Save Simulation  to open the  \nSaving HydroGeoSphere simulatio n dialog.  \n\nGMS Tutorials   HydroGeoSphere \u2013 Surface Flow and ET  \n \n Page 13 of 13 \u00a9 Aquaveo 2024  3. When finished, c lick OK to close the Saving HydroGeoSphere Simulation  dialog.  \nSaving the simulation creates the GROK  file and the other files that it refers to.  The data \nin the files is based on the parameters set for the simulation in GM S. To view these files:  \n4. Right -click on the \u201c  R5\u201d simulation and select Open Containing Folder  to \nopen a Windows File Explorer . \nThe opened file explorer shows the directory where GMS saved the model files.   \n9 Run Grok  \n1. Right -click the \u201c R5\u201d simulation and select the Run grok  command  to open a \nrun dialog.   \nThe \u201cRun grok.exe\u201d dialog appears. The output from grok.exe is displayed . It should only \ntake a few seconds for grok .exe to finish. When it is done, there may be some warnings \nat the bo ttom of the output but there should not be any errors.  \n2. When the process finishes, click OK. \n10 Run Phgs  \nNow that the input files have been prepared by running grok.exe, the model is ready to \nbe run.  \n1. Right -click the \u201c R5\u201d simulation and select the Run phgs  command . \nThe \u201cRun phgs.exe\u201d dialog appears. The progress dialog shows a plot of the residual \nerror versus time, and the output from phgs.exe . It will take a few minutes for phgs.exe to \nfinish.   \n2. When the process finishes, click OK. \n11 Read the Solution  \n1. Right -click the \u201c  R5\u201d simulation and select Read Solution to start the Read \nSolution  progress dialog.  \nWhen GMS is done reading the solution, the Read Solution  progress dialog should \ndisappear automatically if there are no errors.  \nA new Solution folder was added under the R5 simulation  containing  links to datasets \nthat were added  under \u201cR5 (HydroGeoSphere)\u201d folder s under the \u201c3d\u201d and \u201ctop 2d\u201d \nUGrid s. The HydroGeoSphere \u2013 Post-Processing  tutorial has more information about \nhow to examine the solution.  \n12 Conclusion  \nThis concludes the  \u201cHydroGeoSphere \u2013 Surface Flow and Evapotranspiration \u201d tutorial.  \n \n\n", "filename": "HydroGeoSphere-olf-et.pdf", "pages": 13}, "HydroGeoSphere-pm": {"text": "GMS Tutorials   HydroGeoSphere \u2013 Porous Media Domain  \n Page 1 of 15 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nHydroGeoSphere \u2013 Porous Media Domain  \nBuild a HydroGeoSphere model in GMS  \n \nObjectives   \nThis tutorial demonstrates how to set up a HydroGeoSphere model with a porous media domain in GMS . \nPrerequisite Tutorials  \n\uf0b7 Getting Started  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 HydroGeoSphere Model & \nInterface  \n Time  \n\uf0b7 25\u201345 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   HydroGeoSphere \u2013 Porous Media Domain  \n Page 2 of 15 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Basic Workflow  ................................ ................................ ................................ ....................  3 \n3 Getting Started  ................................ ................................ ................................ .....................  4 \n3.1 Domains  ................................ ................................ ................................ .......................  4 \n4 Create a HydroGeoSphere Simulation  ................................ ................................ ...............  5 \n5 Simulation Control ................................ ................................ ................................ ...............  6 \n5.1 Time  Stepping ................................ ................................ ................................ ...............  6 \n5.2 Output  ................................ ................................ ................................ ...........................  7 \n5.3 Initial Conditions  ................................ ................................ ................................ ...........  7 \n6 Zones  ................................ ................................ ................................ ................................ .... 7 \n6.1 Use a Polygon to Create Zone 3 ................................ ................................ ...................  9 \n6.2 Set the Porous Media Zone  ................................ ................................ ........................  11 \n7 Material Properties  ................................ ................................ ................................ ............  11 \n7.1 Create the \u201cMedium Sand\u201d material  ................................ ................................ ............  12 \n7.2 Create the \u201cCoarse Sand\u201d material  ................................ ................................ .............  12 \n7.3 Create the \u201cClay\u201d material  ................................ ................................ ...........................  13 \n8 Boundary Conditions  ................................ ................................ ................................ ........  13 \n9 Save the Project and Simulation  ................................ ................................ ......................  14 \n10 Run Grok  ................................ ................................ ................................ ............................  15 \n11 Run Phgs  ................................ ................................ ................................ ............................  15 \n12 Read the Solution  ................................ ................................ ................................ ..............  15 \n13 Conclusion  ................................ ................................ ................................ .........................  15 \n \n1 Introduction  \nThis tutorial demonstrates  how to build a HydroGeoSphere  (HGS)  model in GMS. It is \nbased off of the Intro to HydroGeoSphere1 tutorial from Aquanty. Refer to that tutorial and \nthe HydroGeoSphere Reference Manual as needed.  \nIn the Intro to HydroGeoSphere  tutorial, the \u201cR5 Catchment\u201d model is developed. From \nthat tutorial:  \nThe model is quite simple compared to many \u2018real world\u2019 mo dels, that you may \nbuild. But it contains sufficient complexity that it is perfectly suited to demonstrate \nthe overall HydroGeoSphere workflow. The intention of this tutorial is not to \nperfectly recreate the catchment, but to teach the process of creating a small \nwatershed model in HGS. In fact, several of the inputs for the R5 model are \ncompletely arbitrary (e.g. the delineation of soil types and associated hydraulic \nproperties, boundary condition values, etc.).  \nThe R5 catchment covers a small (approximately 0.1 km2) rangeland catchment \nnear Oklahoma City (Figure 3). The defined model includes basic flow in the \nporous medium and surface/overland flow domains, and includes \nevapotranspiration.2 \nThe Intro to HydroGeoSphere  tutorial  includes groundw ater flow, evapotranspiration, and \nsurface flow, but this tutorial only covers groundwater flow. Evapotranspiration and \nsurface flow are covered in the HydroGeoSphere \u2013 Surface Flow and Evapotranspiration  \ntutorial.  \nNote: the HGS executables should be downl oaded from Aquanty\u2019s website be fore \nrunning the HGS simulation: https://www.aquanty.com/hgs -download . \n                                                      \n1 Aquanty Guide for New Users, Intro to HydroGeoSphere Tutorial download at \nhttps://www.aquanty.com/s/HGS_Intro_Tutorial.zip  \n2 HydroGeoSphere Intro Tutorial, pg 13  \nGMS Tutorials   HydroGeoSphere \u2013 Porous Media Domain  \n \n Page 3 of 15 \u00a9 Aquaveo 2024   \nFigure 1     HydroGeoSphere Intro Tutorial, figure 3, pg 14  \n2 Basic W orkflow  \nFrom the Intro to HydroGeoSphere  tutorial, t he basic H GS workflow consists of 5 steps : \n1. Data inputs are prepared (e.g. various GIS files, 2D grid/mesh files, etc.)  \n2. Configure an input data file (the GROK  file) for the model pre -processor\u2026  \n3. Use executables (* .exe) to generate the model input files and solve the \nsimulation\u2026  \na. Grok.exe \u2013 compiles the GROK  file, generates input files for the \nnumerical simulator  \nb. Phgs.exe \u2013 reads model input files, performs the numerical simulation \n(i.e. it \u2018solves\u2019 the model)  \nc. Hsplot .exe OR hgs2vtu.exe \u2013 reformats model outputs for visualization  \n4. Visualize, analyze and interpret model results\u2026  \n5. Iterate on the model to add complexity, perform scenario analysis, calibrate, \netc.\u20263 \nNote that a GROK  file is prepared and then  the grok.exe run s. During the run, grok.exe  \nreads the GROK  file and prepares the actual model input files. Only then can the model \n(phgs.exe) be run.  \nThe HydroGeoSphere workflow is followed pretty closely when using GMS. The basic \nsteps to build an HGS model in GMS, and h ow these steps relate to the \nHydroGeoSphere workflow , are as follows:  \n1. Create the conceptual model (HGS step 1)  \n                                                      \n3 HydroGeoSphere Intro Tutorial, pg 13  \n\nGMS Tutorials   HydroGeoSphere \u2013 Porous Media Domain  \n Page 4 of 15 \u00a9 Aquaveo 2024  2. Create a 3D UGrid for the porous media domain   (HGS step 1)  \n3. Create a 2D UGrid for the 2D domains: surface flow, ET (HGS step 1)  \n4. Save the simulati on, which creates the GROK  file (HGS step 2)  \n5. Run grok.exe on the GROK  file to prepare input files for phgs.exe (HGS step 3a)  \n6. Run phgs.exe (HGS step 3b)  \n7. Read the solution and visualize the results (HGS step 4)  \n8. Iterate on the model to add complexity, perform scenario analysis, calibrate, \netc\u2026 (HGS step 5, not covered in this tutorial)  \n3 Getting  Started  \nDo as follows to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New command to e nsure that the program \nsettings are restored to their default state.  \n3. Click Open   to bring up the Open  dialog.  \n4. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n5. Browse to the hgs-pm\\ folder and select \u201cstart .gpr\u201d. \n6. Click Open to import the project and exit the Open  dialog.  \nThe project should be visible in the Graphics Window ( Figure 2). The project contains a \n3D UGrid , a couple map coverag es, and a raster . \n \nFigure 2      The initial project  \nBefore continuing, it is recommended to save the project with a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Browse to the directory  for this tutorial . \n\nGMS Tutorials   HydroGeoSphere \u2013 Porous Media Domain  \n \n Page 5 of 15 \u00a9 Aquaveo 2024  3. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n4. Enter \u201c hgs_pm .gpr\u201d as the File name . \n5. Click Save to save the project and close the Save As  dialog.  \n3.1 Domains  \nHydroGeoSphere uses \u201cdomains\u201d to describe  the different parts of the hydrosphere. The \ndomains currently supported by GMS are:  \n1. Porous media (\u201cpm\u201d): variably -saturated flow in the subsurface.  \n2. Surface flow (or overland flow \u201colf\u201d): fluid flow on the surface.  \n3. ET (\u201cet\u201d): evapotranspiration.  \nOnly the porous media domain is used in this tutor ial. \n4 Create a HydroGeoSphere S imulation  \nNow to create the HGS simulation in GMS , do the following:  \n1. In the Project Explorer, r ight-click and select  New Simulation  | \nHydroGeoSphere . \n2. Right -click on \u201c  Sim\u201d and select Rename . \n3. Enter  \u201cR5\u201d for the new name.  \nThe UGrid need s to be added to the simulation. To do that, drag and drop  it below the \nsimulation.  \n4. Drag the \u201c 3d\u201d UGrid below the \u201c R5\u201d simulation . \n \nFigure 3      HydroGeoSphere simulation in the Project Explorer  \n \n \n\nGMS Tutorials   HydroGeoSphere \u2013 Porous Media Domain  \n Page 6 of 15 \u00a9 Aquaveo 2024  5 Simulation Control  \nWith the simulation created, simulation parameters can now be assigned.  \n1. Right -click the \u201c R5\u201d simulation and select Simulation Control  to open  the \nSimulation Control  dialog . \nMany HydroGeoSphere inputs are set in the Simulation Control  dialog. Besides \nparameters that are traditionally associated with HydroGeoSphere simulation control, this \ndialog also includes time stepping, output, zones, and initial conditions.  \n2. Select  the General  tab and enter the following:  \na. For the Description  enter  \u201cR5 model from 'Intr o to HGS' tutorial\u201d . \nb. Turn on  the following options : \ni. Transient flow  \nii. Unsaturated  \niii. Finite difference mode  \n3. Select the Units  tab. \n4. Ensure Units are set to  \u201ckilogram -metre -second\u201d . \n5. Select  the Saturated flow  tab. \n6. Turn on Flow solver maximum iterations  and enter  \u201c1000 \u201d. \n7. Select  the Variably saturated flow  tab. \n8. Make certain the No nodal flow check  option is on . \n5.1 Time Stepping  \n1. Select  the Time stepping  tab. \n2. In the General time step settings  section , turn on the following option s and set \nthem to the correct value:  \na. Initial time  step: \u201c0.5\u201d \nb. Maximum time step : \u201c4000 \u201d \nc. Minimum time step multiplier : \u201c0.5\u201d \nd. Maximum time step multiplier : \u201c1.2\u201d \ne. Jacobian epsilon : \u201c1e-6\u201d \nf. Newton maximum iterations : \u201c12\u201d \ng. Newton absolute convergence criteria : \u201c5e-3\u201d \nh. Newton residual convergence cri teria: \u201c1e-3\u201d \n3. In the Adaptive time step settings  section, turn on the following options and set \nthem to correct value:  \na. Head control : \u201c10\u201d \nb. Saturation control : \u201c0.5\u201d \nc. Newton iteration control : \u201c8\u201d \n\nGMS Tutorials   HydroGeoSphere \u2013 Porous Media Domain  \n \n Page 7 of 15 \u00a9 Aquaveo 2024  5.2 Output  \n1. Select  the Output  tab. \n2. Click the Add row  button to add a row in the table . \n3. Enter or c opy/paste the following times (in seconds)  into the Output Times table : \n1 \n60 \n600 \n3600 \n7200 \n14400  \n28800  \n57600  \n86400  \n5.3 Initial C onditions  \n1. Select  the Initial conditions  tab. \n2. In the  Head  section , select Initial head  depth to water table  and enter \u201c1.0\u201d. \n3. Click the OK button to close the Simulation Control  dialog . \n6 Zones \nHydroGeoSphere uses the idea of \u201czones\u201d to divide the model domain into different \nareas. Properties such as hydraulic conductivity are asso ciated with one or more zones \nand thus can vary spatially. Each model domain (e.g. porous media, surface/overland \nflow, evapotranspiration) must have its own zonation associated with it.  \nIn GMS, zones are defined using cell -based datasets. These datasets c an be created in \na variety of ways. Hydraulic conductivity and other properties are defined on \u201cmaterials\u201d, \nand materials are assigned to one or more zones.  \nThis tutorial will demonstrate zone datasets for the porous media domain.  \nThe porous media domain w ill have three zones. Most cells will be in zone 1 and will be \nassigned to the \u201cMedium Sand\u201d material. Zone 2 consists of a narrow band of cells in the \nmiddle, which widens at the top. These cells will be assigned to the \u201cCoarse Sand\u201d \nmaterial. Zone 3 will  be some cells in the middle of layer five and assigned to the \u201cClay\u201d \nmaterial.  A dataset with values of 1, 2, and 3 where 1 indicates zone 1, 2 indicates zone \n2 etc  will be created in this section . \nUse a raster to create zones 1 and 2 : \n1. Switch to Plan View  . \n2. In the Project Explorer, turn on the \u201c  PM_zones.asc\u201d raster . \n\nGMS Tutorials   HydroGeoSphere \u2013 Porous Media Domain  \n Page 8 of 15 \u00a9 Aquaveo 2024  The raster should appear similar to Figure 4. The raster consists of only two values: blue \nis 1 and red is 2.  \n  \nFigure 4      Imported raster  \nNow to  run a tool that will interpolate the raster to the UGrid and create a new dataset.  \n3. Right -click on the \u201c  3d\u201d UGrid and select Z Values \u2192 Cell Dataset . \nA new cell-based dataset named \u201c  elevation\u201d will appear  in the Project Explorer . \n4. Right -click the \u201c PM_zones.asc \u201d raster and select Interpolate To  | UGrid  to \nopen the Interpolate Priority Rasters  tool dialog . \n5. In the Interpolate Priority Rasters  tool, set the following options:  \na. Grid: \u201cUGrid Data/3d\u201d  \nb. Default dataset : \u201cUGrid Data/3d/elevation\u201d  \nc. Output dataset name : \u201czones\u201d  \nd. Resample algorithm : \u201cnearest_neighbor\u201d  \ne. Raster 1 (highest priority) : \u201cGIS Layers/PM_zones.asc\u201d  \nf. Leave Raster 2  as \u201cNone Selected\u201d  \n6. Click OK to run the Interpolate Priority Rasters  tool. \n7. When the tool finishes, c lick OK to close the Interpolate Priority Rasters  dialog.  \n8. In the Project Explorer, t urn off the \u201c PM_zones.asc \u201d raster . \nTo see how the elevation values were interpolated, turn on UGrid face contours . \n\nGMS Tutorials   HydroGeoSphere \u2013 Porous Media Domain  \n \n Page 9 of 15 \u00a9 Aquaveo 2024  9. Select the \u201c  3d\u201d UGrid to make it active.  \n10. Click the Contour Options   macro to open the Contour Options  dialog.  \n11. Change the Contour method  to \u201cBlock Fill\u201d. \n12. Click OK to close the Contour Options  dialog.  \n13. Click Yes at the message to turn on contours.  \n14. Select the \u201c  zones \u201d dataset to make it active . \nThe contour colors indicate that the zone dataset matches the raster. Moving the mouse \naround the grid will show  the F values at the bottom of the G raphics W indow . Note  that \nthe blue contours are where the dataset values are  1 and the red is where the values are  \n2. The interpolation is the same for all layers of the grid. If desired,  turn on \u201cSingle layer\u201d \nview and switch layers to see that the zonation is the same in every layer.  \n6.1 Use a Polygon to Create Z one 3  \nThe example currently has two zone s. Using a different method, this tutorial will show \nhow to add a third zone to the HGS simulation.  \nStart with assign ing the cells in a polygon to be zone 3 . \n1. Right -click on the  \u201c 3d\u201d UGrid  and select Lock / Unlock Editing . \n2. Select the \u201c zones\u201d dataset to make it active . \n3. Turn on Single layer  above the Graphics Window . \n4. Chang e the Layer to \u201c5\u201d. \n5. Select the \u201c zones\u201d  coverage  to make it active.  \n6. Click the Display Options   macro to open the Display Options  dialog.  \n7. For the Objects  row, c lick the  button to open the Line Properties  dialog.  \n8. Change the Width  to \u201c3\u201d.  \n9. Click OK to close the Line Properties  dialog.  \n10. Click OK to close the Display Options  dialog.  \n11. Using the Select Polygons   tool, select the clay lens polygon ( Figure 5). \n\nGMS Tutorials   HydroGeoSphere \u2013 Porous Media Domain  \n Page 10 of 15 \u00a9 Aquaveo 2024   \nFigure 5      The clay len s polygon selected  \n12. Right -click and select the Select Intersecting Objects\u2026  command to open the \nSelect Objects of Type  dialog.  \n13. Select the Active UGrid cells  option and click OK to close Select Objects of Type  \ndialog.  \n14. Above the Graphics Window, c hange  dataset value S to \u201c3\u201d. \n15. Deselect the polygon . \nNow the zones dataset has values of 3 for the all of cells inside the polygon in layer 5 \n(Figure 6). \n16. Turn off Single lay er. \n\nGMS Tutorials   HydroGeoSphere \u2013 Porous Media Domain  \n \n Page 11 of 15 \u00a9 Aquaveo 2024   \nFigure 6      Set zone values on layer 5 of the UGrid  \n6.2 Set the Porous Media Zone  \n1. In the Project Explorer, d ouble -click on the  \u201c R5\u201d simulation  to open the \nSimulation Control  dialog.  \n2. Select the Zones  tab. \n3. Turn on the Read porous media zones from file  option.  \n4. Click the Select Dataset  button  to open the Select Dataset  dialog.  \n5. Select the  \u201czones\u201d dataset under the 3d UGrid . \n6. Click OK to close the Select Dataset  dialog.  \n7. Click OK to close the Simulation Control  dialog.  \n7 Material P roperties  \nProperties such as hydraulic conductivity are associated with HydroGeoSphere materials. \nThis idea is similar to  traditional GMS materials, but HydroGeoSphere materials are \ncompletely separate from the traditional GMS materials. Multiple HydroGeoS phere \nmaterials can be defined, and materials are assigned to domains and to one or more \nzones. Note that if material property values are not assigned, then a default value will be \napplied. This example  will create three materials. In this case, each mater ial will be \nassigned to one zone, but a material can be assigned to multiple zones.  \nStart with defining three materials with a porous media domain.  \n1. Right -click on the \u201c  R5\u201d simulation  and select Materials  to open the Materials  \ndialog.  \n\nGMS Tutorials   HydroGeoSphere \u2013 Porous Media Domain  \n Page 12 of 15 \u00a9 Aquaveo 2024  7.1 Create the \u201cMedium Sand\u201d material  \n1. Click Add Row   to add  a material . \n2. Change the material name to \u201cMedium Sand\u201d . \n3. Leave Domain  at \u201cPorous media\u201d and Zones  at \u201c1\u201d. \n4. Select the K isotropic  option  and enter \u201c1 e-5\u201d. \n5. Turn on the Specific storage  option and enter  \u201c1.2e-7\u201d. \n6. Turn on Porosity  and set it to \u201c0.34\u201d. \n7. Make sure Unsaturated tables or functions  is set to \u201cTables \u201d. \n8. Turn on Saturation -relative k  and click the Table  button  to open the XY Series \nEditor  dialog.  \n9. Click the Import  button  to bring up an Open  dialog.  \n10. Change the filter  list to \u201cCSV (Comma delimited) Files (*.csv)\u201d . \n11. Browse to the directory for the tutorial files (hgs-pm) and select  the \u201cmedium -\nsand -sat-krw.csv \u2019 file. \n12. Click Open  to close the Open  file. \n13. Click OK to close the XY Series Editor  dialog.  \n14. Turn on Pressure -satura tion and click the Table  button to open the XY Series \nEditor  dialog.  \n15. Click the Import  button to bring up an Open  dialog.  \n16. Browse to the directory for the tutorial files and select the \u201cmedium -sand -p-\nsat.csv\u2019 file.  \n17. Click Open  to close the Open  dialog.  \n18. Click OK to close the XY Series Editor  dialog.  \n7.2 Create the \u201cCoarse Sand\u201d material  \n1. Click Add Row   to add a new material.  \n2. Change the new material name to \u201c Coarse Sand\u201d.  \n3. Leave Domain  at \u201cPorous media\u201d and change Zones  to \u201c2\u201d. \n4. Select the K isotropic  option and enter  \u201c5e-5\u201d. \n5. Turn on the Specific storage  option and enter \u201c1.2e -7\u201d. \n6. Turn on Porosity  and set it to \u201c0.34\u201d . \n7. Turn on Saturation -relative k  and click the Table  button to open the XY Series \nEditor  dialog.  \n8. Click Import  button to bring up an Open  dialog.  \n9. Browse to the directory for the tutorial files and select the \u201c coarse -sand -sat-\nkrw.csv\u2019 file.  \n10. Click Open  to close the Open  file. \n11. Click OK to close the XY Series Editor  dialog.  \n\nGMS Tutorials   HydroGeoSphere \u2013 Porous Media Domain  \n \n Page 13 of 15 \u00a9 Aquaveo 2024  12. Turn on Pressure -saturation and click the Table  button to open the XY Series \nEditor  dialog . \n13. Click Import  button to bring up an Open  dialog.  \n14. Browse to the directory for the tutorial files and select the \u201c coarse -sand -p-sat.csv\u2019 \nfile. \n15. Click Open  to close the Open  dialog.  \n16. Click OK to close the XY Series Editor  dialog.  \n7.3 Create the \u201cClay\u201d material  \n1. Click Add Row   to add a new material.  \n2. Change the new material name to \u201cClay\u201d.  \n3. Leave Domain  at \u201cPorous media\u201d and change Zones  to \u201c3\u201d. \n4. Select the K isotropic  option  and enter  \u201c1e-6\u201d. \n5. Turn on the Specific storage  option and enter \u201c1.2e -7\u201d. \n6. Turn on Porosity  and set it to \u201c0.51\u201d . \n7. Switch Unsaturated tables or functions  to \u201cFunctions \u201d. \n8. Ensure \u201cbrooks -corey\u201d is selected in the drop -down  in the Unsaturated functions  \nsection.  \n9. Turn on Residual saturation  and enter  \u201c0.183 \u201d. \n10. Turn on Air entry pressure  and enter  \u201c-0.016 \u201d. \n11. Turn on Exponent  and enter  \u201c2.12\u201d. \n12. Click OK to close the Materials  dialog.  \n8 Boundary Conditions  \nBoundary conditions are defined on feature objects in GMS coverages. When the model \nis saved, GMS intersects the features with the UGrid  to find the grid components (nodes, \ncells, faces, or segments) that should be associated with the boundary conditions, and \nwrites the boundary conditions to the GROK  file. \nThe boundary conditions in the porous media domain consist of four wells. The well \npoints are defined in the \u201c porous media BCs\u201d coverage . \n1. Turn off the \u201c 3d\u201d UGrid and the \u201c zones\u201d coverage.  \n2. Turn on the \u201c  porous media BCs\u201d coverage and select it to make it active.  \n3. Right -click on the \u201c  porous media BCs\u201d coverage and select Coverage T ype | \nHydroGeoSphere  | Boundary Conditions . \nTo assign the well boundary conditions : \n4. Using the Select Nodes   tool, drag a box to s elect all four points representing \nwells . \n5. Right -click and select  Assign Properties\u2026  to open the Point Properties  dialog.  \n6. From the list on the left, turn on Flux nodal . \n\nGMS Tutorials   HydroGeoSphere \u2013 Porous Media Domain  \n Page 14 of 15 \u00a9 Aquaveo 2024  7. Change the name to \u201cWell\u201d.  \nThe wells will all be assigned to node sheet 2 . A node sheet is the layer of nodes \nbetween two cell layers.  \n8. Set Minimum sheet  to \u201c2\u201d. \n9. Set Maximum sheet  to \u201c2\u201d. \n10. Change Input type  to \u201cTime series \u201d. \n11. Click the Edit XY Series \u2026 button  to open the XY Series Editor  dialog.  \n12. Enter the following:  \nTime Flux \n0 -0.0000277778  \n21600  0 \n43200  -0.0000277778  \n64800  0 \n13. Click OK to close the XY Series Editor  dialog.  \n14. Click OK to close the Point Properties  dialog.  \nThe boundary conditions for the porous media domain  are now defined . \n15. Drag the \u201c  porous media BCs\u201d coverage below the \u201c  R5\u201d simulation.  \n \nFigure 7      HydroGeoSphere simulation in the Project Explorer  \n9 Save the Project and S imulation  \nBefore continuing, complete the following:  \n1. Save   the project . \nThis saves the GMS project files, but not the HydroGeoSphere simulation files.  To create \nthe files for the HydroGeoSphere simulation, the simulation needs to be saved.  \n\nGMS Tutorials   HydroGeoSphere \u2013 Porous Media Domain  \n \n Page 15 of 15 \u00a9 Aquaveo 2024  2. Right-click on the \u201c  R5\u201d simulation and select Save Simulation  to open the  \nSaving HydroGeoSphere Simulation  dialog.  \n3. When finished, c lick OK to close the Saving HydroGeoSphere simulation  dialog.  \nSaving the simulation creates the GROK  file and the other files that it refers to.  The data \nin the files is based on the parameters set for the simulation in GM S. To view these files:  \n4. Right -click on the \u201c  R5\u201d simulation and select Open Containing Folder  to \nopen a Windows File Explorer . \nThe op ened file explorer shows the directory w here GMS saved the model files.  \n10 Run Grok  \n1. Right -click the \u201c R5\u201d simulation and select the Run grok  command  to open a \nrun dialog.   \nThe \u201cRun grok.exe\u201d dialog appears. The output from grok.exe is displayed . It should only \ntake a few seconds for grok .exe to finish. When it is done, there may be some warnings \nat the bottom of the output but there should not be any errors.  \n2. When the process finishes, click OK. \n11 Run Phgs  \nNow that the input files have been prepared by running  grok.exe, the model is ready to \nbe run.  \n1. Right -click the \u201c R5\u201d simulation and select the Run phgs  command . \nThe \u201cRun phgs.exe\u201d dialog appears. The progress dialog shows a plot of the residual \nerror versus time, and the output from phgs.exe . It will take a few minutes for phgs.exe to \nfinish.  \n2. When the process finishes, click OK. \n12 Read the Solution  \n1. Right -click the \u201c  R5\u201d simulation and select Read Solution to start the Read \nSolution  progress dialog.  \nWhen GMS is done reading the solution, the Read Solution  progress dialog should \ndisappear automatically if there are no errors.  \nA new Solution folder was added under the R5 simulation  with links to datasets that were \nadded  under a \u201cR5 (HydroGeoSphere)\u201d folder under the \u201c3d\u201d UGrid.  The \nHydroGeoSphere  \u2013 Post-Processing  tutorial has more information about how to examine \nthe solution.  \n13 Conclusion  \nThis concludes the \u201cHydroGeoSphere \u2013 Porous Media Domain\u201d tutorial.  Note that this \ntutorial only demonstrates the process of defining domains for a HydroGeoSpher e model. \nIt does not demonstrate a finished model. See additional GMS tutorials for more \ninformation on creating a complete HydroGeoSphere model.  \n\n", "filename": "HydroGeoSphere-pm.pdf", "pages": 15}, "HydroGeoSphere-Post": {"text": "GMS Tutorials   HydroGeoSphere \u2013 Post-Processing  \n Page 1 of 11 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nHydroGeoShere \u2013 Post -Processing  \nReview  a HydroGeoSphere model in GMS  \n \nObjectives   \nThis tutorial demonstrates post-processing options for  a HydroGeoSphere model in GMS . \nPrerequisite Tutorials  \n\uf0b7 Getting Started  \n\uf0b7 HydroGeoSphere \u2013 Porous \nMedia Domain  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 HydroGeoSphere Model & \nInterface  \n Time  \n\uf0b7 25\u201345 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   HydroGeoSphere \u2013 Post-Processing  \n Page 2 of 11 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Basic Workflow  ................................ ................................ ................................ ....................  3 \n3 Getting Started  ................................ ................................ ................................ .....................  4 \n4 Model Output  ................................ ................................ ................................ .......................  5 \n4.1 Observations ................................ ................................ ................................ .................  5 \n4.2 Hydrographs  ................................ ................................ ................................ .................  5 \n5 Save the Project and Simulation  ................................ ................................ ........................  6 \n6 Run Grok  ................................ ................................ ................................ ..............................  7 \n7 Run Phgs  ................................ ................................ ................................ ..............................  7 \n8 Examine the Solution  ................................ ................................ ................................ ..........  7 \n8.1 Read the Solution  ................................ ................................ ................................ .........  7 \n8.2 3D Datasets  ................................ ................................ ................................ ..................  7 \n8.3 3D Dataset s Vectors  ................................ ................................ ................................ ..... 8 \n8.4 2D Datasets  ................................ ................................ ................................ ..................  9 \n8.5 Solution Plots  ................................ ................................ ................................ ..............  10 \n9 Conclusion  ................................ ................................ ................................ .........................  11 \n \n1 Introduction  \nThis tutorial demonstrates  post-processing options for  a HydroGeoSphere  (HGS)  model \nin GMS. It is based off of the Intro to HydroGeoSphere  tutorial from Aquanty. Refer to \nthat tutorial and the HydroGeoSphere Reference Manual as needed.  \nIn the Intro to HydroGeoSphere  tutorial, the \u201cR5 Catchment\u201d model is developed. From \nthat tutorial:  \nThe model is quite simple compared to many \u2018 real world\u2019 models that you may \nbuild. But it contains sufficient complexity that it is perfectly suited to demonstrate \nthe overall HydroGeoSphere workflow. The intention of this tutorial is not to \nperfectly recreate the catchment, but to teach the process  of creating a small \nwatershed model in HGS. In fact, several of the inputs for the R5 model are \ncompletely arbitrary (e.g. the delineation of soil types and associated hydraulic \nproperties, boundary condition values, etc.).  \nThe R5 catchment covers a small  (approximately 0.1 km2) rangeland catchment \nnear Oklahoma City (Figure 3). The defined model includes basic flow in the \nporous medium and surface/overland flow domains, and includes \nevapotranspiration.1 \n                                                      \n1 HydroGeoSphere Intro Tutorial, pg 13  \nGMS Tutori als  HydroGeoSphere \u2013 Post-Processing  \n \n Page 3 of 11 \u00a9 Aquaveo 2024   \nFigure 1     HydroGeoSphe re Intro Tutorial, figure 3, pg 14  \n2 Basic W orkflow  \nFrom the Intro to HydroGeoSphere  tutorial, t he basic H GS workflow consists of 5 steps : \n1. Prepare data inputs  (e.g. various GIS files, 2D grid/mesh files, etc.)  \n2. Configure an input data file (the GROK  file) for the model pre -processor\u2026  \n3. Use executables (*.exe) to generate the model input files and solve the \nsimulation\u2026  \na. Grok.exe \u2013 compiles the GROK  file, generates input files for the \nnumerical simulator  \nb. Phgs.exe \u2013 reads model input files, performs the numerical simulation \n(i.e. it \u2018solves\u2019 the model)  \nc. Hsplot.exe OR hgs2vtu.exe \u2013 reformats model outputs for visualization  \n4. Visualize, analyze and interpret model results\u2026  \n5. Iterate on the model to add complexity, perform scenario analysis, calibrate, \netc\u20262 \nNote  that a GROK  file is prepared and then  the grok.exe run s. During the run, grok.exe  \nreads the GROK  file and prepares the actual model input files. Only then can the model \n(phgs.exe) be run.  \nThe HydroGeoSphere workflow is followed pretty closely when using G MS. The basic \nsteps to build an HGS model in GMS, and how these steps relate to the \nHydroGeoSphere workflow , are as follows:  \n1. Create the conceptual model (HGS step 1)  \n                                                      \n2 HydroGeoSphere Intro Tutorial, pg 13  \n\nGMS Tutorials   HydroGeoSphere \u2013 Post-Processing  \n Page 4 of 11 \u00a9 Aquaveo 2024  2. Create a 3D UGrid for the porous media domain   (HGS step 1)  \n3. Create a 2D UGrid for the 2D d omains: surface flow, ET (HGS step 1)  \n4. Save the simulation, which creates the GROK  file (HGS step 2)  \n5. Run grok.exe on the GROK  file to prepare input files for phgs.exe (HGS step 3a)  \n6. Run phgs.exe (HGS step 3b)  \n7. Read the solution and visualize the results (HGS step 4)  \n8. Iterate on the model to add complexity, perform scenario analysis, calibrate, \netc\u2026 (HGS step 5, not covered in this tutorial)  \n3 Getting  Started  \nDo as follows to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New comma nd to ensure that the program \nsettings are restored to their default state.  \n3. Click Open   to bring up the Open  dialog.  \n4. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n5. Browse to the hgs-post\\ folder and select \u201cstart .gpr\u201d. \n6. Click Open to import the project and exit the Open  dialog.  \nThe project should be visible in the Graphics Window ( Figure 2). The project contains a \nHydroGeoSphere  simulation that has already been set up to include a 3D UGrid. \nBoundary condition s, materials, and the model control parameters have been set.  \n \nFigure 2      The initial project  \nBefore continuing, it is recommended to save the pr oject with a new name.  \n\nGMS Tutori als  HydroGeoSphere \u2013 Post-Processing  \n \n Page 5 of 11 \u00a9 Aquaveo 2024  1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Browse to the directory  for this tutorial . \n3. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n4. Enter \u201c hgs_post .gpr\u201d as the File name . \n5. Click Save to save the project and close the Save As  dialog.  \n4 Model O utput \nGMS allows recording both observation and hydrograph data from the HydroGeoSphere \nmodel run. Doing this requires creating map coverages that can then be added to the \nsimulation.  \n4.1 Observations  \nCreate an observation coverage  by doing the following:  \n1. Turn off the \u201c  3d\u201d UGrid.   \n2. Right -click in the Project Explorer  and select New | Coverage\u2026  to generate a \nnew coverage  \n3. Right -click on \u201c  new coverage\u201d and select Rename . \n4. Enter \u201cobservations\u201d for the new name.  \n5. Right -click on the \u201c  observations\u201d coverage and select Coverage Type  | \nHydroGeoSphere  | Observations . \n6. Using the Create Point   tool, c reate a point anywhere in the model area . \n7. Keeping the new point selected, enter following coordinates :  \n\uf0b7 X = 360 \n\uf0b7 Y = 295 \n\uf0b7 Z = 398 \n8. Using  the Select Points \\Nodes   tool, double -click the point  to open the Point \nProperties  dialog.  \n9. In the list on the left, t urn on Observation point . \n10. For the Name  enter  \u201cpoint1\u201d . \nThe Interpolate option causes computed values from nearby points to be interpolated to \nthe observation point (corresponding to the \u201cMake interpolated observation point\u201d \ncommand). If off, computed values from the nearest point are used (corresponding to the  \n\u201cMake observation point\u201d command). For this example, l eave it off.  \n11. Click OK to close the Point Properties  dialog.  \n12. Drag the \u201c  observations\u201d coverage below the \u201c  R5\u201d simulation.  \n4.2 Hydrographs  \nCreate an hydrograph coverage  by doing the foll owing: \n1. Right -click on the \u201c  surface flow BCs\u201d coverage and select  Duplicate . \n\nGMS Tutorials   HydroGeoSphere \u2013 Post-Processing  \n Page 6 of 11 \u00a9 Aquaveo 2024  2. Right -click on \u201c  Copy of surface flow BCs\u201d and select Rename . \n3. Enter \u201chydrographs\u201d for the new name.  \n4. Right -click on the \u201c  hydrographs \u201d coverage and select Coverage Type  | \nHydroGeoSphere  | Hydrographs.  \n5. Using the Select Arc   tool, double -click the top arc to open the Arc Properties  \ndialog.  \n6. In the list on the left, t urn on Hydrograph . \n7. Set the Name to \u201cOutlet\u201d . \n8. Turn on  the Map to grid boundary  option.  \n9. Click OK to close the Arc Properties  dialog.  \n10. Drag the \u201c  hydrographs\u201d coverage below the \u201c  R5\u201d simulation.  \n \nFigure 3      The HydroGeoSphere simulation in the Project Explorer  \n5 Save the Project and S imulation  \nBefore continuing, complete the following:  \n1. Save   the project . \n2. Right -click on the \u201c  R5\u201d simulation and select Save Simulation  to open the  \nSaving HydroGeoSphere simulation  dialog.  \n3. When finished, c lick OK to close the Saving HydrogGeoSphere Simulation  \ndialog.  \n\nGMS Tutori als  HydroGeoSphere \u2013 Post-Processing  \n \n Page 7 of 11 \u00a9 Aquaveo 2024  Saving the simulation creates the GROK  file and the other files that it refers to.  To view \nthese files:  \n4. Right -click on the \u201c  R5\u201d simulation and select Open Containing Folder  to \nopen a Windows File Explorer . \nThe opened file explorer shows the directory where GMS saved the model files.  \n6 Run Grok  \n1. Right -click the \u201c R5\u201d simulation and select the Run grok  command  to open a \nrun dialog.  \nThe \u201cRunning grok.exe\u201d dialog appears. The output from grok.exe is displayed . It should \nonly take a few seconds for grok .exe to finish. When it is done, there may be s ome \nwarnings at the bottom of the output but there should not be any errors.  \n2. When the process finishes, click OK. \n7 Run Phgs  \nNow that the input files have been prepared by running grok.exe, the model is ready to \nbe run.  \n1. Right -click the \u201c R5\u201d simulation and select the Run phgs  command . \nThe \u201cRun phgs.exe\u201d dialog appears. The progress dialog shows a plot of the residual \nerror versus time, and the output from phgs.exe . It will take a few minutes for phgs.exe to \nfinish.  \n2. When the process finish es, click OK. \n8 Examine the Solution  \n8.1 Read the S olution  \n1. Right -click the \u201c R5\u201d simulation and select Read Solution to start the Read \nSolution  progress dialog.  \nWhen GMS is done reading the solution, the Read Solution  progress dialog should \ndisappear automatically if there are no errors.  \nA new Solution folder was added under the R5 simulation, with subfolders \u201c pm\u201d, and \u201c olf\u201d. \nThese contain links to datasets that were added  under \u201cR5 (HydroGeoSphere)\u201d folders \nunder the \u201c3d\u201d and \u201ctop 2d\u201d UGrids. Let\u2019s look at some of the datasets.  \n8.2 3D Datasets  \n1. Turn off all \u201c Map Data \u201d. \n2. Turn on the \u201c 3d\u201d UGrid . \n3. Under the \u201c 3d\u201d UGrid, expand the \u201c  R5 (HydroGeoSphere) \u201d and  \u201c pm\u201d \nfolder s, select the \u201c  head_pm\u201d dataset . \n\nGMS Tutorials   HydroGeoSphere \u2013 Post-Processing  \n Page 8 of 11 \u00a9 Aquaveo 2024  4. In the Time Step window below the Project Explorer, select the Options  button  to \nopen the Time Settings  dialog.  \n5. Change the Relative  option to \u201cseconds\u201d . \n6. Click OK to close the Time Settings  dialog.  \n7. Select different time steps and see that the contours change a little with time.  \n \nFigure 4     3D \"head_pm\" dataset  \n8.3 3D Datasets Vectors  \n1. Under the \u201c pm\u201d folder , select the \u201c  q_pm\u201d dataset.  \n2. Click the Display Options   macro to open the Display Options  dialog.  \n3. Turn off Cell edges  and turn on Vectors . \n4. Click OK to close the Display Options  dialog.  \n5. Select different time steps and see that the vectors change a little with time.  \n\nGMS Tutori als  HydroGeoSphere \u2013 Post-Processing  \n \n Page 9 of 11 \u00a9 Aquaveo 2024   \nFigure 5     3D \"q_pm\" vectors  \n8.4 2D Datasets  \n1. Turn off the \u201c 3d\u201d UGrid and turn on and select the \u201c  top 2d\u201d UGrid . \n2. Under the \u201c  top 2d\u201d UGrid, expand the \u201c  R5 (HydroGeoSphere) \u201d and \u201c olf\u201d \nand \u201c  BCs\u201d folder s and s elect the \u201c  CritDepth_outlet -Flux (nodal) \u201d dataset . \nAll the datasets in the \u201c BCs\u201dfolder were created by boundary conditions. The \u201c  \nCritDe pth_outlet -Flux (nodal) \u201d dataset was created by the critical depth boundary \ncondition on the top arc. The dataset has meaningful values at the points where the \nboundary condition arc is defined and null values at all other points.  \n3. Click the Display Options   macro to open the Display Options  dialog.  \n4. Turn off Face contours  and Vectors  then turn on Cell edges  and Point contours . \n5. Click OK to close the Display Options  dialog.  \n6. Select the last time step and see that the point contours change.  \n\nGMS Tutorials   HydroGeoSphere \u2013 Post-Processing  \n Page 10 of 11 \u00a9 Aquaveo 2024   \nFigure 6      2D \" CritDepth_outlet -Flux (nodal) \" dataset  \n8.5 Solution Plots  \nIn addition to datasets on the UGrids, GMS also read in a number of plots when the \nsolution was read.  \n1. Right -click the \u201c  R5\u201d simulation and select the Solution Plots  command  to \nopen the Solution Plots  dialog.  \n \nFigure 7      HydroGeoSphere solution plots  \n\nGMS Tutori als  HydroGeoSphere \u2013 Post-Processing  \n \n Page 11 of 11 \u00a9 Aquaveo 2024  The window on the left of the dialog lists the plots that can be displayed. They are \ngrouped by the file that they came from. The currently selected item is displayed in the \nplot window on the right. Multiple plots can be displayed simultaneously by toggling them \non in this list.  Notice there are plots for the boundary conditions (\u201cTransient water balance \nsummary -Well\u201d etc), the observation point (unde r \u201cR5o.observation_well_flow.point1.dat\u201d) \nand the hydrograph (under \u201cR5o.hydrograph.Outlet.dat\u201d). The water balance file plots are \ndisplayed by default.  \n2. Expand other files and click on different plots to see the plot data generated by \nHydroGeoSphere.  \n3. Click  on the View Data   button to open the Plot Data  dialog to see  the plot \ndata values.  \n9 Conclusion  \nThis concludes the  \u201cHydroGeoSphere Post -Processing\u201d  tutorial.  \n \n\n", "filename": "HydroGeoSphere-Post.pdf", "pages": 11}, "ImportFromWeb": {"text": "GMS Tutorials   Importing from Web  \n Page 1 of 5 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nImport from Web  \nDownload images from a web database  \n \nObjectives   \nThis tutorial gives an overview of the Importing From Web  option offered by GMS. This option connects \nGMS to a web based program that adds additional functionality to the GMS program.  The two programs \ninteract through an internet connection and allow accessing satellite photographs easily and quickly.  \n \nThis tutorial will review the basic skills concerning how to use the Import From Web  option.   \n \nPrerequisite Tutorials  \n\uf0b7 None  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 Internet Connection  \n Time  \n\uf0b7 10\u201320 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   Importing from Web  \n Page 2 of 5 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 GMS User Interface ................................ ................................ ................................ ..............  2 \n2.1 Selecting the Location of the Aerial Photo  ................................ ................................ .... 2 \n2.2 Saving the Image  ................................ ................................ ................................ ..........  3 \n3 Importing a World Topographic Image  ................................ ................................ ..............  4 \n3.1 Selecting the Lo cation for the Topographic Image  ................................ ........................  4 \n3.2 Saving the Image  ................................ ................................ ................................ ..........  4 \n4 Conclusion  ................................ ................................ ................................ ...........................  5 \n \n1 Introduction  \nThe Import From Web  option adds an easier way to obtain images from the internet to \nuse as backgrounds for GMS projects. GMS is able to connect to a data server then \nretrieve selected photographs or maps of just about any location desired. Two specific file \ntypes can  be obtained through using this option: \n\uf0b7 Aerial photo \n\uf0b7 World topographical map  \n2 GMS User Interface  \nAn aerial photo can be  imported into GMS and saved as a background image for a \nproject.  \n2.1 Selecting the Location of the Aerial Photo \nTo open the project in GMS, do the following:  \n1. Select File | New to clear all previous data.  \n2. If asked to confirm deletion of all data, click Don\u2019t Save .  \n3. Select File | Import From Web...  to bring up the Virtual Earth Map Locator  \ndialog.  \nFor this tutorial , use the following location: Shinnecock Bay, Long Island, NY.  \n4. Enter \u201cShinnecock Bay\u201d in the Place to search for  field and click Jump to Search \nLocation . \n5. Switch the drop -down view menu to \u201cImagery\u201d to get an aerial view.  \n6. Drag the image to center the bay in  the window.  \n7. Zoom in to a comfortable view where the entire bay fits the screen ( Figure  1). \nGMS Tutorials   Importing from Web  \n \n Page 3 of 5 \u00a9 Aquaveo 2024   \n      Figure  1       Shinnecock  Bay \n8. Click OK button to close the Virtual Earth Map Locator  dialog.  \n9. Click OK at message stating a projection needs to be set.  \n10. Accept the projection in the Display Projection  dialog and click OK to bring up the \nData Service Options  dialog.  \nGMS then takes t he last image that was in the dialog and allows for saving it in a few \nways.  \n2.2  Saving the Image  \nIn the Data Service Options  dialog, there are five file options (scroll right to view all of \nthem).  \n1. Select World Imagery  and click OK to close the Data Service  Options  dialog and \nopen the Save Web Services Data File(s)  dialog.  \n2. Select \u201cWeb Services Files (*.web)\u201d from the Save as type  drop-down.  \n3. Browse to the desired location to save the file and enter \u201cshinnecock_bay\u201d as the \nFile name . \n4. Click Save  to close the Save Web Services Data File(s)  dialog.  \n5. When asked to confirm the creation of the file, click Yes to bring up the Raster \nCell Size dialog.  \nThe confirmation dialog shows the complete path of the file and shows the extension of \nthe file. Since this file is an aerial file, it ends with \u201c*_w_imagery.tif\u201d. Other image types \nhave unique file extensions to help in differentiation.  \nA suggested scale is already provided in the Raster Cell Size  dialog, but a different scale \ncan be selected if desired. Remember that the  lower the scale the more detailed the \nimage and the more time it will take to save.  \n6. Click OK to accept the default size and exit the Raster Cell Size  dialog.  \nGMS then creates the file and loads the image into the Graphics Window.  \n\nGMS Tutorials   Importing from Web  \n \n Page 4 of 5 \u00a9 Aquaveo 2024  3 Importing a World Topographic Image  \nA world topograp hic image can be imported into G MS and saved to serve as a \nbackground for a project.  \n3.1  Selecting the Lo cation for the Topographic Image  \nTo open a new project in GMS, do the following:  \n1. Select File | New to clear all previous  data.  \n2. If asked to confirm deletion of all data, click Don\u2019t Save . \n3. Select File | Import From Web...  to bring up the Virtual Earth Map Locator  \ndialog.    \nThe location from the previous section has been saved by the Virtual Earth Map Locator , \nso there is not  a need to search for the same location again. However, if the location was \nchanged, follow step 4 in section 2.1.  \n4. Zoom in to a view where the entire bay fits the screen nicely  (Figure 2). \n5. Change the drop -down set to \u201cTopographic\u201d.  \n6. Click OK button  to close the Virtual Earth Map Locator  dialog.  \n7. Click OK at message stating a projection needs to be set.  \n8. Accept the projection in  the Display Projection  dialog and click OK to bring up the \nData Service Options  dialog . \n \n      Figure 2      Shinnecock Bay  \n3.2  Saving the Image  \n1. Scroll to the right to select World Topo Map  and click OK to close the Data \nService Options  dialog and bring up the Save Web Services Data File(s)  dialog.  \n2. Select \u201cWeb Services Files (*.web)\u201d from the Save as type  drop-down.  \n\nGMS Tutorials   Importing from Web  \n \n Page 5 of 5 \u00a9 Aquaveo 2024  3. Browse to the desired location to save the file and enter \u201cshinnecock_bay_topo\u201d \nas the File name . \n4. Click Save  to close the Save Web Services Data File(s)  dialog.  \n5. When asked to confirm the creation of the file, click Yes to bring up the Raster \nCell Size dialog.  \n6. Click OK to accept the default size and exit the Raster Cell Size  dialog.  \nGMS then creates the file and  loads the image into the Graphics Window.  \n4 Conclusion  \nThis concludes the \u201cImport from Web\u201d tutorial. Feel free to c ontinue to experiment with \nthis part of GMS, or exit the program.  \n \n", "filename": "ImportFromWeb.pdf", "pages": 5}, "Lidar": {"text": "GMS Tutorials   Lidar  \n Page 1 of 12 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nLidar  \nUsing lidar for interpolation and visualization in GMS  \n \nObjectives   \nThis tutorial teaches how lidar data can be used in GMS for display and interpolation.  \n \nPrerequisite Tutorials  \n\uf0b7 Getting Started  Required Components  \n\uf0b7 GMS  Core  \n Time  \n\uf0b7 10\u201320 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   Lidar  \n Page 2 of 12 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Importing Lidar Data  ................................ ................................ ................................ ............  2 \n3 Lidar Display Options  ................................ ................................ ................................ ..........  4 \n3.1 Filtering Lidar  ................................ ................................ ................................ ................  4 \n3.2 Contours  ................................ ................................ ................................ .......................  5 \n3.3 Color by classification  ................................ ................................ ................................ ... 6 \n3.4 Number of points displayed  ................................ ................................ ..........................  6 \n3.5 Bounding box  ................................ ................................ ................................ ................  7 \n3.6 Trimming Lidar  ................................ ................................ ................................ ..............  7 \n4 Exporting a Filtered Lidar  ................................ ................................ ................................ ... 8 \n5 Converting Lidar to a Raster  ................................ ................................ ..............................  9 \n6 Interpolate Lidar to a UGrid  ................................ ................................ ..............................  10 \n7 Filling holes when Interpolating  ................................ ................................ .......................  12 \n8 Multiple Lidar Files  ................................ ................................ ................................ ............  12 \n9 Conclusion  ................................ ................................ ................................ .........................  12 \n \n1 Introduction  \nLidar stands for Light Detection and Ranging . A lidar file typically contains many 3D \npoints representing features on the Earth\u2019s surface.  \nLidar data can be used in GMS for display and interpolation to other objects. A number of \nfeatures exist to efficiently handle the large amount of data that is typical with lidar, such \nas options to display a subset of points and exclude points. T o maintain efficiency, \nindividual points cannot be selected or edited.  \nIn this tutorial, a lidar file representing the area around Boulder, Colorado, will be \nimported and used in various ways. Topics covered include:  \n\uf0b7 Importing a lidar file  \n\uf0b7 Filtering lida r  \n\uf0b7 Changing the display options  \n\uf0b7 Exporting lidar  \n\uf0b7 Interpolating to ugrids  \n\uf0b7 Creating a raster from a lidar file  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2 Importing Lidar Data  \nStart with opening a file containing lidar data. Lidar data is typically very dense and the \nfiles can be very large.  \n1. Click Open   to bring up the Open  dialog.  \n2. Browse to the Tutorials \\GIS\\lidar directory . \n\nGMS Tutorials   Lidar  \n \n Page 3 of 12 \u00a9 Aquaveo 2024  3. Select \u201cRaster/DEM Files\u201d from the Files of type  drop-down and select \u201c22.las\u201d.  \n4. Click Open  to close the Open  dialog.  \nThe Graphics Window should appear similar to Figure 1. This is a lidar of almost one \nmillion points located near Boulder, Colorado. Only 50,000 points are being displayed \ndue to the current display options. Notice in the status bar in the bottom r ight of the GMS \nwindow, the projection is being displayed. The projection information was included in the \nlidar file and GMS set the display projection to match it. For more information on \nprojections, refer to the \u201cProjections\u201d tutorial.  \n \n      Figure 1      Lidar data in GMS  \n5. Zoom in and out on the raster using the mouse wheel or Zoom  . If zooming in \nfar enough, individual points can be seen as in Figure 2. \n6. When done zooming in, click on the Frame  macro.  \n \n       Figure 2      Lidar points  \n\nGMS Tutorials   Lidar  \n \n Page 4 of 12 \u00a9 Aquaveo 2024  \n3 Lidar Display Options  \nEach lidar file has its own display options. This differs f rom how GMS works with most \nother objects. The lidar display options are accessed by right -clicking on the lidar items in \nthe Project Explorer.  \n1. Right -click on \u201c  22.las\u201d, and then select Display Options\u2026  to bring up the \nLidar Display Options \u2013 22.las  dialog.  \n \n      Figure 3      Lidar Display Options dialog  \n3.1 Filtering Lidar  \nLidar use classifications and return types for each point, signifying a possible trait the \npoints have. The classifications have been given a name based on possible terrain types, \nhowever they may not actually represent the given name.  It is possible to f ilter out points \nfrom the display that do not meet certain criteria. On the right side of the dialog, there is \nan Exclude by  section.  Notice that it currently has Classification  selected. Below this \nsection is a table listing each existing classification.   Notice that each classification is \ncurrently checked except \u201cLow Point (Noise)\u201d.  \n2. Check \u201cLow Point (Noise)\u201d.  \n3. Click Apply . If necessary, move the dialog to the side so the graphics window \ncan be seen.  \nThe display should now look something like Figure 4. Notice that by including the \nextreme values the contour coloring provides a less interesting picture. Note that by \nturning off the \u201cLow Point (Noise)\u201d p oints they will not be used if interpolating from \u201c\n22.las\u201d. By default, extreme values are not displayed when import a lidar file.  \n Filtering affects the points that are used when interpolating from lidar . \n \n \n\nGMS Tutorials   Lidar  \n \n Page 5 of 12 \u00a9 Aquaveo 2024   \n      Figure 4      Lidar data filtering out one classification  \n4. Uncheck \u201cLow Point (Noise)\u201d to return to the previous display options.  \n5. In the Exclude by section, click Return Type . Notice that the table below \nchanges.  \n6. Check Second but not -last then click Apply . \nThe disp lay should now look similar to Figure 5. \n \n      Figure 5      Lidar data filtered by a return type  \n7. Change the filter back to Classification  and click Apply  to return to the original \ndisplay options.  \n3.2 Contours  \n1. In the Points section, make sure that Contours is selected.  \n2. Click the Options\u2026  button next to Contours  to open the Dataset Contour \nOptions \u2013 Lidar \u2013 22.las  dialog . \n\nGMS Tutorials   Lidar  \n \n Page 6 of 12 \u00a9 Aquaveo 2024  \nThe lidar  contour options are the same contour options that are used throughout GMS, \nalthough some things are disabled.  \n1. Click Color Ramp\u2026 to open the Choose color ramp  dialog . \n2. Select the Hue 1 color palette.  \n3. Click the Reverse   button.  \n4. Click OK to close the Choose color ramp dialog .   \n5. Click OK to close the Dataset Contour Options \u2013 Lidar \u2013 22.las  dialog.  \n6. Click Apply  in the Lidar Display Options \u2013 22.las  dialog.  \nNotice that the contours are still visible, but now blue is used for the maximum value \ninstead of the minimum value.  \n3.3 Color by classification  \nNow to look at assigning classification specific colors:  \n1. Select Color by classification . \n7. In the table on the right of the dialog, change the color of \u201cUnclassified\u201d to gre en, \n\u201cGround\u201d to brown, and \u201cWater\u201d to blue.  \n8. Click Apply . \nThe display should now look similar to Figure 6.  \n \n      Figure 6      Points colored by classification  \n3.4 Number of points displayed  \nNotice that the Total number of points in file  is more than the Number of points displayed . \nBecause lidar files typically have a lot of points, GMS only displays the number of points \nspecified  in order to speed up the display of the lidar file. However, when the lidar is used \nas an interpolation source, GMS uses all the points in the file, not just those being \ndisplayed.  \n The number of points displayed does NOT affect the points used when \ninterpolating from lidar.  \n\nGMS Tutorials   Lidar  \n \n Page 7 of 12 \u00a9 Aquaveo 2024  \n2. Change the Max number of points  displayed  to 100,000 and click Apply . \nNotice there are more points being displayed.   \n3.5 Bounding box  \nWith some files, it can be hard to identify the extents of the lidar. To resolve this issue:  \n1. Check the box marked Show bounding box.   \n2. Click OK to close the Lidar Display Options  \u2013 Lidar \u2013 22.las  dialog.  \n9. Click Oblique View  . \nNotice that this created a box around the extents of the lidar. The box style can be \nchanged by clicking the Options\u2026  button next to the Show bounding box  option.  \n3.6 Trimming Lidar  \nSometimes the lidar covers an area much larger than the area of interest.  Lidar can be \ntrimmed to the area of interest. Note that when a trimmed lidar is used as an interpolation \nsource, only the trimmed area is used.  \n Trimming affects the points that are used when interpolating from lidar . \n \n1. Switch to Plan View . \n2. Zoom   in on the right side of the points as shown in Figure 7. \n \n      Figure 7      Zoomed in on right side  \n10. Return to the Lidar Display Options \u2013 Lidar \u2013 22.las  dialog by right -clicking on    \u201c\n 22.las\u201d in the Project Explorer and selecting the Display Options\u2026  \ncommand.  \n11. In the upper -right corner, check Exclusion extents , then click the Options\u2026  \nbutton next to it to being up the Lidar Exclusion Exte nts dialog.  \n12. Check on the X/Y option.  \n\nGMS Tutorials   Lidar  \n \n Page 8 of 12 \u00a9 Aquaveo 2024  13. Click the Update  button. This sets the Min and Max values in the table.  \nThe Update  button gets the X and Y extents of the current view and updates the values \nin the table below. For the Update  button to work, the displa y must be in plan view. The \nmin and max X,Y , and Z values can also be edited manually if desired.  \n14. Click OK to close the Lidar Exclusions Extents  dialog.  \n15. Click OK to close the Lidar Display Options \u2013 Lidar \u2013 22.las  dialog.  \n16. Switch to Oblique View  . \nNotice the lidar extents have been trimmed and the display should look something like \nFigure 8. \n \nFigure 8      Trimmed lidar  \n \n4 Exporting a Filtered Lidar  \nGMS can export a filtered lidar file. The exported file will only include the filtered points.  \n1. Right -click on \u201c  22.las\u201d, and click Export\u2026  to open the Lidar File  dialog.  \n17. Enter \u201c22_filtered\u201d for the File Name .   \n18. Click Save  to close the Lidar File  dialog and export the lidar file.  \nIf desired, the file could be changed this using the drop -down menu, and saved as a *.laz \nfile (compressed). A *.laz file is the same as a *.las file but compressed.   \n19. Click the New  macro.  \n20. Select Don\u2019t Save  at the prompt.  \n21. Click Open    to bring up the Open dialog . \n22. Select \u201cRaster/DEM Files\u201d from the Files of type  drop-down.  \n23. Select the \u201c22_filtered.las\u201d file and click Open . \n\nGMS Tutorials   Lidar  \n \n Page 9 of 12 \u00a9 Aquaveo 2024  The display should appear similar to Figure 9. \n \nFigure 9     Filtered lidar  \n24. Right -click on \u201c  22_filtered.las\u201d, and then select Display Options  to bring up \nthe Lidar Display Options \u201322filtered.las  dialog.  \nNotice in the Classification table \u201cLow Point (Noise)\u201d is no longer present, because when \nexporting the previous lidar file, \u201cLow Point (Noise)\u201d was filtered out.  \n25. Click Cancel  to close the Lidar Display Options \u201322filtered.las  dialog. \n5 Converting Lidar to a Raster  \nLidar data can be converted into a raster. Unlike lidar, rasters are uniformly gridded data. \nSince rasters can also be used as a source of interpolation, it can be useful to convert the \nlidar to a raster that has fewer data  points and then use the raster for interpolation \nthereafter. In this case, the raster would use less memory and would draw faster than the \nlidar.  \nConvert a lidar to a raster by doing the following:  \n2. Right -click on \u201c  22_filtered.las\u201d, then click Interpolat e To | Raster\u2026  to open \nthe Interpolate Lidar to Raster  dialog.  \n26. Change the Cell size  to \u201c2\u201d.  \nNotice that the cells (X Y) boxes changed their values to fit the Cell size . \n27. Click OK to close the Interpolate Lidar to Raster  dialog and open the Raster File  \ndialog.  \n28. Click Save  to close the Raster File  dialog without changing the default filename.  \n29. Uncheck \u201c  22_filtered.las\u201d in the Project Explorer.  \nThe raster now in the display should look similar to Figure 10. \n\nGMS Tutorials   Lidar  \n \n Page 10 of 12 \u00a9 Aquaveo 2024   \n      Figure 10      Raster converted from lidar \n6 Interpolate Lidar to a UGrid  \nLidar can be interpolated to a U Grid. Start with importing a 2D UGrid.  \n1. Turn off \u201c  22_filtered.tif\u201d and turn on \u201c  22_filtered.las\u201d in the Project \nExplorer.  \n2. Click Open    to bring up the Open dialog . \n3. Select \u201cAll Files (*.*)\u201d from the Files of type  drop-down.  \n30. Select the \u201cugrid.vtu\u201d file and click Open . \nThis is a 2D grid that is in a loca tion where a groundwater model will be created.  \n31. Right -click on \u201c  22_filtered.las\u201d in the Project Explorer and click Interpolate to  | \nUGrid to open the Interpolate Lidar to UGrid  dialog.  \nThe target UGrid can be specified but it should already be set to the  one that was just \nopened so it does not need to be changed. The lidar can be interpolated to either the \nUGrid points (cell corners) or to the cell centers. The area average radius defines a \nsquare surrounding each point being interpolated to, with the len gth of each square side \nequaling twice the radius. The lidar points found within each box are averaged to \ndetermine the interpolated value at the UGrid point, as shown in Figure 11. \n\nGMS Tutorials   Lidar  \n \n Page 11 of 12 \u00a9 Aquaveo 2024   \n      Figure 11      Area average radius defining boxes around cell centers  \n32. Select Cell centers  in the Target dataset location  section.  \n33. Click OK to close the Interpolate Lidar to UGrid  dialog.  \nNotice that a new dataset appeared under \u201c  ugrid\u201d in the Project Explorer, titled \u201c  \n22_filtered\u201d. To see the interpolated values of the UGrid, turn on contours for the UGrid.  \n34. Click the Display Options   macro to open the Display Options  dialog.  \n35. Select \u201cU Grid: ugrid \u2013 [Active]\u201d from the list on the left.  \n36. Check on Face contours.   \n37. Select Options\u2026  next to Face contours  to bring up the Dataset Contour Options \n\u2013 UGrid \u2013 22_filtered dialog.  \n38. Select \u201cBlock Fill\u201d from the Contour method drop-down.  \n39. Click OK to close  the Dataset Contour Options \u2013 Ugrid \u2013 22_filtered dialog.  \n40. Click OK to close the Display Options  dialog.  \n41. Turn off \u201c  22_filtered.las\u201d.  \nThe display should now look something like  Figure 12. \n\nGMS Tutorials   Lidar  \n \n Page 12 of 12 \u00a9 Aquaveo 2024   \nFigure 12      UGrid with interpolated values  \n7 Filling holes when Interpolating  \nWhen interpolating from a lidar  to create a raster or to create a new dataset on a UGrid, \nthere may be sparse areas in the lidar that would potentially leave \u201choles\u201d in the raster or \ndataset. GMS will attempt to fill these holes by interpolating from the raster or UGrid cells \naround the  hole, if the hole is surrounded by cells that have valid data. Sparse areas that \nare not completely surrounded by cells with valid data will be left with \u201cno data\u201d values.  \n8 Multiple Lidar Files  \nMultiple lidar files can be used when creating rasters and int erpolating to UGrids. This is \ndemonstrated in the \u201cLidar with Multiple Files\u201d tutorial.  \n9 Conclusion  \nThis concludes the GMS \u201cLidar\u201d tutorial. The following topics were discussed and \ndemonstrated:  \n\uf0b7 Lidar are images with elevation data.  \n\uf0b7 Lidar can be filtered an d trimmed to show data desired.  \n\uf0b7 Lidar can be exported.  \n\uf0b7 Lidar can be converted to rasters or interpolated to UGrids.  \n \n\n", "filename": "Lidar.pdf", "pages": 12}, "Lidar_with_Multiple_Files": {"text": "GMS Tutorials   Lidar with Multiple Files  \n Page 1 of 6 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nLidar with Multiple Files  \nUsing multiple lidar files for interpolation in GMS  \n \nObjectives   \nThis tutorial teaches how multiple lidar files can be used in GMS for display and interpolation to rasters \nand UGrids.  \n \nPrerequisite Tutorials  \n\uf0b7 Lidar  Required Components  \n\uf0b7 GMS Core  \n Time  \n\uf0b7 10\u201320 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   Lidar with Multiple Files  \n Page 2 of 6 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Importing Multiple Lidar Files  ................................ ................................ .............................  2 \n3 Merging Lidar Files  ................................ ................................ ................................ ..............  4 \n3.1 Exporting a Merged Lidar File  ................................ ................................ .......................  4 \n3.2 Importing a Merged Lidar File  ................................ ................................ .......................  4 \n4 Converting Lidar to a Raster Using Multiple Files  ................................ ............................  4 \n5 Interpolate Lidar to a UGrid Using Multipl e Files  ................................ ..............................  5 \n6 Conclusion  ................................ ................................ ................................ ...........................  6 \n \n1 Introduction  \nLidar is often used to conduct elevation and shallow bathymetric surveys that can be \nsaved as point clouds or rasters. These can then be imported into GMS for use in various \nprojects. If multiple lidar files are loaded into GMS, they can all be used to create rasters \nand to be interpolated to UGrids. They can also be merged together for convenience.  \nFor discussion of the basic lidar interface in GMS, please refer to the \u201cLidar\u201d tutorial. It is \nrecommended that tutorial be completed prior to th is tutorial.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2 Importing Multiple Lidar Files  \nBegin by opening f our lidar files containing data from Mount St. Helens, a volcano that \nerupted violently in 1980 in the state of Washington in the United States.  \nOpen the four files by doing the following:  \n1. Click Open   to bring up the Open  dialog.  \n2. Browse to the Tutorials \\GIS\\lidarWithMultipleFiles  directory . \n3. Select \u201cRaster/DEM Files\u201d from the Files of type  drop-down.  \n4. While holding the Shift key down, select \u201cmounnelst.las\u201d, \u201cmounnwlst.las\u201d, \n\u201cmounselst.las\u201d, and \u201cmounnswlst.las\u201d.  \n5. Click Open  to close the Open  dialog and import the files.  \nAfter several seconds, the Graphics Window should appear similar to Figure 1. By default \nGMS displays a maximum of 50,000 points per lidar file, so 200,000 points are being \ndrawn. The total number of points is over 23 million.  \n\nGMS Tutorials   Lidar with Multiple Files  \n \n Page 3 of 6 \u00a9 Aquaveo 2024   \n      Figure 1      Mount St. Helens lidar files  \nNow change the perspective to  be able to see the elevation more clearly.  \n6. Switch to Oblique View   to see the volcano in perspective view.  \nThe project should now appear similar to Figure 2. \n \n       Figure 2      In oblique view  \nNow return the view to the top -down, or Plan view, by doing the following:  \n7. Switch to Plan View  . \nNotice that the edges of each lidar  file can be discerned as a break in the color shading. \nThis is a result of each lidar file having its own display options and thus its own minimum \nand maximum data range used in the contour options. Setting the contour range to be the \nsame for all the lid ar files is one way to correct this. Merging the lidar files into one file, as \ndemonstrated in the next section, is another way.  \n\nGMS Tutorials   Lidar with Multiple Files  \n \n Page 4 of 6 \u00a9 Aquaveo 2024  3 Merging Lidar Files  \nMultiple lidar files can be merged into one file. GMS creates a new lidar file that contains \nthe data of al l the individual files.  \n3.1 Exporting a Merged Lidar File  \n1. In the Project Explorer, select all four Mount St. Helens lidar files by selecting the \nfirst file then holding down the Shift key and selecting the last file.  \n2. Right -click on any of the selected files an d select the Merge\u2026  command to open \nthe Lidar File  dialog.  \n3. Enter \u201call.laz\u201d in the File name  field and click Save . \nIt may take several seconds to create the merged file. The LAZ format is a compressed \nlidar format.  \n3.2 Importing a Merged Lidar File  \nNow import t he file that was just created.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cRaster/DEM Files\u201d from the Files of type  drop-down.  \n3. Select the \u201call.laz\u201d file.  \n4. Click Open  to close the Open  dialog.  \n5. In the Project Explorer, turn off the original four LAS files. \nNotice that the merged file appears sparser because only 50,000 points are being drawn \nto represent 23 million points. This could be changed by increasing the number of points \ndisplayed in the Lidar Display Options  dialog.  \nAlso notice that the color ation is now smooth with no sharp breaks. This is because there \nis only one minimum and maximum range used for contouring.  \nThe rest of the tutorial will use the original four lidar files so the merged lidar file can be \nremoved.  \n6. In the Project Explorer, rig ht-click the \u201c  all.laz\u201d file and select Remove . \n7. Turn on the four LAS files.  \n4 Converting Lidar to a Raster Using Multiple Files  \nA raster can be created from multiple lidar files. If the files overlap, the overlapping data \nwill be averaged to get the raster values.  \nConvert all the lidar to a raster by doing the following:  \n1. In the Project Explorer, select all four lidar files using the Shift key. \n2. Right -click on any of the selected files and choose the Interpolate To  | Raster  \ncommand to open the Interpolate Lidar to Raster  dialog.  \n3. Accept all of the default values and click OK to open the Raster File  dialog.  \n4. Change the File name  to \u201call\u201d and click Save  to close the Raster File  dialog.  \n\nGMS Tutorials   Lidar with Multiple Files  \n \n Page 5 of 6 \u00a9 Aquaveo 2024  5. In the Project Explorer, turn off the original four LAS files.  \nThe raster should appear similar to Figure 3.  \n \n      Figure 3      Raster converted from multiple lidar files  \nThe rest of t he tutorial does not use the raster file, so it can be deleted.  \n6. In the Project Explorer, right -click the \u201c  all.tif\u201d file and select Remove . \n7. Turn on \u201c  GIS Layers\u201d, which will turn on all of the lidar files.  \n5 Interpolate Lidar to a UGrid Using Multiple Files  \nMultiple lidar files can be interpolated to a U Grid, much in the same way the raster was \ncreated.  If the files overlap, the overlapped regions will be averaged to determine the \ndata values.  \nStart with importing a 2D UGrid.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cAll Files (*.*)\u201d from the Files of type  drop-down.  \n3. Select \u201cmultipleLidar.vtu\u201d and click Open . \nThis is a 2D grid that is in a location where a groundwater model could be created.  \n4. Select all of the LAS files in the Project Explorer.  \n5. Right -click on any of the selected files and select Interpolate To  | UGrid  to open \nthe Interpolate Lidar to UGrid  dialog.  \n6. In the Target dataset location  section, select Points . \n7. Enter \u201call\u201d as the New dataset name . \n8. Click OK to close the Interpolate Lidar to  UGrid  dialog.  \n\nGMS Tutorials   Lidar with Multiple Files  \n \n Page 6 of 6 \u00a9 Aquaveo 2024  Once it is done processing, notice the new \u201c  all\u201d dataset under the \u201c  UGrid Data\u201d \nfolder in the Project Explorer. To see the interpolated values of the UGrid, turn on \ncontours for the UGrid.  \n9. Click Display Options   to open the Display Opti ons dialog.  \n10. Select \u201cUGrid: multipleLidar \u2013 [Active]\u201d from the list on the left.  \n11. Check Face contours.   \n12. Click on Options\u2026  next to Face contours  to bring up the Dataset Contour \nOptions \u2013 UGrid \u2013 all_filtered dialog.  \n13. Select \u201cBlock Fill\u201d from the Contour method  drop-down.  \n14. Click OK to close the Dataset Contour Options \u2013 UGrid \u2013 all dialog.  \n15. Click OK to close the Display Options  dialog.  \n16. Uncheck \u201c  GIS Layers\u201d in the Project Explorer.  \nThe display should now appear similar to Figure 4. \n \n      Figure 4      UGrid with interpolated values from multiple lidar  \n6 Conclusion  \nThis concludes the GMS \u201cLidar with Multiple Files\u201d tutorial. The following topics  were \ndiscussed and demonstrated:  \n\uf0b7 Multiple lidar can be displayed and used for interpolation to rasters and UGrids.  \n\uf0b7 GMS can merge multiple lidar files into a single lidar file.  \n\uf0b7 Lidar files each have their own display options.  \n \n \n\n", "filename": "Lidar_with_Multiple_Files.pdf", "pages": 6}, "mod-PATH3DU-Transient": {"text": "GMS Tutorials   mod-PATH3DU  Transient  \n Page 1 of 14 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMod-PATH3DU  Transient  \nA particle tracking with a  transient MODFLOW -USG  model  \nObjectives   \nThis tutorial demonstrates more about GMS's mod -PATH3DU interface and how transient simulations are \ndone . \n \nPrerequisite Tutorials  \n\uf0b7 Mod-PATH3DU  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 MODPATH/MP3DU \nInterface  Time  \n\uf0b7 15\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   mod-PATH3DU  Transient  \n Page 2 of 14 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Opening an Existing Model  ................................ ................................ ................................ . 2 \n3 Saving a Text Copy ................................ ................................ ................................ ..............  3 \n4 Running MODFLOW  ................................ ................................ ................................ ............  4 \n5 Creating a Backward Tracking mod -PATH3DU Model  ................................ .....................  4 \n5.1 Adding Starting Locations  ................................ ................................ .............................  4 \n5.2 Direction and Release Time ................................ ................................ ..........................  5 \n5.3 IFACE  ................................ ................................ ................................ ...........................  6 \n6 Running the Model Checker  ................................ ................................ ...............................  7 \n6.1 Fixing Unit Numbers  ................................ ................................ ................................ ..... 8 \n6.2 Running the Model Checker  ................................ ................................ .........................  9 \n7 Saving and Running mod -PATH3DU  ................................ ................................ ...............  10 \n8 Capture Zones and Well Groups  ................................ ................................ ......................  11 \n8.1 Creating Well Groups  ................................ ................................ ................................ . 11 \n9 Exporting a Shapefile  ................................ ................................ ................................ ........  12 \n10 Conclusion  ................................ ................................ ................................ .........................  14 \n \n1 Introduction  \nThe particle path and time tracking simulation program mod -PATH3DU was written by \nChris Muffles at S.S. Papadopulos &  Associates for use with structured and unstructured \ngrids. It is similar to MODPATH and works with unstructured grids and MODFLOW -USG.  \nThis tutorial start s by opening a transient MODFLOW -USG model. A native text copy of \nthe model is saved and MODFLOW run s on the native text. A new backward -tracking \nmod-PATH3DU model with points at the well s is then  created . The mod -PATH3DU Model \nChecker is run and the errors that it identifies are fixed.  \nThe model is then launched,  the solution  is imported, the wells are renamed in order to \nalter the capture zones, and a shapefile containing the pathline points is exported.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program set tings \nare restored to their default state.  \n2 Opening an Existing Model  \nTo open a two -layer transient MODFLOW -USG model:  \n1. Click Open   to bring up the Open  dialog . \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the Transient \\Transient \\ directory and select \u201cTransient.gpr\u201d.  \n4. Click Open  to import the project and exit the Open  dialog.  \nThe project should appear similar to Figure 1.  \n\nGMS Tutorials   mod-PATH3DU  Transient  \n \n Page 3 of 14 \u00a9 Aquaveo 2024   \n      Figure 1      Starting MODFLOW -USG model  \nFlow is from left to right with the cells on the right side set as constant head cells with \nvalues of \u201c139.0\u201d to \u201c119.0\u201d. There are several wells in the project that extract water from \nthe mo del. There are five stress periods and the end time of the model is at 1,000,970.1 \ndays. Linear contours showing head are turned on.  \nBefore proceeding, it is recommended to save the project under a new name.  \n5. Select File | Save As \u2026 to open the Save As  dialo g. \n6. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n7. Enter \u201cTransientMp3du.gpr\u201d as the File name . \n8. Click Save  to create a new project file and close the Save As  dialog.  \n3 Saving a Text Copy  \nMODFLOW files are read by mod -PATH3DU using its interna l version of MODFLOW. \nBecause of this, mod -PATH3DU cannot read the GMS -formatted MODFLOW files that \nuse HDF5 to store array data. The next step is to save a native text copy of the \nMODFLOW simulation for mod -PATH3DU to use.  \n1. In the Project Explorer , double -click on \u201c  Global\u201d to bring up the MODFLOW \nGlobal/Basic Package  dialog.  \n2. In the MODFLOW version  section, turn on Save native text copy . \n3. Click OK to close the  MODFLOW Global/Basic Package  dialog . \n\nGMS Tutorials   mod-PATH3DU  Transient  \n \n Page 4 of 14 \u00a9 Aquaveo 2024  4. Select File | Save  to save a text copy of MODFLOW to the project directory.  \n4 Running MODFLOW  \nTo generate a solution for the native text copy version of the model, MODFLOW needs to \nbe run. The typical way to run MODFLOW uses the GMS formatted copy of the model, so \nMODFLOW nee ds to run in a different way.  \n1. Select MODFLOW | Advanced  | Run MODFLOW Dialog \u2026 to bring up the Run \nMODFLOW  dialog.  \n2. In the MODFLOW version  section, select USG . \n3. Click Name file   to bring up an Open  dialog.  \n4. Navigate up one directory and open the TransientMp3d u_MODFLOW -ugrid _text  \nfolder.  \n5. Select \u201cTransientMp3du.mfn\u201d and click Open  to exit the Open dialog.  \n6. Click OK to close the Run MODFLOW  dialog and bring up a command prompt \nwindow where MODFLOW will run.  \n7. When MODFLOW finishes running, close the command prompt window by \npressing any key.  \n5 Creating a Backward Tracking mod -PATH3DU Model  \nThe next step is to create the mod -PATH3DU model.  \n1. In the Project Explorer , right -click on \u201c  ugrid\u201d and select New mod -PATH3DU  \nmenu item.  \nThis adds \u201c  ugrid\u201d, a new mod -PATH3DU model, to the Project Explorer.  \n2. Right -click on \u201c  ugrid\u201d and select Rename . \n3. Enter \"backward\" and press Enter  to set the new name.  \n5.1 Adding Starting Locations  \n1. Right -click on \u201c  backward\u201d and select Create Particles at Wells  to bring up \nthe Generate Particles at Wells  dialog.  \n2. Click OK to accept the defaults and close the Generate Particles at Wells  dialog.  \nNotice the ring of starting locations created around the wells ( Figure 2). \n3. Zoom   in to see the particles around the wells.  \n4. When finished, select the Frame   macro to view the entire grid.  \n\nGMS Tutorials   mod-PATH3DU  Transient  \n \n Page 5 of 14 \u00a9 Aquaveo 2024   \n      Figure 2      Ring of particle starting locations around wells  \n5.2 Direction and Release Time  \nWith starti ng locations at the wells, it is now possible to create a backward tracking \nsimulation.  \n1. Right -click on \u201c  backward\u201d and select Options \u2026 to bring up the mod-\nPATH3DU Options  dialog ( Figure 3). \n2. Select \u201cOptions\u201d from the list on the left.  \n3. Select \u201cBackward\u201d from the Direction  drop-down.  \n \n      Figure 3      mod-PATH3DU Options dialog  \n\nGMS Tutorials   mod-PATH3DU  Transient  \n \n Page 6 of 14 \u00a9 Aquaveo 2024  \nNotice that Release Time  is set to \u201c0.0\u201d. Because the MODFLOW model is transient and \nthe mod -PATH3DU Direction  is set to \u201cBackward\u201d, the Release Time  should not be \u201c0.0\u201d. \nIt would typically be the end time of the MODFLOW model. In this model, that time \nhappens to be \u201c 1000970. 1\u201d.  \nHowever, notice that Auto Compute Releas e Time  is set to \u201cTrue\u201d. When GMS saves the \nmod-PATH3DU input files, it automatically sets the Release Time  to either the \nMODFLOW end time (if doing backward tracking), or to \u201c0.0\u201d (if doing forward tracking). \nTherefore, Releas e Time  does not need to be changed in this case.  \n The Auto Compute  Release Time  option will cause the Release Time  to be set \nat \u201c0.0\u201d or the MODFLOW end time based on the Direction . \n5.3 IFACE  \nIFACE is an input used by mod -PATH3DU to help trac k particles through cells containing \na source or sink. The flow into or out of the cell due to the source or sink must be \nassigned to a cell face. For example, recharge would be assigned to the top cell face. \nIFACE values are integer values which vary from  \u201c0\u201d to \u201c6\u201d, with \u201c0\u201d indicating an internal \nsource/sink (e.g. wells), \u201c5\u201d and \u201c6\u201d indicating the bottom and top faces, respectively, and \nvalues between \u201c1\u201d and \u201c4\u201d indicating side faces.  \n1. Select \u201cIFACE\u201d from the list on the left ( Figure 4). \nHistorically, cells were always hexahedrons (six -faced) so this numbering scheme made \nsense. With unstructured grids, however, there can be any number of side faces on a \ncell. T herefore, with mod -PATH3DU, instead of specifying a value from \u201c1\u201d through \u201c4\u201d to \nindicate a side face, a value of \u201c2\u201d is used to indicate any side face, and mod -PATH3DU \ndetermines the specific side face internally.  \nIFACE input can be supplied to mod -PATH3 DU in one of two ways: as cell -by-cell input \nvia an auxiliary variable included in the MODFLOW boundary condition package files, or \nby specifying an IFACE value for each type of boundary condition in the mod-PATH3DU \nOptions  dialog. Both methods can be used  together, with the IFACE values in the options \ndialog used only if the auxiliary variable method is not used.  \nGMS Tutorials   mod-PATH3DU  Transient  \n \n Page 7 of 14 \u00a9 Aquaveo 2024  \n \n      Figure 4      IFACE values  \nThis table ( Figure 4) is how IFACE values are specified. Notice there are two rows listed \nin the table, one for CHD and one for RCH. The names correspond to the names found in \nthe cell to cell flow (CCF) file. GMS adds these two items automatically wit h all new mod -\nPATH3DU simulations. If these types of boundary conditions were not being used, mod -\nPATH3DU would ignore the IFACE values listed in the table, so it would not be \nnecessary to delete them.  \n Two IFACE  entries are created automatically by GMS a nd used by mod -\nPATH3DU, or ignored by it if they are not needed.  \n \nWells are also included in this model, but IFACE is included by GMS as an auxiliary \nvariable in the well package file so no IFACE value is needed in this table. The CHD \npackage is being use d for the constant head boundary condition and GMS does not \nautomatically include IFACE as an auxiliary variable for this package, so the IFACE value \nlisted in the table is necessary.  \nThe value of \u201c2\u201d for CHD indicates that flow will be assigned to a side face for cells \ncontaining a constant head boundary condition. The value of \u201c6\u201d for RCH indicates that \nflow will be assigned to the top face for cells containing a recharge boundary condition.  \nThe default IFACE  values make sense for this model so no change is needed.  \n2. Click OK to exit the mod-PATH3DU Options  dialog.  \n6 Running the Model Checker  \nGMS has a model checker for mod -PATH3DU that looks for obvious problems with the \nmodel setup and warns of potential errors or issues that may impact the model run.  \n1. Save   the project.  \n\nGMS Tutorials   mod-PATH3DU  Transient  \n \n Page 8 of 14 \u00a9 Aquaveo 2024  \n2. Right -click \u201c  backward\u201d and select Check Simulation\u2026  to bring up the Model \nChecker  dialog.  \n3. Click Run Check  to begin the check.  \nNotice the errors about unit numbers ( Figure 5). For some reason, mod -PATH3DU can \nonly handle unit numbers that are 199 or less. These errors will be fixed in the next \nsection.  \n4. Click Done  to close the Model Checker  dialog.  \n mod-PATH3DU requires that MODFLOW unit numbers be 199 or less.  \n \n      Figure 5      Model Checker dialog showing errors  \n6.1 Fixing Unit Numbers  \nTo fix the unit numbers, do the following:  \n1. Select MODFLOW | Name File \u2026 to bring up the MODFLOW Name File  dialog.  \n2. Scroll down so that unit numbers greater than \u201c199\u201d are visible ( Figure 6). \n\nGMS Tutorials   mod-PATH3DU  Transient  \n \n Page 9 of 14 \u00a9 Aquaveo 2024  \n \n      Figure 6      MODFLOW Name File dialog  \n3. Enter \u201c19\u201d, \u201c20\u201d, and \u201c21\u201d on the DRN,  CHD,  and SMS  rows (respectively) in the \nUnit #  column.  \n4. Click OK to exit the MODFLOW Name File  dialog.  \n The MODFLOW Name File  dialog can be used to change unit numbers.  \n6.2 Running the Model Checker  \nNow to rerun the Model  Checker  to make sure there are no more errors:  \n1. Right -click \u201c  backward\u201d and select Check Simulation\u2026  to bring up the Model \nChecker  dialog.  \n2. Click Run Check  to begin the check.  \nNo errors or warnings should be listed ( Figure 7). \n3. Click Done  to close the Model Checker  dialog.  \n \n      Figure 7      Model Checker dialog with no errors or warnings  \n\nGMS Tutorials   mod-PATH3DU  Transient  \n \n Page 10 of 14 \u00a9 Aquaveo 2024  \n The Model Checker  looks for obvious problems in the model setup.  \n7 Saving and Running mod -PATH3DU  \nBefore running mod -PATH3DU, it is advised to save the project.  \n1. Save   the project.  \nThis saves the project again, this time including the mod -PATH3DU input files.  \n2. Right -click \u201c  backward\u201d and select Run mod -PATH3DU to bring up the \nMP3DU  model wrapper dialog  \nThe MP3DU  model wrapper dialog displays the output from the mod -PATH3DU run, and \nshould finish within less than a minute. If the mod -PATH3DU run finishes successfully, \nthe di alog displays \"Normal termination of mod -PATH3DU.\" near the bottom of the dialog \n(Figure  8). \n  \n      Figure  8      mod-PATH3DU model wrapper dialog  \n3. When mod -PATH3DU finishes, turn on Read solution on exit  and click Close  to \nexit the MP3DU  model wrapper dialog.  \n4. Click Redraw Display  . \nThis causes GMS to refresh the display after reading the pathline file. The proj ect should \nappear similar to Figure 9. \n\nGMS Tutorials   mod-PATH3DU  Transient  \n \n Page 11 of 14 \u00a9 Aquaveo 2024   \n      Figure 9      Pathline solution showing pathlines tracking backward from the well  \n5. If desired, Zoom   in and examine the pathlines.  \n6. Save   the project when done reviewing the pathlines , as it now contains the \nsolution.  \n8 Capture Zones and Well Groups  \nNotice the purple line surrounding all the pathlines. This line encloses a capture zone.  \n1. Click Display Options   to bring up the Display Options  dialog.  \n2. Select \u201cUGrid: ugrid \u2013 [Active]\u201d from the list on the left.  \n3. In the Capture zones  section of the Particles  tab, notice that Delineate by well  is \nselected and Boundary  is turned on.  \nDelineate by well  groups wells together by name, and creates a capture zone using the \npathlines for each well in the group. Turning on Boundary  makes the capture zone \nboundary visible.  \n4. Click Cancel  to close the Display Options  dialog.  \n8.1 Creating Well Groups  \nTo create differen t well groups, modify the well names.  \n1. Select MODFLOW  | Optional Packages  | WEL \u2013 Well\u2026  to bring up the \nMODFLOW Well Package  dialog.  \n2. Enter \u201cD\u201d in the Name  column on row 1.  \n\nGMS Tutorials   mod-PATH3DU  Transient  \n \n Page 12 of 14 \u00a9 Aquaveo 2024  \n3. Enter \u201cC\u201d in the Name  column on row 2.  \n4. Enter \u201cB\u201d in the Name  column on row 3.  \n5. Enter \u201c A\u201d in the Name  column on rows 4 \u201313. \n6. Click OK to exit the MODFLOW Well Package  dialog.  \n7. Click Redraw Display  . \n8. Save   the project.  \nNotice how the capture zone boundary lines have changed ( Figure 10). The wells at the \ntop of the model are grouped together in one capture zone, and the other wells each \nhave individual capture zones.  \n Wells can be grouped together in the same capture zone by setting their \nnames equal in the MODFLOW Well package.  \n \n      Figure 10      Capture zones for different well groups  \n9 Exporting a Shapefile  \nThe pathline solution can be exported to a shapefile for viewing in a GIS application. \nThree types of shapefiles can be exported: a point shapefile containing each pathline \npoint, a line shapefile containing each pathline, and a polygon shapefile containing the \ncapture zone polygons.  \n1. Right -click \"  backward\" and select Export \u2026 to bring up the Export mod -\nPATH3DU  dialog.  \n2. Select \u201c Pathline Shapefile (*.shp) \u201d from the Save as type  drop-down.  \n\nGMS Tutorials   mod-PATH3DU  Transient  \n \n Page 13 of 14 \u00a9 Aquaveo 2024  \n3. Enter \u201cbackward.shp\u201d as the File name . \n4. Click Save  to export the shapefile and close the Export mod -PATH3DU  dialog.  \n5. Click Open   to bring up the  Open  dialog . \n6. Select \u201cShapefiles (*.shp)\u201d from the Files of type  drop-down.  \n7. Select \u201cbackward.shp\u201d and click Open  to import the shapefile and exit the Open  \ndialog.  \n8. Click Display Options   to bring up the Display Options  dialog.  \n9. Select \u201cUGrid: ugrid  \u2013 [Active]\u201d from the list on the left.  \n10. On the UGrid tab, turn off Cell edges  and Face contours . \n11. Turn on UGrid boundary . \n12. Select \u201cGIS Data\u201d from the list on the left.  \n13. Select \u201cBlue\u201d from the Lines  drop-down.  \n14. Click OK to exit the Display Options  dialog.  \n15. Turn off \"  backward\" in the Project Explorer.  \n16. Switch to Oblique View  . \nThe project should appear similar to Figure 11. \n17. Using the Rotate   tool, examine the pathlines in 3D. \nThe lines in the shapefile are 3D lines, just as they are in GMS. The shapefile can be \nimported into another GIS application, if desired.  \n Shapefiles of pathlines, path points, or capture zone polygons can all be \nexported from GMS.  \n \n \n      Figure 11      Pathline shapefile in 3D  \n\nGMS Tutorials   mod-PATH3DU  Transient  \n \n Page 14 of 14 \u00a9 Aquaveo 2024  10 Conclusion  \nThis concludes the \u201cmod -PATH3DU Transient\u201d tutorial. The following  key concepts were \ndiscussed and demonstrated in this tutorial : \n\uf0b7 The Auto Compute  Reference  Time  option will cause the Refer ence  Time  to be \nset at \u201c0.0\u201d or at the MODFLOW end time based on the Tracking  Direction . \n\uf0b7 Two IFACE  entries are created automatically by GMS and may be used by mod -\nPATH3DU if needed.  \n\uf0b7 mod-PATH3DU requires that MODFLOW unit numbers be 199 or less.  \n\uf0b7 Use the MODFLOW Name File  dialog to change unit numbers.  \n\uf0b7 The mod -PATH3DU model checker looks for obvious problems in the model \nsetup.  \n\uf0b7 Wells can be grouped in the same capture zone by setting their names to equal \nvalues in the MODFLOW Well Package  dialog.  \nGMS can e xport shapefiles of pathlines, path points, or capture zone polygons.  \n", "filename": "mod-PATH3DU-Transient.pdf", "pages": 14}, "mod-PATH3DU": {"text": "GMS Tutorials   mod-PATH3DU  \n Page 1 of 10 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMod-PATH3DU  \nA particle tracking program for MODFLOW -USG   \nObjectives   \nThis tutorial gives an overview of GMS's interface for mod -PATH3DU . \n \nPrerequisite Tutorials  \n\uf0b7 MODPATH  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 MODPATH/MP3DU \nInterface  Time  \n\uf0b7 15\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   mod-PATH3DU  \n Page 2 of 10 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Opening an Existing Model  ................................ ................................ ................................ . 2 \n3 Saving a Native Text Copy  ................................ ................................ ................................ .. 3 \n4 Running MODFLOW  ................................ ................................ ................................ ............  3 \n5 Creating a Backward Tracking mod -PATH3DU Model  ................................ .....................  4 \n5.1 Adding Starting Locations  ................................ ................................ .............................  4 \n5.2 Changing to Backward Tracking  ................................ ................................ ...................  5 \n6 Saving and Running mod -PATH3DU  ................................ ................................ .................  6 \n7 Creating a Forward Tracking mod -PATH3DU Model  ................................ ........................  6 \n7.1 Adding Starting Locations  ................................ ................................ .............................  7 \n8 Saving and Running mod -PATH3DU  ................................ ................................ .................  8 \n9 Examining the Solution  ................................ ................................ ................................ ....... 9 \n10 Conclusion  ................................ ................................ ................................ .........................  10 \n \n1 Introduction  \nThe mod -PATH3DU model is a particle tracking program written by Chris Muffles at S.S. \nPapadopulos &  Associates. It works with structured and unstructured grids, as well as \nMODFLOW -USG. It is similar to MODPATH, so it is recommended to be familiar with the \nMODPATH tutorial before starting this tutorial.  \nThis tutorial begins with opening a model containin g a MODFLOW -USG model, saves a \nnative text copy of the model, and runs MODFLOW on the native text. Next, a new \nbackward tracking mod -PATH3DU model with points at the well will be created, the new \nmodel saved, mod -PATH3DU will run, and the solution imported . Finally, a new forward \ntracking mod -PATH3DU model with points on the side will be created.  \n1.1 Getting Started  \nTo start:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2 Opening an Existing Model  \nThe first step is to open a MODFLOW -USG model based on the example problem \nincluded with mod -PATH3DU. It is a one -layer Voronoi model. Flow is from left to right , \nwith the cells on the left side set as constant head cells w ith a value of \u201c50.0\u201d. The cells \non the right side are also set as constant head cells with a value of \u201c49.0\u201d. There is one \nCLN well in the middle of the model that extracts water. Transparent, continuous, color -\nfilled contours of head are turned on.  \n1. Click  Open   to bring up the Open  dialog . \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the VoronoiModel \\VoronoiModel \\ folder and select \u201cVoronoi.gpr\u201d.  \n4. Click Open  to import the project and exit the Open  dialog.  \nThe project should appear similar to Figure 1.  \n\nGMS Tutorials   mod-PATH3DU  \n \n Page 3 of 10 \u00a9 Aquaveo 2024  \n \n      Figure 1      Starting MODFLOW -USG model from mod -PATH3DU examples  \nNow to save the pro ject with a new name:  \n5. Select File | Save As \u2026 to open the Save As  dialog.  \n6. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n7. Enter \u201cmp3du.gpr\u201d as the File name . \n8. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n3 Saving a Native Text Copy  \nBecause mod -PATH3DU reads MODFLOW files and uses its own internal version of \nMODFLOW to do so, it cannot read the GMS -formatted MODFLOW files which use \nHDF5 to store array data. Therefore, it is necessary to save a native text cop y of the \nMODFLOW simulation for use by mod -PATH3DU.  \n1. In the Project Explorer , double -click on \u201c  Global\u201d to bring up the MODFLOW \nGlobal/Basic Package  dialog.  \n2. In the MODFLOW version  section, turn on Save native text copy . \n3. Click OK to close the  MODFLOW Global /Basic Package  dialog . \n4. Save   the project so that the text copy of MODFLOW will be saved.  \n \n mod-PATH3DU requires a native text version of the MODFLOW model.  \n4 Running MODFLOW  \nMODFLOW must be run again to generate a solution for the native text copy version  of \nthe model. The typical way to run MODFLOW uses the GMS -formatted copy of the \nmodel, so MODFLOW needs to run in a different way.  \n1. Select MODFLOW | Advanced  | Run MODFLOW Dialog \u2026 to bring up the Run \nModflow  dialog.  \n2. In the MODFLOW version  section, turn on USG . \n\nGMS Tutorials   mod-PATH3DU  \n \n Page 4 of 10 \u00a9 Aquaveo 2024  \n3. Click Name file   to bring up an Open  dialog.  \n4. Navigate up one directory and open the mp3du _MODFLOW -Voronoi _text  folder.  \n5. Select \u201cmp3du.mfn\u201d and click Open  to exit the Open dialog.  \nThe dialog should appear similar to Figure 2. \n \n      Figure 2      Run MODFLOW dialog  \n6. Click OK to exit the Run MODFLOW  dialog and bring up a command prompt \nwindow.  \n7. When MODFLOW finishes running, close the comman d window by pressing any \nkey. \n \n The MODFLOW | Advanced  | Run MODFLOW Dialog  menu command can be \nused to run MODFLOW using any version of MODFLOW on any name file.  \n5 Creating a Backward Tracking mod -PATH3DU Model  \nThe next step is to create the mod -PATH3DU model.  \n1. In the Project Explorer , right -click \u201c  Voronoi\u201d and select New mod -PATH3DU  \nto create a new \u201c  Voronoi\u201d mod -PATH3DU model.  \n2. Right -click \u201c  Voronoi\u201d and select Rename . \n3. Enter \"backward\" and press Enter  to set the new name.  \n5.1 Adding Starting Locations  \n1. Right -click \u201c  backward\u201d and select Create Particles at Wells \u2026 to bring up the \nGenerate Particles at Wells  dialog.  \n2. Click OK to accept the defaults and close the Generate Particles at Wells  dialog.  \n \n\nGMS Tutorials   mod-PATH3DU  \n \n Page 5 of 10 \u00a9 Aquaveo 2024  \n Starting locations can be generated at wells using the Create Particles at \nWells \u2026 command.  \n \nWhen using MODPATH normally, at this point GMS would automatically save and run \nMODPATH and import the pathlines. Because GMS does not automatically run mod -\nPATH3DU, it must be done manually. This will be done in the n ext section.  \n \n mod-PATH3DU does not run automatically, unlike MODPATH . \n3. Zoom   in to the cell containing the well.  \nNotice the ring of starting locations created around the well ( Figure 3). \n \n      Figure 3      Ring of starting locations created around the well  \n4. Frame   the project to return to the previous view.  \n5.2 Changing to Backward Tracking  \nWith starting locations at the well, the next task is creating a backward tracking \nsimulation.  \n1. Right -click \u201c  backward\u201d and select Options \u2026 to bring up the mod-PATH3DU \nOptions  dialog.  \n2. Select \u201cOptions\u201d from the list on the left.  \n3. Select \u201cBackward\u201d from the Direct ion drop-down ( Figure 4). \n4. Click OK to exit the mod-PATH3DU Options  dialog.  \n \n      Figure 4      Selecting the direction  \n\nGMS Tutorials   mod-PATH3DU  \n \n Page 6 of 10 \u00a9 Aquaveo 2024  6 Saving and Running mo d-PATH3DU  \nBefore running mod -PATH3DU, the changes must be saved.  \n1. Save   the project. This will include the mod -PATH3DU input files.  \n2. Right -click \u201c  backward\u201d and select Run mod -PATH3DU to bring up the \nMP3DU  model wrapper dialog ( Figure 5). \n \n      Figure 5      mod-PATH3DU model wrapper  \nWhen mod -PATH3DU finishes, the line \"Normal termination of mod -PATH3DU.\" should \nappear near the bottom of the MP3DU  model wrapper dialog.  \n3. When mod -PATH3DU finishes, make sure Read solution on exit  is turned on and \nclick Close  to exit the MP3DU  model wrapper dialog.  \nGMS will import the pathline solution file and display the pathlines. The result should \nappear simil ar to Figure 6. \n \n      Figure 6      Pathline solution showing pathlines tracking backward from the well  \n4. If desired, Zoom   in and examine the pathlines.  \n5. Click the Save   macro to save the project with the solution.  \n7 Creating a Forward Tracking mod -PATH3DU Model  \nNow to create another mod -PATH3DU model with starting locations on the left edge of \nthe model that track forward:  \n\nGMS Tutorials   mod-PATH3DU  \n \n Page 7 of 10 \u00a9 Aquaveo 2024  \n1. In the Project Explorer , right -click \u201c  Voronoi\u201d and select New mod -\nPATH3DU \u2026 to create a new \u201c  Voronoi\u201d mod -PATH3DU model.  \n2. Right -click \u201c  Voronoi\u201d and select Rename . \n3. Enter \"forward\" and press Enter  to set the new name.  \n \n Multiple mod -PATH3DU simulations can  exist in GMS at the same time . \n7.1 Adding Starting Locations  \n1. Zoom   in on the left side of the UGrid.  \n2. Using the Select Cells   tool, drag a box that selects the cells on the left side of \nthe grid in the area where the existing pathlines are, including two cells above \nand below the cells the pathlines touch ( Figure 7). \n \n      Figure 7      Select ed cells on the left side of the UGrid  \n3. Right -click on any selected cell and select Create mod -PATH3DU Particles \u2026 to \nbring up the Generate Particles  dialog.  \n4. Move the slider unde r Number of particles  to change it to \u201c4\u201d.  \n5. Click OK to close the Generate Particles  dialog.  \nEach cell now contains up to four starting locations ( Figure 8).  \n\nGMS Tutorials   mod-PATH3DU  \n \n Page 8 of 10 \u00a9 Aquaveo 2024  \n \n      Figure 8      Starting locations in the selected cells  \n6. If desired, Zoom   in and see how GMS arranged the starting locations.  \nBecause Voronoi cells are irregularly shaped, some cells will end up with fewer particles \nbecause GMS cr eates them in a square pattern using the cell extents as a guide, and \nthen eliminates particles that end up outside the cell borders.  \n \n Starting locations can be created inside cells by selecting cells and using the \nCreate mod -PATH3DU Particles\u2026  command . \n8 Saving and Running mod -PATH3DU  \nBefore running mod -PATH3DU again, it is recommended to save the project.  \n1. Save   the project.  \n2. Right -click \u201c  forward\u201d and select Run mod -PATH3DU  to bring up the MP3DU  \nmodel wrapper dialog.  \n3. When mod -PATH3DU finishes, make sure  Read solution on exit  is turned on and \nclick Close  to exit the MP3DU  model wrapper dialog.  \nGMS then imports the pathline solution file and displays the pathlines ( Figure 9).  \n \n      Figure 9      Pathline solution showing pathlines tracking backward from the well  \n4. If desired, Zoom   in and examine the pathlines.  \n5. Save   the project with the solution.  \n\nGMS Tutorials   mod-PATH3DU  \n \n Page 9 of 10 \u00a9 Aquaveo 2024  9 Examining the Solution  \nNow to take a closer  look at the pathlines:  \n1. Turn off \u201c  backward\u201d in the Project Explorer.  \n2. Zoom   in on the well ( Figure 10). \n \n      Figure 10      Forward track ing pathlines around the well  \n3. Frame   the project.  \n4. Click Display Options   to bring up the Display Options  dialog.  \n5. Select \u201cUGrid: Voronoi \u2013 [Active]\u201d from the list on the left.  \n6. On the Particles  tab, turn on Direction arrows . \nA number of other display options related to starting locations and pathlines are available \nhere.  \n7. Click OK to close the Display Options  dialog.  \nFlow direction is now shown ( Figure 11). \n \n      Figure 11      Flow direction arrows are visible  \n  \n\nGMS Tutorials   mod-PATH3DU  \n \n Page 10 of 10 \u00a9 Aquaveo 2024  10 Conclusion  \nThis concludes the \u201cmod -PATH3DU\u201d tutorial. The following  key concepts were discussed \nand demonstrated:  \n\uf0b7 GMS includes an interface to mod -PATH3DU.  \n\uf0b7 mod-PATH3DU  requires a native text version of the MODFLOW model.  \n\uf0b7 The MODFLOW | Advanced  | Run MODFLOW Dialog \u2026 menu command can be \nused to run MODFLOW using any version of MODFLOW on any name file.  \n\uf0b7 Startling locations can be generated at wells using the Create Particl es at \nWells \u2026 command.  \n\uf0b7 mod-PATH3DU does not run automatically like MODPATH.  \n\uf0b7 Multiple mod -PATH3DU simulations can exist in GMS at the same time.  \n\uf0b7 Starting locations can be created inside cells by selecting cells and using the \nCreate mod -PATH3DU Particles \u2026 command . \n \n", "filename": "mod-PATH3DU.pdf", "pages": 10}, "MODAEM": {"text": "GMS Tutorials   MODAEM  \n Page 1 of 12 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODAEM  \nAnalytic element modeling with MODAEM  \n \nObjectives   \nIllustrate the use of GMS for analytic modeling with MODAEM.  \nPrerequisite Tutorials  \n\uf0b7 Feature Objects   Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODAEM  \n Time  \n\uf0b7 25\u201340 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODAEM  \n Page 2 of 12 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Description of Problem  ................................ ................................ ................................ . 2 \n1.2 Getting Started  ................................ ................................ ................................ ..............  3 \n2 Setting up the Model  ................................ ................................ ................................ ...........  3 \n2.1 Importing the Background Map  ................................ ................................ .....................  3 \n2.2 Creating the Conceptual Model  ................................ ................................ ....................  4 \n2.3 Creating the Specified Head Arcs  ................................ ................................ .................  5 \n2.4 Entering the Aquifer Properties  ................................ ................................ .....................  7 \n2.5 Saving the Project  ................................ ................................ ................................ .........  7 \n2.6 Saving the Project  ................................ ................................ ................................ .........  8 \n3 Creating the River  ................................ ................................ ................................ ................  8 \n3.1 Running MODAEM  ................................ ................................ ................................ ....... 9 \n4 Adding Recharge  ................................ ................................ ................................ ...............  10 \n4.1 Running MODAEM  ................................ ................................ ................................ ..... 10 \n5 Wells  ................................ ................................ ................................ ................................ ... 10 \n5.1 Production Wells  ................................ ................................ ................................ .........  10 \n5.2 Observation Wells  ................................ ................................ ................................ ....... 11 \n5.3 Running MODAEM  ................................ ................................ ................................ ..... 11 \n6 Conclusion  ................................ ................................ ................................ .........................  12 \n \n1 Introduction  \nMODAEM is a single -layer, steady -state analytic element groundwater flow model that \nhas been enhanced for use with GMS. This tutorial introd uces MODAEM and illustrates \nthe use of GMS for analytic element modeling. This tutorial does not go into detail in \nexplaining the analytic element method. For a more detailed explanation of analytic \nelement modeling and MODAEM, refer to the MODAEM Help man ual. \nThis tutorial will go over importing a background map, creating a conceptual model and \ndefining the parameters, and finally running MODAEM for different conditions.  \n1.1 Description of Problem  \nThis tutorial describes the use of GMS to model groundwater flow near the wellfield in \nBrazil, Indiana, USA. Brazil (population about 8,100) operates a wellfield about five miles \neast of town, in the floodplain of Big Walnut Creek (see Figure 1). The objectives of this \nmodel are to do the following:  \n\uf0b7 Model the 5 -year capture zone for the well field for use in the Brazil wellhead \nprotection effort.  \n\uf0b7 Examine the effects of the addition of a well to the wellfield.  \nThe following figure shows the site location, along with the model boundaries. The \nwellfield is situated in the floodplain of Big Walnut Creek. The aquifer is composed of \ncoarse gravel with an  average hydraulic conductivity of 250 ft/d (60.9 m/d), deposited in a \nburied bedrock valley. Although the bedrock surrounding the valley is slightly permeable, \nit is not considered an important source of water. The thickness of the gravel aquifer in \nthe v alley varies from 10 \u201380 feet (3.0 \u201324.4 meters). At the wellfield, the ground elevation \nis roughly 600 feet (183 meters), and the aquifer is roughly 60 feet (18.3 meters) thick.  \nGMS Tutorials   MODAEM  \n \n Page 3 of 12 \u00a9 Aquaveo 2024   \n      Figure 1      Model boundary  \n1.2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select the File | New command to ensure that the \nprogram settings are restored to their default state.   \n2 Setting up the Model  \n2.1 Importing the Background Map  \nThe first step t o create the model is to import a background image of the site being \nmodeled. Use the image as a guide while creating points, arcs, and polygons to define \nfeatures of the model.  \n1. Click Open   to bring up the Open  dialog.  \n2. Change the Files of type  to \u201cImages (*.tif;*.tiff;*.jpg;*.jpeg;*.png;*.sid;*.ecw)\u201d.  \n3. Browse to the modaem  directory for this tutorial and select \u201cbrazil_topo.tif\u201d.  \n4. Click Open  to import the image and exit the Open  dialog.  \nThe background map should appear similar to Figure 2. The units and project projection \nhave been set to match the data in the image file. These unites and projection will be \nused for the rest of the project.  \n\nGMS Tutorials   MODAEM  \n \n Page 4 of 12 \u00a9 Aquaveo 2024   \nFigure 2      Initial background map image  \n2.2 Creating the Conceptual Model  \nIt is now possible to enter the model data. First, create a MODAEM conceptual model. \nSecond, create coverages to define the boundary conditions and aquifer pr operties. The \nboundary of the model is shown in Figure 3. \n1. In the Project Explorer , right -click on the empty space then, from the pop -up \nmenu, select New | Conceptual Model\u2026  to open the Conceptual Model \nProperties  dialog.  \n2. Change the Name  to \u201cIndiana\u201d.  \n3. Change the Type  to \u201cMODAEM\u201d.  \n4. Click OK to close the Conceptual Model Properties  dialog.  \n5. Right -click on \u201c  Indiana\u201d and select New Coverage\u2026  to open the Coverage \nSetup dialog.  \n6. Change the Coverage name  to \u201cBoundary\u201d.  \n7. Select the Use to define model boundary  option.  \n8. Click OK to close the Coverage Setup dialog.  \n9. Select \u201c  boundary\u201d to make it active.  \n10. Using the Create Arc   tool, click out the boundary as shown  in Figure 3 below.  \n\nGMS Tutorials   MODAEM  \n \n Page 5 of 12 \u00a9 Aquaveo 2024   \n      Figure 3      Boundary arcs  \n2.3 Creating the Specified Head Arcs  \nBy default, the arcs in a MODAEM  boundary coverage are \u201cno flow\u201d boundaries. This \nmeans the arc\u2019s type is set to \u201cspecified flow\u201d and that the flow is set to 0. Next, add \nspecified head arcs to this coverage. To create the specified head arcs, split the \nboundary arc into four separate ar cs.  \nConvert Vertices to Nodes  \n1. Click Display Options   to open the Display Options  dialog.  \n2. Select \u201cMap Data\u201d from the list on the left.  \n3. On the Map tab, turn on Vertices . \n4. Click OK to close the Display Options  dialog.  \n5. Using the Select Objects   tool while pr essing the Shift key, select the four \npoints (vertices and/or nodes) indicated in Figure 4.  \nDepending on how the boundary arc was created, one of the  vertices shown in Figure 4 \nmay actually be a node. In that case, the node can still be selected with the Select \nVertex  tool (though it is not necessary in this case).  \n\nGMS Tutorials   MODAEM  \n \n Page 6 of 12 \u00a9 Aquaveo 2024   \n      Figure 4      Convert vertices to nodes  \nIt may be necessary to insert additional vertices. This can be done by using the Create \nVertex  tool. Simply select the tool and then click on the arc in the desired location.  \n6. Select Feature Objects |  Vertices \u2192 Nodes  to convert all the selected vertices to \nnodes.  \nAssigning Arcs  \n7. Using the Select Arcs   tool while pressing the Shift key, select the two new \narcs that were created on the north and south of the boundary ( Figure 5). \n8. Click the Properties   macro to open the Attribute Table dialog.  \n9. In the All row, change the Type  to \u201cspec. head\u201d using the drop -down.  \n10. Click OK to exit the Attributes Table  dialog.  \n11. Using the Select Points/Nodes   tool while pressing the Shift key, select both \nnodes on the northern specified head arc.  \n12. Click  the Properties   macro to open the Attribute Table dialog.  \n13. Select \u201cspec. head\u201d from the BC type drop-down.  \n14. On the All row in the Head  column, enter \u201c182.0\u201d.  \n15. Click OK to exit the Attributes Table  dialog.  \n16. Repeat steps 5 \u20139 for the nodes attached to the south ern specified head arc, but \nenter \u201c178.6\u201d for the Head  value.  \n\nGMS Tutorials   MODAEM  \n \n Page 7 of 12 \u00a9 Aquaveo 2024   \n      Figure 5      Specified head arcs  \n2.4 Entering the Aquifer Properties  \nNext, enter the properties of the aquifer as described in the following steps. Aquifer \nproperties can be assigned to individual polygons, and also define properties for a \nbackground aquifer.  \n1. Select MODAEM | Global Options\u2026  to open the MODAEM Global Options \ndialog.  \n2. In the Background aquifer properties  section, enter \u201c170.0\u201d as the Base.  \n3. Enter  \u201c18.0\u201d as the Thickness  \n4. Enter \u201c60.0\u201d as the Hyd. cond.  \n5. Click OK to exit the MODAEM Global Options  dialog.  \nWith a boundary coverage, a single polygon must define the aquifer being modeled.  \n6. Select Feature Objects | Build Polygons . \n2.5 Saving the Project  \nIt is now possible to run MODAEM. With other models in GMS, such as MODFLOW, it is \nrequired to save the changes to the project before running the model. Because MODAEM \nwrites the data currently in memory to temporary files used to complete the model run, \nsaving the changes in GMS before running MODAEM is not required. However, it is \nhighly recommended to periodically Save   projects.  \n\nGMS Tutorials   MODAEM  \n \n Page 8 of 12 \u00a9 Aquaveo 2024  1. Select File | Save As\u2026  to open the Save As  dialog.  \n2. Enter \u201cbrazil.gpr\u201d as the File name  and click Save  to exit the Save As  dialog.  \n2.6 Saving the Project  \nSelecting the menu command MODAEM | Solve  will initiate a MODAEM run. Once this \ncommand is executed, a dialog will appear showing the output from the MODAEM model.  \n1. Select MODAEM | Solve  to launch the MODAEM  model wrapper dialog.  \n2. When MODAEM  is finished, click Close  to exit the MODAEM model wrapper \ndialog.  \nHead contours should now appear inside the boundary coverage.  \n3. Click Contours   to open the Dataset Contour Options \u2013 Map \u2013 MODAEM \nHead dialog.  \n4. In the Contour method  section, sel ect \u201cColor Fill and Linear\u201d from the first drop -\ndown.  \n5. Change the Transparency  value to \u201c60\u201d.  \n6. Click OK to close the Dataset Contour Options \u2013 Map \u2013 MODAEM Head dialog.  \n3 Creating the River  \nNow to add the river to the model:  \n1. Right -click on \u201c  Indiana\u201d in the P roject Explorer and select New Coverage\u2026  to \nopen the Coverage Setup dialog.  \n2. Enter \u201c River\u201d as the Coverage name . \n3. In the Source/Sink/BCs  section, turn on River . \n4. Click OK to exit the Coverage Setup  dialog.  \n5. Select the Create  Arc  tool and click out the river arc starting near the \nnorthern specified head boundary and ending near the southern specified head \nboundary, as shown in Figure 6 below. Don\u2019t extend the river beyond the \nboundary coverage.  \n\nGMS Tutorials   MODAEM  \n \n Page 9 of 12 \u00a9 Aquaveo 2024   \n      Figure 6      Modeling the river  \n6. Using the Select Arcs   tool, double -click on the river arc to open the Attribute \nTable dialog.  \n7. In the Type  column of the spreadsheet, select \u201criver\u201d from the drop -down.  \n8. Enter \u201c5000.0\u201d in the Cond. (m/d)  column.  \n9. Click OK to close the Attributes Table  dialog.  \n10. Using the Select Points/Nodes   tool, double -click on the river node at the \nnorthern end of the model to  open the Attribute Table dialog.  \n11. Enter \u201c182.0\u201d as the Head.  \n12. Enter \u201c179.0\u201d as the Elev. \n13. Click OK to exit the Attribute Table  dialog.  \n14. Repeat steps 10 \u201313 for the southern river node, but enter \u201c178.6\u201d for the Head  \nand \u201c175.6\u201d for the Elev. \n3.1 Running MODAEM  \nIt is now possible to run MODAEM again.  \n1. Select MODAEM | Solve  to launch the MODAEM  model wrapper dialog.  \n2. When MODAEM  is finished, click Close  to exit the MODAEM  model wrapper \ndialog.  \n\nGMS Tutorials   MODAEM  \n \n Page 10 of 12 \u00a9 Aquaveo 2024  Notice some change in the head contours, particularly around the river arc.  \nMODAEM only calculates for the view that is currently visible in the Graphics Window. \nZooming in before running MODAEM increases the refinement of the contours that \nMODAEM calculates. Zooming out decreases the contour refinement.  \nFor example, if the view w as zoomed in to select the southern river node, then the \ncontours are highly -refined, but only a small portio n of the model results display.  \n4 Adding Recharge  \nNow to add recharge to the model:  \n1. Right -click on the \u201c  Boundary \u201d coverage and select the Duplicate  command.  \n2. Double -click on \u201c  Copy of Boundary \u201d to bring up the Coverage Setup  dialog.  \n3. Change the Coverage Name  to \u201crecharge \u201d. \n4. In the Sources/Sinks/BCs  section, turn off Specified Head  and Specified Flow . \n5. In the Areal Properties  section, turn on Recharge . \n6. Click OK to exit the Coverage Setup  dialog.  \n7. Using the Select Polygons   tool, double -click on the polygon to open the \nAttribute Table dialog.  \n8. Enter \u201c0 .00042 \u201d as the Recharge  (m/d) .  \n9. Click OK to exit the Attribute Table  dialog.  \n4.1 Running MODAEM  \nIt is now pos sible to run MODAEM again.  \n1. Select MODAEM | Solve  to launch the MODAEM  model wrapper dialog.  \n2. When MODAEM  is finished, click Close  to exit the MODAEM  model wrapper \ndialog.  \nNotice some change in the head contours.  \n5 Wells  \n5.1 Production Wells  \nNow to import production wells from a tab -delimited text file:  \n1. Right -click on \u201c  Indiana\u201d and select New Coverage\u2026  to open the Coverage \nSetup dialog.  \n2. Change the Coverage name  to \u201cWells\u201d.  \n3. Under the Source/Sink/BCs  section, turn on the Wells  option.  \n4. Click OK to exit the Coverage Setup  dialog.  \n5. Click Open   to bring up the Open  dialog.  \n\nGMS Tutorials   MODAEM  \n \n Page 11 of 12 \u00a9 Aquaveo 2024  6. Select \u201cAll Files (*.*) from the Files of type  drop-down.  \n7. Select \u201cprod_wells.txt\u201d and click Open to exit the Open  dialog and open the Step \n1 of 2  page of the Text Import Wizard  dialog.  \n8. Below t he first section, turn on Heading row . \n9. Click Next  to go to the Step 2 of 2  page of the Text Import Wizard  dialog.  \n10. Select \u201cWell data\u201d from the GMS data type  drop-down.  \n11. In the File preview  section, select \u201cX\u201d from the Type  drop-down in the first \ncolumn.  \n12. Select \u201cY\u201d from the Type  drop-down in the second column.  \n13. Select \u201cFlow Rate\u201d from the Type  drop-down in the third column.  \n14. Click Finish  to exit the Text Import Wizard  dialog.  \nThere may be some difficulty in seeing the wells. If desired, the color of the well  symbol \ncan be changed in the Display Options  dialog by clicking on the Display Options   \nmacro and selecting the desired color for Well in the Map display options in the  Coverage \nsection.  \n5.2 Observation Wells  \nBefore running MODAEM again, import field-measured head values.  \n1. Right -click on \u201c  Indiana\u201d in the Project Explorer and select New Coverage\u2026  to \nopen the Coverage Setup dialog.  \n2. Enter \u201cObservation\u201d as the Coverage name . \n3. Under the Observation Points  section, turn on the Head  option.  \n4. Click OK to exit the Coverage  Setup dialog.  \n5. Click Open   to bring up the Open  dialog.  \n6. Select \u201cwell_head.txt\u201d and click Open to exit the Open  dialog and bring up the \nStep 1 of 2  page of the Text Import Wizard  dialog.  \n7. Below the first section, turn on Heading row . \n8. Click Next  to go to the Step 2 of 2  page of the Text Import Wizard . \n9. Select \u201cObservation data\u201d from the GMS data type  drop-down.  \n10. In the File preview  section, select \u201cName\u201d from the Type  drop-down in the first \ncolumn.  \n11. Select \u201cX\u201d from the Type  drop-down in the sec ond column.  \n12. Select \u201cY\u201d from the Type  drop-down of the third column.  \n13. Select \u201cObs. Head\u201d from the Type  drop-down of the fourth column.  \n14. Click Finish  to exit the Text Import Wizard  dialog.  \nThe observation targets should appear.  \n5.3 Running MODAEM  \nNow to run MODAE M again:  \n\nGMS Tutorials   MODAEM  \n \n Page 12 of 12 \u00a9 Aquaveo 2024  1. Select MODAEM | Solve  to launch the MODAEM  model wrapper dialog.  \n2. When MODAEM  is finished, click Close  to exit the MODAEM  model wrapper \ndialog.  \nThe project should appear similar to Figure 7. \n \n      Figure 7      Final MODAEM run  \n6 Conclusion  \nThis concludes the \u201cMODAEM\u201d  tutorial. The following key concepts were discussed and \ndemonstrated:  \n\uf0b7 MODAEM is an anal ytic element model that uses points, arcs, and polygons to \ncompute solutions.  \n\uf0b7 The Map module is used to construct conceptual models using feature objects \n(points, arcs and polygons).  \n\uf0b7 Feature objects are grouped into coverages. Only one coverage can be acti ve, \nand only the active coverage can be edited.  \n \n\n", "filename": "MODAEM.pdf", "pages": 12}, "MODFLOW-6-Transport-Uncoupled": {"text": "GMS Tutorials   MODFLOW  6 \u2013 Trans port Uncoupled  \n Page 1 of 6 \u00a9 Aquaveo 2023   \n GMS 10.7 Tutorial  \nMODFLOW  6 \u2013 Transport Uncoupled  \nRun a transport simulation using the solution from an uncoupled flow simulation linked \nvia the FMI package  \n \nObjectives   \nLearn how to import a flow and transport simulation and link them together using the FMI package .  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW 6 \u2013 Grid \nApproach  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW -USG Model &  \nInterface  \n Time  \n\uf0b7 10\u201320 minutes  \n \nGMS 10.7  \n\nGMS Tutorials   MODFLOW  6 \u2013 Trans port Uncoupled  \n Page 2 of 6 \u00a9 Aquaveo 2023  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Importing the Models  ................................ ................................ ................................ ..........  2 \n3 Saving the Project  ................................ ................................ ................................ ...............  3 \n4 Delete the Second UGrid  ................................ ................................ ................................ ..... 3 \n5 Run the Flow Model  ................................ ................................ ................................ .............  3 \n5.1 Saving the Simulation  ................................ ................................ ................................ ... 4 \n5.2 Checking the Simulation  ................................ ................................ ...............................  4 \n5.3 Running the Simulation  ................................ ................................ ................................ . 4 \n6 Run the Transport Model  ................................ ................................ ................................ .... 5 \n6.1 Examine the Mass Source Loading Data  ................................ ................................ ...... 5 \n6.2 Specify the Flow Model Data  ................................ ................................ ........................  5 \n6.3 Saving and Running the Simulation  ................................ ................................ ..............  5 \n6.4 Viewing the Results  ................................ ................................ ................................ ...... 6 \n7 Conclusion  ................................ ................................ ................................ ...........................  6 \n \n1 Introduction  \nGMS can allow for models to be uncoupled, with the necessary data re -linked back into \nmodels at a later point. This workflow is described in this tutorial. The FMI package is \nused to link separate flow data from one MODFLOW 6 simulation back to the transport \nmodel so it can be utilized in the transport simulation.  \nFor some groundwater projects it is useful to uncouple models from each other and link \nthe data between models later on. This tutorial will demonstrate uncoupling models using \nMODFLOW 6 simulations. The tutorial makes use of a simple UGrid for demonstration \npurposes.  \nThis tutorial workflow will involve importing existing flow and transport simulations and \nrunning the simulations to get results. The Groundwater Transport (GWT) Model \nsimulates three -dimensional transport of a sing le solute species in flowing groundwater.  \nThe flow and transport model can be uncoupled. The FMI package is used to link the flow \ndata to the transport model. The mass loading is specified in the mass source loading \n(SRC) package. Positive value means addi tion and negative value means removal from \nthe model.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n3. If asked to save changes, click Don\u2019t Save  to close the dialog and restore GMS \nto a default state.  \n2 Importing the Models  \nFirst, import the models:  \n1. Outside of GMS, browse to the mf6_transport_uncoupled \\ex-gwt-moc3d -\np02\\mf6gwf directory and select \u201cmfsim.nam\u201d . \nGMS Tutorials   MODFLOW 6 \u2013 Trans port Uncoupled  \n \n Page 3 of 6 \u00a9 Aquaveo 2023  2. Drag the \u201cmfsim.nam\u201d file into GMS. This will import the flow model into GMS. A \ndialog should briefly appear and disappear as it is importing.  \nOnce it is imported, the \u201c  flow\u201d MODFLOW simulation should be visible in the Project \nExplorer. Now, import th e transport model. Note the subtle change in directory name:  \n3. Outside of GMS, browse to the mf6_transport_uncoupled \\ex-gwt-moc3d -\np02\\mf6gwt directory and select \u201cmfsim.nam\u201d.  \n4. Drag the \u201cmfsim.nam\u201d file into GMS. This will import the transport model into \nGMS. A dialog should briefly appear and disappear as it is importing.  \nOnce it is imported, the \u201c  trans\u201d MODFLOW simulation should be visible in the \nProject Explorer. The starting project should look like Figure 1. \n \nFigure 1      Initial project  \n3 Saving the Project  \nAt this point, make  sure that the project is saved.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog . \n2. Select \u201cProject Files (*.gpr )\u201d from the Save as type  drop-down.  \n3. Enter  \u201cmf6-uncoupled .gpr\u201d as the File name . \n4. Click Save  to close the Save As  dialog .  \nSave the project regularly so that progress isn\u2019t lost if something goes wrong.  \n4 Delete the Second UGrid  \nA UGrid  was created for each imported simulation, so there are now two, but they are \nidentical. It is possible to continue with two UGrids, but for the sake of simplicity, one \nUGrid will be  reused for both simulations.  \n1. Right -click on \u201c  UGrid (2)\u201d in the Project Explorer and select Delete  to remove \nthe unnecessary UGrid.  \n2. In the Project Explorer , expand \u201c  trans\u201d and \u201c  trans\u201d.  \n3. Drag \u201c  UGrid\u201d in the Project Explorer to be under \u201c   trans\u201d (the model, not \nthe simulation) to link it to the trans model.  \n4. Save  the pr oject.  \n5 Run the Flow Model  \nNow that the redundant UGrid has been removed, the flow model should be run to \ngenerate the needed data.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Trans port Uncoupled  \n Page 4 of 6 \u00a9 Aquaveo 2023  The flow model has the injection well on the left side and the constant head boundary \nconditions on the right side. This mean s the flow is going from left to right.  \n5.1 Saving the Simulation  \nBefore the flow simulation is run, it should be saved:  \n1. Right -click on the \u201c  flow\u201d MODFLOW simulation and select Save Simulation . \nA dialog should briefly appear and disappear as it is saving.  \n5.2 Checking the Simulation  \nThe flow simulation should also be checked before it is run in case there are any \nunresolved errors. To check for errors, do the following:  \n1. Right -click on the \u201c  flow\u201d MODFLOW simulation and select the Check \nSimulation\u2026 command. This will bring up the Check MODFLOW 6 Simulation \ndialog.  \n2. There should be no errors. If this is the case, click OK to close the Check \nMODFLOW 6 Simulation dialog. If there are errors, ensure that they are resolved \nbefore moving forward with the tu torial.  \n5.3 Running the Simulation  \nWith the flow simulation having been saved and checked for errors, it is now time to run \nthrough it.  \n1. Right -click on the \u201c  flow\u201d MODFLOW simulation and select Run Simulation . \nThis will bring up the Simulation Run Queue dialog .  \n2. When the simulation is completed, click on the Load Solution button to load the \nsolution into GMS.  \n3. Click on the Close  button to close the Simulation Run Queue dialog.  \n4. Select Display | Display Options\u2026 to bring up the Display Options dialog.  \n5. Select UGrid: UGrid \u2013 [Active] from the list on the left.  \n6. Turn on Face contours to see the solutions.  \n7. Turn off Cell edges  and turn on UGrid boundary .  \n8. Click OK to close the Display Options dialog.  \nThe Graphics Window should appear similar to Figure 2. \n \nFigure 2      Project after the flow model has been run  \n\nGMS Tutorials   MODFLOW 6 \u2013 Trans port Uncoupled  \n \n Page 5 of 6 \u00a9 Aquaveo 2023  6 Run the Transport Model  \nWith the data generated for the flow model, the next step is to prepare to run the \ntransport model. The data from the flow model run will be linked to the transport model to \ninform it.  \n6.1 Examine the Mass Source Loading Data  \nFirst to examine the mass source loading data:  \n1. If necessary, in the Project Explorer, expand out the \u201c  trans\u201d MODFLOW \nsimulation.  \n2. Double -click on \u201c src\u201d to open the Mass Source Loading (SRC) Package dialog.  \nNotice the spreadsheet in the PERIODS section. In the SMASSRATE column, there \nshould be a value of \u201c2.5\u201d followed by zeros. This is the mass source loadi ng rate, which \nis in a unit of mass/time. A positive value indicates addition of solute mass, and a \nnegative value indicates removal of solute mass. In this example, an addition of mass is \nintroduced to  the model at row 12, column 8, layer 1, with a rate o f 2.5.  \n3. When done observing, click OK to close the Mass Source Loading (SRC) \nPackage dialog.  \n6.2 Specify the Flow Model Data  \nNext, the FMI package will be used to inform the transport simulation of the flow solution.  \n1. Double -click on \u201c fmi\u201d to open the Flow Mode l Interface (FMI) Package dialog.  \n2. Turn on Let GMS determine the paths from the flow simulation when saving .  \n3. Click the Select Flow Simulation\u2026 button to open the Select Flow Simulation \ndialog.  \n4. Click the checkbox next to the \u201c  flow\u201d MODFLOW simulation.  \n5. Click OK to close the Select Flow Simulation dialog.  \n6. Click OK to close the Flow Model Interface (FMI) Package  dialog.  \n6.3 Saving and Running the Simulation  \nWith the flow model data specified for the transport model, the simulation can now be \nsaved and run:  \n1. Right-click on the \u201c  trans\u201d MODFLOW simulation and select the Save Project, \nSimulation and Run  command to open the Simulation Run Queue dialog.  \n2. When the simulation is completed within the dialog, click on the Load Solution \nbutton to load the simulation solut ion data into GMS.  \n3. Once the dialog is empty of data after loading in the solution data, click on the \nClose  button to close the Simulation Run Queue dialog.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Trans port Uncoupled  \n Page 6 of 6 \u00a9 Aquaveo 2023  6.4 Viewing the Results  \nWith the solution  data now generated, examine the results:  \n1. In the Project Explo rer, under \u201c  Solution\u201d, expand \u201c  trans\u201d and select the \u201c  \nConcentration\u201d dataset.  \nThe results  should now be displayed in the Graphics Window.  \n2. Scroll through different time steps to observe changes in the display.  \nAs time goes on, the concentration should be seen spreading out from the mass loading \nsource. The Graphics Window on the last step should appear similar to Figure 3. \n \nFigure 3      Concentration dataset on final time step  \n7 Conclusion  \nThis concludes the \u201cMODFLOW 6 \u2013 Transport Uncoupled\u201d tutorial. The following key \ntopics were discussed and demonstrated:  \n\uf0b7 Use the GWT model to simulate three -dimension al transport of a single solute \nspecies in flowing groundwater.  \n\uf0b7 Uncoupling a flow and transport model.  \n\uf0b7 Using the FMI package to link the flow data to the transport model.  \n\uf0b7 GMS can automatically determine inputs for the FMI package when the flow \nmodel is selected.  \n\uf0b7 Specifying mass loading in the SRC package. Positive value means addition and \nnegative value means removal from the model.  \n \n\n", "filename": "MODFLOW-6-Transport-Uncoupled.pdf", "pages": 6}, "MODFLOW-AdvancedParameterOptions": {"text": "GMS Tutorials   MODFLOW \u2013 Advanced Parameter Options  \n Page 1 of 14 \u00a9 Aquaveo 2024   \n GMS 10.8  Tutorial  \nMODFLOW \u2013 Advanced Parameter Options  \nGMS support for native MODFLOW parameters, instances, and \nclusters  \n \nObjectives   \nThis tutorial shows how to use some of the advanced features associated with MODFLOW parameters \nincluding instances and clusters. It also demonstrates how to define array -based parameters using \nclusters and discusses parameter factors.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Automated \nParameter Estimation  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  Time  \n\uf0b7 25\u201340 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   MODFLOW \u2013 Advanced Parameter Options  \n Page 2 of 14 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  3 \n2 Importing the Project  ................................ ................................ ................................ ...........  3 \n3 Creating a Recharge Parameter with a Cluster  ................................ ................................ . 3 \n3.1 The Define Clusters Dialog  ................................ ................................ ...........................  4 \n3.2 Running MODFLOW  ................................ ................................ ................................ ..... 6 \n4 Creating  a Recharge Parameter with Multiple Clusters  ................................ ...................  7 \n4.1 Running MODFLOW  ................................ ................................ ................................ ..... 8 \n5 Creating a Transient Model  ................................ ................................ ................................ . 8 \n5.1 Setting up the Stress Periods  ................................ ................................ .......................  8 \n5.2 Editing the Specific Yield  ................................ ................................ ..............................  9 \n5.3 Editing the RCH Parameters ................................ ................................ .........................  9 \n5.4 Running MODFLOW  ................................ ................................ ................................ ..... 9 \n6 Using Parameter Instances  ................................ ................................ ...............................  10 \n6.1 Running MODFLOW  ................................ ................................ ................................ ... 10 \n7 LPF Parameters  ................................ ................................ ................................ .................  10 \n7.1 Running MODFLOW  ................................ ................................ ................................ ... 11 \n8 Parameter Factors  ................................ ................................ ................................ .............  12 \n8.1 Editing Parameter Factors  ................................ ................................ ..........................  13 \n8.2 Running MODFLOW  ................................ ................................ ................................ ... 13 \n9 Conclusion  ................................ ................................ ................................ .........................  14 \n \n1 Introduction  \nThis tutorial illustrates how to use some of the advanced features associated with \nMODFLOW parameters. This tutorial assumes an un derstanding of how to use the \nparameter estimation tools available in GMS. It is therefore recommended to complete \nthe \u201cMODFLOW \u2013 Automated Parameter Estimation \u201d tutorial before starting this tutorial. It \nis also important to understand how to define array -based parameters using clusters and \nthe concept of parameter instances. Learn more about these concepts by reading the \nMODFLOW documentation.  \nThe model in this tutorial is the same model featured in the \u201c MODFLOW  \u2013 Automated \nParameter Estimation \u201d tutorial.  For most cases, array -based parameters can be defined \nusing the key value approach used in that tutorial. However, this approach is not \ncompletely compatible with the native MODFLOW parameter formats.  \nMODFLOW array -based parameters are defined using clus ters. A cluster is a multiplier \narray, a zone array, and an IZ value (key values associated with the zone array). The key \nvalue approach used in GMS usually creates an array -based parameter defined by a \nsingle cluster. MODFLOW supports parameters that are defined by multiple clusters and \nGMS supports this feature.  \nIn addition to clusters, MODFLOW also supports defining parameter instances for \nparameters associated with a transient MODFLOW model. This feature allows creating a \nsingle parameter, then associa ting multiple sets of clusters with instances of that \nparameter. This allows each instance to be specified with a stress period.  \nTo prevent confusion, this tutorial presents an example where RCH parameters are \ndefined using clusters in a steady state model . The tutorial then changes the model to be \ntransient and creates more than one instance for one of the recharge parameters.  \nThis tutorial discusses and demonstrates opening a parameterized MODFLOW model \nand solution, defining RCH parameters using clusters , and then running MODFLOW. The \nmodel will be changed to be transient, the parameters will be changed to use instances, \nand MODFLOW will be run again. LPF parameters will be defined using clusters, \nMODFLOW will be run, the parameter factors will be adjuste d, and MODFLOW will be \nrun a final time.  \nGMS Tutorials   MODFLOW \u2013 Advanced Parameter Options  \n \n Page 3 of 14 \u00a9 Aquaveo 2024  1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.   \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2 Importing the Project  \nFirst, import the modeling project:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the advparam \\advparam \\ directory and select \u201c start.gpr \u201d. \n4. Click Open  to import the project and close th e Open  dialog . \nA MODFLOW model with a solution and map coverages should appear ( Figure 1).  \n \n      Figure 1      The initial model  \nIn the Pr oject Explorer, expand the \u201c  3D Grid Data\u201d folder and the \u201c  grid\u201d item. \nNotice the seven datasets below the 3D grid : \u201c HKZone1 ,\u201d \u201c HKZone2 ,\u201d \u201c Mult1 ,\u201d \u201c\n Mult2 ,\u201d \u201c RchZone1 ,\u201d \u201c RchZone2 ,\u201d and \u201c RchZone3 \u201d. These datasets will be \nused to define the RCH and LPF parameters.  \n3 Creating a Recharge Parameter with a Cluster  \nThe next step is to create a recharge parameter defined by a single cluster. Once that is \ndone, MODFLOW can be run.  \n1. Select MODFLOW | Parameters\u2026  to open the Parameters dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Advanced Parameter Options  \n \n Page 4 of 14 \u00a9 Aquaveo 2024  2. In the Para meters  section, turn on Show all columns . \n3. Click New to create a new parameter.  \n4. In the Name  column, enter\u201c RCH_1 \u201d. \n5. In the Type  column, select \u201c RCH \u201d from the drop -down.  \n6. In the Value column, enter \u201c 0.00005 \u201d. \n7. In the Use clusters  column, check the box.  \n8. Enter \u201c 1\u201d in the Num. Clusters  (NCLU)  column . \n9. Enter \u201c 1\u201d in the Num. Instances  column.  \nThe dialog should appear as in Figure 2 at this point.  \n10. In the Define clusters  column, cli ck the  button to bring up the Define \nClusters dialog ( Figure 3). \n \n      Figure 2      Parameter instances dialog  \n3.1 The Define Clusters Dialo g \nClusters and parameter instances are defined in the Define Cluster s dialog. Since this is \na steady state model, the example has only one instance and one cluster, and only one \neditable row is available in the dialog ( Figure 3). \n\nGMS Tutorials   MODFLOW \u2013 Advanced Parameter Options  \n \n Page 5 of 14 \u00a9 Aquaveo 2024   \n      Figure 3      Define Clusters dialog with one instance and one cluster  \n1. Click Cancel  to close the Define Clusters  dialog.  \n2. Enter \u201c2\u201d in the Num. Clusters  (NCLU)  column.  \n3. Click the  button  in the Define clusters  column to open the Define Clusters \ndialog.  \nNotice that the spreadsheet now has two editable rows ( Figure 4). Normall y, two \nmultiplier arrays, two zone arrays, and two IZ values need to be defined to successfully \ndefine the clusters.  \n \n      Figure 4      Define Clusters dialog with two clusters and one instance  \n4. Click Cancel  to close the Define C lusters  dialog.  \n5. Enter \u201c2\u201d in the Num. Instances  column.  \n6. Click the  button in the Define clusters  column to open the Define Clusters \ndialog.  \nThe spreadsheet  now has four editable rows ( Figure 5). Normally, two clusters have to be \ndefined for each instance. Notice an instance name must be specified, and the stress \nperiods where the instance is used must be defined. For a transient model with three \n\nGMS Tutorials   MODFLOW \u2013 Advanced Parameter Options  \n \n Page 6 of 14 \u00a9 Aquaveo 2024  stress periods, one of the instances could be used for stress periods 1 and 2, and the \nother instance could be used with stress period 3. If defining an RCH or EVT parameter \nusing clusters and instances, it is necessary to make sure at least one parameter \ninstance is assigned  to every stress period in the model.  \n \n      Figure 5      Define Clusters dialog with two clusters and two instances  \n7. Click Cancel  to close the Define Clusters  dialog.  \n8. Enter \u201c1\u201d in both the Num. Clusters  (NCLU)  and Num. Instances  columns.  \n9. Click the  button to bring up the Define Clusters  dialog.  \n10. Enter \u201c RCH_1_1 \u201d for the Instance Name . Note that MODFLOW limits the length \nof an instance name to 10 characters.  \n11. Click the  button in the Multiplier Array  column to bring up the Select Datas et \ndialog.  \n12. Select \u201c Mult1 \u201d from the Solution  section and click OK to close the Select Dataset  \ndialog.  \n13. Click the  button in the Zone  Array  column to open the Select Datas et dialog.  \n14. Select \u201c RchZone1 \u201d from the Solution  section and click OK to close the Select \nDataset  dialog.  \n15. Enter \u201c 2\u201d in the IZ column.  \nThe IZ field specifies where the parameter is active in the MODFLOW grid. RchZone1 \nhas values of \u201c0\u201d and \u201c2\u201d. Specifying \u201c2\u201d as the IZ will cause the parameter to only be \nused when the zone array has a value of \u201c2\u201d when MODFLOW runs.  \n16. Enter \u201c 1\u201d in the Stress Periods  column and click OK to exit the Define Clusters  \ndialog.  \n17. Click OK to exit the Parameters  dialog.  \nA parameter using clusters h as now been defined.  \n3.2 Running MODFLOW  \nNow to save the project and run MODFLOW:  \n\nGMS Tutorials   MODFLOW \u2013 Advanced Parameter Options  \n \n Page 7 of 14 \u00a9 Aquaveo 2024  1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c run1. gpr\u201d as the File name  and click Save to save t he project under the \nnew name and close the Save As  dialog.  \n4. Select MODFLOW  | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n5. Once MODFLOW is done running, turn on Read in the solution  and Turn on \ncontours (if not on already)  and click Close  to close the MODFLOW  model \nwrapper dialog.  \nThe head contours from the MODFLOW solution should now be visible ( Figure 6). \n \n      Figure 6      Model with solution contours  \n4 Creating a Recharge Parameter with Multiple Clusters  \nThe tutorial will now cover how to create another recharge parameter defined by two \nclusters before running MODFLOW again.  \n1. Select MODFLOW | Parameters\u2026  to open the Parameters dialog.  \n2. Click New to add a new row in the spreadsheet.  \n3. In the Name  column on the new row, enter \u201c RCH_2 \u201d. \n4. In the Type  column, select \u201c RCH \u201d from the drop -down.  \n5. In the Value column, enter \u201c 0.00004 \u201d. \n6. Check the box in the Use clusters  column.  \n\nGMS Tutorials   MODFLOW \u2013 Advanced Parameter Options  \n \n Page 8 of 14 \u00a9 Aquaveo 2024  7. Enter \u201c2\u201d in the Num. Clusters  (NCLU) column.  \n8. Enter \u201c 1\u201d in the Num. Instances  column.  \n9. Click the  button in the Define clusters  column to open the Define Clusters \ndialog.  \n10. Enter the values for the clusters as shown in the table below. Only the selected \ndataset names are shown for the Multiplier  and Zone Array columns below, but it \nis necessary to use the  button to select the datasets so the full path to the \ndatasets is dis played. The IZ values should be separated by spaces.  \nInst. Id  Instance Name  Multiplier Array  Zone Array  IZ Stress Per.  \n1 RCH_2_1  Mult2  RchZone2  4 5 3  1 \n1  Mult2  RchZone3  6 7   \n11. When finished, click OK to exit the Define Clusters dialog.  \n12. Click OK to exit the Parameters dialog.  \nSince two RCH parameters are defined for stress period 1, the final value of the recharge \nrate will be the sum of the two parameters. MODFLOW computes this internally.  \n4.1 Running MODFLOW  \nNow to save the project and run MODFLOW:  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c run2. gpr\u201d as the File name  and click Save to save the project under the \nnew name and close the Save As  dialog.  \n4. Select MODFLOW  | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n5. Once MODFLOW is done running, turn on Read solution on exit  and Turn on \ncontours (if not on already) . \n6. Click Close  to exit the MODFLOW  model wrapper dialog.  \nThe contours will have changed slightly. Switch between the \u201c  run1 (MODFLOW)\u201d and \n\u201c run2 (MODFLOW)\u201d solutions to see the difference.  \n5 Creating a Transient Model  \nIn addition to defining parameters using clusters, parameter instances for transient \nmodels can also be defined.  \n5.1 Setting up the Stress Periods  \nTo change the model to be transient and make three stress periods:  \n1. Select MODFLOW  | Global Options\u2026  to open the MODFLOW Global/Basic \nPackage  dialog.  \n2. In the Model type  section, change the option to Transient . \n3. Click Stress Periods \u2026 to open the Stress  Periods dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Advanced Parameter Options  \n \n Page 9 of 14 \u00a9 Aquaveo 2024  4. Enter \u201c3\u201d for the Number of stress periods . \n5. Enter \u201c1\u201d in the Num Time Steps  column on rows 1\u20133. \n6. Click OK to exit the Stress Periods  dialog.  \n7. Select OK to exit the MODFLOW Global/Basic Package  dialog.  \n5.2 Editing the Specific Yield  \nSince this is  an unconfined model, it is necessary to edit the specific yield value in the \nLPF package.  \n1. Select the Select Cells   tool. \n2. Select Edit | Select All  to select all of the cells in layer 1 of the grid.  \n3. Select Edit | Properties \u2026 to open the 3D Grid Cell Properties dialog.  \n4. Enter \u201c 0.01\u201d in the Value  column of the Specific yield  row.  \n5. Select OK to exit the 3D Grid Cell Properties  dialog.  \n5.3 Editing the RCH Parameters  \nNow to update the parameters to be compatible with the stress periods:  \n1. Select MODF LOW | Parameters\u2026  to open the Parameters  dialog.  \n2. Click the  button in the Define clusters  column of the \u201c RCH_1 \u201d row to bring \nup the Define Clusters dialog.  \n3. Enter \u201c1 2 3\u201d (numbers separated by spaces) in the Stress Periods  column.  \n4. Click OK to exit the Define Clusters dialog.  \n5. Repeat steps 2 \u20134 for the \u201c RCH_2 \u201d row.  \n6. Click OK to exit the Parameters dialog.  \n5.4 Running MODFLOW  \nNow to save the project and run MODFLOW:  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c run3. gpr\u201d as the File name  and click Save  to close the Save As  dialog.  \n4. Select MODFLOW  | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n5. Once MODFLOW is done running, turn on Read solution on exit  and Turn on \ncontours (if not on already) . \n6. Click Close  to close the MODFLOW  model wrapper dialog.  \nThere should be no visible change in the model shown in the Graphics Window.  \n\nGMS Tutorials   MODFLOW \u2013 Advanced Parameter Options  \n \n Page 10 of 14 \u00a9 Aquaveo 2024  6 Using Parameter Instances  \nNext to change one of the recharge parameters to use instances:  \n1. Select MODFLO W | Parameters\u2026  to open the Parameters dialog.  \n2. For the \u201c RCH_1 \u201d parameter, change the Num. Instances  to be \u201c 2\u201d. \n3. Click the  button in the Define clusters  column on the \u201c RCH_1 \u201d row to open \nthe Define Clusters dialog.  \n4. Enter \u201c1 3\u201d (make sure to place a space b etween the numbers) in the Stress \nPeriods  column on row 1 (Instance Name of \u201cRCH_1_1\u201d).  \n5. On row 2, enter \u201c RCH_1_2 \u201d in the Instance Name  column.  \n6. Click the  button in the Multiplier Array  column to bring up the Select Dataset  \ndialog.  \n7. Select the \u201c Mult2 \u201d dataset in the Solution  section and click OK to close the Select \nDataset  dialog.  \n8. Click the  button in the Zone Array  column to bring up the Select Dataset  \ndialog.  \n9. Select the \u201c RchZone1 \u201d dataset in the Solution  section and click OK to close the \nSelect Dat aset dialog.  \n10. Enter \u201c2\u201d in the IZ column.  \n11. Enter \u201c2\u201d in the Stress Periods  column.  \n12. Select OK to exit the Define Clusters  dialog.  \n13. Select OK to exit the Parameters dialog.  \n6.1 Running MODFLOW  \nNow to save the project and run MODFLOW:  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c run4. gpr\u201d as the File name  and click Save to close the Save As  dialog.  \n4. Select MODFLOW  | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n5. Once MODFLOW is done running, turn on Read solution on exit  and Turn on \ncontours (if not on already) . \n6. Click Close  to exit the MODFLOW  model wrapper dialog.   \nThere should be no visible changes to the model in the Graphics Window.  \n7 LPF Parameters  \nGMS supports  parameters with the LPF and HUF packages. The LPF package is being \nused in this tutorial, with horizontal conductivity changed to use parameters. When \n\nGMS Tutorials   MODFLOW \u2013 Advanced Parameter Options  \n \n Page 11 of 14 \u00a9 Aquaveo 2024  entering parameters for the LPF package, a layer number is used in place of an instance \nname.  \n1. Select MOD FLOW | Parameters\u2026  to open the Parameters dialog.  \n2. Click New to add a third parameter entry to the spreadsheet.  \n3. On the third row, enter \u201cHK_1\u201d in the Name  column.  \n4. Select \u201cHK\u201d from the Type  column drop -down.  \n5. Enter \u201c0.67\u201d in the Value  column.  \n6. Check the box in  the Use clusters  column.  \n7. Enter \u201c 2\u201d in the Num. Clusters  (NCLU) column.  \n8. Click the  button in the Define clusters  column to open the Define Clusters \ndialog.  \n9. Enter the values for the cluster shown in the table below then click OK to close \nthe Define Clusters  dialog. Note that the numbers in the IZ column have a space \nbetween them.  \nLayer  Multiplier Array  Zone Array  IZ \n1 Mult1  HKZone1  1 2 \n2 Mult1  HKZone1  1 2 \n10. Click New to add a fourth parameter entry to the spreadsheet.  \n11. Repeat steps 3\u20137 for the fourth entry with the following values: a Name  of \n\u201cHK_2 \u201d, a Type  of \u201cHK\u201d, and a Value  of \u201c0.15\u201d \n12. Click the  button in the Define clusters  column to open the Define Clusters  \ndialog.  \n13. Enter the values for the cluster shown in the table below.  \n \n14. When finished, click OK to exit the Define Clusters  dialog.  \n15. Click OK to exit the Parameters dialog.  \n7.1 Running MODFLOW  \nNow to save the project and run MODFLOW:  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c run5. gpr\u201d as the File name . \n4. Click Save  to close the Save As  dialog.  \n5. Select MODFLOW  | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n6. Once MODFLOW is done running, turn on Read solution on exit  and Turn on \ncontours (if not on already) . \n7. Click Close  to exit the MODFLOW  model wrapper dialog.   \nLayer  Multiplier Array  Zone Array  IZ \n1 Mult1  HKZone2  3 4 \n2 Mult1  HKZone2  3 4 \nGMS Tutorials   MODFLOW \u2013 Advanced Parameter Options  \n \n Page 12 of 14 \u00a9 Aquaveo 2024  The \u201c  run5 (MODFLOW)\u201d solution will show slight changes in the contour lines on the \nmodel ( Figure 7). Switch back and forth between the five solutions to see the differences.  \n \n      Figure 7      The contours changed slightly after the fif th run  \n8 Parameter Factors  \nThe MODFLOW list -based packages (WEL, DRN, GHB, RIV, CHD, STR) allow \nparameter factors to be defined along with the parameters. For example, when creating a \nriver boundary condition in GMS using the map module, GMS will store the l ength of the \narc in the grid cell that is associated with each river boundary condition. Then if wanting \nto parameterize river conductance, the parameter can be conductance per unit length, \nand the parameter factor will be the length of the arc.  \nThe final  conductance for a particular river boundary condition will be the product of the \nparameter value and the parameter factor. Because MODFLOW allows this parameter \nfactor to vary per stress period, there can be multiple parameters stored for each grid cell \n(one for each stress period).  \nNow to create a parameter in the WEL package, then change the parameter factor on \none of the stress periods.  \n1. Select MODFLOW | Parameters\u2026  to bring up the Parameters  dialog.  \n2. Click New to create a fifth parameter.  \n3. Enter \u201c -15\u201d in  the Key column.  \n4. Select \u201cWELL\u201d from the drop -down in the Type  column.  \n\nGMS Tutorials   MODFLOW \u2013 Advanced Parameter Options  \n \n Page 13 of 14 \u00a9 Aquaveo 2024  5. Enter \u201c -15.0\u201d in the Value  column.  \n6. Click OK to exit the Parameters  dialog.  \n8.1 Editing Parameter Factors  \nBy default, the parameter factors are 1.0 (which will have no effect on the final value that \nthe parameter represents). It is necessary to change the parameter factor for the second \nstress period for the parameter that was just created.  \n1. Select MODFLOW  | Optional Packages  | WEL \u2013 Well\u2026  to open the MODFLOW \nWell Package  dialog.  \n2. Enter \u201c2\u201d i n Stress period .  \n3. Turn off Use previous . \n4. In the Q factor  column of the spreadsheet for cell ID  \u201c1613\u201d, enter \u201c10.0\u201d. This is \nthe parameter factor.  \nThis causes the second stress period to have a pumping rate for this well that is 10.0 \ntimes greater (or \u201c -150.0\u201d instead of \u201c -15.0\u201d). Q factor  is only used by parameters.  \n5. Click OK to exit the MODFLOW Well Package  dialog.  \n8.2 Running MODFLOW  \nNow to save the pr oject and run MODFLOW:  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c run6. gpr\u201d as the File name  and click Save  to close the Save As  dialog.  \n4. Select MODFLOW  | Run MODFLOW  to brin g up the MODFLOW  model wrapper \ndialog.  \n5. Once MODFLOW is done running, turn on Read solution on exit  and Turn on \ncontours (if not on already) . \n6. Click Close  to close the MODFLOW  model wrapper dialog.  \nNotice the changes in the contours around the well on the left side of the model when \nswitching to the second time step on the MODFLOW solution ( Figure 8). \nGMS Tutorials   MODFLOW \u2013 Advanced Parameter Options  \n \n Page 14 of 14 \u00a9 Aquaveo 2024   \n      Figure 8      The contours changed s lightly after changing the parameters  \n9 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 Advanced Parameters Options\u201d  tutorial.  The following \nkey concepts were discussed and demonstrated:  \n\uf0b7 Array -based parameters can be defined using clusters.  \n\uf0b7 Parameter instances can be defined for array -based parameters for transient \nmodels.  \n\uf0b7 Parameter factors can be defined for list -based packages in GMS.  \n \n\n", "filename": "MODFLOW-AdvancedParameterOptions.pdf", "pages": 14}, "MODFLOW-AdvancedPest": {"text": "GMS Tutorials   MODFLOW \u2013 Advanced PEST  \n Page 1 of 13 \u00a9 Aquaveo 2025   \n GMS 10 .8 Tutorial  \nMODFLOW \u2013 Advanced PEST  \nParallel PEST, SVD -Assist, Pilot Points  \n \nObjectives   \nLearn how to parameterize a MODFLOW model and run PEST  to obtain optimal parameter values. \nExperiment with truncated singular value decomposition (SVD), SVD -Assist, and Parallel PEST . \n \nPrerequisite Tutorials  \n\u2022 MODFLOW \u2013 PEST Pilot \nPoints  Required Components  \n\u2022 GMS Core  \n\u2022 MODFLOW Interface  \n\u2022 Geostatistics  \n\u2022 PEST  \n\u2022 Parallel PEST  \n Time  \n\u2022 50\u201370 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 Advanced PEST  \n Page 2 of 13 \u00a9 Aquaveo 2025  1 Introduction  ................................ ................................ ................................ ........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ............  2 \n2 Parallel PEST  ................................ ................................ ................................ ......................  3 \n2.1 Saving the Project and Running Parallel PEST  ................................ ...........................  4 \n3 Parallel PEST with SVD -Assist  ................................ ................................ ..........................  5 \n3.1 Specifying a Precomputed Jacobian  ................................ ................................ ...........  6 \n3.2 Changing the Regularization Option  ................................ ................................ ............  7 \n4 Multiple Parameters Using Pilot Points  ................................ ................................ ............  8 \n4.1 Creating a Second Set of Pilot Points ................................ ................................ ..........  9 \n4.2 Creating the New HK Parameter  ................................ ................................ ...............  10 \n4.3 Using Pilot Points with RCH Parameter  ................................ ................................ ..... 10 \n4.4 Saving the Project and Running PEST  ................................ ................................ ...... 11 \n5 A Note on Highly Parameterized Models  ................................ ................................ ........  12 \n6 Conclusion  ................................ ................................ ................................ ........................  13 \n \n1 Introduction  \nThe \u201c MODFLOW \u2013 Automated Parameter Estimation \u201d tutorial describes the basic \nfunctionality of PEST  provided in GMS. It illustrates how to parameterize a MODFLOW \nmodel and run PEST to obtain optimal parameter values. This tutorial describes several \nPEST features, including Truncated Singular Value Decomposition (SVD), SVD -Assist, \nand Parallel PEST.  \nEach of these features is intended to decrease the amount of time necessary for PEST to \ncomplete the optimization process. The SVD options focus on identifying and removing \ninsensitive parameters from the model inversion process, while Parallel PEST speeds  up \nthe inversion process by running more models simultaneously.  \nThe model in this tutorial is the same model featured in the \u201c MODFLOW  \u2013 Model \nCalibration \u201d tutorial. The model includes observed flow data for the stream and observed \nheads at a set of scattered observation wells. The conceptual model for the site consists \nof a set of recharge and hydraulic conductivity zones. These zones will be marked as \nparameters, and an inverse model will be used to find a set of recharge and hydraulic \nconductivity values that minimize the calibration error. It will utilize two methods  for model \nparameterization: polygonal zones and pilot point interpolation.  \nThis tutorial will demonstrate and discuss:  \n\u2022 Opening a MODFLOW model and solution.  \n\u2022 Running the model and solution with just Parallel PEST.  \n\u2022 Using SVD and SVD -Assist.  \n\u2022 Using SVD and SVD -Assist with a different regularization option.  \n\u2022 Using SVD and SVD -Assist with multiple parameters and sets of pilot points.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n3. If asked to save changes, click Don\u2019t Save  to close the dialog and restore GMS \nto a default state.  \nGMS Tutorials   MODFLOW \u2013 Advanced PEST  \n \n Page 3 of 13 \u00a9 Aquaveo 2025  2 Parallel PEST  \nAll of the steps required to run PEST must also be followed to run Parallel PEST. The \nonly additional inputs required are to 1) specify the number of models that can be run \nsimultaneously by PEST, and 2) specifying a \u201cWAIT\u201d variable. The WAIT variable is \ndescribed by the PEST documentation as the amount of time that PEST and PSLAVE will \npause at certain strategic places in their communication. Normally, the default value \nshould work fine. However, if either PEST or PSLAVE reports a sharing violation on the \nhard drive, then increase the value of the WAIT variable.  \nTo illustrate Parallel PEST and SVD -Assist, start with an existing project.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the advPEST/advPEST directory and select \u201c run1_SvdAssist.gpr \u201d. \n4. Click Open  to import the project file and exit the Open  dialog . \nA MODFLOW model should appear with a solution and a set of map coverages ( Figure \n1). Three of the coverages are the source/sink, recharge, and hydraulic conductivity \ncoverages used to define the conceptual model. The active coverage contains a set of \nobserved head values from observation wells. In the source/sink coverage, an observed \nflow value has been assigned to the stream network.  \n5. Select MODFLOW | Global Options \u2026 to open the MODFLOW Global/Basic \nPackage dialog.  \n6. In the Run options  section, select Parameter Estimation .  \n7. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n8. Select MODFLOW | Parameter Estimation \u2026 to open the PEST dialog.  \n9. For the Max number of iterations  (NOPTMAX ), enter \u201c2\u201d . \n10. In the Parallel PEST  section, turn on Use Parallel Pest . \n11. Click OK to exit the PEST  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Advanced PEST  \n \n Page 4 of 13 \u00a9 Aquaveo 2025   \n      Figure 1      Initial model  \n2.1 Saving the Project and Running Parallel PEST  \nNow to save the project prior to running parallel PEST:  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Browse to the advPEST/advPEST directory . \n3. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n4. Enter \u201c run2_PPest .gpr\u201d as the File name . \n5. Click Save  to export the file under the new name and close the Save As  dialog.  \n6. Click Run MODFLOW   to bring up the MODFLOW /PEST Parameter \nEstimation  dialog.  \nAt this point, a number of new command prompt windows are created. These are called \n\u201cslaves\u201d, and the number created depends on the number of available cores on the \ncomputer being used. This number can also be specified manually in the Parallel PEST  \nsection of the PEST  dialog (the same dialog accessed in the previous section). The \ncommand prompts running PSLAVE  are initially minimized.  \nThe MODFLOW/PEST Parameter Estimation  dialog reads the output from Parallel PEST \nand updates the model error and parameter values for each PEST iteration. If the Abort  \nbutton is clicked prior to the MODFLOW run finishing, all of the Parallel PEST processes \nwill be terminated. Once the MODFLOW run finishes, the Abort  button will change to \n\nGMS Tutorials   MODFLOW \u2013 Advanced PEST  \n \n Page 5 of 13 \u00a9 Aquaveo 2025  Close . Clicking the Stop w/ Statistics  button causes Parallel PEST to stop at its current \niteration.  \nParallel PEST may take a few minutes to run two iterations with the current model, \ndepending on the speed of the computer. MODFLOW is run 129 times for each of the \nPEST iterations \u2014once for each pilot point being estimated.  \n7. Once the MODFLOW parameter estimation has finished, turn on Read solution \non exit  and Turn on contours (if not on already) . \n8. Click Close  to exit the MODFLOW/PEST Parameter Estimation  dialog.  \nThere should be no visible changes in the displayed model.  \n3 Parallel PEST with SVD -Assist  \nNow to run Parallel PEST again with the SVD -Assist option turned on. T his process is \nparticularly advantageous for models that have hundreds or thousands of parameters \n(such as pilot points).  \nSVD-Assist involves 3 basic steps. First, PEST runs MODFLOW once for every \nparameter in order to compute a matrix. This information is used to create super \nparameters that are combinations of the parameters originally specified.  \nSecond, SVDAPREP is run to create a new PEST control file. The options for \nSVDAPREP are entered by clicking  the SVD-Assist Options \u2026 button  in the PEST  \ndialog . For more information on each of these options , see the PEST manual.1 The most \nimportant option entered is the Specify # super param , set to \u201cNo\u201d by default. When this \noption is set to \u201cNo\u201d, the information written to the SVD file will be used to specify the \nnumber of super parameters.  \nThird, PEST runs using the new control file written by SVDAPREP. This should result in \nsignificantly fewer model runs for each PEST iteration. This often results in an order of \nmagnitude reduction in the number of runs required for each PEST  iteration.  \n1. Select MODFLOW | Parameter Estimation \u2026 to open the PEST dialog.  \n2. For the Max number of  iterations (NOPTMAX ), enter \u201c15\u201d . \n3. In the SVD options  section, turn on Use SVD  and Use SVD -Assist . \n4. Click OK to exit the PEST  dialog.  \n5. Select File | Save As \u2026 to bring up the Save As  dialog.  \n6. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n7. Enter \u201c run2_SvdAssist .gpr\u201d as the File name  and click Save  to exit the Save As  \ndialog.  \n8. Click Run MODFLOW   to bring up the MODFLOW/PEST Parameter \nEstimation  dialog.  \nNote:  Each PEST iteration only requires 11 or 22 MODFLOW runs after the initial run of \n129. When PEST finishes running, the error should be about \u201c0.1\u201d.  \n9. When PEST finishes, turn on Read solution on exit  and Turn on contours (if not \non already) . \n \n1 PEST: Model -Independent Parameter Estimation User Manual Part I: PEST, SENSAN, and Global Optimisers  \n(2017). Watermark Numerical Computing, pp.199 -219. \nhttp://www.pesthomepage.org/getfiles.php?file=newpestman1.pdf  \n\nGMS Tutorials   MODFLOW \u2013 Advanced PEST  \n \n Page 6 of 13 \u00a9 Aquaveo 2025  10. Click Close  to exit the MODFLOW /PEST Parameter Estimation  dialog.  \nThe model will change slightly ( Figure 2). Feel free to compare the differences between  \n\u201c run2_PPest (MODFLOW)\u201d and \u201c  run2_SvdAssist (MODFLOW)\u201d.  \n \n      Figure 2      Changes after PEST run with SVD -Assist  \nWhen PEST runs with SVD -Assist, the parameter values are not written to the PAR file \nbecause this file contains the values for the super parameters. The base parameter \nvalues are written to a BPA file.  \n11. Select MODFLOW | Parameters \u2026 to bring up the Parameters  dialog.  \n12. Click Import Optimal Values \u2026 to bring up the Open  dialog.  \n13. Browse to the advPEST/advPEST /run2_S vdAssist_MODFLOW  directory and \nselect \u201c run2_SvdAssist.bpa \u201d. \n14. Click Open  to exit the Open  dialog.  \n15. Click OK to close the Parameters  dialog . \n3.1 Specifying a Precomputed Jacobian  \nThe first step in the SVD -Assist process can be skipped when rerunning the model. The \nJacobian and SVD files must be specified, then SVDAPREP is run followed by Parallel \nPEST.  \n1. Select MODFLOW | Parameter Estimation\u2026  to open the PEST dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Advanced PEST  \n \n Page 7 of 13 \u00a9 Aquaveo 2025  2. Click on the SVD-Assist Options\u2026  button to open the SVD-Assist Options  \ndialog.  \n3. Change the value of the  Specify Jacobian file  row to \u201cYes\u201d.  \n4. Outside of GMS, open a new Windows Explorer window and browse to the \nadvPEST/advPEST /run2_S vdAssist _MODFLOW  directory.  \n5. Find the full path and file name, for the Jacobian file path  field, from the previous \nrun. The file will have a *.jco extension. Example: \nC:\\advPEST \\advP EST\\run2_SvdAssist_MODFLOW \\run2_ svdassist.jco . \n6. Find the full path and file name, for the SVD file path  field, from the previous run. \nThe path will be similar to the following: \nC:\\advPEST \\advP EST\\run2_SvdAssist_MODFLOW \\run2_ svdassist.svd . \n7. Once these paths have been entered into the SVD-Assist Options dialog, click \nOK to exit the SVD-Assist Options  dialog.  \n8. Click OK to exit the PEST  dialog.  \nSaving the Project  \nBefore continuing, save the project with a new file name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c run3_SvdAssist .gpr\u201d as the File name  and click Save  to exit the Save As  \ndialog.  \nRunning PEST  \nWith all of the changes saved, PEST can now be run.  \n1. Click Run MODFLOW   to bring up the MODFLOW/PEST Parameter \nEstimation  dialog.  \nPEST will take several minutes to run. When PEST is finished, a \u201cParameter estimation \nfinished\u201d message will appear in the text portion of the window and the Abort button will \nchange  to Close . \n2. When PEST finishes, turn on Read solution on exit  and Turn on contours (if not \non already) . \n3. Click Close  to exit the MODFLOW/PEST Parameter Estimation  dialog.  \nWhen PEST is finished running the solution will be the same as that computed in Section \n3. \n3.2 Changing the Regularization Option  \nNow try it with the regularization option set to use the Preferred value regularization  \nmethod.  \n1. Select MODFLOW | Parameter Estimation \u2026 to open the PEST dialog.  \n2. In the Tikhonov regularization (only used with pilot points)  section, turn off \nPreferred homogeneous regularization  and turn on Preferred value \nregularization . \n3. Click OK to close the PEST  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Advanced PEST  \n \n Page 8 of 13 \u00a9 Aquaveo 2025  Saving the Project  \nBefore continuing, save the project with a new file name.  \n1. Select File | Save As \u2026 to bring up the Save As  dialog . \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter  \u201cmfpest_pilot_pref_val.gpr \u201d as the File name . \n4. Click Save  to close the Save As  dialog . \nPrior Information Equations  \nIf desired, compare the different prior information equations written from GMS by looking \nat the RPF files in the MODFLOW directories. The prior information equations for \nPreferred homogenous regularization , found in the \u201crun2_SvdAssist .rpf\u201d file in the \nadvPEST \\advPEST \\run2_SvdAssist_MODFLOW  directory, should look like Figure 3. \n \n      Figure 3      First entries in the run2_SvdAssist.rpf file  \nNotice that these equations define a relationship between the different pilot points. In \naddition, the weight applied to these equations changes as shown by the last number \nwritten to each line. In contrast, the prior information equations for Preferred value \nregularization , found in the \u201cmfpest_pilot_pref_val.rpf\u201d file in the \nadvPEST \\advPEST \\mfpest_pilot_pref_val_MODFLOW  directory,  have the same weight \napplied and define a preferred value for each point  (Figure 4). \n \n      Figure 4      First entries in the mfpest_pilot_pref_val.rpf file  \nRunning PEST  \nThe next step is to run PEST.  \n1. Click Run MODFLOW   to bring up the MODFLOW/PEST Parameter \nEstimation  dialog.  \nPEST will take several minutes to run. When PEST is finished, a \u201cParameter estimation \nfinished\u201d message will appear in the text portion of the window.  \n2. Once PEST is finished, turn on Read solution on exit  and Turn on contours (if not \non already).  \n3. Click Close  to exit the MODFLOW/PEST Parameter Estimation  dialog.  \nIf desired, view the new HK field by importing the optimal values and examining the \ncontours as was done previously.  \n4 Multiple Parameters Using Pilot Points  \nIn GMS, pilot points can be used with HK and RCH parameters. Also, there can be \nmultiple HK (or RCH) parameters that use the same or different pilot points.  \n\nGMS Tutorials   MODFLOW \u2013 Advanced PEST  \n \n Page 9 of 13 \u00a9 Aquaveo 2025  Because the problem will be changed to use HK and RCH parameters, the Jacobian and \nSVD files needs to be unspecified. Do this by using the following steps.  \n1. Select MODFLOW | Parameter Estimation\u2026  to open the PEST dialog.  \n2. Click on the SVD-Assist Options\u2026  button to open the SVD-Assist Options  \ndialog.  \n3. Change the value of the  Specify Jacobian file  row to \u201cNo\u201d.  \n4. Click OK to exit the SVD-Assist Options  dialog.  \n5. Click OK to close the PEST  dialog.  \nNext, create a second HK parameter and a new set of pilot points.  \n6. In the Project Explorer , turn off \u201c 3D Grid Data\u201d.  \n7. Fully expand the \u201c  Map Data\u201d folder so the individual coverages under the  \n\u201c BigVal\u201d conceptual model are visible.  \n8. Select the \u201c  Hydraulic Conductivity \u201d coverage to make it active.  \n9. Using the Select Polygons   tool, double -click the polygon surrounding the \nriver in the middle of the model to bring up the Attribute Table dialog.  \n10. In the Horizontal K  column enter \u201c -60.0\u201d (ft/d). \n11. Click OK to close the Attribute Table  dialog . \n12. Right -click on the \u201c  Hydraulic Conductivity \u201d coverage and select Map To | \nMODFLOW/MODPATH . \n4.1 Creating a Second Set of Pilot Points  \nAnother scatter point set needs to be created for the new HK parameter by first creating a \n2D grid and converting it to a scatter point set.  \n1. In the Project Explorer , right-click on the empty space and select New | 2D \nGrid\u2026 to open the Create Finite Difference Grid dialog.  \n2. In the X-Dimension  section, enter \u201c2240.0\u201d as the Origin , \u201c4075.0\u201d ( ft) as the \nLength , and \u201c3\u201d for the Number cells .  \n3. In the Y-Dimension  section, enter \u201c700.00\u201d for the Origin , \u201c11100.0\u201d ( ft) for the \nLength , and \u201c5\u201d for the Number cells . \n4. In the Z-Dimension  section, enter \u201c0.5\u201d for the Origin . This value is assigned to \nthe scatter points created from the grid  \n5. In the Orientation / type  section, select \u201c Cell centered \u201d from the Type  drop-down.  \n      Figure  5 shows how it should appear.  \n6. Click OK to exit the Create Finite Difference Grid  dialog.  \nA new \u201c  grid\u201d will appear under the \u201c  2D Grid Data\u201d folder in the Project Explorer, \nand a new grid will appear on the model in the Graphics Window.  \n7. Right -click \u201c  grid\u201d and select Convert To | 2D Scatter Points  to bring up the \nScatter Point Set Name  dialog.  \n8. For New scatter point set name  enter \u201c HK_60 \u201d. \n9. Click OK to close the Scatter Point Set Name  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Advanced PEST  \n \n Page 10 of 13 \u00a9 Aquaveo 2025  A new \u201c  HK_60\u201d scatter point set should appear under the \u201c  2D Scatter Data \u201d folder \nin the Project Explorer.  \n10. Right -click on \u201c  grid\u201d under the \u201c  2D Grid Data\u201d folder and select Delete  to \nremove the 2D grid.  \n \n \n \n       Figure 5      Create Finite Difference Grid dialog  \n4.2 Creating the New HK Parameter  \nA new parameter should now be created for the new pilot points.  \n1. Select MODFLOW | Parameters \u2026 to open the Parameters dialog.  \n2. Click Initialize From Model . \nThis updates the spreadsheet with data from the new scatter point set.  \n3. In the Name  column, on the row with \u201cHK_60\u201d, turn on the boxes in the Param. \nEst. Solve  column and the Log Xform  column.  \n4. In the Value  column , on the row with \u201cHK_60\u201d , select \u201c <Pilot points> \u201d from the \ndrop-down.  \n5. In the Value  column, click on the  button above the drop -down to open the \n2D Interpolation Options dialog.  \n6. In the Interpolating from  section,  from the Object  drop-down,  select \u201cHK_60  \n(active)\u201d . \n7. Click OK to exit the 2D Interpolation Options dialog.  \n8. Click OK to exit the Parameters dialog.  \n4.3 Using Pilot Points with RCH Parameter  \nPilot points can be used to estimate recharge with the model. For the RCH parameter, \nuse the same set of pilot points that the \u201cHK_30\u201d parameter uses, but create a new \ndataset with starting values for the RCH parameter.  \n1. Right -click the \u201c  Recharge \u201d coverage and select Attribute Table \u2026 to open the \nAttribute Table dialog.  \n2. Select \u201cPolygons\u201d from the Feature type  drop-down.  \n\nGMS Tutorials   MODFLOW \u2013 Advanced PEST  \n \n Page 11 of 13 \u00a9 Aquaveo 2025  3. In the All row, in the Recharge rate  (ft/d) column , enter \u201c -150.0\u201d .  \n4. Click OK to close the Attribute Table  dialog.  \n5. Right -click on the \u201c  Recharge \u201d coverage and select Map To | \nMODFLOW/MODPATH . \nCreating New Starting Values for the RCH Parameter  \nCreate a new dataset on the HK scatter set to provide the starting values for the RCH \nparameter.  \n1. Select \u201c  HK\u201d in the Project Explorer  to make it active.  \n2. Select Edit | Datas et Calculator \u2026 to bring up the Data Calculator  dialog.  \n3. In the Expression  field, enter \u201c 1e-5\u201d. \n4. In the Result  field, enter \u201c RCH \u201d. \n5. Click Compute  button to create a new dataset with all values equal to \u201c1.0e -5\u201d. \n6. Click Done  to exit the Data Calculator  dialog.  \nEditing the RCH Parameters  \nNow to edit the RCH parameters to use pilot points:  \n1. Select MODFLOW | Parameters\u2026  to open the Parameters dialog.  \n2. Delete the \u201c RCH_180 \u201d and \u201c RCH_210 \u201d parameters by selecting any cell in the \nrow and clicking the Delete  button.  \n3. For parameter \u201c RCH_150 ,\u201d in the Value  column , select \u201c<Pilot points> \u201d from the \ndrop-down .  \n4. In the Value  column for parameter \u201c RCH_150 \u201d, click on the  button  above \nthe drop -down arrow to open the 2D Interpolation Options dialog.  \n5. In the Interpolating from  section, select \u201c HK (active)\u201d from the Object  drop-down \nand \u201c RCH \u201d from the Dataset  drop-down.  \n6. Click OK to exit the 2D Interpolation Options  dialog.  \n7. Select OK to exit the Parameters dialog.  \n4.4 Saving the Project and Running PEST  \nBefore running PEST, it is recommended the project be saved under a new name.  \n1. Select File | Save As \u2026 to bring up the Save As  dialog . \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cmfpest_pilot_2zones.gpr \u201d as the File name  and click Save  to close the \nSave As  dialog.  \nWhen pilot points are assigned to both HK and RCH parameters, the prior information \nequations for the HK and RCH parameters are assigned to different regularization \ngroups. This helps PEST to differentiate weighting among pertinent prior information \nequati ons. In other words, PEST works better with this option.  \n4. Click  Run MODFLOW   to bring up the MODFLOW/PEST Parameter \nEstimation  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Advanced PEST  \n \n Page 12 of 13 \u00a9 Aquaveo 2025  PEST will take several minutes to run. When PEST is finished, a \u201cParameter estimation \nfinished\u201d message will appear in the text portion of the window and the Abort  button will \nchange to Close . \n5. Once PEST is finished turn on Read solution on exit  and Turn on contours (if not \non already) . \n6. Click Close  to exit the MODFLOW/PEST Parameter Estimation  dialog.  \nIf desired, turn on the \u201c  3D Grid Data\u201d folder and compare the various solutions to see \nthe differences between them. The final solution for the \u201c  mfpest_pilot_2zones \n(MODFLOW)\u201d solution should appear similar to Figure 6. \n \n      Figure 6      The final solution for mfpest_pilot_2zones (MODFLOW)  \nView the new HK field if desired by importing the optimal values and examining the \ncontours as was done previously. It is possible to view the final hydraulic conductivity \nfield calculated by PEST by selecting the \u201c  HK\u201d item in the Project Explorer  below the  \n\u201c LPF\u201d package under the \u201c  MODFLOW\u201d item.  Note that the file default  is configured \nfor Display key values  instead of Display final array values , which can be changed in the \nDisplay Options  dialog . \n5 A Note on Highly Parameterized Models  \nThe model that was just created has over 100 parameters. This is a fairly simple \nMODFLOW model that converges rather quickly; most real -world problems take longer to \nrun. In such cases, it may not be practical to run MODFLOW over 100 times for each \n\nGMS Tutorials   MODFLOW \u2013 Advanced PEST  \n \n Page 13 of 13 \u00a9 Aquaveo 2025  PEST iteration. However, using SVD -Assist with PEST can dramatically reduce the \nnumber of model runs required for each PEST iteration. When combining SVD -Assist \nwith Parallel PEST, it becomes practical to use PEST with models containing hundreds or \neven th ousands of parameters.  \n6 Conclusion  \nThis concludes the \u201c MODFLOW \u2013 Advanced PEST \u201d tutorial. The following key concepts \nwere discussed and demonstrated in this tutorial:  \n\u2022 GMS supports the SVD option for PEST.  \n\u2022 It is possible to  use Parallel PEST from GMS.  \n\u2022 It is possible to  run SVD -Assist from GMS by simply turning on the option.  When \nusing pilot points and the Import Optimal Values \u2026 button is clicked, a new \ndataset is created for the 2D scatter points.  \n\u2022 It is possible to view the final hydraulic conductivity field calculated by PEST by \nselecting the \u201c HK\u201d item in the Project Explorer  below the \u201c LPF\u201d package.  \n\u2022 It is possible to use pilot points with HK and RCH  parameters and assign pilot \npoints to different parameter zones.  \n \n", "filename": "MODFLOW-AdvancedPest.pdf", "pages": 13}, "MODFLOW-AutomatedParameterEstimation": {"text": "GMS Tutorials   MODFLOW \u2013 Automated Parameter Estimation  \n Page 1 of 12 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Automated Parameter Estimation  \nModel calibration with PEST  \n \nObjectives   \nLearn how to calibrate a MODFLOW model using a zonal approach with PEST . \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Model \nCalibration  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 PEST  Time  \n\uf0b7 25\u201340 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 Automated Parameter Estimation  \n Page 2 of 12 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Importing the Project  ................................ ................................ ................................ ...........  3 \n3 Model Parameterization  ................................ ................................ ................................ ...... 4 \n4 Defining the Parameter Zones  ................................ ................................ ............................  4 \n4.1 Setting up the Hydraulic Conductivity Zones  ................................ ................................  4 \n4.2 Setting up the Recharge Zones  ................................ ................................ ....................  5 \n4.3 Mapping the Key Values to the Grid Cells  ................................ ................................ .... 6 \n5 Setting Parameter Data  ................................ ................................ ................................ ....... 6 \n5.1 Turn on Parameter Estimation  ................................ ................................ ......................  6 \n5.2 Starting Head  ................................ ................................ ................................ ................  7 \n5.3 Editing the Parameter Data  ................................ ................................ ..........................  7 \n5.4 Maximum Iterations  ................................ ................................ ................................ ...... 8 \n6 Saving the Project and Running PEST  ................................ ................................ ..............  8 \n6.1 Viewing the Solution  ................................ ................................ ................................ ..... 9 \n7 Loading Optimal Parameter Values  ................................ ................................ .................  10 \n8 Viewing Parameter Sensitivities  ................................ ................................ .......................  11 \n9 Conclusion  ................................ ................................ ................................ .........................  12 \n \n1 Introduction  \nThe \u201c MODFLOW  \u2013 Model Calibration \u201d tutorial \u2014which should have been  completed prior \nto beginning this tutorial \u2014described the basic calibration tools provided in GMS. It \nillustrated how head levels from observation wells and observed flows from streams \ncould be entered into GMS and how these data could be compared to model computed \nvalues. It also described how a trial -and-error method could be used to iteratively adjust \nmodel parameters until the model computed values matched the field -observed values to \nan acceptable level of agreement.  \nIn many cases, calibration can be achieved much more rapidly with an inverse model. An \ninverse model is a utility that automates the parameter  estimation process. The inverse \nmodel systematically adjusts a user -defined set of input parameters until the difference \nbetween the computed and observed values is minimized.  \nGMS contains an interface to an inverse model called PEST. This tutorial illust rates how \nto calibrate a MODFLOW model using PEST. The model in this tutorial is the same \nmodel featured in the \u201c MODFLOW  \u2013 Model Calibration \u201d tutorial. The model includes \nobserved flow data for the stream and observed heads at a set of scattered observatio n \nwells. The conceptual model for the site consists of a set of recharge and hydraulic \nconductivity zones. These zones will be marked as parameters and an inverse model will \nbe used to find a set of recharge and hydraulic conductivity values that minimize the \ncalibration error.  \nThis tutorial discusses and demonstrates opening a MODFLOW model and solution, \ndefining conditions, running PEST, and loading optimal parameter values.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GM S is already running, select File | New to ensure that the program settings \nare restored to their default state.  \nGMS Tutorials   MODFLOW \u2013 Automated Parameter Estimation  \n \n Page 3 of 12 \u00a9 Aquaveo 2024  2 Importing the Project  \nFirst, import the modeling project:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the Tutorials \\MODFLOW \\inverse  directory and select \u201c bigval.gpr \u201d. \n4. Click Open  to import the project and close the Open  dialog.  \nThe imported project should appear similar to Figure 1. \n \n      Figure 1      Initial screen after importing the project  \n5. Right -click on a blank spot in the Project Explorer and select Expand All .  \nNotice there is now a MODFLOW model with  a solution and a set of map coverages \n(Figure 2). Three of the coverages are the source/sink, recharge, and hydraulic \nconductivity coverages used to define the conce ptual model. The active coverage \ncontains a set of observed head values from observation wells. When switching to the \nsource/sink coverage, notice that an observed flow value has been assigned to the \nstream network.  \n\nGMS Tutorials   MODFLOW \u2013 Automated Parameter Estimation  \n \n Page 4 of 12 \u00a9 Aquaveo 2024   \n      Figure 2      Initial appearance of the Project Explorer  \n3 Model Parameterization  \nThe first step in setting up the inverse model is to \u201cparameterize\u201d the input. This involves \nidentifying which parts of the model input the inverse model utility will optimize. There are \ntwo approaches for parameterization: zonal and pilot points. The tutorial entitled \n\u201cMODFLOW \u2013 Pest Pilot Points\u201d covers the pilot point approach. In this tutorial, the zonal \napproach will be used.  \nThis involves identifying polygonal zones of hydraulic  conductivity and recharge, marking \nthe zones as parameters, and assigning a starting value for each zone. PEST will then \nadjust the K or recharge values assigned to the zones as it attempts to minimize the \nresidual error between computed vs. observed head s and flows.  \n4 Defining the Parameter Zones  \nFor the first attempt at parameter estimation, define a set of parameter zones. The \nconceptual model approach utilized in GMS is ideally suited for this task since the \nconceptual model consists of recharge and K z ones defined with polygons. Mark the \npolygons as parameter zones by assigning a \u201ckey value\u201d to each polygon. The key value \nshould be a value that is not expected to occur elsewhere in the MODLOW input file. A \nnegative value typically works well.  \nUse seven parameter zones consisting of four hydraulic conductivity zones and three \nrecharge zones. The number of observations is eleven, consisting of ten observation \nwells and one stream flow value. Note that the number of parameters being estimated \nshould always be less than the number of observations when using parameter zones.  \n4.1 Setting up the Hydraulic Conductivity Zones  \nStart with setting up the hydraulic conductivity zones. The hydraulic conductivity polygons \nare shown in Figure 3. The five polygons will be used to define five parameter zones. The \nkey values associated with each of the five zones are shown on the polygons in Figure 3. \n\nGMS Tutorials   MODFLOW \u2013 Automated Parameter Estimation  \n \n Page 5 of 12 \u00a9 Aquaveo 2024  \n \nHydraulic Conductivity Zones  \n-30 -60 \n-90 -90 \n-120  \n      Figure 3      Hydraulic conductivity zones and parameter key values  \nTo assign the key values to the polygons:  \n1. Select the \u201c  Hydraulic Conductivity\u201d  coverage in the Project Explorer to make it \nactive.  \n2. Using the Select Polygons   tool, double -click on the central polygon with the \nvalue of \u201c -60\u201d (see Figure 3) to open the Attribute Table dialog.  \n3. In the Horizontal K  (m/d) column in the spreadsheet, enter \u201c -60\u201d and click OK to \nclose the Attribute Table  dialog.  \n4. Repeat steps 2 \u20133 for the remaining four  polygons, entering the parameter key \nvalues as indicated in Figure 3. \n4.2 Setting up the Recharge Zones  \nNext, it is necessary to set up the recharge zones. The recharge p olygons are shown in       \nFigure 4. The five polygons will be used to define four parameter zones. The polygon at \nthe top end of the model is relative ly small; it is isolated from the majority of the \nobservation wells, and it is down gradient from the wells. As a result, it is not a good \ncandidate for parameter estimation. This tutorial will fix the recharge in this zone at zero. \nThe key values will be associated with the other four polygons to define four parameter \nzones as shown.  \n\nGMS Tutorials   MODFLOW \u2013 Automated Parameter Estimation  \n \n Page 6 of 12 \u00a9 Aquaveo 2024  \n \nRecharge Zones  \n0 \n-150 \n-180 -180 \n-210  \n      Figure 4      Recharge zones and parameter key values  \nTo assign the key values to the polygons:  \n1. Select the \u201c  Recharge \u201d coverage to make it active.  \n2. Using the Select Polygon   tool, double -click on the top center polygon as \nshown in Figure 4 to open the Attribute Table dialog.   \n3. In the Recharge rate (m/d)  column of the spreadsheet, enter \u201c0\u201d and click OK to \nclose the Attribute Table  dialog.  \n4. Repeat steps 2 \u20133 for the remaining four recharge polygons, entering the \nappropriate values from Figure 4. \n4.3 Mapping the Key Values to the Grid Cells  \nOnce the key values are assigned to the polygons, they must be mapped to the cells in \nthe MODFLOW grid.  \n1. Select Feature Objects | Map \u2192 MODFLOW  to bring up the Map \u2192 Model  \ndialog . \n2. Click  OK to accept the defaults and close the Map \u2192 Model  dialog.  \n5 Setting Parameter Data  \n5.1 Turn on Parameter Estimation  \nBefore editing the parameter data, it is necessary to turn on the Parameter Estimation  \noption by doing the following:  \n\nGMS Tutorials   MODFLOW \u2013 Automated Parameter Estimation  \n \n Page 7 of 12 \u00a9 Aquaveo 2024  1. Select \u201c  3D Grid Data \u201d in the Project Explorer  to make the module  active . \n2. Select MODFLOW  | Global Options \u2026 to open the MODFLOW Global/Basic \nPackage dialog.  \n3. In the Run options  section, select Parameter Estimation . \n5.2 Starting Head  \nThe head contours currently displayed on the grid are from a forward run of a MODFLOW \nsimulation using the starting parameter values. Before running PEST, copy the computed \nheads to the starting heads array. This will ensure that each time PEST runs MODFLO W, \nthe starting head values will be reasonably close to the final head values and MODFLOW \nshould converge quickly.  \n1. Turn off Starting heads equal grid top elevations.   \nThis allows the starting heads to be set manually.  \n2. Click Starting Heads \u2026 to open the Starting Heads dialog.  \n3. Click 3D Datas et \u2192 Grid\u2026 to bring up the Select Dataset  dialog.  \n4. Expand the \u201c  bigval (MODFLOW) \u201d folder and select the \u201c  Head\u201d  dataset.  \n5. Click OK to close the Select Dataset  dialog . \n6. Click OK to exit the Starting Heads  dialog.  \n7. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \nNote:  If PEST fails during the process between two successive Jacobian run s, this could \nbe due to the non convergence of the model. Such non convergence can be due to a set \nof initial heads too far from the so lution to be calculated into PEST process.  To verify this, \nimport the last optimal parameters (see  Section  7), run a forward model , and use the \ncalculated heads as new \"starting heads\".  \n5.3 Editing the Parameter Data  \nNext to create a list of parameters and enter a starting, minimum, and maximum value for \neach.  \n1. Select MODFLOW  | Parameters\u2026  to open the Parameters dialog.  \nThe Parameters  section is used to manage a list of p arameters used by the inverse \nmodel. Each parameter has several properties, including a name, a key value, a type, a \nstarting value, a minimum value, a maximum value, a usage field, and a log -transform \nfield.  \nRather than creating each parameter individual ly, the parameter list can be automatically \ngenerated by GMS in most cases by using the Initialize From Model  button. GMS then \nsearches the MODFLOW input data for likely key values and creates a list of parameters. \nIf a parameter is not automatically found  by GMS, it can be added using the New button.  \n2. Click Initialize F rom Model  to load data from the existing model.  \nNote that all seven parameters were automatically found. Also note that each parameter \nhas been given a default name. The next step is to enter  a starting, minimum, and \nmaximum value for each parameter. Special care should be taken when selecting the \nstarting values. In most cases, using arbitrary starting values will cause the inverse model \nto fail to converge. The closer the starting values are  to the final parameter values, the \n\nGMS Tutorials   MODFLOW \u2013 Automated Parameter Estimation  \n \n Page 8 of 12 \u00a9 Aquaveo 2024  greater the chance that the inverse model will converge. The starting values to be used \nwere found after a few iterations of manual (trial -and-error) calibration.  \n3. For all parameters, check on the boxes in both the Param.  Est. Solve  and Log \nXform  columns.  \n4. Enter the following data into the parameters spreadsheet:  \nName  Value  Min Value  Max Value  \nHK_30  1.2 0.003  30 \nHK_60  2.4 0.003  30 \nHK_90  0.6 0.003  30 \nHK_120  0.2 0.003  30 \nRCH_150  0.0001  1e-10 0.0001  \nRCH_180  0.00008  1e-10 0.0001  \nRCH_210  0.00006  1e-10 0.0001  \n5. Select OK to exit the Parameters  dialog.  \n5.4 Maximum Iterations  \nFinally, increase the maximum number of iterations used by the solver package. This will \nincrease the likelihood that MODFLOW will converge at each iteration . \n1. Select MODFLOW  | PCG \u2013 Pre. Conj. \u2013Gradient Solver\u2026  to open the \nMODFLOW PCG Package dialog.  \n2. Enter \u201c100\u201d as the Maximum number of outer iterations  (MXITER ). \n3. Enter \u201c100\u201d as the Number of  inner iterations  (ITER1). \n4. Click OK to close the MODFLOW PCG Package  dialog.  \n6 Saving the Project and Running PEST  \nIt is now possible to save the project and run PEST.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c mfpest_zones. gpr\u201d as the File na me.  \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n5. Click Run MODFLOW   to bring up the MODFLOW/PEST Parameter \nEstimation  model wrapper dialog.  \nPEST is now running. The spreadsheet in the top -right-hand corner of the dialog  shows \nthe error and parameter values for each iteration of the parameter estimation process. \nThe plot on the left shows the error for each iteration. When PEST is finished running, \nreview the optimum parameter values in the spreadsheet. Once PEST has foun d the \noptimum parameter values, MODFLOW will run a forward run with the optimum values \nand output the head solution. This will be the solution that will be imported.  \nNote: If there is room on the screen, consider resizing the output window by dragging the \nhandle in the lower right corner of the window.  \n\nGMS Tutorials   MODFLOW \u2013 Automated Parameter Estimation  \n \n Page 9 of 12 \u00a9 Aquaveo 2024  6.1 Viewing the Solution  \nOnce MODFLOW is done running, import the solution.  \n1. Turn on Read solution on exit  and Turn on contours  (if not on already).  \n2. Click Close  to exit the MODFLOW/PEST Parameter Estimation  model wrapper \ndialog.  \nThe contours currently shown on the 3D grid are the heads from the MODFLOW run with \nthe optimum parameter values. Now look at the observation targets in the map module \nand the error associated with this model run.  \n3. Select the \u201c  Observation Wells \u201d coverage. Notice that the residual error has \nbeen greatly reduced for all monitoring wells ( Figure 5). \n \n      Figure 5      Each well shows a reduced residual error  \n4. Select the \u201c  Sources & Sinks \u201d coverage. Notice that the observation target \n(located near the top of the stream) shows very little residual error (red circle in \nFigure 6). \n\nGMS Tutorials   MODFLOW \u2013 Automated Parameter Estimation  \n \n Page 10 of 12 \u00a9 Aquaveo 2024   \n      Figure 6      Observation target shows very small residual error  \n5. Using the Select Arc Group   tool, select the arc group by clicking on a river \narc. Notice  in the e dit strip at the bottom of the Graphics E indow the computed \nand observed flow is reported ( Figure 7). \n \n      Figure 7      Edit str ip showing computed, observed, and residual flows  \nNext, look at some global error norms.  \n6. Expand the \u201c  3D Grid Data\u201d and \u201c  grid\u201d items if necessary.  \n7. Right -click on \u201c  mfpest_zones (MODFLOW)\u201d  and select Properties \u2026 to open \nthe Properties dialog.  \nThis command brings up a spreadsheet showing the residual error (computed -observed) \nfrom this model run. The spreadsheet shows the error from the head observations, the \nflow observations, and the combined weighted observations. If desired, compare the \nvalues fr om this run to the \u201c bigval \u201d MODFLOW solution.  \n8. Click OK to exit the Properties  dialog . \n7 Loading Optimal Parameter Values  \nWhen finished using the inverse model, it is often desirable to load and view the optimal \nparameter values. Now load the optimal paramete rs. \n1. Select the \u201c  3D Grid Data \u201d folder in the Project Explorer  to make it active . \n2. Select MODFLOW  | Parameters \u2026 to open the Parameters dialog.  \n3. Click Import Optimal Values  to bring up the Open  dialog.  \n4. Select \u201cPAR File (*.par,*.bpa)\u201d from the drop -down to the  right of the File name  \nfield.  \n5. Browse to the Tutorials \\MODFLOW \\inverse \\mfpest_zones_MODFLOW  directory \nand select \u201c mfpest_zones.par\u201d . \n6. Click Open  to import the parameters file and close the Open  dialog.  \nNotice that the starting values for all of the paramete rs have now been changed to the \noptimal value computed by the inverse model.  \n\nGMS Tutorials   MODFLOW \u2013 Automated Parameter Estimation  \n \n Page 11 of 12 \u00a9 Aquaveo 2024  7. Click OK to exit the Parameters  dialog . \n8 Viewing Parameter Sensitivities  \nIn addition to computing the optimal parameter values, PEST  will compute the \nsensitivities of each parameter. This information is printed to the SEN file at each \nparameter estimation iteration. Use the Plot Wizard  in GMS to create a plot of this \ninformation.  \n1. Click Plot Wizard   to bring up the Step 1 of 2  page of the Plot Wizard  dialog.  \n2. In the Plot Type  section, select Parameter Sensitivities  from the list on the left . \n3. Click Next > to go to the Step 2 of 2  page of the Plot Wizard  dialog.  \n4. Click Finish  to close the Plot Wizard  dialog.  \nThe plot should be simil ar to the one in Figure 8. \n \n      Figure 8      Parameter sensitivity plot  \nFor a more in -depth explanation of the calculations used to create this file, refer to the \nPEST documentation (section 5.3.2 of the PEST Manual). The parameter sensitivity \ninformation is useful in identifying the parameters that have the greatest effect on  the \nmodel and those parameters that have a little or no effect on the model. If desired, \nremove or hold constant the \u201cinsensitive\u201d parameters in another PEST model run.  \n\nGMS Tutorials   MODFLOW \u2013 Automated Parameter Estimation  \n \n Page 12 of 12 \u00a9 Aquaveo 2024  9 Conclusion  \nThis concludes the \u201c MODFLOW  \u2013 Automated Parameter Estimation \u201d tutorial. Th e \nfollowing key topics were discussed and demonstrated:  \n\uf0b7 Use the zonal approach or the pilot point approach with PEST. When using pilot \npoints, there may be more parameters than observations because regularization \nis included in the parameter estimation.  \n\uf0b7 When PEST finishes, the solution imported into GMS corresponds to the optimal \ninput values. However, the input values in GMS are still the starting values. The \nImport Optimal Values  button must be used to replace the starting values with \nthe optimal values.  \n\uf0b7 View the parameter sensitivities by creating a sensitivity plot using the Plot \nWizard . \n \n", "filename": "MODFLOW-AutomatedParameterEstimation.pdf", "pages": 12}, "MODFLOW-ConceptualModelApproach1": {"text": "GMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 1  \n Page 1 of 13 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Conceptual Model Approach 1  \nBuild a basic MODFLOW model using the conceptual model approach  \n \nObjectives   \nThe conceptual model approach involves using the GIS tools in the Map module to develop a conceptual \nmodel of the site being modeled. The location of sources/sinks, model boundaries, layer parameters \n(such as hydraulic conductivity), and all other data necessary for the simulation can be defined at the \nconceptual model level without a grid.  \n \nPrerequisite Tutorials  \n\uf0b7 Feature Objects  \n\uf0b7 MODFLOW \u2013 Grid \nApproach  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 20\u201330 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 1  \n Page 2 of 13 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  3 \n2 Importing the Background Image ................................ ................................ .......................  3 \n3 Saving the Project  ................................ ................................ ................................ ...............  4 \n4 Defining the Boundary  ................................ ................................ ................................ ........  4 \n4.1 Creating the Coverage  ................................ ................................ ................................ .. 4 \n4.2 Creating the Arc  ................................ ................................ ................................ ............  5 \n5 Defining the Rivers  ................................ ................................ ................................ ..............  6 \n5.1 Assigning the Head Arcs  ................................ ................................ ..............................  6 \n5.2 Building the Polygons  ................................ ................................ ................................ ... 8 \n6 Defining the Aquifer  ................................ ................................ ................................ ............  8 \n6.1 Copying the Boundary  ................................ ................................ ................................ .. 8 \n6.2 Assigning Values  ................................ ................................ ................................ ..........  9 \n7 Setting up the Grid  ................................ ................................ ................................ ..............  9 \n7.1 Locating the Grid Frame  ................................ ................................ ...............................  9 \n7.2 Creating the Grid  ................................ ................................ ................................ ........  10 \n8 Preparing for the MODFLOW Model Run  ................................ ................................ .........  11 \n8.1 Initializing the MODFLOW Data  ................................ ................................ ..................  11 \n8.2 Defining the Active/Inactive Zones  ................................ ................................ ..............  11 \n8.3 Converting the Conceptual Model  ................................ ................................ ...............  11 \n8.4 Defining the Starting Head  ................................ ................................ ..........................  12 \n8.5 Checking the Simulation  ................................ ................................ .............................  12 \n9 Saving and Running MODFLOW  ................................ ................................ ......................  12 \n10 Conclusion  ................................ ................................ ................................ .........................  13 \n \n1 Introduction  \nTwo approaches can be used to construct a MODFLOW simulation in GMS: grid or \nconceptual model. The grid approach works directly with the 3D grid and applies \nsources/sinks, and other model parameters on a cell -by-cell basis. The steps involved in \nthe grid approach are described in th e \u201cMODFLOW \u2013 Grid Approach \u201d tutorial.  \nIn this tutorial, an outer boundary will be created for the model. The rivers will be defined \nand heads will be assigned to the various arcs in the boundary before building the \ncoverage polygons. The hydraulic conduct ivity and layer elevations of the aquifer will be \ndefined. A grid frame will be created and a grid will be created within it.  \nThe MODFLOW active and inactive zones will be defined, the conceptual model will be \nconverted to a grid -based model, the starting  head will be assigned, and the simulation \nwill then be run.  The problem solved in this tutorial is illustrated in Figure 1.  \nThis tutorial models the groundwater flow in the valley sediments bounded by the hills to \nthe north and the two converging rivers to the south of a site in eastern Texas in the \nUnited States. The boundary to the north will be a no -flow boundary and the remaining \nboundary will be a  general head boundary corresponding to the average stage of the \nrivers.  \nIt is necessary to assume that the influx to the system is primarily through recharge due \nto rainfall. There are some creek beds in the area which are sometimes dry but \noccasionally fill up due to influx from the groundwater. These creek beds will be \nrepresented using drains. Two production wells in the area will also be included in the \nmodel.  \nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 1  \n \n Page 3 of 13 \u00a9 Aquaveo 2024  \n \nRiver  Well #1  \nWell #2  \nRiver  Creek beds  Limestone Outcropping  North   \n      Figure 1      Plan view of site to  be modeled  \nThis tutorial discusses and demonstrates the following key concepts:  \n\uf0b7 Importing a background image  \n\uf0b7 Creating and defining coverages  \n\uf0b7 Mapping the coverages to a 3D grid  \n\uf0b7 Checking the simulation and running MODFLOW  \n1.1 Getting Started  \nDo the following  to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2 Importing the Background Image  \nBefore setting up the simulation, import a digital image of the site being modeled. This \nimage was created by scanning a portion of a USGS quadrangle map on a desktop \nscanner. The image was imported into GMS, registered, and a GMS project file was \nsaved.  \nOnce the image is imported into GMS, it can be displayed in the background as a guide \nfor on -screen digitizing and placement of model features.  \nImport the image by doing the following:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr) \u201d from the Files of type  drop-down.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 1  \n \n Page 4 of 13 \u00a9 Aquaveo 2024  3. Browse to the modfmap1  directory and select \u201cstart.gpr\u201d.  \n4. Click Open  to import the project file and close the Open  dialog.  \nThe Main Graphics Window will appear as in Figure 2. All other objects in GMS are \ndrawn on top of the image. The image will only appear in plan view.  \n \n      Figure 2      The imported map  \n3 Saving the Project  \nBefore making any changes, save the project under a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201ceasttex.gpr\u201d for the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \nIt is recommended to periodically Save   while working through the tutorial and while \nworking on any project.  \n4 Defining the Boundary  \nThe first step is to define the outer boundary of the model. This will be done by creating \nan arc that forms a closed loop around the site. When building a model, it is \nrecommended to build one component at a time. This makes it easier to resolve \nproblems with the model later on.  \n4.1 Creating the Coverage  \n1. Right -click on the empty space in the Project Explorer and select New | \nConceptual Model\u2026  to bring up the Conceptual Model Properties  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 1  \n \n Page 5 of 13 \u00a9 Aquaveo 2024  2. Enter \u201cEast Texas\u201d for the Name .  \n3. Select \u201cMODFLOW\u201d from the Type  drop-down.  \n4. Click OK to close the Conceptual Model  Properties  dialog.  \n5. Right -click on the \u201c  East Texas\u201d conceptual model and select New \nCoverage\u2026  to bring up the Coverage Setup  dialog.  \n6. Enter \u201cBoundary\u201d for the Coverage name . \n7. Enter \u201c213.0\u201d as the Default elevation . \n8. Click OK to close the Coverage Setup  dialog . \n4.2 Creating the Arc  \nNormally a boundary arc will be manually digitized. To see how this is done, do the \nfollowing:  \n1. Select the new \u201c  Boundary\u201d coverage to make it active and to switch to the \nMap module.  \n2. Using the Create Arc   tool, click out an arc b eginning at point (a) in Figure 3, \nfollowing the river southeast as shown (b), then northeast from the convergence \n(c), then along the foot of the lime stone outcroppings on the north (d) until back \nat the start point (e). Don't worry about the spacing or the exact location of the \npoints; just use enough points to define the approximate location of the \nboundary.  \n3. To end the arc, click on the starting poin t. \nIf a mistake is made while clicking on the points, press the Backspace  key to backup. If \nwanting to abort the arc and start over, press the Esc key.  \nFor consistency purposes, a previously generated arc will be imported for use during the \nrest of the tu torial.  \n4. Right -click on the \u201c  East Texas\u201d conceptual model and select Delete . \n5. Click Open   to bring up the Open  dialog.  \n6. Select \u201cMap Files (*.map)\u201d from the Files of type  drop-down.  \n7. Browse to the modfmap1  directory and select \u201cBoundary.map\u201d.  \n8. Click Open  to import the project file and close the Open  dialog.  \nThe \u201c  East Texas\u201d conceptual model will reappear with an arc on a \u201c  Boundary\u201d \ncoverage that will be used for the rest of the tutorial.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 1  \n \n Page 6 of 13 \u00a9 Aquaveo 2024   \n      Figure 3      Creating the boundary arc  \n5 Defining the Rivers  \nThe next step in building the conceptual model is to construct the l ocal sources/sinks \ncoverage. This coverage defines the boundary of the region being modeled and defines \nlocal sources/sinks including wells, rivers, drains, and general head boundaries.  \nThe properties that can be assigned to the feature objects in a covera ge depend on the \nconceptual model and the options set in the Coverage Setup  dialog. Before creating the \nfeature objects, it is necessary to change these options.  \n1. Right -click on the \u201c  Boundary\u201d coverage and select Duplicate  to create a new \n\u201c Copy of Bound ary\u201d coverage.  \n2. Right -click on \u201c  Copy of Boundary\u201d and select Properties\u2026 to bring up the \nProperties  dialog.  \n3. For the Coverage name , enter \u201cRivers\u201d and press the Enter  key. \n4. Click OK to close the Properties  dialog.  \n5. Right -click on \u201c  Rivers\u201d and select Coverage Setup\u2026 to bring up the \nCoverage Setup  dialog.  \n6. In the Sources/Sinks/BCs  column, turn on General Head.  \n7. Near the bottom left of the dialog, turn on Use to define model boundary (active \narea) . \n8. Click OK to close the Coverage Setup  dialog.  \n5.1 Assigning the  Head Arcs  \nThe next step is to define the head boundaries along the south and east sides of the \nmodel. Before doing this, however, it is necessary to first split the arc that was just \ncreated into three arcs. One arc will define the no -flow boundary along the top and the \n(e) Click here to \nend (d) Foot of the limestone \noutcropping  \n(c) Northeast along this \nriver \n(b) Southeast along this \nriver (a) Start \nhere \nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 1  \n \n Page 7 of 13 \u00a9 Aquaveo 2024  other two arcs will define the two rivers. An arc is split by selecting one or more vertices \non the arc and converting the vertices to nodes.  \n1. Select \u201c  River s\u201d in the Project Explorer to make it active.  \n2. Using the Select Vertices   tool, sel ect the two vertices shown in Figure 4 by \nselecting one of them, then holding down the Shift key and selecting the other \none. Vertex #1 is located at the junction of the two rivers. Vertex #2 is located at \nthe top of the river on the east side of the model.  \n3. Right -click on one of the selected vertices and select Vertex \u2192 Node  to change \nthem into n odes.  \n \n      Figure 4      Convert vertices to nodes  \nNow that the three arcs have been defined, the two arcs on the rivers should be classified \nas specified head arcs.  \n4. Using the Select Arcs   tool, select the arcs on the south and  east sides (right \nand bottom) of the model by selecting one arc and holding down the Shift key \nwhile selecting the other arc.  \n5. Right -click on one of the selected arcs and select Attribute Table \u2026 to bring up \nthe Attribute Table  dialog . \n6. On the All row, selec t \u201cgen. head\u201d from the drop -down in the Type  column. This \nwill change the types for both arcs.  \n7. On the All row, enter \u201c1.0\u201d for the Cond (m^2/d)/(m)  column.  \n8. Click OK to close the Attribute Table  dialog . \n9. Click anywhere on the model other than on the arcs to unselect them. Notice that \nthe color of the arcs has changed to indicate the arc type.  \nThe next step is to define the head at the nodes at the ends of the arcs. The head along \na specified head arc is assumed to vary linearly along the length of the arc.  \n10. Using the Select Points/Nodes   tool, double -click on the western (left) node \nof the arc on the southern (bottom) boundary to bring up the Attribute Table  \ndialog.  \n11. Enter \u201c 212.0\u201d on row 1 (with Type  \u201cgen. head\u201d) in the Head -Stage  (m) column.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 1  \n \n Page 8 of 13 \u00a9 Aquaveo 2024  12. Click OK to close the Attribute Table  dialog.  \n13. Using the Select Points/Nodes   tool, double -click on the southern (bottom) \nnode where the rivers converge to bring up the Attribute Table  dialog.  \n14. Enter \u201c208.0\u201d on row 3 in the Head -Stage  (m) column.  \n15. Click OK to close the Attrib ute Table  dialog.  \n16. Using the Select Points/Nodes   tool, double -click on the northern (top) node \nof the arc on the east (right) boundary to bring up the Attribute Table  dialog.  \n17. Enter \u201c 214.0\u201d on row 4 (with Type  \u201cgen. head\u201d) in the Head -Stage  (m) column.  \n18. Click OK to close the Attribute Table  dialog.  \n5.2 Building the Polygons  \nWith the local sources/sinks type coverage, the entire region to be modeled must be \ncovered with non -overlapping polygons. This defines the active region of the grid. In most \ncases, all of the polygons will be variable head polygons (the default). However,  other \npolygons may be used.  \nFor example, to model a lake, a general head polygon can be used. The simplest way to \ndefine the polygons is to first create all of the arcs used in the coverage and then select \nthe Build Polygons command. This command searches through the arcs and creates a \npolygon for each of the closed loops defined by the arcs. These polygons are of type \n\u201cNONE\u201d by default but may be converted to other types by selecting the polygons and \nusing the Properties  comm and. \nNow that the arcs in the coverage have been created, it is possible to construct the \npolygons. All of the polygons will be variable head polygons.  \n1. Click the Build Polygons   macro.  \nNotice that the polygon is now filled.  \nIf desired, change the view of  the polygons by selecting Display | Display Options\u2026  and \nchanging the option in the Display Options  dialog.  \n6 Defining the Aquifer  \nA separate coverage will be used to represent the hydraulic conductivity and the layer \nelevations for the aquifer.  \n6.1 Copying th e Boundary  \nCreate the layer coverage by copying the boundary.  \n1. Right -click on the \u201c  Boundary\u201d coverage and select Duplicate  to create a new \n\u201c Copy of Boundary\u201d  coverage.  \n2. Right -click on \u201c  Copy of Boundary\u201d  and select Coverage Setup\u2026  to bring up \nthe Covera ge Setup  dialog.  \n3. Enter \u201cAquifer Layer 1\u201d as the Coverage name . \n4. In the Areal Properties  column, turn on Horizontal K, Top elev.,  and Bottom elev. . \n5. Click OK to close the Coverage Setup  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 1  \n \n Page 9 of 13 \u00a9 Aquaveo 2024  6.2 Assigning Values  \nThe hydraulic conductivity of the aquifer should  now be entered. In many cases, multiple \npolygons are defined by defining hydraulic conductivity zones. For the sake of simplicity, \nthis tutorial will use a constant value for the entire grid.  \nTo assign a K value for the layer:  \n1. Select the \u201c  Aquifer Layer 1\u201d coverage in the Project Explorer to make it active . \n2. Click Build Polygons   to create a polygon on the \u201cLayer 1\u201d coverage.  \n3. Using the Select Polygons   tool, double -click on the polygon to bring up the \nAttribute Table  dialog.  \n4. Enter \u201c5.5\u201d in the Horizonal K (m/d)  column.  \nThe final step is to define the layer elevations of the model. In this tutorial, a constant \nelevation will be set for the top and bottom of the grid. Other tutorials instruct how to \ninterpolate elevations from points to get more realistic layer elevations.  \n5. Enter \u201c230.0\u201d in the Grid Top elev.  column.  \n6. Enter \u201c175.0\u201d in the Grid Bot. elev. column.  \n7. Click OK to close the Attribute Table  dialog . \n7 Setting up the Grid  \n7.1 Locating the Grid Frame  \nNow that the coverages are complete, it is possible to crea te the grid. The first step in \ncreating the grid is to define the location and orientation of the grid using the grid frame. \nThe grid frame represents the outline of the grid. It can be graphically positioned on top of \nthe site map.  \n1. In the Project Explorer , right -click on the empty space and select New | Grid \nFrame .  \nA grid frame should appear in the Graphics Window and a new \u201cGrid Frame\u201d should \nappear in the Project Explorer.  \n2. Using the Select Grid   tool, right -click on \u201c  Grid Frame\u201d border and select \nFit to Active Coverage .  \nThe grid frame will adjust to fit the active coverage entirely within it ( Figure 5). \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 1  \n \n Page 10 of 13 \u00a9 Aquaveo 2024   \n      Figure 5      The grid frame is the purple box around the coverage  \n7.2 Creating the Grid  \nWith the coverages and the grid frame created, it is now possible to create the grid.  \n1. Select \u201c  River s\u201d in the Project Explorer to make it active.  \n2. Select Feature Objects  | Map \u2192 3D Grid to bring up the Create Finite Difference \nGrid dialog.  \nNotice that the grid is dimensioned using the data from the grid frame. If a grid frame \ndoes not exist, the grid is defaulted to surround the model with approximately 5% overlap \non the sides.  \n3. Under  the X-Dimension  and Y-Dimension  sections, select Cell size  for both and \nenter \u201c20.0\u201d.  \n4. Click OK to close the Create Finite Difference Grid  dialog.  \nA 3D grid will appear within the grid frame ( Figure 6). \n \n      Figure 6      3D grid  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 1  \n \n Page 11 of 13 \u00a9 Aquaveo 2024  8 Preparing for the MODFLOW Model Run  \n8.1 Initializing the MODFLOW Data  \nNow that the grid is constructed, it is necessary to initialize the MODFLOW data before \nconverting the conceptual model to a grid -based numerical model.  \n1. Right -click on the \u201c  grid\u201d item in the Project Explorer and select New \nMODFLOW\u2026  to bring up the MODFLOW Global/Basic Package  dialog.  \n2. Click OK to accept the defaults and c lose the MODFLOW Global/Basic Package  \ndialog.  \n8.2 Defining the Active/Inactive Zones  \nWith the grid constructed and MODFLOW initialized, the next step is to define the active \nand inactive zones of the model. This is accomplished automatically using the information \nin the local sources/sinks coverage.  \n1. Select the \u201c  Rivers\u201d coverage in the Project Explorer to make it active.  \n2. Select Feature Objects | Activate Cells in Coverage(s) . \nEach of the cells in the interior of any polygon in the local sources/sinks c overage is \ndesignated as active, and each cell outside of all of the polygons is designated as \ninactive. Notice that the cells on the boundary are activated such that the no -flow \nboundary at the top of the model approximately coincides with the outer cell edges of the \ncells on the perimeter while the specified head boundaries approximately coincide with \nthe cell centers of the cells on the perimeter ( Figure 7). \n \n      Figure 7      Only active cells are visible  \n8.3 Converting the Conceptual Model  \nIt is now possible to convert the conceptual model from the feature object -based \ndefinition to a grid -based MODFLOW numerical model.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 1  \n \n Page 12 of 13 \u00a9 Aquaveo 2024  1. Right -click on the \u201c  East Texas\u201d conceptual model and select Map To | \nMODFLOW / MODPATH  to bring up the Map \u2192 Model  dialog.  \n2. Select All applicable coverages  and click OK to close the Map \u2192 Model  dialog. \nThe Graphics Window should appear as in Figure 8. \nNotice that the cells underlying the general head boundaries were all identified and \nassigned the appropriate sources/sinks. The heads and e levations of the cells were \ndetermined by linearly interpolating along the general head arcs. In addition, the hydraulic \nconductivity values were assigned to the appropriate cells.  \n \n      Figure 8      After the conceptual model i s converted to MODFLOW  \n8.4 Defining the Starting Head  \nIt is necessary to define the starting head before running MODFLOW. Because this \ntutorial is using the top elevation (230 m) as the starting head value, it is not necessary to \nmake any changes because the starting heads are set to the grid top elevation by default.  \n8.5 Checking the Simulation  \nAt this point, the MODFLOW data is completely defined and now ready to run the \nsimulation. It is advisable to run the Model Checker  to see if GMS can identify any \nmistakes  that may have been made.  \n1. Select MODFLOW  | Check Simulation\u2026  to bring up the Model Checker  dialog.  \n2. Click Run Check . There should be no errors.  \n3. Click Done  to exit the Model Checker  dialog.  \n9 Saving and Running MODFLOW  \nSave the project before running MODFLOW.  \n1. Click the Save   macro.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 1  \n \n Page 13 of 13 \u00a9 Aquaveo 2024  Saving the project not only saves the MODFLOW files but it saves all data associated \nwith the project including the feature objects and scatter points.  \n2. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog. The m odel run should complete quickly.  \n3. When MODFLOW is finished, turn on Read solution on exit  and Turn on contours \n(if not on already).  \n4. Click Close  to close the MODFLOW  model wrapper dialog.  \nContours should appear ( Figure 9). These are contours of the computed head solution.  \n \n      Figure 9      The contours are visible after the MODFLOW model run  \n10 Conclusion  \nThis concludes the \u201c MODFLOW  \u2013 Conceptual Model Approach 1\u201d  tutorial. Additional \nconceptual model tutorials further explore this approach. The following key concepts \nwere demonstrated and discussed:  \n\uf0b7 A background image can be imported to help construct the conceptual model.  \n\uf0b7 It is usually a good idea to define the model boundary in a coverage and copy \nthat coverage whenever it is necessary to create a new coverage.  \n\uf0b7 It is possible to customize the set of properties associated with points, arcs and \npolygons by using the Coverage Se tup dialog.  \n\uf0b7 Some arc properties, like head, are not specified by selecting the arc but by \nselecting the nodes at the ends of the arc. That way the property can vary \nlinearly along the length of the arc.  \n\uf0b7 A grid frame can be used to position the grid, but is  not required.  \n\uf0b7 It is necessary to use the Map \u2192 MODFLOW / MODPATH  command every time \nthat conceptual model data is transferred to the grid.  \n \n \n\n", "filename": "MODFLOW-ConceptualModelApproach1.pdf", "pages": 13}, "MODFLOW-ConceptualModelApproach2": {"text": "GMS  Tutorials   MODFLOW \u2013 Conceptual Model Approach 2  \n Page 1 of 13 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Conceptual Model Approach 2  \nAdding drains, wells, and recharge  to MODFLOW using the conceptual model \napproach  \nObjectives   \nThe conceptual model approach involves using the GIS tools in the Map module to develop a conceptual \nmodel of the site being modeled. The location of sources/sinks, model boundaries, layer parameters \n(such as hydraulic conductivity), and all other data necessa ry for the simulation can be defined at the \nconceptual model level without a grid.  \n \nPrerequisite Tutorials  \n\uf0b7 Feature Objects  \n\uf0b7 MODFLOW \u2013 Grid \nApproach  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 15\u201330 minutes  \n \nGMS 10.8  \n\nGMS  Tutorials   MODFLOW \u2013 Conceptual Model Approach 2  \n Page 2 of 13 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  3 \n2 Importing the Project  ................................ ................................ ................................ ...........  3 \n3 Saving the Project  ................................ ................................ ................................ ...............  4 \n4 Delineating the Recharge Zones  ................................ ................................ ........................  4 \n4.1 Copying the Boundary  ................................ ................................ ................................ .. 4 \n4.2 Assigning the Recharge Values  ................................ ................................ ....................  5 \n4.3 Assigning the Recharge Values  ................................ ................................ ....................  5 \n4.4 Checking the Simulation  ................................ ................................ ...............................  5 \n4.5 Saving and Running MODFLOW  ................................ ................................ ..................  5 \n5 Creating the Wells  ................................ ................................ ................................ ...............  6 \n5.1 Creating the Wells Coverage  ................................ ................................ ........................  6 \n5.2 Creating the Wells Points  ................................ ................................ .............................  6 \n5.3 Converting the Conceptual Model  ................................ ................................ .................  7 \n5.4 Checking the Simulation  ................................ ................................ ...............................  7 \n5.5 Saving and Running MODFLOW  ................................ ................................ ..................  7 \n6 Defining the Drain Arcs  ................................ ................................ ................................ ....... 8 \n6.1 Importing the Drain Arcs  ................................ ................................ ...............................  8 \n6.2 Assigning the Drains  ................................ ................................ ................................ ..... 9 \n6.3 Converting the Conceptual Model  ................................ ................................ ...............  10 \n6.4 Checking the Simulation  ................................ ................................ .............................  11 \n6.5 Saving and Running MODFLOW  ................................ ................................ ................  11 \n7 Viewing the Solutions  ................................ ................................ ................................ ....... 12 \n7.1 Viewing the Water Table in Side View  ................................ ................................ ........  12 \n7.2 Viewing the Flow Budget  ................................ ................................ ............................  12 \n8 Conclusion  ................................ ................................ ................................ .........................  13 \n \n1 Introduction  \nThis tutorial builds on the \u201cMODFLOW \u2013 Conceptual Model Approach 1\u201d tutorial. In that \ntutorial, a one -layer model using the conceptual model approach was built. The only \nfeatures assigned were the rivers, creating a simple model.  \nThis tutorial will start with that simple model then add drains, wells, and recharge. \nMODFLOW will execute after each feature is added to monitor the progressive change in \nthe model.  \nThe problem t his tutorial will be solving is illustrated in Figure 1. The site is located in \neastern Texas in the United States of America.  \nThis project will be mod eling the groundwater flow in the valley sediments bounded by \nthe hills to the north and the two converging rivers to the south. The boundary to the \nnorth will be a no -flow boundary and the remaining boundary will be a specified head \nboundary corresponding  to the average stage of the rivers.  \nIt is necessary to assume that the influx to the system is primarily through recharge due \nto rainfall. There are some creek beds in the area which are sometimes dry but \noccasionally fill up due to influx from the groun dwater. These creek beds will be \nrepresented using drains. Two production wells in the area will also be included in the \nmodel.  \nThis tutorial will discuss and demonstrate:  \n\uf0b7 Creating and defining drain arcs.  \n\uf0b7 Creating and defining wells.  \n\uf0b7 Add recharge values . \n\uf0b7 Converting the conceptual model to MODFLOW.  \nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 2  \n \n Page 3 of 13 \u00a9 Aquaveo 2024  \uf0b7 Checking the simulation and running MODFLOW.  \n\uf0b7 Viewing the results.  \n \nRiver  Well #1  \nWell #2  \nRiver  Creek beds  Limestone Outcropping  North  \n \n      Figure 1      Plan view of site to be modeled  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2 Importing the Project  \nThe first step is to import the East Texas project. This will read in the MODFLO W model, \nthe solution, and all other files associated with the model.  \nTo import the project, do as follows:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the modfmap2  directory and sele ct \u201cstart.gpr\u201d.  \n4. Click Open to import the project and close the Open  dialog.  \n5. Select \u201c  Rivers\u201d to make it active.  \nThe Main Graphics Window will appear as in Figure 2. \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 2  \n \n Page 4 of 13 \u00a9 Aquaveo 2024   \n      Figure 2      The imported project  \n3 Saving the Project  \nBefore making any changes, save the project under a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201ceasttex2.gpr\u201d for the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \nIt is recommended to Save   periodically when working on projects, wheth er they are \ntutorials or real projects.  \n4 Delineating the Recharge Zones  \nStart with constructing a coverage that defines the recharge zones. Assume that the \nrecharge over the area being modeled is uniform.  \n4.1 Copying the Boundary  \nTo create the recharge coverage  by copying the boundary coverage:  \n1. Right -click on the \u201c  Boundary\u201d  coverage and select Duplicate  to create a new \n\u201c Copy of Boundary\u201d coverage.  \n2. Right -click on \u201c  Copy of Boundary\u201d  and select Properties\u2026  to bring up the \nCoverage Properties  dialog.  \n3. Enter \u201cRecharge\u201d as the Coverage name  and click OK to close the Coverage \nProperties  dialog.  \n4. Right -click on \u201c  Recharge\u201d  and select Coverage Setup\u2026  to bring up the \nCoverage Setup  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 2  \n \n Page 5 of 13 \u00a9 Aquaveo 2024  Notice that the Coverage name  can be modified in this dialog as well . \n5. In the Areal Properties  column, turn on Recharge rate . \n6. Click OK to close the Coverage Setup  dialog and finish defining the recharge \ncoverage arcs.  \n7. Click Build Polygons   to build the polygon on the \u201cRecharge\u201d coverage.  \n4.2 Assigning the Recharge Values  \nNow t hat the recharge zones are defined, it is possible assign the recharge values. This \nis done by assigning values to the polygon.  \n1. Using the Select Polygons   tool, double -click on the polygon to bring up the \nAttribute Table  dialog.  \n2. Enter \u201c0.0003\u201d as the Recharge rate . \nThis value was obtained by multiplying the annual rainfall by 5% and dividing by 365.  \n3. Click OK to close the Attribute Table  dialog.  \n4.3 Assigning the Recharge Values  \nIt is now possible to convert the conceptual model from the feature object -base d \ndefinition to a grid -based MODFLOW numerical model.  \n1. Right -click on the \u201c  East Texas\u201d conceptual model and select Map To | \nMODFLOW / MODPATH  to bring up the Map \u2192 Model  dialog.  \n2. Select All applicable coverages  and click OK to close the Map \u2192 Model  dialog.   \n3. Turn on \u201c  grid\u201d in the Project Explorer.  \nThe recharge value has now been assigned to the cells in the 3D grid.  \n4.4 Checking the Simulation  \nAt this point, the MODFLOW data is completely defined and now ready to run the \nsimulation. It is advisable to run the Model Checker  to see if GMS can identify any \nmistakes that may have been made.  \n1. Select MODFLOW  | Check Simulation\u2026  to bring up the Model Checker  dialog.  \n2. Click Run Check . There should be no errors.  \n3. Click Done  to exit the Model Checker  dialog.  \n4.5 Saving and Running MODFLOW  \nSave the project before running MODFLOW.  \n1. Save   the project.  \nSaving the project not only saves the MODFLOW files but it saves all data associated \nwith the project including the feature objects and scatter points.  \n2. Select MODFLOW | Run MODFLO W to bring up the MODFLOW  model wrapper \ndialog. The model run should complete quickly.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 2  \n \n Page 6 of 13 \u00a9 Aquaveo 2024  3. When MODFLOW is finished, turn on Read solution on exit  and Turn on contours \n(if not on already).  \n4. Click Close  to close the MODFLOW  model wrapper dialog.  \nContours should appear ( Figure 3). These are contours of the computed recharge \nsolution.  \n \n      Figure 3      The contours are visible after the MODFLOW model run   \n5 Creating the Wells  \nThe next step is to define the two wells. Wells are defined as point type objects.  \n5.1 Creating the Wells Coverage  \nWhile the wells could be added to an existing coverage, the wells  will be created on a \nseparate coverage.  \n1. Right -click on the \u201c  East Texas\u201d conceptual model and select New \nCoverage\u2026  to bring up the Coverage Setup  dialog.  \n2. Enter \u201cWells\u201d for the Coverage name . \n3. In the Sources/Sinks/BCs  column, turn on Wells.  \n4. Click OK to close the Coverage Setup  dialog.  \n5.2 Creating the Wells Points  \nTo create the two points representing the wells and assign flow value to each of them, do \nthe following:  \n1. Right -click on the \u201c  Wells\u201d coverage and select the Attribute Table\u2026  \ncommand to up the  Attribute Table  dialog.  \n2. Be certain that the Feature type  drop-down is set to \u201cPoints \u201d. \n3. Turn on Show coordinates . \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 2  \n \n Page 7 of 13 \u00a9 Aquaveo 2024  4. Under Name , enter \u201cWell 1\u201d then press Tab. \n5. Enter the coordinates \u201c613250\u201d for X, \u201c3428630\u201d for Y, and \u201c213\u201d for Z, pressing \nthe Tab key after each.  \n6. Select \u201cwell\u201d from the drop -down in the Type  column.  \n7. Enter \u201c -50.0\u201d in the Flow rate  column.  \n8. Change the BC type  drop-down menu to \u201cANY/NONE\u201d.  \n9. On the next row down, repeat steps 4\u20137, entering \u201cWell 2\u201d for the Name ,  \n\u201c615494\u201d for X, \u201c342823 2\u201d for Y, \u201c213.0\u201d for Z, and \u201c -300.0\u201d for the Flow Rate .  \n10. Click OK to close the Attribute Table dialog.  \nThe location of the wells should be as seen in Figure 4. \n \n      Figure 4      Location of the wells  \n5.3 Converting the Conceptual Model  \nNow add the wells to the MODFLOW numerical model.  \n1. Right -click on the \u201c  East Texas\u201d conceptual model and select Map To | \nMODFLOW / MODPATH  to bring up the Map \u2192 Model  dialog.  \n2. Select All applicable coverages  and click OK to close the Map \u2192 Model  dialog.  \nThe wells have now been added to the grid.  \n5.4 Checking the Simulation  \nCheck the simulation before running MODFLOW.  \n1. Select MODFLOW  | Check Simulation\u2026  to bring up the Model Checker  dialog.  \n2. Click Run Check . There should be no errors.  \n3. Click Done  to exit the Model Checker  dialog.  \n5.5 Saving and Running MODFLOW  \nSave the project befo re running MODFLOW.  \nWell #1  \nWell #2  \nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 2  \n \n Page 8 of 13 \u00a9 Aquaveo 2024  1. Save   the project.  \n2. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog. The model run should complete quickly.  \n3. When MODFLOW is finished, turn on Read solution on exit  and Turn on contours \n(if not on already).  \n4. Click Close  to close the MODFLOW  model wrapper dialog.  \nContours should appear ( Figure 5). These are contours of the computed head solution.  \n \n      Figure 5      The MODFLOW model run, including the wells  \n6 Defining the Drain Arcs  \nStart with adding arcs at the locations of the creek beds to define the drains. The arcs \ncould be creating using the Create Arc tool. In this case, the drain  arcs will be imported \nfrom a map file and added to the conceptual model. The drain arcs will have their own \nmap coverage which will include a boundary arc and polygon. While the drain arcs could \nbe added to an existing coverage, having the arcs on a separ ate coverage makes it \neasier to define the drains.  \n6.1 Importing the Drain Arcs  \nTo import the drain arcs, do the following:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cMap Files (*.map)\u201d from the Files of type  drop-down.  \n3. Browse to the Tutorials \\MODFLOW \\modfmap2  directory and select \n\u201cDrains.map\u201d.  \n4. Click Open  to import the project file and close the Open  dialog.  \nGMS imports the drain arcs on their own coverage in a separate conceptual model. The \narcs will appear in the Graphics Window as s hown in Figure 6. \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 2  \n \n Page 9 of 13 \u00a9 Aquaveo 2024   \n      Figure 6      Drain arcs  \nThe drain arcs need to be added to the \u201c  East Texas\u201d conceptual model.  \n5. Select the \u201c  Drains\u201d coverage under the \u201c  Drains Arcs\u201d con ceptual model.  \n6. Drag the \u201c  Drains\u201d coverage to be under the \u201c  East Texas\u201d conceptual \nmodel.  \n7. Click Yes on the warning dialog.  \n8. Right -click on the \u201c  Drains Arcs\u201d conceptual model and select Delete . \n6.2 Assigning the Drains  \nNext to define the arcs as drains and assign the conductance and elevation to the arcs.  \n1. Select the \u201c  Drains\u201d coverage to make it active.  \n2. Using the Select Arcs   tool and while holding down the Shift key, select all \nthree drain arcs.  \n3. Right -click on one of the selected arcs and select Attribute  Table\u2026  to bring up \nthe Attribute Table  dialog.  \n4. In the All row, select \u201cdrain\u201d from the drop -down in the Type  column.  \n5. Enter \u201c555.0\u201d in the Cond. (m2/d)/(m) column.  \nConductance is calculated using the following formula:  \nLkAC\uf03d\n \nWhere k is the hydraulic conductivity, A is the gross cross -sectional area, and L is the \nflow length. In this tutorial, assume that the hydraulic conductivity is 12 m/day, the drain \nwidth is 9.25 m, and the flow length is 0.2 m. This will give a conductance of 55 5 \n(m2/day)/(m).  \nThis represents a conductance per unit length value. GMS automatically computes the \nappropriate cell conductance value when the drains are assigned to the grid cells.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 2  \n \n Page 10 of 13 \u00a9 Aquaveo 2024  6. Click OK to close the Attribute Table  dialog.  \nThe color of the drain arcs should change to show they are now recognized as drains by \nGMS.  \nThe elevations of the drains are specified at the nodes of the arcs. The elevation is \nassumed to vary linearly along the arcs between the specified values.  \n7. Using the Select Points/Nodes   tool, double -click on Node 1 as shown in \nFigure 7 to bring up the Attribute Table dialog.  \n8. On the drain  row, enter \u201c221\u201d in the Bot. elev.  column .  \n9. Click OK to close the Attribute Table dialog.  \n10. Repeat steps 7 \u20139 to assign the drain elevations from the list below to the rest of \nthe nodes shown in Figure 7. \nNode 1:  221.0  Node 4: 211.0  \nNode 2: 212.0  Node 5: 221.0  \nNode 3: 220.0  Node 6: 210.0  \n \n      Figure 7      Locations of the drain nodes  \n6.3 Converting the Conceptual Model  \nNow add the arcs to the MODFLOW numerical model.  \n1. Right -click on the \u201c  East Texas\u201d conceptual model and select Map To | \nMODFLOW / MODPATH  to bring up the Map \u2192 Model  dialog.  \n2. Select All applicable coverages  and click OK to close the Map \u2192 Model  dialog. \nThe Graphics Window should appear as in Figure 8. \nNotice that the cells underlying the drains were all identified and assigned the appropriate \nsources/sinks. The heads and elevations of the cells were determined by linearly \ninterpolating along the general head and drain arcs. The conductances of the drain cells \nwere determined by computing the length of the drain arc overlapped by each cell and \nmultiplying that length by the conductance value  assigned to the arc.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 2  \n \n Page 11 of 13 \u00a9 Aquaveo 2024   \n      Figure 8      After the conceptual model is converted to MODFLOW  \n6.4 Checking the Simulation  \nCheck the simulation before running MODFLOW.  \n1. Select MODFLOW  | Check Simulation\u2026  to bring up the Model Checker  dialog.  \n2. Click Run Check . There should be no errors.  \n3. Click Done  to exit the Model Checker  dialog.  \n6.5 Saving and Running MODFLOW  \nSave the project before running MODFLOW.  \n1. Save   the project.  \n2. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog. The model run should complete quickly.  \n3. When MODFLOW is finished, turn on Read solution on exit  and Turn on contours \n(if not on already).  \n4. Click Close  to close the MODFLOW  model wrapper dialog.  \nContours should appear ( Figure 9). These are contours of the computed head solution.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 2  \n \n Page 12 of 13 \u00a9 Aquaveo 2024   \n      Figure 9      The MODFLOW model run including drains  \n7 Viewing the Solutions  \n7.1 Viewing the Water Table in Side View  \nAnother interesting way to view a solution is in side view.  \n1. Turn off \u201c  Grid Frame\u201d in the Project Explorer . \n2. Select \u201c  MODFLOW\u201d in the Project Explorer to switch to the 3D Grid module.  \n3. Using the Select Cell   tool, select a cell somewhere near the well on the right \nside of the model.  \n4. Switch to Side View  . \n5. Click Frame Image  . \nNotice that the computed head values are used to plot a water table profile.  \n6. Use the arrow buttons  in the main toolbar to move back and forth through the \ngrid. A cone of depression should be seen at the well.  \n7. When finished, switch to Plan View  . \n7.2 Viewing the Flow Budget  \nThe MODFLOW solution consists of both a head file and a cell -by-cell flow (CCF) file. \nGMS can use the CCF file to dis play flow budget values. To know if any water exited \nfrom the drains, simply click on a drain arc.  \n1. Select the \u201c  Map Data\u201d folder in the Project Explorer . \n2. Using the Select Arcs  tool, select the rightmost drain arc.  \nNotice that the total flow through the arc is displayed in the strip at the bottom left of the \nwindow. Next, view the flow to the river.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 2  \n \n Page 13 of 13 \u00a9 Aquaveo 2024  3. Click on one of the specified head arcs at the bottom and view the flow.  \n4. Hold down the Shift key and select all of the specified head arcs.  \nNotice that the to tal flow is shown for all selected arcs. Flow for a set of selected cells can \nbe displayed as follows:  \n5. Select the \u201c  3D Grid Data\u201d folder in the Project Explorer.  \n6. Select a group of cells by dragging a box around the cells.  \n7. Select MODFLOW  | Flow Budget...  to bring up the Flow Budget  dialog.  \nThe Flow Budget  dialog shows a comprehensive flow budget for the selected cells.  \n8. Click OK to exit the Flow Budget  dialog.  \n9. Click anywhere outside the model to unselect the cells.  \n8 Conclusion  \nThis concludes the \u201c MODFLOW  \u2013 Conceptual Model Approach 2\u201d  tutorial. Here are the \nKey concepts from this tutorial:  \n\uf0b7 Feature arcs can be used to define drains in the conceptual model.  \n\uf0b7 Feature points can be used to define wells in the conceptual model.  \n\uf0b7 Feature polygons can be used to d efine recharge areas in the conceptual model.  \n\uf0b7 It is possible to customize the set of properties associated with points, arcs and \npolygons by using the Coverage Setup  dialog.  \n\uf0b7 It is necessary to use the Map \u2192 MODFLOW / MODPATH  command every time \nthat concept ual model data is transferred to the grid.  \n \n \n\n", "filename": "MODFLOW-ConceptualModelApproach2.pdf", "pages": 13}, "MODFLOW-ConceptualModelApproach3": {"text": "GMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 3  \n Page 1 of 13 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Conceptual Model Approach 3  \nBuild a multi -layer MODFLOW model using advanced conceptual model techniques  \n \nObjectives   \nThe conceptual model approach involves using the GIS tools in the Map module to develop a conceptual \nmodel of the site being modeled. The location of sources/sinks, layer parameters such as hydraulic \nconductivity, model boundaries, and all other data necessary for the simulation can be defined at the \nconceptual model level without a g rid. \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach 1 and 2  \n\uf0b7 MODFLOW \u2013 Interpolating \nLayer Data  \n \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 Geostatistics  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 35\u201350 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 3  \n Page 2 of 13 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  3 \n2 Importing the Project  ................................ ................................ ................................ ...........  4 \n3 Saving the Project  ................................ ................................ ................................ ...............  4 \n4 Creating the Grid  ................................ ................................ ................................ .................  4 \n5 Initializing the MODFLOW Data  ................................ ................................ ..........................  5 \n6 Defining the Active/Inactive Zones  ................................ ................................ ....................  5 \n7 Redefining the Hydraulic Conductivity  ................................ ................................ ..............  6 \n7.1 Creating the Layer 2 Coverage  ................................ ................................ .....................  7 \n8 Interpolating Layer Elevations  ................................ ................................ ...........................  7 \n8.1 Interpolating the Surface Elevations  ................................ ................................ .............  7 \n8.2 Interpolating the Layer Elevations  ................................ ................................ .................  8 \n8.3 Interpolating the Layer Elevations  ................................ ................................ .................  8 \n8.4 Interpolating the Layer Elevations  ................................ ................................ .................  8 \n9 Converting the Conceptual Model ................................ ................................ ......................  9 \n10 Checking and Saving the Simulation  ................................ ................................ ...............  10 \n11 Running MODFLOW  ................................ ................................ ................................ ..........  10 \n12 Viewing the Water Table in Side View  ................................ ................................ ..............  11 \n13 Fixing the Well  ................................ ................................ ................................ ...................  12 \n14 Conclusion  ................................ ................................ ................................ .........................  13 \n \n1 Introduction  \nThis tutorial builds on the \u201c MODFLOW \u2013 Conceptual Model Approach 1\u201d and \n\u201cMODFLOW \u2013 Conceptual Model Approach 2\u201d tutorials. In those tutorials, a one -layer \nmodel using the conceptual model approach was built. The top and bottom elevations \nwere all the same, meaning the model was completely flat.  \nThis tutorial takes that model and makes it more complex and realistic. It is modified to \nhave two layers and varying top and bottom elevations that match the te rrain and \ngeology. One of the wells will be assigned to layer 2.  \nThe problem solved in this tutorial is a site in East Texas as illustrated in Figure 1. This \ntutoria l evaluates the suitability of a proposed landfill site with respect to potential \ngroundwater contamination. The results of this simulation are used as the flow field for a \nparticle tracking and a transport simulation in the MODPATH and MT3DMS tutorials.  \nThe simulation models the groundwater flow in the valley sediments bounded by the hills \nto the north and the two converging rivers to the south. A typical north -south cross \nsection through the site is shown in Figure 1b. The site is underlain by limestone bedrock \nwhich outcrops to the hills at the north end of the site. There are two primary sediment \nlayers: an upper layer modeled as an unconfined, and the lower layer mo deled as \nconfined.  \nThe boundary to the north is a no -flow boundary, and the remaining boundary is a \nspecified head boundary corresponding to the average stage of the rivers. The system is \nprimarily recharged through rainfall. Creek beds in the area are usu ally dry but \noccasionally flow due to influx from the groundwater. The tutorial model represents these \ncreek beds using drains. Two production wells in the area are included in the model.  \nAlthough the site modeled in this tutorial is an actual site, the la ndfill and the \nhydrogeologic conditions at the site have been fabricated. The stresses and boundary \nconditions used in the simulation were selected to provide a simple \u2014yet broad \u2014\nsampling of the options available for defining a conceptual model.  \nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 3  \n \n Page 3 of 13 \u00a9 Aquaveo 2024  \nRiver\nLimestone BedrockRiver\n(b)Well #1\nWell #2Proposed\nLandfill\nSite\nRiverCreek bedsLimestone OutcroppingNorth\n(a)\nUpper Sediments\nLower Sediments \n      Figure 1      Site to be modeled in this tutorial. (a) Plan view of site. (b) Typical north -south \ncross section through site  \nThis tutorial will discuss and demonstrate:  \n\uf0b7 Creating a two layer grid from the conc eptual model.  \n\uf0b7 Interpolating scatter points to MODFLOW layer data.  \n\uf0b7 Mapping the conceptual model to MODFLOW.  \n\uf0b7 Adjusting the well depth.  \n\uf0b7 Checking the simulation and running MODFLOW.  \n\uf0b7 Viewing the results.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 3  \n \n Page 4 of 13 \u00a9 Aquaveo 2024  2 Importing the Project  \nThe first step is to import the East Texas project. This opens the MODFLOW model, the \nsolution, and all other files associated with the model.  \nTo import the project, do as follows:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the modfmap3  directory and select \u201cstart.gpr \u201d. \n4. Click Open to import the project and close the Open  dialog.  \nThe Main Graphics Window will appear as in Figure 2. \n \n      Figure 2      After importing the project  \n3 Saving the Project  \nBefore making any changes, save the project under a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cEastTexa s3.gpr\u201d as the File name . \n4. Click Save  to save the file under the new name and close the Save As  dialog.  \nBe sure to periodically Save   throughout the tutorial.  \n4 Creating the Grid  \nStart with creating a new two layer grid.  \n1. Select Feature Objects  | Map \u2192 3D Grid to get the first of two warning \nmessages.  \n2. Click OK at the warning dialog to delete the existing grid.  \n3. Click OK to delete the existing MODFLOW simulation and to open the Create \nFinite Difference Grid  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 3  \n \n Page 5 of 13 \u00a9 Aquaveo 2024  Notice that the grid is dimensioned using th e data from the grid frame. If a grid frame \ndoes not exist, the grid is defaulted to surround the model with approximately 5% overlap \non the sides.  \n4. Under the X-Dimension  and Y-Dimension  sections, select Cell Size  and enter \n\u201c20.0\u201d.  \n5. In the Z-Dimension  section, select Number cells  and enter \u201c2\u201d in the field to the \nright.  \n6. Click OK to close the Create Finite Difference Grid  dialog.  \nThe new grid will appear in the Graphics Window ( Figure 3). \n \n      Figure 3      The two layer grid  \n5 Initializing the MODFLOW Data  \nNow that the grid is constructed, the next step is to convert the conceptual model to a \ngrid-based numerical model. Before doing this, the MODFLOW data must first be \ninitialized:  \n1. Right -click on the \u201c  grid\u201d in the Project Explorer and select New MODFLOW\u2026  \nto bring up the MODFLOW Global/Basic Package  dialog.  \n2. Click OK to accept the defaults and close the MODFLOW Global/Basic Pack age \ndialog.  \n6 Defining the Active/Inactive Zones  \nNow that the grid has been created and MODFLOW has been initialized, the next step is \nto define the active and inactive zones of the model. This is accomplished automatically \nusing the information in the map c overage. However, the existing map coverages are set \nup for a one layer grid. They will need to be modified to apply to both layers of the grid.  \n1. Select the \u201c  Rivers\u201d coverage to make it active.  \n2. Right -click on \u201c  Rivers\u201d and select Coverage Setup\u2026  to open the Coverage \nSetup  dialog.  \n3. Turn on Layer Range  under the Source/Sinks/BCs  section.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 3  \n \n Page 6 of 13 \u00a9 Aquaveo 2024  4. Click OK to close the Coverage Setup dialog.  \nTurning on the Layer Range  option overwrites the Default Layer Range  and allows each \nfeature object in the coverage to be assign ed to its own layer range. New objects created \non the coverage after this option is active will automatically use the full layer range. \nExisting objects will need to be modified.  \n5. Using the Select Polygons   tool, select the polygon.  \n6. Click Properties   macro to bring up the Attribute Table  dialog.  \n7. Scroll to the far right in the table and confirm that the layer assignment for the \nFrom layer is \u201c1\u201d and the To layer is \u201c2\u201d.  \n8. Click OK to close the Attribute Table  dialog.  \nOther coverages and feature objects  do not need to be adjusted at this time.  \n9. Click anywhere outside the polygon to unselect it.  \n10. Select Feature Objects | Activate Cells in Coverage(s) . \nThe Graphics Window should appear similar to Figure 4. \n \n      Figure 4      Only the active zones are highlighted  \nEach of the cells in the interior of any polygon in the local sources/sinks coverage is \ndesignated as active and each  cell which is outside of all of the polygons is designated as \ninactive. Notice that the cells on the boundary are activated such that the no -flow \nboundary at the top of the model approximately coincides with the outer cell edges of the \ncells on the perime ter while the specified head boundaries approximately coincide with \nthe cell centers of the perimeter cells.  \n7 Redefining the Hydraulic Conductivity  \nThe \u201cMODFLOW \u2013 Conceptual Model Approach 2\u201d tutorial simulated a one-layer model. \nThis tutorial simulates a two-layer model, making it necessary to define the hydraulic \nconductivity for the second layer. Similar to in the previous tutorial, the second layer uses \nconstant values.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 3  \n \n Page 7 of 13 \u00a9 Aquaveo 2024  7.1 Creating the Layer 2 Coverage  \nTo facilitate the two -layer model simulation, create t he \u201cAquifer Layer 2\u201d coverage by \ncopying the \u201cAquifer Layer 1\u201d coverage.  \n1. Right -click on \u201c Aquifer Layer 1 \u201d and select Duplicate \u2026 to create a new \u201c  \nCopy of Aquifer Layer 1\u201d coverage . \n2. Right -click on \u201c  Copy of Aquifer Layer 1\u201d and select Coverage Setup \u2026 to \nbring up the Coverage Setup  dialog .  \n3. Enter  \u201cAquifer Layer 2 \u201d as the Coverage name . \n4. Below the three columns, set the Default layer range  to go from \u201c2\u201d to \u201c2\u201d. \n5. Click  OK to close the Coverage Setup  dialog.  \n6. Right -click on \u201c  Aquifer Layer 2\u201d and select Attribute Table\u2026  to bring up the \nAttribute Table  dialog.  \n7. Select \u201cPolygons\u201d from the Feature type  drop-down.  \n8. In the spreadsheet, enter \u201c10.0\u201d in the Horizontal K (m/d)  column.  \n9. Click OK to close the Attribute Table  dialog.  \n8 Interpolating Layer Elevations  \nNow it is necessary to define the layer elevations. Since this tutorial uses the LPF \npackage, top and bottom elevations are defined for each layer regardless of the layer \ntype. For a two layer model, it is necessary to define a layer elevation array for the to p of \nlayer 1 (the ground surface), the bottom of layer 1, and the bottom of layer 2. It is \nassumed that the top of layer 2 is equal to the bottom of layer 1.  \nOne way to define layer elevations is to import a set of scatter points defining the \nelevations an d interpolate the elevations directly to the layer arrays. This can be done \nwith scatter points as well as the rasters. In this case, use a raster for the top of the grid \nand scatter points for the elevations of the bottom of layer 1 and the bottom of laye r 2. \nLayer interpolation is covered in depth in the \u201cMODFLOW \u2013 Interpolating Layer Data \u201d \ntutorial.  \n8.1 Interpolating the Surface Elevations  \nTo interpolate the ground surface elevations to the MODFLOW grid, do the following:  \n1. In the Project Explorer, expand the \u201c GIS Layers\u201d folder.  \n2. Right -click on the \u201c  elev_10.tif\u201d  raster and select Interpolate To | MODFLOW \nLayers\u2026  to bring up the Interpolate to MODFLOW Layers  dialog.  \nThis dialog tells GMS which datasets to interpolate to which MODFLOW arrays. The \ndialog is ex plained fully in the \u201cMODFLOW \u2013 Interpolating Layer Data\u201d tutorial.  \n3. Select \u201celev_10.tif\u201d in the Rasters section and \u201cTop Elevations Layer 1\u201d in the \nMODFLOW data section.  \n4. Click Map to add them to the Dataset \u2192 MODFLOW data  section.  \n5. Click OK to perform the i nterpolations and close the Interpolate to MODFLOW \nLayers  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 3  \n \n Page 8 of 13 \u00a9 Aquaveo 2024  8.2 Interpolating the Layer Elevations  \nTo interpolate the layer elevations for the bottom of layers 1 and 2, do the following:  \n1. In the Project Explorer, expand the \u201c  2D Scatter Data\u201d folder.  \n2. Right-click on the \u201c  elevs\u201d scatter set and select Interpolate To | MODFLOW \nLayers\u2026  to bring up the Interpolate to MODFLOW Layers  dialog.  \nNotice that GMS automatically mapped the Bottom Elevations Layer 1  and Bottom \nElevations Layer 2 arrays to the appropriate datasets based on the dataset name. No \nadditional mappings need to be performed here.  \n3. Click OK to perform the interpolations and close the Interpolate to MODFLOW \nLayers  dialog.  \nNow that the interpolation is finished, hide the scatter point sets , GIS layers, and the grid \nframe.  \n4. Turn off the \u201c  Grid Frame\u201d, the \u201c  GIS Layers\u201d folder, and the \u201c  2D Scatter \nData\u201d folder.  \n8.3 Interpolating the Layer Elevations  \nTo check the interpolation, view a cross section.  \n1. Select the \u201c  3D Grid Data \u201d folder in the Project Explorer . \n2. Using the Select Cell   tool, select a cell somewhere near the center of the \nmodel.  \n3. Switch to Side View  . \n4. Use the arrows in the Mini-grid Toolbar  to view different columns in the grid.  \nNote that on the right side of the cross section, the bottom layer pinches out and the \nbottom elevations are greater than the top elevations ( Figure 5). This must be fixed \nbefore running the model.  \n \n      Figure 5      Cross section before elevations are corrected  \n8.4 Interpolating the Layer Elevations  \nGMS provides a convenient set of tools for fixing layer array problems. These tools are \nlocated in the Model Checker  and are explained fully in th e \u201cMODFLOW \u2013 Interpolating \nLayer Data \u201d tutorial.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 3  \n \n Page 9 of 13 \u00a9 Aquaveo 2024  1. Select MODFLOW | Check Simulation \u2026 to bring up the Model Checker  dialog . \n2. Click  Run Check  to check the model for errors.  \nNotice that many errors were found for layer 2. There are several ways to fix these er rors. \nThis tutorial will use the Truncate to bedrock  option. This option makes all cells below the \nbottom layer inactive.  \n3. Click  Fix Layer Errors\u2026  to bring up the Fix Layer Errors  dialog.  \n4. In the Correction method  section, select Truncate to bedrock  and click Fix \nAffected Layers . \n5. Click  OK to exit the Fix Layer Errors  dialog.  \n6. Click  Run Check  to check the model for errors.  \nNotice that all the errors have been fixed. The various warnings are acceptable for the \npurposes of this tutorial and can be ignore d. \n7. Click  Done  to exit t he Model Checker dialog.  \nAnother way to view the layer corrections is in plan view.  \n8. Switch to Plan View  . \n9. In the Mini-grid Toolbar  , click  the up arrow   to view the \nsecond layer.  \nNotice that the cells at the northern edge of the m odel in layer 2 are inactive ( Figure 6). \n10. Switch back to the top layer by clicking the down arro w . \n \n      Figure 6      Inactive cells in layer 2  \n9 Converting the Conceptual Model  \nIt is now possible to convert the conceptual model from the feature object -based \ndefinition to a grid -based MODFLOW numerical model.  \n1. Right -click on the \u201c  East Texas\u201d conceptual model and sele ct Map To | \nMODFLOW / MODPATH  to bring up the Map \u2192 Model dialog.  \n2. Select All applicable coverages  and click OK to close the Map \u2192 Model dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 3  \n \n Page 10 of 13 \u00a9 Aquaveo 2024  Notice that the cells underlying the drains, wells, and specified head boundaries were all \nidentified and assig ned the appropriate sources/sinks ( Figure 7). The heads and \nelevations of the cells were determined by linearly interpolating along the specified head \nand drain arcs. The conductances of the drain cells were determined by computing the \nlength of the drain arc overlapped by each cell and multiplying that length by the \nconductance value assigned to the arc. In addition, the recharge and hydraulic \nconductiv ity values were assigned to the appropriate cells.  \n \n      Figure 7      The model after conversion  \n10 Checking and Saving the Simulation  \nAt this point, the MODFLOW data has been completely defined, and it is possible to run \nthe simul ation. First run the Model Checker again to see if GMS can identify any mistakes \nthat may have been made.  \n1. Select the \u201c  3D Grid Data\u201d folder in the Project Explorer to switch to the 3D \nGrid module.  \n2. Select MODFLOW  | Check Simulation\u2026  to bring up the Model Checker  dialog.  \n3. Click Run Check . There should be no errors.  \n4. Click Done  to exit the Model Checker dialog.  \n5. Save   the project.  \nSaving the project not only saves the MODFLOW files but it saves all data associated \nwith the project including the feature objects  and scatter points.  \n11 Running MODFLOW  \nIt is now possible to run MODFLOW.  \n1. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog. The process should be completed quickly.  \n2. When the solution is completed, turn on Read solution on exit  and Turn on \ncontours (if not on already)  and click Close  to exit the MODFLOW  model \nwrapper dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 3  \n \n Page 11 of 13 \u00a9 Aquaveo 2024  The Graphics Window should appear similar to Figure 8. To view the contours for the \nsecond layer, do as follows:  \n3. Click the up arrow  in the Ortho Grid  Toolbar . \n4. After viewing the contours, return to the top layer by clicking the down arrow.  \n \n      Figure 8      Contours of layer 1 after the model run  \nNotice the flooded cells (indicated by the small blue symbols) along parts of the river \nboundaries. These areas are flooded at generally less than one foot and show how the \nwater table is very near the surface in those areas.  \n12 Viewing the Water Table in Side View  \nAn interesting way to view a solution is in side view.  \n1. Using the Select Cell   tool, select a cell somewhere near the well on the right \nside of the model.  \n2. Switch to Side View  . \nNotice that the computed head values are used to plot a water table profile.  \n3. Use the arrow buttons  in the Mini-grid Toolbar  to move back and forth through \nthe grid.  \nNotice the well does not extend into the second layer as shown in Figure 9. This will need \nto be fixed.  \n \n      Figure 9      Side view of the model  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 3  \n \n Page 12 of 13 \u00a9 Aquaveo 2024  13 Fixing the Well  \nThe well on the right side currently only extends to the bottom of the first layer. To fix this, \ndo the following:  \n1. Switch to Plan View  . \n2. Select \u201c  Wells\u201d to make it active.  \n3. Right -click on \u201c  Wells\u201d and select Coverage Setup\u2026  to open the Coverage \nSetup  dialog.  \n4. Turn on Layer Range  under the Source/Sinks/BCs  section.  \n5. Click OK to close the Coverage Setup dialog.  \n6. Using the Select Points/Nodes   tool, double -click on the well on the right side \nto bring up the Attribute Table  dialog.  \n7. Scroll to the far right in the table and confirm that the layer assignment for the \nFrom layer is \u201c1\u201d and the To layer is \u201c2\u201d.  \n8. Click OK to close the Attribute Table  dialog.  \nModifying the number of layers included in a well does not changes the well flow to be \npartitioned. Well flow is not split between layers, but written to each layer individually.  \nNext, add the changes to the simulation.  \n9. Right -click on the \u201c  East Texas\u201d conceptual model and select Map To | \nMODFLOW / MODPATH  to bring up the Map \u2192 Model dialog.  \n10. Select All applicable coverages  and click OK to close the Map \u2192 Model dialog.  \nWith the changes to the well applied to the simulation, run MODFLOW again.  \n11. Click Save  . \n12. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog. The process should be completed quickly.  \n13. When the solution is completed, turn on Read solution on exi t and Turn on \ncontours (if not on already)  and click Close  to exit the MODFLOW  model \nwrapper dialog.  \nThe results of these changes can be reviewed by doing the following:  \n14. Select the \u201c  3D Grid Data\u201d folder in the Project Explorer.  \n15. Using the Select Cell   tool, select a cell somewhere near the well on the right \nside of the model.  \n16. Switch to Side View  . \nThe well now extends to the second layer creating a cone of depression ( Figure 10). \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 3  \n \n Page 13 of 13 \u00a9 Aquaveo 2024   \n      Figure 10      Side view of the model with well depression visible  \n14 Conclusion  \nThis concludes the \u201c MODFLOW  \u2013 Conceptual Model Approach 3\u201d  tutorial. The following \ntopics were discussed and demonstrated:  \n\uf0b7 Creating a 3D grid with multiple layers.  \n\uf0b7 Elevations for boundary conditions, such as drains, can be specified using a \nraster.  \n\uf0b7 It is possible to specify things like layer elevations and hydrau lic conductivities \nusing polygons in the conceptual model, but that will result in stair -step-like \nchanges. For smoother transitions, it is possible to use 2D scatter points and \ninterpolation.  \n \n \n\n", "filename": "MODFLOW-ConceptualModelApproach3.pdf", "pages": 13}, "MODFLOW-ConceptualModelApproach4": {"text": "GMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 4  \n Page 1 of 10 \u00a9 Aquaveo 2025   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Conceptual Model Approach 4  \nAn introduction to GMS  \n \nObjectives   \nThe conceptual model approach involves using the GIS tools in the Map module to develop a conceptual \nmodel of the site being modeled. The location of sources/sinks, layer parameters such as hydraulic \nconductivity, model boundaries, and all other data necessary for the simulation can be defined at the \nconceptual model level without a grid.  \n \nPrerequisite Tutorials  \n\u2022 MODFLOW \u2013 Conceptual \nModel Approach 1  \n\u2022 MODFLOW \u2013 Conceptual \nModel Approach 3  \n Required Components  \n\u2022 GMS Core  \n\u2022 Geostatistics  \n\u2022 MODFLOW Interface  \n Time  \n\u2022 15\u201325 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 4  \n Page 2 of 10 \u00a9 Aquaveo 2025  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  3 \n2 Importing the Project  ................................ ................................ ................................ ...........  4 \n3 Saving the Project  ................................ ................................ ................................ ...............  4 \n4 Redefining the Recharge  ................................ ................................ ................................ .... 4 \n4.1 Creating the Landfill Boundary Polygon  ................................ ................................ ........  5 \n4.2 Assigning the Recharge Values  ................................ ................................ ....................  6 \n5 Redefining the Hydraulic Conductivity  ................................ ................................ ..............  6 \n5.1 Turning on Vertical Anisotropy  ................................ ................................ ......................  6 \n5.2 Specifying the Horizontal K  ................................ ................................ ...........................  6 \n6 Modifying the Wells and Drains Coverages  ................................ ................................ ...... 7 \n6.1 Turn on MNW2  ................................ ................................ ................................ .............  7 \n6.2 Modifying the Existing Well  ................................ ................................ ...........................  7 \n6.3 Assigning the Drain Elevation  ................................ ................................ .......................  8 \n7 Converting the Conceptual Model ................................ ................................ ......................  8 \n8 Checking and Saving the Simulation  ................................ ................................ .................  8 \n9 Running MODFLOW  ................................ ................................ ................................ ............  9 \n10 Viewing the Flow Budget  ................................ ................................ ................................ .... 9 \n11 Conclusion  ................................ ................................ ................................ .........................  10 \n \n1 Introduction  \nThis tutorial builds on the \u201c MODFL OW \u2013 Conceptual Model Approach 3\u201d tutorial. In that \ntutorial, a one -layer grid was expanded to include multiple layers, and elevations were \ninterpolated to the grid layers.  \nThis tutorial starts with the same model and makes it more complex and realistic. One of \nthe wells will be switched to use the MNW2 package with a well screen that partially \npenetrates both layers. An imported shapefile will be used to define multiple recharge \npolygons to simulate a landfill.  \nThe problem being solved in this tutorial is a site in East Texas as illustrated in Figure 1. \nThis tutorial evaluates the suitability of a proposed landfill site with respect to potential \ngroundwater contamination. The results of this simulation are used as the flow field for a \nparticle tracking and a transport simulation in the MODPATH and MT3DMS tutorials.  \nThe tutorial models the groundwater flow in the valley sediments bounded by the hills to \nthe north and the two converging rivers to the south. A typical north -south cross section \nthrough the site is shown in Figure 1b. The site is underlain by limestone bedrock which \noutcrops to the hills at the north end of the site. There are two primary sediment layers: \nan upper layer modeled as unconfined, and a lower layer modeled as confined.  \nThe boundary to the north is a no -flow boundary, and the remaining boundary is a \nspecified head boundary corresponding to the average stage of the rivers. The influx into \nthe system is primarily through recharge due to rainfall. Creek beds in the area are \nsometimes dry, but occasionally flow due to influx from the groundwater. The tutorial \nrepresents these creek beds using drains. Two production wells in the area are included \nin the model.  \nAlthough the site modeled in this tutorial is an actual site, the landfill and the \nhydrogeological  conditions at the site have been fabricated. The stresses and boundary \nconditions used in the simulation were selected to provide a simple \u2014yet broad \u2014\nsampling of the options available for defining a conceptual model.  \nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 4  \n \n Page 3 of 10 \u00a9 Aquaveo 2025  \nRiver\nLimestone BedrockRiver\n(b)Well #1\nWell #2Proposed\nLandfill\nSite\nRiverCreek bedsLimestone OutcroppingNorth\n(a)\nUpper Sediments\nLower Sediments \n      Figure 1      Site to be modeled in this tutorial. (a) Plan view of site. (b) Typical north -south \ncross section through site  \nThis tutorial discusses and demonstrates:  \n\u2022 Defining a recharge polygon by importing a shapefile and converting it to feature \nobjects.  \n\u2022 Defining well screens in the conceptual model.  \n\u2022 Assigning drain elevations using a raster.  \n\u2022 Mapping the conceptual model to MODFLOW.  \n\u2022 Checking the simulation and running MODFLOW.  \n\u2022 Viewing the results.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 4  \n \n Page 4 of 10 \u00a9 Aquaveo 2025  2 Importing the Project  \nThe first step is to import the East Texas project. This will read in the MODFLOW model, \nthe solution, and all other files associated with the model.  \nTo import the project, do as follows:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the modfmap4  directory and select \u201cstart.gpr\u201d.  \n4. Click Open to import the project and close the Open  dialog.  \nThe Main Graphics Window will appear as in Figure 2. \n \n      Figure 2      After importing the project  \n3 Saving the Project  \nBefore making any changes, save the project under a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr )\u201d from the Save as type  drop-down.  \n3. Enter \u201cEastTexas4.gpr\u201d as the File name . \n4. Click Save  to save the file under the new name and close the Save As  dialog.  \nBe sure to Save   periodically throughout the tutorial.  \n4 Redefining the Recharge  \nAssume the recharge over the area being modeled is uniform except for at the landfill. \nThe recharge in the area of the landfill will be reduced due to the landfill liner system.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 4  \n \n Page 5 of 10 \u00a9 Aquaveo 2025  4.1 Creating the Landfill Boundary Polygon  \nThe first step is to create the arc delineating the boundary of the landfill. For this tutorial, \nimport the boundary from an existing landfill shapefile.  \n1. Select the \u201c  GIS Layers \u201d folder  in the Project Explorer  to make it active.  \n2. Select GIS | Add Shapefile Data \u2026 to bring up the Select shapefile  dialog.  \n3. Select \u201cShapefile (*.shp)\u201d from the Files of type  drop-down.  \n4. Select \u201c landfill_arcs.shp \u201d and click Open  to import the shapefile and close the \nSelect shapefile  dialog . \nNow that the shapefile is imported, convert it into feature objects in the \u201c  Recharge \u201d \ncoverage.  \n5. Expand the \u201c  Map Data\u201d folder, including the \u201c  East Texas\u201d conceptual \nmodel within it.  \n6. Select the \u201c  Recharge \u201d coverage to make it active . \n7. Select \u201c  landfill_arcs.shp \u201d under \u201c  GIS Layers\u201d in the Project Explorer . \n8. Select GIS | Shapes  \u2192 Feature Objects . The Step 1 of 3  page of the GIS to \nFeature Objects Wizard  dialog will appear.  \n9. Click Next  to go to the Step 2 of 3 page of the GIS to Feature Objects Wizard  \ndialog.  \n10. On the Mapping  row of the Mapping preview  section, select \u201cElevation\u201d from the \ndrop-down in the ARC_ELEV  column.  \n11. Click Next  to go to the Step 3 of 3 page of the GIS to Feature Objects Wizard  \ndialog.  \n12. Click Finish  to close the GIS to Feature Objects Wizard  dialog.  \nThe landfill is now created and visible in the Graphics Window ( Figure 3). With the landfill \nboundary defined, it is necessary to rebuild the polygons.  \n13. Click the Build Polygons   macro.  \n \n      Figure 3      The landfill is outlined as a black square  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 4  \n \n Page 6 of 10 \u00a9 Aquaveo 2025  4.2 Assigning the Recharge Values  \nNow that the recharge zones are redefined, it is possible to assign the recharge values \nfor the landfill polygon.  \n1. Select the \u201c  Recharge\u201d coverage to make it active.  \n2. Using the Select Polygons   tool, double -click on the landfill polygon to bring \nup the Attribute Table dialog.  \n3. Enter \u201c0.00006\u201d as the Recharge rate . \nNote:  This recharge rate is small relative to the rate assigned to the other polygons. The \nlandfill will be capped and lined and thus will have a small recharge value. The recharge \nessentially represents a small amount of leachate that escapes from the landfill.  \n4. Click OK to close the Attribute Table dialog.  \n5 Redefining the Hydraulic Conductivity  \nAs in the \u201cMODFLOW \u2013 Conceptual Model Approach 3\u201d tutorial, a two -layer model will be \nused here. Thus, it is necessary to define the hydraulic conductivity for the second layer \nand the vertical anisotropy for both layers. Constant values will be used for the second \nlayer.  \n5.1 Turning on Vertical Anisotropy  \n1. Right -click on the \u201c  Aquifer Layer 1\u201d  coverage and select Coverage Setup\u2026  \nto bring up the Coverage Setup  dialog.  \n2. In the Areal Properties  column, turn on Vertical anis . \n3. Click OK to close the Coverage Setup  dialog.  \n4. Select \u201c  Aquifer Layer 1\u201d to make it active.  \n5. Double -click on the polygon to bring up the Attribute Table  dialog.  \n6. Enter \u201c4.0\u201d in the Vertical anis.  column.  \nThis makes the vertical hydraulic conductivity one fourth of the horizontal conductivity.  \n7. Click OK to close the Attribute Table  dialog.  \n5.2 Specifying the Horizontal K  \nFor the new layer, do the following:  \n1. Select \u201c  Aquifer Layer 2\u201d in the Project Explorer to make it active.  \n2. Using the Select Polygons   tool, double -click on the polygon to bring up the \nAttribute Table dialog.  \n3. Enter \u201c10.0\u201d for the Horizonal K . \n4. Click OK to close the Attribute Table dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 4  \n \n Page 7 of 10 \u00a9 Aquaveo 2025  6 Modifying the Wells and Drains Coverages  \nSince our model has two layers, it is necessary to specify in which grid layer the wells \nshould be placed when mapping the conceptual model to the grid. There are three ways \nto do this.  \nThe simplest way is to specify the grid layer in the conceptual model, but that requires \nknowing how many grid layers will be in the project and where they will be when building \nthe conceptual model. The conceptual model would also need to be changed  if grid \nlayers were later added or subtracted.  \nThe second way is to use a well screen with the WEL package. This allows for specifying \nthe top and bottom of the screened interval of the well. When the conceptual model is \nmapped to the grid, the well will be placed automatically in the appropriate grid layer (or \nlayers) based on which grid layers intersect the well screen. If multiple grid layers are \nintersected by the well screen, multiple wells will be created.  \nThe third way is to use the MNW2 package and define the screened interval. The MNW2 \npackage is a more realistic well package that better models partially penetrating wells \nand wells that have more than one screened interval and/or draw from multiple grid \nlayers. This tutorial will use this option.  \nThe conceptual model will be modified so it uses real terrain data for elevations. The \nterrain elevations will come from a raster. The raster will also be used to define the drain \nelevations. When the drain arcs are discretized onto the model grid, the cells that \nintersect the arc s will be  found. Then the drain elevation  is interpolated from the raster  to \nthe cell centers.  \nThis method is particularly helpful with large models where the elevation for each drain at \nthe arc nodes would otherwise have to be manually determined and entered.  \n6.1 Turn on MNW2  \nIt is necessary to make the MNW2 properties available in the coverage.  \n1. Right -click the \u201c  Wells\u201d coverage in the Project Explorer and select Coverage \nSetup\u2026  to bring up the Coverage Setup dialog.  \n2. In the Sources/Sinks/BCs  column, turn on Wells (MNW2) . \n3. Click OK to close the Coverage Setup dialog.  \n6.2 Modifying the Existing Well  \nNow edit the eastern well.  \n1. Select the \u201c  Wells\u201d coverage in the Project Explorer to make it active.  \n2. Using the Select Points \\Nodes   tool, select the well on the eastern (right) side \nof the model.  \n3. Click Properties   to bring up the Attribute Table dialog.  \n4. In the table, select \u201cwell (MNW2)\u201d from the drop -down in the Type  column.  \n5. Scroll to the right and enter \u201c -300.0\u201d in the Qdes (m^3/d)  field.  \n6. Select \u201cTHIEM\u201d from the drop -down in the LOSSTYPE  column.  \n7. Check the box in the Vertical Boreline  column.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 4  \n \n Page 8 of 10 \u00a9 Aquaveo 2025  8. Click on the  button in the Boreline  column to bring up the Table  dialog.  \n9. In the row marked with a star *, enter \u201c180.0\u201d in the Z screen begin  column and \n\u201c165.0\u201d in the Z screen end  column .  \nThese values make the well screen go through both layers 1 and 2.  \n10. In the row 1, enter \u201c0.05\u201d in the Rw column.  \n11. Click  OK to exit the Table  dialog.  \n12. Click OK to exit the Attribute Table  dialog.  \n6.3 Assigning the Drain Elevation  \nIt is now possible to assign drain elevation using these data.  \n1. Select \u201c  Drain s\u201d in the Project Explorer  to make it active.  \n2. Click on the Select Points/Nodes   tool, then select Edit | Select All .  \n3. Click Properties   to bring up the Attribute Table  dialog.  \n4. At the top right, select \u201cdrain\u201d from the BC type  drop-down.  \n5. In the All row, select \u201c<Raster>\u201d from the Bot. Elev. (m)   drop-down to bring \nup the Select Raster  dialog.  \n6. Select \u201c elev_10.tif \u201d and click OK to close the Select Raster  dialog.  \n7. Click OK to exit the Attribute Table  dialog.  \n7 Converting the Conceptual Model  \nIt is now possible to convert the conceptual model from the feature object -based \ndefinition to a grid -based MODFLOW numerical model.  \n1. Right -click on the \u201c  East Texas\u201d conceptual model and select Map To | \nMODFLOW / MODPATH  to bring up the Map \u2192 Model dialog.  \n2. Select All applicable coverages  and click OK to close the Map \u2192 Model dialog.  \nThe cells underlying the drains, wells, and general head boundaries were all identified \nand assigned the appropriate sources/sinks. The heads and elevations of the cells were \ndetermined by linearly interpolating along the general head and drain arcs. The \nconductance of the drain cells were determined by computing the length of the drain arc \noverlapped by each cell and multiplying that length by the conductance value assigned to \nthe arc. In addition, the recharge and hydraulic conductivity values were assigned to the \nappropriate cells.  \n8 Checking and Saving the Simulation  \nAt this point, the MODFLOW data has been completely defined, and it is possible to run \nthe simulation. First run the Model Checker again to see if GMS can identify any mistakes \nthat may have been made.  \n1. Select the \u201c  3D Grid Data\u201d folder in the Project Explorer to switch to the 3D \nGrid module.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 4  \n \n Page 9 of 10 \u00a9 Aquaveo 2025  2. Select MODFLOW  | Check Simulation\u2026  to bring up the Model Checker  dialog.  \n3. Click Run Check . There should be no errors.  \n4. Click Done  to exit the Model Checker dialog.  \n5. Click Save  . \nSaving the project not only saves the MODFLOW files but also saves all data associated \nwith the project, including the feature objects and scatter points.  \n9 Running MODFLOW  \nIt is now possible to run MODFLOW.  \n1. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog. The process should be completed quickly.  \n2. When the solution is completed, turn on Read solution on exit  and Turn on \ncontours (if not on already)  and click Close  to exit the MODFLOW  model \nwrapper dialog.  \nThe Graphics Window should appear similar to Figure 4. To view the contours for the \nsecond layer, do as follows:  \n3. Click the up arrow  in the Ortho Grid  Toolbar . \n4. After viewing the contours, return to the top layer by clicking the down arrow.  \n \n      Figure 4      Contours of layer 1 after the model run  \n10 Viewing the Flow Budget  \nThe MODFLOW solution consists of both a head file and a cell -by-cell flow (CCF) file. \nGMS can use the CCF file to display flow budget values. For example, to know if any \nwater exited from the drains, do the following:  \n1. Select \u201c  Drains\u201d to make it active.  \n2. Using the Select Arcs   tool, select on the rightmost drain arc.  \nNotice that the total flow through the arc is displayed in the strip at the bottom of the \nwindow. Next, view the flow to the river.  \n\nGMS Tutorials   MODFLOW \u2013 Conceptual Model Approach 4  \n \n Page 10 of 10 \u00a9 Aquaveo 2025  3. Select \u201c  Rivers\u201d to make it active.  \n4. Using the Select Arcs   tool, select the head arc at the bottom and view the \nflow. \n5. Using the Select Arcs   tool while holding down the Shift key, select the other \ngeneral head arc.  \nNotice that the total flow shown is for all selected arcs. Flow for a set of selected cells can \nbe displayed as follows:  \n6. Select the \u201c  3D Grid Data\u201d folder in the Project Explorer to switch to the 3D \nGrid module.  \n7. Using the Select Cell   tool, select a group of cells by dragging a box around \nthe cells.  \n8. Select MODFLOW  | Flow Budget\u2026  to bring up the Flow Budget dialog.  \nThis dialog shows a comprehensive flow budget for the selected cells.  \n9. Click OK to exit the Flow Budget dialog.  \n10. Click anywhere outside the model to unselect the cells.  \n11 Conclusion   \nThis concludes the \u201c MODFLOW  \u2013 Conceptual Model Approach  4\u201d tutorial. The following \ntopics were discussed and demonstrated:  \n\u2022 It is possible to import shapefiles and convert them to feature objects for use in \nthe conceptual model.  \n\u2022 Well screens can be used to automatically locate the correct 3D grid layer in \nwhich the wells are located.  \n\u2022 The MNW2 package more accurately models wells that are screened across \nmultiple layers.  \n\u2022 Elevations for boundary conditions, such as drains, can be specified using a \nraster.  \n \n\n", "filename": "MODFLOW-ConceptualModelApproach4.pdf", "pages": 10}, "MODFLOW-DRTPackage": {"text": "GMS Tutorials   MODFLOW \u2013 DRT Package  \n Page 1 of 15 \u00a9 Aquaveo 2025   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 DRT Package  \nThe MODFLOW drain return package  \n \nObjectives   \nLearn about the MODFLOW drain return package (DRT) interface in GMS and compare the package to \nthe regular MODFLOW drain (DRN) package.  \n \nPrerequisite Tutorials  \n\u2022 MODFLOW \u2013 Conceptual \nModel Approach I  \n Required Components  \n\u2022 GMS Core  \n\u2022 MODFLOW Interface  \n Time  \n\u2022 25\u201340 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 DRT Package  \n Page 2 of 15 \u00a9 Aquaveo 2025  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  4 \n2.1 Opening the Existing Model  ................................ ................................ ..........................  4 \n2.2 Saving the Model with a New Name  ................................ ................................ .............  4 \n3 Changing from DRN to DRT Boundary Conditions  ................................ ..........................  5 \n3.1 Selecting the Drain Cells  ................................ ................................ ..............................  5 \n3.2 Creating DRT Boundary Conditions  ................................ ................................ ..............  5 \n3.3 Deleting DRN Boundary Conditions  ................................ ................................ ..............  6 \n3.4 Saving and Running MODFLOW  ................................ ................................ ..................  6 \n3.5 Examining the Flow Budget  ................................ ................................ ..........................  6 \n4 Changing the Return -Flow Cell for the DRT Boundary Conditions  ................................ . 7 \n4.1 Saving and Running MODFLOW  ................................ ................................ ..................  7 \n4.2 Examining the Flow Budget  ................................ ................................ ..........................  8 \n5 Creating a Conceptual Model  ................................ ................................ .............................  8 \n5.1 Creating a Coverage  ................................ ................................ ................................ ..... 9 \n5.2 Creating the DRT Arc  ................................ ................................ ................................ ... 9 \n5.3 Creating the DRT Point  ................................ ................................ ...............................  10 \n5.4 Mapping the Conceptual Model to MODFLOW  ................................ ..........................  11 \n5.5 Examining the DRT Package  ................................ ................................ ......................  11 \n5.6 Saving and Running MODFLOW  ................................ ................................ ................  12 \n5.7 Viewing the Computed Flows for the Feature Objects  ................................ ................  13 \n6 Creating a DRT Parameter  ................................ ................................ ................................  13 \n6.1 Saving and Running MODFLOW  ................................ ................................ ................  14 \n7 Conclusion  ................................ ................................ ................................ .........................  15 \n \n1 Introduction  \nIn MODFLOW, drain boundary conditions are used to simulate water leaving the \ngroundwater system. MODFLOW has two standard packages that are used to model \ndrains: the DRN (Drain) package and the DRT (Drain Return) package.  The DRT \npackage can be used to simulate the return flow of water discharged from a drain \nboundary condition to the groundwater system.  \nEach drain boundary condition requires specifying a drain elevation and a drain \nconductance. When the simulated head in a cell is above the drain elevation, water will \nleave the groundwater system proportional to the drain conductance. When the simulated \nhead in a cell is below the drain elevation, no water leaves the system through the drain \nboundary condition.  \nIn addition to specifying a drain elevation and conductance, specify a return -flow cell and \na return -flow factor (0.0 \u20131.0). A portion of the water that would normally leave the \ngroundwater system through the drain is returned to the model at the return -flow cell.       \nFigure  1 illustrates an example of where a DRT boundary condition may be used.  \nThe DRN package has existed since the first MODFLOW release.  The DRT package was \nintroduced with MODFLOW 2000. This tutorial explains how to use the DRT package and \ncompares it to the DRN package. Both packages can be used at the same time if \ndesired.  \nGMS Tutorials   MODFLOW \u2013 DRT Package  \n \n Page 3 of 15 \u00a9 Aquaveo 2025   \n      Figure 1      DRT model, from Banta (2000)1 \nThe problem explored in this tutorial is the same one used in the \u201c MODFLOW \u2013 Grid \nApproach \u201d tutorial, and is shown in Figure 2. This problem is a modified version of the \nsample problem described near the end of the MODFLOW  88 Reference Manual . Refer \nto the \u201c MODFLOW \u2013 Grid Approach \u201d tutorial for a complete description of the problem. In \nbrief, it is a grid -based model (no conceptual model) that has three layers, some wells, \nsome drains, recharge, and constant head cells.  \n \nUnconfined  \nConfined  \nConfined  Const Head = 0 m  \nin column 1 of  \nlayers 1 & 2  Drain  \nLayer 1 : K = 15 m/d, top elev. = 60 m, bot elev. = -45 m \nLayer 2 : K = 0.9 m/d, top elev. = -45 m, bot elev. = -120 m \nLayer 3 : K = 2 m/d, top elev. = -120 m, bot elev. = -215 m Recharge = 0.0009 m/d  \n \n      Figure 2      Sample problem to be solved  \nThis tutorial will discuss and demonstrate importing an existing MODFLOW simulation, \nchanging DRN boundary conditions to DRT boundary conditions, and changing DRT \nboundary conditions to return flow to the model. A simple conceptual model will also be \ncreated to illustrate how DRT can be modeled conceptually and mapped to MODFLOW.  \n \n1 Banta, Edward R. (2000), MODFLOW -2000, The U.S. Geological Survey Modular Ground -Water \nModel \u2014Documentation of Packages for Simulating Evapotranspiration with a Segmented Function \n(ETS1) and Drains with Return Flow (DRT1) . Open -File Report 00 -466, Denver, Colorado, p.32. \nhttp://pubs.usgs.gov/of/2000/0466/report.pdf  . \n\nGMS Tutorials   MODFLOW \u2013 DRT Package  \n \n Page 4 of 15 \u00a9 Aquaveo 2025  2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state. Click Don\u2019t Save  if asked to save changes.  \n2.1 Opening the Existing Model  \nStart with a previously -created MODFLOW model.  \n3. Click Open   to bring up the Open  dialog.  \n4. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n5. Browse to the drt folder and select \u201cmodfgrid.gpr\u201d.  \n6. Click Open to import the project and exit the Open  dialog.  \nA grid with head contours and symbols representing wells, drains and other boundary \nconditions should be visible ( Figure 3). \n \n      Figure 3      The MODFLOW model  \n2.2 Saving the Model with a New Name  \nNow it is possible to start making changes. First, save the model with a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cdrt.gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n\nGMS Tutorials   MODFLOW \u2013 DRT Package  \n \n Page 5 of 15 \u00a9 Aquaveo 2025  3 Changing from DRN to DRT Boundary Conditions  \nNext, delete the DRN boundary conditions and create identical DRT boundary conditions.  \n3.1 Selecting the Drain Cells  \nIt is necessary to select the cells with the drain boundary condition:  \n1. Using the Select Cells   tool while holding down the Shift key, select the cells \nin columns 2 \u201310 of row 8 (highlighted in Figure 4).  \n \n      Figure 4      Location of the drain boundary conditions  \n2. Select MODFLOW | Advanced | Sources/Sinks\u2026  to bring up the MODFLOW \nSources/Sinks  dialog.  \n3.2 Creating DRT Boundary Conditions  \nNext to create new DRT boundary conditions and copy the properties of the existing drain \n(DRN) boundary conditions.  \n1. Select \u201cDrain (DRN)\u201d from the list on the left. This spreadsheet shows the DRN \nboundary conditions.  \n2. Select the top cell (below the All row) in the Elevation (m)  column, and while \nholding down Shift, select the bottom cell in the Conductance (m^2/d)  column.  \nThis should highlight all of the cells in the spreadsheet except for those in the All row. \n3. Right -click on the one of the selected columns and select Copy . \n4. Select \u201cDrain (DRT)\u201d from the list on the left.  \n5. Click Add BC  to create new DRT boundary conditions in each of the selected \ncells.  \n\nGMS Tutorials   MODFLOW \u2013 DRT Package  \n \n Page 6 of 15 \u00a9 Aquaveo 2025  6. Select the top cell (below the All row) in the Elevation (m)  column, then right -click \non the cell and select Paste . \nThe contents from the \u201cDrain (DRN)\u201d cells should be copied to the \u201cDrain (DRT)\u201d cells.  \n3.3 Deleting DRN Boundary Conditions  \nNow it is necessary to delete the drain boundary conditions.  \n1. Select \u201cDrain (DRN)\u201d from the list on the left.  \n2. Click Delete All BCs . \n3. Click OK to exit the MODFLOW Sources/Sinks  dialog.  \n4. Click anywhere outside the grid to unselect the cells.  \nNotice the color of the boundary conditions has changed slightly to be a darker green \n(Figure 5). \n \n      Figure 5      DRN boundary conditions converted to DRT  \n3.4 Saving and Running MODFLOW  \nThe next step is to save these changes and run MODFLOW.  \n1. Save   the project.  \n2. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n3. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and exit the MODFLOW  model wrapper dialog.  \n5. Fully expand the \u201c  3D Grid Data\u201d folder in the Project Explorer.  \n6. Compare the new and old solutions by alternately selecting the \u201c  modfgrid \n(MODFLOW)\u201d and the \u201c  drt (MODFLOW)\u201d  folders.  \nNotice the heads are identical in the new \u201c  drt (MODFLOW)\u201d and the \u201c  modfgrid \n(MODFLOW)\u201d solutions.  \n7. Save   the project with the new solution.  \n3.5 Examining the Flow Budget  \nNow to compare the flow budget information from the two models:  \n1. Select \u201c  modfgrid (MODFLOW)\u201d in the Project Explorer to make it active.  \n2. Select MODFLOW | Flow Budget\u2026  to bring up the Flow Budget  dialog.  \n3. In the Sources/Sinks  section, on the DRAINS  row, notice that the value in the \nFlow Out  column is \u201c -136,771.6992188\u201d and the value in the Flow In column is \n\u201c0.0\u201d.  \n\nGMS Tutorials   MODFLOW \u2013 DRT Package  \n \n Page 7 of 15 \u00a9 Aquaveo 2025  4. Click OK to exit the Flow Budget  dialog.  \n5. Select \u201c  drt (MODFLOW)\u201d to make it active.  \n6. Select MODFLOW | Flow Budget\u2026  to bring up the Flow Budget  dialog.  \n7. In the Sources/Sinks  section, on the DRAINS (DRT)  row, notice that the value in \nthe Flow Out  column is also \u201c -136,771.6992188\u201d and the value in the Flow In  \ncolumn is also \u201c0.0\u201d.  \n8. Click OK to exit the Flow Budget  dialog.  \n4 Changing the Return -Flow Cell for the DRT Boundary Conditions  \nThis tutorial has shown that the DRT package can be used exactly as the DRN package. \nNow to modify the DRT inputs to simulate the return flow from the drains to the \ngroundwater system. First, save the project with a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cdrt1.gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and exit the Save As  dialog.  \n5. Select MODFLOW | Optional Packages | DRT \u2013 Drain Return\u2026  to bring up the \nMODFLOW Drain Return Package  dialog.  \n6. In the spreadsheet, in the Return I  and Return J  columns, enter \u201c15\u201d for each of \nthe DRT boundary condition rows.  \n7. In the Rfprop  column, enter \u201c0.5\u201d for each of the DRT boundary condition rows. \nThis is the return -flow proportion.  \n8. Click OK to exit the MODFLOW Drain Return Package  dialog.  \n4.1 Saving and Running MODFLOW  \nNow to save these changes and run MODFLOW:  \n1. Save   the project.  \n2. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n3. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and exit the MODFLOW  model wrapper dialog.  \nNotice the changes in the new solution ( Figure 6). \n\nGMS Tutorials   MODFLOW \u2013 DRT Package  \n \n Page 8 of 15 \u00a9 Aquaveo 2025   \n      Figure 6      There are visible changes in the contours  \n5. Compare the new and old solutions by alternately selecting the \u201c  drt \n(MODFLOW)\u201d folder and the \u201c  drt1 (MODFLOW)\u201d  folder in the Project \nExplorer.  \nNotice the head is different in the new \u201c  drt1 (MODFLOW)\u201d solution.  \n6. Save   the project with the new solution.  \n4.2 Examining the Flow Budget  \nThe next step is to view the flow budget information from the \u201c drt1\u201d model  \n1. Select the \u201c  drt1 (MODFLOW) \u201d solution in the Project Explorer to make it \nactive.  \n2. Select MODFLOW  | Flow Budget \u2026 to bring up the Flow Budget  dialog.  \n3. On the Cells  tab, in the Sources/Sinks  section, on the DRAINS  (DRT)  row, there \nare now values in both the Flow In  and Flow Out  columns .  \n4. Click OK to exit the Flow Budget  dialog.  \n \n5 Creating a Conceptual Model  \nThe next step is to examine how to use a conceptual model with DRT data. Save the \nmodel with a new name before changing to a conceptual model.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n\nGMS Tutorials   MODFLOW \u2013 DRT Package  \n \n Page 9 of 15 \u00a9 Aquaveo 2025  3. Enter \u201cdrt2.gpr\u201d as the File name  and click Save  to close the Save As  dialog.  \n4. Right -click in empty space in the Project Explorer and select New | Conceptual \nModel\u2026  to bring up the Conceptual Model Properties  dialog.  \n5. Enter \u201cmodfgrid\u201d as the Name . \n6. Click OK to close the Conceptual Model Properties  dialog.  \n5.1 Creating a Coverage  \n1. Right -click on the \u201c  modfgrid\u201d conceptual model and select New Coverage\u2026  \nto bring up the Coverage Setup  dialog.  \n2. Enter \u201cdrt\u201d as the Coverage name . \n3. In the Sources/Sinks/BCs  column, turn on Layer range  and Drain (DRT) . \n4. Click OK to exit the Coverage Setup  dialog.  \n5.2 Creating the DRT Arc  \n1. Select the \u201c  drt\u201d coverage to make it active.  \n2. Using the Create Arc   tool, create an arc for the drains as shown in Figure 7. \nMake sure the left end of the arc does not enter the specified head cell on the left \nside of the model.  \n \n      Figure 7      Creating an arc for the drains  \n3. Using the Select Arcs  tool, double -click on the newly created arc to bring up \nthe Attribute Table  dialog.  \n4. In the spreadsheet, in the Type  column, select \u201cdrain (DRT)\u201d from the drop -down.  \n5. Enter \u201c4.8\u201d in the Cond. (m^2/d)/(m)  column. Leave the other attributes at the \ndefault settings.  \n\nGMS Tutorials   MODFLOW \u2013 DRT Package  \n \n Page 10 of 15 \u00a9 Aquaveo 2025  6. Click OK to exit the Attribute Table  dialog.  \n7. Click anywhere outside the arc to unselect it.  \nNote that the arc changed color and the nodes changed to squares ( Figure 8). \n \n      Figure 8      The arc is now green with green squares as the nodes  \n8. Using the Select Objects   tool, select the right arc node.  \n9. Click Properties   to bring up the Attribute Table  dialog.  \n10. In the spreadsheet, enter \u201c30.0\u201d in the Bot. elev. (m)  column.  \n11. Click OK to exit the Attributes Table  dialog.  \nThe left arc node bottom elevation is defaulted to \u201c0.0\u201d, so it is not necessary to edit its \nvalue.  \n5.3 Creating the DRT Point  \nNow to create a DRT point in the coverage:  \n1. Using the Create Point   tool, create a point in the cell at row 2 column 8 (the \ncell is highlighted in purple in Figure 9). \n \n      Figure 9      New DRT point  \n2. Using the Select Objects   tool, double -click on the new point to bring up the \nAttribute Table  dialog.  \n3. In the spreadsheet, enter \u201cpoint_4\u201d in the Name  column.  \n4. Select \u201cdrain (DRT)\u201d from the drop -down in the Type  column.  \n5. Enter \u201c1000.0\u201d in the Cond. (m^2/d)  column.  \n6. Enter \u201c10.0\u201d in the Bot. elev. (m)  column.  \n7. Enter \u201c0.5\u201d in the Rfprop  column.  \n8. Select \u201cUse layer range\u201d from the drop -down in the Auto assign layer  column.  \n9. Enter \u201c2\u201d in both the From layer  and the To layer  columns.  \nWhen completed, the dialog should appear as in Figure 10. \n10. Click OK to exit the Attribute Table  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 DRT Package  \n \n Page 11 of 15 \u00a9 Aquaveo 2025   \nFigure 10  Attribute Table dialog for the DRT point  \n5.4 Mapping the Conceptual Model to MODFLOW  \nThe conceptual model is now set up so it is possible to map it to the MODFLOW grid.  \n1. Select Feature Objects | Map \u2192 MODFLOW  to bring up the Map \u2192 Model \ndialog.  \n2. Click OK to accept the defaults and close the Map \u2192 Model  dialog.  \n5.5 Examining the DRT Package  \nNow to look at the data in MODFLOW that was mapped from the conceptual model.  \n1. Select MODFLOW | Optional Packages | DRT \u2013 Drain Return\u2026  to bring up the \nMODFLOW Drain Return Package  dialog.  \n2. Review the various DRT boundary conditions that were created.  \n3. Notice that the boundary conditions created from the arc have a return -flow \nproportion (Rfprop) of \u201c0.0\u201d, while the boundary condition created from the point \nhas the return -flow proportion  of \u201c0.5\u201d.  \n4. Notice that the return cell location is defaulted to the same I, J location as the \nboundary condition except that K is set to \u201c1\u201d.  \n5. At the bottom of the dialog, turn on IJK from the Display cell  options. Notice that \nthe last DRT boundary condition is located at IJK \u201c2,8,2\u201d ( Figure 11, highlighted \nat bottom left) and the return KIJ is 1,2,8 ( Figure 11, highlighted at bottom right).  \n6. Click OK to exit the MODFLOW Drain Return Package  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 DRT Package  \n \n Page 12 of 15 \u00a9 Aquaveo 2025   \n      Figure 11      DRT boundary condition and return coordinates  \n5.6 Saving and Running MODFLOW  \nNow to save these changes and run MODFLOW:  \n7. Save   the project.  \n8. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n9. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n10. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.  \nNotice some changes in the new solution ( Figure 12). \n11. Save   the project with the new solution.  \n\nGMS Tutorials   MODFLOW \u2013 DRT Package  \n \n Page 13 of 15 \u00a9 Aquaveo 2025   \n      Figure 12      The new solution with contours  \n5.7 Viewing the Computed Flows for the Feature Objects  \nSince the DRT boundary conditions were created from feature objects in the map \nmodule, it is possible to select the points or arcs that were used to create the boundary \nconditions and view the computed flow out of the model from those boundary conditions.  \n1. Select the \u201c  modfgrid\u201d conceptual model in the Project Explorer to make it \nactive.  \n2. Using the Select Objects   tool, select the DRT arc in the coverage.  \nNotice the information strip at the bottom of the GMS window ( Figure 13). The computed \nflow out of the model from the DRT arc is s hown there. The DRT point can also be \nselected to see similar information.  \n \n      Figure 13      Computed flow from the DRT arc  \n6 Creating a DRT Parameter  \nNow to create a DRT parameter by changing the conductance on the DRT arc to use a \nparameter instead of specifying the conductance value:  \n1. Using the Select Objects   tool, double -click on the DRT arc in the coverage to \nbring up the Attribute Table  dialog.  \n2. In the spreadsheet, enter \u201c -10.0\u201d in the Cond. (m^2/d)/(m)  column.  \n\nGMS Tutorials   MODFLOW \u2013 DRT Package  \n \n Page 14 of 15 \u00a9 Aquaveo 2025  3. Click OK to exit the Attribute Table  dialog.  \n4. Select Feature Objects | Map \u2192 MODFLOW  to bring up the Map \u2192 Model  \ndialog.  \n5. Click OK to accept the defaults and close the Map \u2192 Model  dialog.  \n6. Select MODFLOW | Parameters\u2026  to bring up the Parameters  dialog.  \n7. Click Initialize From Model .  \nNotice that a new parameter has been created.  \n8. In the spreadsheet, enter \u201c4.8\u201d in the Value  column.  \n9. Click OK to exit the Parameters  dialog.  \n10. Select MODFLOW | Optional Packages | DRT \u2013 Drain Return\u2026  to bring up the \nMODFLOW Drain Return Package  dialog.  \nNotice that the conductance is set to \u201c -10.0\u201d for the boundary conditions created by the \narc. Also notice that the spreadsheet now has a Cond. factor  column. The values listed in \nthe Cond. factor  column are multiplied by the parameter value to give the final \nconductance value for the DRT boundary condition.  \n11. Click OK to exit the MODFLOW Drain Return Package  dialog.  \n6.1 Saving and Running MODFLOW  \nNow to save the changes and run MODFLOW:  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cdrt3.gpr\u201d as the File name . \n4. Click Save to save the project under the new name and close the Save As  \ndialog.  \n5. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n6. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n7. Click Close  to exit the MODFLOW  model wrapper dialog.  \nNotice that the new solution is the same as the previous run.  \n  \nGMS Tutorials   MODFLOW \u2013 DRT Package  \n \n Page 15 of 15 \u00a9 Aquaveo 2025  7 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 DRT Package\u201d tutorial. The following key concepts \nwere discussed and demonstrated:  \n\u2022 GMS supports both the DRN and DRT packages. Both packages can be used at \nthe same time if desired.  \n\u2022 The DRT package produces the same results as the DRN package if the return -\nflow factor is specified as zero.  \n\u2022 DRT data can be viewed and edited in the DRT Package  dialog.  \n\u2022 DRT data can be defined on points, arcs, and polygons in a conceptual model.  \nGMS supports DRT parameters.  \n", "filename": "MODFLOW-DRTPackage.pdf", "pages": 15}, "MODFLOW-ETSPackage": {"text": "GMS Tutorials   MODFLOW \u2013 ETS Package  \n Page 1 of 18 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 ETS Package  \nThe MODFLOW Evapotranspiration Segments (ETS) package \ninterface in GMS  \n \nObjectives   \nLearn how to use the MODFLOW Evapotranspiration Segments (ETS) package interface in GMS and \ncompare it to  the regular MODFLOW Evapotranspiration (EVT) package.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach I  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 40\u201360 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 ETS Package  \n Page 2 of 18 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 Opening the Existing Model  ................................ ................................ ..........................  4 \n2.2 Saving the Model with a New Name  ................................ ................................ .............  4 \n3 Adding ET via the EVT Package  ................................ ................................ .........................  4 \n3.1 Turning on the EVT Package  ................................ ................................ ........................  5 \n3.2 Specifying ET ................................ ................................ ................................ ................  5 \n3.3 Saving and Running MODFLOW  ................................ ................................ ..................  5 \n3.4 Examining the Flow Budget  ................................ ................................ ..........................  6 \n4 Adding ET via the ETS Package  ................................ ................................ .........................  7 \n4.1 Saving the Model with a New Name  ................................ ................................ .............  7 \n4.2 Switching from the EVT Package to the ETS Package  ................................ .................  7 \n4.3 Specifying ET ................................ ................................ ................................ ................  7 \n4.4 Switching LMT package to Extended Header  ................................ ...............................  8 \n4.5 Saving and Running MODFLOW  ................................ ................................ ..................  8 \n4.6 Examining the Flow Budget  ................................ ................................ ..........................  9 \n5 Adding ETS Curve Segments  ................................ ................................ .............................  9 \n5.1 Saving the Model with a New Name  ................................ ................................ ...........  10 \n5.2 Changing NETSEG  ................................ ................................ ................................ ..... 10 \n5.3 Defining the PXDP Data  ................................ ................................ .............................  10 \n5.4 Defining the PETM Data  ................................ ................................ .............................  11 \n5.5 Saving and Running MODFLOW  ................................ ................................ ................  11 \n6 Building a Conceptual Model  ................................ ................................ ...........................  12 \n6.1 Saving the Model with a New Name  ................................ ................................ ...........  12 \n6.2 Creating the Conceptual Model  ................................ ................................ ..................  13 \n6.3 Creating a Coverage  ................................ ................................ ................................ ... 13 \n6.4 Creating the Polygon  ................................ ................................ ................................ .. 13 \n6.5 Setting the Polygon Properties  ................................ ................................ ...................  14 \n6.6 Mapping to MODFLOW  ................................ ................................ ..............................  14 \n6.7 Examining the ETS Package  ................................ ................................ ......................  14 \n6.8 Saving and Running MODFLOW  ................................ ................................ ................  15 \n7 Parameters  ................................ ................................ ................................ .........................  16 \n7.1 Saving the Model with a New Name  ................................ ................................ ...........  16 \n7.2 Parameterizing the Model  ................................ ................................ ...........................  16 \n7.3 Saving and Running MODFLOW  ................................ ................................ ................  17 \n8 Conclusion  ................................ ................................ ................................ .........................  18 \n \n1 Introduction  \nEvapotranspiration is the moving of water from the ground surface to the atmosphere \nthrough evaporation and transpiration. MODFLOW has two standard packages \u2014EVT \nand ETS \u2014used to model evapotranspiration.   \nThe EVT package \u2014which has existed since at least MODFLOW 88 \u2014requires three \nparameters to determine evapotranspiration: the evapotranspiration (ET) surface \nelevation, the maximum ET rate, and the extinction depth. When the head in a cell is at or \nabove the ET surface, ET occurs at the maximum ET rate. When the head is below the \nextin ction depth, ET is zero. In between these two points, the ET varies linearly ( Figure \n1). \nThe Evapotranspiration Segments Package  (ETS) \u2014introduced with MODFLOW 2000 \u2014\nis very similar to the EVT package, but adds the ability to vary the ET nonlinearly \nbetween the ET surface and the extinction depth. These packages can be used \nsimultaneously.  \nGMS Tutorials   MODFLOW \u2013 ETS Package  \n \n Page 3 of 18 \u00a9 Aquaveo 2024   \n      Figure 1      ET model, from Banta  (2000 )1 \nThis t utorial explains how to use the ETS package and compares it to the EVT package. \nIt uses the problem ( Figure 2) found in the \u201c MODFLOW \u2013 Grid Approach \u201d tutorial, a \nmodified version of the sample problem described near the end of the MODFLOW  88 \nReference Manual . It is a grid -based model (no conceptual model) with three layers, \nsome wells and drains, recharge, and constant head cells.  \n \nUnconfined  \nConfined  \nConfined  Const Head = 0 m  \nin column 1 of  \nlayers 1 & 2  Drain  \nLayer 1 : K = 15 m/d, top elev. = 60 m, bot elev. = -45 m \nLayer 2 : K = 0.9 m/d, top elev. = -45 m, bot elev. = -120 m \nLayer 3 : K = 2 m/d, top elev. = -120 m, bot elev. = -215 m Recharge = 0.0009 m/d  \n \n      Figure 2      Sample problem to be solved  \nThis tutorial discusses and demonstrates:  \n\uf0b7 Adding ET to the model using the EVT package.  \n\uf0b7 Adding ET to the model using the ETS package.  \n\uf0b7 Mimicking the EVT package.  \n\uf0b7 Defining a n onlinear curve for the ETS package.  \n\uf0b7 Creating a simple conceptual model illustrating how ETS can be modeled \nconceptually and mapped to MODFLOW.  \n \n \n2 Getting Started  \nDo the following to get started:  \n                                                      \n1 Banta, Edward R. (2000), MODFLOW -2000, The U.S. Geological Survey Modular Ground -Water \nModel \u2014Documentation of Packages for Simulating Evapotranspiration with a Segmented Fu nction \n(ETS1) and Drains with Return Flow (DRT1) . Open -File Report 00 -466, Denver, Colorado, p.3. \nhttp://pubs.usgs.gov/of/2000/0466/report.pdf  . \n\nGMS Tutorials   MODFLOW \u2013 ETS Package  \n \n Page 4 of 18 \u00a9 Aquaveo 2024  1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state. Click Don\u2019t Save  if asked to save changes.  \n2.1 Opening the Existing Model  \nThe first step is to start with a MODFLOW model that has already been created.  \n1. Click Open   to bring u p the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the et directory and select \u201cmodfgrid.gpr\u201d.  \n4. Click Open  to import the project and exit the Open  dialog.  \nThis opens the model showing a grid with color filled cont ours and symbols representing \nwells, drains, and other boundary conditions ( Figure 3). \n \n      Figure 3      The initial model  \n2.2 Saving the Model with a New Name  \nBefore making changes, save the model with a new name.  \n1. Select File | Save As\u2026  to bring up t he Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cevt.gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n3 Adding ET via the EVT Package  \nThe first change is to add ET  to the model via the EVT package.  \n\nGMS Tutorials   MODFLOW \u2013 ETS Package  \n \n Page 5 of 18 \u00a9 Aquaveo 2024  3.1 Turning on the EVT Package  \nIt is necessary to turn on the EVT package.  \n1. Select MODFLOW | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage  dialog.  \n2. Click Packages\u2026  to bring up the MODFLOW Packages / Processes  dialog.  \n3. In the Optional packages / processes  section, turn on EVT1 \u2013 \nEvapotranspiration . \n4. Click OK to exit the MODFLOW Packages / Processes  dialog.  \n5. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n3.2 Specifying ET  \nNow it is necessary to specify the E T parameters.  \n1. Select MODFLOW | Optional Packages | EVT \u2013 Evapotranspiration\u2026  to bring \nup the MODFLOW EVT Package  dialog.  \nMax ET Rate  \n2. Above the array, in the View/Edit  drop-down, select \u201cEVTR. Max ET rate\u201d.  \n3. Click Constant \u2192 Array  to bring up the Grid Value  dialog.  \n4. Enter \u201c0.01\u201d as the Constant value for grid . \n5. Click OK to close the Grid Value  dialog.  \nET Surface  \n6. Select \u201cSURF. Elevation of ET surface\u201d from the View/Edit  drop-down.  \n7. Click Constant \u2192 Array  to bring up the Grid Value  dialog.  \n8. Enter \u201c59.0\u201d as the Constant value for grid . \n9. Click OK to close the Grid Value  dialog.  \nExtinction Depth \n10. Select \u201cEXDP. ET extinction depth\u201d from the View/Edit  drop-down.  \n11. Click Constant \u2192 Array  to bring up the Grid Value  dialog.  \n12. Enter \u201c6.0\u201d as the Constant value for grid . \n13. Click OK to close the Grid Value  dialog.  \nNo more changes will be made for this tutorial example. In the ET option (NEVTOP) \nsection, notice that the default selection for the drop -down is \u201c(1) ET only at top layer\u201d.  \n14. Click OK to exit the MODFLOW EVT Package  dialog.  \n3.3 Saving and Running MODFLOW  \nThe next steps are to save the changes and run MODFLOW.  \n1. Save   the project.  \n\nGMS Tutorials   MODFLOW \u2013 ETS Package  \n \n Page 6 of 18 \u00a9 Aquaveo 2024  2. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n3. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.  \nNotice the contours have changed ( Figure 4) because th e head is lower in the new \u201cevt\u201d \nsolution. The addition of evapotranspiration has caused more water to leave the model, \nthus lowering the head.  \n5. Expand the \u201c  3D Grid Data\u201d folder.  \n6. Compare the new and old solutions by alternately selecting \u201c  modfgrid \n(MODF LOW)\u201d and \u201c  evt (MODFLOW)\u201d in the Project Explorer.  \n7. Save   the project with the new solution.  \n \n      Figure 4      The contours have changed  \n3.4 Examining the Flow Budget  \nThis tutorial will now take a look at how much water is leavin g the system due to \nevapotranspiration.  \n1. Select the \u201c  evt (MODFLOW)\u201d solution in the Project Explorer to make it active.  \n2. Select MODFLOW | Flow Budget\u2026  to bring up the Flow Budget  dialog.  \n3. On the Cells  tab, notice that in the Sources/Sinks  section, on the ET row, there is \nzero flow in but some flow out.  \n4. Click OK to exit the Flow Budget  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 ETS Package  \n \n Page 7 of 18 \u00a9 Aquaveo 2024  4 Adding ET via the ETS Package  \nThe next step is to switch to the ETS package to model evapotranspiration. No curve \nsegments will be defined at first so that the ETS pac kage will work just like the EVT \npackage. Segments will be added later.  \n4.1 Saving the Model with a New Name  \nBefore changing the model to use the ETS package, save the model with a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cets1.gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n4.2 Switching from the EVT Package to the ETS Package  \nFirst, turn on the ETS package.  \n1. Select MODFLOW | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage dialog.  \n2. Click Packages\u2026  to bring up the MODFLOW Packages / Processes dialog.  \n3. In the Optional packages / processes  section, turn off EVT1 \u2013 Evapotranspiration  \nand turn on ETS1 \u2013 Evapotranspiration Segments . \n4. Click OK to exit the MODFLOW Packages / Processes  dialog.  \n5. Click OK to exit the MODFLOW Global/Basic Package dialog.  \n4.3 Specifying ET  \nNext, specify the ET parameters.  \n1. Select MODFLOW | Optional Packages | ETS \u2013 Evapotranspiration \nSegme nts\u2026  to bring up the MODFLOW ETS Package  dialog.  \nThis dialog is very similar to the MODFLOW EVT Package  dialog. The ET parameters \nwill be set to the same values that were used for the EVT package.  \nMax ET Rate  \n1. Above the array, in the View/Edit  drop-down, select \u201c ETSR . Max ET rate\u201d.  \n2. Click Constant \u2192 Array  to bring up the Grid Value  dialog.  \n3. Enter \u201c0.01\u201d as the Constant value for grid . \n4. Click OK to close the Grid Value  dialog.  \nET Surface  \n1. Select \u201c ETSS . Elevation \u201d from the View/Edit  drop-down.  \n2. Click Constant \u2192 Array  to bring up the Grid Value  dialog.  \nGMS Tutorials   MODFLOW \u2013 ETS Package  \n \n Page 8 of 18 \u00a9 Aquaveo 2024  3. Enter \u201c59.0\u201d as the Constant value for grid . \n4. Click OK to close the Grid Value  dialog.  \nExtinction Depth \n1. Select \u201c ETSX . ET extinction depth\u201d from the View/Edit  drop-down.  \n2. Click Constant \u2192 Array  to bring up t he Grid Value  dialog.  \n3. Enter \u201c6.0\u201d as the Constant value for grid . \n4. Click OK to close the Grid Value  dialog.  \nNotice that NETSEG  was left at \u201c1\u201d. This means there is one curve segment, meaning the \ncurve is linear. Therefore, the ETS package will behave just l ike the EVT package.  \n5. Click OK when finished to exit the MODFLOW ETS Package  dialog.  \n4.4 Switching LMT package to Extended Header  \nWhen GMS saves a MODFLOW simulation, by default, it includes the linkage files \nneeded by MT3DMS to run a transport simulation, even  if no MT3DMS model is currently \ndefined. If the ETS package is in use, a setting for the MT3DMS linkage files must be \nchanged.  \n1. Select MODFLOW | OC \u2013 Output Control\u2026  to bring up the MODFLOW Output \nControl dialog.  \n2. In the Other output  section, select Extende d header format  under the *.hff file for \ntransport  option.  \n3. Click OK to close the MODFLOW Output Control  dialog.  \nAlternatively, simply turn off *.hff file for transport  since MT3DMS will not be used with \nthis model.  \n4.5 Saving and Running MODFLOW  \nNow it is poss ible to save the changes and run MODFLOW.  \n1. Save   the project.  \n2. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n3. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import th e solution and close the MODFLOW  model wrapper \ndialog.  \nThe new \u201c  ets1 (MODFLOW)\u201d solution is identical to the \u201c  evt (MODFLOW)\u201d \nsolution.  \n5. Compare all three solutions by alternately selecting \u201c  modfgrid (MODFLOW)\u201d, \u201c\n evt (MODFLOW)\u201d,  and \u201c  ets1 (MODFLOW) \u201d in the Project Explorer.  \n6. Save   the project with the new solution.  \n\nGMS Tutorials   MODFLOW \u2013 ETS Package  \n \n Page 9 of 18 \u00a9 Aquaveo 2024  4.6 Examining the Flow Budget  \nNow review how much water is leaving the system due to evapotranspiration.  \n1. Select \u201c  ets1 (MODFLOW)\u201d to make it active.  \n2. Select MODFLOW | Flow Budget\u2026  to bring up the Flow Budget  dialog.  \n3. On the Cells  tab, notice the ET SEGMENTS  row in the Sources/Sinks  section. \nThere is zero flow in but some flow out. The flow out is the same amount that \nwas previously reported for the EVT package.  \n4. Click OK to exit the  Flow Budget  dialog.  \n5 Adding ETS Curve Segments  \nThe next step will take advantage of the extra functionality in the ETS package by \nspecifying a nonlinear curve, such as the one in Figure 5. \n \n      Figure 5      Nonlinear ET curve with three segments  \nThis curve requires some explanation. PXDP and PETM are MODFLOW variables. The \nETS1 package documentation describes them as follows:  \nIn the ETS1 Pac kage, the functional relation of evapotranspiration rate to \nhead is conceptualized as a segmented line in the variable interval. The \nsegments that determine the shape of the function in the variable interval \nare defined by intermediate points where adjacen t segments join. The \nends of the segments at the top and bottom of the variable interval are \ndefined by the ET surface, the maximum evapotranspiration rate, and the \nextinction depth. The number of intermediate points that must be de\ufb01ned \nis one less than th e number of segments in the variable interval. For \neach intermediate point, two values, PXDP and PETM, are entered to \ndefine the point. PXDP is a proportion (between zero and one) of the \nextinction depth, and PETM is a proportion of the maximum \nevapotransp iration rate. PXDP is 0.0 at the ET surface and is 1.0 at the \nbottom of the variable interval. PETM is 1.0 at the ET surface and is 0.0 \nat the bottom of the variable interval.2 \n                                                      \n2 Banta  (2000) , p.3.  \n00.250.50.751\n0 0.25 0.5 0.75 1\nPXDPPETM\nGMS Tutorials   MODFLOW \u2013 ETS Package  \n \n Page 10 of 18 \u00a9 Aquaveo 2024  The curve in Figure 5 is nonlinear. It is defined so that the ET rate drops gradually as the \nhead drops below the ET surface, but then drops more rapidly as the head approaches \nthe extinction depth. The values for  PXDP and PETM in this case are as follows:  \nRow PXDP  PETM  \n1 0.0 1.0 \n2 0.5 0.8 \n3 0.75 0.5 \n4 1.0 0.0 \nTo use the curve in Figure 5 for the ETS package, change the number of segments \n(NETSEG) to 3 and define the points where the segments meet. Since there are three \nsegments, two points of intersection need to be defined. It is not necessary to define the \nfirst and last points on the curve since they are always at \u201c1.0\u201d and \u201c0.0\u201d. It is only \nnecessary to define the two interior points on the curve.  \n \n5.1 Saving the Model with a New Name  \nBefore changing the model to use a nonline ar curve for ETS, save the model with a new \nname.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr) from the Save as type  drop-down.  \n3. Enter \u201cets2.gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n5.2 Changing NETSEG  \nTo change the number of segments:  \n1. Select MODFLOW | Optional Packages | ETS \u2013 Evapotranspiration \nSegments\u2026 to bring up the MODFLOW ETS Package  dialog.  \n2. Enter \u201c3\u201d in the NETSEG  field at the middle -right of the dialog.  \n5.3 Defining the PXDP Data  \nThe order of entering the values for PXDP and PETM is important, as explained in the \npackage documentation:  \nPXDP is a proportion of the extinction depth (dimensionless), measured \ndownward from the ET surface, which, with PETM, defines the shape of \nthe relation between the evapotranspiration rate and head. The value of \nPXDP must be between 0.0 and 1.0, inclusive. Repetitions of PXDP and \nPETM are read in sequence such that the first occurrenc e represents the \nbottom of the first segment, and subsequent repetitions represent the \nbottom of successively lower segments. Accordingly, PXDP values for \nlater repetitions (representing lower segments) should be greater than \nPXDP values for earlier repeti tions.   \nGMS Tutorials   MODFLOW \u2013 ETS Package  \n \n Page 11 of 18 \u00a9 Aquaveo 2024  PETM is a proportion of the maximum evapotranspiration rate \n(dimensionless) which, with PXDP, defines the shape of the relation \nbetween the evapotranspiration rate and head. The value of PETM \nshould be between 0.0 and 1.0, inclusive. Repetitions of  PXDP and \nPETM are read in sequence such that the first occurrence represents the \nbottom of the first segment, and subsequent repetitions represent the \nbottoms of successively lower segments. Accordingly, PETM values for \nlater repetitions (representing low er segments) generally would be less \nthan PETM values for earlier repetitions.3 \nDefine the PXDP values for both points, and apply the same curve to all the cells in the \ngrid. Note that it is possible to have different curves for each cell.  \n1. Select \u201cPXDP. Curve segments\u201d from the View/Edit  drop-down.  \n2. Enter \u201c1\u201d in the Segment array  field.  \nThis means data for the first point is being viewed and edited.  \n3. Click Constant \u2192 Array  to bring up the Grid Value  dialog.  \n4. Enter \u201c0.5\u201d as the Constant value f or grid  and click OK to close the Grid Value  \ndialog.  \n5. Enter \u201c2\u201d in the Segment array  field in order to view the second segment.  \n6. Click Constant \u2192 Array  to bring up the Grid Value  dialog.  \n7. Enter \u201c0.75\u201d as the Constant value for grid  and click OK to close the Grid Value  \ndialog.  \n5.4 Defining the PETM Data  \nNext, define the PETM data for both points. Make the same curve apply to all the cells in \nthe grid.  \n1. Select \u201cPETM. Curve segments\u201d from the View/Edit  drop-down.  \n2. Set the Segment array  to \u201c1\u201d.  \n3. Click Constant \u2192 Array  to bring up the Grid Value  dialog.  \n4. Enter \u201c0.8\u201d as the Constant value for grid  and click OK to close the Grid Value  \ndialog.  \n5. Set the Segment array  to \u201c2\u201d.  \n6. Click Constant \u2192 Array  to bring up the Grid Value  dialog.  \n7. Enter \u201c0.5\u201d as the Constant value for grid  and click OK to close the Grid Value  \ndialog.  \n8. Click OK to exit the MODFLOW ETS Package  dialog.  \n5.5 Saving and Running MODFLOW  \nThe next steps are to save these changes and run MODFLOW.  \n1. Save   the project.  \n                                                      \n3 Banta (2000), p.8. Emphasis  added.  \n\nGMS Tutorials   MODFLOW \u2013 ETS Package  \n \n Page 12 of 18 \u00a9 Aquaveo 2024  2. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n3. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.  \nNotice the very slight changes in the new solution ( Figure 6). \n5. Compare all four solutions by alternately selecting \u201c  modfgrid (MODFLOW)\u201d, \u201c\n evt (MODFLOW)\u201d,  \u201c ets1 (MODFLOW)\u201d,  and \u201c  ets2 (MODFLOW)\u201d  in the \nProject Explorer.  \n6. Save  the project with the new solution.  \n \n      Figure 6      Very slight changes in the contours are noticeable  \n6 Building a Conceptual Model  \nThe next step is to examine how to use a conceptual model with ETS data.  \n6.1 Saving the Model with a New Name  \nBefore changing the model to use a conceptual model, save the model with a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cets3.gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n\nGMS Tutorials   MODFLOW \u2013 ETS Package  \n \n Page 13 of 18 \u00a9 Aquaveo 2024  6.2 Creating the Conceptual Model  \n1. Right -click in the Project Explorer and select New | Conceptual Model\u2026  to bring \nup the Conceptual Model Propert ies dialog.  \n2. Enter \u201cmodfgrid\u201d as the Name . \n3. Under Advanced package options to include , turn on ETS1 \u2013 Evapotranspiration \nSegments . \n4. Click OK to close the Conceptual Model Properties  dialog.  \n6.3 Creating a Coverage  \n1. Right -click on the new \u201c  modfgrid\u201d conceptual mo del and select New \nCoverage\u2026  to bring up the Coverage Setup  dialog.  \n2. Enter \u201cets\u201d as the Coverage name . \n3. In the Areal Properties  column, turn on Max ET rate , ET elev. , ETS Extinction \ndepth , and ETS Segmented curve . \n4. Click OK to exit the Coverage Setup  dialog.  \n6.4 Creating the Polygon  \n1. Select the \u201c  ets\u201d coverage to make it active.  \n2. Using the Create Arc   tool, create an arc that surrounds the grid. End the arc \nby clicking on the starting node in order to form a closed polygon ( Figure 7). \n3. Select Feature Objects | Build Polygons  to create the polygon.  \n \n      Figure 7      Creating a polygon that encompasses the model grid  \n\nGMS Tutorials   MODFLOW \u2013 ETS Package  \n \n Page 14 of 18 \u00a9 Aquaveo 2024  6.5 Setting the Poly gon Properties  \n1. Using the Select Objects   tool, double -click anywhere inside the new polygon \nto bring up the Attribute Table  dialog.  \n2. Enter \u201c0.01\u201d in the Max ETS rate (m/d)  column.  \n3. Enter \u201c59.0\u201d in the ETS elev. (m)  column.  \n4. Enter \u201c6.0\u201d in the ETS ext. depth (m) column.  \n5. Enter \u201c -1\u201d in the ETS segmented curve column.  \nThe value in the ETS segmented curve  column is the number of an XY series. The \ncurves are defined using the XY Series Editor , and each XY series has a unique number. \nA value of \u201c -1\u201d indicates that no XY series has been specified yet.  \n6. Click the  button in the ETS segmented curve  column to bring up the XY \nSeries Editor  dialog.  \nEnter the values from the following chart into the spreadsheet on  the left side of the \ndialog. These are different values than were used previously. In this case, the first and \nlast values on the curve will be included:  \nRow PXDP  PETM  \n1 0.0 1.0 \n2 0.4 0.9 \n3 0.8 0.6 \n4 1.0 0.0 \n7. Click OK to exit the  XY Series Editor  dialog . \nNotice the value in the ETS segmented curve  column has changed.  \n8. Click OK to exit the  Attribute Table  dialog . \n6.6 Mapping to MODFLOW  \nThe conceptual model is now set up, so it is possible to map it to the MODFLOW grid.  \n1. Select Feature Objects | Map \u2192 MOD FLOW  to bring up the Map \u2192 Model  \ndialog.  \n2. Click OK to accept the defaults and close the Map \u2192 Model  dialog.  \n6.7 Examining the ETS Package  \nThe next step is to take a look at the data in MODFLOW that was mapped from the \nconceptual model.  \n1. Select MODFLOW | Optional Packages | ETS \u2013 Evapotranspiration \nSegments\u2026 to bring up the MODFLOW ETS Package  dialog.  \n2. Select \u201cETSS. Elevation\u201d from the View/Edit drop-down. The cells in the \nspreadsheet below should all show \u201c59.0\u201d.  \n\nGMS Tutorials   MODFLOW \u2013 ETS Package  \n \n Page 15 of 18 \u00a9 Aquaveo 2024  3. Select \u201cETSR. Max ET rate\u201d from t he View/Edit drop-down. The cells in the \nspreadsheet below should all show \u201c0.01\u201d.  \n4. Select \u201cETSX. ET extinction depth\u201d from the View/Edit drop-down. The cells in \nthe spreadsheet below should all show \u201c6.0\u201d.  \n5. Select \u201cPXDP. Curve segments\u201d from the View/Edit drop-down and enter \u201c1\u201d as \nthe Segment array . Notice that the cells in the spreadsheet below all show \u201c0.4\u201d.  \n6. Enter \u201c2\u201d as the Segment array . Notice that the cells in the spreadsheet below all \nshow \u201c0.8\u201d.  \n7. Select \u201cPETM. Curve segments\u201d from the View/Edit drop-down and enter \u201c1\u201d as \nthe Segment array. Notice that the cells in the spreadsheet below all show \u201c0.9\u201d.  \n8. Enter \u201c2\u201d as the Segment array. Notice that the cells in the spreadsheet below all \nshow \u201c0.6\u201d.  \nClick OK to close the MODFLOW ETS Package  dialog.  \n6.8 Saving  and Running MODFLOW  \nThe next steps are to save the changes and run MODFLOW.  \n1. Save   the project.  \n2. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n3. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on  already) . \n4. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.  \nNotice some very slight changes in the new solution ( Figure 8). \n5. Compare all five solutions by alternately selecting \u201c  modfgrid (MODFLOW)\u201d, \u201c\n evt (MODFLOW)\u201d, \u201c  ets1 (MODFLOW)\u201d, \u201c  ets2 (MODFLOW)\u201d, and \u201c  \nets3 (MODFLOW)\u201d in the Project Explorer.  \n6. Save   the project with the new solution.  \n\nGMS Tutorials   MODFLOW \u2013 ETS Package  \n \n Page 16 of 18 \u00a9 Aquaveo 2024   \n      Figure 8      Very slight changes visible in the contours  \n7 Parameters  \nIt is possible to set parameters with the EVT and ETS packages. Use parameters to \nassign one ET rate to the left side of the model and a different rate to the right side.  \n7.1 Saving the Model with a New Name  \nThe model should first be saved with a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cets4.gpr\u201d as the File name . \n4. Click Save  to save t he project under the new name and close the Save As  \ndialog.  \n7.2 Parameterizing the Model  \n1. Turn off \u201c  Map Data\u201d in the Project Explorer.  \n2. Select \u201c  3D Grid Data\u201d to switch to the 3D Grid   module.  \n3. Using the Select Cells   tool, select the rightmost eight columns (see Figure 9). \n4. Right -click in the selected area and select Sources/Sinks\u2026  to bring up the \nMODFLOW Sources/Si nks dialog.  \n\nGMS Tutorials   MODFLOW \u2013 ETS Package  \n \n Page 17 of 18 \u00a9 Aquaveo 2024  5. Select Evapotranspiration (ETS)  from the list on the left.  \n6. In the All row, enter \u201c -10.0\u201d in the ETS Max. et. (m/d) column.  \nNote that \u201c -10.0\u201d is not a valid ET rate. It is a key value that indicates these cells will be \nassociated with a paramete r. This key value can be any negative number.  \n7. Click OK to exit the MODFLOW Source/Sinks  dialog.  \n8. Select MODFLOW | Parameters\u2026  to bring up the Parameters  dialog.  \n9. Click Initialize From Model  to create a new parameter.  \nThis results in GMS looking through the m odel inputs for negative numbers and creating \na parameter whenever one is found. In this case, GMS creates one parameter for the -10 \nvalues it encountered in the ETS package.  \n10. Enter \u201c0.1\u201d in the Value  column (it may already be set to that value).  \n11. Click OK to exit the Parameters  dialog.  \n \n      Figure 9      Dragging a box around the rightmost eight columns  \n7.3 Saving and Running MODFLOW  \nThe next steps are to save the changes and run MODFLOW.  \n1. Save   the project.  \n2. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n3. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n\nGMS Tutorials   MODFLOW \u2013 ETS Package  \n \n Page 18 of 18 \u00a9 Aquaveo 2024  4. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.  \nNotice some very slight chan ges in the new solution ( Figure 10). \n5. Compare all six solutions by alternately selecting \u201c  modfgrid (MODFLOW)\u201d, \u201c\n evt (MODFLOW)\u201d, \u201c  ets1 (MODFLOW)\u201d,  \u201c ets2 (MODFLOW)\u201d, \u201c  ets3 \n(MODFLOW)\u201d, and \u201c  ets4 (MODFLOW)\u201d in the Project Explorer.  \n6. Save   the project with the new solution.  \n \n      Figure 10      The final solution, showing very slight contour changes  \n8 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 ETS Package\u201d tutorial. The following key concepts \nwere demonstrated and discussed:  \n\uf0b7 GMS supports both the EVT and ETS packages. Both packages can be used at \nthe same time if desired.  \n\uf0b7 The ETS package produces the same results as the EVT package if only one \ncurve segment is defined.  \n\uf0b7 ETS data can be viewed and edited in the MODFLOW ETS Package  dialog.  \n\uf0b7 The order in which the PXDP and PETM data is entered is important. PXDP \nvalues should be in increasing order and PETM values should be in  decreasing \norder.  \n\uf0b7 ETS data can be defined on polygons in a conceptual model.  \n\n", "filename": "MODFLOW-ETSPackage.pdf", "pages": 18}, "MODFLOW-GAGEPackage": {"text": "GMS Tutorials   MODFLOW \u2013 Gage Package  \n Page 1 of 8 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 GAGE Package  \nThe MODFLOW GAGE Package Interface in GMS  \n \nObjectives   \nThis tutorial explains how to use the MODFLOW GAGE package interface in GMS.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Grid \nApproach  \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach I  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 20\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 Gage Package  \n Page 2 of 8 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 Importing the Project  ................................ ................................ ................................ ..... 3 \n2.2 Saving the Model with a New Name  ................................ ................................ .............  4 \n3 Adding the Gages  ................................ ................................ ................................ ................  4 \n3.1 The Lake Package Dialog  ................................ ................................ .............................  4 \n3.2 The SFR Package Dialog  ................................ ................................ .............................  5 \n3.3 Enabling the GAGE Package ................................ ................................ ........................  5 \n3.4 Adding Gages  ................................ ................................ ................................ ...............  5 \n4 Running MODFLOW  ................................ ................................ ................................ ............  6 \n5 Examining the Solution  ................................ ................................ ................................ ....... 6 \n5.1 The Head Solution  ................................ ................................ ................................ ........  6 \n5.2 Gage Output Files  ................................ ................................ ................................ .........  7 \n5.3 Creating a Gage Plot  ................................ ................................ ................................ .... 7 \n6 Conclusion  ................................ ................................ ................................ ...........................  8 \n \n1 Introduction  \nThe Gage package (GAGE) was developed by the USGS to allow output of detailed time \nseries data for a given lake ID or SFR stream reach. GAGE  provides an extensive list of \noptions for lake time series output including stage, volume, inflows, outflows, lake \nconductance, UZF interaction, and several others. For an SFR reach associated with a \nmodel cell, some of the options include stage, flow, dep th, width, diversion specific \noutput, and unsaturated flow routing.  \nThe conceptual model for this tutorial is shown in Figure 1. The model consists of two \nlakes \u2014Clear Lake and Blue Lake \u2014connected by a stream. The stream flows from Clear \nLake and feeds Blue Lake. Blue Lake is also fed by a second stream, and a third stream \nflows from Blue Lake into a much larger body of water.  \nThe model is transient with  stress periods set to cover a four -year period, with the starting \nhead values for the model set at steady -state. The first and fourth years have normal \nprecipitation, and the second and third years are below normal.  \nThis tutorial will discuss and demonst rate  \n\uf0b7 Adding gage stations to an existing MODFLOW simulation of the lakes and the \nstreams.  \n\uf0b7 Analyzing the gage file output to see how the change in precipitation affects the \nlakes and streams.  \n\uf0b7 Generating a gage plot.  \nGMS Tutorials   MODFLOW \u2013 Gage Package  \n \n Page 3 of 8 \u00a9 Aquaveo 2024   \n      Figure 1      Conceptual model  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state. Click Don\u2019t Sav e if asked to save changes.  \n2.1 Importing the Project  \nFirst, import the project:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the gage \\gage folder and select \u201cstart.gpr\u201d.  \n4. Click Open to im port the project and exit the Open  dialog.  \nA MODFLOW model should appear in the Graphics Window ( Figure 2). \n\nGMS Tutorials   MODFLOW \u2013 Gage Package  \n \n Page 4 of 8 \u00a9 Aquaveo 2024   \n      Figure 2      Layer 2 of the MODFLOW model  showing elevation contours  \n2.2 Saving the Model with a New Name  \nBefore making changes, save the model with a new name . \n1. Select File | Save As\u2026 to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cTwoLakes.gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n3 Adding the Gages  \nBefore adding gage stations to the simulation, it is necessary to determine the stream \nsegment and reach for each SFR gage. To do this, view the lake and SFR boundary \nconditions in the package dialogs.  \n3.1 The Lake Package Dialog  \n1. Select MODFLOW | Optional Pa ckages | LAK \u2013 Lake\u2026  to open the MODFLOW \nLake Package  dialog.  \nThe lake boundary conditions are shown in this dialog. In the spreadsheet in the Lake \nattributes  section, Blue Lake is listed as \u201cLake 1\u201d and Clear Lake is listed as \u201cLake 2\u201d.  \n2. Click OK to exit the MODFLOW Lake Package  dialog  \n\nGMS Tutorials   MODFLOW \u2013 Gage Package  \n \n Page 5 of 8 \u00a9 Aquaveo 2024  3.2 The SFR Package Dialog  \n1. Select MODFLOW | Optional Packages | SFR2 \u2013 Streamflow -Routing\u2026  to \nopen the MODLFLOW Stream (SFR2) Package  dialog.  \nThe dialog contains two tables. The Segments  table contains a segment entry f or each \nstream, and the Reaches  table contains the reaches for all segments. In order to find the \nappropriate segment and reach, it is necessary to look in the Reaches  table.  \nThe ISEG  column of the table contains the segment number, and the IREACH  column \ncontains the reach number. Reaches are ordered in the direction of flow, so look for the \nhighest numbered reach for each segment. From the table, the segment -reach pairs to \nbe located include 1 \u201310, 2 \u20137, and 3 \u201330.  \n2. Click OK to exit the MODFLOW Stream (SFR2)  Package  dialog.  \n3.3 Enabling the GAGE Package  \nBefore adding gages, ensure that GAGE is enabled.  \n1. Select MODFLOW | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage dialog.  \n2. Click Packages\u2026  to open the MODFLOW Packages / Processes dialog.  \n3. In the Optio nal packages / processes  section, turn on GAGE \u2013 Gage . \n4. Click OK to exit the MODFLOW Packages / Processes  dialog.  \n5. Click OK to exit the MODFLOW Global/Basic Package dialog.  \n3.4 Adding Gages  \nGages are added in the GAGE Package  dialog.  \n1. Select MODFLOW | Optional Pa ckages | GAGE \u2013 Gage\u2026  to open the Gage \nPackage  dialog.  \n2. In the Stream Gages  table at the top, add three rows by clicking three times on \nthe Insert Row  button at the bottom of the Stream Gages  table.  \n3. Enter the following values:  \nName  GAGESEG  GAGERCH  \nClear_Creek  1 10 \nBig_Creek  2 7 \nBlue_Creek  3 30 \nThe OUTTYPE  column gives options for several different types of gage output. For this \ntutorial, use the default value.   \n4. Below the Lake Gages  table, click on Add All Lakes  to add gages for both lakes.  \nNow change the lake names.  \n5. Replace \u201cLake 1\u201d with \u201cBlue_Lake\u201d and \u201cLake 2\u201d with \u201cClear_Lake\u201d.  \n6. Click OK to exit the  Gage Package dialog . \n \n\nGMS Tutorials   MODFLOW \u2013 Gage Package  \n \n Page 6 of 8 \u00a9 Aquaveo 2024  4 Running MODFLOW  \nNow to save these changes and run MODFLOW:   \n1. Save   the project.  \n2. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n3. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.   \n5. Save   the project with the new solution.  \nThe new s olution will be visible ( Figure 3). Notice the contours.  \n \n      Figure 3      The computed solution after the MODFLOW run  \n5 Examining the Solution  \nThe next sections look more closely at the computed so lution.  \n5.1 The Head Solution  \n1. Expand the \u201c  3D Grid Data\u201d folder in the Project Explorer and select the \u201c  \nHead \u201d dataset under the \u201c  TwoLakes (MODFLOW) \u201d solution.  \nThe Time Step  window appears at the bottom of the Project Explorer , and the first stress \nperiod is selected.  \n2. Scroll through the time steps, clicking on a time step near the middle of the \nsimulation and then the time step at the end.  \n\nGMS Tutorials   MODFLOW \u2013 Gage Package  \n \n Page 7 of 8 \u00a9 Aquaveo 2024  When changing between the different time steps, notice that the first and last time steps \nhave similar head contours. F or time steps near the middle of the simulation, the head \nvalues are lower.  \n5.2 Gage Output Files  \nThe gage output files can be found in the solution folder in the Project Explorer.  \n1. Expand the \u201c  Gage Files\u201d folder under the \u201c  TwoLakes (MODFLOW)\u201d \nsolution.  \n2. Double -click on the \u201c  start_Blue_Creek.gag\u201d file  (or right -click on the file and \nselect View File ) to bring up the View Data File  dialog.  \n3. If you have previously turned on the Never ask this again option in this dialog, \nthis dialog will not appear. Skip to step 6.  \n4. Select the desired text editor from the Open with  drop-down.  \n5. Click OK to close the View Data File  dialog and open the gage output file in the \ndesired text editor.  \nThe gage output file shows columns for time, stage, and flow ( Figure 4).  \n6. Scroll through the text file that opens, noticing the change in the Flow  column.  \nFor this stream, the flow rate drops by about 30 percent during the time of below -normal \nprecipitation.  \n \n      Figure 4      Gage output file for Blue Creek  \n7. Double -click on the \u201c  start_Clear_Creek.gag\u201d file in the Project Explorer and \nrepeat Steps 3 -5 \nThis stream shows a less significant change in flow r ate. If desired, check the gage \noutput for the other three gage stations as well.  \n8. Close the open gage files and return to GMS.  \n5.3 Creating a Gage Plot  \nPlots can be generated in GMS from solution gage files.  \n1. Click Plot Wizard   to bring up the Step 1 of 2  page of the Plot Wizard  dialog.  \n2. In the Plot Type  section, select Gage Package Value vs. Time  from the list on the \nleft. \n3. Click Next >  to go to the Step 2 of 2  page of the Plot Wizard  dialog.  \n4. In the Gage file  list, select \u201cBlue_Creek\u201d.  \n\nGMS Tutorials   MODFLOW \u2013 Gage Package  \n \n Page 8 of 8 \u00a9 Aquaveo 2024  5. In the Data column  list, select \u201cFlow\u201d.  \n6. Click Finish  to close the Plot Wizard  dialog.  \nThe generated plot is shown in Figure 5. The plot shows that the flow rate drops rapi dly \nfor this stream as the period with less precipitation begins and then recovers to near the \ninitial flow rate during the final year.  \n \n      Figure 5      Gage plot for Blue Creek  \n6 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 GAGE Package\u201d tutorial. The following key concepts \nwere discussed and demonstrated:  \n\uf0b7 GMS supports the MODFLOW GAGE package.  \n\uf0b7 Gages are entered in the Gage Package  dialog.  \n\uf0b7 Gage output text files can be viewed by opening them from the Project Explorer . \n\uf0b7 Gage plots can be generated using the Plot Wizard  dialog.  \n \n\n", "filename": "MODFLOW-GAGEPackage.pdf", "pages": 8}, "MODFLOW-GeneratingDataFromSolids": {"text": "GMS Tutorials   MODFLOW \u2013 Generating Data from Solids  \n Page 1 of 20 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Generating Data from Solids  \nUsing solid models to represent complex stratigraphy with MODFLOW  \nObjectives   \nLearn the steps necessary  to convert solid models to MODFLOW data on a 3D grid, and adjust elevations \nassociated with the grid to match the elevations defined by the solid models.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach I  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 Subsurface  Time  \n\uf0b7 40\u201360 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 Generating Data from Solids  \n Page 2 of 20 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  3 \n2 Importing the Solids  ................................ ................................ ................................ ............  4 \n3 Boundary Matching Versus Grid Overlay  ................................ ................................ ..........  4 \n3.1 Boundary Matching  ................................ ................................ ................................ ....... 5 \n3.2 Grid Overlay ................................ ................................ ................................ ..................  6 \n3.3 Grid Overlay with K Equivalent  ................................ ................................ .....................  6 \n4 Solids \u2192 MODFLOW Using Grid Overlay  ................................ ................................ ..........  6 \n4.1 Displaying the 3D Grid  ................................ ................................ ................................ .. 6 \n4.2 Initializing MODFLOW  ................................ ................................ ................................ .. 7 \n4.3 Activating Cells  ................................ ................................ ................................ .............  7 \n4.4 Solids \u2192 MODFLOW  ................................ ................................ ................................ .... 8 \n4.5 Viewing the Grid  ................................ ................................ ................................ ...........  8 \n5 Solids  \u2192 MODFLOW Using Boundary Matching  ................................ ............................  10 \n5.1 Layer Ranges  ................................ ................................ ................................ .............  10 \n5.2 Assigning Layers to Solids  ................................ ................................ ..........................  11 \n5.3 Solids \u2192 MODFLOW  ................................ ................................ ................................ .. 12 \n6 Viewing the Grid  ................................ ................................ ................................ ................  12 \n7 Thin Cells  ................................ ................................ ................................ ...........................  13 \n7.1 Assigning Minimum Thickness ................................ ................................ ....................  13 \n7.2 Top Cell Bias  ................................ ................................ ................................ ..............  13 \n8 Converting the Conceptual Model ................................ ................................ ....................  14 \n8.1 Using Materials to Define Hydraulic Conductivity  ................................ .......................  15 \n9 Running MODFLOW and Viewing the Solution  ................................ ...............................  15 \n10 Solids \u2192 HUF ................................ ................................ ................................ .....................  16 \n10.1  Selecting the HUF Package  ................................ ................................ ........................  17 \n10.2  Converting the Solids to HUF Data  ................................ ................................ .............  17 \n10.3  Viewing the HUF Data  ................................ ................................ ................................  18 \n10.4  Converting the Conceptual Model  ................................ ................................ ...............  19 \n10.5  Running MODFLOW  ................................ ................................ ................................ ... 19 \n11 Conclusion  ................................ ................................ ................................ .........................  20 \n \n1 Introduction  \nComplex stratigraphy can be difficult to simulate in MODFLOW models. MODFLOW uses \na structured grid that requires each grid layer to be continuous throughout the model \ndomain. This makes it difficult to explicitly represent common features such as pinchout s \nand embedded seams in a MODFLOW model.  \nSolid models can be used to represent arbitrarily complex stratigraphy. Figure 1 shows  a \ncross section through a solid model where different stratigraphic units pinch out. \nDesigning a MODFLOW compatible grid for this type of stratigraphy is very difficult.  \nThis tutorial covers the steps necessary to convert solid models ( Figure 1) to MODFLOW \ndata. The elevations associated with the finite -difference grid will be adjusted to match \nthe elevations defined by the solid models. The material assigned to each g rid cell will be \ninherited from the solid encompassing the cell. Figure 2 shows a MODFLOW compatible \ngrid of the cross section shown in Figure 1. \nGMS Tutorials   MODFLOW \u2013 Generating Data from Solids  \n \n Page 3 of 20 \u00a9 Aquaveo 2024   \n      Figure 1      Cross section through a solid model  \nOne of the main benefits of using solid models to define stratigraphy for MODFLOW \nmodels is that it provi des a grid -independent definition of the layer elevations that can be \nused to immediately re -create the MODFLOW grid geometry after any change to the grid \nresolution. Solid models of stratigraphy can be easily created in GMS using the \u201chorizons \napproach\u201d. The tutorial entitled \u201c Stratigraphy Modeling \u2013 Horizons and Solids \u201d explains \nhow to create solid models using GMS.  \n \n      Figure 2      Finite difference grid with elevations and materials inherited from the solid model  \nThis tutor ial discusses and demonstrates opening a file containing solids data, using the \nSolids \u2192 MODFLOW  command with the Grid Overlay  and Boundary Matching  options, \nassigning grid layers to the solids, fixing problems associated with thin cells, converting \nthe co nceptual model to MODFLOW and running MODFLOW, converting the solids to \nHUF data, and converting the conceptual model again and running MODFLOW.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state. Click Don\u2019t Save  if asked to save changes.  \n\nGMS Tutorials   MODFLOW \u2013 Generating Data from Solids  \n \n Page 4 of 20 \u00a9 Aquaveo 2024  2 Importing the Solids  \nFirst, import a file containing a set of solids for the site being modeled:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the sol2mf \\sol2mf  directory and select \u201c start.gpr\u201d. \n4. Click Open to import the file and close the Open  dialog.  \nThe imported cross sections show the stratigraphy for the exam ple site ( Figure 3). \n \n      Figure 3      Initial view after opening the project  \nThere are five different solids in this project file. There  are two main units labeled \nupper_aquifer (green) and lower_aquifer (red). There are two silty -clay (blue) units inside \nof the upper_aquifer, and there is a clay (yellow) unit between the upper_aquifer and \nlower_aquifer.  \n3 Boundary Matching Versus Grid Overl ay \nThere are three options when using the Solids \u2192 MODFLOW  command: the Boundary \nMatching  option, the Grid Overlay  option, and the Grid Overlay with K Equivalent  option \n(Figure 4). \n\nGMS Tutorials   MODFLOW \u2013 Generating Data from Solids  \n \n Page 5 of 20 \u00a9 Aquaveo 2024   \n      Figure 4      Solids \u2192 MODFLOW options illustrated (side view)  \n3.1 Boundary Matching  \nWith the Boundary Matching  option, the top and bottom of the grid are deformed to match \nthe tops and bottoms of the solids. The interior grid layers are also deformed to match the \nboundaries of the solids. The grid cell materials are set to match the material of the solid \nof the gr id cell center.  \nThis option results in a close fit between the grid and the solids, but it can result in thin \ncells which can cause stability problems or dry cell issues when running MODFLOW. \nThis option requires determining which grid layers should be ass ociated with which \nsolids.  \nBoundary Matching  \nGrid Overlay  \nSolids  \n Grid \nGrid Overlay with  \nK Equivalent  \nGMS Tutorials   MODFLOW \u2013 Generating Data from Solids  \n \n Page 6 of 20 \u00a9 Aquaveo 2024  3.2 Grid Overlay  \nThe Grid Overlay  option deforms the top and bottom of the grid to match the tops and \nbottoms of the solids. The interior grid layer boundaries are deformed to be evenly \nspaced between the top and bottom of the grid u sing a simple linear interpolation. The \ninterior grid layers are not changed to match the solid boundaries. As with the Boundary \nMatching  option, the grid cell materials are set to match the material of the solid of the \ngrid cell center.  \nThis option does n ot result in as close a fit between the grid and the solids as the \nboundary matching option, but it may avoid the thin cell problems associated with the \nBoundary Matching  option. The Grid Overlay  option does not require assigning grid layer \nranges to each solid.  \n3.3 Grid Overlay with K Equivalent  \nThis option is very similar to the  Grid Overlay  option. One of the problems with the Grid \nOverlay  option is that if there is a relatively thin layer in the solids and the layer does not \nhappen to encompass any cell cen ters or it encompasses few cell centers, the layer will \nbe under -represented in the MODFLOW grid. This becomes particularly important if the \nlayer is meant to represent a low permeability layer. For such cases, the  Grid Overlay \nwith K Equivalent  (or Grid O verlay with Keq ) option may give superior results.  \nThe Grid Overlay with Keq  method is identical to the  Grid Overlay  method in terms of \nhow the elevations of the grid cells are defined. The two methods differ in how the \nmaterial properties are assigned. R ather than simply assigning materials based on which \nsolid encompasses the cell centers, the Keq method attempts to compute a custom \nKh and Kv value for each cell.  \nWhen assigning the material properties to a cell, GMS computes the length of each solid \nin the cell (from a vertical line at the cell center that intersects the solids) and computes \nan equivalent Kh, Kv, and storage coefficient for the cell that takes  into account  each of \nthe solids in the cell. Thus, the effect of a thin seam in a cell would be included in the \nKh and Kv values for the cell.  \n4 Solids \u2192 MODFLOW Using Grid Overlay  \nThis tutorial will first examine the Grid Overlay  option. With this option, all t hat is needed \nare a set of solids and a grid in the same location.  \n4.1 Displaying the 3D Grid  \nThe grid was imported as part of the project, but the display of the grid cells was turned \noff. To turn it back on, do the following:  \n1. In the Project Explorer , turn on  the \u201c  3D Grid Data \u201d folder.  \n2. Expand the \u201c  3D Grid Data \u201d folder by clicking on the plus symbol next to it.  \n3. Turn on the \u201c  grid\u201d item within that folder.  \nThe 3D grid should now be visible ( Figure 5). \n\nGMS Tutorials   MODFLOW \u2013 Generating Data from Solids  \n \n Page 7 of 20 \u00a9 Aquaveo 2024   \n      Figure 5      Initial view with 3D grid visible  \n4.2 Initializing MODFLOW  \nIt is necessary to initialize MODFLOW before executing the Solids \u2192 MODFLOW  menu \ncomman d. \n1. Right -click on \u201c  grid\u201d and select New MODFLOW\u2026  to bring up the MODFLOW \nGlobal/Basic Package  dialog.  \n2. Click OK to accept the defaults and close the MODFLOW Global/Basic Package  \ndialog .  \nNormally, the starting heads would be set here. Since they are set to be equal to the grid \ntop elevation (300) by default, there is no need to do so in this case.  \n4.3 Activating Cells  \nIt is necessary to inactivate the cells outside the model domain.  \n1. In the Project Explorer , select the \u201c  Map Data \u201d folder to make it active.  \n2. Select Feature Objects | Activate Cells in Coverage(s) . \nThe cells outside the model domain will disappear ( Figure 6). \n\nGMS Tutorials   MODFLOW \u2013 Generating Data from Solids  \n \n Page 8 of 20 \u00a9 Aquaveo 2024   \n      Figure 6      3D grid showing only active cells  \n4.4 Solids \u2192 MODFLOW  \n1. In the Project Explorer , select the \u201c  Solid Data \u201d folder to make it active.  \n2. Select the Select Solids   tool.  \nNotice that labels for each so lid appear ( Figure 7). \n3. Select Solids  | Solids \u2192 MODFLOW \u2026 to bring up the Solids \u2192MODFLOW  \ndialog.  \n4. Select Grid Overlay  under Solids \u2192MODFLOW Mode . \n5. Click OK to close the Solids \u2192MODFLOW  dialog and execute the deformation.  \nThe deformation  may take a few moments to complete. The 3D grid should appear \ndeformed to match the top and bottom of the solids ( Figure 7).  \n \n      Figure 7      The 3D grid has been deformed  \n4.5 Viewing the Grid  \nDo the following to examine the grid:  \n1. Click Display Options   to bring up the Display Options  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Generating Data from Solids  \n \n Page 9 of 20 \u00a9 Aquaveo 2024  2. Select \u201c  3D Grid Data \u201d from the list on the left.  \n3. On the 3D Grid  tab, turn on Cell faces . \n4. Click OK to close the Display Options  dialog.  \n5. Select the \u201c  3D Grid Data \u201d folder to make it active.  \nNotice that the solid cross sections are now mostly obscured from view by the grid, but \nare still poking out in places. Looking closely, notice that the top of the grid matches the \ntop of the solid cross sections quite well. The grid and cross sections sho uld appear as \nshown in Figure 8. \n \n      Figure 8      After executing Solids \u2192 MODFLOW using grid overlay  \nDo to the following to look at the grid from the side:  \n6. Switch to Ortho Mode  . \n7. Using the Select Cells   tool, select a cell somewhere near the middle of the \ngrid. \n8. Switch to Front View  . \nThe solid cross sections are in front of the grid row.  \n9. In the Project Explorer , turn off the \u201c  Solid Da ta\u201d folder.  \n10. In the Mini Grid Toolbar,  use the arrow buttons  to view the grid along different \nrows.  \nThe grid at row 14 should appear similar to Figure 9. \n \n      Figure 9      Grid row 14 after Solids \u2192 MODFLOW using grid overlay  \n\nGMS Tutorials   MODFLOW \u2013 Generating Data from Solids  \n \n Page 10 of 20 \u00a9 Aquaveo 2024  Feel free to continue reviewing the MODFLOW model at this point before moving on.  \n5 Solids  \u2192 MODFLOW Using Boundary Matching  \nThe Boundary Matching  option results in a close fit between the solid boundaries and the \ngrid layer, but it requires a bit more work.  \n5.1 Layer Ranges  \nIt is necessary to assign a layer range to each of the solids  before conve rting the solids to \nMODFLOW data using the Boundary Matching  option. The layer range represents the \nconsecutive sequence of layer numbers in the MODFLOW grid that should coincide with \nthe solid model.  \nA sample set of layer range assignments is shown in Figure 10. The first example, (a), is \na case where each solid is continuous through the model domain with no pinchouts. Each \nof the solids is given a layer range defined  by a beginning and ending grid layer number. \nThe resulting MODFLOW grid is shown in Figure 10(b). \n A. Layers 1 -2 \nB. Layer 3 -5 \nC. Layers 6 -7 \n(a) \n(b) \n \n      Figure 10      (a) A set of simple solids with grid layer assignments  \n  (b) The MODFLOW grid resulting from the layer assignments  \nA more complex case with pinchouts is illustrated in Figure 11(a). Solid A is given the \nlayer range 1 \u20134, and the enclosed pinchout (solid B) is given the layer range 2 \u20132. The set \nof grid layers within the defined range that are actually overlapped by the solid may \nchange from location to location. The  layer range represents the set of grid layers \npotentially overlapped by the solid anywhere in the model domain.  \nFor example, on the left side of the problem shown in Figure 11(a), solid A  covers grid \nlayers 1, 2, 3 and 4. On the right side of the model, solid A is associated with grid layers \n1, 3 and 4 since the enclosed solid (solid B) is associated with layer 2. Likewise, Solid C \nis associated with grid layers 5 and 6 on the left side of  the model but only with layer 6 on \nGMS Tutorials   MODFLOW \u2013 Generating Data from Solids  \n \n Page 11 of 20 \u00a9 Aquaveo 2024  the right side of the model where solid D is associated with layer 5. The resulting \nMODFLOW grid is shown in (b).  \n \n(a) \n(b) A. Layers 1 -4 \nB. Layers 2 -2 \nD. Layers 5 -5 C. Layers 5 -6 \n1 \n2 \n3 \n4 \n5 \n6 \n \n      Figure 11      (a) Grid layer assignments for a set of solids with pinchouts  \n  (b) The MODFLOW grid resulting from the layer assignments  \nWhen assigning layer ranges to solids, care must be taken to define associations that are \ntopologically sound. For example, since solid B in Figure 11(a) is enclosed by solid A, \nsolid B could not be assigned a layer range that is outside the layer range of solid A.  \n5.2 Assigning Layers to Solids  \nNow it is possible to assign the grid lay ers to the solids. Figure 12 is a cross section \nthrough the site. Notice that the project must have a minimum of five grid layers in order \nto represent all of the lay ers present in this cross section. In this case, the upper_aquifer \n(green) will be assigned to layers 1 \u20133. The silty -clay (blue) will be assigned to layer 2. \nThe clay (yellow) will be assigned to layer 4, and the lower_aquifer (red) will be assigned \nlayers  4\u20135. \nGMS Tutorials   MODFLOW \u2013 Generating Data from Solids  \n \n Page 12 of 20 \u00a9 Aquaveo 2024   \n      Figure 12      Cross section through the model domain  \n1. In the Project Explorer , expand the \u201c  Solid Data \u201d folder if necessary.  \n2. Double -click on \u201c  upper_aquifer 1 \u201d in the Project Explorer  to bring up the \nProperties dialog.  \n3. Enter \u201c1\u201d for Begin Layer and \u201c3\u201d for End Layer.  \n4. Click OK to close the Properties dialog.  \n5. Repeat steps 2 \u20134 for the remaining solids, using the values shown in the \nfollowing table.  \n upper_aquifer 1  lower_aquifer 2  clay 3  silty-clay 4  silty-clay 5  \nBegin layer  1 4 4 2 2 \nEnd layer  3 5 4 2 2 \n5.3 Solids \u2192 MODFLOW  \n1. Select Solids  | Solids \u2192 MODFLOW\u2026  to bring up the Solids \u2192 MODFLOW  \ndialog.  \n2. Under Solids \u2192 MODFLOW Mode , select Boundary Matching . \n3. Click OK to close the Solids \u2192 MODFLOW  dialog and initiate the conversion.  \nThe Solids \u2192 MODFLOW \u2026 command may take a few moments to complete.  \n6 Viewing the Grid  \nSee how the grid has changed by doing the following:  \n1. Select the \u201c  3D Grid Data \u201d folder to make it active.  \n2. Switch to Plan View . \n3. Turn o n Ortho Mode  . \n4. Using the Select Cells   tool, select a cell somewhere near the middle of the \ngrid. \n\nGMS Tutorials   MODFLOW \u2013 Generating Data from Solids  \n \n Page 13 of 20 \u00a9 Aquaveo 2024  5. Switch to Front View  . \n6. Use the arrow buttons  in the Mini Grid Toolbar,  to view row 30 ( Figure 13). \n \n      Figure 13      Row 30  of grid after Solids \u2192 MODFLOW using boundary matching  \nNotice that the second layer has both silty -clay (blue) and upper_aquifer  (green) \nmaterials assigned to it.  \n7. Use the arrow buttons  to view the grid along different rows.  \n8. Switch to Side View  . \n9. Use the arrow buttons  in the Mini -Grid Toolbar to view  the grid along different \ncolumns.  \n10. Switch back to Front View  .  \n7 Thin Cells  \nThe purpose of boundary matching is to ensure that each upper and lower boundary \ndefined by the solid model is precisely matched by a layer boundary in the MODFLOW \ngrid. As a result of this approach, thin cells often occur where solids pinchout. Notice the \nthin cells on the edges of the clay (yellow) and silty -clay (blue) solids in Figure 13. If \nwanting to limit the effect of the thin cells in the model grid, set a  minimu m target \nthickness for each of the solids.  \n7.1 Assigning Minimum Thickness  \nTo limit the thin cells in the model, do the following:  \n1. Double -click on the \u201c  upper aquifer 1 \u201d solid in the Project Explorer  to bring up \nthe Properties  dialog . \n2. Enter \u201c20.0\u201d (ft) for Target min. cell thickness . \n3. Click OK to exit the Properties  dialog.  \n4. Repeat steps 1 \u20133 for each of the remaining solids.  \n7.2 Top Cell Bias  \nAnother problem that may occur with boundary matching is that the cells in the top layer \nof the grid may be too thin and subj ect to wetting and drying. To ensure that the top layer \nof the grid is sufficiently thick, do the following:  \n1. Double -click on the \u201c  upper_aquifer 1 \u201d solid in the Project Explorer  to bring up \nthe Properties dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Generating Data from Solids  \n \n Page 14 of 20 \u00a9 Aquaveo 2024  2. Select \u201cYes\u201d from the Use top cell bias  drop-down.  \n3. Click OK to exit the Properties dialog.  \n4. Select Solids | Solids \u2192 MODFLOW \u2026 to bring up the Solids \u2192 MODFLOW  \ndialog.  \n5. Select OK to close the Solids \u2192 MODFLOW  dialog  and execute the Solids \u2192 \nMODFLOW  menu command.  \n \nFigure 14      Row 30 of the model grid using target minimum thickness and top cell bias  \nThe grid should now look similar to Figure 14. Notice how the top row is thicker, and  the \nthin cells in the yellow and blue areas are now thicker.  \n8 Converting the Conceptual Model  \nIt is now possible to finish developing the MODFLOW model. In the interest of time, the \nconceptual model has already been built. It was imported with the project file. For more \ninformation on conceptual models, refer to the \u201c MODFLOW \u2013 Conceptual Model \nApproach \u201d tutorial.  \n1. In the Project Explorer , select the \u201c  Map Data \u201d folder to make it active.  \n2. Switch to Plan View  . \n3. Select Feature Objects | Map \u2192 MODFLOW  to bring up the Map \u2192 M odel \ndialog.  \n4. Select All applicable coverages  and click OK to close the Map \u2192 M odel dialog.  \nThe grid should appear similar to Figure 15. \n\nGMS Tutorials   MODFLOW \u2013 Generating Data from Solids  \n \n Page 15 of 20 \u00a9 Aquaveo 2024   \n      Figure 15      Plan view after map converted to MODFLOW  \n8.1 Using Materials to Define Hydraulic Conductivity  \nNext, set the option for MODFLOW to use the material assigned to the grid cell to define \nthe hydraulic conductivity for the cell. \n1. Select MODFLOW  | LPF \u2013 Layer Property Flow\u2026  to bring up the LPF Package \ndialog.  \n2. In the Layer property entry method section, select Use material IDs . \n3. In the Layer data section, click Material Properties \u2026 to bring up the Materials \ndialog.  \n4. On the MODFLOW  tab, for each material, enter the values for the properties \nshown in the table below:  \nMaterial Name  Horizontal k  \n(ft/d)  Vert. anisotropy \n(Kh/Kv)  \nupper_aqufier  15.0 3.0 \nlower_aquifer  30.0 3.0 \nclay 0.5 3.0 \nsilty-clay 1.0 3.0 \n5. Click OK to exit the Materials dialog.  \n6. Click OK to exit the LPF Package dialog.  \n9 Running MODFLOW and Viewing the Solution  \nIt is now possible to run MODFLOW. Before doing so, save the MODFLOW simulation.  \n\nGMS Tutorials   MODFLOW \u2013 Generating Data from Solids  \n \n Page 16 of 20 \u00a9 Aquaveo 2024  1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as typ e drop-down.  \n3. Enter \u201c run1_lpf.gpr \u201d as the File name . \n4. Click Save  to save the file and close the Save As  dialog . \n5. Select MODFLOW  | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n6. When MODFLOW has finished r unning, turn on Read solution on exit  and Turn \non contours (if not on already) . \n7. Click Close  to close the MODFLOW  model wrapper dialog and import the \nMODFLOW solution.  \n8. Click Display Options   to bring up the Display Options  dialog.  \n9. Select \u201c  3D Grid Data \u201d from the list on the left.  \n10. On the 3D Grid  tab, turn off Cell faces . \n11. Click OK to exit the Display Options  dialog.  \nThe head contours are visible on the grid ( Figure 16). If desired, cycle through the layers \nto see how the head contours change within the different layers. Switch to Side View   \nto see the contours on the rows or columns.  \n \n      Figure 16      MODFLOW solution with contours visible  \n10 Solids \u2192 HUF \nNow use the HUF package in MODFLOW  to define the hydraulic properties of the grid \ncells instead of the LPF package. This package is designed to represent complex \nstratigraphic r elationships in a grid independent fashion.  \n\nGMS Tutorials   MODFLOW \u2013 Generating Data from Solids  \n \n Page 17 of 20 \u00a9 Aquaveo 2024  The hydrostratigraphy is represented using a set of hydrogeologic units. Each unit is \ndefined by two arrays: one for the top elevation and one for the thickness. The thickness \nvalues can be set to zero in regions  of the model where the unit is not present. When \nMODFLOW is executed, each cell is compared to the corresponding unit elevation arrays \nand equivalent hydraulic properties are assigned to the cell. Figure 17 shows an example \nof HUF units on a MODFLOW grid.  \n \n       Figure 17      HUF data  \n10.1 Selecting the HUF Package  \nFirst, select the HUF package as the flow package.  \n1. Select MODFLOW  | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage dialog.  \n2. Click Packages \u2026 to bring up the MODFLOW Packages  / Processes  dialog.  \n3. In the Flow package  section select HUF \u2013 Hydrogeologic Unit Flow . \n4. Click OK to exit the MODFLOW Packages  / Processes  dialog.  \n5. Click OK to exit the MODFLOW Global/Basic Package dialog.  \n10.2 Converting the Solids to HUF Data  \nIt is now possible to convert the solids to HUF data. However when the Solids \u2192 \nMODFLOW  command ran, some of the cells were inactivated in layers 4 and 5. It is \nnecessary for those cells to be active for this new model.  \n1. In the Project Explorer , select the \u201c  Map Data \u201d folder to make it active.  \n2. Select Feature Objects | Activate Cells in Coverage(s) . \n3. In the Project Explorer , select the  \u201c Solid Data \u201d folder to make it active.  \n4. Select Solids  | Solids \u2192 HUF\u2026 to bring up the Solids \u2192 HUF  dialog.  \n5. Turn on Adjust grid cell elevations . \nThe MODFLOW top elevation array of the top layer and the bottom elevation array of the \nbottom layer are adjusted to match the tops and bottoms of all the solids. The interior top \nand bottom elevation arrays are assigned based on the proportions entered in the \n\nGMS Tutorials   MODFLOW \u2013 Generating Data from Solids  \n \n Page 18 of 20 \u00a9 Aquaveo 2024  Elevation bias  spreadsheet. The entire grid depth for each grid column is distributed \naccording to the entries in the spreadsheet for each layer.  \n6. In the Elevation bias  spreadsheet, enter \u201c 0.4\u201d in the Fraction  column of row 1. \n7. Click OK to execute the Solids \u2192 HUF command and close the Solids \u2192 HUF  \ndialog.  \n10.3 Viewing the HUF Data  \nTo view the HUF data, do the following:  \n1. In the Project Explorer , select the \u201c  3D Grid Data \u201d folder to make it active.  \n2. Click Display Options   to bring up the Display Options dialog . \n3. Select \u201c3D Grid Data\u201d from the list on the left.  \n4. On the 3D Grid  tab, select \u201cSpecified\u201d from the Color  drop-down under Cell \nedges . \n5. On the MODFLOW   tab, turn on Hydrogeologic units . \n6. Click OK to exit the Display Options dialog.  \n7. Switch to Plan View  . \nThe display should appear similar to Figure 18. \n \n      Figure 18      The HUF data is now visible  \n8. Using the Select Cells   tool, select  a cell somewhere in the middle of the grid.  \n9. Switch to Front View  . \n10. Use the arrow buttons  in the Mini -Grid Toolbar to view  the grid along different \ncolumns ( Figure 19). \n\nGMS Tutorials   MODFLOW \u2013 Generating Data from Solids  \n \n Page 19 of 20 \u00a9 Aquaveo 2024   \n      Figure 19      HUF data visible in front view  \n10.4 Converting the Conceptual Model  \nIt is necessary to convert the conceptual model again to ensure that any cells that were \ninactive will have the correct boundary conditions.  \n1. Switch to Plan View  . \n2. In the Project Explorer , select the \u201c  Map Data \u201d folder to make it active.  \n3. Expand the \u201c  Map Data \u201d folder by clicking on the plus symbol next to it.  \n4. Right-click on the \u201c  MODFLOW \u201d conceptual model and select Properties \u2026 \nfrom the menu to bring up the Conceptual Model Properties dialog.  \n5. Select \u201c HUF\u201d from the Flow package  drop-down .  \n6. Click OK to exit the Conceptual Model Properties dialog.  \n7. Select Feature Objects | Map \u2192 MODFLOW  to bring up the Map \u2192 Model \ndialog.  \n8. Select All applicable coverages  and click OK to execute the Map \u2192 MODFLOW  \ncommand and close the Map \u2192 Model dialog.  \n10.5 Running MODFLOW  \nIt is now possible to save the project and run MODFLOW.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c run1_huf .gpr\u201d as the File na me. \n4. Click Save  to save the project and close the Save As  dialog.  \n5. Select MODFLOW  | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n6. When MODFLOW has finished running, tur n on Read solution on exit  and Turn \non contours (if not on already).  \n7. Click Close  to close the MODFLOW  model wrapper dialog and import the \nMODFLOW solution.  \n\nGMS Tutorials   MODFLOW \u2013 Generating Data from Solids  \n \n Page 20 of 20 \u00a9 Aquaveo 2024  The head contours are visible on the grid (       Figure 20). Some red triangles may appear \non certain grid cells. These cells have gone dry (the water table is below the bottom of \nthe cell) in this simulation. Cycle through the layers to see how the head contours change \nwithin the different layers. It is also possible to switch into side view to see the contours \non the rows or columns.  \n \n      Figure 20      Head contours of the HUF data after MODFLOW is run  \n11 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 Generating Data from Solids\u201d tutorial. The following \nconcepts were discussed and demonstrated:  \n\uf0b7 Solids can be used to define the MODFLOW layer elevations. They can also be \nused to create MODFLOW HUF data.  \n\uf0b7 It is necessary to assign l ayer ranges to the solids before using them to create a \nlayered grid if using the Solids \u2192 MODFLOW  Boundary Matching  option.  \n\uf0b7 It is possible to use a minimum thickness to avoid thin cells. It is also possible to \nspecify a top cell bias to make the top grid layer thicker.  \n\uf0b7 If using solids to define the MODFLOW layer data, it is probably best to use the \nMaterial IDs approach to define the hydraulic properties of grid cells based on \ntheir material.  \n \n\n", "filename": "MODFLOW-GeneratingDataFromSolids.pdf", "pages": 20}, "MODFLOW-GridApproach": {"text": "GMS Tutorials   MODFLOW \u2013 Grid Approach  \n Page 1 of 18 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Grid Approach  \nAn introduction to GMS  \n \nObjectives   \nThe grid approach to MODFLOW pre -processing is described in this tutorial. In most cases, the \nconceptual model approach is more powerful than the grid approach. However, the grid approach is \nuseful for simple problems or academic exercises where cell -by-cell editing is necessary.  \n \nPrerequisite Tutorials  \n\uf0b7 None  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 35\u201355 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 Grid Approach  \n Page 2 of 18 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  3 \n2 Units ................................ ................................ ................................ ................................ ...... 3 \n3 Creating the Grid  ................................ ................................ ................................ .................  4 \n4 Creating the MODFLOW Simulation ................................ ................................ ...................  4 \n4.1 Packages  ................................ ................................ ................................ ......................  4 \n4.2 The IBOUND Array  ................................ ................................ ................................ ....... 5 \n4.3 Top and Bottom Elevations  ................................ ................................ ...........................  5 \n4.4 Starting Heads  ................................ ................................ ................................ ..............  6 \n5 Assigning IBOUND Values Directly to Cells  ................................ ................................ ...... 6 \n5.1 Viewing the Left Column  ................................ ................................ ...............................  6 \n5.2 Selecting the Cells  ................................ ................................ ................................ ........  6 \n5.3 Changing the IBOUND Value  ................................ ................................ .......................  7 \n5.4  Checking the Values  ................................ ................................ ................................ ..... 7 \n6 The LPF Package  ................................ ................................ ................................ .................  8 \n6.1 Top Layer  ................................ ................................ ................................ .....................  8 \n6.2 Middle Layer  ................................ ................................ ................................ .................  8 \n6.3 Bottom Layer  ................................ ................................ ................................ ................  9 \n7 The Recharge Package  ................................ ................................ ................................ ....... 9 \n8 The Drain Package ................................ ................................ ................................ ...............  9 \n9 The Well  Package  ................................ ................................ ................................ ..............  11 \n9.1 Top Layer Wells  ................................ ................................ ................................ ..........  11 \n9.2 Middle Layer Wells  ................................ ................................ ................................ ..... 12 \n9.3 Bottom Layer Wells  ................................ ................................ ................................ ..... 13 \n10 Checking and Saving the Simulation  ................................ ................................ ...............  14 \n11 Running MODFLOW  ................................ ................................ ................................ ..........  15 \n12 Viewing the Solution  ................................ ................................ ................................ .........  15 \n12.1  Changing Layers  ................................ ................................ ................................ .........  16 \n12.2  Color Fill Contours and Color Legend  ................................ ................................ .........  16 \n13 Zone Budget  ................................ ................................ ................................ .......................  17 \n13.1  Assigning Zone Budget IDs  ................................ ................................ ........................  17 \n13.2  Viewing the Zone Budget Report  ................................ ................................ ................  18 \n14 Conclusion  ................................ ................................ ................................ .........................  18 \n \n1 Introduction  \nTwo approaches can be used to construct a MODFLOW simulation in GMS: the grid \napproach and the conceptual model approach. The grid approach involves working \ndirectly with the 3D grid to apply sources/sinks and other model parameters on a cell -by-\ncell basis . The conceptual model approach involves using the GIS tools in the Map \nmodule to develop a conceptual model of the site being modeled. The data in the \nconceptual model are then copied to the grid. The grid approach to MODFLOW pre -\nprocessing is described in this tutorial.  \nIn most cases, the conceptual model approach is more e fficient than the grid approach. \nHowever, the grid approach is useful for simple problems or academic exercises where \ncell-by-cell editing is necessary. Completing this tutorial is not required before beginning \nthe conceptual model tutorials.  \nThis tutorial  uses a modified version of the sample problem ( Figure 1) described near the \nend of the MODFLOW  Reference Manual . Three aquifers will be simulated using three \nlayers in the computational grid. The grid covers a square region measuring 75000 feet \nby 75000 feet.  \nThe grid will consist of 15 rows and 15 columns, each cell measuring 5000 feet by 5000 \nfeet in plan view. For simplicity, the elevation of the top and bottom of  each layer will be \nflat. The hydraulic conductivity values shown are for the horizontal direction. For the \nvertical direction, the tutorial will use some fraction of the horizontal hydraulic \nconductivity.  \nGMS Tutorials   MODFLOW \u2013 Grid Approach  \n \n Page 3 of 18 \u00a9 Aquaveo 2024  Flow into the system is due to infiltration from p recipitation and is defined as recharge in \nthe input. Flow out of the system is due to buried drain tubes, discharging wells (not \nshown on the diagram), and a lake, which is represented by a constant head boundary \non the left. Starting heads will be set eq ual to zero, and a steady state solution will be \ncomputed.  \n \nUnconfined  \nConfined  \nConfined  Const Head = 0 m  \nin column 1 of  \nlayers 1 & 2  Drain  \nLayer 1 : K = 15 m/d, top elev. = 60 m, bot elev. = -45 m \nLayer 2 : K = 0.9 m/d, top elev. = -45 m, bot elev. = -120 m \nLayer 3 : K = 2 m/d, top elev. = -120 m, bot elev. = -215 m Recharge = 0.0009 m/d  \n \n       Figure 1      Sample problem to be solved  \nThis tutorial discusses and demonstrates the following:  \n\uf0b7 Creating a 3D grid  \n\uf0b7 Setting up a MOD FLOW simulation  \n\uf0b7 Checking the simulation and running MODFLOW  \n\uf0b7 Assigning zone budgets  \n\uf0b7 Viewing the report  \n1.1 Getting Started  \nDo as follows to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New command to ensure that the program \nsettings are restored to their default state.  \n2 Units  \nFirst, define the units used in the model. The units chosen will be applied to edit fields in \nthe GMS interface as a reminder of the proper units for each parameter.  \n1. Select Edit | Units\u2026  to bring up the Units  dialog.  \n2. Click the  button next to the Length  field to bring up the Display Projection \ndialog.  \n3. Select \u201cMeters\u201d from the Units  drop-down in both the Horizontal  and Vertical  \nsections.  \n4. Click OK to close the Display Projection dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Grid Approach  \n \n Page 4 of 18 \u00a9 Aquaveo 2024  5. Select \u201cd\u201d (for days) from the Time  drop-down. Ignore the other units as they are \nnot used for flow simulations.  \n6. Click OK to exit the Units dialog.  \n3 Creating the Grid  \nThe first step in solving the problem is to create the 3D finit e difference grid.  \n1. In the Project Explorer,  right-click on the empty space and select New | 3D \nGrid\u2026  to bring up the Create Finite Difference Grid  dialog.  \n2. In both the X-dimension  and Y-dimension  sections , enter \u201c22860.0\u201d for Length  \nand \u201c15\u201d for Number cell s. \n3. In the Z-dimension  section , enter \u201c3\u201d for Number cells . \nThe top and bottom elevations will be entered later for each layer of the grid. Thus, the \nthickness of the cells in the z directions entered here will not affect the MODFLOW  \ncomputations.  \n4. Click OK to close the Create Finite Difference Grid  dialog.  \nThe grid should appear in the window in plan view. A simplified representation of the grid \nshould also appear in the Mini -Grid Toolbar (  Figure  2). \n \n        Figure 2      Mini-Grid toolbar  \n4 Creating the MODFLOW Simulation  \nThe next step is to initialize the MODFLOW simulation.  \n4.1 Packages  \n1. In the Project Explorer,  right-click on \u201c  grid\u201d and select New MODFLOW\u2026  to \nbring up the MODFLOW Global/Basic Package  dialog . \nFirst, select the packages. The input to MODFLOW  is subdivided into packages. Some of \nthe packages are optional and some are required. The Global and Basic packages are \nboth always required, and are therefore always active. There are no settings to turn them \non or off.  \n2. Click Packages\u2026  to bring up the MODFLOW Packages / Processes  dialog.  \nThis dialog specifies which of the optional packages will be used to set up the model. To \nselect the optional packages, do as follows:  \n3. In the Solver  section, select the SIP1 \u2013 Stongly Impl. Proc . \n4. In the Optional packages / processes  section, turn on DRN1 \u2013 Drain, RCH1 \u2013 \nRecharge , and WEL1 \u2013 Well. \n5. Click OK to exit the MODFLOW Packages / Processes  dialog.  \nDo not close the MODFLOW Global/Basic Package  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Grid Approach  \n \n Page 5 of 18 \u00a9 Aquaveo 2024  4.2 The IBOUND Array  \nThe next step is to set up the IBOUND array. The I BOUND array is used to designate \neach cell as either active (IBOUND > 0), inactive (IBOUND = 0), or constant head \n(IBOUND < 0). For this problem, all cells will be active, except for the first two layers in \nthe leftmost column, which will be designated as constant head.  \n1. Click IBOUND\u2026  to bring up the IBOUND Array  dialog.  \nThe values of the IBOUND array are displayed here in a spreadsheet -like fashion, one \nlayer at a time. The edit field in the upper left corner of the dialog can be used to change \nthe current layer. For this problem, all of the values in the array need to be greater than \nzero, except for the left column of the top two layers, which should be less than zero.  \nBy default, the values in the array should already be greater than zero. Therefore, \nchanging the values for the constant head cells is all that needs to be done. This can be \naccomplished by entering a value of \u201c -1\u201d for each of the thirty constant head cells.  \nHowever, there is another way to edit the IBOUND array that is much simpler for thi s \ncase. This method will be described later in the tutorial. For now, leave all of the cells \nactive.  \n2. Click Cancel  to exit the IBOUND Array  dialog.  \n4.3 Top and Bottom Elevations  \nThe next step is to set up the top and bottom elevation arrays.  \n1. Click Top Elevation \u2026 to bring up the Top Elevation  dialog.  \n2. Enter \u201c1\u201d for the Layer . \n3. Click Constant \u2192 Layer\u2026  to bring up the Layer Value dialog.  \n4. Enter \u201c60.0\u201d for the Constant value for layer , and click OK to close the Layer \nValue dialog.  \n5. Click OK to exit the Top Elevation  dialog.  \nGMS forces the top of a layer to be at the same location as the bottom of the layer above. \nThus, it is only necessary to enter the bottom elevations of all the layers now and the tops \nof the layers will be set automatically.  \n6. Click Bottom Elevation\u2026  to bring up the Bottom Elevation  dialog.  \n7. Enter \u201c1\u201d for the Layer . \n8. Click Constant \u2192 Layer\u2026  to bring up the Layer Value dialog.  \n9. Enter \u201c -45.0\u201d for the Constant value for layer , and click OK to close the Layer \nValue dialog.  \n10. Enter \u201c2\u201d for the Layer . \n11. Click Constant \u2192 Layer\u2026  to bring up the Layer Value dialog.  \n12. Enter \u201c -120.0\u201d for the Constant value for layer , and click OK to close the Layer \nValue dialog.  \n13. Enter \u201c3\u201d for the Layer . \n14. Click Constant \u2192 Layer\u2026  to bring up the Layer Value dialog.  \n15. Enter \u201c -215.0\u201d f or the Constant value for layer , and click OK to close the Layer \nValue dialog.  \n16. Click OK to exit the Bottom Elevation  dialog.  \nGMS Tutorials   MODFLOW \u2013 Grid Approach  \n \n Page 6 of 18 \u00a9 Aquaveo 2024  17. Turn on Starting heads equal grid top elevation  near the bottom of the dialog.  \n18. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n4.4 Starting Heads  \nThe starting heads array is used to establish an initial head value when performing a \ntransient simulation.  Since this project is  computing a steady state simulation, the initial \nhead for each cell shouldn't make a difference in the  final solution.   \nHowever, the closer the starting head values are to the final head values, the more \nquickly MODFLOW will converge to a solution.  Furthermore, for certain types of layers, if \nthe starting head values are too low, MODFLOW may interpret the cells as being dry.  For \nthe problem at hand , the initial values are set to \u201c60\u201d because Starting heads equal grid \ntop elevation  is turned on  in the MODFLOW Global/Basic Package  dialog.   \nThe starting heads array is also used to establish the head values ass ociated with \nconstant head cells.  For this problem, the constant head values should be zero.  Since all \nof the starting head values are already \u201c60\u201d by default, it will be necessary  to make these \nchanges later in the tutorial.  \n5 Assigning IBOUND Values Direct ly to Cells  \nAs mentioned above, the IBOUND values can be entered through the IBOUND Array  \ndialog. In some cases, it is easier to assign values directly to cells. This can be \naccomplished by editing the properties of the cells. Before using the command, it is \nnecessary to first select the cells in the leftmost column of the top two layers.  \n5.1 Viewing the Left Column  \nTo simplify the selection of the cells, change the display to make the leftmost layer \nvisible.  \n1. Turn on Ortho Mode  . \n2. Switch to  Side View  . \nThe grid appears very thin. To make things easier, increase the Z magnification so that \nthe grid appears stretched in the vertical direction:  \n3. Click Display  Options   to bring up the Display Options  dialog.  \n4. Enter \u201c15.0\u201d for the Z magnification  and click OK to close the Display Options  \ndialog.  \n5.2 Selecting the Cells  \nDo the following to select the cells:  \n1. Select the Select Cells   tool so the Mini -Grid Toolbar appears  \n2. Enter \u201c 1\u201d in the Mini -Grid Toolbar and press the Tab key. \nNotice column number one (the leftmost column) is now shown.  \n3. Drag a box around all of the cells in the top two layers of the grid to highlight \nthem ( Figure 3). \n\nGMS Tutorials   MODFLOW \u2013 Grid Approach  \n \n Page 7 of 18 \u00a9 Aquaveo 2024   \n      Figure 3      Highlight the first two layers  \n5.3 Changing the IBOUND Value  \nTo edit the IBOUND value:  \n1. Right -click on one of the selected cells and select Properties\u2026  to bring up the \n3D Grid Cell Properties  dialog.  \n2. Select \u201cSpecified Head\u201d from the drop -down in the Value  column of the IBOUND  \nrow. \n3. Enter \u201c0.0\u201d in the Value  column of the Starting head  row. \n4. Click OK to exit the 3D Grid  Cell Properties  dialog.  \n5. Switch to Plan View  . \nNotice that an orange diamond symbol is displayed in the cells that were edited, \nindicating they are constant head cells ( Figure 4). \n \n        Figure 4      Constant head cells marked on the left  \n5.4  Checking the Values  \nTo en sure that the IBOUND values were entered correctly:  \n1. Select MODFLOW  | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage  dialog.  \n2. Click IBOUND\u2026  button to bring up the IBOUND Array  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Grid Approach  \n \n Page 8 of 18 \u00a9 Aquaveo 2024  3. Choose the up arrow to the right of  the layer field in the upper left corner of the \ndialog to cycle through the layers.  \nNote that the cells in the leftmost column in the top two layers all have a value of \u201c -1\u201d. \nMost of the MODFLOW  input data can be edited in GMS using either a spreadsheet \ndialog such as this one, or by selecting a set of cells and entering a value directly.  \n4. Click Cancel  to exit the IBOUND Array  dialog.  \n5. Click Cancel  to exit the MODFLOW Global/Basic Package  dialog.  \n6 The LPF  Package  \nThe next step is to enter the data for the Lay er Property Flow (LPF) package. The LPF \npackage computes the conductance between each of the grid cells and sets up the finite \ndifference equations for the cell -to-cell flow.  \nTo enter the LPF data:  \n1. Select MODFLOW | LPF \u2013 Layer Property Flow\u2026  to bring up th e LPF Package \ndialog.  \n2. In the Layer data  section, enter \u201c1\u201d for the Layer . \nThe options in the Layer data  section are used to define the layer type and hydraulic \nconductivity data for each layer. This problem has three layers. The top layer is \nunconfined, and the bottom two layers are confined. The default Layer type  in GMS is \nConvertible , which means the lay er can be confined or unconfined. Thus, it isn\u2019t \nnecessary to change the layer types.  \nThe buttons on the right side of the Layer Data  section are for entering the parameters \nnecessary for computing the cell -to-cell conductances. MODFLOW requires a set of \nparameters for each layer depending on the layer type.  \n6.1 Top Layer  \nFirst, enter the data for the top layer:  \n1. Click Horizontal Hydraulic Conductivity\u2026  to bring up the Horizontal Hydraulic \nConductivity dialog . \n2. Click Constant \u2192 Layer  to bring up the Layer Value dialog.  \n3. Enter a value of \u201c15.0\u201d for the Constant value for layer  and click OK to close the \nLayer Value dialog.  \n4. Click OK to exit the Horizontal Hydraulic Conductivity  dialog.  \n5. Click Vertical Anisotropy (Kh/Kv)\u2026  to bring up the Vertical Anisotropy (Kh/Kv)  \ndialog .  \n6. Click Constant \u2192 Layer\u2026  to bring up the Layer Value dialog.  \n7. Enter \u201c10.0\u201d for the Constant value for layer  and click OK to close the Layer \nValue dialog.  \n8. Click OK to exit the Vertical Anisotropy (Kh/Kv)  dialog.  \n6.2 Middle Layer  \nNext, enter the data for the middle layer:  \nGMS Tutorials   MODFLOW \u2013 Grid Approach  \n \n Page 9 of 18 \u00a9 Aquaveo 2024  1. In the Layer data  section, enter \u201c2\u201d for the Layer . \n2. Repeat steps 1 \u20138 from section  6.1, entering \u201c0.9\u201d for the Constant value for layer  \nfor the horizontal hydraulic conductivity and \u201c5.0\u201d for the Constant value for layer  \nfor the vertical a nisotropy.  \n6.3 Bottom Layer  \nFinally, enter the data for the bottom layer:  \n1. In the Layer data  section, enter \u201c3\u201d for the Layer . \n2. Repeat steps 1 \u20138 from section  6.1, entering \u201c2.0\u201d for the Constant value for layer  \nfor the horizontal hydraulic conductivity and \u201c5.0\u201d  for the Constant value for layer  \nfor the vertical anisotropy.  \n3. When done, click OK to close the LPF Package  dialog.  \n \n7 The Recharge Package  \nEntering data in the recharge package allows simulation of the recharge to an aquifer due \nto rainfall and infiltration .  \nTo enter the recharge data, do the following:  \n1. Select MODFLOW  | Optional Packages  | RCH \u2013 Recharge\u2026  to bring up the \nMODFLOW Recharge Package  dialog.  \n2. Click Constant \u2192 Array  to bring up the Grid Value dialog.  \n3. Enter \u201c0.0009\u201d for the Constant value for grid  and click OK to close the Grid \nValue dialog.  \n4. Click OK to exit the MODFLOW Recharge Package  dialog.  \n8 The Drain Package  \nThe next step is to define the row of drains in the top layer of the model. To define the \ndrains, first select the cells where the drains will be located, and then select the Point \nSources/Sinks command.  \nThe drains are located in the top layer (layer 1). S ince this is the current layer, it isn\u2019t \nnecessary to change the view.  \nNotice that as the cursor moves across the grid, the IJK indices  of the cell beneath the \ncursor are displayed in the Edit Window  at the bottom of the screen ( Figure 5, bottom).   \nThis is the second way to create a UGrid discussed in this tutorial. There are other ways \nexplained in the UGrid Creation  tutorial. UGrids can be created so that they are ref ined \naround wells, rivers, and lakes (points, arcs, and polygons) in the conceptual model.  \nGMS Tutorials   MODFLOW \u2013 Grid Approach  \n \n Page 10 of 18 \u00a9 Aquaveo 2024   \n        Figure 5      Cells to be selected (top) and IJK indices of cell under cursor  (bottom)  \nTo select the cells, do the following:  \n1. Using the Select Cells   tool while holding down the Shift key, draw a box \nselecting cells 2 \u201310 on row 8 ( Figure 5, top). The first cell will indicate \u201cIJK: \n8,2,1\u201d, meaning \u201crow 8, cell 2, layer 1\u201d ( Figure 5, bottom).  \nTo assign drains to the cells:  \n2. Right -click on one of the selected cells and select Sources/Sinks\u2026  to bring up \nthe MODFLOW Sources/Sinks  dialog.  \n3. Select \u201cDrain (DRN)\u201d from the list on the left.  \n4. Click Add BC  to add a new instance of a drain t o each of the selected cells.  \nAt this point, enter an elevation and a conductance for the selected drains. The drains all \nhave the same conductance but the elevations are not all the same.  \n5. Enter the following values in the Elevation (m)  and Conductance (m ^2/d)  \ncolumns in the list of drains:  \nID Elevation  Conductance  \n107 0.0 7430.0  \n108 0.0 7430.0  \n109 3.0 7430.0  \n110 6.0 7430.0  \n111 9.0 7430.0  \n112 15.0 7430.0  \n113 20.0 7430.0  \n114 27.0 7430.0  \n115 30.0 7430.0  \n6. Click OK to close the MODFLOW Sources/Sinks  dialog.  \n7. Deselect the cells by clicking anywhere outside the grid.  \nThe drains should now be marked by green circles ( Figure 6). \n\nGMS Tutorials   MODFLOW \u2013 Grid Approach  \n \n Page 11 of 18 \u00a9 Aquaveo 2024   \n        Figure 6      Location of drain cells (green circles)  \n9 The Well Package  \nSeveral wells need to be defined. Most of the wells are in the top layer but some are in \nthe middle and bottom layers.  \n9.1 Top Layer Wells  \nDefine the wells in the top layer (layer 1) first:  \n1. Using the Select Cells   tool while holding down the Ctrl key, \nselect the cells  \n2. shown in Figure 7 (the twelve cells containing yellow squares , rows \nindicated by red arrows ). The coordinates of each well are shown in \nthe table to the right.  \n3. Right -click on a selected cell  and select Sources/Sinks\u2026  to bring \nup the MODFLOW Sources/Sinks  dialog.  \n4. Select \u201cWells  (WEL)\u201d  from the list on the left and click the Add BC  \nbutton. Twelve well entries will appear in the spreadsheet area on \nthe right side of  the dialog.  \n5. In the All row, enter \u201c -12230\u201d in the Q (flow) (m^3/d)  column.  \nA negative value signifies extraction.  \n6. Click  OK to close the MODFLOW Sources/Sinks  dialog.  \n7. Deselect the cells by clicking anywhere outside the grid.  \nWell Coordinates  \nrow \n(i) col \n(j) lay \n(k) \n9 8 1 \n9 10 1 \n9 12 1 \n9 14 1 \n11 8 1 \n11 10 1 \n11 12 1 \n11 14 1 \n13 8 1 \n13 10 1 \n13 12 1 \n13 14 1 \nGMS Tutorials   MODFLOW \u2013 Grid Approach  \n \n Page 12 of 18 \u00a9 Aquaveo 2024   \n       Figure 7      Rows with wells (twelve yellow squares)  \n9.2 Middle Layer Wells  \nThe wells in the middle layer (layer 2) need to be defined next. First, it is necessary to \nview the middle layer.  \n1. Click the Up arrow  in the Mini -Grid Toolbar  switch to layer 2.  \n2. Using the Select Cells   tool while holding down the Ctrl \nkey, select the cells shown in Figure 8 (the two cells \ncontaining yellow squares, indicated by red arrows). The \ncoordinates of each well are shown in the table to the right.  \n3. Right -click on a selected cell and select Sources/Sinks\u2026  to \nbring up the MODFLOW Sources/Sinks  dialog.  \n4. Select \u201cWells (WEL) \u201d from the list on the left and click the Add \nBC button. Two well entries will appear in the spreadsheet area on the right side \nof the dialog.  \n5. In the All row, enter \u201c -12230\u201d in the Q (flow) (m^3/d)  column.  \n6. Click OK to close the MODFLOW Sources/Sinks  dialo g. \n7. Unselect the cells by clicking anywhere outside the grid.  \nWell \nCoordinates  \nrow \n(i) col \n(j) lay \n(k) \n4 6 2 \n6 12 2 \nGMS Tutorials   MODFLOW \u2013 Grid Approach  \n \n Page 13 of 18 \u00a9 Aquaveo 2024   \nFigure 8      Well locations  \n9.3 Bottom  Layer Wells  \nFinally, define a single well on the bottom layer (layer 3):  \n1. Click the Up arrow  in the Mini -Grid Toolbar  to switch to layer 3.  \n2. Using the Select Cells   tool, select the cell shown in Figure 9 (indicated by red \narrow). The coordinates of the well are \u201cIJK: 5, 11, 3\u201d.  \n3. Right-click on the selected cell and select Sources/Sinks\u2026  to bring up the \nMODFLOW Sources/Sinks  dialog.  \n4. Select \u201cWells (WEL)\u201d from the list on the left and click the Add BC  button. One \nwell entry will appear in the spreadsheet area on the right side of the d ialog.  \n5. Enter \u201c -0.15\u201d in the Q (flow) (m^3/d)  column.  \n6. Click OK to close the MODFLOW Sources/Sinks  dialog.  \n7. Unselect the cell by clicking anywhere outside the grid.  \n\nGMS Tutorials   MODFLOW \u2013 Grid Approach  \n \n Page 14 of 18 \u00a9 Aquaveo 2024   \n       Figure 9      Location of the single well in layer 3  \nNow that all of the wells have been defined, it is possible to go back to the top layer.  \n1. Click the down arrow  twice in the Mini -Grid Toolbar  to go back to layer 1 . \n10 Checking and Saving the Simulation  \nAt this point, the MODFLOW data is completely defined and r eady for the simulation run. \nBecause of the significant amount of data required for a MODFLOW simulation, it is easy \nto omit some of the required data or to define inconsistent or incompatible options and \nparameters. Such errors will either cause MODFLOW t o crash or to generate an \nerroneous solution. Before saving the simulation and running MODFLOW, always run the \nMODFLOW Model Checker  and check for errors.  \nThe purpose of the Model Checker  is to analyze the input data currently defined for a \nMODFLOW simula tion and report any obvious errors or potential problems. However, \nrunning the Model Checker  successfully does not guarantee that a solution will be \ncorrect. It simply serves as an initial check on the input data and can save a considerable \namount of time that would otherwise be lost tracking down input errors.  \nDo the following to run the Model Checker : \n1. Select MODFLOW  | Check Simulation\u2026  to bring up the Model Checker  dialog.  \n2. Click Run Check  to initiate the model check.  \nA list of messages is shown for each o f the MODFLOW input packages. If everything has \nbeen done correctly, the packages should have no errors. When an error exists, select \nthe error in the Model Checker  and GMS will select the cells or layers associated with the \nproblem.  \n3. When finished reviewin g the results of the model check, click Done  to exit the \nModel Checker . \n4. Select File | Save As\u2026  to bring up the Save As  dialog.  \n5. Browse to the modfgrid  directory.  \n\nGMS Tutorials   MODFLOW \u2013 Grid Approach  \n \n Page 15 of 18 \u00a9 Aquaveo 2024  6. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n7. Enter \u201cgridmod.gpr\u201d as the File name  and click Save  to save the project and \nclose the  Save As  dialog.  \n11 Running MODFLOW  \nIt is now possible to run MODFLOW:  \n1. Select MODFLOW  | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \nThe super file name is passed to MODFLOW as a command line argument. MODFLOW \nopens the file and begins the simulation. As the simulation proceeds, some text output in \nthe window will report the solution progress.  \n2. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n3. Click Close  to exit the MODFLOW  model wrapper dialog.  \n4. Click Display Options   to bring up the Display Options  dialog.  \n5. Select \u201c3D Grid Data\u201d from the list on the left.  \n6. On the MODFLOW  tab, click on the blue triangle button to the left of Flooded \ncells to bring up the Symbol Attributes  dialog.  \n7. Click the down -arrow button next to Color  and select \u201cSkyblue\u201d from the list of \ncolors.  \n8. Click OK to close the Symbol Attributes  dialog.  \n9. Click OK to close the Display Options  dialog.  \n12 Viewing the Solution  \nGMS imports the soluti on automatically when the MODFLOW window is closed. At this \npoint, a set of head contours for the top layer should be seen. Some cells containing a \nlight blue triangle symbol will also be visible (top right in Figure 10). These cells are \nflooded, meaning the computed water table is above the top of the cell.  \n\nGMS Tutorials   MODFLOW \u2013 Grid Approach  \n \n Page 16 of 18 \u00a9 Aquaveo 2024   \n      Figure 10      Contours, with flooded cells at top right  \n12.1 Changing Layers  \nView th e solutions on the middle and bottom layers by doing the following:  \n1. Click the up arrow  in the Mini -Grid Toolbar to go to layer 2 (one click) or layer \n3 (two clicks).  \n2. When finished viewing the middle and bottom layer solutions, use the down \narrow  to return to layer 1.  \n12.2 Color Fill Contours and Color Legend  \nIt is also possible to display the contours using a color fill option.  \n1. Select Display  | Contour Options\u2026  to bring up the Dataset Contour Options \u2013 \n3D Grid \u2013 Head  dialog.  \n2. In the Contour method  section, select \u201cColor Fill\u201d from the top drop -down.  \n3. At the bottom left, turn on Legend  \n4. Click OK to close the Dataset Contour Options \u2013 3D Grid \u2013 Head  dialog.  \nThe Graphics Window should appear similar to Figure 11. \n\nGMS Tutorials   MODFLOW \u2013 Grid Approach  \n \n Page 17 of 18 \u00a9 Aquaveo 2024   \n       Figure 11      Color fill contours with a legend  \n13 Zone Budget  \nZone Budget is a program developed by the U.S. Geological Survey (USGS) to compute \nsubregional water budgets for MODFLOW groundwater flow models. GMS has \nincorporated a similar flow budget reporting tool. In GMS, zones are defined by assigning \na Zone Budge t ID to cells. Once the zones are defined, a report can be generated that \nshows the flow budget for the zone. The report also includes a component that shows the \nflow in and out to adjacent zones.  \n13.1 Assigning Zone Budget IDs  \nIn this model, make each layer in to a zone.  \n1. Switch to Plan View  . \n2. Use the up  or down  arrows on the Mini -Grid Toolbar to switch to layer 2 of \nthe grid.  \n3. Using the Select Cells   tool, drag a box around all of the cells in layer 2 of the \ngrid. \n4. Right -click on one of the selected cells an d select Properties\u2026  to bring up the \n3D Grid Cell Properties  dialog.  \n5. Enter \u201c2\u201d for the Zone budget ID.  \n6. Click OK to close the 3D Grid Cell Properties  dialog.  \n7. Use the Mini -Grid Toolbar to switch to layer 3 of the grid.  \n8. Repeat steps 3 through 6, entering \u201c3\u201d for the Zone budget ID . \n\nGMS Tutorials   MODFLOW \u2013 Grid Approach  \n \n Page 18 of 18 \u00a9 Aquaveo 2024  13.2 Viewing the Zone Budget Report  \nIt is now possible to view the flow budget for each of the zones.  \n1. Select MODFLOW | Flow Budget\u2026  to bring up the Flow Budget  dialog.  \n2. Switch to the Zones  tab. \nCurrently, the report is showing information  for the first zone (the top layer of the grid). \nThe report is divided into two sections: flow into the zone and flow out of the zone. Every \nsource/sink present in the model is listed in the report with a flow value. In addition to the \nsources/sinks, there  is a field for the amount of flow that goes between zones.  \n3. View the reports for the other two zones by selecting the desired zone from the \nZone  drop-down.  \n4. When finished, click OK to exit the Flow Budget  dialog.  \n14 Conclusion  \n \nThis concludes the \u201cMODFLOW \u2013 Grid Approach\u201d tutorial. The following topics were \ndiscussed and demonstrated:  \n\uf0b7 It is possible to specify which units are being used and GMS will display the units \nnext to input fields to help input the appropriate value. GMS does not do any unit \nconversion s. \n\uf0b7 The desired MODFLOW packages for use in the model can be selected by \nchoosing the MODFLOW | Global Options\u2026  command and clicking the \nPackages\u2026  button.  \n\uf0b7 Most MODFLOW array data can be edited in two ways: via a spreadsheet or by \nselecting grid cells and us ing the MODFLOW | Advanced | Cell Properties\u2026  \ncommand.  \n\uf0b7 Wells, drains, etc. can be created and edited by selecting the grid cell(s) and \nchoosing the MODFLOW | Advanced | Sources/Sinks\u2026  command or by right -\nclicking on a selected cell and selecting the Source s/Sinks\u2026  command from the \npop up menu.  \n\uf0b7 The Model Checker  can be used to analyze the input data and check for errors.  \n\uf0b7 A flow budget report can be generated for a sub -region of the model by assigning \nZone budget IDs to the grid and then using the Flow Budget  command.  \n \n", "filename": "MODFLOW-GridApproach.pdf", "pages": 18}, "MODFLOW-InterpolatingLayerData": {"text": "GMS Tutorials   MODFLOW \u2013 Interpolating Layer Data  \n Page 1 of 12 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Interpolating Layer Data  \nInterpolating MODFLOW elevations and other data from discrete \npoints  \n \nObjectives   \nLearn how to effectively use GMS tools to interpolate MODFLOW layer elevation data and other \nMODFLOW data from scatter points.  \n \nPrerequisite Tutorials  \n\uf0b7 Geostatistics 2D  \n\uf0b7 MODFLOW \u2013 Grid \nApproach\u2026  \nOr \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach I  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 Geostatistics  \n Time  \n\uf0b7 20\u201335 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 Interpolating Layer Data  \n Page 2 of 12 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Interpolating to MODFLOW Layers  ................................ ................................ ...............  2 \n1.2 Getting Started  ................................ ................................ ................................ ..............  3 \n2 Case 1 \u2013 Complete Layers  ................................ ................................ ................................ .. 3 \n2.1 Importing the Scatter Point Sets  ................................ ................................ ...................  3 \n2.2 Switch to Front View  ................................ ................................ ................................ ..... 4 \n2.3 Interpolating the Elevation Values  ................................ ................................ ................  4 \n3 Case 2 \u2013 Embedded Seam  ................................ ................................ ................................ .. 5 \n3.1 Interpolating the Values  ................................ ................................ ................................  6 \n3.2 Correcting the Layer Data  ................................ ................................ .............................  6 \n4 Case 3 \u2013 Outcropping  ................................ ................................ ................................ ..........  7 \n4.1 Interpolating the Values  ................................ ................................ ................................  7 \n4.2 Correcting the Layer Values  ................................ ................................ .........................  8 \n5 Case 4 \u2013 Bedrock Truncation  ................................ ................................ .............................  9 \n5.1 Activating the Inactive Cells  ................................ ................................ ..........................  9 \n5.2 Interpolating the Values  ................................ ................................ ..............................  10 \n5.3 Viewing the Results  ................................ ................................ ................................ .... 10 \n5.4 Correcting the Layer Values  ................................ ................................ .......................  11 \n5.5 Viewing the Corrected Layers  ................................ ................................ .....................  11 \n6 Conclusion  ................................ ................................ ................................ .........................  12 \n \n1 Introduction  \nFor sites with complex stratigraphy and three -dimensional flow, a multilayer MODFLOW \nmodel can be much more accurate than a one -layer, two -dimensional model. When \ncreating multilayer models, defining layer data can be challenging. This is particularly true  \nfor cases involving embedded seams, pinchouts, and truncations. Fortunately, GMS \ncontains a suite of tools for interpolating and manipulating layer elevation data.  \nThis tutorial involves the use of scatter points, interpolation, and MODFLOW. Therefore, \na familiarity with MODFLOW and scatter points is helpful. Although not required, \ncompleting the \u201c Geostatistics  \u2013 2D\u201d tutorial and either the \u201c MODFLOW \u2013 Grid Approach \u201d \nor \u201cMODFLOW \u2013 Conceptual Model Approach  I\u201d tutorial is recommended before \ncompleting this tutorial.  \nTo illustrate the process of interpolating the elevations and fixing errors, it is necessary to \nlook at a series of example cases. Each example illustrates a different problem and \ndescribes a simple and effective approach for correctly modeling t he stratigraphy. This \ntutorial will discuss and demonstrate importing scatter point datasets, then interpolating \nelevation values and correcting the layer elevations for complete layers, embedded \nseams, outcroppings, and bedrock truncation. With the tools in GMS, even complex \ngeologic strata can be modeled quickly and easily.  \n1.1 Interpolating to MODFLOW Layers  \nOne of the ways to create the top and bottom elevation arrays for each MODFLOW layer \nis to interpolate them from a set of scatter points. The interpola tion can be performed \ndirectly on the MODFLOW arrays using the Interpolation  | Interpolate \u2192 2D Grid  menu \ncommand in the 2D Scatter Point   module.  \nThe scatter points can be imported from a tabular scatter point file. For regions with \ncomplex stratigraphy such as embedded seams or outcroppings, the scatter point data \nmust be defined carefully. Once interpolated, the scatter point data may result in \noverlapping layers. These errors can be automatically corrected using the Model \nChecker . \n\nGMS Tutorials   MODFLOW \u2013 Interpolating Layer Data  \n \n Page 3 of 12 \u00a9 Aquaveo 2024  1.2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored  to their default state. Click Don\u2019t Save  if asked to save changes.  \n2 Case 1 \u2013 Complete Layers  \nThe first case examined is shown in Figure 1. This is the simplest of the cases examined \nin this tutorial. The site has three layers and all three layers extend over the entire \ndomain of the model.  \n \n      Figure 1      Typical cross section with three layers extending across  the entire domain model  \n2.1 Importing the Scatter Point Sets  \nThe first step in defining the layer data will be creating a grid. The next step is to create a \nset of points at various xy locations in the model. Each point has an elevation for the top \nand bottom of each layer. In a real  problem, these data would come from sources such \nas exploratory boreholes. The data are entered into a tabular text file, typically through \nthe use of a spreadsheet  application . The Import Wizard  is then used to import the \ntabular text file into GMS. The \u201cGeostatistics  \u2013 2D\u201d tutorial teaches how to do this in \ndetail.  \nThis tutorial will look at four different scenarios. Four different scatter point sets have \nbeen prepared in advance using the technique described above. To import the project, do \nthe followin g: \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state. Click Don\u2019t Save  if asked to save changes.  \n3. Click Open\u2026   to bring up the Open  dialog.  \n4. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n5. Browse to the layerdata \\layerdata  directory and select \u201c points.gpr\u201d.  \n6. Click Open  to import the project file and close the Open  dialog.  \nThe Main Graphics Window will appear similar to Figure 2. \n\nGMS Tutorials   MODFLOW \u2013 Interpolating Layer Data  \n \n Page 4 of 12 \u00a9 Aquaveo 2024   \n      Figure 2      The initial project file for Case 1  \n2.2 Switch to Front View   \nBefore interpolating, change the view to look at a cross section of  the grid. That way, it \nwill be possible to immediately see the results of the interpolation. Before switching the \nview, first select a cell in the interior of the model. If a cell is selected when switching \nviews, the new view will change to the row or co lumn passing through the selected cell.  \n1. Using the Select Cells   tool, select a cell near the middle of the grid.  \n2. Switch to Front View  . \nThe Graphics Window should appear similar to Figure 3. Notice the grid layers are flat.  \n \n      Figure 3      Front view with selected cell  \n2.3 Interpolating the Elevation Values  \nA set of points should appear on the screen. The scatter point sets each have four \ndatasets: top1, bot1, bot2, and bot3. The next step is to interpolate each of these \ndatasets to the appropriate layer in the MODFLOW array. Before interpolating the points, \ninitialize the MODFLOW data.  \n1. Expand the \u201c  3D Grid Data\u201d folder in t he Project Explorer.  \n2. Right -click on \u201c  grid\u201d and select New MODFLOW\u2026  to bring up the \nMODFLOW Global/Basic Package dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Interpolating Layer Data  \n \n Page 5 of 12 \u00a9 Aquaveo 2024  3. Click OK to accept the defaults and close the MODFLOW Global/Basic Package \ndialog.  \nTo interpolate the elevation values:  \n4. Expand the \u201c  2D Scatter Data\u201d folder and the \u201c  Case 1\u201d scatter set in the \nProject Explorer.  \n5. Select \u201c  Case 1\u201d to make it active.  \n6. Right -click on \u201c  Case 1\u201d and select Interpolate To | MODFLOW Layers\u2026  to \nbring up the Interpolate to MODFLOW Layers dialog.  \nThis dialog i s used to define which scatter point datasets are interpolated to which \nMODFLOW arrays. The datasets are listed at the top -left and the MODFLOW arrays are \nlisted at the top -right of the dialog. The \u201cmapped\u201d relationships are listed at the bottom of \nthe dia log in the Dataset \u2192 MODFLOW data  section. GMS tries to automatically map the \nrelationships based on the dataset names. In this case, all of the relationships were \ncorrectly mapped.  \n7. Click the OK button to exit the Interpolate to MODFLOW Layers dialog.  \nAfter a few moments, the display will change ( Figure 4). Notice that the interpolated \nlayers match the cross section shown in Figure 1. Use the arrow buttons in the Mini -Grid \nToolbar to view the cross sections along other rows.  \n \n      Figure 4      After the scatter sets ar e interpolated to MODFLOW  \n3 Case 2 \u2013 Embedded Seam  \nThe next case to be examined is illustrated in Figure 5. The middle layer is an embedded \nseam that only exists on the  left (west) side of the model. This type of layer is more \ndifficult to model with MODFLOW since a full array of K values must be defined for each \nlayer. Making the cells in the second layer inactive on the right side of the model will not \nwork since this will result in a no -flow boundary between the first and third layers.  \nTo model the seam correctly, use a three layer model and the second layer will extend \nthroughout the entire model domain. Adjusting the layer thickness of the second layer so \nthat the c ells will be very small on the right side of the model will simulate the pinchout.  \n \n      Figure 5      Typical cross section through a site with an embedded seam  \n\nGMS Tutorials   MODFLOW \u2013 Interpolating Layer Data  \n \n Page 6 of 12 \u00a9 Aquaveo 2024  3.1 Interpolating the Values  \nNow interpolate the data from the scatter points for Case 2. The elevations for the second \nlayer on the right side of the model are adjusted so that the bottom of layer 2 is above the \ntop of layer 2. This overlap will be fixed after the values are interpolated.  \nDo as follows to interpolate the val ues: \n8. Collapse the \u201c  Case 1\u201d scatter point set  and expand the \u201c  Case 2 \u201d scatter \npoint set in the Project Explorer.  \n9. Select \u201c  Case 2 \u201d to make it active.  \n10. Right -click on \u201c  Case 2 \u201d and select Interpolate To | MODFLOW L ayers \u2026 to \nbring up the Interpolate to MODFLOW Layers dialog.  \n11. Click OK to close the Interpolate to MODFLOW Layers  dialog.  \nNote how the middle layer becomes inverted on the right side of the model ( Figure 6). \n \n      Figure 6      Case 2 after interpolation to MODFLOW, with middle layer inverted on the right \nside \n3.2 Correcting the Layer Data  \nThe next step is to fix the overlap on the right side of the model using the layer  data tools \nin the MODFLOW model checker.  \n1. Select MODFLOW  | Check Simulation\u2026  to bring up the Model Checker  dialog.  \n2. Click Run Check  to check for errors. Notice the layer elevation errors under the \nBasic Package.  \n3. Click Fix Layer Errors\u2026  to bring up the Fix Layer Errors  dialog.  \nThis dialog provides several options for correcting layer errors. Notice that many errors \nare listed for layer 2. The correction options are shown on the left. For this case, use the \nAverage  option. This method computes the average of the top and bottom elevation for \neach cell and moves the top elevation to be just above the average and the bottom \nelevation to be just below the average. The final difference between the top and the \nbottom is set to the Minimum thickness  value shown in th e dialog.  \n4. In the Correction method  section, select Average . \n5. In the Overlap errors  list on the right, select Layer 2 . \n6. Click Fix Selected Layer  to initiate the error correction. The process should be \nvery quick.  \n7. Click OK to exit the Fix Layer Errors  dialog.  \n8. Click Done  to exit the Model Checker  dialog.  \nNote that the seam is now properly modeled ( Figure 7). It appears that the middle layer \npinches out, but i n actuality it only becomes very thin and continues throughout the grid. \n\nGMS Tutorials   MODFLOW \u2013 Interpolating Layer Data  \n \n Page 7 of 12 \u00a9 Aquaveo 2024  Use the arrow buttons in the Mini -Grid Toolbar to view the cross sections along other \nrows.  \n \n      Figure 7      After the layer errors are corrected  \n4 Case 3 \u2013 Outcropping  \nThe next case to be examined is shown in Figure 8. In this case, the top layer is an \noutcropping that only exists on the left side of the model. Demonstrate this case using a \nthree layer model and adjusting the thickness of the top layer so that it goes to a very \nsmall value on the right side of the model.  \n \n      Figure 8      Typical cross section through a site with outc ropping  \nIn this case, the elevations for the scatter points have been adjusted so that the bottom of \nthe first layer extends above the top of the second layer on the right side of the model. \nAfter interpolating the values, adjust the elevations.  \n4.1 Interpolat ing the Values  \nTo interpolate the values, do the following:  \n1. Collapse the \u201c  Case 2\u201d scatter point set and expand the \u201c  Case 3\u201d scatter \npoint set in the Project Explorer.  \n2. Select \u201c  Case 3\u201d to make it active.  \n3. Right -click on \u201c  Case 3\u201d and select Interpolate To | MODFLOW Layers\u2026  to \nbring up the Interpolate to MODFLOW Layers dialog.  \n4. Click OK to accept the defaults and close the Interpolate to MODFLOW Layers \ndialog.  \nNote how the bottom of the first layer extends above the ground surface on the right side \nof the model ( Figure 9). \n\nGMS Tutorials   MODFLOW \u2013 Interpolating Layer Data  \n \n Page 8 of 12 \u00a9 Aquaveo 2024   \n      Figure 9      After interpolation to MODFLOW, with top layer extending above the ground on the \nright \n4.2 Correcting the Layer Values  \nTo correct the layer errors, do the following:  \n1. Select MODFLOW  | Check Simulation\u2026  to bring up the Model Checker  dialog.  \n2. Click Run Check  to check for errors. Notice the layer elevation errors under the \nBasic Package . \n3. Click Fix Layer Errors\u2026  to bring up the Fix Layer Errors  dialog.  \nIn this case, it is necessary to fix the errors for layer 1 by moving the bottom of layer one \ndown to where it  is just below the ground surface. This can be accomplished using the \nPreserve top  option.  \n4. In the Correction method  section, select Preserve top . \n5. In the Overlap errors  list on the right, select Layer 1.  \n6. Turn on Inactivate thin cells . \nWith this option, inst ead of having a thin layer extend across the top of the grid, the thin \ncells are inactivated. This is useful since thin cells on the top of the grid often go dry.  \n7. Click Fix Selected Layer  to initiate the error correction. The process should be \nvery quick.  \n8. Click OK to exit the Fix Layer Errors  dialog.  \n9. Click Done  to exit the Model Checker  dialog.  \nNotice how the outcropping is now properly modeled ( Figure 10).  \n \n      Figure 10      The outcropping after the layer errors are corrected  \n10. When finished viewing the cross section, switch to Plan View  (Figure 11). \n\nGMS Tutorials   MODFLOW \u2013 Interpolating Layer Data  \n \n Page 9 of 12 \u00a9 Aquaveo 2024   \n      Figure 11      Plan view after outcropping layer errors corrected  \n5 Case 4 \u2013 Bedrock Truncation  \nThe final case to be examined is shown in Figure 12. The site has three layers, but the \nlayers are truncated by the bedrock on the sides of the model. Model this situation by \ninactivating the cells on the peri meter of the model that are below the bedrock elevation. \nAdjust the layer\u2019s bottom elevations as necessary to accurately model the bedrock.  \n(a)\n(b)\n \n      Figure 12      East/west (a) and north/south (b) cross section with layers truncated by bedrock  \n5.1 Activating the Inactive Cells  \nThe last interpolation caused cells on the top layer to become inactive. It is necessary to \nfirst activate those cells.  \n\nGMS Tutorials   MODFLOW \u2013 Interpolating Layer Data  \n \n Page 10 of 12 \u00a9 Aquaveo 2024  1. Select MODFLOW | Global Options\u2026  to bring up the MODFLOW Global/B asic \nPackage dialog.  \n2. Click IBOUND\u2026  to bring up the Ibound Array dialog.  \n3. Click Constant \u2192 Grid\u2026  to bring up the Grid Value dialog.  \n4. Enter \u201c1\u201d for the Constant value for grid  and click OK to close the Grid Value \ndialog.  \n5. Click OK to close the Ibound Array dialog. \n6. Click OK to close the MODFLOW Global/Basic Package dialog.  \n5.2 Interpolating the Values  \nDo as follows to interpolate the values:  \n1. Collapse the \u201c  Case 3\u201d scatter point set  and expand the \u201c  Case 4\u201d scatter \npoint set in the Project Explorer.  \n2. Select \u201c  Case 4\u201d to make it active.  \n3. Right -click on \u201c  Case 4\u201d and select Interpolate To | MODFLOW L ayers \u2026 to \nbring up the Interpolate to MODFLOW Layers dialog.  \n4. Click OK to accept the defaults and close the Interpolate to MODFLOW Layers \ndialog.  \n5.3 Viewing the Results  \nTo view the results, do as follows:  \n1. Select the \u201c  3D Grid Data\u201d folder to make it active.  \n2. Using the Select Cells   tool, select a cell near the middle of the grid.  \n3. Select the Front View   button ( Figure 13). \n4. Select the Side View   button ( Figure 14). \nNotice how the bottom of the third layer (the top of the bedrock) overlaps the upper  \nlayers.  \n \n      Figure 13      Front view after interpolating to MODFLOW  \n\nGMS Tutorials   MODFLOW \u2013 Interpolating Layer Data  \n \n Page 11 of 12 \u00a9 Aquaveo 2024   \n      Figure 14      Side view after interpolating to MODFLOW  \n5.4 Correcting the Layer Valu es \nTo correct the layer errors, do the following:  \n1. Select MODFLOW  | Check Simulation\u2026  to bring up the Model Checker  dialog.  \n2. Click Run Check  to check for errors. Notice the layer elevation errors under the \nBasic Package.  \n3. Click Fix Layer Errors\u2026  to bring up the Fix Layer Errors  dialog.  \nIn this case, a customized option called Truncate to bedrock  is perfectly suited to this \nproblem. This method examines the elevations for each cell. If the bedrock elevation (the \nbottom elevation for the bottom lay er) is above the top elevation of the cell, the cell is \nmade inactive. If the bedrock elevation is below the top of the cell but above the bottom, \nthe bottom elevation is adjusted to match the bedrock elevation.  \n4. In the Correction method  section, select Truncate to bedrock . \n5. Click Fix Affected Layers  to initiate the error correction. The process should be \nvery quick.  \n6. Click OK to exit the Fix Layer Errors  dialog.  \n7. Click Done  to exit the Model Checker  dialog.  \nNotice how the outcropping is now properly modeled (      Figure  15). \n \n     Figure 15      After truncation to bedrock  \n5.5 Viewing the Corrected Layers  \nTo view the cross sections, do the following:  \n1. Use the arrow buttons in the Mini -Grid Toolbar to view the grid along different \ncolumns.  \n2. Switch to Front View   and use the arrow buttons in the Mini -Grid Toolbar to \nview the grid along different rows.  \n\nGMS Tutorials   MODFLOW \u2013 Interpolating Layer Data  \n \n Page 12 of 12 \u00a9 Aquaveo 2024  3. Switch to Plan View   and notice how the cells on the perimeter of the grid \nhave been made inactive.  \n4. Use the arrow buttons in the Mini -Grid Toolbar to view the grid on different \nlayers.  \n5. Turn off Ortho Mode   and switch to Oblique View   to view the stratigraphy \nin 3D ( Figure 16). \n6. Use the Rotate   tool to view the grid from different viewpoints.  \n \n      Figure 16      View of the grid in Oblique View  \n6 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 Interpolating Layer Data\u201d tutorial. The following topics \nwere discussed and demonstrated:  \n\uf0b7 It is possible to interpolate from 2D scatter points directly to MODFLOW elevation \ndata arrays.  \n\uf0b7 Interpolating to MODFLOW elev ation data can result in layers that overlap.  \n\uf0b7 It is possible to correct overlap errors by using the Fix Layer Errors  dialog, \navailable by selecting MODFLOW | Check Simulation\u2026  \n\uf0b7 There are different ways to fix layer errors. Pick the method that best suits the \nparticular problem.  \n \n\n", "filename": "MODFLOW-InterpolatingLayerData.pdf", "pages": 12}, "MODFLOW-LAKPackage": {"text": "GMS Tutorials   MODFLOW \u2013 LAK Package  \n Page 1 of 16 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 LAK Package  \nUse the MODFLOW Lake (LAK3) package to simulate mine dewatering  \n \nObjectives   \nLearn the steps involved in using the MODFLOW Lake (LAK3) package interface in GMS. This tutorial will \ndemonstrate using the LAK3 package to simulate the dewatering of a deep excavation associated with a \nmining operation.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach II  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 Geostatistics  \n\uf0b7 Subsurface  \n Time  \n\uf0b7 30\u201345 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 LAK Package  \n Page 2 of 16 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Problem Description  ................................ ................................ ................................ ..... 3 \n1.2 Outline  ................................ ................................ ................................ ..........................  4 \n2 Getting Started  ................................ ................................ ................................ .....................  5 \n2.1 Importing the MODFLOW Model  ................................ ................................ ..................  5 \n2.2 Saving a Copy of the Project  ................................ ................................ ........................  5 \n2.3 Turning on the Lake Package  ................................ ................................ .......................  6 \n3 The Lake Model  ................................ ................................ ................................ ....................  6 \n3.1 Creating  the Lake Coverage  ................................ ................................ .........................  6 \n3.2 Importing the Lake Polygon  ................................ ................................ ..........................  6 \n3.3 Setting up the Lake TIN  ................................ ................................ ................................  8 \n3.4 Assigning the Polygon Properties  ................................ ................................ .................  9 \n3.5 Mapping to MODFLOW  ................................ ................................ ..............................  10 \n3.6 The Lake Package Dialog  ................................ ................................ ...........................  11 \n3.7 Turning on the GAGE Package  ................................ ................................ ..................  12 \n3.8 Changing the Solver  ................................ ................................ ................................ ... 12 \n3.9 Running the MODFLOW Simulation  ................................ ................................ ...........  13 \n3.10  Viewing the Results  ................................ ................................ ................................ .... 13 \n3.11  Modifying the Model  ................................ ................................ ................................ .... 13 \n3.12  Running the MODFLOW Simulation  ................................ ................................ ...........  14 \n3.13  Viewing the Results  ................................ ................................ ................................ .... 14 \n4 Iterating the Solution Process  ................................ ................................ ..........................  15 \n5 Conclusion  ................................ ................................ ................................ .........................  16 \n \n1 Introduction   \nThis tutorial illustrates the steps involved in using the Lake (LAK3) package as part of a \nMODFLOW simulation. The situation discussed is hypothetical, and does not represent \nan actual real -world situation or operation.  \nThe Lake package is a more sophist icated alternative to the typical approach of using the \nGeneral Head Boundary (GHB) package to simulate the lake -aquifer interactions. The \nGHB package is used to define the stage in the lake and MODFLOW computes the flow \nrequired to maintain that stage giv en the head losses that occur as the water flows \nthrough the lake bottom sediments. With the Lake package, the stage in the lake is \ncomputed by MODFLOW based on the water budget.  \nThe water budget is a function of inflow/outflow resulting from head differe nces between \nthe aquifer and the lake. The flow budget also includes the effect recharge, evaporation, \nand anthropogenic inflow and discharge. The storage capacity of the lake is determined \nautomatically based on the lake geometry. The Lake package can be used for either \nsteady -state or transient simulations.  \nThe Lake package represents a lake using a set of inactive cells as shown in Figure  1. \nThe blue cells correspon d to the lake and have an IBOUND value of zero (the cells are \n\u201cinactive\u201d). Defining the lake in this fashion allows the lake to interact with lower layers \nand it allows lateral inflow to the lake.  \nThe lake is also assumed to have lakebed sediments which af fect the flow between the \naquifer and the lake. The effect of the lakebed sediments is represented with a lakebed \nleakance term that includes the thickness and the hydraulic conductivity. The flow from \nthe aquifer into the lake is a function of both the la kebed leakance and the conductance \nof aquifer cells adjacent to the lake.  \nThe Lake package includes an option for simulating \u201csublakes.\u201d This option makes it \npossible for the lake to partition into smaller, separated lakes as the lake stage drops.  \nGMS Tutorials   MODFLOW \u2013 LAK Package  \n \n Page 3 of 16 \u00a9 Aquaveo 2024   \n      Figure  1      Cell discretization used by the Lake package1 \n1.1 Problem Description  \nIn this tutorial exercise, the Lake package is used to simulate the dewatering of a \nhypothetical deep excavation associated with a hypothetical mi ning operation. The model \ndomain is shown in Figure  2. The contours in the map represent ground surface \nelevation. The aquifer consists primarily of fractured limeston e.  \nThe excavation for this mining operation has been proposed in the region indicated in       \nFigure  2. When fully excavated, the mine will be approximately 700 meters wide, 1200 \nmeters long, and about 600 meters dee p at the deepest point. The objective of this \nexercise is to estimate the amount of water that will need to be pumped out of the bottom \nof the excavation in order to dewater the site.  \n                                                      \n1 Merritt, Michael L. and Konikow, Leonard F. (2000).  Documentation of a computer program to \nsimulate lake -aquifer interaction using the MODFLOW ground water flow model and the MOC3D \nsolute -transport model, U.S. Geological Survey, Water -Resou rces Investigations Report 00 -4167, \ncover page . http://fl.water.usgs.gov/PDF_files/wri00_4167_merritt.pdf . \n\nGMS Tutorials   MODFLOW \u2013 LAK Package  \n \n Page 4 of 16 \u00a9 Aquaveo 2024   \n      Figure  2      Map of region containing the proposed mine (a) Plan view (b) Cross -section \ncorresponding to A -A\u2019 with water table shown  \nAlthough not required, it may be useful to complete the \u201c MODFLOW \u2013 Conceptual Model \nApproach  I\u201d tutorial before doing this tutoria l. \n1.2 Outline  \nThis tutorial will demonstrate and discuss the following key concepts:  \n1. Opening a file containing a calibrated MODFLOW simulation of the groundwater \nflow in the region surrounding the proposed excavation site.  \n2. Turning on the Lake package option.  \n3. Defining the elevations of the bottom of the lake (excavation) using a TIN.  \n4. Defining the location of the lake using a polygon in the Map  module.   \n5. Assigning a set of lake properties to the lake polygon in the Map  module, \nincluding a \u201cwithdrawal rate\u201d re presenting the pumping rate used by the \ndewatering wells.  \n6. Using the Map \u2192 MODFLOW  command to discretize the lake data from the \npolygon to the grid cells.  \n\nGMS Tutorials   MODFLOW \u2013 LAK Package  \n \n Page 5 of 16 \u00a9 Aquaveo 2024  7. Running the MODFLOW simulation.  \n8. Importing the solution and examine the resulting lake stage.  \n9. Repeating  steps 5 \u20138 until the resulting stage is within ten meters of the bottom of \nthe lake (excavation).  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state. Click Don\u2019t Save  if asked to save changes.  \n2.1 Importing the MODFLOW Model  \nThe first step is to import a file containing a previously -completed MODFLOW model of \nthe site.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the modflake \\modflake  directory and select \u201cstart.gpr\u201d.  \n4. Click Open to import the project and exit the Open  dialog . \nNotice a set of contours on the grid ( Figure 3). These contours represent the computed \nhead from the MODFLOW simulation. This model has been calibrated to pre -excavation \nconditions. Now to modify the model to simulate the ef fect of the mine.  \n \n      Figure 3      Contoured map of the excavation site  \n2.2 Saving a Copy of the Project  \nBefore continuing, save a copy of the project under a different name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c mine01.gpr \u201d as the File name . \n\nGMS Tutorials   MODFLOW \u2013 LAK Package  \n \n Page 6 of 16 \u00a9 Aquaveo 2024  4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \nWhile going through the tutorial, periodically Save   the project to save any changes.  \n2.3 Turning on the Lake Package  \nNow to turn on the Lake package option in the MODFLOW interface:  \n1. Select MODFLOW  | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage dialog.  \n2. Click Packages\u2026  to bring up the MODFLOW Pac kages / Processes dialog.  \n3. In the Optional packages / processes section, turn on LAK3 \u2013 Lake . \n4. Click OK to exit the MODFLOW Packages / Processes dialog.  \n5. Click OK to exit the MODFLOW Global/Basic Package dialog.  \n3 The Lake Model  \n3.1 Creating the Lake Coverage  \nThe easiest way to build Lake package data in GMS is to use conceptual modeling tools \nin the Map  module. This allows users to define the boundary of the mine using a \npolygon and to define the geometry of the mine (the elevations) using a TIN.  \nFirst, create a  coverage for the lake polygon:  \n1. In the Project Explorer, fully expand the \u201c  Map Data\u201d folder.  \n2. Right -click on the \u201c  Conc. Mod\u201d conceptual model and select New \nCoverage\u2026  to bring up the Coverage Setup  dialog.  \n3. Enter \u201clake\u201d as the Coverage name . \n4. In the Sources/Sinks/BCs  column, scroll down and turn on Lake . \n5. At the bottom of the dialog, turn off Use to define model boundary (active area) . \n6. Click OK to exit the Coverage Setup  dialog.  \n3.2 Importing the Lake Polygon  \nNext to create a polygon representing the boundary of the mine by importing a shapefile:  \n1. Select File | Open\u2026  to bring up the Open  dialog.  \n2. Select \u201cShapefiles (*.shp)\u201d from the Files of type  drop-down.  \n3. Select \u201cmine_bound_poly.shp\u201d and click Open to import the shapefile and exit \nthe Open  dialog.  \nA new entry, \u201c  mine_bound_poly.shp\u201d, will appear under \u201c  GIS Layers\u201d in the Project \nExplorer. It is behind the grid and the map coverages, so it is partially obscured.  \n4. Turn off \u201c  3D Grid Data\u201d and \u201c  Map Data\u201d in the Project Explorer.  \n\nGMS Tutorials   MODFLOW \u2013 LAK Package  \n \n Page 7 of 16 \u00a9 Aquaveo 2024  The polygon should a ppear as a black polygon on top of the map (detail in Figure 4).  \n \n      Figure 4      Detail showing the lake polygon  \nIn order to use this polygon in the conceptual model, convert it from a shapefile to a GMS \nfeature object in the \u201c  lake\u201d coverage. Do the following to convert the polygon:  \n5. Select \u201c  GIS Layers\u201d in the Project Explorer.  \n6. Select GIS | Shapes \u2192 Feature Objects  to bring up the Step 1 of 3 page of the \nGIS to Feature Objects Wizard  dialog.  \n7. Click Next >  to go to the Step 2 of 3  page of the GIS to Feature Objects Wizard  \ndialog.  \n8. Click Next >  to go to the Step 3 of 3 (Finished)  page of the GIS to Feature \nObjects Wizard dialog (there are no attributes with the shapefile).  \n9. Click Finish  to close the GIS to Feature Objects Wizard  dialog.  \nThe Shapes \u2192 Feature Objects  command adds the new feature objects to the active \ncoverage. Since the \u201c  lake\u201d coverage  is currently active, the mine boundary polygon \nshould have been added to the \u201c  lake\u201d coverage. To confirm, do the following:  \n10. Turn off \u201c  GIS Layers\u201d in the Project Explorer.  \n11. Turn on the\u201c  lake\u201d coverage in the Project Explorer.  \nThe lake is visible as a polygon in the \u201c  lake\u201d  coverage ( Figure 5). \n \n      Figure 5      The lake polygon in the lake coverage  \n\nGMS Tutorials   MODFLOW \u2013 LAK Package  \n \n Page 8 of 16 \u00a9 Aquaveo 2024  3.3 Setting up the Lake TIN  \nBefore entering the lake properties, it is necessary to create a TIN representing the \ngeometry (elevations) of the bottom of the mine. This TIN is used when mapping to \nMODFLOW to mark the lake cells and assign the proper layer elevations to the cells in \nthe MODFLOW grid in th e vicinity of the bottom of the mine. To build the TIN, first create \nthe TIN from the mine boundary polygon, then interpolate the elevations to the TIN from a \nscatter point set.  \n1. Select the \u201c  lake\u201d coverage to make it active.  \n2. Select Feature Objects | Map \u2192  TIN to bring up the Properties  dialog.  \n3. Enter \u201cmine bottom\u201d as the TIN name . \n4. Click OK to close the Properties  dialog.  \nA new \u201c  mine bottom\u201d TIN will appear under the \u201c  TIN Data\u201d folder in the Project \nExplorer, and the TIN will be visible in the Graphics W indow ( Figure 6). The density of the \ntriangles in the TIN is a function of the vertex spacing on the arcs defining the polygon \nboundary. If necessary, the spacing can be adjusted using Redistribute Vertices . In this \ncase, the spacing is acceptable and no changes need to be made.  \n \n      Figure 6      The mine bottom TIN  \nDo as follows to interpolate the elevations:  \n5. Fully expand th e \u201c  2D Scatter Data\u201d folder in the Project Explorer.  \n6. Right -click on the\u201c  excavation\u201d scatter set, select Interpolate To  | Active TIN  to \nbring up the Interpolate \u2192 Object dialog.  \n7. Enter \u201celevations\u201d as the Interpolated dataset name .  \n8. Click OK to close the Interpolate \u2192 Object  dialog.  \nNotice some new contours appear on the TIN. Before continuing, view the TIN in oblique \nview to confirm the interpolation results:  \n9. Deselect Ortho Mode   at the top of the GMS window.  \n10. Switch to Oblique View  . \n\nGMS Tutorials   MODFLOW \u2013 LAK Package  \n \n Page 9 of 16 \u00a9 Aquaveo 2024  Use Zoom   and Rotate  to view the shape of the mine in 3D ( Figure 7). When \nfinished, change the view back to what it was before by doing the following:  \n11. Switch to Plan View  . \n12. Reselect  Ortho Mode  . \n \n      Figure 7      TIN with elevations and the lake polygon  \n3.4 Assigning the Polygon Properties  \nIt is now possible to assign the lake properties to the mine polygon.  \n1. Select the \u201c  lake\u201d coverage in the Project Explorer to make it active.  \n2. Using the Select Objects  tool, double -click on the lake polygon to bring up the \nAttribute Table  dialog.  \n3. Enter \u201cmine\u201d in the Name  column.  \n4. Select \u201clake\u201d from the drop -down in the Type  column.  \n5. Enter  \u201c2300.0\u201d in the Init. Stage (m)  column.  \n6. Enter \u201c1801.0\u201d in the Min. Stage (m)  column.  \n7. Enter \u201c2460.0\u201d in the Max. Stage (m)  column.  \n8. Click on the  button in the Bathymetry  column to bring up the Select TIN  \ndialog.  \n9. Select \u201c  mine bottom\u201d and click OK to clos e the Select TIN  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 LAK Package  \n \n Page 10 of 16 \u00a9 Aquaveo 2024  The value in the Lake Leakance (1/d)  column represents the leakance (K/thickness) of \nthe lake bottom sediments. Since this tutorial is simulating an excavation, there are no \nlake bottom sediments, so input an arbitrarily large lea kance value to simulate minimal \nresistance to flow.  \n10. Enter \u201c1e6\u201d in the Lake Leakance (1/d)  column.  \nFor the precipitation, enter a value in units of m/d that corresponds to a rate of just under \n0.5 m/yr.  \n11. Enter \u201c0.0013\u201d in the Precipitation (m/d)  column.  \nSince the excavation will be dewatered, it is advisable to be conservative and leave the \nEvaporation at zero.  \nThe Runoff  represents the volumetric inflow from the adjacent watershed. The basin \nfeeding into the mine has an area of about 3,000,000 m2, so assume that about one -fifth \nof the precipitation in this area turns into runoff, giving us a volumetric rate of \n0.0013/5*3e6 = 780 m3/d. \n12. Enter \u201c780.0\u201d in the Runoff (m^3/d)  column.  \nThe Withdrawal  rate represents the volumetric extraction rate due to anthro pogenic \nactivities. The tutorial will use this term to represent the pumping rate used to dewater the \nwell. Start with an estimate and then re -run the model until the stage is near the bottom of \nthe mine. Enter the number as a positive value since it is as sumed to be extracted by \ndefault.  \n13. Enter \u201c2000.0\u201d in the Withdrawal (m^3/d)  column.  \nFinally, there are two columns for the Parent Lake  and Sill Elevation (m) . These \nproperties are used to link multiple lakes together into a system where a large lake can \nchange into multiple smaller lakes as the water level drops. This tutorial will not need to \nuse this feature.  \nThere is also an option called Adjust Cell Elev . This option is used to modify the top \nelevations of the active cells just beneath the lake cells so that the elevations match the \nlake bathymetry. This option leads to more accurate stage -volume relationships, but it \ncan make the model less robust. Leave the option off for this study.  \n14. Click OK to exit the Attribute Table  dialog.  \n \n      Figure 8      Lake properties in the Attribute Table dialog  \n3.5 Mapping to MODFLOW  \nAt this point, it is possible to run the Map \u2192 MODFLOW  command to discretize the \nconceptual model data to the MODFLOW input arrays on the 3D grid. The mine boundary \npolygon and the mine bottom TIN are used to identify the set of cells that lie inside the \n\nGMS Tutorials   MODFLOW \u2013 LAK Package  \n \n Page 11 of 16 \u00a9 Aquaveo 2024  body of the mine. These cells are marked as lake cells and are set to be inactive \n(IBOUND = 0).  \nThe elevations of the cells adjacent to the bottom of the mine are adjusted up or down to \nmatch the mine bottom when selecting the Adjust Cell Elev.  field in the polygon attributes \ntable. A lake object is created i n the MODFLOW Lake Package  dialog and the lake \nproperties entered in the previous section are inherited by this object. The leakance \nvalues entered in the previous step are assigned to all grid cells on the perimeter of the \nlake.  \n1. Turn on \u201c  3D Grid Data\u201d and turn off the \u201c  mine bottom\u201d TIN in the Project \nExplorer.  \n2. Select Feature Objects | Map \u2192 MODFLOW  to bring up the Map \u2192 Model  \ndialog.  \n3. Click OK to accept the defaults and close the Map \u2192 Model  dialog.  \n3.6 The Lake Package Dialog  \nNow to look at  the MODFLOW Lake Package  dialog to see how the conceptual model \nwas mapped to the grid.  \n1. Select MODFLOW | Optional Packages | LAK \u2013 Lake\u2026  to bring up the \nMODFLOW Lake Package  dialog.  \nThe MODFLOW Lake Package dialog has some global options at the top and a list of \nlakes at the bottom. Notice there is one lake listed, and it has the values that were \nentered into the conceptual model.  \nLakes are located in the grid using 2D arrays of lake IDs.  \n \n      Figure 9      MODFLOW Lake Package dialog  \n\nGMS Tutorials   MODFLOW \u2013 LAK Package  \n \n Page 12 of 16 \u00a9 Aquaveo 2024  2. Click Lake IDs\u2026  to bring up the Lake ID  dialog.  \n3. Use the scroll bars in the 2D array to find the area with 1s (rows 21 \u201332 and \ncolumns 23 \u201334). \nThis is where the lake is in the grid. Each lake has a unique ID number. If there were \nadditional lakes, the re would be other areas with different ID numbers (2, 3, and so on).  \n4. Change the Layer  field to \u201c2\u201d.  \nNotice the values are all \u201c0\u201d in this layer, meaning the lake does not extend into the \nsecond layer of the model.  \n5. Click OK to exit the Lake ID dialog.  \n6. Click  OK to exit the MODFLOW Lake Package dialog.  \n3.7 Turning on the GAGE Package  \nTo determine the stage in the mine resulting from our selected pumping rate, this tutorial \nwill use the GAGE package. Turning on the GAGE package for the lake causes \nMODFLOW to generate a text file which contains a list of stages versus time steps.  \n1. Select MODFLOW | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage dialog.  \n2. Click Packages\u2026  to bring up the MODFLOW Packages / Processes dialog  \n3. In the Optional packages / processes  section, turn on GAGE \u2013 Gage . \n4. Click OK to exit the MODFLOW Packages / Processes dialog.  \n5. Click OK to exit the MODFLOW Global/Basic Package dialog.  \nNext, add the lake to the GAGE package:  \n6. Select MODFLOW | Optional Packages | GAGE \u2013 Gage\u2026  to bring u p the Gage \nPackage  dialog.  \n7. Click Add All Lakes  to add the lake to the Lake Gages  section.  \n8. Click OK to close the Gage Package  dialog.  \n3.8 Changing the Solver  \nBefore continuing, it is necessary to change the solver option to use the SIP solver. This \nsolver works  better than the other solvers for this particular problem.  \n1. Select MODFLOW | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage dialog.  \n2. Click Packages\u2026  to bring up the MODFLOW Packages / Processes dialog.  \n3. In the Solver  section, select SIP1 \u2013 Strongly Impl. Proc . \n4. Click OK to exit the MODFLOW Packages / Processes dialog.  \n5. Click OK to exit the MODFLOW Global/Basic Package dialog.  \nNext, adjust the maximum number of iterations.  \n6. Select MODFLOW | SIP1 \u2013 Strongly Impl. Proc. Solver \u2026 to bring up the \nMODFLOW SIP Package dialog.  \n7. Enter \u201c1000\u201d in the Maximum iterations per time step (MXITER) field.  \nGMS Tutorials   MODFLOW \u2013 LAK Package  \n \n Page 13 of 16 \u00a9 Aquaveo 2024  8. Click OK to close the MODFLOW SIP Package  dialog.  \n3.9 Running the MODFLOW Simulation  \nNow to save the changes and run MODFLOW:  \n1. Save   the project . \n2. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n3. When MODFLOW has finished running, turn on Read solution on exit  and Turn \non contours (if not on already) . \n4. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.  \nNotice that the head contours indicate slight drawdown of the water table around the \nmine.  \n3.10 Viewing the Results  \nNext, determine the stage in the mine as a result of the selected pumping rate using the \nMODFLOW -generated gage file. The gage file can be accessed from the Project \nExplorer:  \n1. Fully expand the \u201c  3D Grid Data\u201d folder in the Project Explorer.  \n2. In the Project Explorer, under \u201c  mine01 (MODFLOW)\u201d, expand \u201c  Gage \nFiles\u201d, then double -click on \u201c  mine01_mine.gag\u201d to bring up the View Data File  \ndialog.  \nNote that this dialog ma y not appear if the Never ask this again  option has been \npreviously checked. If this is the case, skip to step 4 below.  \n3. Select the desired text editor from the Open with  drop-down and click OK to open \n\u201cmine01_mine.gag\u201d in that application.  \n4. Notice that the stage value listed on the last line is approximately 2257 m.  \nSome drawdown has occurred but still has a long ways to go to dewater the mine.  \n5. Close the text editor and return to GMS.  \n3.11 Modifying the Model  \nNext to increase the pumping rate and  run the model again to see the effect on the stage. \nHowever, be careful. The LAK3 package is quite sensitive to the initial conditions. For \nexample, if the pumping rate is changed to 10,000 m^3/d, the solution will not converge. \nMake smaller changes to th e pumping rate and also adjust the starting heads and the \ninitial stage to improve convergence.  \nThere are two ways to edit the lake values. In the first, edit the conceptual model and \nthen map the changes to the grid again. In the second, edit the grid dir ectly by using the \nMODFLOW Lake Package  dialog. The second method does not change the conceptual \nmodel, however, so if the conceptual model is remapped to the grid, any changes made \ndirectly to the grid will be overwritten. In this tutorial, the first meth od will be used.  \nDo the following to change the lake properties:  \n1. Select the \u201c  lake\u201d coverage in the Project Explorer to make it active.  \n\nGMS Tutorials   MODFLOW \u2013 LAK Package  \n \n Page 14 of 16 \u00a9 Aquaveo 2024  2. Using the Select Objects   tool, double -click on the lake polygon to bring up the \nAttribute Table  dialog.  \n3. Enter \u201c2200.0 \u201d in the Init. Stage (m)  column.  \n4. Enter \u201c2500.0\u201d in the Withdrawal  column.  \n5. Click OK to exit the Attribute Table  dialog.  \nNow to map these changes from the conceptual model to the grid:  \n6. Click Map \u2192 MODFLOW   to bring up the Map \u2192 Model  dialog.  \n7. Click OK to acc ept the defaults and close the Map \u2192 Model  dialog.  \nNext, change the starting heads to match the current solution.  \n8. Select the MODFLOW | Global Options\u2026  to bring up the MODFLOW \nGlobal/Basic Package dialog.  \n9. Click Starting Heads\u2026  to bring up the Starting Heads  dialog.  \n10. Click 3D Dataset \u2192 Grid\u2026  to bring up the Select Dataset  dialog.  \n11. Since the \u201cHead\u201d dataset is already selected, click OK to copy the head solution \nto the starting heads array and close the Select Dataset  dialog.  \n12. Click OK to exit the Starting Heads  dialog.  \n13. Click OK to exit the MODFLOW Global/Basic Package dialog.  \n3.12 Running the MODFLOW Simulation  \nIt is now time to save these changes and run MODFLOW again.  \n1. Save   the project . \n2. Select MODFLOW  | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n3. When MODFLOW has finished running, turn on Read solution on exit  and Turn \non contours (if not on already) . \n4. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.  \n3.13 Viewing the Results  \nNotice that there is now a little more drawdown ar ound the mine.  \n1. Fully expand the \u201c  3D Grid Data\u201d folder in the Project Explorer.  \n2. In the Project Explorer, under \u201c  mine01 (MODFLOW)\u201d, expand \u201c  Gage \nFiles\u201d, then double -click on \u201c  mine01_mine.gag\u201d to bring up the View Data File  \ndialog.  \nAgain, this dialog  may not appear if the Never ask this again  option has been previously \nchecked. If this is the case, skip to step 4 below.  \n3. Select the desired text editor from the Open with  drop-down and click OK to open \n\u201cmine01_mine.gag\u201d in that application.  \n4. Notice that the stage value listed on the last line is approximately 2230 m.  \n\nGMS Tutorials   MODFLOW \u2013 LAK Package  \n \n Page 15 of 16 \u00a9 Aquaveo 2024  This represents a drop of 27 m from the previous iteration.  \n5. Close the text editor and return to GMS.  \n4 Iterating the Solution Process  \nNormally, most real -life projects would require a series of iterations of sections 3.11 to \n3.13 in order to find the optimal solution. These iterations involve gradually increasing the \npumping rate and updating the initial stage and starting heads array until the desired \nsolution is achieved. If  the solution does not converge for a particular iteration, make a \nsmaller change to the withdrawal rate.  \nBe careful while iterating, as in some cases the model will appear to converge, but the \nsolution will not be valid. If there are any doubts about the solution, open the \n\u201cmodel01.out\u201d file in the \u201cmine01 (MODFLOW)\u201d folder in the Project Explorer and look at \nthe lake package iteration output about two -thirds of the way down the file.  \nAs mentioned at the beginning of Section  3.11, it may be easier to edit the lake in the \nMODFLOW Lake Package  dialog while iterating instead of editing in the conceptual \nmodel. Editing the lake in the dialog allows for skipping the Map \u2192 MODFLOW  step, \nthereby saving a little time. Just remember that the values in the conceptual  model will be \nout of sync with the values on the grid when using this method.  \nIn this case, follow all the steps in sections 3.11 to 3.12, entering the following to obtain \nthe final solution:  \n1. Enter \u201c1810.0\u201d for step 3 in section 3.11.  \n2. Enter \u201c6340.0\u201d for s tep 4 in section 3.11.  \nOnce done, the model should appear similar to Figure 10. \n \n      Figure 10      The final contours upo n reaching the optimal solution  \n\nGMS Tutorials   MODFLOW \u2013 LAK Package  \n \n Page 16 of 16 \u00a9 Aquaveo 2024  5 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 LAK Package\u201d tutorial. The following key concepts \nwere demonstrated and discussed in this tutorial:  \n\uf0b7 To use the Lake package, both a TIN representing the lake bathymetry and a \npolygon representing the lake boundary must be created.  \n\uf0b7 The lake properties are assigned to the lake polygon in the Map  module.  \n\uf0b7 The flow between the aquifer and the lake is a function of both the aquifer \nconductance and the lakebed leakance.  \n\uf0b7 The Lake package computes the stage in the lake based on a flow budget for the \nlake and the lake geometry.  \n\uf0b7 To determine the amount of pumping required for an excavation, simulate the \nexcavation using the Lake package and adjust the withdrawal rate until the \ndesired stage i s found.  \n \n\n", "filename": "MODFLOW-LAKPackage.pdf", "pages": 16}, "MODFLOW-LGR": {"text": "GMS Tutorials   MODFLOW -LGR \n Page 1 of 19 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013LGR  \nCreate MODFLOW -LGR models with locally refined grids using GMS  \n \nObjectives   \nGMS supports building MODFLOW -LGR models with nested child grids. This tutorial shows the various \nparts of the MODFLOW -LGR interface in GMS . \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Grid \nApproach  \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach I  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 20\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW -LGR \n Page 2 of 19 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  3 \n2 Opening the Non -LGR Model  ................................ ................................ ..............................  3 \n2.1 Saving with a Different File Name  ................................ ................................ .................  4 \n2.2 Switching to MODFLOW -LGR ................................ ................................ ......................  4 \n2.3 Saving and Running MODFLOW  ................................ ................................ ..................  5 \n3 Creating the Child Grid  ................................ ................................ ................................ ....... 5 \n3.1 Examining the Child Grid  ................................ ................................ ..............................  7 \n3.2 LGR Options  ................................ ................................ ................................ ...............  10 \n3.3 Map \u2192 MODFLOW  ................................ ................................ ................................ .... 12 \n3.4 Checking the Simulation  ................................ ................................ .............................  12 \n3.5 Saving and Running MODFLOW  ................................ ................................ ................  12 \n4 Viewing the Solution  ................................ ................................ ................................ .........  13 \n4.1 Flow Budget  ................................ ................................ ................................ ................  13 \n5 BFH Package  ................................ ................................ ................................ ......................  15 \n5.1 Running the Child Model Independently  ................................ ................................ ..... 15 \n5.2 Running the Parent Independently  ................................ ................................ .............  17 \n6 Conclusion  ................................ ................................ ................................ .........................  19 \n \n1 Introduction  \nMODFLOW -LGR can be used to create MODFLOW models that contain locally refined \nregions in areas where smaller cell sizes are desired. These refined regions are \nconsidered child grids of a parent grid. MODFLOW -LGR solves for the heads and flows \nof the child and parent grids using an iterative technique while maintaining consistency in \nthe boundary conditions along the borders of the child and parent grids.  \nThe problem in thi s tutorial is one of the example problems included with MODFLOW -\nLGR. It consists of a meandering river in a regional model as shown in Figure 1. The area \nis modeled us ing MODFLOW -2005 and a three -layer grid with specified heads on the left \nand right with steady -state conditions.  \nNo-flow boundaries occur on the north and south and flow is generally from west to east. \nA child grid will be used in the area where the river  bends are close together in order to \nobtain a more accurate solution in this area.  \nThis tutorial will discuss and demonstrate the following:  \n\uf0b7 GMS supports MODFLOW -LGR and parent/child models.  \n\uf0b7 MODFLOW -LGR gives the same results as MODFLOW -2005 if there are no \nchild grids present.  \n\uf0b7 Child grids appear in the Project Explorer  under the parent grid.  \n\uf0b7 Only one grid and MODFLOW simulation is active at a time. Only cells in the \nactive grid can be selected.  \n\uf0b7 The LGR Options  dialog shows the child grids and the informat ion that will go in \nthe LGR control file.  \n\uf0b7 The BFH package can be used to run the parent or child model independently.  \nGMS Tutorials   MODFLOW -LGR \n \n Page 3 of 19 \u00a9 Aquaveo 2024   \n      Figure 1      Sample problem to be solved1 \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary,  launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state. Click Don\u2019t Save  if asked to save changes.  \n2 Opening the Non -LGR Model  \nStart by opening the non -LGR regional model that has al ready been created using \nMODFLOW -2005.  \n1. Click Open   to bring up the Open  dialog . \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the mflgr \\mflgr  directory and select \u201c start.gpr \u201d. \n4. Click Open to import the project and close the Open  dialog.  \nThe Graphics Window should appear similar to Figure 2. \n                                                      \n1 Mehl, Steffen W. and Hill, Mary C. (2007). \u201cMODFLOW -2005, The U.S. Geological Survey \nModular Ground -Water Model \u2014Documentation of Shared Node Local Grid Refinement (LGR) and \nthe Boundary Flow an d Head (BFH) Package\u201d in U.S. Geological Survey Techniques and Methods \n6-A12, p.43. http://pubs.usgs.gov/tm/2006/tm6a12/pdf/TM6 -A12.pdf   \n\nGMS Tutorials   MODFLOW -LGR \n \n Page 4 of 19 \u00a9 Aquaveo 2024   \n      Figure 2      Non-LGR regional model  \n2.1 Saving with a Different File  Name  \nBefore making any changes, save the project under a new name.  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c lgr.gpr \u201d as the File name . \n4. Click Save to save the project unde r the new name and close the Save As  \ndialog.  \nIt is recommended to periodically Save   as the tutorial progresses . \n2.2 Switching to MODFLOW -LGR \nNow switch the model from MODFLOW -2005 to MODFLOW -LGR.  \n1. Select MODFLOW | Global Options \u2026 to open the MODFLOW Global/Basic \nPackage dialog.  \n2. In the MODFLOW version  section, select LGR. \n3. Click OK to close the MODFLOW Global/Basic Package  dialog.  \n\nGMS Tutorials   MODFLOW -LGR \n \n Page 5 of 19 \u00a9 Aquaveo 2024  2.3 Saving and Running MODFLOW  \nBefore adding a child model, save the changes and run MODFLOW to make sure \nMODFLOW -LGR gi ves the same results as MODFLOW -2005.  \n1. Save   the project.  \n2. Click Run MODFLOW    to bring up the MODFLOW  model wrapper dialog.  \n3. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to exit the MODFLOW  mode l wrapper dialog and import the solution.  \nNotice there is no difference in the contours \u2014the MODFLOW -LGR solution is the same \nas the MODFLOW -2005 solution. Expand the \u201c  3D Grid Data\u201d folder and switch \nbetween the \u201c  start (MODFLOW)\u201d and \u201c  lgr (MODFLOW)\u201d s olutions in the Project \nExplorer  to verify that they are identical.  \n3 Creating the Child Grid  \nNow the child grid can be created by selecting a range of cells in the regional model. The \narea is marked by a rectangle that can be turned on. Start with turning o ff the contours to \nmake things easier to see.  \n1. Click Display Options   to bring up the Display Options  dialog.  \n2. Select \u201c3D Grid Data\u201d from the list on the left.  \n3. On the 3D Grid  tab, in the Active dataset  section, turn off Contours . \n4. Click OK to close the Display Options  dialog.  \n5. In the Project Explorer , turn on the \u201c  Annotation Data \u201d folder.  \nA red rectangle should appear.  \n6. Using the Select Cells   tool, drag a box to select the cells in the red rectangle. \nBe sure to get all the cells touched by the rectangl e. The region of selected cells \nshould be 8 wide by 7 high ( Figure 3). \n\nGMS Tutorials   MODFLOW -LGR \n \n Page 6 of 19 \u00a9 Aquaveo 2024   \n      Figure 3      The selected cells for the child grid  \n7. Right -click in the selected area and select Create Child Grid \u2026 to bring up the \nCreate Child Grid  dialog ( Figure 4). \n \n      Figure 4      Create Child Grid dialog  \n8. Enter \u201c2\u201d for the Bottom layer .  \n9. In the Vertical refinement per layer  section, enter \u201c 3\u201d in the Refinement column \nfor parent layers 1 and 2.  \n10. Click OK to close the Create Child Grid  dialog.  \n11. In the Project Explorer , turn off the \u201c  Annotation Data \u201d folder to hide the red \nrectangle.  \n\nGMS Tutorials   MODFLOW -LGR \n \n Page 7 of 19 \u00a9 Aquaveo 2024  A nested child grid should now be visible within the cells that were previously selected \n(Figure 5). \n \n      Figure 5      Model with child grid  \n3.1 Examining the Child Grid  \nNotice that the cells on the outside boundary of the child grid have constant head \nboundary conditions. In MODFLOW -LGR terminology, these child cells on the sides are \none-half cells and on the corners they are one -quarter cells. Note that GMS always draws \nthe entire cell even though only a half or quarter of the cell actually exists as far as \nMODFLOW is concerned. Where the child cell center coincides with a parent cell cen ter, \nit is a shared node. Head and flows are iteratively computed along this boundary and \nshared between the parent and child models.  \nLook at the Project Explorer  and take note of the following : \n\uf0b7 A new 3D grid item called \u201c  child\u201d has been added to the \u201c  3D Grid Data\u201d \nfolder. It is under the original parent, \u201c  grid\u201d.  \n\uf0b7 The original 3D grid  icon is now grey, indicating that it is no longer active. \nThere is only one active grid at a time. Only cells in the active grid can be \nselected. To activate a 3D grid , simply click on its icon.  \n\uf0b7 A \u201c  MODFLOW\u201d model has appeared under the new child grid.  \n\uf0b7 The original MODFLOW  icon under the parent grid is now grey, indicating it is \ninactive. Similar to 3D grids, there is only one MODFLOW model active at a time. \nTo activ ate a MODFLOW model, simply click on its icon or on the icon of its \nparent grid. Activating a MODFLOW model also activates its grid.  \n\nGMS Tutorials   MODFLOW -LGR \n \n Page 8 of 19 \u00a9 Aquaveo 2024   \n      Figure 6      Project Explorer with child grid  \nNow examine grid activity and the child grid. \n1. With the Select Cells   tool, try to select a cell in the parent grid. This isn\u2019t \npossible because it is inactive.  \n2. Now try to select cells in the child grid. This is possible because it is active.  \n3. In the Project Explorer , click on the parent \u201c grid\u201d to make it activate.  \n4. Now try to select cells in the parent grid and the child grid. When clicking in the \narea of the child grid, cells in the parent grid are being selected.  \n5. Switch to Front View  . \nThe display should show a grid sloping slightly to the ri ght (Figure 7). \n\nGMS Tutorials   MODFLOW -LGR \n \n Page 9 of 19 \u00a9 Aquaveo 2024   \n      Figure 7      Front view, row 6  \n6. Change the row being viewed by using the up and down arrows on the  Mini Grid \nToolbar .  \nNotice that both the parent and child grids change while viewing different rows. The Mini \nGrid Toolbar  acts on the active grid but the child grid row is kept in sync with the parent \ngrid row.  \n7. On the Mini Grid Toolbar , turn on Multiple grids  to bring up the Current Ortho \nLevels  dialog ( Figure 8). \n \n      Figure 8      Current Ortho Levels dialog  \nThis dialog shows which row is  currently being displayed on all grids. This dialog is \nmodeless, so the GMS interface can continue being used while it is being displayed. Feel \nfree to move the dialog to a convenient location on the screen.  \n8. Change the grid row up and down.  \nNotice that t he values change in the Current Ortho Levels  dialog. The parent grid rows \nchanges once for every three child grid rows. GMS is finding and displaying the child row \nthat corresponds with the current parent row. Now disable syncing of the ortho levels.  \n9. Click Display Options   to bring up the Display Options  dialog.  \n10. Select \u201c3D Grid Data\u201d from the list on the left.  \n11. On the 3D Grid  tab, in the top section, turn off Synch ortho levels with all grids . \n12. Click OK to close the Display Options  dialog.  \nThe top and bottom elevations are such that the model slopes down from left to right. \nNotice that the child grid extends down to the middle of the second layer. This follows the \nLGR rules for vertical refinement as shown in Figure 9. \n\nGMS Tutorials   MODFLOW -LGR \n \n Page 10 of 19 \u00a9 Aquaveo 2024   \n      Figure 9      Vertical refinement rules2 \nReferring to Figure 9:  \nCross -sectional schematic of vertical refinement interface of (a) a one -layer parent \nmodel refined to a  three -layer child model, (b) a multi -layer parent model where the \nchild refinement varies vertically and terminates at the shared node of the second \nparent layer, (c) a multi -layer parent model where the child refinement varies \nvertically and extends to t he bottom of the parent model, (d) a multi -layer parent \nmodel where the child refinement terminates at the first shared node of the parent, \nwhich is not possible, and (e) a multilayer parent model where the child refinement \nterminates at the bottommost sha red node, which is not possible.3 \n13. Switch to Plan View  . \n14. Close   the Current Ortho Levels  dialog.  \n3.2 LGR Options  \nNow look at the LGR Options  dialog.  \n1. Select the parent \u201c  grid\u201d in the Project Explorer  to make it active . \n                                                      \n2 Mehl, p.13. http://pubs.usgs.gov/tm/2006/tm6a12/pdf/TM6 -A12.pdf   \n3 Ibid. \n\nGMS Tutorials   MODFLOW -LGR \n \n Page 11 of 19 \u00a9 Aquaveo 2024  2. Select MODFLOW | Global Options \u2026 to open the MODFLOW Global/Basic \nPackage \u2013 Parent dialog.  \nNotice the name of the dialog ends in \u201c \u2013 Parent\u201d. When LGR is in use, the MODFLOW \ndialogs will end in \u201c \u2013 Parent\u201d or \u201c \u2013 child\u201d depending on which MODFLOW simulation is \ncurrently active. The grids ca n be renamed and the new grid name will be displayed in \nthe MODFLOW dialogs for the child grids. For the parent grid, the MODFLOW dialogs will \nalways say \u201c \u2013 Parent\u201d no matter what the parent grid is renamed.  \nThe effects of the options in the main MODFLOW  menu depend on which MODFLOW \nsimulation is active. Since the parent simulation is currently active, all the main \nMODFLOW  menu commands will act on it. If the child model is made active, the main \nMODFLOW  menu commands will act on the child model.  \nThe same me nu commands can also be found by right -clicking on the \u201c  MODFLOW\u201d \nitem in the Project Explorer . The Project Explorer  may be used to avoid having to \nremember which model the main menu is acting on.  \n3. Click LGR Options \u2026 to bring up the LGR Options  dialog ( Figure 10). \n \n      Figure 10      LGR Options dialog  \nThe items in this dialog correspond to the LGR control file. This file is passed to \nMODFLOW -LGR when running a parent/child paired simulation. The file also contains \ninformation on the parent and child models.  \nThe top Child grids  spreadsheet lists all the child grids. The lower Vertical refinement for \nchild grid  spreadsheet displays the layer -by-layer vertical refinement for the selected child \ngrid. The dimensions and refinement of the child grids cannot be edited here, but the \nvalues to be written to the LGR Control File ( NPLBEG, NPLEND , etc.) can be seen.  \n4. Selec t the child grid by clicking in any field in the first row of the Child grids  \nspreadsheet. This activates the Vertical refinement for child grid  section at the \nbottom of the dialog.  \n5. Click Cancel  to exit the LGR Options  dialog.  \n6. Click Cancel  to exit the MODF LOW Global/Basic Package \u2013 Parent dialog.  \n\nGMS Tutorials   MODFLOW -LGR \n \n Page 12 of 19 \u00a9 Aquaveo 2024  3.3 Map \u2192 MODFLOW  \nNow that a child grid has been created, the conceptual model must be mapped to it so \nthat the river is represented in the child model.  \n1. Select the \u201c  child\u201d grid in the Project Explorer  to make it acti ve. \n2. Enter \u201c1\u201d in the Lay (k)  field of the Mini Grid Toolbar . \n3. Click Map \u2192 MODFLOW    to bring up the Map \u2192 Model  dialog.  \n4. Click OK to accept the defaults and close the Map \u2192 Model  dialog.  \nThe river boundary conditions have now been added to all the cells in the child grid under \nthe river arc ( Figure 11).  \n \n      Figure 11      After M ap \u2192 MODFLOW with child model  \n3.4 Checking the Simulation  \nIt is recommended to always run the Model Checker  prior to running MODFLOW.  \n1. Select MODFLOW | Check Simulation \u2026 to open the Model Checker dialog . \n2. Click Run Check . There should be no warnings or errors detected.  \nNotice that the model checker checked both the  parent and the child models. Regardless \nof which grid/model is active, the model checker will always look at all MODFLOW \nmodels.  \n3. Click Done  to close the Model Checker  dialog.  \n3.5 Saving and Running MODFLOW  \nNow save the work and run MODFLOW.  \n1. Save   the project . \n2. Click Run MODFLOW    to bring up the MODFLOW  model wrapper dialog.  \n\nGMS Tutorials   MODFLOW -LGR \n \n Page 13 of 19 \u00a9 Aquaveo 2024  3. When the model finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and exit the MODFLOW  model wrapper dialog.  \nThere are two solutions: one for the parent and one for the child.  \n4 Viewing the Solution  \nContours are displayed for both the parent and child grids. Notice there is some overlap \naround the edges. Although the parent cells around the parent/child interface are half \ncells and three -quarter cells, GMS draws and contours the entire cell.  \n1. Turn off the \u201c  child\u201d grid.  \nNotice that the parent cells in the region of the child grid are inactive and not displayed. \nThe cell activity is a property of the head solution dataset. The  IBOUND array still has \nthem marked as active, as it should. This can be verified by examining the parent \nIBOUND array.  \n2. Turn on the \u201c  child\u201d grid.  \nNotice the contours of the child and parent seem to match fairly well.  \n4.1 Flow Budget  \nNow examine the flow bud get. \n1. Select the parent  \u201c grid\u201d to make it active.  \n2. Under \u201c  lgr (MODFLOW) \u201d, double -click on the \u201c  lgr.out \u201d file to bring up the \nView Data File  dialog.  \nThis dialog will not appear if Never as k this again  was previously turned on in this dialog. \nIf this is  the case, skip to step 4.  \n3. Select the desired text editor from the Open with  drop-down and click OK to open \nthe data file and close the View Data File  dialog.  \n4. Locate the \u201c PARENT FLUX B.C. \u201d items in the budget summary near the bottom \nof the file (red stars in Figure 12). \n\nGMS Tutorials   MODFLOW -LGR \n \n Page 14 of 19 \u00a9 Aquaveo 2024   \n      Figure 12      Flow between parent and child grids  \nThis represents the flow between the parent and child models. There should be about 24 \nm3 in and 120 m3 out. That means 24 m3 flows from the child to the parent and 120 m3 \nflows from the parent to the child.  \n5. Close the \u201clgr.out\u201d file and return to GMS.  \n6. Under \u201c  lgr_child (MODFLOW) \u201d, double -click on the \u201c  lgr_child.out \u201d file to \nbring up the View Data File  dialog. As before, this dialog may not appear. If this \nis the case, skip to step 8.  \n7. Select the desired text editor from the Open with  drop-down and click OK to open \nthe data file and close the View Data File  dialog.  \n8. Locate the \u201c FLUX ACROSS PARENT -CHILD INTERFACE \u201d section near the \nbottom of the file ( Figure 13). \n \n      Figure 13      Flux across parent -child interface  \n\nGMS Tutorials   MODFLOW -LGR \n \n Page 15 of 19 \u00a9 Aquaveo 2024  Notice the flow in to the child and flow out to the parent are the same as what was just \nseen in the \u201c lgr.out \u201d file. Also notice the \u201c PARENT FLUX B.C. \u201d entries  are not listed in the \nbudget summary in this file.  \n9. Close the \u201clgr_child.out\u201d file and return to GMS.  \n10. Select MODFLOW | Flow Budget \u2026 to bring up the Flow Budget \u2013 Parent  dialog.  \nOn the Cell tab, notice that the flow budget does not include the \u201cPARENT FLUX  B.C.\u201d \nitem included in the OUT file. MODFLOW does not write this information to the CCF file \nfor either the parent or the child. GMS gets the flow budget numbers from the CCF file, \nnot the OUT file.  \n11. Click OK to exit the Flow Budget  \u2013 Parent  dialog.  \n5 BFH Pa ckage  \nThe BFH package was created to allow parent and child models to be run independently \nusing the coupling flux and head boundary conditions produced by LGR. To do this, the \nmodel is first run coupled using LGR to calculate and save the coupling boundar y \nconditions. Then the parent or child model is run independently by turning on the BFH \npackage and using the coupling boundary conditions saved in the first step. To practice \nthis, first run the child model independently and then run the parent model inde pendently.  \n5.1 Running the Child Model Independently  \nSaving  the Boundary Heads and Fluxes  \nIn order to run the child model independently, it is necessary to turn on the option to save \nthe coupling heads (IUCBHSV). If running the parent model independently, it i s \nnecessary to turn on the option to save the complimentary fluxes (IUPBFSV). In this \ncase, the plan is to run the parent independently, so it is necessary to turn on both \noptions.  \n1. Select the parent  \u201c grid\u201d to make it active.  \n2. Select MODFLOW | Global Optio ns\u2026 to open the MODFLOW Global/Basic \nPackage \u2013 Parent dialog.  \n3. Click LGR Options \u2026 to open the LGR Options dialog.  \n4. Turn on Save boundary fluxes  (IUPBFSV) at the top -right.  \n5. In the Child grids  spreadsheet, turn on Save BFH head IUCBHSV ,. \n6. Click OK to exit the LGR Options dialog.  \n7. Click OK to exit the MODFLOW Global/Basic Package \u2013 Parent dialog.  \nNow save the project with a new name so the solutions can be compared.  \n8. Select File | Save As \u2026 to bring up the Save As  dialog.  \n9. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n10. Enter \u201c lgr2.gpr \u201d as the File name . \n11. Click Save to save the project under the new name and close the Save As  \ndialog.  \nThis causes the following line to be written to the name file of the child model:  \n\nGMS Tutorials   MODFLOW -LGR \n \n Page 16 of 19 \u00a9 Aquaveo 2024   DATA         1787 \" lgr2_child.bf h_hed\" \nWhen the model is run, the boundary heads will be saved to this \u201c lgr2_child.bfh_hed \u201d file. \nAs nothing has been changed, the solution will not change.  \nRunning  MODFLOW  \nNow it is necessary to run MODFLOW in coupled mode.  \n1. Click Run MODFLOW    to bring up the MODFLOW  model wrapper dialog.  \n2. When the model finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n3. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.  \nTurn ing on BFH Package  \nNow it is necessary to use the boundary heads that were just saved in the \n\u201clgr2_child.bfh_hed \u201d file to run the child model independently. These heads are applied \naround the boundary of the child model.  \n1. Under the \u201c  child\u201d grid in the Project Explorer , right-click on  \u201c MODFLOW\u201d \nand select Global Options \u2026 to open the MODFLOW Global/Basic Package \u2013 \nchild dialog.  \n2. Click Packages \u2026 to open the MODFLOW Packages / Processes \u2013 child dialog.  \n3. In the Optional packages  / processes  section, turn on BFH \u2013 Boundary Flow and \nHead . \n4. Click OK to exit the MODFLOW Packages / Processes \u2013 child dialog.  \n5. Click OK to exit the MODFLOW Global/Basic Package \u2013 child dialog.  \nNow that it has been turned on, look at the options in the BFH Package.  \n6. Select the \u201c  child\u201d grid in the Project Explorer  to make it active . \n7. Under the \u201c  child\u201d grid, right -click on \u201c  MODFLOW\u201d and select Optional \nPackages | BFH \u2013 Boundary Flow and Head  to open the BFH Package dialog \n(Figure 14).  \nThe Head file  path will vary depending on the location where the project was saved.  \n \n      Figure 14      BFH Package dialog  \n\nGMS Tutorials   MODFLOW -LGR \n \n Page 17 of 19 \u00a9 Aquaveo 2024  By default, the \u201c lgr2_child.bfh_hed \u201d file that MODFLOW just created is listed in the Head \nfile field. This file and the Head unit #  will be written in the MODFLOW name file. When \nMODFLOW runs, it will read the heads from this file and apply them to the boundary of \nthe child model. Nothing e lse needs to change because GMS has defaulted the options \nin the desired way.  \n8. Click OK to exit the BFH Package  dialog.  \nSaving and Running MODFLOW  \nNow it is possible to run the child model independently.  \n1. Save   the project . \n2. Under \u201c  child\u201d in the Project Ex plorer , right -click on \u201c  MODFLOW\u201d and \nselect Run MODFLOW Uncoupled On Just This Model   to bring up the \nMODFLOW \u2013 child model wrapper dialog.  \nThis command causes GMS to launch MODFLOW on just the child model. MODFLOW -\nLGR is still used, but not in a coupled fashion.  \n3. When the model has finished, turn on Read solution on exit  and Turn on contours \n(if not on already) . \n4. Click Close  to import the solution and exit the MODFLOW \u2013 child model wrapper \ndialog.  \nNotice that the contours are the same as when the mo dels were run coupled. The BFH \npackage cannot be used when running MODFLOW -LGR in coupled mode, so the BFH \npackage in the child model would need to be turned off in order to rerun it.  \n5.2 Running the Parent Independently  \nThis tutorial will now demonstrate how the BFH package can be used to run the parent \nindependently. The option to save the complimentary fluxes (IUPBFSV) has already been \nturned on, so just turn on the BFH package in the parent model.  \nTurning on BFH Package  \nIt is necessary to use the boundary f lows that were saved in the \u201c lgr2.bfh_flw \u201d file to run \nthe parent model independently. These flows are applied to the boundary of the parent \nmodel around the child model.  \n1. Under \u201c  grid\u201d in the Project Explorer , right -click on the parent  \u201c MODFLOW \u201d \nmodel a nd select Global Options \u2026 to open the MODFLOW Global/Basic \nPackage \u2013 Parent dialog.  \n2. Click Packages \u2026 to open the MODFLOW Packages / Processes \u2013 Parent \ndialog.  \n3. In the Optional packages  / processes  section, turn on BFH \u2013 Boundary Flow and \nHead . \n4. Click OK to ex it the MODFLOW Packages / Processes \u2013 Parent dialog.  \n5. Click OK to exit the MODFLOW Global/Basic Package \u2013 Parent dialog.  \nAt this point, the BFH Package  dialog for the parent model would be opened to look at \nthe options. However, GMS has defaulted everything  to what is desirable, so just run the \nparent independently.  \n\nGMS Tutorials   MODFLOW -LGR \n \n Page 18 of 19 \u00a9 Aquaveo 2024  Save and Run MODFLOW  \nNow it is possible to run the parent model independently.  \n1. Save   the project . \n2. Under \u201c  grid\u201d, right -click on the parent  \u201c MODFLOW \u201d model and select Run \nMODFLOW Uncoupled On Just This Model   to bring up the MODFLOW \u2013 \nParent  model wrapper dialog.  \nThis command causes GMS to launch MODFLOW on just the parent model. MODFLOW -\nLGR is still used, but not in a coupled fashion.  \n3. When the model finishes, turn on Read solution on exit and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and close the MODFLOW  \u2013 Parent  model \nwrapper dialog.  \nGMS reads the solution and displays the contours. Notice there is a small difference in \nthe contours compared to the coupled solu tion ( Figure 15). \n \n      Figure 15      Final view after parent run independently  \n\nGMS Tutorials   MODFLOW -LGR \n \n Page 19 of 19 \u00a9 Aquaveo 2024  6 Conclusion  \nThis concludes the \u201c MODFLOW \u2013 LGR\u201d tutorial.  T his tutorial demonstrate d and \ndiscuss ed: \n\uf0b7 Importing an existing MODFLOW model.   \n\uf0b7 Switching the mode l to MODFLOW -LGR and running it.   \n\uf0b7 Adding a child grid.   \n\uf0b7 Running the parent and child coupled.   \n\uf0b7 Saving the boundary heads.   \n\uf0b7 Turning on the BFH package.   \n\uf0b7 Running  the child model independentl y using the boundary heads.  \n", "filename": "MODFLOW-LGR.pdf", "pages": 19}, "MODFLOW-LGR_Dual": {"text": "GMS Tutorials   MODFLOW -LGR Dual Refinement  \n Page 1 of 13 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW -LGR Dual Refinement  \nCreate a MODFLOW -LGR model with two locally refined grids using \nGMS  \n \nObjectives   \nThis tutorial  builds on the MODFLOW -LGR tutorial and shows how to create more than one child grid. \nThis tutorial covers parameters, MODPATH, and using the BFH package to check the accuracy of the \ncoupled boundary heads and flows . \nPrerequisite Tutorials  \n\uf0b7 MODFLOW -LGR Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 MODPATH/MP3DU \nInterface  \n Time  \n\uf0b7 20\u201335 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW -LGR Dual Refinement  \n Page 2 of 13 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  3 \n2 Opening the Starting Model  ................................ ................................ ................................  3 \n2.1 MODPATH  ................................ ................................ ................................ ....................  4 \n2.2 Parameters  ................................ ................................ ................................ ...................  4 \n2.3 Saving with a Different Name  ................................ ................................ .......................  4 \n3 Creating a Second Child Grid  ................................ ................................ .............................  5 \n4 LPF Package  ................................ ................................ ................................ ........................  6 \n5 Saving and Running MODFLOW  ................................ ................................ ........................  6 \n6 Examining Accuracy Using BFH Package  ................................ ................................ .........  7 \n6.1 Turning on IUPBFSV and IUCBHSV  ................................ ................................ ............  7 \n6.2 Turning on BFH Package  ................................ ................................ .............................  7 \n6.3 Saving and Running CHILD1  ................................ ................................ ........................  8 \n6.4 Examining the Accuracy  ................................ ................................ ...............................  8 \n7 Adding Well to Child  ................................ ................................ ................................ ............  9 \n7.1 Saving and Running CHILD1  ................................ ................................ ......................  10 \n7.2 Examining the Accuracy  ................................ ................................ .............................  10 \n8 Adding Well to Parent  ................................ ................................ ................................ ....... 11 \n8.1 Turning on BFH Package in the Parent Model  ................................ ...........................  11 \n8.2 Saving and Running the Parent  ................................ ................................ ..................  12 \n8.3 Examining the Accuracy  ................................ ................................ .............................  12 \n9 Conclusion  ................................ ................................ ................................ .........................  13 \n \n1 Introduction  \nMODFLOW -LGR can be used to create MODFLOW models that contain locally refined \nregions in areas where smaller cell sizes are desired. These refined regions are \nconsidered child grids of a parent grid. MODFLOW -LGR solves for the heads and flows \nof the child and parent grids using an i terative technique while maintaining consistency in \nthe boundary conditions along the borders of the child and parent grids.  \nMODFLOW -LGR can use multiple child grids. This tutorial builds on the \u201c MODFLOW -\nLGR\u201d tutorial and demonstrates how to create multipl e child grids. It discusses and \ndemonstrates:  \n\uf0b7 Importing an existing MODFLOW -LGR model.  \n\uf0b7 Examining the MODPATH model.  \n\uf0b7 Examining the parameters on the model.  \n\uf0b7 Adding a second child grid.  \n\uf0b7 Using the BFH package to check the accuracy of the coupled boundary hea ds \nand flows.  \n\uf0b7 Saving and running MODFLOW -LGR.  \nThe problem in this tutorial is one of the example problems included with MODFLOW -\nLGR.1 It is a simple, one -layer, confined, steady -state model containing two extraction \nwells as shown in Figure 1. No-flow boundaries occur on the north and south, and \nspecified head boundaries are defined on the east and west. Flow is generally to the \n                                                      \n1 Mehl, Steffan W. and Hill, Mary C. (2007). \u201cMODFLOW -2005, The U.S. Geological Su rvey \nModular Ground -Water Model \u2014Documentation of the Multiple -Refined -Areas Capability of Local \nGrid Refinement (LGR) and the Boundary Flow and Head (BFH) Package\u201d in U.S. Geological \nSurvey Techniques and Methods 6 -A21, p.6. http://pubs.usgs.gov/tm/2007/06A21/pdf/TM6 -\nA21_508.pdf  . \nGMS Tutorials   MODFLOW -LGR Dual Refinement  \n \n Page 3 of 13 \u00a9 Aquaveo 2024  wells. For this tutorial, a child grid h as been created around the area of the well on the \nleft. Another child grid will be created around the well on the right.  \n \n      Figure 1      Sample problem to be solved2 \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state. Click Don\u2019t Save  if asked to save changes.  \n2 Opening the Starting Model  \nStart by opening the existing model.  \n1. Click Open   to bring up the Open  dialog . \n2. Browse to the mflgr -dual/mflgr -dual directory for this tutorial and select \u201c start.gpr \u201d. \n3. Click Open  to import the project and close the Open  dialog.  \nThe Main Graphics Window should appear similar to Figure 2. \n                                                      \n2 Mehl (2007).  \n\nGMS Tutorials   MODFLOW -LGR Dual Refinement  \n \n Page 4 of 13 \u00a9 Aquaveo 2024   \n      Figure 2      Starting model  \n2.1 MODPATH  \nThis model includes a child grid around the well on the left side (grid cell edges are \nturned off but the grid shell is visible). It also includes pathlines generated by MODPATH. \nThe pathlines are on the parent grid and are generated from a solution that w as created \nby running MODFLOW -LGR independently on the parent model. MODPATH does not \nhandle pathlines crossing grid boundaries. In GMS, MODPATH particles and MODPATH \nsolutions can be generated on the parent model.  \n2.2 Parameters  \nBoth the parent and child mode ls use parameters and clusters to define hydraulic \nconductivity.  \n1. Select MODF LOW | Parameters \u2026 to open the Parameters dialog.  \n2. Notice that there are 5 parameters defined, then click Cancel  to close the \nParameters  dialog.  \n3. Select MODFLOW | LPF \u2013 Layer P roperty Flow \u2026 to bring up the LPF Package \n\u2013 Parent dialog.  \n4. Notice the warning note at the bottom about LPF parameters.  \n5. In the Layer data  section, notice that the Layer type  is set to Confined . \n6. Click Cancel  to close the LPF Package \u2013 Parent  dialog.  \nIt is perfectly acceptable to use parameters to define MODFLOW inputs with MODFLOW -\nLGR. If desired, view the parameters for the CHILD1 model, or look at the zone array \nused with the parameter clusters.  \n2.3 Saving with a Different Name  \nBefore making any changes, save  the project under a new name.  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c lgr-dual.gpr \u201d as the File name . \n\nGMS Tutorials   MODFLOW -LGR Dual Refinement  \n \n Page 5 of 13 \u00a9 Aquaveo 2024  4. Click Save to save the project under the new file name and close th e Save As  \ndialog.  \nUse Save   periodically as the model is developed.  \n3 Creating a Second Child Grid  \nCreate another child grid around the well on the right.  \n1. Turn on the \u201c  Annotation Data \u201d folder in the Project Explorer . A purple \nrectangle should appear around the well on the right.  \n2. Using the Select Cells   tool, drag a box to select the cells within the purple \nrectangle.  \n3. Right -click in the selected area and select Create Child Grid \u2026 to bring up the \nCreate Child Grid  dialog ( Figure 3). \n \n      Figure 3      Create Child Grid dialog  \n4. Enter \u201cCHILD2\u201d as the Grid name . \n5. Enter \u201c9\u201d as the Horizontal refinement . \n6. Click OK to close the Create Child Grid  dialog.  \n7. Turn off \u201c Annotation Data \u201d in the Project Explorer . \nThere are now two child grids ( Figure 4). \n\nGMS Tutorials   MODFLOW -LGR Dual Refinement  \n \n Page 6 of 13 \u00a9 Aquaveo 2024   \n      Figure 4      Two child grids visible  \n4 LPF Package  \nSome things in the LPF package now need to be changed. Although the parent and \nCHILD1 models use parameters to define hydraulic conductivity, in the interest of time, \nnone will be specified for CHILD2.  \n1. Select MODFL OW | LPF \u2013 Layer Property Flow \u2026 to open the  LPF Package \u2013 \nCHILD2  dialog.  \n2. In the Layer data section, select Confined  as the Layer type . \n3. Click Horizontal Hydraulic Conductivity \u2026 to bring up the Horizontal Hydraulic \nConductivity dialog.  \n4. Click Constant \u2192 Grid\u2026 to bring up the Grid Value dialog.  \n5. Enter \u201c 0.0005 \u201d as the Constant value for grid  and click OK to close the Grid \nValue  dialog.  \n6. Click OK to exit the Horizontal Hydraulic Conductivity dialog.  \n7. Click OK to exit the LPF Package \u2013 CHILD2 dialog.  \n5 Saving and Runni ng MODFLOW  \nNow it is possible to save and run MODFLOW.  \n1. Save   the project.  \n2. Click Run MODFLOW    to bring up the MODFLOW  model wrapper dialog.  \n3. When the model finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution, turn on contours, and close the MODFLOW  \nmodel wrapper dialog.  \nNote that the pathlines have changed and they no longer go all the way to the wells \n(Figure 5). This is because the parent model ends where the child models start and \nMODPATH does not track pathlines across parent/child model boundaries. To see the \noriginal pathlines, simply change the solution back to the \u201cstart (MODFLOW)\u201d solution.  \n\nGMS Tutorials   MODFLOW -LGR Dual Refinement  \n \n Page 7 of 13 \u00a9 Aquaveo 2024   \n      Figure 5      MODPATH pathlines do not continue to wells  \n6 Examining Accuracy Using BFH Package  \nThe BFH \u2013 Boundary Head and Flow package can be used to run parent or child models \nindependently using coupling head and flow da ta generated from a previous coupled run \nof MODFLOW -LGR. This was demonstrated in the \u201c MODFLOW -LGR\u201d tutorial. The BFH \npackage can also be used to examine the accuracy of the parent/child model coupling. \nThis section of the tutorial will demonstrate how.  \n6.1 Turning on IUPBFSV and IUCBHSV  \n1. Expand the \u201c  3D Grid Data\u201d folder in the Project Explorer.  \n2. Make the parent model active by clicking on its \u201c  MODFLOW\u201d model or its \u201c  \ngrid\u201d. \n3. Select MODFLOW | Global Options \u2026 to bring up the MODFLOW Global/Basic \nPackage \u2013 Pare nt dialog.  \n4. Click LGR Options \u2026 to bring up the LGR Options  dialog.  \nNotice the Save boundary fluxes (IUPBFSV) option in the top -right is on and the \nIUCBHSV option is on for CHILD1 in the spreadsheet. This indicates that the coupling \nflow and head files were created when MODFLOW -LGR was last run coupled on the \nparent and child models. If these options were not on, they would need to be turned on \nand MODFLOW -LGR would need to be run again in coupled mode to create these files.  \n5. Click Cancel  to exit the LGR Optio ns dialog.  \n6. Click Cancel  to exit the MODFLOW Global/Basic Package \u2013 Parent dialog.  \n6.2 Turning on BFH Package  \nIt is now necessary to activate the BFH package.  \n1. Make the \u201cCHILD1\u201d model active in the Project Explorer  by clicking on its \u201c  \nMODFLOW\u201d model or on \u201c  CHILD1\u201d . \n2. Select MODFLOW | Global Options \u2026 to open the MODFLOW Global/Basic \nPackage \u2013 CHILD1 dialog.  \n\nGMS Tutorials   MODFLOW -LGR Dual Refinement  \n \n Page 8 of 13 \u00a9 Aquaveo 2024  3. Click Packages \u2026 to open the MODFLOW Packages / Processes \u2013 CHILD1 \ndialog.  \n4. In the Optional packages  / processes  section, turn on BFH \u2013 Boundary Flow and \nHead . \n5. Click OK to exit the MODFLOW Packages / Processes \u2013 CHILD1 dialog.  \n6. Click OK to exit the MODFLOW Global/Basic Package \u2013 CHILD1 dialog.  \nThe file names specified in the BFH package could be reviewed at this time. The default \nname is based on the project file  names in this case, however, so it is not necessary.  \n6.3 Saving and Running CHILD1  \nNow save and run MODFLOW on just the CHILD1 model.  \n1. Save   the project.  \n2. Under \u201c  CHILD1\u201d, right -click on \u201c  MODFLOW\u201d and select Run MODFLOW \nUncoupled On Just This Model  to bring up the MODFLOW \u2013 CHILD1  model \nwrapper dialog.  \n3. When the model finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution, turn on contours, and close the MODFLOW \u2013 \nCHILD1  model wrapper dial og. \n6.4 Examining the Accuracy  \nNow look at the accuracy of the parent/child coupling.  \n1. Expand the \u201c  lgr-dual_CHILD1 (MODFLOW) \u201d solution in the Project Explorer  \nand double -click on \u201c lgr-dual_CHILD1.out \u201d to bring up the View Data File  dialog. \nIf Never ask this a gain has previously been turned on, this dialog will not appear. \nIf this is the case, skip to step 3.  \n2. Select the desired text editor from the Open with  drop-down and click OK to open \n\u201clgr-dual_CHILD1.out\u201d and close the View Data File  dialog.  \n3. Scroll to the  bottom of the file and find the \u201cBFH: BOUNDARY FLUX \nCOMPARISON\u201d section ( Figure 6). \n\nGMS Tutorials   MODFLOW -LGR Dual Refinement  \n \n Page 9 of 13 \u00a9 Aquaveo 2024   \n      Figure 6      BFH Comparison data \nThe information shows the difference in flux across the boundary between running the \nmodels coupled and running them uncoupled. Notice there is a difference but it is very \nsmall. This information can help determine if the boundary heads and flows are still valid \nwhen running and modifying a child model independently.  \n7 Adding Well to Child  \nNow add another well to CHILD1 and see how it impacts the boundary flows.  \n1. Using the Select Cells   tool, right -click somewhere in the upper right area of \nCHILD1 (the e xact location is not important, see Figure 7 for approximate \nlocation) and select Sources/Sinks \u2026 to open the MODFLOW Sources/Sinks \u2013 \nCHILD1 dialog.  \n2. Select \u201c Wells  (WEL)\u201d from the list on the left.  \n3. Click Add BC . A new entry will appear in the spreadsheet section above the \nbutton.  \n4. Enter \u201c -0.0055\u201d in the Q (flow ) (ft^3/s ) column (replacing the \u201c0.0\u201d). This is the \nsame rate as the first well.  \n5. Click OK to clo se the MODFLOW Sources/Sinks \u2013 CHILD1  dialog.  \n\nGMS Tutorials   MODFLOW -LGR Dual Refinement  \n \n Page 10 of 13 \u00a9 Aquaveo 2024   \n      Figure 7      Creating a second well (indicated by arrow) in CHILD1  \n7.1 Saving and Running CHILD1  \nNow save and run MODFLOW on just the CHILD1 model.  \n1. Save   the project.  \n2. Under \u201c  CHILD1\u201d, right -click \u201c  MODFLOW\u201d and select Run MODFLOW \nUncoupled On Just This Model  to bring up the MODFLOW \u2013 CHILD1  model \nwrapper dialog.  \n3. When the model finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to imp ort the solution, turn on contours, and close the MODFLOW \u2013 \nCHILD1  model wrapper dialog.  \n7.2 Examining the Accuracy  \nNow to review the accuracy of the parent/child coupling:  \n1. Expand \u201c  lgr-dual_CHILD1 (MODFLOW) \u201d in the Project Explorer . \n2. Double -click on \u201c lgr-dual_CHILD1.out \u201d to bring up the View Data File  dialog. As \nbefore, this dialog may not appear. Skip to step 4 if it does not appear.  \n3. Select the desired text editor from the Open with  drop-down and click OK to open \n\u201clgr-dual_CHILD1.out\u201d and close the View Data File dialog.  \n4. Scroll to the bottom of the file and find the \u201cBFH: BOUNDARY FLUX \nCOMPARISON\u201d section ( Figure 8). \nNotice the differences from the previous results ( Figure 6) and determine if the difference \nis acceptable.  \n\nGMS Tutorials   MODFLOW -LGR Dual Refinement  \n \n Page 11 of 13 \u00a9 Aquaveo 2024   \n      Figure 8      BFH comparison data with two wells in CHILD1  \n8 Adding Well to Parent  \nNow to add a well to the parent and see how it affects the boundary heads.  \n1. Select the parent \u201c  grid\u201d in the Project Explorer to make it active . \n2. Using the Select Cells   tool, right -click somewhere between the two child \ngrids (the ex act location is not important as long as it is not within one of the child \ngrids) and select Sources/Sinks \u2026 to open the MODFLOW Sources/Sinks \u2013 \nParent dialog.  \n3. Select \u201cWells (WEL)\u201d from the list on the left.  \n4. Click Add BC  to create a new entry in the spreadsheet above the button.  \n5. Enter \u201c -0.0055\u201d in the Q (flow ) (ft^3/s ) column (replacing the \u201c0.0\u201d). This is the \nsame rate as the other wells.  \n6. Click OK to create the new well and close the MODFLOW Sources/Sinks \u2013 \nParent  dialog . \n8.1 Turning on BFH Package in the Parent Model  \nTo run the parent model independently, the BFH package must first be turned on.  \n1. Select MODFLOW  | Global Options \u2026 to open the MODFLOW Global/Basic \nPackage \u2013 Parent  dialog.  \n2. Click Packages \u2026 to open the MODFLOW Packages  / Processes \u2013 Parent  \ndialog.  \n3. In the Optional packages  / processes  section, turn on BFH \u2013 Boundary Flow and \nHead . \n4. Click OK to exit the MODFLOW Packages / Processes \u2013 Parent dialog.  \n5. Click OK to exit the MODFLOW Global/Basic Package \u2013 Parent dialog.  \n\nGMS Tutorials   MODFLOW -LGR Dual Refinement  \n \n Page 12 of 13 \u00a9 Aquaveo 2024  8.2 Saving and Running the Parent  \nNow save and run MODFLOW on just the parent model.  \n1. Save   the project.  \n2. Right -click on the parent \u201c  MODFLOW\u201d model and select Run MODFLOW \nUncoupled On Just This Model  to bring up the MODFLOW \u2013 Parent  model \nwrapper dialog.  \n3. When the model finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution, turn on contours, and close the MODFLOW \u2013 \nParent  model wrapper dialog.  \nThe Graphics Window should appear similar to Figure 9. \n \n      Figure 9      The new well is visible in the parent grid  \n8.3 Examining the Accuracy  \nAgain, look at the accuracy of the parent/child cou pling.  \n1. Expand the \u201c  lgr-dual (MODFLOW) \u201d solution in the Project Explorer . \n2. Double -click on \u201c lgr-dual.out \u201d to bring up the View Data File  dialog. As before, \nthis dialog may not appear. If it does not appear, skip to step 4.  \n3. Select the desired text editor from the Open with  drop-down and click OK to open \n\u201clgr-dual.out\u201d and close the View Data File  dialog.  \n4. Scroll to the bottom of the file and find the \u201cBFH: BOUNDARY HEAD \nCOMPARISON\u201d section.  \nNotice that now this section shows boundary heads, not fluxes. Notice how big the head \ndifference is from the coupled model and determine if the difference is acceptable.  \n \n \n\nGMS Tutorials   MODFLOW -LGR Dual Refinement  \n \n Page 13 of 13 \u00a9 Aquaveo 2024  9 Conclusion  \nThis concludes the \u201c MODFLOW \u2013 LGR Dual Refinement\u201d  tutorial.  The following concepts \nwere discussed and demo nstrated : \n\uf0b7 GMS supports MODFLOW -LGR and models with multiple children.  \n\uf0b7 MODPATH can be used with MODFLOW -LGR, but pathlines do not cross \nparent/child borders.  \n\uf0b7 In GMS, MODPATH can only be used on the parent model.  \n\uf0b7 Parameters can be used with MODFLOW -LGR.  \n\uf0b7 The BFH package can be used to examine the accuracy of the parent/child \ncoupling and the impact that modifications in uncoupled models have on the \nboundary heads and flows.  \n \n", "filename": "MODFLOW-LGR_Dual.pdf", "pages": 13}, "MODFLOW-ManagingTransientData": {"text": "GMS Tutorials   MODFLOW \u2013 Managing Transient Data  \n Page 1 of 13 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Building a Transient Model  \nCreating transient MODFLOW models with time -varying inputs  \n \nObjectives   \nGMS provides a powerful suite of tools for inputting and managing transient data. These tools allow all \ndata to be managed using a date/time format that eliminates much of the extra data processing that is \noften required with modeling projects. This tutorial illustrates how these tools are used.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach I  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 30\u201350 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 Managing Transient Data  \n Page 2 of 13 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Importing and saving the Project  ................................ ................................ .......................  2 \n3 Transient Data Strategy  ................................ ................................ ................................ ...... 3 \n4 Entering Transient data in the Map Module  ................................ ................................ ...... 4 \n4.1 Assigning the transient Recharge Rate  ................................ ................................ ........  4 \n4.2 Importing Transient Recharge Data  ................................ ................................ ..............  6 \n4.3 Importing Pumping Well Data  ................................ ................................ .......................  8 \n4.4 Assigning Specific Yield  ................................ ................................ ................................  8 \n5 Initializing MODFLOW Stress Periods  ................................ ................................ ...............  9 \n5.1 Changing the MODFLOW Simulation to Transient  ................................ .......................  9 \n5.2 Setting up the Stress Periods  ................................ ................................ .....................  10 \n6 Converting the Conceptual Model ................................ ................................ ....................  11 \n7 Setting Starting Heads  ................................ ................................ ................................ ...... 11 \n8 Saving and Running MODFLOW  ................................ ................................ ......................  11 \n9 Setting up an Animation  ................................ ................................ ................................ ... 12 \n10 Conclusion  ................................ ................................ ................................ .........................  13 \n \n1 Introduction  \nBuilding a transient simulation typically requires the management of large amounts of \ntransient data from a variety of sources, including pumping well data, recharge data, river \nstages, and water levels in observation wells. Gathering and formatting such data can be \nvery tedious. GMS provides tools for importing time series  data and converting that data \ninto inputs for MODFLOW models.  \nThe model this tutorial uses is the same model used in the \u201c MODFLOW \u2013 Model \nCalibration \u201d tutorial. This tutorial will use the computed heads from the steady -state \ncalibrated flow model as the s tarting heads for the transient simulation. Transient \nrecharge and pumping conditions will be modeled. The recharge rates will be manually \nentered but the pumping rates will be imported from a text file.  \nThis tutorial discusses and demonstrates opening a MODFLOW model and solution, \nentering transient data, importing a well pump data file, setting up stress periods and \ndefining additional inputs, running MODFLOW, and creating an animation.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launc h GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  Click Don\u2019t Save  if asked to save changes.  \n2 Importing and saving the Project  \nTo import the project:  \n1. Click Open   to bring up the Open dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the trans \\trans  directory and select \u201cstart.gpr\u201d.  \n4. Click Open  to import the project and close the Open  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Managing Transient Data  \n \n Page 3 of 13 \u00a9 Aquaveo 2024  A MODFLOW model with a solution and a set of map coverages should be visible ( Figure \n1). Two of the coverages are the source/sink and hydraulic conductivity coverages used \nto define the conceptual model. The ac tive coverage is the recharge coverage.  \nBefore continuing, save the project with a new name.  \n5. Select File | Save As\u2026  to bring up the Save As  dialog.  \n6. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n7. Enter  \u201ctrans1.gpr\u201d as the File name  and clic k Save to close the Save As  dialog.  \nIt is recommended to save the project periodically.  \n \n      Figure 1      The initial project in the Graphics Window  \n3 Transient Data Strategy  \nWhen entering the time values associated with transien t data, MODFLOW requires that \nthe time be entered as scalar time values relative to a time value of zero at the beginning \nof the simulation. Furthermore, the times must be compatible with the time unit selected \nfor the model. This approach can be time cons uming since transient data must be \nconverted from a date/time format to a relative time format.  \nThe strategy used in GMS for managing transient data makes it possible to enter all time \nvalues using a simple date/time format. Transient data are entered in the conceptual \nmodel using date/time values. The time at the beginning of the first MODFLOW stres s \nperiod is the reference time. This represents the date/time corresponding to \u201ctime=0.0\u201d in \nthe simulation.  \n\nGMS Tutorials   MODFLOW \u2013 Managing Transient Data  \n \n Page 4 of 13 \u00a9 Aquaveo 2024  When the model is converted from the conceptual model to the grid model, the time \nvalues in the conceptual model are automatically mapped to the a ppropriate time values \ncorresponding to the MODFLOW stress periods. When the MODFLOW model is saved to \ndisk, the date/time values are converted to the appropriate relative time values.  \nIn addition to ease of use, another advantage of the transient data str ategy used in GMS \nis that both the spatial and temporal components of the conceptual model are defined \nindependently of the discretization used in both the grid spacing and the stress period \nsize. The stress period spacing can be changed, and the model can  be regenerated from \nthe conceptual model in seconds.  \n4 Entering Transient data in the Map Module  \nThe first step in setting up the transient model is to associate the transient data with \nfeature objects in the Map  module.  \n4.1 Assigning the transient Recharge R ate \nFirst, it is necessary to assign the transient recharge rate for the recharge zones. The \nrecharge zones are shown in Figure 2. There are four recharge zones defined by five \npolygons. Leave the recharge rate for zone 1 at zero and assign a transient recharge rate \nto the other three zones.  \nDo the following to assign the recharge data:  \n1. Expand the \u201c  Map Data\u201d folder and the \u201c  BigVal\u201d conceptual mo del in the \nProject Explorer.  \n2. Select the \u201c  Recharge\u201d coverage to make it active.  \n3. Using the Select Polygons   tool, select the polygon corresponding to \nrecharge zone 2 in Figure 2. \n4. Click Properties   to bring up the Attribute Table dialog.  \n \nRecharge Zones  \n1 \n2 \n3 3 \n4 \n \n      Figure 2      Recharge zones  \n\nGMS Tutorials   MODFLOW \u2013 Managing Transient Data  \n \n Page 5 of 13 \u00a9 Aquaveo 2024  5. In the table in the Recharge rate (ft/d)  column, click the down arrow  button \nand select \u201c<transient>\u201d from the drop -down.  \n6. Now click the  button just above the down arrow  button to bring up the XY \nSeries Editor  dialog.  \n7. At the bottom -left of the dialog, turn on Use dates/times . \n8. Enter the data from the following table into the appropriate columns and rows in \nthe XY Series Editor  dialog spreadsheet. Once done, the dialog should appear \nas in Figure 3. \nTime  Recharge rate (ft /d) \nOct 1,1985 12:00:00 AM  0.001  \nJan 1, 1986 12:00:00 AM  0.001  \nJan 1, 1986 12:00:00 AM   0.0005  \nMar 1, 1986 12:00:00 AM   0.0005  \nMar 1, 1986 12:00:00 AM  0.006  \nJuly 1, 1986 12:00:00 AM  0.006  \nJuly 1, 1986 12:00:00 AM  0.005  \nOct 1, 1986 12:00:00 AM  0.005  \nOct 1, 1986 12:00:00 AM  0.001  \nDec 1, 1986 12:00:00 AM  0.001  \n \n9. Click OK to exit the XY Series Editor  dialog.  \n10. Click OK to exit the Attribute Table dialog.  \n \n      Figure 3      XY Series Editor showing recharge rate  \nDepending on the computer settings, the dates may be formatted differently than shown \nin Figure 3. Those shown above are formatted month/day/year . \n\nGMS Tutorials   MODFLOW \u2013 Managing Transient Data  \n \n Page 6 of 13 \u00a9 Aquaveo 2024  4.2 Importing Transient Recharge Data  \nInstead of repeating this same procedure for the other recharge zones, the data will be \nimported from a text file. Transient data can be imported for polygons, arcs, points, or \nnodes. The format for the text files is shown below.  \nName  Date  Recharge  \nzone 3  Dec 3, 1999  0.0005  \nzone 3  Jan 30, 2000  0.001  \nzone 4  Mar 27, 2000  0.002  \n\u2026 \nIn the case above, there is only a date field; GMS also supports specifying both a date \nand a time. Later in this tutorial, pumping data that has both a date and a time specified \nwill be imported. The Name  column is used to match the Date  data with a particular \npolygon.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cText Files (*.txt;*.csv)\u201d from the Files of type  drop-down.  \n3. Browse to the trans \\trans  directory and select \u201ctrans_recharge.csv\u201d.  \n4. Click Open  to close the Open  dialog and bring up the Step 1 of 2  page of the \nText Import Wizard  dialog.  \nThis wizard is used to import text data into a GMS project ( Figure 4). \n \n      Figure 4      Step 1 of 2 page of the Text Import Wizard dialog  \n5. Below the File import options  section, turn on Heading row  and click the Next >  \nbutton to go to the Step 2 of 2  page of the Text Import Wizard  dialog ( Figure 5). \n6. Select \u201cTransient polygon data\u201d from the GMS data type  drop-down.  \n\nGMS Tutorials   MODFLOW \u2013 Managing Transient Data  \n \n Page 7 of 13 \u00a9 Aquaveo 2024   \n      Figure 5      Step 2 of 2 page of the Text Import Wizard dialog  \nNotice that the Name  and the Date  columns were automatically recognized by GMS. Now \nit is necessary to specify the field for the third column of data.  \n7. Select \u201cRecharge rate TS\u201d from the Type  drop-down at the top of the third \ncolumn of the spreadsheet.  \n8. Click Finish  to close th e Text Import Wizard  dialog.  \n9. Click No at the prompt regarding step function or continuous time series.  \n10. Double -click on any of the polygons in zone 3 or zone 4 (see Figure 2) to open \nthe Attribute Table dialog.  \n11. Click the  button in the Recharge rate (ft/d)  column to open the XY Series \nEditor dialog. A time series curve of the imported data will appear which should \nmatch Figure 6. \n12. Click OK to exit the XY Series Editor  dialog.  \n13. Click OK to exit the Attribute Table dialog.  \n \n      Figure 6      XY Se ries Editor showing recharge rate  for zone 3  \n\nGMS Tutorials   MODFLOW \u2013 Managing Transient Data  \n \n Page 8 of 13 \u00a9 Aquaveo 2024  4.3 Importing Pumping Well Data  \nIn addition to the transient recharge data, this simulation will also contain a transient \npumping schedule for the three wells in the model. Since the model only has three wells, \nthe transient pumping schedules could easily be entered by hand. To save time, the well \ndata will be imported from a text file. This method is particularly useful for models with \nmany wells or complicated pumping schedules.  \nPumping well data is typically impor ted using two files. The first file contains the name, \nscreen geometry, and xy coordinates of the wells. The second file contains the pumping \nschedules. Since the well locations are already defined, only the pumping schedules \nneed to be imported . The forma t for this file is as follows:  \nName  date time Q \n\"well 1\"  12/3/1999  18:00:00  625.0  \n\"well 1\"  1/30/2000  7:38:25  0.0 \n\"well 1\"  3/27/2000  18:00:00  200.0  \n\"well 2\"  12/3/1999  18:00:00  0.0 \n\"well 2\"  12/5/1999  14:48:32  100.0  \n\u2026 \nWhen importing text data for points, it is necessary to indicate to GMS which point \nmatches with the date/time data. This can be done using a name, an ID, or an xy \ncoordinate. In the case above, a name is being used.  \nThe first time an entry is found for a  particular well, the well type is changed to transient if \nthe well is steady -state, and a pumping rate time series is created for the well. Each time \na subsequent line is imported with the same well name, GMS adds a point to the time \nseries. The dates and  times can be in any standard format.  \nTo import the well pumping data file:  \n1. Select the \u201c  Sources & Sinks\u201d coverage to make it active.  \n2. Click Open   to bring up the Open  dialog.  \n3. Select \u201cText Files (*.txt;*.csv)\u201d from the Files of type  drop-down.  \n4. Browse to the trans \\trans  directory and select \u201cpumping.txt\u201d.  \n5. Click Open  to close the Open  dialog and bring up the Step 1 of 2  page of the \nText Import Wizard  dialog.  \n6. Below the File import options  section, turn on Heading row  and click the Next >  \nbutton to go to the Step 2 of 2  page of the Text Import Wizard  dialog.  \n7. Select \u201cPumping data\u201d from the GMS data type  drop-down. Notice that GMS \nautomatically recognized all of the fields in the file.  \n8. Click Finish  to close the Text Import Wizard  dialog.  \n9. Click Yes at the prompt to import the pumping data as a step function.  \n10. Using the Select Points \\Nodes   tool, double -click on any of the wells to bring \nup the Attribute Table dialog. Notice that the Flow rate (ft^3/d)  says \u201c <transient >\u201d \nfor all of them. The  button can be clicked to see the curve, if desired.  \n11. Click OK to exit the Attribute Table dialog.  \n4.4 Assigning Specific Yield  \nIt is necessary to assign the storage coefficient to the aquifer. Since this is a one -layer \nunconfined aquifer, the specific yield ne eds to be assigned.  \n\nGMS Tutorials   MODFLOW \u2013 Managing Transient Data  \n \n Page 9 of 13 \u00a9 Aquaveo 2024  1. Double -click on the \u201c  Hydraulic Conductivity\u201d  coverage in the Project Explorer \nto bring up the Coverage Setup  dialog.  \n2. In the Areal Properties  column, turn on Specific yield . \n3. Click OK to exit the Coverage Setup  dialog.  \n4. Using the Select Polygons   tool and while holding down the Shift key, select \nthe polygons labeled 1 and 2 in Figure 7. \n \n      Figure 7      Hydraulic conductivity zones  \n5. Click Properties   to bring up the Attribute Table dialog.  \n6. In the All row of the spreadsheet, enter \u201c0.2\u201d in the Spec. yield  column.  \n7. Click OK to exit the Attribute Table dialog.  \n8. Repeat steps 4 \u20137 for zones 3 and 4, entering \u201c0.15\u201d on the All row in the Spec. \nyield column. Be sure to select both zones labeled \u201c3\u201d . \n5 Initializing MODFLOW Stress Periods  \nMODFLOW discretizes time using stress periods and time steps. A length of time is \nassociated with each stress period, and boundary conditions (or stresses) can change at \nthe beginning of a stress period. Stress periods are subdivided into time steps. Before \nconverting the conceptual model, it is necessary to set up the stress periods.  \n5.1 Changing the MODFLOW Simulation to Transient  \nFirst, change the current MODFLOW simulation from a steady -state simulation to a \ntransient simulation.  \n1. In the Project Explorer, expand the \u201c  3D Grid Data\u201d folder, the \u201c  grid\u201d item \nunder it, and the \u201c  MODFLOW\u201d item underneath that.  \n43\n32\n1\n\nGMS Tutorials   MODFLOW \u2013 Managing Transient Data  \n \n Page 10 of 13 \u00a9 Aquaveo 2024  2. Right -click on the \u201c  Global\u201d package and select Properties\u2026  to bring up the \nMODFLOW Global/Basic Package dialog.  \n3. In the Model type  section, select Transient . \n5.2 Setting up the Stress Periods  \nNow set up the stress period inform ation for MODFLOW.  \n1. Click Stress Periods\u2026  to bring up the Stress Periods dialog.  \n2. Enter \u201c7\u201d for the Number of stress periods . \nThe stress periods need to match the times where the input data in the map module \nchanges. For example, the value for recharge chang es at three different dates: Jan 1, \n1986, Mar 1, 1986, and July 1, 1986. Therefore, it is necessary to make sure that stress \nperiods start at those times and at the times corresponding to changes in the pumping \nschedules.  \n3. Turn on Use dates/times . \nWhen the Use dates/times  option is used, all input fields in the MODFLOW interface in \nthe 3D Grid  module expect the date/time format for input. The date/time format is used to \ndisplay time values such as the time step values when post -processing. If this option is \nnot used, scalar time values (100, 120, etc.) are displayed.  \n4. Uncheck the box in the Steady state  column on the first row.  \nThe Steady state  check box is on by default so that the transient model starts from a \nsteady -state condition.  \nThe starting heads can be set to the solution from a steady -state run, or allowed enough \ntime at the beginning of the transient model for the heads to stabilize before applying any \nchanges in stresses. Since a steady -state model and solution already exist, the tutorial \nwill use the solution as the starting heads for the transient model.  \n5. From the table below, enter the date time and number of time steps for the stress \nperiods. As the dates are entered, the stress period length is automatically \ncalculated.  \nRow  Start  Num Time Steps \n1 Oct 1, 1985 12:00:00 AM  2 \n2 Jan 1, 1986 12:00:00 AM  1 \n3 Mar 1, 1986 12:00:00 AM  8 \n4 May 1, 1986 12:00:00 AM  4 \n5 June 1, 1986 12:00:00 AM  4 \n6 July 1, 1986 12:00:00 AM  8 \n7 Sept 1, 1986 12:00:00 AM  8 \nEnd Dec 1, 1986 12:00:00 AM   \n6. Click OK to exit the Stress Periods  dialog.  \n7. Click OK if a prompt comes up.  \n8. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n \n\nGMS Tutorials   MODFLOW \u2013 Managing Transient Data  \n \n Page 11 of 13 \u00a9 Aquaveo 2024  6 Converting the Conceptual Model  \nNow to convert the conceptual model data to MODFLOW input data:  \n1. Right -click on the \u201c  BigVal \u201d conceptual model in the Project Explorer and \nselect Map to | MODFLOW/MODPATH  to bring up the Map \u2192Model dialog.  \n2. Select All applicable coverages and click OK to close the Map \u2192Model dialog.  \n3. Click OK at the prompt to acknowledge that the xy series will be extrapolated to \nthe numerical model.  \n7 Setting Starting Heads  \nAs mentioned earlier, transient models require starting off with a steady -state stress \nperiod, setting the starting heads equal to the solution generated from a steady -state \nmodel, or allowing som e time in the beginning of the transient model for the heads to \nstabilize before applying any changes in stresses (pumping rates, recharge rates, etc.). \nThe second approach will be used in this case.  \n1. In the Project Explorer, expand the \u201c  Global\u201d package a nd double -click on the \u201c\n Starting Heads\u201d dataset to bring up the Starting Heads dialog.  \n2. Click 3D Dataset \u2192 Grid\u2026  to bring up the Select Dataset dialog.  \n3. In the Solution  section, expand \u201c  grid\u201d and \u201c  start (MODFLOW)\u201d, then select \nthe \u201c  Head\u201d dataset.  \n4. Click OK to exit the Select Dataset dialog.  \n5. Click OK to exit the Starting Heads dialog.  \nThe starting head could also have been set to start with a steady -state stress period by \nchecking the Steady state  option for the first stress period in the Stress Period  dialog.  \n8 Saving and Running MODFLOW  \nIt is now possible to save the model and launch MODFLOW.  \n1. Click Save  . \n2. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n3. Once MODFLOW has finished running, turn on Read solution on exit  and Turn \non contou rs (if not on already)  and click Close  to close the MODFLOW  model \nwrapper dialog.  \nThe contours should change slightly ( Figure 8). \n4. Expand the \u201c trans1 (MODFLOW) \u201d item in the Project Explorer . \n5. Select the \u201c  Head \u201d dataset.  \n6. Use the Time Steps  window to cycle through the different time steps of the \nsolution to see how the pumping schedules of the wells affect the computed \nheads.  \n\nGMS Tutorials   MODFLOW \u2013 Managing Transient Data  \n \n Page 12 of 13 \u00a9 Aquaveo 2024   \n      Figure 8      Contours after MODFLOW run  \n9 Setting up an Animation  \nHow the head changes over time can be shown by generating an animation. To set up \nthe animation:  \n1. Select Display | Animate\u2026  to bring up the Options  page of the Animation Wizard  \ndialog.  \n2. In the Optio ns section, turn on Dataset  and click Next >  to go to the Datasets  \npage of the Animation Wizard  dialog.  \n3. Turn on Display clock  and click Finish  to generate the animation and close the \nAnimation Wizard  dialog.  \nThe generated animation file can be viewed in a media player application outside of \nGMS.  \n \n\nGMS Tutorials   MODFLOW \u2013 Managing Transient Data  \n \n Page 13 of 13 \u00a9 Aquaveo 2024  10 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 Managing Transient Data\u201d tutorial. The following topics \nwere discussed and demonstrated:  \n\uf0b7 When opening the Properties  dialog for objects in the Map  module, transient \ndata can be entered by using the  button s. \n\uf0b7 It is possible to import transient data for points, arcs, polygons, and nodes using \nthe Text Import Wizard  dialog. The points, arcs, polygons, and nodes must \nalready exist in the active coverag e. \n\uf0b7 GMS can show dates and times as scalar values (0.0, 2.5, etc.) or in date/time \nformat (12/03/2003).  \n\uf0b7 The MODFLOW stress periods must be defined before using the Feature Objects \n| Map \u2192 MODFLOW / MODPATH  command with a transient simulation.  \n \n\n", "filename": "MODFLOW-ManagingTransientData.pdf", "pages": 13}, "MODFLOW-MNW2NonVerticalandPumpCapacity": {"text": "GMS Tutorials   MODFLOW \u2013 Non Vertical Wells and Pump Curves  \n Page 1 of 10 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Non-Vertical Wells and Pump Curves  \nUsing non -vertical wells and pump performance curves in MNW2  \nObjectives   \nLearn how to use the non-vertical wells and pump capacity options from the MNW2 package in GMS . \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 MNW2 \nPackage  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 20\u201340 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 Non Vertical Wells and Pump Curves  \n Page 2 of 10 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 Importing the Existing Model ................................ ................................ .........................  3 \n2.2 Saving the Model with a New Name  ................................ ................................ .............  4 \n3 Using MNW2 Horizontal Wells for Dewatering  ................................ ................................ .. 4 \n3.1 Examining the Diaphragm Wall ................................ ................................ .....................  4 \n3.2 Creating an MNW2 Coverage  ................................ ................................ .......................  5 \n3.3 Creating the Horizontal Well  ................................ ................................ .........................  5 \n3.4 Converting the Conceptual Model  ................................ ................................ .................  7 \n3.5 Viewing the MNW2 Well  ................................ ................................ ...............................  7 \n3.6 Running MODFLOW  ................................ ................................ ................................ ..... 8 \n3.7 Viewin g the Water Table  ................................ ................................ ...............................  8 \n4 Using a Pump Capacity Curve  ................................ ................................ ............................  8 \n4.1 Saving the Model with a New Name  ................................ ................................ .............  8 \n4.2 Modifying the Existing Well  ................................ ................................ ...........................  9 \n4.3 Converting the Conceptual Model and Running MODFLOW  ................................ ........  9 \n4.4 Viewing the Water Table  ................................ ................................ .............................  10 \n5 Conclusion  ................................ ................................ ................................ .........................  10 \n \n1 Introduction  \nThis tutorial is divided into two parts. The first part demonstrates using MNW2 horizontal \nwells for dewatering. The models are fictitious construction sites. The second part \ndemonstrates using a pump capacity curve in the model.  \nThe problem to be solved in this tutorial is shown in Figure 1. The model is divided into 5 \nunconfined layers. The upper layers (layers 1 to 4) are permeable layers with hydraulic \nconductivity of 40 ft/day.  The lower layer (layer 5) is an impermeable layer with hydraulic \nconductivity of 0.1 ft/day. A storage coefficient of 0.0001 and specified yield of 0.05 are \nassigned uniformly to all 5 layers.  \nThe 60000 -ft2 area is divided into 40 rows and 60 columns. Un iform, square cells of 5 \nfeet are used in the model. Specified head values are assigned in layer 1 and are \nmaintained at the same elevations for all the stress periods. The construction site is \nsurrounded by a diaphragm wall to prevent water from infiltrat ing into the site.  \nThis tutorial will discuss and demonstrate:  \n\uf0b7 Importing an existing MODFLOW simulation.  \n\uf0b7 Running the simulation.  \n\uf0b7 Examining the results to understand the MNW2 package options.  \n\uf0b7 Modifying a conceptual model to use MNW2 instead of the WEL package.  \nGMS Tutorials   MODFLOW \u2013 Non Vertical Wells and Pump Curves  \n \n Page 3 of 10 \u00a9 Aquaveo 2024  \n \nNo flow boundary  \n \nNo flow boundary  Constant head \nboundary (H=48 ft)  \n \nNo flow boundary  \n Construction Site  \n \nHorizontal Well  \n Diaphragm  wall (Slurry wall)  \n  \n      Figure 1      Site model  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state. Click Don\u2019t Save  if asked to save changes.  \n2.1 Importing the Existing Model  \nTo start with a MODFLOW model that has already been created:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the mnw2adv \\mnw2adv folder and select \" mnw2.gpr \". \n4. Click Open  to import the model and exit the Open  dialog.  \nA grid with specified head boundary (CHD) conditions on the east side should be v isible \n(Figure 2). \n\nGMS Tutorials   MODFLOW \u2013 Non Vertical Wells and Pump Curves  \n \n Page 4 of 10 \u00a9 Aquaveo 2024   \n      Figure 2      Imported MODFLOW model  \n2.2 Saving the Model with a New Name  \nNow it is possible to start making changes. To save the model with a new name:  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \" mnw2_horizontal.gpr \" as the File name . \n4. Click Save  to save the project under the new name and exit the Save As  dialog.  \n3 Using MNW2 Horizontal Wells for Dewatering  \n3.1 Examining the Diaphragm Wall  \nOne of the main purposes of the diaphragm wall is to prevent water from infiltrating into \nthe site. The diaphragm w all can be simulated in GMS by using the Horizontal Flow \nBarrier (HFB) Package.  \n\nGMS Tutorials   MODFLOW \u2013 Non Vertical Wells and Pump Curves  \n \n Page 5 of 10 \u00a9 Aquaveo 2024  1. Uncheck the \"  3D Grid Data \" folder in the Project Explorer . \n2. Right -click in the Project Explorer  and select Expand All . \n3. Select the \"  diaphragm wall \" coverage to make it active . \n4. Right -click on the \"  diaphragm wall \" coverage and select the Coverage \nSetup \u2026 command to bring up the Coverage Setup  dialog.  \nThe Default layer range  is from layer \u201c1\u201d to layer \u201c4\u201d. This makes the diaphragm wall \nextend through grid layers 1 to 4 when mapp ing to MODFLOW.  \n5. Click OK to close the Coverage Setup  dialog.  \n6. Using the Select Arc s  tool, double -click on the diaphragm wall arc to bring up \nthe Attribute Table  dialog.  \nNotice that the arc is assigned with Type  of \u201cbarrier \u201d and Hyd. char.  (hydraulic \nchara cteristic ) of \u201c0.01\u201d. \n7. Click OK to close the Attribute Table  dialog.  \n3.2 Creating an MNW2 Coverage  \nThe next step is to create a shallow horizontal well system to dewater the site. This can \nbe accomplished using the nonvertical  well capabilities available in MNW2.  \nFirst, it is necessary to create a new coverage.  \n1. Right -click on the  \" Construction Site \" conceptual model and select New \nCoverage\u2026  to bring up the Coverage Setup  dialog.  \n2. Enter \" MNW2 \" as the Coverage name .  \n3. Enter \" 50.0\" as the Default elevation . \n4. In the Sources/Sinks/BCs  section, turn on Wells (MNW2) . \n5. Click OK to close the Coverage Setup  dialog.  \n3.3 Creating the Horizontal Well  \nNow it is possible to create the horizontal well.  \n1. Using the Create Point   tool, click anywhere in the window to create a point.  \n2. While the new point is selected, enter \u201c42.5\u201d, \u201c247.5 \u201d, and \u201c 50\u201d (respectively ) into \nthe X, Y and Z edit fields at the top of the GMS window, pressing Tab or Enter  \nafter each one.  \n3. Using the Select Points \\Nodes   tool, select the point that was just created by \nclicking on it and click on Properties   to bring up the Attribute Table  dialog.  \n4. In the spreadsheet in row 1, enter \u201cWell_A\u201d in the Name  column.  \n5. Select \" well (MNW2) \" from the drop -down in the Type column.  \n6. Select \u201c<transient>\u201d from the drop -down  in the Qdes (ft^3/d)  column.  \n7. Click  the  button in the  Qdes (ft^3/d)  column to bring up the XY Series Editor  \ndialog.  \n8. Enter the following into the Time (d)  and Qdes (ft^3/d)  columns in the \nspreadsheet on  the left:  \n\nGMS Tutorials   MODFLOW \u2013 Non Vertical Wells and Pump Curves  \n \n Page 6 of 10 \u00a9 Aquaveo 2024  Time  Qdes (ft^3/day)  \n0 -9000  \n5 -9000  \n5 -3000  \n30 -3000  \n9. Click OK to close the XY Series Editor  dialog.  \n10. Uncheck the box in the Vertical Boreline  column.  \n11. Click the  button in the Boreline  column to bring up the Table  dialog.  \n12. Enter the following values:  \nX screen \nbegin (ft)  Y screen \nbegin (ft)  Z screen \nbegin (ft)  X screen \nend (ft)  Y screen \nend (ft)  Z screen \nend (ft)  \n42.5 247.5  27.0 42.5 247.5  26.0 \n42.5 247.5  26.0 42.5 48.5 26.0 \n42.5 48.5 26.0 157.5  48.5 26.0 \n157.5  48.5 26.0 157.5  247.5  26.0 \n157.5  247.5  26.0 42.5 247.5  26.0 \n13. Click OK to close the Table  dialog.  \n14. Select \" THIEM \" from the drop -down in the LOSSTYPE  column.  \n15. Scroll to the right and enter \" 0.5\" in the Rw column.  \n16. Click OK to close the Attribute Table  dialog.  \nThe horizontal well should look similar to one shown in Figure 3: \n \n      Figure 3      Horizontal well  \n\nGMS Tutorials   MODFLOW \u2013 Non Vertical Wells and Pump Curves  \n \n Page 7 of 10 \u00a9 Aquaveo 2024  3.4 Converting the Conceptual Model  \nIt is now possible to convert the conceptual model from the feature object -based \ndefinition to a grid -based MODFLOW numerical model.  \n1. Right -click on the \"  Construction Site \" conceptual model and select Map To | \nMODFLOW/MODPATH  to bring up the Map \u2192 Model  dialog . \n2. Select All applicable coverages  and click OK to close the Map \u2192 Model  dialog.  \n3. Switch to Ortho Mode  . \n4. Change to layer 2 using the up arrow   by Lay (k) in the Mini Grid Toolbar . \n5. Turn on the \"  3D Grid Data \" folder.  \nNotice that the cells underlying the ba rrier and wells were all identified and assigned the \nappropriate sources/sinks.  \n6. Click on the \"  3D Grid Data \" folder to switch to the 3D Grid module.  \n7. Using the Select Cells   tool, select a grid cell somewhere in the middle of the \nmodel.  \n8. Switch to Front Vi ew . \nNotice the horizontal barriers extending from layers 1 through 4 on the left and right sides \nand the horizontal well in layer 2 ( Figure 4). \n \n      Figure 4      Model in front view  \n3.5 Viewing the MNW2 Well  \nBefore running the simulation, it is possible to look at the well in the MNW2 package data \nthat was created using the conceptual approach.  \n1. Select MODFLOW  | Optional Packages  | MNW2 \u2013 Multi -Node Well\u2026 to open \nthe MODFLOW Multi -Node Well (MNW2) Package  dialog.  \n2. Click Wells \u2026 to bring up the MNW2 Wells  dialog.  \n3. Select any cell in row 1 of the spreadsheet (for \u201cWell_A\u201d).  \nNotice the nodes for \u201cWell_A\u201d are listed in the Nodes for WELLID: \u201cWell _A\u201d, row #1  \nspreadsheet. These nodes are automatically assigned to the appropriate cells based on \nthe conceptual model.  \n4. Click OK to exit the MNW2 Wells  dialog.  \n5. Click OK to exit the MODFLOW Multi -Node Well (MNW2) Package  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Non Vertical Wells and Pump Curves  \n \n Page 8 of 10 \u00a9 Aquaveo 2024  3.6 Running MODFLOW  \nNow it is possible to save the changes and run MODFLOW.  \n1. Save   the project.  \n2. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n3. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.  \n5. Save   the project with the new solution.  \n3.7 Viewing the Water Table  \nNow view the solution at different time steps to see the drawdown.  \n1. Expand the \"  mnw2_horizontal (MODFLOW) \" solution in th e Project Explorer  \nand select the \"  Head \" dataset.  \n2. Use the Time Step s window  below the Project Explorer to cycle through the \ndifferent time steps of the solution and see how the pumping schedules of the \nwell affect the water level.  \nNote that the water lev el keeps decreasing for the first 5 days. After lowering the pumping \nrate after 5 days, the water level seems to reach a steady state for the site. This is \nconsistent with the pumping schedule that was entered. Feel free to adjust the pumping \nrate to see h ow it affects the water table. The last time step should appear similar to \nFigure 5. \n \n      Figure 5      Water table at the end of the simul ation  \n4 Using a Pump Capacity Curve  \n4.1 Saving the Model with a New Name  \nBefore examining the pump -capacity curve option in MNW2, it would be good to save the \nmodel with a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*. gpr)\u201d from the Save as type  drop-down.  \n3. Enter \" mnw2_pumpcurve.gpr \" as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n\nGMS Tutorials   MODFLOW \u2013 Non Vertical Wells and Pump Curves  \n \n Page 9 of 10 \u00a9 Aquaveo 2024  4.2 Modifying the Existing Well  \nNow to apply the pumping curve to the existing well:  \n1. Select the \" MNW2 \" coverage in the Project Explorer  to make it active.  \n2. Using the Select Points \\Nodes   tool, click on the well  to select it.  \n3. Click Properties   to bring up the Attribute Table  dialog.  \n4. In the spreadsheet, scroll to the right and check the box in the PUMPCAP  \ncolumn.  \n5. Scroll to the right and enter \" 50.0\" in the Hlift column.  \n6. Scroll to the right and click on the  button in the Pump capacity curve \ncolumn  to bring up the XY Series Editor  dialog. \n7. Enter the following data into the spreadsheet:  \nYield (ft^3/d)  Total Dynamic Head (ft)  \n0.0 15.0 \n3000.0  14.0 \n5000.0  13.0 \n7000.0  10.0 \n9000.0  6.0 \n8. Click OK to close the XY Series Editor  dialog.  \n9. Enter \" 1.0\" in the Pump capacity mult  column.  \n10. Click  OK to close the Attribute Table  dialog . \nThe option to use pump capacity was turned on in step 4. In step 5, the Hlift value was \nspecified as 50 ft. Hlift is the reference head (or elevation) corresponding to the discharge \npoint. In this tutorial, the top elevation is at 50 ft. Assume that the pump is placed at the \ntop elevation.  \nIn steps 6 \u20138, the pump capacity curve was defined. The model will calculate th e pumping \nrate based on these numbers. If the water level is from 50 ft (at top elevation) to 44 ft (top \nelevation minus 6.0 ft), the pump will withdraw water at 9000 ft3/d. The model will \ninterpolate the pumping rate linearly for water levels between 44 f t to 35 ft (top elevation: \n15.0 ft) based on the provided numbers. If the water level falls below 35 ft, the model will \nshut down the well.  \nIn step 9, the pump capacity multiplication was specified as \u201c1.0\u201d. This means that the \nhead -capacity relations defi ned in step 7 are used. If any value less than or equal to \u201c0.0\u201d \nis specified, the head -capacity relations will be ignored for that particular stress period. \nAny other positive value, such as \u201c2.0\u201d, can be specified. The model will adjust the \nwithdrawal ra te from the head -capacity curve by multiplying the withdrawal rate by the \npump capacity multiplication factor.  \nFor this example, the exact head -capacity curve for all the stress periods was used. \nTherefore, a constant value of \u201c 1.0\u201d was specified for the pump capacity multiplication \nfactor.  \n4.3 Converting the Conceptual Model and Running MODFLOW  \nThe next step is to convert the changes to MODFLOW, and then run a new simulation.  \n\nGMS Tutorials   MODFLOW \u2013 Non Vertical Wells and Pump Curves  \n \n Page 10 of 10 \u00a9 Aquaveo 2024  1. Right -click on the \"  MNW2 \" coverage and select Map To | \nMODFLOW/MODPATH  command.  \nThis updates the well and makes it possible to save the changes and run MODFLOW.  \n2. Save   the project.  \n3. Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n4. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n5. Click Close  to import the solution and exit the MODFLOW  model wrapper dialog.  \n6. Save   the project with the new solution.  \n4.4 Viewing the Water Table  \nNow to examine the new results:  \n1. Expand the \"  mnw2_pumpcurve (MODFLOW) \" solution in the Project Explorer  \nand selec t the \"  Head \" dataset.  \n2. Use the Time Steps  window to cycle through the time steps of the solution.  \nNotice that the pump does not always perform at full capacity and the water level at the \nend of 5 days is much higher compared to the previous scenario ( Figure 6). The flow \nbudget may be used to see the change in pumping rate over time.  \n \n      Figure 6      Water table after the first 5 days  \n5 Conclusion  \nThis concludes the \u201c MOD FLOW \u2013 Nonvertical Wells and Pump Curves \u201d tutorial. The \nfollowing key concepts were discussed and demonstrated:  \n\uf0b7 GMS supports the MNW2 package.  \n\uf0b7 It is possible to specify nonvertical wells using MNW2.  \n\uf0b7 It is possible to specify head -capacity pumping curves in  MNW2.  \nMNW2 wells can be created in the conceptual model and  mapped to the grid.  \n\n", "filename": "MODFLOW-MNW2NonVerticalandPumpCapacity.pdf", "pages": 10}, "MODFLOW-MNW2Package": {"text": "GMS Tutorials   MODFLOW \u2013 MNW2 Package  \n Page 1 of 20 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 MNW2 Package  \nUse the MNW 2 package with the sample problem and a conceptual \nmodel  \nObjectives   \nLearn how to use the MNW2 package in GMS and compare it to the WEL package. Examine the sample \nMNW2 model that comes with MODFLOW, and then examine a different model that uses the conceptual \nmodel approach . \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach I  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 35\u201350 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 MNW2 Package  \n Page 2 of 20 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  4 \n2.1 Importing the Existing Model ................................ ................................ .........................  5 \n2.2 Saving the Model with a New Name  ................................ ................................ .............  6 \n3 Viewing the MNW2 Boundary Conditions  ................................ ................................ .........  6 \n3.1 Opening the MNW2 Package Dialog  ................................ ................................ ............  6 \n3.2 Stress Period Data  ................................ ................................ ................................ ........  7 \n3.3 Defining the Wells  ................................ ................................ ................................ .........  7 \n3.4 Examining the Well Screen for Well -A ................................ ................................ ..........  9 \n3.5 Opening the Source/Sinks Dialog  ................................ ................................ ...............  10 \n3.6 Running MODFLOW  ................................ ................................ ................................ ... 11 \n3.7 Exam ining the Solution  ................................ ................................ ...............................  12 \n4 Changing the Active Flag for the Multi -node Well  ................................ ..........................  13 \n4.1 Running MODFLOW and Viewing the Solution  ................................ ..........................  13 \n5 Drawdown -Limited Wells  ................................ ................................ ................................ .. 13 \n5.1 Running MODFLOW and Viewing the Solution  ................................ ..........................  15 \n6 Creating a Conceptual Model  ................................ ................................ ...........................  15 \n6.1 Opening the Existing Conceptual Model  ................................ ................................ ..... 16 \n6.2 Examining the Existing Solution ................................ ................................ ..................  16 \n6.3 Changing the Model to Use MNW2  ................................ ................................ ............  16 \n6.4 Changing the Wells to MNW2  ................................ ................................ .....................  17 \n6.5 Examining the MNW2 Package  ................................ ................................ ..................  17 \n6.6 Saving and Running MODFLOW  ................................ ................................ ................  17 \n6.7 Examining the Solution  ................................ ................................ ...............................  18 \n7 Changing to a Multi -Node Well  ................................ ................................ .........................  18 \n7.1 Examining the MNW2 Package  ................................ ................................ ..................  18 \n7.2 Saving and Running MODFLOW  ................................ ................................ ................  19 \n7.3 Viewing the Flow in the MNW2  Boundary Conditions  ................................ .................  19 \n8 Conclusion  ................................ ................................ ................................ .........................  20 \n \n1 Introduction  \nThis tutorial is very similar to the \u201cMODFLOW MNW Package\u201d tutorial. The first MNW \nsample problem was converted to MNW2 using the USGS program \u201cmnw1to2.exe\u201d.  \nThe Multi -Node Well (MNW2) package was created to replace the MNW1 package. Both \npackages were developed to more accurately model \u201cwells that are completed in multiple \naquifers or in a single heterogeneous aquifer, partially -penetrating wells, and horizontal \nwells.\u201d Thes e can be influenced by the effects of dynamic changes in the distribution of \npumping or intra -borehole flow that can significantly alter groundwater flow.1  \nThe model in this tutorial is the same as the model used in the first MNW package \ndocumentation.  \nThe system consists of two aquifers that are separated by a 50 -foot-thick \nconfining unit. The upper aquifer is unconfined, has a hydraulic \nconductivity of 60 ft/d, and has a uniform base of 50 ft above the datum. \nThe lower aquifer is confined and has a trans missivity of 15,000 ft2/d. \nStorage coefficients of \u201c0.05\u201d and \u201c0.0001 \u201d were assigned to layers 1 and \n2, respectively. The 66 -mi2 area of the test problem was divided into 21 \nrows of 14 columns. Uniform, square cells that measured 2,500 ft on a \n                                                      \n1 Halford, K. J. and Hanson, R. T. (2002). User Guide for the Drawdown -Limited, Multi -Node Well \n(MNW) Package for the U.S. Geological Survey\u2019s Modular Three -Dimensional Finite Difference \nGround -Water Flow Model, Versions MODFLOW -96 and MODFLOW -2000 . U.S . Geological \nSurvey Open -File Report 02 -293, p.2. \nhttps://water.usgs.gov/nrp/gwsoftware/modflow2000/MNW_text.pdf  . \nGMS Tutorials   MODFLOW \u2013 MNW2 Package  \n \n Page 3 of 20 \u00a9 Aquaveo 2024  side were us ed throughout the simulated area. Specified heads and \ndrains are assigned in layer 1 and are maintained at the same elevations \nfor all stress periods.  \nA period of 1,000,970 days was simulated with 5 stress periods. The first \ntwo stress periods simulated s teady -state conditions, which were \nachieved by having each stress period be 500,000 days long. Recharge \nduring stress periods 1 and 2 was a uniform 7 inches per year (in./yr). No \npumpage was extracted during stress period 1 but multi -node wells were \nsimula ted. About 950,000 ft3/d of pumpage was extracted during stress \nperiod 2; this is about 35 percent of the total volumetric budget. Transient \nconditions were simulated during stress periods 3, 4, and 5, which were \nperiods of 60, 180, and 730 days, respectiv ely. Uniform recharge rates of \n2, 0, and 12 in./yr, respectively, were applied during stress periods 3, 4, \nand 5. In addition to the simulation of two multi -node wells (wells A and \nB), there are 15 other single -node wells that have a combined discharge \nof 935,350 ft3/d for stress periods 2 through 5. 2 \n \n      Figure 1      Explanation for Figure 23 \n \n                                                      \n2 Halford (2002), pp.15 -17. \n3 Halford (2002), p.16.  \n\nGMS Tutorials   MODFLOW \u2013 MNW2 Package  \n \n Page 4 of 20 \u00a9 Aquaveo 2024   \n      Figure 2      MNW example from the documentation4 \nThis tutorial will discuss and demonstrate importing an existing MODFLOW simulation, \nrunning the simulatio n, examining the results to understand the MNW2 package options, \nand modifying a conceptual model to use MNW2 instead of the WEL package.  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state. Click Don\u2019t Save  if asked to save changes.  \n                                                      \n4 Halford  (2002), p.16.  \n\nGMS Tutorials   MODFLOW \u2013 MNW2 Package  \n \n Page 5 of 20 \u00a9 Aquaveo 2024  2.1 Importing the Existing Model  \nTo start with a MODFLOW model that has already been created:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cMODFLOW Name Files (*.mfn;*.nam)\u201d from the Files of type  drop-down.  \n3. Browse to the mnw2 \\mnw2  folder and select \u201c mnw2.nam \u201d. \n4. Click Open  to exit the Open  dialog and bring up the MODFLOW Translator  \ndialog ( Figure 3). \n \n      Figure 3      MODFLOW Translator dialog  \n5. Click OK to accept the defaults and start the translation.  \nThe MODFLOW Translator runs and ends with a message sayin g \u201cMODFLOW 2000 \nterminated successfully.\u201d  \n6. Click Done  to close the MODFLOW Translator  dialog and import the file.  \nA grid with symbols representing wells, drains, and specified head boundary conditions \nwill appear ( Figure 4). \n\nGMS Tutorials   MODFLOW \u2013 MNW2 Package  \n \n Page 6 of 20 \u00a9 Aquaveo 2024   \n      Figure 4      Imported MODFLOW model  \n2.2 Saving the Model with a New Name  \nBefore making changes, it is a good idea to save the model with a new name.  \n1. Select File | Save A s\u2026 to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c mnw2.gpr \u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n3 Viewing the MNW2 Boundary Conditions  \nBefore running the simulation, it is possible to view the MNW2 boundary conditions.  \n3.1 Opening the MNW2 Package Dialog  \n1. Select MODFLOW  | Optional Packages  | MNW2 \u2013 Multi -Node Well\u2026  to open \nthe MODFLOW Multi -Node Well (MNW2) Package  dialog ( Figure 5). \n\nGMS Tutorials   MODFLOW \u2013 MNW2 Package  \n \n Page 7 of 20 \u00a9 Aquaveo 2024  This dialog is used to add and edit MNW2 wells and to change options associated with \nthe MNW2 package.  \n \n      Figure 5      MNW2 Package dialog  \nThe M NW2 documentation contains detailed information on each input option.5 \n3.2 Stress Period Data  \nThe MNW2 package allows certain things to vary per stress period, while other things \nremain constant for all stress periods. For example, well definitions are constan t for all \nstress periods \u2014that is, wells cannot be defined for some stress periods and not for \nothers, although they can be designated as active or inactive per stress period.  \n1. Use the increment up arrow  to adjust the Stress period  to \u201c2\u201d.  \n2. Notice that all of the wells except for \u201cWell -5B\u201d have a specified pumping rate in \nthis stress period.  \n3.3 Defining the Wells  \nThe spreadsheet in the dialog shows the data that can vary per stress period, but to \nactually add and delete wells, click on the Wells \u2026 button.  \n                                                      \n5 MNW2 documentation can be found online at http://pubs.usgs.gov/tm/tm6a30/  \n\nGMS Tutorials   MODFLOW \u2013 MNW2 Package  \n \n Page 8 of 20 \u00a9 Aquaveo 2024  1. Click Wells\u2026  to open the MNW2 Wells dialog ( Figure 6). \n \n      Figure 6      MNW2 Wells dialog  \nNotice the 16 MNW2 wells listed in the spreadsheet. Most of these are single -node wells. \nHowever, the wells named \u201cWELL -A\u201d and \u201cWELL -B\u201d are multi -node wells (they have \nmore than one node).  \nWells can be added, deleted, reordered, renamed, and have their options changed in this \ndialog. The nodes (cells) that are associated with each well are located in the bottom \nspreadsheet, Nodes for WELLID . \n2. On row 1 in the WELLID  column, select the \u201c WELL -A\u201d cell. \nNotice the nodes for \u201cWELL -A\u201d are listed in the bottom spreadsheet, along with some \nother variables ( Rw, Rskin , Kskin ). \n3. On row 1 in the top spreadsheet (the row for \u201cWELL -A\u201d), enter \u201c -1\u201d in the \nNNODES  column.  \nNotice the change in the Nodes  spreadshe et. Specifying a negative number for NNODES \nmeans the well is a vertical well, and instead of specifying the nodes for the well, it is \nnecessary to specify the top and bottom elevations of the well screen. The next step is to \nchange \u201cWELL -A\u201d to use a well screen.  \n4. In the Nodes  for WELLID  spreadsheet, enter \u201c400.0\u201d in the Ztop column.  \n5. Enter \u201c10.0\u201d in the Zbotm  column.  \n6. Click OK to exit the MNW2 Wells dialog.  \n7. Click OK to exit the MODFLOW Multi -Node Well ( MNW2 ) Package  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 MNW2 Package  \n \n Page 9 of 20 \u00a9 Aquaveo 2024  3.4 Examining the Well Screen for Well-A \nNow to change the display options so the well screen is more noticeable:  \n1. Select \u201c  3D Grid Data \u201d in the Project Explorer  to switch to the 3D Grid  \nmodule . \n2. Using the Select Cells   tool, select the cell in row 3, column 3. This cell \ncontains a well (highlighted in Figure 7). \n \n      Figure 7      Selected MNW2 well cell  \n3. Click the Front View   button.  \nNot much is visible while viewing the grid slice in front view ( Figure 8). The Z scale can \nbe exaggerated to see things better.  \n \n      Figure 8      The well screen is not easily visible at this scale  \n4. Click Display Options   to bring up the Display Options  dialog.  \n5. In the section below the list on the left, enter \u201c20.0\u201d for the Z magnification . \n6. Click OK to close the Display Options  dialog.  \n7. Click anywhere outside the grid to deselect the cell.  \nThe display should appear similar to Figure 9. \n\nGMS Tutorials   MODFLOW \u2013 MNW2 Package  \n \n Page 10 of 20 \u00a9 Aquaveo 2024   \n      Figure 9      Front view of grid at \u201cWELL -A\u201d \nNotice \u201cWELL -A\u201d (the one on the left) is drawn differently than the rest because it is a \nvertical well and uses a well screen. Square symbols are drawn at the top and bottom of \nthe well screen with a line connecting them. The other wells are dr awn with a symbol at \nthe cell center. Notice the well on the right side that has symbols in the top and bottom \nlayer. This is \u201cWELL -B\u201d and it has two nodes \u2014one in each layer.  \n3.5 Opening the Source/Sinks Dialog  \nNotice how MNW2 wells are handled by the Sources/ Sinks  dialog.  \n1. Using the Select Cells   tool, select the 3D grid cell with WELL -A in it \n(highlighted in Figure 10). \n \n      Figure 10      Selected MNW2 well cell  \n2. Right -click on the selected cell and select Sources/Sinks\u2026  to bring up the \nMODFLOW  Source s/Sinks  dialog ( Figure 11). \n \n      Figure 11      Sources/Sinks dialog  \nThis dialog allows for editing the properties of selected boundary conditions as well as \nadding ad ditional boundary conditions in the selected cells. With MNW2 wells, some \nthings are defined with the well and remain constant while other things can vary per \n\nGMS Tutorials   MODFLOW \u2013 MNW2 Package  \n \n Page 11 of 20 \u00a9 Aquaveo 2024  stress period. Only those things which can vary per stress period are shown in the \nspreadsheet. C licking on the button in the Edit column brings up the MNW2 Wells  dialog \n(discussed earlier), allowing the well definition to be edited.  \n3. Click OK to exit the MODFLOW Sources/Sinks  dialog.  \n4. Switch to Plan View  . \n3.6 Running MODFLOW  \nBefore running MODFLOW, it is necessary to change the output options to make it easier \nto see the results.   \n1. Select MODFLOW | OC \u2013 Output Control\u2026  to bring up the MODFLOW Output \nControl  dialog.  \n2. In the Output interval  section, select Output at last time step of each stress \nperiod . \n3. Turn on Save cell by cell flow terms to *.ccf file . \n4. Click OK to exit the MODFLOW Output Control  dialog.  \n5. Save   the project.  \n6. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n7. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already).  \n8. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.  \nContours should appear on the grid similar to those shown in Figure 12. Notice that \n\u201cWELL -A\u201d is still selected.  \n \n      Figure 12      MODFLOW solution  \n\nGMS Tutorials   MODFLOW \u2013 MNW2 Package  \n \n Page 12 of 20 \u00a9 Aquaveo 2024  9. Save   the project with the new solution.  \n10. Switch to Front View  . \n3.7 Examining the Solution  \nLook closely at the computed solution. From this  view, the water table and the head \ncontours can be seen ( Figure 13). Notice that on the left side of the view, the head is \ngreater in the top layer of the model. In c ontrast, the head on the right side of the view, \nwhere the specified head boundary condition is located, is less in layer 1 than in layer 2 \nof the model. Notice that the head in the selected cell is about \u201c180.0\u201d.  \n1. Select the cell in the second layer (Cell ID 325) just below the currently selected \ncell. \nNotice that the head in the cell in the second layer is about \u201c175.7\u201d. This means there is a \npotential for flow from layer 1 to layer 2 at these particular cells. This shows the effect \nthat the MNW2 multi -node well has on these grid cells.  \n \n      Figure 13      Cell ID 31 selected, showing contours indicating the cell head  \n2. Select and then right -click on \u201c  CCF (mnw2.ccf)\u201d in the Project Explorer  and \nselect CCF \u2192 Datasets . \nNotice that several additional datasets appear below this one.  \n3. Select the \u201c  MNW2 \u201d dataset  \n4. Click anywhere off the grid to unselect the grid cell.  \nNotice the head is lower in the top cell because the well screen passing through both \nlayers has allowed the higher head f rom above to flow into the lower aquifer cells (layer \n2). This is an example of intra -borehole flow that can occur when a well is completed in \nmore than one aquifer. The Flow Budget  dialog shows the effect of the multi -node wells.  \n5. Using the Select Cells   tool while holding down the Shift key, select the two \nwell cells on the left of the grid that contain a well screen.  \n6. Select MODFLOW | Flow Budget \u2026 to bring up the Flow Budget  dialog.  \nOn the MNW2  row, notice that the Flow In  and the Flow Out  are equal and opposite, just \nas expected. A flow of about \u201c -11,992\u201d leaves the model cell in layer 1 and enters the \nmodel cell in layer 2.  \n7. Click OK to exit the Flow Budget  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 MNW2 Package  \n \n Page 13 of 20 \u00a9 Aquaveo 2024  4 Changing the Active Flag for the Multi -node Well  \nAssume that \u201cWELL -A\u201d was n ot constructed until after the first stress period in the model. \nTherefore, the intra -borehole flow and any pumping should not be modeled until after the \nfirst stress period. This problem can be avoided by turning off the active flag for the \nboundary condi tion. \n1. Select MODFLOW  | Optional Packages  | MNW2 \u2013 Multi -Node Well\u2026  to open \nthe MODFLOW Multi -Node Well (MNW2) Package  dialog.  \n2. In the spreadsheet in the Stress period data  section, uncheck the box in the \nActive  column for the \u201cWELL -A\u201d row.  \n3. Enter \u201c 2\u201d in the  Stress period  field.  \n4. Notice that \u201cWELL -A\u201d is active in the second stress period . \n5. Click OK to exit the MODFLOW Multi -Node Well (MNW2) Package  dialog.  \n4.1 Running MODFLOW and Viewing the Solution  \nNow to run MODFLOW to see how the solution has changed:  \n1. Save   the project.  \n2. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n3. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) .  \n4. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.  \n5. Select and then right -click on \u201c  CCF (mnw2.ccf)\u201d  in the Project Explorer  and \nselect CCF \u2192 Datasets . \n6. Select the dataset named \u201c  MNW2 .\u201d \nNotice that there is no intra -borehole flow now at \u201cWELL -A\u201d during the first stress period.  \n5 Drawdown -Limited Wells  \nThe M NW2 package also allows for wells to be limited by the drawdown in the cell \ncontaining the well. This feature allows a well to stop pumping when the head in the cells \ndrops below a specified elevation. Now change the drawdown for one of the wells and \nsee t he effect on the solution. Before doing that, though, change the active flag back to \nits original state for \u201cWELL -A\u201d. \n1.  Select MODFLOW  | Optional Packages  | MNW2 - Multi -Node Well\u2026  to open \nthe MODFLOW Multi -Node Well (MNW2) Package  dialog.  \n2. In the spreadshee t in the Stress period data  section, check the box in the Active  \ncolumn for the \u201cWELL -A\u201d row.  \n3. Click OK to exit the MODFLOW Multi -Node Well (MNW2) Package  dialog.  \nNow to edit one of the MNW2 wells to illustrate the drawdown -limited feature:  \n4. Switch to Plan View  . \n\nGMS Tutorials   MODFLOW \u2013 MNW2 Package  \n \n Page 14 of 20 \u00a9 Aquaveo 2024  5. Select the bottom -right well cell (Cell ID 124, highlighted in Figure 14), right -click \non it, and select Sources/Sinks\u2026  to bring up the MODFLOW Sources/Sinks  \ndialog.  \n6. Select \u201cWells (MNW2)\u201d from the list on the left.  \n \n      Figure 14      MNW2 boundary condition cell (IJK = 9,12,1, ID = 124)  \n7. In the spreadsheet on row 124, scroll to the right to the Hlim (ft) column and click \nthe  button to bring up the XY Series Editor  dialog.  \nThis allows editing of the value of Hlim (ft) for the boundary condition. Notice the four \nrows in the spreadsheet which have a value of \u201c115.0\u201d in the Hlim (ft)  column.  \n8. Enter \u201c 142.0 \u201d in the Hlim (ft)  column  for each of those four rows (replacing the \n\u201c115.0\u201d).  \n9. Click OK to exit the XY Series Editor dialog.  \n10. Click OK to exit the MODFLOW Sources/Sinks dialog.  \n\nGMS Tutorials   MODFLOW \u2013 MNW2 Package  \n \n Page 15 of 20 \u00a9 Aquaveo 2024  5.1 Running MODFLOW and Viewing the Solution  \nNow to run MODFLOW to see how the solution has changed:  \n1. Save   the project.  \n2. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n3. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.  \n5. Select and then right -click on \u201c  CCF (mnw2.ccf)\u201d in the Project Explorer  and \nselect CCF \u2192 Datasets . \n6. Select the dataset named \u201c  MNW2 \u201d and change the active time step to the \nsecond time step listed in the Time Step window  below the Project Explorer . \nNotice that the flow at the cell that was edited is about \u201c -3127.1\u201d.  \n7. Select the \u201c  Head \u201d dataset. Notice that the head in this cell is about \u201c142.7\u201d.  \nRemember, the desired flow rate (Qdes) that was specified for the well was \u201c -66850.0 \u201d. \nNevertheless, the computed  flow for this drawdown limited well was only \u201c -3127\u201d. Now it \nis necessary to look at the head at the next output time.  \n8. Select the third time step listed in the Time Step window . Notice that the head at \nthe cell is about \u201c141.6\u201d.  \n9. Change to the \u201c MNW2 \u201d datas et and notice that the flow in this time step is \u201c0.0\u201d.  \nEven though the head value is high enough, the well has been deactivated during this \nstress period. Find out why by examining the well\u2019s settings in the MNW2  Package  \ndialog.  \n10. Select MODFLOW | Optional Packages | MNW2 \u2013 Multi -Node Well \u2026 to open \nthe MODFLOW Multi -Node Well ( MNW2)  Package  dialog.  \n11. Change the Stress period  to \u201c2\u201d and notice the Hlim (ft) settings for Well 12 . The \ndialog window can be resized in order to see more columns.  \n12. Change to the next s tress period.  \nNotice that for this stress period, the QCUT  value has been set to \u201c -1\u201d (making the \nQfrcmn  a percentage value) with a Qfrcmn  value of \u201c0.45\u201d (45 percent). The Qfrcmn  \nvalue is the minimum pumping rate required for the well to remain active. With a desired \nflow rate ( Qdes ) of \u201c-66850.0\u201d, it would be necessary to have a flow rate of \u201c -30082.5\u201d for \nthe well to remain active. For the previous stress period, QCUT  was set to  \u201c0\u201d (none), \nallowing the well to be active.  \n13. Click OK to exit the MODFLOW Multi -Node Well (MNW2) Package  dialog.  \n6 Creating a Conceptual Model  \nThe next step is to examine how to use a conceptual model with MNW2 data. This will be \ndone by taking the finished model from the \u201c MODFLOW \u2013 Conceptual Model Approach  I\u201d \ntutorial and changing it for use with the MNW2 package.  \n\nGMS Tutorials   MODFLOW \u2013 MNW2 Package  \n \n Page 16 of 20 \u00a9 Aquaveo 2024  6.1 Opening the Existing Conceptual Model  \n1. Save   the grid -based MNW2 model before opening the conceptual model.  \n2. Click New  to ensure the program set tings are restored to their defaults.  \n3. Click Open   to bring up the Open  dialog.  \n4. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n5. Browse to the mnw2 \\mnw2\\sample  directory and select \u201cmod fmap 2.gpr\u201d. \n6. Click Open  to import the new project and ex it the Open  dialog.  \nThe Graphics Window should appear similar to Figure 15. Before making any changes, \nsave the project under a new name.  \n7. Select File | Save As \u2026 to bring up the Save As  dialog.  \n8. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n9. Browse to the mnw2 \\mnw2  folder.  \n10. Enter \u201c MNWmap. gpr\u201d as the File name . \n11. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n \n      Figure 15      Initial imported model  \n6.2 Examining the Existing Solution  \nBefore changing to the MNW2 package, look at the flow budget for the existing solution \nby doing the following:  \n1. Select MODFLOW  | Flow Budget\u2026  to bring up the Flow Budget  dialog.  \nNotice the flow budget for the well package has a Flow Out rate of about \u201c -2189.2\u201d.  \n2. Click  OK to exit the Flow Budget  dialog.  \n6.3 Changing the Model to Use MNW2  \nTo change to the MNW2 package, first the WEL package needs to be removed from \nMODFLOW.  \n\nGMS Tutorials   MODFLOW \u2013 MNW2 Package  \n \n Page 17 of 20 \u00a9 Aquaveo 2024  1. Select MODFLOW | Global Options\u2026  to open the MODFLOW Global/Basic \nPackage dialog.  \n2. Click Packages \u2026 to bring up the MODFLOW Packages  / Processes  dialog.  \n3. In the Optional packages / processes  section, turn off WEL1 \u2013 Well to disable the \nWEL package.  \n4. Click OK to exit the MODFLOW Packages  / Processes  dialog.  \n5. Click OK to exit the MODFLOW Global/Basic Package dialog.  \n6.4 Changing the Wells to MNW2  \nWith the WEL packaged turned off, now set the wells to use MNW2.  \n1. Fully expand the \u201c  Map Data\u201d folder.  \n2. Select and right -click on the \u201c  Sources&Sinks\u201d coverage and select Coverage \nSetup\u2026  to bring up the Coverage Setup  dialog.  \n3. In the Sources/Sinks/BCs  column, turn on Wells ( MNW2 ). \n4. Click OK to exit the Coverage Setup  dialog.  \n5. Right -click on \u201c  Sources&Sinks\u201d and select Attribut e Table\u2026  to bring up the \nAttribute Table  dialog.  \n6. In the All row of the spreadsheet, select \u201cwell (MNW2)\u201d from the drop -down in the \nType  column.  \n7. On row 16 (\u201cwell1\u201d), scroll to the right and enter \u201c -50.0\u201d in the Qdes  (m^3/d) \ncolumn . \n8. On row 17 (\u201cwell2\u201d), enter \u201c -300.0\u201d in the Qdes  (m^3/d)  column.  \n9. Click OK to exit the Attribute Table  dialog.  \nWith the conceptual model now set up, it is possible to map it to the MODFLOW grid.  \n10. Click Map \u2192 MODFLOW   to bring up the Map \u2192 Model  dialog . \n11. Click OK to accept the defaults and close the Map \u2192 Model  dialog.  \n6.5 Examining the MNW2 Package  \nNow to take a look at the data in MODFLOW that was mapped from the conceptual \nmodel:  \n1. Select MODFLOW  | Optional Packages  | MNW2 \u2013 Multi -Node Well\u2026  to open \nthe MODFLOW Multi -Node Well (MNW2) Package  dialog.  \nReview the two MNW2 wells. These were created by using Map \u2192 MODFLOW  . \n2. Click OK to exit the MODFLOW Multi -Node Well (MNW2) Package  dialog . \n6.6 Saving and Running MODFLOW  \nNow it is possible to save the changes and run MODFLOW.  \n1. Select MODFLOW | OC \u2013 Output Control\u2026  to bring up the MODFLOW Output \nControl  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 MNW2 Package  \n \n Page 18 of 20 \u00a9 Aquaveo 2024  2. In the Other output  section, turn off *.hff file for transport . \n3. Click OK to exit the MODFLOW Output Control  dialog . \n4. Save   the project.  \n5. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n6. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n7. Click Close  to import the solution and close the MODFLOW  dialog.  \n8. Save   the project with the new solution.  \n6.7 Examining the Solution  \nNow look at the flow budget for the new solution.  \n1. Select MODFLOW  | Flow Budget\u2026  to bring up the Flow Budget  dialog.  \nNotice the flow budget for the MNW2 package has the same Flow Out rate of \u201c -2344.6\u201d . \n2. Click  OK to exit the Flow Budget  dialog.  \n7 Changing to a Multi -Node Well  \nNow to create a multi -node well (a well with multiple nodes) from the map data:  \n1. Right -click on the \u201c  Sources&Sinks \u201d coverage and select Attribute Table\u2026  to \nbring up the Attribute Table  dialog.  \n2. Enter \u201c1\u201d in the From layer  column for \u201c well2 \u201d (row 17) in the table.  \n3. Click OK to exit the Attribute Table  dialog.  \nThe conceptual model is set up so now it is possible to map it to the MODFLOW grid.  \n4. Click Map \u2192 MODFLOW   to bring up the Map \u2192  Model  dialog . \n5. Click OK to accept the defaults and exit the Map \u2192 Model  dialog.  \n7.1 Examining the MNW2 Package  \nNext, review the data in MODFLOW that was mapped from the conceptual model.  \n1. Select MODFLOW | Optional Packages | MNW2 \u2013 Multi -Node Well\u2026  to bring up \nthe MODFLOW Multi -Node Well (MNW2) Package  dialog.  \n2. Click Wells \u2026 to bring up the MNW2 Wells  dialog.  \n3. In the WELLID  column on row 2, select \u201c well2 \u201d. \n4. In the NNODES  column, notice that \u201cwell2\u201d has 2 nodes.  \n5. Select \u201cTHIEM\u201d from the drop -down in the LOSSTYPE  column on row 2. \nWells that have more than one node must specify a LOSSTYPE other than NONE.  \n6. Click OK to exit the MNW2 Wells dialog . \n7. Click OK to exit the MODFLOW Multi -Node Well (MNW2) Package dialog.  \n\nGMS Tutorials   MODFLOW \u2013 MNW2 Package  \n \n Page 19 of 20 \u00a9 Aquaveo 2024  7.2 Saving and Running MODFLOW  \nBefore saving the changes a nd running MODFLOW, it is necessary to adjust the \nparameters associated with the solver.  \n1. Select MODFLOW | PCG \u2013 Pre. Conj. -Gradient Solver\u2026  to bring up the \nMODFLOW PCG Package  dialog.  \n2. Enter \u201c100\u201d as the Maximum number of outer iterations  (MXITER ).  \n3. Enter \u201c 0.5\u201d as the Relaxation parameter  (RELAX) .  \n4. Click OK to exit the MODFLOW PCG Package  dialog.  \n5. Select File | Save As\u2026  to bring up the Save As  dialog.  \n6. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n7. Enter \u201c MNWmap2 .gpr\u201d as the File name  \n8. Click  Save  to save the project under the new name and close the Save As  \ndialog.  \n9. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n10. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n11. Click Close  to import  the solution and exit the MODFLOW  dialog.  \n7.3 Viewing the Flow in the MNW2 Boundary Conditions  \nNow view the computed flow out of each of the well2 MNW2 boundary conditions.  \n1. Select the \u201c  3D Grid Data\u201d folder to make it active.  \n2. Zoom   in on the well on the rig ht side of the model.  \n3. Using the Select Cell s  tool, select the cell containing the well (Cell ID 1944).  \n4. Select MODFLOW | Flow Budget \u2026 to bring up the Flow Budget  dialog.  \nNotice that the Flow Out of the well in the top layer is about \u201c -169.3\u201d.  \n5. Click OK to exit the Flow Budget  dialog.  \n6. Use the up arrow in the Mini Grid Toolbar to switch to Lay (k)  (layer) \u201c2\u201d of the \ngrid. \n7. Using the Select Cell s  tool, select the cell containing the well (Cell ID 5024).  \n8. Select MODFLOW | Flow Budget \u2026 to bring up the Flow Budg et dialog.  \nNotice that the Flow Out rate for this well is about \u201c -130.7\u201d.  \n\nGMS Tutorials   MODFLOW \u2013 MNW2 Package  \n \n Page 20 of 20 \u00a9 Aquaveo 2024  8 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 MNW2 Package\u201d tutorial. The following key concepts \nwere discussed and demonstrated in this tutorial:  \n\uf0b7 GMS supports the MNW2 package.  \n\uf0b7 The MNW2  package produces the same results as the WEL package when there \nare no multi -node wells.  \n\uf0b7 MNW2 data can be viewed and edited in the MODFLOW Multi -Node Well \n(MNW2) Package  dialog.  \n\uf0b7 MNW2 wells can be created in the conceptual model and mapped to the grid.   \n \n", "filename": "MODFLOW-MNW2Package.pdf", "pages": 20}, "MODFLOW-MNWPackage": {"text": "GMS Tutorials   MODFLOW \u2013 MNW Package  \n Page 1 of 18 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 MNW Package  \nUse the MNW package with the sample problem and a conceptual \nmodel  \nObjectives   \nLearn how to use Multi -Node Well (MNW) package in GMS and compare it to the WEL package. Both \npackages can be used at the same time if desired. Examine the sample MNW model that comes with \nMODFLOW and then examine a different model that uses the conceptual model approach.  \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach I  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 30\u201345 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 MNW Package  \n Page 2 of 18 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  4 \n2.1 Importing the Existing Model ................................ ................................ .........................  4 \n2.2 Saving the Model with a New Name  ................................ ................................ .............  5 \n2.3 Viewing the MNW Boundary Conditions  ................................ ................................ ....... 6 \n2.4 Reviewing the Source/Sinks Dialog  ................................ ................................ ..............  6 \n2.5 Running MODFLOW  ................................ ................................ ................................ ..... 7 \n2.6 Examining the Solution  ................................ ................................ ................................ . 8 \n3 Changing the Active Flag for the Multi -Node Well  ................................ ............................  9 \n3.1 Running MODFLOW and Viewing the Solution  ................................ ..........................  10 \n4 Drawdown Limited Wells  ................................ ................................ ................................ .. 10 \n4.1 Running MODFLOW and Viewing the Solution  ................................ ..........................  11 \n4.2 Drawdown Limited Multi -Node Wells  ................................ ................................ ..........  12 \n5 Create a Conceptual Model  ................................ ................................ ...............................  14 \n5.1 Open the Existing Conceptual Model  ................................ ................................ ..........  14 \n5.2 Examining the Existing Solution ................................ ................................ ..................  15 \n5.3 Changing the Model to Use MNW  ................................ ................................ ..............  15 \n5.4 Changing the Wells to MNW  ................................ ................................ .......................  15 \n5.5 Examine the MNW Package  ................................ ................................ .......................  16 \n5.6 Saving and Running MODFLOW  ................................ ................................ ................  16 \n5.7 Examining the Solution  ................................ ................................ ...............................  16 \n6 Changing to a Multi -Node Well  ................................ ................................ .........................  16 \n6.1 Examine the MNW Package  ................................ ................................ .......................  17 \n6.2 Saving and running MODFLOW  ................................ ................................ .................  17 \n6.3 Viewing the Flow in the MNW Boundary Conditions  ................................ ...................  17 \n7 Conclusion  ................................ ................................ ................................ .........................  18 \n \n1 Introduction  \nThe Multi -Node Well (MNW) package was developed to more accurately model wells that \nare completed in multiple aquifers or in a single heterogeneous aquifer, partially \npenetrating wells, and horizontal wells that can be influenced by the effects of dynamic \nchanges in the distribution of pumping or intra -borehole flow that can significantly alter \ngroundwater flow.1  \nThe problem in this tutorial ( Figure 1 and Figure 2) is the same as the model used in the \nMNW documentation:  \nThe system consists of t wo aquifers that are separated by a 50 -foot-thick \nconfining unit. The upper aquifer is unconfined, has a hydraulic \nconductivity of 60 ft/d, and has a uniform base of 50 ft above the datum. \nThe lower aquifer is confined and has a transmissivity of 15,000 ft2/d. \nStorage coefficients of 0.05 and 0.0001 were assigned to layers 1 and 2, \nrespectively. The 66 -mi2 area of the test problem was divided into 21 \nrows of 14 columns. Uniform, square cells that measured 2,500 ft on a \nside were used throughout the simulate d area. Specified heads and \ndrains are assigned in layer 1 and are maintained at the same elevations \nfor all stress periods.  \nA period of 1,000,970 days was simulated with 5 stress periods. The first \ntwo stress periods simulated steady -state conditions, wh ich were \n                                                      \n1 Halford, K. J. and Hanson, R. T. (2002). User Guide for the Drawdown -Limited, Multi -Node Well \n(MNW) Package for the U.S. Geological Survey\u2019s Modular Three -Dimensional Finite Difference \nGround -Water Flow Model, Versions MODFLOW -96 and MODFLOW -2000 . U.S. Geological \nSurvey Open -File Report 02 -293, p.15 \u201317. \nhttps://water.usgs.gov/nrp/gwsoftware/modflow2000/MNW_tex t.pdf . \nGMS Tutorials   MODFLOW \u2013 MNW Package  \n \n Page 3 of 18 \u00a9 Aquaveo 2024  achieved by having each stress period be 500,000 days long. Recharge \nduring stress periods 1 and 2 was a uniform 7 inches per year (in./yr). No \npumpage was extracted during stress period 1 but multi -node wells were \nsimulated. About 950,000 ft3/d of pumpage was extracted during stress \nperiod 2; this is about 35 percent of the total volumetric budget. Transient \nconditions were simulated during stress periods 3, 4, and 5, which were \nperiods of 60, 180, and 730 days, respectively. Uniform recharge rate s of \n2, 0, and 12 in./yr, respectively, were applied during stress periods 3, 4, \nand 5. In addition to the simulation of two multi -node wells (wells A and \nB), there are 15 other single -node wells that have a combined discharge \nof 935,350 ft3/d for stress p eriods 2 through 5.2  \nThis tutorial discusses and demonstrates importing an existing MODFLOW simulation, \nrunning the simulation, examining the results to understand the MNW package options, \nand modifying a conceptual model to use MNW instead of the WEL pac kage.  \n \n      Figure 1      Legend  for Figure 23 \n                                                      \n2 Halford (2002).  \n3 Ibid. \n\nGMS Tutorials   MODFLOW \u2013 MNW Package  \n \n Page 4 of 18 \u00a9 Aquaveo 2024   \n      Figure 2      MNW example from the documentation4 \n2 Getting S tarted  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state. Click Don\u2019t Save  if asked to save changes.  \n2.1 Importing the Existing Model  \nThis tutorial will start with a MODFLOW model that has already been created.  \n1. Click Open   to bring up the Open  dialog.  \n                                                      \n4 Halford (2002).  \n\nGMS Tutorials   MODFLOW \u2013 MNW Package  \n \n Page 5 of 18 \u00a9 Aquaveo 2024  2. Select \u201cAll Files (*.*)\u201d from the Files of type  drop-down.  \n3. Browse to the mnw \\mnw  folder and select \u201c mnw1.nam \u201d. \n4. Click Open  to exit the Open dialog and bring up the MODFLOW Translator  \ndialog.  \n5. Click OK to accept the default options and initiate the translation of the file.  \n6. When MODFLOW 2000 terminates successfully, click Done  to close the \nMODFLOW Translator  dialog and finish importing the fil e. \nA grid with symbols representing wells, drains, and specified head boundary conditions \nshould appear ( Figure 3). \n \n      Figure 3      Imported MODFLOW model  \n2.2 Saving the Model with a New Name  \nBefore making changes, it is best to save the model with a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c MNW .gpr\u201d as the File name . \n\nGMS Tutorials   MODFLOW \u2013 MNW Package  \n \n Page 6 of 18 \u00a9 Aquaveo 2024  4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n2.3 Viewing the MNW Boundary Conditions  \nBefore running the simulation, it is possible to view the MNW boundary conditions.  \n1. Select MODFLOW | Optional Packages | MNW1 \u2013 Multi -Node Well\u2026  to open \nthe MODFLOW Multi -Node Well Package  dialog.  \nThis dialog is used to edit existing MNW boundary conditions  and to change options \nassociated with the MNW package. The options located near the top of the dialog apply \nto the MNW package, while the spreadsheet near the bottom allows editing of individual \nMNW boundary conditions. Instead of repeating all of the MNW  documentation here, \nreview it on the USGS MODFLOW website as needed for more information on each input \noption.5 \nNow to examine the MNW boundary conditions:  \n2. Notice the 17 MNW wells listed in the spreadsheet.  \nMost of these are single -node wells. However, the wells named \u201cWell -A\u201d and \u201cWell -B\u201d are \nmulti -node wells. Notice that for each of the wells labeled \u201cWell -A,\u201d the Well ID  is \u201c1\u201d, and \nfor each of the wells labeled \u201cWell -B,\u201d the Well ID is \u201c4\u201d.  \n3. Enter \u201c2\u201d for the Stress period . \nNotice that nearly all of t he wells have a specified pumping rate in this stress period \nexcept for \u201cWell -A\u201d and \u201cWell -B\u201d. Only one of the boundary conditions associated with \neach of the multi -node wells has a desired pumping rate specified. The MNW package \nwill determine how much of  the desired flow should come from each of the nodes \nassociated with a multi -node well.  \nGMS now has the Name , Active , and Well ID  fields. Name  is a label used to identify a \nboundary condition. Active  is a flag used to determine if the boundary condition is  used \nduring a particular stress period. The Well ID  field is used to identify multi -node wells. \nRefer to the MNW documentation6 for a full explanation of each of the inputs to the MNW \nboundary conditions.  \n4. Click OK to close the MODFLOW Multi -Node Well Pack age dialog.  \n2.4 Reviewing the Source/Sinks Dialog  \n1. Switch to the 3D Grid module by selecting the \u201c  3D Grid Data \u201d item in the \nProject Explorer . \n2. Using the Select Cells   tool, select the 3D grid cell highlighted in Figure 4. \n                                                      \n5 \u201cMNW1 \u2013 Multi -Node, Drawdown Limited Well Package\u201d, Online Guide to MODFLOW . U.S. \nGeological Survey, 2016. \nhttp://water.usgs.gov/nrp/gwsoftware/modflow2000/MFDOC/index.html?mnw.htm . \n6 \u201cMNW1\u201d (2016).  \n\nGMS Tutorials   MODFLOW \u2013 MNW Package  \n \n Page 7 of 18 \u00a9 Aquaveo 2024   \n      Figure 4      Selected MNW well cell (IJK: 3,3,1,)  \n3. Right -click on the selected cell and select Sources/Sinks\u2026  to bring up the \nMODFLOW  Source s/Sinks  dialog.  \nThis dialog allows for editing of the properties of a selected boundary condition, as well \nas the adding of additional boundary conditions in the selected cells. Note that some of \nthe properties available for MNW boundary conditions (such as Well ID ) do no t allow \nentering a time series. Therefore, the values entered in this dialog for these properties \nwill be assigned to the boundary condition for all stress periods.  \n4. Select OK to exit the MODFLOW  Source s/Sinks  dialog.  \n2.5 Running MODFLOW  \nBefore running MODFLOW,  it is necessary to change the output options to make it easier \nto see the results.   \n1. Select MODFLOW | OC \u2013 Output Control\u2026  to bring up the MODFLOW Output \nControl  dialog.  \n2. In the Output interval  section, select Output at last time step of each stress \nperiod . \n3. Turn on Save cell by cell flow terms to *.ccf file . \n4. Click OK to exit the MODFLOW Output Control  dialog.  \nNow to save these changes and run MODFLOW:  \n5. Save   the project.  \n6. Select MODFLOW  | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n\nGMS Tutorials   MODFLOW \u2013 MNW Package  \n \n Page 8 of 18 \u00a9 Aquaveo 2024  7. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n8. Click Close  to close the MODFLOW  model wrapper dialog.   \nContours should appear on the grid similar to those shown in Figure  5. \n \n      Figure  5      MODFLOW solution  \n9. Save   the project with the new solution.  \n2.6 Examining the Solution  \nNow to look closely at the computed solution:  \n1. If necessary, re -select the grid cell selected in Figure 4 (Cell ID: 31).  \n2. Switch to Front View  . \n3. Click Display Options   to bring up the Display Options  dialog.  \n4. In the section below the list on the left, enter \u201c20.0\u201d for the Z magnification . \n5. Click OK to close the Display Options  dialog.  \nFrom this view, it is possible to see the water table and the head contours ( Figure 6). \nNotice that on the left side of the vie w, the head is greater in the top layer of the model. In \ncontrast, the head on the right side of the view \u2014where the specified head boundary \ncondition is located \u2014is less in layer 1 than in layer 2 of the model. Notice that the head in \nthe selected cell is a bout \u201c179.8\u201d.  \n\nGMS Tutorials   MODFLOW \u2013 MNW Package  \n \n Page 9 of 18 \u00a9 Aquaveo 2024   \n      Figure 6      Front view showing water table and head contours  \n6.  Select the cell directly below the one currently selected (Cell ID: 325).  \nNotice that the head in the cell in the second layer is about \u201c175.8\u201d. This means there is a \npotential for flow from layer 1 to layer 2 at these particular cells. It is also possible to see \nwhat effect the MNW multi -node well has on these grid cells.  \n7. Select \u201c  CCF (MNW.ccf)\u201d in the Project Explorer , then right -click on it and  \nselect CCF \u2192 Data sets. \n8. Select the new \u201c  MNW \u201d dataset.  \n9. Click anywhere off the grid to unselect the grid cell.  \nNotice that flow is occurring between the multi -node well boundary conditions at these \ncells. This is an example of intra -borehole flow that can occur when a well is completed in \nmore than one aquifer. The effect of the multi -node wells is visible by looking at the Flow \nBudget  dialog.  \n10. Select the two wells on the left side of the grid by selecting one cell and then \nholding down the Shift key while selecting the other. (Cell IDs: 325 and 31)  \n11. Select MODFLOW | Flow Budget \u2026 to bring up the Flow Budget  dialog.  \nNotice that values on the MNW  row in the Flow In  and the Flow Out  columns are equal \nand opposite, just as expected. A flow of about \u201c -16088.6\u201d leaves the model cell in layer \none and enters the model cell in layer two.  \n12. Click OK to exit the Flow Budget  dialog.  \n3 Changing the Active Flag for the Multi -Node Well  \nNow it is possible to see the effect of turning off the active flag for the multi -node well. \nAssume that \u201cWell -A\u201d was not constructed until after the first stress period in the model. \nTherefore, do not model the intra -borehole flow or any pumping until after the first stress \nperiod. This can be accomplished by turning off the active flag  for the boundary condition.  \n1. Select MODFLOW | Optional Packages | MNW1 \u2013 Multi -Node Well\u2026  to open \nthe MODFLOW Multi -Node Well Package  dialog.  \n2. In the spreadsheet at the bottom, uncheck the box in the Active  column for both \n\u201cWell -A\u201d boundary conditions.  \n3. Chan ge the Stress period  to \u201c2\u201d just above the spreadsheet.  \nNotice that \u201cWell -A\u201d is active in stress period \u201c2\u201d.  \n4. Click OK to exit the MODFLOW Multi -Node Well Package  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 MNW Package  \n \n Page 10 of 18 \u00a9 Aquaveo 2024  3.1 Running MODFLOW and Viewing the Solution  \nNow it is possible to run MODFLOW to see how the solution has changed.  \n1. Save   the project.  \n2. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n3. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) .  \n4. Click Close  to exit the MODFLOW  model wrapper dialog.  \n5. Select and then right -click on \u201c  CCF (MNW.ccf)\u201d in the Project Explorer  and \nselect CCF \u2192 Datas ets. \n6. Select the \u201c  MNW \u201d dataset.  \nNotice that there is no intra -borehole flow now at \u201cWell -A\u201d during the first stress period.  \n4 Drawdown Limi ted Wells  \nThe MNW package also allows for wells to be limited by the drawdown in the cell \ncontaining the well. This feature allows a well to stop pumping when the head in the cells \ndrops below a specified elevation. The next step in the tutorial will be to  change the \ndrawdown for one of the wells and see the effect on the solution. However, first change \nthe active flag back to its original state for \u201cWell -A.\u201d \n1.  Select MODFLOW | Optional Packages | MNW1 \u2013 Multi -Node Well\u2026  to open \nthe MODFLOW Multi -Node Well P ackage  dialog.  \n2. In the spreadsheet at the bottom, check the box in the Active  column for both \n\u201cWell -A\u201d boundary conditions.  \n3. Click OK to exit the MODFLOW Multi -Node Well Package  dialog.  \nNow to edit one of the MNW wells to illustrate the drawdown -limited feat ure: \n4. Switch to Plan View  . \n5. Select the \u201c MNW\u201d dataset and change the active time step to the second time \nstep listed in the Time Step Window  below the Project Explorer.  \n\nGMS Tutorials   MODFLOW \u2013 MNW Package  \n \n Page 11 of 18 \u00a9 Aquaveo 2024   \n      Figure 7      MNW boundary condition cell  \n6. Select the  cell highlighted in dark green as in Figure 7  (bottom right cell of the \ngroup of wells, Cell ID: 124), then right -click and select Sources/Sinks \u2026 to bring \nup the MODFLOW Sources/Sinks  dialog.  \n7. Scroll to the right in the spreadsheet to the Hlim column and c lick the  button \non row 124 to bring up the XY Series Editor  dialog.  \n8. In the Hlim column, on rows 2\u20135, enter \u201c 142.0 \u201d. \n9. Click OK to exit the XY Series Editor dialog.  \n10. Click OK to exit the MODFLOW Sources/Sinks dialog.  \n4.1 Running MODFLOW and Viewing the Solution  \nNow to run MODFLOW to see how the solution has changed:  \n1. Save   the project.  \n2. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n3. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to impo rt the solution and close the MODFLOW  model wrapper \ndialog.  \n\nGMS Tutorials   MODFLOW \u2013 MNW Package  \n \n Page 12 of 18 \u00a9 Aquaveo 2024  5. Select \u201c  CCF (MNW.ccf)\u201d in the Project Explorer , then right -click on it and \nselect CCF \u2192 Datas ets. \n6. Select the \u201c MNW\u201d dataset and change the active time step to the second time \nstep listed in the Time Step Window  below the Project Explorer.  \nNotice that the flow at the cell that was edited is about \u201c-5754 .48\u201d. \n7. Select the \u201c  Head \u201d dataset.  \nNotice that th e head in th is cell is about \u201c 143.29 \u201d. Remember, the desired flow rate \n(Qdes ) that was specified for the well was \u201c 66850.0 \u201d. Nevertheless, the computed flow for \nthis drawdown limited well was only \u201c6130\u201d. Now it is possible to look at the head at the \nnext output time.  \n8. Select the third time step listed in the Time Step Window . Notice that the head at \nthe cell is about \u201c142.37\u201d.  \n9. Change to the \u201c MNW \u201d dataset and notice that the flow in this time step is \u201c0.0\u201d.  \nEven though the head value is high enough, the well has been de activated during this \nstress period. Find out why by examining the well\u2019s settings.  \n10. Select MODFLOW | Optional Packages | MNW1 \u2013 Multi -Node Well \u2026 to open \nthe MODFLOW Multi -Node Well  Package  dialog.  \n11. Change Stress period  to \u201c2\u201d and notice the settings for Cell ID 124 near the \nbottom of the spreadsheet.  \n12. Change Stress period  to \u201c3\u201d.   \nNotice that \u2014for this stress period \u2014the QCUT  value has been set to \u201cPercent (2)\u201d with a \nQfrcmn  value of \u201c45.0\u201d (a percentage). The Qfrcmn  value is the minimum pumping rate \nrequired for the well to remain active. With a desired flow rate ( Qdes ) of \u201c-66850.0\u201d, a \nflow rate of \u201c -30082.5\u201d is needed for the well to remain active. For the previous stress \nperiod, QCUT  was set to \u201cNone (0)\u201d, allowin g the well to be active.  \n13. Click OK to exit the MODFLOW Multi -Node Well Package  dialog.   \n4.2 Drawdown Limited Multi -Node Wells  \nFor multi -node wells, the limiting water level needs to be specified for the first multi -node \ncell listed in the MNW package dialog.  \n1. Select MODFLOW  | Optional Packages | MNW1 \u2013 Multi -Node Well\u2026  to open \nthe MODFLOW Multi -Node Well Package  dialog.  \n2. Change Stress period  to \u201c2\u201d.   \nNotice that (for this stress period) the first \u201cWell -A\u201d has a flow rate of \u201c -20000\u201d.  \n3. Scroll to the right in the s preadsheet so the Hlim and DD columns are visible.   \nNotice that the Hlim value is set to \u201c50.0\u201d and the DD is set to \u201cRelative (2)\u201d. When using \nrelative drawdown, the Hlim value used by MODFLOW is calculated by either adding or \nsubtracting Hlim from Href. When the Qdes  value is greater than zero, Hlim is added to \nHref, and when the Qdes  value is less than zero, Hlim is subtracted from Href. To \ndemonstrate how the sign of the Qdes  value can affect the model, adjust the Qdes  values \nfor \u201cWell -A\u201d: \n4. Scroll to the  left in the spreadsheet to the Qdes  (flow) (ft^3/d)  column and enter  \n\u201c-1.0\u201d on row 1 (\u201cWell -A\u201d). \n\nGMS Tutorials   MODFLOW \u2013 MNW Package  \n \n Page 13 of 18 \u00a9 Aquaveo 2024  5. On row 2, enter \u201c -19999.0 \u201d for Qdes (flow) (ft^3/d) (the second \u201cWell -A\u201d cell). The \ncombined value of Qdes  for \u201cWell -A\u201d remains \u201c -20000\u201d.  \n6. Click OK to exit the MODFLOW Multi -Node Well Package  dialog.   \nBefore running MODFLOW with these changes, it is necessary to check head and multi -\nnode well values in the first cell to verify that they will remain the same.  \n7. Using the Select Cells   tool, select the top-left well cell (Well -A, Cell ID: 31, \nsee Figure 8).  \n8. Select the second time step in the Time Step Window. Notice that the flow for the \ncell is about \u201c -20120.7\u201d.  \n \n      Figure 8      Selected MNW well cell  \n9. Select the \u201c  Head\u201d dataset in the Project Explorer. Notice that the head value \nis about \u201c164.60\u201d.  \n10. Save   the project.  \n11. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n12. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n13. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.  \n14. Select the \u201c  Head\u201d  dataset and select the second time step in the Time Step \nWindo w. Notice that the head in this cell remains at about \u201c164.60\u201d.  \n15. Select \u201c  CCF (MNW.ccf)\u201d in the Project Explorer , then right -click on it and \nselect CCF \u2192 Datas ets. \n\nGMS Tutorials   MODFLOW \u2013 MNW Package  \n \n Page 14 of 18 \u00a9 Aquaveo 2024  16. Select the \u201c  MNW \u201d dataset and select the second time step in the Time Step \nWindow . Notice t hat the flow remains at about \u201c -20120.7\u201d.   \nNow adjust the Qdes  values so that the sum remains the same but the sign of the Qdes  \nfor the first cell is positive.  \n17. Select MODFLOW | Optional Packages | MNW1 \u2013 Multi -Node Well \u2026 to open \nthe MODFLOW Multi -Node Well  Package  dialog.  \n18. Change Stress period  to \u201c2\u201d.  \n19. On row 1 (the first \u201cWell -A\u201d cell), enter \u201c 1.0\u201d in the Qdes  (flow) (ft^3/d)  column.  \n20. On row 2 (the second \u201cWell -A\u201d cell), enter \u201c -20001.0 \u201d in the Qdes (flow)  (ft^3/d)  \ncolumn.  \n21. Click OK to exit the MODFLOW Multi -Node Well Package  dialog.  \n22. Save   the project.  \n23. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n24. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n25. Click Close  to import the solution and clo se the MODFLOW  model wrapper \ndialog.  \n26. Select the \u201c  Head \u201d dataset and select stress period 2 in the Time Step \nWindow . Notice that the head in this cell has changed to about \u201c165.62\u201d.  \n27. Select \u201c  CCF (MNW.ccf)\u201d in the Project Explorer , then right -click on it a nd \nselect CCF \u2192 Datas ets. \n28. Select the \u201c  MNW \u201d dataset and select the second time step in the Time Step \nWindow .  \nNotice that the flow has changed to about \u201c -13809.84\u201d. This change has been caused by \na higher Hlim value, which was in turn brought about by cha nging the sign of the Qdes  \nvalue in the first \u201cWell -A\u201d cell. Less flow could be taken from the model by the well to \nmaintain a higher head value.  \n5 Create a Conceptual Model  \nThe next step is to examine how to use a conceptual model with MNW data. We\u2019ll do th is \nby taking the finished model for the \u201c MODFLOW \u2013 Conceptual Model Approach \u201d tutorial \nand changing it to use the MNW package.  \n5.1 Open the Existing Conceptual Model  \n1. Before opening the conceptual model, Save   the grid -based MNW model.  \n2. Click New  to reset GMS  back to the default settings.  \n3. Click Open   to bring up the Open  dialog.  \n4. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n5. Browse to the mnw \\mnw \\sample  directory and select \u201cmodfmap2.gpr\u201d.  \n6. Click Open  to import the project and exit the Open  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 MNW Package  \n \n Page 15 of 18 \u00a9 Aquaveo 2024  Before making any changes, it is good to save the project under a new name.  \n7. Select File | Save As \u2026 to bring up the Save As  dialog.  \n8. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n9. Browse to the mnw \\mnw  directory.  \n10. Enter \u201c MNWmap. gpr\u201d as the File name . \n11. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n5.2 Examining the Existing Solution  \nBefore changing to the MNW package, look at the flow budget for the existing solution:  \n1. Select MODFLOW  | Flow Budget\u2026  to bring up the Flow Budget  dialog.  \nNotice the flow budget for the well package has a flow out rate of about \u201c -2344.60\u201d.  \n2. Click  OK to exit the Flow Budget  dialog.  \n5.3 Changing the Model to Use MNW  \nTo change to the MNW package, first the WEL package needs to be  removed from \nMODFLOW.  \n1. Select MODFLOW | Global Options\u2026  to open the MODFLOW Global/Basic \nPackage dialog.  \n2. Click Packages \u2026 to bring up the MODFLOW Packages  / Processes  dialog.  \n3. In the Optional packages / processes  section, turn off WEL1 \u2013 Well to disable the \nWEL package.  \n4. Click OK to exit the MODFLOW Packages  / Processes  dialog.  \n5. Click OK to exit the MODFLOW Global/Basic Package dialog.  \n5.4 Changing the Wells to MNW  \n1. Fully expand the \u201c  Map Data\u201d folder.  \n2. Right -click on the \u201c  Sources&Sinks\u201d coverage u nder the \u201c  East Texas \u201d \nconceptual model in the Project Explorer  and select Coverage Setup\u2026  to bring \nup the Coverage Setup  dialog.  \n3. In the Sources/Sinks/BCs  section, turn on Wells (MNW) . \n4. Click OK to exit the Coverage  Setup  dialog.  \n5. Right -click on \u201c  Sources& Sinks \u201d and select Attribute Table\u2026  to bring up the \nAttribute Table  dialog.  \n6. On the All row of the spreadsheet, select \u201cwell (MNW)\u201d from the Type  drop-down \ncolumn.  \n7. Scroll to the right and enter \u201c -50.0\u201d in the Qdes  (m^3/d)  column on row 16. \n8. Enter \u201c -300.0\u201d in the Qdes  (m^3/d)  column on row 17. \n9. Click OK to exit the Attribute Table dialog.  \n\nGMS Tutorials   MODFLOW \u2013 MNW Package  \n \n Page 16 of 18 \u00a9 Aquaveo 2024  The conceptual model is set up so now it can be mapped to the MODFLOW grid.  \n10. Click Map \u2192 MODFLOW   to bring up the Map \u2192 Model  dialog.  \n11. Click OK to accept the defaults and close the Map \u2192 Model  dialog.  \n5.5 Examine the MNW Package  \nThe next step is to review the data in MODFLOW that was mapped from the conceptual \nmodel.  \n1. Select MODFLOW | Optional Packages | MNW1 \u2013 Multi -Node Well\u2026  to bring up \nthe MODFLOW  Multi -Node Well Package  dialog.  \nReview the two MNW boundary conditions that were created.  \n2. Click OK to exit the MODFLOW Multi -Node Well Package  dialog . \n5.6 Saving and Running MODFLOW  \nBefore saving the changes and running MODFLOW, adjust the output control.  \n1. Select MODFLOW | OC \u2013 Output Control\u2026  to bring up the MODFLOW Output \nControl  dialog.  \n2. In the Other output section, turn off *.hff file for transport . \n3. Click OK to exit the MODFLOW Output Control  dialog.  \n4. Save   the project.  \n5. Click Run MODFLOW   to bring up the MODFLOW model wrapper  dialog.  \n6. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n7. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.  \n8. Save   the project with the new solution.  \n5.7 Examining the Solution  \nLook at the flow budget for the new solution:  \n1. Select MODFLOW  | Flow Budget\u2026  to bring up the Flow Budget  dialog.  \nNotice the flow budget for the MNW package has the same approximate flow out rate of \n\u201c-2344.6\u201d.  \n2. Click  OK to exit the Flow Budget  dialog.  \n6 Changing to a Multi -Node Well  \nNow to create a multi -node well from the map data:  \n1. Right -click on \u201c  Sources&Sinks \u201d and select Attribute Table\u2026 to bring up the \nAttribute Table  dialog.  \n2. In row 17 (\u201cwell2\u201d), scroll to the right and enter \u201c1\u201d in the From  layer  column.  \n\nGMS Tutorials   MODFLOW \u2013 MNW Package  \n \n Page 17 of 18 \u00a9 Aquaveo 2024  3. Click OK to exit the Attribute Table  dialog.  \nThe conceptual model can now be mapped to the MODFLOW grid.  \n4. Click Map \u2192 MODFLOW   to bring up the Map \u2192 Model  dialog . \n5. Click OK to accept the defaults and close the Map \u2192 Model  dialog.  \n6.1 Examine the MNW Package  \nNow to look at the data in MODFLOW that was mapped from the conceptual model.  \n1. Select MODFLOW | Optional Packages | MNW1 \u2013 Multi -Node Well\u2026  to bring up \nthe MODFLOW Multi -Node Well Package  dialog.  \nReview the various MNW boundary conditions that w ere created.  \n2. Notice that \u201cwell2\u201d is associated with two MNW boundary conditions and that the \nWell ID  is 1 for each of the boundary conditions.  \n3. Notice also that the Qdes  has only been assigned to one of the \u201cwell2\u201d boundary \nconditions.  \nThe MNW package wi ll calculate the amount of flow that each of the wells will take from \nthe aquifer.  \n4. Click OK to exit the MODFLOW Multi -Node Well Package  dialog . \n6.2 Saving and running MODFLOW  \nNow it is possible to save the changes and run MODFLOW. Before doing so, adjust the \nparameters associated with the solver.  \n1. Select MODFLOW  | PCG \u2013 Pre. Conj. -Gradient Solver\u2026  to bring up the \nMODFLOW PCG Package dialog.  \n2. Enter \u201c100\u201d as the Maximum number of outer iterations  (MXITER ).  \n3. Enter \u201c0.5\u201d as the Relaxation parameter  (RELAX) .  \n4. Click OK to exit the MODFLOW PCG Package  dialog.  \n5. Select File | Save As\u2026  to bring  up the Save As  dialog.  \n6. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n7. Enter \u201c MNWmap2 .gpr\u201d as the File name  \n8. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n9. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n10. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n11. Click Close  to import the  solution and close the MODFLOW  dialog.  \n6.3 Viewing the Flow in the MNW Boundary Conditions  \nView the computed flow out of each of the MNW boundary conditions associated with \nwell2 by doing the following:  \n\nGMS Tutorials   MODFLOW \u2013 MNW Package  \n \n Page 18 of 18 \u00a9 Aquaveo 2024  1. Select \u201c  3D Grid Data\u201d to make it active.  \n2. Zoom   in aro und the well on the right side of the model.  \n3. Using the Select Cell   tool, select the cell containing the well (Cell ID: 1944).  \n4. Select MODFLOW | Flow Budget \u2026 to bring up the Flow Budget  dialog.  \nNotice that the flow out of the well in the top layer is about  \u201c-170.08\u201d. Now to view the flow \nout of the well in the second layer:  \n5. Click OK to exit the Flow Budget  dialog.  \n6. Using the Mini Grid Toolbar , change the Lay (k) to \u201c2\u201d.  \n7. Select the cell containing the well (Cell ID: 5024) using the Select Cell   tool. \n8. Select MODFLOW | Flow Budget \u2026 to bring up the Flow Budget  dialog.  \nNotice that the flow rate for this well is about \u201c -129.92\u201d.  \n9. Click OK to exit the Flow Budget  dialog.  \n10. Save   the project.  \n7 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 MNW Package\u201d tutorial. The followin g key concepts \nwere discussed and demonstrated in this tutorial:  \n\uf0b7 GMS supports both the WEL and MNW packages. Both packages can be used \nat the same time if desired.  \n\uf0b7 The MNW package produces the same results as the WEL when there are no \nmulti -node wells.  \n\uf0b7 MNW  data can be viewed and edited in the MNW package dialog.   \n \n\n", "filename": "MODFLOW-MNWPackage.pdf", "pages": 18}, "MODFLOW-ModelCalibration": {"text": "GMS Tutorials   MODFLOW \u2013 Model Calibration  \n Page 1 of 16 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Model Calibration  \nManually vary input values and use observations to calibrate a \nMODFLOW model  \n \nObjectives   \nGMS contains a suite of tools to assist in the model calibration process, including observation points and \ndifferent types of plots. These tools are described in this tutorial. A MODFLOW model is manually \ncalibrated by adjusting inputs and watching how the computed values compare to the observed values.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach I  \n Required  Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 25\u201340 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 Model Calibration  \n Page 2 of 16 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Description of Problem  ................................ ................................ ................................ . 2 \n1.2 Getting Started  ................................ ................................ ................................ ..............  4 \n2 Importing the Model  ................................ ................................ ................................ ............  4 \n3 Observation Data  ................................ ................................ ................................ .................  5 \n4 Entering Observation Points  ................................ ................................ ..............................  5 \n4.1 Creating a Coverage with Observation Properties  ................................ ........................  5 \n4.2 Creating an Observation Point  ................................ ................................ ......................  6 \n4.3 Calibration Target  ................................ ................................ ................................ .........  6 \n4.4 Point Statistics  ................................ ................................ ................................ ..............  7 \n5 Reading in a Set of Observation Points  ................................ ................................ .............  8 \n5.1 Deleting the Observation Point  ................................ ................................ .....................  8 \n5.2 Importing Points  ................................ ................................ ................................ ............  8 \n5.3 Text Import Wizard  ................................ ................................ ................................ ....... 8 \n6 Entering the Observed Stream Flow  ................................ ................................ ..................  9 \n7 Viewing the Solution  ................................ ................................ ................................ .........  10 \n7.1 Error Summary  ................................ ................................ ................................ ...........  10 \n7.2 Computed vs. Observed Data Plot  ................................ ................................ .............  11 \n8 Editing the Hydraulic Conductivity  ................................ ................................ ..................  12 \n9 Converting the Model  ................................ ................................ ................................ ........  13 \n10 Com puting a Solution  ................................ ................................ ................................ ....... 13 \n10.1  Saving the Simulation  ................................ ................................ ................................ . 13 \n10.2  Running MODFLOW  ................................ ................................ ................................ ... 13 \n11 Error  vs. Simulation Plot  ................................ ................................ ................................ ... 14 \n12 Continuing the Trial -and-Error Calibration  ................................ ................................ ...... 15 \n12.1  Changing Values vs. Changing Zones  ................................ ................................ ........  15 \n12.2  Viewing the Answer  ................................ ................................ ................................ .... 15 \n13 Conclusion  ................................ ................................ ................................ .........................  16 \n \n1 Introduction  \nAn important part of any groundwater modeling exercise is the model calibration process. \nIn order for a groundwater model to be used in any type of predictive role, it must be \ndemonstrated that the model can successfully simulate observed aquifer behavior. \nCalibration is a process wherein certain parameters of the model, such as recharge and \nhydraulic conductivity, are altered in a  systematic fashion and the model is repeatedly run \nuntil the computed solution matches field -observed values within an acceptable level of \naccuracy.  \nThe model calibration exercise in this tutorial is based on the MODFLOW model. Thus, it \nis recommended to complete the \u201c MODFLOW \u2013 Conceptual Model Approach  I\u201d tutorial \nprior to beginning this tutorial. Although this particular exercise is based on MODFLOW, \nthe calibration tools in GMS are designed in a general -purpose fashion and can be used \nwith any model.  \n1.1 Description of Problem  \nA groundwater model for a medium -sized basin is shown in Figure 1. The basin \nencompasses 72.5 square kilometers. It is in a semi -arid climate, wi th average annual \nprecipitation of 0.381 m/yr. Most of this precipitation is lost through evapotranspiration. \nThe recharge that reaches the aquifer eventually drains into a small stream at the center \nof the basin. This stream drains to the north and eventu ally empties into a lake with \nelevation 304.8 meters. Three wells in the basin also extract water from the aquifer. The \nperimeter of the basin is bounded by low -permeability crystalline rock. There are ten \nobservation wells in the basin. There is also a stream flow gauge at the bottom end of the \nstream.  \nGMS Tutorials   MODFLOW \u2013 Model Calibration  \n \n Page 3 of 16 \u00a9 Aquaveo 2024   \n      Figure 1      Sample model used in calibration exercise  \nThe assumed recharge and hydraulic conductivity zones for the model are shown in \nFigure 2. The model region encompasses fractured and weathered bedrock as well as \nalluvial material, grading from hydraulically tighter materials in the south to more \npermeable materials in the north. F urthermore, the materials around the stream tend to \nbe coarser, cleaner, and thus more permeable. The topmost region of the model near the \nlake has a high level of phreatophytic plant life.  \nThe first task of this exercise will be to import a single -layer, unconfined MODFLOW \nmodel that has been constructed for the site. This model contains an initial estimate of \nhydraulic conductivities and recharge. A solution computed with this initial model will then \nbe imported and the error in the initial solution will be analyzed. New values for hydraulic \nconductivity and/or recharge will be entered, a new MODFLOW solution will be \ngenerated, and a new error estimate will be computed and plotted. These steps should \nbe repeated until the error is reasonably small.  \n\nGMS Tutorials   MODFLOW \u2013 Model Calibration  \n \n Page 4 of 16 \u00a9 Aquaveo 2024   \n      Figure 2      Recharge and hydraulic conductivity zones  \n1.2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n3. If asked to save changes, click Don\u2019t Save  to close the dialog and restore GMS \nto a default state.  \n2 Importing the Model  \nFirst, import the model:  \n1. Click Open   to bring up the Open  dialog. \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the calib\\calib directory and select \u201cbigval.gpr\u201d.  \n4. Click Open to import the project and exit the Open  dialog.  \n5. Right -click in the Project Explorer and select Expand All . \nBoth a grid and a conceptual model should appear ( Figure 3). The conceptual model was \nused to construct the MODFLOW model and consists of three coverages. The  currently \nactive coverage contains the model boundary, the specified head boundary, the stream, \nand the wells. There is also a coverage of recharge zones and a coverage of hydraulic \nconductivity zones. For the initial simulation, a single value of hydraul ic conductivity (2.4 \nm/day) and a single value of recharge (7.62e -5 m/day) have been assigned. The \npolygonal zones of hydraulic conductivity and recharge will be edited as the tutorial \nprogresses to reduce the model error.  \n\nGMS Tutorials   MODFLOW \u2013 Model Calibration  \n \n Page 5 of 16 \u00a9 Aquaveo 2024   \n      Figure 3      Initial screen showing the model and three coverages  \n3 Observation Data  \nThe tutorial will be using two types of observation data in the calibration process: water \ntable elevations from observation wells and observed flow rates in the stream. Si nce the \nmodel is in a fairly arid region, assume that most of the flow to the stream is from \ngroundwater flow.  \n4 Entering Observation Points  \nFirst, it is necessary to enter a set of observation points representing the observed head \nin the ten observation wel ls in the region. Observation points are created in the Map \nmodule.  \n4.1 Creating a Coverage with Observation Properties  \nBefore entering observation points, first create a coverage with observation properties.  \n1. Right -click on \u201c  BigVal\u201d in the Project Explorer a nd select New Coverage\u2026  to \nbring up the Coverage Setup  dialog.  \n2. Enter \u201cObservation Wells\u201d as the Coverage name . \n3. In the Observation Points  column, turn on Head . \n4. From the 3D grid layer option for obs. pts.  drop-down , select \u201cBy layer number\u201d.  \n5. Click OK to exit the Coverage Setup  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Model Calibration  \n \n Page 6 of 16 \u00a9 Aquaveo 2024  4.2 Creating an Observation Point  \nIt is now possible to create an observation point. To create the point, do the following:  \n1. Select the \u201c  Observation Wells\u201d coverage to make it active.  \n2. Using the Create Point   tool, click on ce anywhere on the model to create a \nnew point.  \n3. In the XYZS Bar , enter \u201c4470\u201d for X and \u201c9965\u201d for Y (Figure 4). This will move \nthe point to those coordinates.  \n \n      Figure 4      XYZS Bar  \nTo assign the properties to the point:  \n4. With the point still selected, click Properties   to bring up the Attribute Table  \ndialog.  \n5. Enter \u201cPoint #1\u201d in the Name  column of the spreadsheet.  \n6. Select \u201cobs. pt\u201d from the drop -down in the Type  column.  \n7. Enter \u201c305\u201d in the Obs. Head  column.  \n8. Enter \u201c1.5\u201d in the Obs. Head interval  column . \nThis interval represents the estimated error ( \uf0b1) in the observed value. This confidence \nvalue represents the confidence  in the error estimate. The interval can be used as a \ncalibration target. Calibration is achieved when the error is within the estimated error \ninterval ( \uf0b1 1.5 m, in this case) of the observed value. In other words, if the computed \nhead falls between 303.5 and 306.5, the calibration target is reached for this observation \nwell. \n9. Enter \u201c95\u201d in the Obs. Head conf(%)  column.  \n10. Click OK to close the Attribute Table  dialog.  \n4.3 Calibration Target  \nAt this point, a calibration target like the one shown in Figure 5 typically shows up next to \nthe observation point. However, the observation measurement model in this case is \nMODFLOW. With MODFLOW, the simulation must be run,  and the solution imported \nbefore the calibration targets appear. This is because the computed values are output by \nMODFLOW and are not calculated internally by GMS.  \nTo make the calibration targets appear, run MODFLOW and import the solution.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter  \u201crun2.gpr\u201d as the File name  and click Save to exit the Save As  dialog.  \n4. Select the \u201c  3D Grid Data\u201d folder in the Project Explorer to make it active.  \n5. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n6. When MODFLOW finishes running, turn on Read solution on exit  and Turn on \ncontours (if not on already) . \n7. Click Close  to exit th e MODFLOW  model wrapper dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Model Calibration  \n \n Page 7 of 16 \u00a9 Aquaveo 2024  Note that a calibration target is now drawn next to the point ( Figure 5).  \n \n      Figure 5      Green error bar on calibration target  \nThe components of a calibration target are illustrated in Figure 6. The center of the target \ncorresponds to the observed v alue. The top of the target corresponds to the observed \nvalue plus the interval and the bottom corresponds to the observed value minus the \ninterval.  \nThe colored bar represents the error. If the bar lies entirely within the target, the color bar \nis drawn i n green. If the bar is outside the target but the error is less than 200%, the bar \nis drawn in yellow. If the error is greater than 200%, the bar is drawn in red. In this case, \nthe bar should be green.  \n \n \nCalibration Target  Error  Observed + Interval  \nComputed Value  \nObserved Value  \nObserved - Interval  \n \n      Figure 6      Calibration target  \n4.4 Point Statistics  \nMore detailed statistics concerning the error at the point can be viewed by selecting the \npoint.  \n1. Select the \u201c  Map Data\u201d folder in the Project Explorer to make it active . \n2. Using the Select Points \\Nodes   tool, click on the observation point.  \nNotice that a set of statistics related to the point is displayed in the Status Bar at the \nbottom left side of the GMS screen ( Figure 7). \n \n      Figure 7      Status bar showing information on the selected observation point  \n \n\nGMS Tutorials   MODFLOW \u2013 Model Calibration  \n \n Page 8 of 16 \u00a9 Aquaveo 2024  5 Reading in a Set of Observation Points  \nThe next step would be to enter the r emaining nine observation points. In the interest of \ntime, simply import a previously prepared map file containing all ten points.  \n5.1 Deleting the Observation Point  \nBefore importing the map file containing the observation points, delete the point that was \ncreated in the Observation Wells  coverage.  \n1. Using the Select Points \\Nodes   tool, right -click on the point that was created \nearlier and select Delete . \n5.2 Importing Point s \nNow to import a file containing several observation points:  \n1. Click Open  to bring up the Open  dialog.  \n2. Select \u201cText Files (*.txt;*.csv)\u201d from the Files of type  drop-down.  \n3. Select \u201cobswells.txt\u201d and click Open  to exit the Open  dialog and bring up the \nStep 1  of 2 page of the Text Import Wizard  dialog.  \n5.3 Text Import Wizard  \nOpening a TXT file in GMS will bring up the Text Import Wizard . In the first step of the \nwizard, it is necessary to identify the delimiters that separate the data into columns. In the \nsecond s tep of the wizard, map the columns to fields that GMS recognizes.  \n1. In the section below the File import options  section, turn on Heading row . \n2. Click Next >  to go to the Step 2 of 2  page of the Text Import Options  dialog.  \n3. Select \u201cObservation data\u201d from the GMS data type  drop-down.  \nNotice in the file preview section of the dialog that GMS has mapped the different \ncolumns of data in the file into fields recognized by GMS. No changes need to be made \nhere.  \n4. Click Finish  to import the observation data and close the Text Import Wizard  \ndialog.  \nTen observation wells will appear ( Figure 8). \n\nGMS Tutorials   MODFLOW \u2013 Model Calibration  \n \n Page 9 of 16 \u00a9 Aquaveo 2024   \n      Figure 8      The imported observation wells  \n6 Entering the Observed Stream Flow  \nNow that the observation points are defined, the observed flow in the stream can be \nentered. Observed flows are assigned directly to arcs and polygons in the local \nsource/sink coverage of the conceptual model. MODFLOW det ermines the computed \nflow from the aquifer to the stream. This flow value will be compared to the observed \nflow. \nGMS provides two methods for assigning observed flow: to individual arcs or to a group \nof arcs. The stream flow that was measured at the site r epresents the total flow from the \naquifer to the stream at the stream outlet at the top of the model. This flow represents the \nflow from the aquifer to the stream for the entire stream network. Thus, the observed flow \ncan be assigned to a group of arcs. Wh en reading a solution, GMS will then automatically \nsum the computed flow for all arcs in the group.  \nBefore assigning the observed flow, first create an arc group:  \n1. Right -click on the \u201c  Sources & Sinks\u201d coverage and select Coverage Setup\u2026  \nto open the Coverage Setup dialog.  \n2. In the Sources/Sinks/BCs  column, turn on Observed Flow . \n3. Click OK to exit the Coverage Setup  dialog.  \n4. Select \u201c  Sources & Sinks\u201d to make it active.  \n5. Using the Select Arcs   tool while holding down the Shift key, click on each of \nthe riv er arcs. Be sure to select all six arcs.  \n6. Select Feature Objects | Create Arc Group . \n\nGMS Tutorials   MODFLOW \u2013 Model Calibration  \n \n Page 10 of 16 \u00a9 Aquaveo 2024  This creates a new object out of the selected objects. It is now possible to assign an \nobserved flow to the arc group.  \n7. Using the Select Arc Groups   tool, double -click on a ny of the river arcs to \nopen the Attribute Table dialog.  \n8. Check the box in the Obs. flow  column of the spreadsheet.  \n9. Enter \u201c -4644\u201d in the Obs. flow rate (m^3/d)  column.  \n10. Enter \u201c210\u201d in the Obs. flow interval  column . \nThe entered values indicate that, to achieve calibration, the computed flow should be \nbetween -4434 and -4854 m3/day (4644 +/ - 210).  \n11. Click OK to exit the Attribute Table  dialog.  \n12. Click outside the arc group to deselect it.  \n13. Save   the project.  \n14. Select MODFLOW  | Run MODFLOW  to bring up the MODFLO W model wrapper \ndialog.  \n15. When the model finishes running, turn on Read solution on exit  and Turn on \ncontours (if not on already) . \n16. Click Close  to exit the MODFLOW  model wrapper dialog.  \nAt this point, a calibration target should appear for the observed flow o n the arc group \n(Figure 9). \n \n      Figure 9      Calibration target for the river arc group observed flow  \n7 Viewing the Solution  \nThe contours currently shown on the 3D grid are the heads from the MODFLOW run with \nthe optimum parameter values.  \n7.1 Error Summary  \nNow look at the observation targets in the map model and the error associated with this \nmodel run.  \n1. Select the \u201c  Sources & Sinks\u201d  coverage to make it active . \n\nGMS Tutorials   MODFLOW \u2013 Model Calibration  \n \n Page 11 of 16 \u00a9 Aquaveo 2024  2. Using the Select Arc Groups   tool, select the arc group by clicking on the \nriver arc.  \nNotice that the computed and observed flow is reported in the status bar at the bottom of \nthe Graphics Window.  \n3. Right -click on the \u201c  run2 (MODFLOW)\u201d  solution in the Project Explorer and \nselect Properties\u2026  to open the Properties dialog.  \nThis dialog shows a spreadsheet giving the error from this model run. The spreadsheet \nshows the error from the head observations, the flow observations, and the combined \nweighted observations.  \n4. When finished viewing the properties, click OK to close the Properties  dialog . \n7.2 Computed vs. Observed Data Plot  \nNext, generate some plots related to the calibration error. Create two plots related to the  \nerror at the observation points.  \n1. Click Plot Wizard   to open the Step 1 of 2  page of the Plot Wizard dialog.  \n2. Select \u201cComputed vs. Observed Data\u201d  from the list on the left . \n3. Click Next >  to go to the Step 2 of 2  page of the Plot Wizard  dialog.  \n4. Click Finish  to close the Plot Wizard  dialog.  \nIn the first plot, a symbol is drawn for each of the observation points (       Figure  10). A \npoint that plots on or ne ar the diagonal line indicates a low error. Points far from the \ndiagonal have a larger error.  \n \n      Figure 10      Ten observation points plotted  \n\nGMS Tutorials   MODFLOW \u2013 Model Calibration  \n \n Page 12 of 16 \u00a9 Aquaveo 2024  8 Editing the Hydraulic Conductivity  \nThe next step in the calibration exercise is to change the model parameters and re -run \nthe model. Note that the errors are currently mostly red and negative on the \u201cObservation \nWells\u201d coverage. This indicates the observed value is much larger than the current \ncomputed value. Begin with changing the hydr aulic conductivity in these zones. Then edit \nthe hydraulic conductivity by changing the hydraulic conductivity assigned to the \npolygonal zones in the conceptual model.  \nBefore editing the hydraulic conductivity values, make the hydraulic conductivity zone \ncoverage the active coverage.  \n1. Select the \u201c  Hydraulic Conductivity\u201d coverage to make it active.  \nTo edit the hydraulic conductivity values:  \n2. Using the Select Polygons   tool while holding the Shift key, select polygons 1 \nand 2 as shown in Figure 11. \n3. Click Properties   to open the Attribute Table dialog.  \n4. On the All row, enter \u201c0.6\u201d  in the Horizontal K (m/d)  column. This changes the \nvalue for both polygons at the same time.  \n5. Click OK to close the Attribute Table  dialog.  \n6. Double -click on polygon 3 as shown in Figure 11 to open the Attribute Table \ndialog.  \n7. Enter \u201c0.15\u201d in the Horizontal K (m/d)  column.  \n8. Click OK to close the Attribute Table  dialog.  \n9. Click outside the model to deselect the polygon.  \n \n      Figure 11      Polygons to be sele cted \n32\n1\nGMS Tutorials   MODFLOW \u2013 Model Calibration  \n \n Page 13 of 16 \u00a9 Aquaveo 2024  9 Converting the Model  \nNow that the values have been edited, the next step is to convert the conceptual model to \nthe grid -based numerical model:  \n1. Click  Map \u2192 MODFLOW   to bring up the Map \u2192 Model  dialog.  \n2. Select All applicable coverages  and click OK to close the Map \u2192 Model  dialog.  \n10 Computing a Solution  \nThe next step is to save the MODFLOW model with the new values and compute a new \nsolution.  \n10.1 Saving the Simulation  \nTo save the simulation:  \n1. Select File | Save As\u2026  to bring up the Save As  dialog . \n2. Select \u201cP roject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter  \u201crun3.gpr\u201d  as the File name . \n4. Click Save  to close the Save As  dialog .  \n10.2 Running MODFLOW  \nDo the following to run MODFLOW:  \n1. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n2. When the MODFLOW simulation is completed, turn on Read solution on exit  and \nTurn on contours (if not on already) . \n3. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.  \nNote that the plot in the Plot Window  has been updated ( Figure 12). Although the error \nimproved for the observation wells, the head is still too low on the left and right sides of \nthe model. Up to this point, the tutorial has not paid much attention to the flow target on \nthe arc group. In the next section, create a plot that shows how well the flow target is \nbeing met.  \n\nGMS Tutorials   MODFLOW \u2013 Model Calibration  \n \n Page 14 of 16 \u00a9 Aquaveo 2024   \n      Figure 12      Notice how several of the points are closer to th e line  \n11 Error vs. Simulation Plot  \nWhen performing trial -and-error calibration, it is important to keep track of the trend in the \nerror as new solutions are repeatedly computed. GMS provides a special calibration plot \nto simplify this task.  \n1. Click Plot Wizard   to bring up the Step 1 of 2  page of the Plot Wizard  dialog.  \n2. Select \u201cError vs. Simulation\u201d from the list on the left.  \n3. Click Next >  to go to the Step 2 of 2  page of the Plot Wizard  dialog.  \n4. Click Finish  to close the Plot Wizard  dialog.  \nThe change in each of the three error norms from one solution to the next is clearly \nvisible in the new plot ( Figure 13). The plot is updated as each new solution is imp orted. \nIdeally, the error should gradually become smaller and smaller as changes are made to \nthe model. If a bad choice is made in changing the model, the error may temporarily \nincrease. In most cases, it is a good idea to keep a log of the changes made an d the \nresulting errors.  \n5. When finished viewing the plot, close   the Plot dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Model Calibration  \n \n Page 15 of 16 \u00a9 Aquaveo 2024   \nFigure 13      The change in error is more clearly visible  \n12 Continuing the Trial -and-Error Calibration  \nAt this point, continue with the trial -and-error calibration process using the steps outlined \nabove. If changing the recharge and the hydraulic conductivity values, be sure to make \nthe coverage visible by selecting it in the Project Explorer . \n12.1 Changing Values vs. Changing Zones  \nFor this tutorial, a go od match between the computed and observed values can be \nobtained simply by changing the hydraulic conductivity and recharge values assigned to \nthe polygonal zones. In a real application, however, the size and distribution of the zones \nmay need to be chang ed in addition to the values assigned to the zones.  \n12.2 Viewing the Answer  \nTo view the \u201canswer,\u201d a map file can be imported that contains a set of parameter values \nthat result in a solution that satisfies the calibration target for each of the ten observation \nwells.  \nBefore importing the new conceptual model, delete the \u201cBigVal\u201d conceptual model:  \n1. Right -click on the \u201c  BigVal\u201d conceptual model and select Delete . \nTo import the new conceptual model:  \n2. Click Open   to bring up the Open  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Model Calibration  \n \n Page 16 of 16 \u00a9 Aquaveo 2024  3. Select \u201cMap Files (*.map)\u201d from the Files of type  drop-down.  \n4. Select \u201canswer.map\u201d.  \n5. Click Open  to import the project and close the Open  dialog.  \nThis model can now be converted to the grid, and a new solution can be computed using \nthe steps described above.  \n13 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 Model Calibration\u201d tutorial. The following key topics \nwere discussed and demonstrated:  \n\uf0b7 Observation points will display a target next to them that shows how well the \ncomputed values match the observed values.  \n\uf0b7 With MOD FLOW, the computed values at the observation points come from \nMODFLOW and not GMS. Thus, if creating an observation point, MODFLOW will \nhave to be run before seeing a target.  \n\uf0b7 If wanting to specify a flow observation that applies to a network of streams, \ncreate an arc group.  \n\uf0b7 A number of different plots are available when doing model calibration.  \n\uf0b7 It is possible to import data from another GMS project by turning on Import into \ncurrent project  in the Open  dialog after selecting the desired project.  \n\uf0b7 Whenever cha nges are made to the conceptual model, the Feature Objects | \nMap \u2192 MODFLOW  command must be used, and the project must be saved \nbefore running MODFLOW.  \n \n \n", "filename": "MODFLOW-ModelCalibration.pdf", "pages": 16}, "MODFLOW-NWT": {"text": "GMS Tutorials   MODFLOW \u2013NWT  \n Page 1 of 12 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 NWT \nUse MODFLOW -NWT with a Simple Model  \n \nObjectives   \nThis tutorial introduces GMS and covers the basic elements of the user interface. It is the first tutorial that \nnew users should complete.  \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Grid \nApproach  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 25\u201340 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013NWT  \n Page 2 of 12 \u00a9 Aquaveo 2024  1 Introduction and Description  ................................ ................................ ..............................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  3 \n2 Import the MODFLOW 2000 Model  ................................ ................................ .....................  3 \n2.1 Save the MODFLOW -NWT LPF Project  ................................ ................................ ....... 4 \n2.2 Save the MODFLOW \u2013NWT LPF Project  ................................ ................................ ...... 4 \n2.3 Run the Model  ................................ ................................ ................................ ..............  5 \n3 Switch to the UPW and NWT Packages  ................................ ................................ .............  5 \n3.1 Save the MODFLOW -NWT UPW Project  ................................ ................................ ..... 5 \n3.2 Run the Model and Compare Solutions  ................................ ................................ ........  5 \n4 Switch back to MODFLOW -NWT LPF Model  ................................ ................................ ..... 6 \n4.1 Increase Pumping to Create a Dry Well  ................................ ................................ ........  6 \n4.2 Run the Model  ................................ ................................ ................................ ..............  7 \n4.3 HDRY  ................................ ................................ ................................ ...........................  8 \n5 Switch back to UPW  ................................ ................................ ................................ ............  9 \n5.1 Specify PHIRAMP  ................................ ................................ ................................ ....... 10 \n5.2 Save  the MODFLOW -NWT UPW Dry Cell Project  ................................ .....................  10 \n5.3 Run the Model  ................................ ................................ ................................ ............  10 \n5.4 Examine the Well  ................................ ................................ ................................ ........  11 \n5.5 Save and Run the Model  ................................ ................................ ............................  12 \n5.6 Reduced Pumping Rates  ................................ ................................ ............................  12 \n6 Conclusion  ................................ ................................ ................................ .........................  12 \n \n1 Introduction and Description  \nMODFLOW \u2013NWT uses a Newton method which can handle cell drying and rewetting \nsituations better than previous versions of MODFLOW. For some model scenarios, using \nMODFLOW \u2013NWT can help to achieve convergence. GMS includes an interface to \nMODFLOW \u2013NWT and the UPW and NWT packages included with MODFLOW \u2013NWT.  \nThis tutorial builds on the \u201cMODFLOW \u2013 Grid Approach\u201d tutorial. The purpose of this \ntutorial is to simply de monstrate the MODFLOW \u2013NWT interface in GMS rather than to go \nin-depth on every feature.  \nThe problem to be solved in this tutorial is the same as the one in the \u201cMODFLOW \u2013 Grid \nApproach\u201d tutorial and is shown in Figure 1. This problem is a modified version of the \nsample problem described near the end of the MODFLOW Reference Manual . Three \naquifers will be simulated using three layers in the computational grid.  \nThe grid covers a square region measuring 75000 feet by 75000 feet. The grid consists \nof 15 rows and 15 columns, each cell measuring 5000 feet by 5000 feet in plan view. For \nsimplicity, the elevation of the top and bottom of each layer is flat. The hydraulic \nconductivity values shown are for the horizontal direction. For the vertical direction, \nvertical anisotropy (KH/KV) factors of 10, 5, and 5 are used for layers 1, 2, and 3, \nrespectively.  \nFlow into the system is due to infiltration from precipitat ion and will be defined as \nrecharge in the input. Flow out of the system is due to buried drain tubes, discharging \nwells (not shown in Figure 1), and a  lake which is represented by a constant head \nboundary on the left. Starting heads are set equal to zero, and a steady -state solution is \ncomputed.  \nGMS Tutorials   MODFLOW \u2013NWT  \n \n Page 3 of 12 \u00a9 Aquaveo 2024  \n \nUnconfined  \nConfined  \nConfined  Const Head = 0 m  \nin column 1 of  \nlayers 1 & 2  Drain  \nLayer 1 : K = 15 m/d, top elev. = 60 m, bot elev. = -45 m \nLayer 2 : K = 0.9 m/d, top elev. = -45 m, bot elev. = -120 m \nLayer 3 : K = 2 m/d, top elev. = -120 m, bot elev. = -215 m Recharge = 0.0009 m/d   \n      Figure 1      Sample problem to be solved  \nThis tutorial will discuss and demonstrate:  \n\uf0b7 Importing an existing MODFLOW 2000 model.  \n\uf0b7 Switching to MODFLOW \u2013NWT while continuing to use the LPF and PCG \npackages, and comparing the results.  \n\uf0b7 Switching to the UPW and NWT packages, and comparing the results.  \n\uf0b7 Switching back to MODFLOW 2000, and increasing the pumping rate, causing a \nwell to go dry.  \n\uf0b7 Switching back to MODFLOW \u2013NWT, and comparing how it handles dry cells.  \n\uf0b7 Examining how IPHDRY  affects the head solution.  \n1.1 Getting Started  \nDo the following to get starte d: \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state. Click Don\u2019t Save  if asked to save changes.  \n2 Import the MODFLOW 2000 Model  \nTo import an existing model:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the nwt\\nwt folder and select \u201cmodfgrid.gpr\u201d.  \n4. Click Open to import the file and close the Open  dialog.  \nA MODFLOW model with color contours of the head solution will be visible ( Figure 2). \n\nGMS Tutorials   MODFLOW \u2013NWT  \n \n Page 4 of 12 \u00a9 Aquaveo 2024   \n      Figure 2      Initial view with contours and head solution visible  \n2.1 Save the MODFLOW -NWT LPF Project  \nThe next step is to switch the model to use MODFLOW \u2013NWT.  \n1. Select MODFLOW | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage dialog.  \n2. In the MODFLOW version  section, select NWT . \n3. Click Packages \u2026 to bring up the MODFLOW Packages / Processes dialog.  \nNotice that LPF \u2013 Layer Property Flow  is selected in the Flow package  section and SIP1  \n\u2013 Strongly Impl. Proc.  is selected in the Solver  section. These will be left unchanged for \nnow.  \n4. Click OK to exit the MODFLOW Package s / Processes  dialog.  \n5. Click OK to exit the MODFLOW Global/Basic Package dialog.  \n6. If necessary, click No to the pop -up asking to switch to the NWT Solver. That \nfeature will be explored later.  \n2.2 Save the MODFLOW \u2013NWT LPF Project  \nBefore continuing, it is importan t to save the project with a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter  \u201cnwt_lpf.gpr \u201d as the File name  and click Save  to close the Save As  dialog.  \nIt is recommended  to save the project periodically using Save . \n\nGMS Tutorials   MODFLOW \u2013NWT  \n \n Page 5 of 12 \u00a9 Aquaveo 2024  2.3  Run the Model  \nIt is now possible to run the model.  \n1. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n2. Once MODFLOW has finished, turn on Read solution on exit  and Turn on \ncontours (if not on already) . \n3. Click Close  to import the solution and exit the MODFLOW  model wrapper dialog.  \nGMS imports the solution and contours the head dataset. Notice the head contours are \nexactly the same as they were before. Because this tutorial is still using the LPF and \nSIP1 packages, switching to MODFLOW \u2013NWT hasn't changed anything.  \n3 Switch to the UPW and NWT Packages  \nNow to switch to the UPW and NWT packages:  \n1. Select MODFLOW | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage dialog.  \n2. Click on Packages\u2026  to bring up the MODFLOW Packages / Processes  dialog.  \n3. In the Flow package section, s elect UPW \u2013 Upstream . \nNotice the Solver  section automatically switches to NWT \u2013 Newton.  These two packages \ngo together and if one is used, the other must be used also.  \n4. Click OK to exit the MODFLOW Packages / Processes  dialog.  \n5. Click OK to exit the MODFLOW Global/Basic Package dialog.  \n3.1 Save the MODFLOW -NWT UPW Project  \nThe next step is to save the project with a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter  \u201cnwt_upw.gpr\u201d as the File name  and click Save  to close the Save As  \ndialog.  \n3.2 Run the Model and Compare Solutions  \nIt is now possible to run the model.  \n1. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n2. Once MODFLOW has finished, turn on Read solution on exit  and Turn on \ncontours (if not on already) . \n3. Click Close  to import the solution and exit the MODFLOW  model wrapper dialog.  \nGMS imports the solution and contours the head data set. Notice the head contours are \nslightly different. The UPW and NWT packages give almost the same answer as the LPF \nand SIP1 packages when there are no cell wetting and drying conditions.  \n4. Compare the solution generated with the LPF package and the one ge nerated \nwith the UPW package by clicking back and forth on the two solutions (\u201c  \n\nGMS Tutorials   MODFLOW \u2013NWT  \n \n Page 6 of 12 \u00a9 Aquaveo 2024  nwt_lpf (MODFLOW)\u201d and \u201c  nwt_upw (MODFLOW)\u201d) in the Project Explorer \n(red arrows in Figure 3). It may be necessary to expand the \u201c  3D Grid Data\u201d \nfolder and \u201c  grid\u201d item.  \n \n      Figure 3      Project Explorer showing both solutions  \n \n4 Switch back to MODFLOW -NWT LPF Model  \nThe next step is to go back and load the MODFLOW \u2013NWT model that used the LPF \npackage.  \n1. Click New  to clear the current project. If prompted to save these changes, \nselect Don\u2019t Save . \n2. Select the directory that ends in \u201cnwt_lpf.gpr\u201d from the list of recent files at the \nbottom of the File menu ( Figure 4). \n \n      Figure 4      Reopen the nwt_lpf.gpr model  \n4.1 Increase Pumping to Create a Dry Well  \nNow to increase the pumping rate of one of the wells in order to cause the cells to go dry:  \n1. In the Mini-Grid Toolbar , click on the up arrow to change the view to Lay (k) \n(layer) \u201c2\u201d ( Figure 5). \n\nGMS Tutorials   MODFLOW \u2013NWT  \n \n Page 7 of 12 \u00a9 Aquaveo 2024   \n      Figure 5      Switching to layer 2  \n2. Using the Select Cells   tool, right -click on the well cell in the upper left ( IJK \ncoordinates of \u201c4, 6, 2\u201d, Figure 6) and select Sources/Sinks\u2026  to bring up the \nMODFLOW Source s/Sinks  dialog.  \n \n      Figure 6      The well cell to select  \n3. Select \u201cWells (WEL)\u201d from the list on the left.  \n4. Enter \u201c -190000\u201d in the Q (flow) (m^3/d)  column of the numbered row in the \nspreadsheet on the right.  \n5. Click OK to close the MODFLOW Sources/Sinks  dialog.  \n4.2 Run the Model  \nNow it is time to save these changes and run the model.  \n1. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog. \nWhen prompted to save changes, click Yes. \n2. Once MODFLOW has finished, turn on  Read solution on exit  and Turn on \ncontours (if not on already) . \n3. Click Close  to import the solution and exit the MODFLOW  model wrapper dialog.  \nGMS reads the solution and contours the head dataset. Notice the cell with the well has \ngone dry. A triangle symbol appears in the cell to indicate the cell is dry ( Figure 7). \n\nGMS Tutorials   MODFLOW \u2013NWT  \n \n Page 8 of 12 \u00a9 Aquaveo 2024   \n      Figure 7      Dry cell symbol indicating the well went dry  \n4.3 HDRY  \nThe LPF package will assign a key value, the HDRY value, to any cells which go dry. The \nnext step is to look at the HDRY value.  \n1. Select MODFLOW | LPF \u2013 Layer Property Flow\u2026  to bring up the LPF Package  \ndialog.  \n2. Click More LPF Options\u2026  in the upper -right to bring up the LPF Package \nOptions dialog.  \n3. Notice the value of Head assigned to dry cells (HDRY)  is \u201c-888.0\u201d. Click OK to \nexit the LPF Package Options dialog.  \n4. Click OK to exit the LPF Package dialog.  \nThe next step is to look at the he ad solution.  \n5. Right -click on the \u201c  Head\u201d dataset under the \u201c  nwt_lpf (MODFLOW)\u201d \nsolution in the Project Explorer and select View Values\u2026  to bring up the Edit \nDataset Values  dialog. It may be necessary to expand the \u201c  3D Grid Data\u201d \nfolder, the \u201c  grid\u201d it em, and the \u201c  nwt_lpf (MODFLOW)\u201d solution.  \n6. Scroll down to row 51 and notice the \u201c -888.0\u201d value in the f column for that cell. \nAlso notice the \u201c0\u201d in the Active  column ( Figure 8). \nThe \u201c0\u201d in the Active  column indicates that the cell is inactive. GMS doesn\u2019t display \ncontours for it because there is no data for that cell.  \n\nGMS Tutorials   MODFLOW \u2013NWT  \n \n Page 9 of 12 \u00a9 Aquaveo 2024   \n \n      Figure 8      HDRY value in head solution  \n7. Click OK to exit the  Edit Dataset Values dialog.  \n5 Switch back to UPW  \nNow it is possible to see how MODFLOW \u2013NWT and the UPW package handle the dry \ncell. \n1. Select MODFLOW | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage dialog.  \n\nGMS Tutorials   MODFLOW \u2013NWT  \n \n Page 10 of 12 \u00a9 Aquaveo 2024  2. Click Packages\u2026  to bring up the MODFLOW Packages / Processes  dialog.  \n3. Select UPW \u2013 Upstream Weighting  in the Flow package  section.  \n4. Click OK to exit the MODFLOW Packages / Processes  dialog.  \n5. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n5.1 Specify PHIRAMP  \nMODFLOW \u2013NWT has a unique feature that will reduce the pumping rate in cells as the \nhead drops below a user -specified percentage of cell thickness. The MODFLOW \u2013NWT \ndocumentation describes this feature as follows:  \nNegative pumping rates specified in the Well Package are reduc ed to zero when \nthe groundwater head drops to the cell bottom using a cubic formula and its \nderivative. This option is only available for unconfined (convertible) layers.1  \nThe user -specified percentage of cell thickness is the variable PHIRAMP in the WEL \npackage.  \n1. Select MODFLOW  | Optional Packages  | WEL \u2013 Well\u2026  to bring up the \nMODFLOW Well Package  dialog.  \n2. At the bottom -right side of the dialog, turn on Specify PHIRAMP . \nThe default value is \u201c0.25\u201d. When the head in the cell drops below 25% of the cell \nthickness, the pumping rate will be reduced by MODFLOW \u2013NWT.  \n3. Select OK to accept the default and exit the MODFLOW Well Package  dialog.  \n5.2 Save the MODFLOW -NWT UPW Dry Cell Project  \nThe project should now be saved with a new name.  \n1. Select File | Save As\u2026  to bring up t he Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter  \u201cnwt_upw.gpr\u201d as the File name  and click Save  to close the Save As  \ndialog.  \n4. Select Yes when prompted to replace the existing file.  \n5.3 Run the Model  \nNow to run MODFLOW:  \n5. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n6. Once MODFLOW has finished, turn on Read solution on exit  and Turn on \ncontours (if not on already) . \n7. Click Close  to import the solution and exit the MODFLOW  model wrapper dialog.  \nNotice the UP W solution ( Figure 9) varies greatly from the one generated using the LPF \npackage. The heads in the UPW solution are much lower because, with the LPF \n                                                      \n1 Niswonger, Richa rd G.; Panday, Sora; and Ibaraki, Motomu, 2011. \u201cMODFLOW -NWT: A Newton \nFormulation for MODFLOW -2005\u201d from U.S. Geological Survey Techniques and Methods 6 \u2013A37, \np.14. http://pubs.usgs.gov/tm/tm6a3 7/pdf/tm6a37.pdf  .  \n\nGMS Tutorials   MODFLOW \u2013NWT  \n \n Page 11 of 12 \u00a9 Aquaveo 2024  package, as soon as the cell went dry, the pumping stopped. In the UPW package, the \npumping continued but at a reduced rate (as the tutorial will show).  \n \n      Figure 9      UPW package showing slower pump rate once well was low  \n5.4 Examine the Well  \nNotice the cell with the well no longer appears dry, but it is clear that there is \nconsiderable drawdown around the well.  \n1. Using the Select Cells   tool, click on the well cell ( IJK coordinates \u201c4,6,2\u201d).  \nNotice the S value in the GMS XYZF Bar is about \u201c -104\u201d ( Figure 10). \n \nFigure 10      Head in cell (4,6,2)  \n2. Right -click on the well cell and select Propertie s\u2026 to bring up the 3D Grid Cell \nProperties  dialog.  \nNotice the Top elevation  of this cell is \u201c -45\u201d and the Bottom elevation  is \u201c-120\u201d, so the \nhead is just above the bottom elevation.  \n3. Click OK to exit the 3D Grid Cell Properties dialog.  \n4. In the Mini-Grid Tool bar, click on the down arrow to change the view to Lay (k)  \n(layer) \u201c1\u201d.  \n5. Click on the cell in layer 1 that is directly above the well in layer 2 (the cell with \nIJK (4,6,1)).  \nNotice the head in the cell is about \u201c -94\u201d according to the GMS XYZF Bar . Although the \nhead in the cell above the well is below the bottom of the first layer, the cell is still \ncontoured and is showing the dry cell symbol. The following steps show why.  \n6. Select MODFLOW | UPW \u2013 Upstream Weighting\u2026  to bring up the UPW \nPackage  dialog.  \n7. Click More UPW Options\u2026  to bring up the UPW Package Options  dialog.  \nBy default, the UPW package does not assign the HDRY  value to cells that go dry. The \nIPHDRY  variable may be turned on by doing the following:  \n\nGMS Tutorials   MODFLOW \u2013NWT  \n \n Page 12 of 12 \u00a9 Aquaveo 2024  8. Turn on Set head to HDRY (IPHDRY) . \n9. Click OK to exit the UPW Package Options  dialog.  \n10. Click OK to exit the UPW Package  dialog.  \n5.5 Save and Run the Model  \nNow to run MODFLOW again:  \n1. Select MODFLOW  | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog. Click Yes if asked to save.  \n2. Once MODFLOW has finis hed, turn on Read solution on exit  and Turn on \ncontours (if not on already) . \n3. Click Close  to import the solution and exit the MODFLOW  model wrapper dialog.  \nNotice that the dry cell symbol now appears in the cell above the well.  \n5.6 Reduced Pumping Rates  \nMODFLOW \u2013NWT reduced the pumping rate of the well as the water table got close to \nthe bottom of the cell.  \n4. In the Project Explorer , double -click on the \u201c nwt_upw.out \u201d item.  \n5. If prompted to pick the viewer in a View Data File dialog, click OK to accept the \ndefault or pick another one.  \n6. In the selected text editor, use Ctrl-F to search for the word \u201creduced\u201d until you \nlocate the lines shown in Figure 11. \n \n      Figure 11      Reduced pumping rate as shown in the .out file  \nOnce done reviewing this data and any other data within the file, close the text editor.  \n6 Conclusion  \nThis concludes the \u201cMODFLOW \u2013NWT\u201d tutorial. The following topics were discussed  and \ndemonstrated:  \n\uf0b7 GMS includes an interface to MODFLOW \u2013NWT and the UPW and NWT \npackages.  \n\uf0b7 MODFLOW \u2013NWT can be used with either the LPF or UPW flow packages. The \nUPW package typically produces very similar results to the LPF package if there \nis no cell dryin g or rewetting taking place.  \n\uf0b7 The UPW package does not assign the HDRY  value to dry cells unless the \nIPHDRY  option is turned on.  \n\uf0b7 MODFLOW \u2013NWT will reduce the pumping rate in a well as the water table \napproaches the bottom of the cell.  \n \n\n", "filename": "MODFLOW-NWT.pdf", "pages": 12}, "MODFLOW-PestPilotPoints": {"text": "GMS Tutorials   MODFLOW \u2013 PEST Pilot Points  \n Page 1 of 12 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODLFOW \u2013 PEST Pilot Points  \nUse pilot points with PEST to automatically calibrate a MODFLOW \nmodel  \n \nObjectives   \nThis tutorial demonstrates the features and options related to pilot points when used with PEST. It will \nreview using fixed -value pilot points, regularization, and multiple parameters.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Automated \nParameter Estimation  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 Subsurface  \n\uf0b7 Geostatistics  \n\uf0b7 MODFLOW Interface  \n\uf0b7 PEST  \n Time  \n\uf0b7 15\u201325 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 PEST Pilot Points  \n Page 2 of 12 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  3 \n2 Importing the Project  ................................ ................................ ................................ ...........  3 \n3 Creating Pilot Points  ................................ ................................ ................................ ...........  4 \n4 Editing the HK Parameter  ................................ ................................ ................................ ... 6 \n4.1 Editing the Parameters  ................................ ................................ ................................ . 6 \n4.2 Limiting the Number of Parameter Estimation Runs  ................................ .....................  7 \n5 Saving the Project and Running PEST  ................................ ................................ ..............  7 \n5.1 Viewing the Solution  ................................ ................................ ................................ ..... 8 \n5.2 Viewing the Final Hydraulic Conductivity  ................................ ................................ ...... 9 \n6 Adding Fixed Value Pilot Points  ................................ ................................ .......................  10 \n6.1 Saving the Project and Running PEST  ................................ ................................ ....... 11 \n7 Conclusion  ................................ ................................ ................................ .........................  12 \n \n1 Introduction  \nPilot points can be thought of as a 2D scatter point set. Instead of creating a zone and \nhaving the inverse model estimate one value for the entire zone, the value of the \nparameter within the zone is interpolated from the pilot points. The inverse model then \nestimates the values at the pilot points. Using pilot points will vary values from cell to cell. \nWhen the inverse model runs, the values at the pilot points are adjusted  and re -\ninterpolated to the grid cells until the objective function is minimized.  \nPEST provides an option for the pilot point method called regularization. Regularization \nimposes an additional measure of constraint to the parameter being interpolated. This  \nconstraint is imposed by providing PEST with additional information about the parameter \nin the form of prior information equations.  This constraint makes the inversion process \nmore stable and makes it possible to violate one of the typical constraints ass ociated with \nparameter estimation: namely, the requirement that the number of parameters be less \nthan the number of observations.  \nWith regularization, the number of parameters can greatly exceed the number of \nobservations. As a result, complex hydraulic c onductivity distributions can be defined, \nresulting in extremely low residual error. The pilot point method with regularization is an \nincredibly powerful feature of PEST.  \nThere are two methods available in GMS for defining the prior information equations for \nPEST. The two methods can be used simultaneously but are usually used separately. \nThe first method is Preferred homogeneous regularization . When this option is selected , \nthe prior information equations written to the PEST control file relate the pilot points to \none another. These equations indicate to PEST that \u2014in the absence of any strong \ninfluence from the PEST objective function \u2014pilot points that are near to one anoth er \nshould have about the same value.  \nThe second method of regularization is Preferred value regularization . When this option \nis selected, prior information equations written to the PEST control file relate the pilot \npoints to their starting value. These eq uations indicate to PEST that \u2014in the absence of \nany strong influence from the PEST objective function \u2014the pilot point values should be \nequal to their starting value. Depending on the particular problem being solved, one \nmethod may be preferable over the ot her. \nThe model to be calibrated in this tutorial is the same model featured in the \u201c MODFLOW  \n\u2013 Model Calibration \u201d tutorial. The model includes observed flow data for the stream and \nobserved heads at a set of scattered observation wells. The conceptual model  for the site \nconsists of a set of recharge and hydraulic conductivity zones. These zones will be \nmarked as parameters and an inverse model will be used to find a set of recharge and \nhydraulic conductivity values that minimize the calibration error.  \nGMS Tutorials   MODFLOW \u2013 PEST Pilot Points  \n \n Page 3 of 12 \u00a9 Aquaveo 2024  This t utorial will discuss and demonstrate the following:  \n\uf0b7 Opening a MODFLOW model and solution.  \n\uf0b7 Creating pilot points and running PEST.  \n\uf0b7 Loading optimal parameter values and viewing the resulting HK field.  \n\uf0b7 Including pilot points with fixed values and running PEST . \n\uf0b7 Changing regularization options and running PEST.  \n\uf0b7 Using pilot points on different zones and different parameter types.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state. Click Don\u2019t Save if asked to save changes.  \n2 Importing the Project  \nFirst, import the modeling project:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the  Files of type  drop-down.  \n3. Browse to the pilotpoints \\pilotpoints  directory and select \u201cstart.gpr\u201d.  \n4. Click Open  to import the project and exit the Open  dialog.  \nThe initial MODFLOW model should appear similar to Figure 1. \n5. Right -click in the Project Explorer and select Expand All .  \nA MODFLOW model with a solution and a set of map coverages should be visible. Three \nof the coverages are the source/sink, rechar ge, and hydraulic conductivity coverages \nused to define the conceptual model. The active coverage contains a set of observed \nhead values from observation wells. In the source/sink coverage, an observed flow value \nhas been assigned to the stream network.  \n\nGMS Tutorials   MODFLOW \u2013 PEST Pilot Points  \n \n Page 4 of 12 \u00a9 Aquaveo 2024   \n      Figure 1      The initial MODFLOW model  \nThis model has already been parameterized, so just create the pilot points and then run \nPEST.  \n3 Creating Pilot Points  \nThe pilot points that define the hydraulic conductivity distribution for the model should \nnow be created. The pilot points are defined as 2D scatter point sets in GMS. It should be \nnoted that there are many different ways in GMS to create 2D scatter points. Scatter \npoints can be created by converting a 2D grid, 2D mesh, TIN , borehole contacts, or map \ndata to a scatter point set. Scatter points can also be created by creating a new scatter \npoint set and then click out the points in the Graphics Window.  \nIn this example, a 2D grid will be created and then converted to scatter p oints. In order to \ncreate about 50 pilot points, it is necessary to make a cell -centered 2D grid with 50 cells.  \n1. In the Project Explorer,  right-click on the empty space and select New | Grid \nFrame . \n2. Select \u201c  Hydraulic Conductivity\u201d to make it active.  \n3. In the Project Explorer,  right-click on \u201c  Grid Frame\u201d and select Fit to Active \nCoverage . \n4. Select \u201c  Observation Wells\u201d to make it active.  \nIt should appear similar to Figure 2 when done.  \n\nGMS Tutorials   MODFLOW \u2013 PEST Pilot Points  \n \n Page 5 of 12 \u00a9 Aquaveo 2024   \n      Figure 2      The grid frame should encompass the entire model  \nWith the coverages and the grid frame created, it is now possible to create the grid.  \n5. Select Feature Objects  | Map \u2192 2D Gri d to open the Create Finite Difference \nGrid dialog.  \n6. In the X-Dimension  section, enter \u201c5\u201d  for the Number cells . \n7. In the Y-Dimension  section, enter \u201c10\u201d  for the Number cells . \n8. Click OK to close the Create Finite Difference Grid  dialog.  \nThe result is a 2D grid  with 50 cells. Convert it to 2D scatter points by doing the following:  \n9. Right -click on the \u201c  grid\u201d item under the \u201c  2D Grid Data\u201d folder and select \nConvert To  | 2D Scatter Points  to bring up the Scatter Point Set Name  dialog.  \n10. Enter \u201cHK\u201d as the New scatte r point set name  and click OK to close the Scatter \nPoint Set Name  dialog.  \n11. Right -click on the \u201c  grid\u201d and select Delete  to remove the grid.  \nThe default starting value of hydraulic conductivity should be 0.5 m/d, so the next step is \nto change the data value s at the scatter points to this value.  \n12. Expand the \u201c  2D Scatter Data\u201d folder and select the \u201c  HK\u201d scatter point set \nto make it active.  \n13. Unlock the scatter points by selecting Scatter Points | Lock All Scatter Points  to \nremove the checkmark to the left of t he entry in the menu.  \n14. Select the Select Scatter Points   tool and press Ctrl-A to select all of the \nscatter points.  \n\nGMS Tutorials   MODFLOW \u2013 PEST Pilot Points  \n \n Page 6 of 12 \u00a9 Aquaveo 2024  15. In the XYZF Bar , enter \u201c0.5\u201d in the S field and press Enter  to set the new value.  \n16. Deselect the points by clicking anywhere outside the model.  \nThe model should appear similar to Figure 3. \n \n      Figure 3      Placement of scatter points  \n4 Editing the HK Parameter  \nIn the \u201cMODFLOW \u2013 Automated Parameter Estimation \u201d tutorial, the example  had four \nhydraulic conductivity parameters.  For this problem , GMS will e stimat e the hydraulic \nconductivity for the entire lay er with the pilot points.  Only o ne parameter for hydraulic \nconductivity  is needed . This parameter will then be linked to the pilot points using the \nParameters  dialog.  \n4.1 Editing the Parameters  \nThe first step is to edit the currently defined parameters for MOD FLOW.  \n1. Select MODFLOW  | Parameters\u2026  to open the Parameters dialog.  \n2. On the row for the \u201c HK_30\u201d parameter, click the  button in the Value  column \nand select \u201c<Pilot points>\u201d from the drop -down.  \n3. Click on the  button in the Value  column on the \u201cHK_30\u201d row to bring up the \n2D Interpolation Options  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 PEST Pilot Points  \n \n Page 7 of 12 \u00a9 Aquaveo 2024  This dialog allows selecting the scatter point set and dataset used with the parameter and \nthe interpolation scheme. The defaults are appropriate in this case, so it\u2019s not necessa ry \nto change anything.  \n4. Click OK to exit the 2D Interpolation Options  dialog.  \n5. Click OK to exit the Parameters dialog.  \n4.2 Limiting the Number of Parameter Estimation Runs  \nIn the interest of time, this tutorial will limit the number of iterations that PEST does for \nthe problem.  \n1. Select MODFLOW | Parameter Estimation\u2026  to bring up the PEST  dialog.  \n2. For the Max number of iterations  (NOPTMAX  ), enter \u201c5\u201d .. \nNotice the Tikhonov regularization (only used with pilot points)  section of the dialog. This \nsection allows specif ying the type of regularization to use with PEST. By default, \nPreferred homogeneous regularization  is turned on.  \nThe Prior information power factor  is used to change the weight applied to the prior \ninformation equations for the pilot points. When the prior information equations are \ncreated, GMS will compute an inverse distance weight between each pilot point and all \nother pilot points for a given par ameter.  \nThis weight is then raised to the power of the Prior information power factor  and assigned \nto the equation for a given pair of points. Increase the homogeneity constraint (assign a \nhigher weight to the prior information equation) by decreasing thi s value. Decrease the \nhomogeneity constraint (assign a lower weight to the prior information equation) by \nincreasing this value. This tutorial will use the default value of \u201c1.0\u201d.  \n3. Click OK to exit the PEST  dialog.  \n5 Saving the Project and Running PEST  \nNow that all the parameters are set, the project can be saved and PEST can be run.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cmfpest_pilot.gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and exit the Save As  dialog.  \n5. Click Run MODFLOW   to bring up the MODFLOW/PEST Parameter \nEstimation  dialog.  \nPEST is now running. The error and parameter values are updated in the spreadsheet in \nthe upper -right side of the  dialog as the model run progresses. The plot on the left shows \na graphical representation of the error. In this case, there may be some strange \nparameter names like sc1v1. These names were automatically generated and assigned \nto the pilot points.  \nPEST may  take several minutes to run, depending on the speed of the computer being \nused. The residual error should decrease with each iteration. When PEST is finished, a \nmessage will appear in the text portion of the window and the Abort  button will change to \nClos e. Once PEST is finished, it is possible to import the solution.  \n6. Turn on Read solution on exit  and Turn on contours (if not on already) .  \n\nGMS Tutorials   MODFLOW \u2013 PEST Pilot Points  \n \n Page 8 of 12 \u00a9 Aquaveo 2024  7. Click Close  to exit the MODFLOW/PEST Parameter Estimation  dialog.  \nThe model should appear similar to Figure 4. The contours shown on the 3D grid are the \nheads from the MODFLOW run with the optimum parameter values.  \n \n      Figure 4      View of the solution after initial MODFLOW/PEST run  \n5.1 Viewing the Solution  \nThe observation targets in the map model and the error associated with this model run \ncan now be reviewed.  \n1. In the Project Explorer, turn off the \u201c  3D Grid Data\u201d folder in order to see the \ncoverage data better.  \n2. Select the \u201c  Sources & Sinks\u201d  coverage from the Project Explorer .  \nNotice that the observation target on the arc group almost exactly matches.  \n3. Use the Select Arc Groups   tool to select the r iver arc group by clicking on \nthe river arc.  \nIn the edit strip at the bottom of the Graphics Window, notice that the computed and \nobserved flows are reported.  \n4. Select the \u201c  Observation Wells\u201d  coverage from the Project Explorer  to see how \nclosely the compu ted heads match the field observations.  \n5. Right -click on the \u201c  mfpest_pilot (MODFLOW)\u201d  solution in the Project Explorer  \nand select Properties\u2026  to open the Properties  dialog.  \nThis dialog contains a spreadsheet showing the error from this model run. The \nspreadsheet shows the error from the head observations, the flow observations, and the \n\nGMS Tutorials   MODFLOW \u2013 PEST Pilot Points  \n \n Page 9 of 12 \u00a9 Aquaveo 2024  combined weighted observations. Note that these values are lower than the values \nobtained u sing the zonal parameters approach.  \n6. When finished viewing the properties, click OK to close the Properties  dialog . \nTurn on the \u201c  3D Grid Data\u201d folder in the Project Explorer.  \n5.2 Viewing the Final Hydraulic Conductivity  \nWhen PEST ran, a value was estimated at  each of the scatter points used with the \n\u201cHK_30\u201d parameter. The next step is to import the optimal parameter values as \ndetermined by PEST. Importing the optimal parameter values will create a new dataset \nfor the scatter point set. The final hydraulic cond uctivity field will then be seen.  \n1. Select MODFLOW | Parameters\u2026  to open the Parameters dialog.  \n2. Click Import Optimal Values\u2026  to bring up the Open  dialog.  \n3. Select \u201cPAR File (*.par,*.bpa)\u201d from the drop -down to the right of the File name  \nfield.  \n4. Browse to the pilotpoints/pilotpoints/mfpest_pilot_MODFLOW  directory and \nselect \u201cmfpest_pilot.par\u201d.  \n5. Click Open  to exit the Open  dialog.  \nNotice that the starting values for the parameters have changed.  \n6. Click the  button above the drop -down  in the Value  column for \nparameter \u201cHK_30\u201d to bring up the 2D Interpolation Options  dialog.  \nNotice that \u201cHK_30 (mfpest_pilot)\u201d is selected in the Dataset  drop-down. This dataset \nwas imported when the optimal values were imported, and it represents the optimal \nvalues at each pilot poin t as determined by PEST.  \n7. Click OK to exit the 2D Interpolation Options  dialog.  \n8. Click OK to exit the  Parameters dialog.  \n9. Expand the \u201c  MODFLOW\u201d item in the Project Explorer and select \u201c  HK\u201d \nunder the \u201c  LPF\u201d package.  \nThe final hydraulic conductivity values for the MODFLOW simulation should now be \nvisible ( Figure 5). \n\nGMS Tutorials   MODFLOW \u2013 PEST Pilot Points  \n \n Page 10 of 12 \u00a9 Aquaveo 2024   \n      Figure 5      Showing the final hydraulic conductivity v alues  \n6 Adding Fixed Value Pilot Points  \nPilot points can be supplemented by field -measured hydraulic conductivity values (such \nas pump -test data values). Now add additional pilot points to the model and fix the HK \nvalue at those points. First, it is necessary to change the display so it is possible to more \neasily see the grid.  \n1. Click Display Options   to bring up the Display Options  dialog.  \n2. Select \u201c3D Grid Data\u201d from the list on the left.  \n3. On the 3D Grid  tab, in the Active dataset  section, turn off Cont ours. \n4. Click OK to close the Display Options  dialog.  \nNotice that there are three pumping wells in the model ( Figure 6, the center of each \ngreen circle) . For purposes of illustration, assume that a pump test was performed at \neach of these wells and the HK was estimated.  \nCreate a pilot point at each of these wells.  \n5. Select the \u201c  2D Scatter Data\u201d folder in the Project Explorer to make it active.  \n6. Using the Create Scatter Points   tool, create a scatter point at each of the \npumping wells as shown in Figure 6. \n\nGMS Tutorials   MODFLOW \u2013 PEST Pilot Points  \n \n Page 11 of 12 \u00a9 Aquaveo 2024   \n      Figure 6      Location of pumping wells  \n7. Using the Select Scatter Points   tool, select the new scatter point for the well \nclosest to the top of the model.  \nTurning off the 3D grid in the Project Explorer makes the new scatter points more visible.  \n8. In the XYZF Bar , enter \u201c1.0\u201d in the S field and press Enter  to set the new value.  \n9. Select the scatter point at the well on the east (right) side of the model, enter \n\u201c0.1\u201d in the S field, and press Enter  to set the new value.  \n10. Select the scatter point at the well on the west (left) side of the model, enter \u201c5.0\u201d \nin the S field, and press Enter  to set the new value.  \n11. Now select all three of the new scatter points by holding Shift while selecting \neach one, then select Edit | Properties\u2026  to open the Properties dialog.  \n12. In the All row, check the box in the Fixed Pilot Point  column.  \n6.1 Saving the Project and Running PEST  \nIt is now possible to save and run PEST.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter  \u201cmfpest_pilot_fixed.gpr\u201d as the File name  and click Save  to exit the Save \nAs dialog.  \n4. Click Run MODFLOW   to bring up the MODFLOW/PEST Parameter \nEstimation  dialog.  \nPEST may take several minutes to run depending on the speed of the computer being \nused. Once P EST is finished, import the solution.  \n\nGMS Tutorials   MODFLOW \u2013 PEST Pilot Points  \n \n Page 12 of 12 \u00a9 Aquaveo 2024  5. Turn on Read solution on exit  and Turn on contours (if not on already) .  \n6. Click Close  to exit the MODFLOW/PEST Parameter Estimation  dialog.  \n7. View the new HK field by selecting the \u201c  HK Parameter -30\u201d dataset under the \n\u201c Parameters\u201d folder of the \u201c  mfpest_pilot_fixed (MODFLOW)\u201d solution.  \nThe project should appear similar to Figure 7. \n \nFigure 7      \u201cHK Parameter -30\u201d solution with fixed pilot points  \n7 Conclusion  \nThis concludes the \u201c MODFLOW \u2013 PEST Pilot Points \u201d tutorial. The following key topics \nwere discussed and demonstrated:  \n\uf0b7 When using pilot points, there may be more parameters than observations \nbecause regularization is included in the parameter estimation.  \n\uf0b7 In the MODFLOW  Parameters  dialog, change a parameter to use pilot points by \nusing the  and  button s. \n\uf0b7 2D scatter points can be used to create pilot points in GMS.  \n \n\n", "filename": "MODFLOW-PestPilotPoints.pdf", "pages": 12}, "MODFLOW-PestPilotPointsAdvanced": {"text": "GMS Tutorials   MODFLOW \u2013 Advanced PEST Pilot Points  \n Page 1 of 10 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Advance PEST Pilot Points  \nEdit regularization options and use more than one set of pilot points to \ncalibrate a MODFLOW model  \n \nObjectives   \nThis tutorial demonstrates the features and options related to pilot points when used with PEST. It will \nreview using fixed -value pilot points, regularization, and multiple parameters.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 PEST  Pilot \nPoints  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 Geostatistics  \n\uf0b7 MODFLOW Interface  \n\uf0b7 PEST  \n Time  \n\uf0b7 20\u201330 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   MODFLOW \u2013 Advanced PEST Pilot Points  \n Page 2 of 10 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  3 \n2 Importing the Project  ................................ ................................ ................................ ...........  3 \n3 Changing the Regularization Option  ................................ ................................ ..................  4 \n3.1 Saving the Project  ................................ ................................ ................................ .........  4 \n3.2 Prior Information Equations  ................................ ................................ ..........................  4 \n3.3 Running PEST  ................................ ................................ ................................ ..............  4 \n4 Multiple Parameters using Pilot Points  ................................ ................................ .............  5 \n4.1 Creating a Second Set of Pilot Points  ................................ ................................ ...........  6 \n4.2 Creating the New HK Parameter  ................................ ................................ ..................  7 \n4.3 Creating the New HK Parameter  ................................ ................................ ..................  7 \n4.4 Saving the Project and Running PEST  ................................ ................................ .........  8 \n5 A Note on Highly Parameterized Models  ................................ ................................ .........  10 \n6 Conclusion  ................................ ................................ ................................ .........................  10 \n \n1 Introduction  \nPilot points can be thought of as a 2D scatter point set. Instead of creating a zone and \nhaving the inverse model estimate one value for the entire zone, the value of the \nparameter within the zone is interpolated from the pilot points. The inverse model then \nestimates the values at the pilot points. Using pilot points will vary values from cell to ce ll. \nWhen the inverse model runs, the values at the pilot points are adjusted and re -\ninterpolated to the grid cells until the objective function is minimized.  \nPEST provides an option for the pilot point method called regularization. Regularization \nimposes a n additional measure of constraint to the parameter being interpolated. This \nconstraint is imposed by providing PEST with additional information about the parameter \nin the form of prior information equations.  This constraint makes the inversion process \nmuch more stable and makes it possible to violate one of the typical constraints \nassociated with parameter estimation: namely, the requirement that the number of \nparameters be less than the number of observations .  \nWith regularization, the number of parameters can greatly exceed the number of \nobservations. As a result, complex hydraulic conductivity distributions can be defined, \nresulting in extremely low residual error. The pilot point method with regularization is an \nincredibly powerful feature of PEST.  \nThere are two methods available in GMS for defining the prior information equations for \nPEST. The two methods can be used simultaneously but are usually used separately. \nThe first method is Preferred homogeneous r egularization . When this option is selected, \nthe prior information equations written to the PEST control file relate the pilot points to \none another. These equations indicate to PEST that \u2014in the absence of any strong \ninfluence from the PEST objective funct ion\u2014pilot points that are near to one another \nshould have about the same value.  \nThe second method of regularization is Preferred value regularization . When this option \nis selected, prior information equations written to the PEST control file relate the pil ot \npoints to their starting value. These equations indicate to PEST that \u2014in the absence of \nany strong influence from the PEST objective function \u2014the pilot point values should be \nequal to their starting value. Depending on the particular problem being solve d, one \nmethod may be preferable over the other.  \nThe model to be calibrated in this tutorial is the same model featured in the \u201c MODFLOW  \n\u2013 PEST Pilot Points\u201d tutorial. The model includes observed flow data for the stream and \nobserved heads at a set of scatte red observation wells. The conceptual model for the site \nconsists of a set of recharge and hydraulic conductivity zones. These zones will be \nmarked as parameters and an inverse model will be used to find a set of recharge and \nhydraulic conductivity values that minimize the calibration error.  \nGMS Tutorials   MODFLOW \u2013 Advanced PEST Pilot Points  \n \n Page 3 of 10 \u00a9 Aquaveo 2024  This tutorial will discuss and demonstrate the following:  \n\uf0b7 Opening a MODFLOW model and solution.  \n\uf0b7 Changing regularization options and running PEST.  \n\uf0b7 Using pilot points on different zones and different parameter types.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state. Click Don\u2019t Save if asked to save changes.  \n2 Importing the Project  \nFirst, import the modeling project:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the pilotpointsAdvanced \\pilotpointsAdvanced  directory and select \n\u201cmfpest_pilot_fixed.gpr\u201d.  \n4. Click Open  to import the project and exit the Open  dialog.  \nThe initial MODFLOW model should appear similar to Figure 1. \n \n      Figure 1      The initial MODFLOW model  \n\nGMS Tutorials   MODFLOW \u2013 Advanced PEST Pilot Points  \n \n Page 4 of 10 \u00a9 Aquaveo 2024  3 Changing the Regularization Option  \nFirst, the regularization option needs to be changed to use the Preferred value \nregularization  method.  \n1. Select MODFLOW | Parameter Estimation\u2026  to open the PEST dialog.  \n2. In the Tikhonov regularization (only used with pilot points)  section, turn off \nPreferred homogeneous regularization . \n3. Turn on Preferred value regularization . \n4. Click OK to close the PEST  dialog.  \n3.1 Saving the Project  \nBefore running MODFLOW, the project should be saved.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter  \u201cmfpest_pilot_pref_val.gpr\u201d as the File name . \n4. Click Save  to close the Save As  dialog.  \n3.2 Prior Information Equations  \nIf desired, compare the d ifferent prior information equations written from GMS by looking \nat the RPF files in the MODFLOW directories using a text editor. The prior information \nequations for Preferred homogenous regularization , found in \u201cmfpest_pilot_fixed.rpf\u201d, \nshould look simila r to Figure 2. \n \n      Figure 2      Prior information equations from preferred homogenous regularization  \nNotice that these equations define a relationship between the different pi lot points. In \naddition, the weight applied to theses equations changes as shown by the last number \nwritten to each line. In contrast, the prior information equations for Preferred value \nregularization , found in \u201cmfpest_pilot_pref_val.rpf\u201d as shown in Figure 3, have the same \nweight applied and define a preferred value for each point.  \n \n      Figure 3      Prior information equations from preferred value regularization  \n3.3 Running PEST  \nWith the project saved, the next step is to run PEST.  \n1. Click Run MODFLOW   to bring up the MODFLOW/PEST Parameter \nEstimation  dialog.  \nPEST may take several minutes to run, dep ending on the speed of the computer being \nused. Once PEST is finished, import the solution.  \n\nGMS Tutorials   MODFLOW \u2013 Advanced PEST Pilot Points  \n \n Page 5 of 10 \u00a9 Aquaveo 2024  2. Turn on Read solution on exit  and Turn on contours (if not on already) .  \n3. Click Close  to exit the MODFLOW/PEST Parameter Estimation  dialog.  \n4. Select MODFLOW | Parameters\u2026  to open the Parameters dialog.  \n5. Click Import Optimal Values\u2026  to bring up the Open  dialog.  \n6. Select \u201cPAR File (*.par,*.bpa)\u201d from the drop -down to the right of the File name  \nfield.  \n7. Browse to the \npilotpointsAdvanced/ pilotpointsAdvanced/mfpest_pilot_ pref_val_MODFLOW  \ndirectory and select \u201cmfpest_pilot_pref_val.par\u201d.  \n8. Click Open  to exit the Open  dialog.  \n9. Click OK to close the Parameters  dialog.  \nThe project should appear similar to Figure 4. \n \nFigure 4      Optimal values  \n4 Multiple Parameters using Pilot Points  \nIn GMS, pilot points can be used with HK and RCH parameters. Multiple HK (or RCH) \nparameters th at use the same or different pilot points can exist. Create a second HK \nparameter and a new set of pilot points.  \n1. In the Project Explorer, turn off the \u201c  3D Grid Data\u201d folder.  \n2. Select the \u201c  Hydraulic Conductivity\u201d coverage to make it active.  \n3. Using the Select Polygons   tool, double -click the polygon surrounding the \nriver in the middle of the model to bring up the Attribute Table  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Advanced PEST Pilot Points  \n \n Page 6 of 10 \u00a9 Aquaveo 2024  4. Enter \u201c -60.0\u201d the Horizontal K (m/d)  column and click OK to close the Attribute \nTable  dialog.  \n5. Right -click on \u201c  Hydraulic Conductivity\u201d and select Map To | \nMODFLOW/MODPATH . \n4.1 Creating a Second Set of Pilot Points  \nNow to create another scatter point set for the new HK parameter by creating a 2D grid \nand converting it to a scatter point set.  \n1. Right -click on an empty spa ce in the Project Explorer  and select New | 2D Grid\u2026  \nto open the Create Finite Difference Grid dialog.  \n2. In the X-Dimension  section, enter \u201c2240.0\u201d for the Origin , \u201c4075.0\u201d (m) for the \nLength , and \u201c3\u201d for the Number cells . \n3. In the Y-Dimension  section, enter \u201c 700.0\u201d for the Origin , \u201c11100.0\u201d (m) for the \nLength , and \u201c5\u201d for the Number cells . \n4. In the Z-Dimension  section, enter \u201c0.5\u201d as the Origin . This value will be assigned \nto the scatter points created from the grid.  \n5. In the Orientation / type  section, select \u201cCe ll centered\u201d from the Type  drop-down.  \nThe dialog should appear similar to Figure 5. \n \n      Figure 5      Create Finite Difference Grid dialog  \n6. Click OK to close the Create Finite Difference Grid  dialog.  \n7. Right -click on \u201c  grid\u201d and select Convert To | 2D Scatter Points  to bring up the \nScatter Point Set Name  dialog.  \n8. Enter \u201cHK_60\u201d as the New scatter point set name  and click OK to close the \nScatter Point Set Name  dialog.  \n9. Right -click on the same \u201c  grid\u201d item and select Delete .  \nThe new scatter  points should appear interspersed with the previous scatter points \n(Figure 6). Feel free to turn on and off each set of scatter points to more clearly see their \nlocations.  \n\nGMS Tutorials   MODFLOW \u2013 Advanced PEST Pilot Points  \n \n Page 7 of 10 \u00a9 Aquaveo 2024   \n      Figure 6      New scatter points (\u201cHK\u201d scatter set turned off)  \n4.2 Creating the New HK Parameter  \nA new parameter for the newly created pilot points should now be created.  \n1. Select MODFLOW | Parameters\u2026  to open the Parameters dialog.  \n2. Click Initialize From Model . \nNotice that a line for \u201cHK_60\u201d is added to the bottom of the list of parameters.  \n3. Check the boxes in the Param. Est. Solve  and Log Xform  columns on the \n\u201cHK_60\u201d row.  \n4. Select \u201c<Pilot points>\u201d from the drop -down  in the Value  column on the \n\u201cHK_60\u201d row .  \n5. Click on the  button above the drop -down  in the Value  column for  \nparameter \u201cHK_60\u201d to open the 2D Interpolation Options dialog.  \n6. In the Interpolating from  section, select \u201cHK_60 (active)\u201d from the Object  drop-\ndown.  \n7. Click OK to exit the 2D Interpolation Options dialog.  \n8. Click OK to exit the  Parameters dialog.  \n4.3 Creating th e New HK Parameter  \nUse pilot points to estimate recharge with the model. For the RCH parameter, use the \nsame set of pilot points that the \u201cHK_30\u201d parameter uses, but create a new dataset with \nstarting values for the RCH parameter.  \n\nGMS Tutorials   MODFLOW \u2013 Advanced PEST Pilot Points  \n \n Page 8 of 10 \u00a9 Aquaveo 2024  1. Right -click the \u201c  Recharge\u201d  coverage and select Attribute Table\u2026  to bring up \nthe Attribute Table  dialog.  \n2. Select \u201cPolygons\u201d from the Feature type  drop-down.  \n3. In the All row, enter \u201c -150.0\u201d in the Recharge rate (m/d)  column.  \n4. Click OK to close the Attribute Table  dialog.  \n5. Right -click on the \u201c  Recharge\u201d  coverage and select Map To | \nMODFLOW/MODPATH . \nCreating New Starting Values for the RCH Parameter : \nNext, create a new dataset on the HK scatter set to provide the starting values for the \nRCH parameter.  \n1. Select the \u201c  HK\u201d scatt er point set in the Project Explorer to make it active.  \n2. Select Edit | Dataset Calculator\u2026  to bring up the Data Calculator  dialog.  \n3. Enter \u201c1e -5\u201d in the Expression  field.  \n4. Enter \u201cRCH\u201d in the Result  field.  \n5. Click Compute  to create a new dataset with all values e qual to \u201c1.0e -5\u201d. \n6. Click Done  to exit the Data Calculator  dialog.  \nEditing the RCH Parameters : \nThe RCH parameters should now be edited to use pilot points.  \n1. Select MODFLOW | Parameters\u2026 to bring up the Parameters  dialog.  \n2. Click on \u201cRCH_180\u201d in the Name  column and click Delete .  \n3. Repeat step 2 for the \u201cRCH_210\u201d parameter row.  \n4. In the Value  column for the \u201cRCH_150\u201d row, click the drop -down  and select \n\u201c<Pilot points>\u201d. This turns on the pilot points  option for this parameter.  \n5. Click on the  button above the drop -down  in the Value  column for \nparameter \u201cRCH_150\u201d to bring up the 2D Interpolation Options  dialog.  \n6. In the Interpolating from  section, select \u201cHK (active)\u201d from the Object  drop-down, \nand \u201cRCH\u201d from the Dataset  drop-down.  \n7. Click OK to close the 2D Interpolation Options  dialog.  \n8. Click OK to close the Parameters  dialog.  \n4.4 Saving the Project and Running PEST  \nBefore running PEST, the project should be saved.  \n1. Select File | Save As \u2026 to bring up the Save As  dialog . \n2. Select \u201cProject Files (*.gpr)\u201d from the Save  as type  drop-down.  \n3. Enter  \u201cmfpest_pilot_2zones.gpr \u201d as the File name . \n4. Click Save  to close the Save As  dialog.  \nWhen pilot points are assigned to both HK and RCH parameters, the prior information \nequations for the HK and RCH parameters are assigned to differ ent regularization \n\nGMS Tutorials   MODFLOW \u2013 Advanced PEST Pilot Points  \n \n Page 9 of 10 \u00a9 Aquaveo 2024  groups. This helps PEST to differentiate weighting among pertinent prior information \nequations. In other words, PEST works better with this option.  \n5. Click Run MODFLOW   to bring up the MODFLOW/PEST Parameter \nEstimation  dialog.  \nPEST may ta ke several minutes to run, depending on the speed of the computer being \nused. Once PEST is finished, import the solution.  \n6. Turn on Read solution on exit  and Turn on contours (if not on already) . \n7. Click Close  to exit the MODFLOW/PEST Parameter Estimation  dialog.  \n8. Select MODFLOW | Parameters\u2026  to open the Parameters dialog.  \n9. Click Import Optimal Values\u2026  to bring up the Open  dialog.  \n10. Select \u201cPAR File (*.par,*.bpa)\u201d from the drop -down to the right of the File name  \nfield.  \n11. Browse to the \npilotpointsAdvanced/ pilotpo intsAdvanced/mfpest_pilot_2zones_MODFLOW  \ndirectory and select \u201cmfpest_pilot_2zones.par\u201d.  \n12. Click Open  to exit the Open  dialog.  \n13. Click OK to close the Parameters  dialog.  \n14. Turn on \u201c  3D Grid Data\u201d.  \nThe solution should appear similar to Figure 7. Feel free to compare the solutions by \nalternating between them in the Project Explorer.  \n \nFigure 7      After the final run  \n\nGMS Tutorials   MODFLOW \u2013 Advanced PEST Pilot Points  \n \n Page 10 of 10 \u00a9 Aquaveo 2024  5 A Note on Highly Parameterized Models  \nThe model that was just created has over 100 parameters. This is a fairly simple \nMODFLOW model that converges rather quickly. Most real -world problems take longer to \nrun, so it may not be practical to run MODFLOW over 100 times for each PEST iteration.  \nHowever, PEST supports a very innovative method known as SVD -Assist which can \ndramatically reduce the number of model runs required for each PEST iteration. When \ncombining SVD -Assist with Parallel PEST, it becomes practical to use  PEST with models \ncontaining hundreds or even thousands of parameters. Learn more about these methods \nin the \u201c MODFLOW \u2013 Advanced PEST \u201d tutorial.  \n6 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 Advanced PEST Pilot Points\u201d  tutorial. The following \nkey topics were di scussed and demonstrated:  \n\uf0b7 Two different regularization options are available for pilot points: preferred \nhomogeneous and preferred value.  \n\uf0b7 Multiple sets of pilot points can be used with the same MODFLOW model.  \n \n", "filename": "MODFLOW-PestPilotPointsAdvanced.pdf", "pages": 10}, "MODFLOW-Recharge": {"text": "GMS Tutorials   MODFLOW \u2013 Recharge  \n Page 1 of 16 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Recharge  \nRecharge package in MODFLOW  \n \nObjectives   \nLearn about inputs to the MODFLOW Recharge package.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Grid \nApproach  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 25\u201340 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 Recharge  \n Page 2 of 16 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Importing the Project  ................................ ................................ ................................ ...........  2 \n3 Recharge Package  ................................ ................................ ................................ ...............  3 \n4 Contouring the Recharge Values  ................................ ................................ .......................  4 \n4.1 Effect of IBOUND  ................................ ................................ ................................ ..........  5 \n5 Changing the Recharge Option (NRCHOP)  ................................ ................................ ....... 6 \n5.1 Recharge at Specified vertical cells  ................................ ................................ ..............  6 \n6 Transient Model  ................................ ................................ ................................ ...................  7 \n6.1 Recharge Dataset  ................................ ................................ ................................ .........  8 \n6.2 Cell Editing of Recharge  ................................ ................................ ...............................  9 \n7 Conceptual Model  ................................ ................................ ................................ ..............  11 \n8 Model with Parameters  ................................ ................................ ................................ ...... 14 \n9 Conclusion  ................................ ................................ ................................ .........................  16 \n \n1 Introduction  \nThe Recharge Package (RCH) is used by MODFLOW to simulate the deep percolation of \nwater that reaches an aquifer. The purpose of th is tutorial is to demonstrate how \nrecharge can be entered, edited, and visualized in GMS. The example will use a very \nsimplistic model to illustrate the various ways that recharge can be specified.  \nThis tutorial is recommended for users who want to explor e in depth all of the options \navailable in the recharge package. This tutorial is not meant to demonstrate common \nworkflows for implementing recharge in a typical groundwater model.  \n1.1 Getting Started  \nDo the following to get started:   \n1. If necessary, launch GMS .  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2 Importing the Project  \nFirst, import the modeling project:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr )\u201d from the Files of type  drop-down.  \n3. Browse to the recharge  directory for this tutorial and select \u201cmf2k_recharge.gpr\u201d.  \n4. Click Open  to import the project and close the Open  dialog.  \nThe imported project should appear similar to Figure 1. \n\nGMS Tutorials   MODFLOW \u2013 Recharge  \n \n Page 3 of 16 \u00a9 Aquaveo 2024   \n      Figure 1      Initial screen after importing the project  \nThis is a three layer steady -state MODFLOW model with nine cells in each layer. The \nmodel has one specified head cell and recharge. The recharge is specified to be applied \nto layer 1.  \n3 Recharge Package  \nFirst, look at the inputs in the recharge package.  \n1. Double -click on the \u201c  RCH\u201d item in the Project Explorer to bring up the \nMODFLOW Rec harge Package  dialog.  \nThe top of the dialog has the Recharge option (NRCHOP) section. This variable controls \nwhere the recharge is specified in the model. The current option, \u201c(1) Recharge only at \ntop layer\u201d, means that recharge will only be applied to cel ls in layer 1. There are two other \noptions: \u201c(2) Recharge at specified vertical cells\u201d, and \u201c(3) Recharge at highest active \ncell\u201d. Each of these items will be explained in greater detail later.  \nThe Stress period  section is where the current stress period i s selected. Changing the \nstress period will change the contents in the spreadsheet at the bottom of the dialog and \nthe value of the multiplier.  \nThe spreadsheet at the bottom of the dialog shows values in the different recharge \narrays, with \u201cRECH. Flux\u201d cur rently shown. This value has units of length/time and is \nspecified for each cell in layer 1. The amount of water that will enter the MODFLOW cell \nfrom recharge will be this value multiplied by the area of the cell.  \nThere are five buttons on the upper right  side of the dialog. The Edit All Use \nprevious/Multipliers\u2026  will be explained later. The 2D Dataset \u2192 Array  button is used \nto select a dataset from a matching 2D grid and apply that dataset to the recharge array. \nThe Array \u2192 2D Dataset  creates a dataset on a matching 2D grid from the recharge \ndata. The Constant \u2192Array  button assigns a constant value to the recharge array. The \nRasters \u2192 Array\u2026  button takes elevation values from a raster and places them in the \narray.  \n2. Click OK to close the  MODFLOW Recharge Package  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Recharge  \n \n Page 4 of 16 \u00a9 Aquaveo 2024  4 Contouring the Recharge Values  \nThe recharge values can be visualized by making the \u201c  RCH Rate\u201d item the active \ndataset in the Project Explorer.  \n1. Select the \u201c  RCH Rate\u201d item in the Project Explorer.  \nThe view will look like  Figure 2 below.  \n \nFigure 2       RCH rate contours  \nOnly the top layer of the grid is visible because recharge is only applied to the top of the \ngrid. The color is the same in each cell because the recharge values are constant. The \nrecharge values can be edited in the MODFLOW  Recharge Package  dialog and the y can \nbe edited by selecting a cell.  \n2. Using the Select Cells   tool, select the cell shown in Figure 3. \n  \nFigure 3      Select  the cell indicated by the arrow (IJK: 1,1,1)  \n3. Right -click on the selected cell and choose Sources/Sinks  to open the \nMODFLOW Sources/Sinks  dialog.  \n4. Select \u201cRecharge (RCH)\u201d from the list on the left side of the dialog.  \n5. Enter \u201c0.0002\u201d for the Flux (ft/d)  value in the spreadsheet.  \n6. Select OK to exit the MODFLOW Sources/Sinks  dialog.  \nThe view will update and appear like Error! Reference source not found. . \n\nGMS Tutorials   MODFLOW \u2013 Recharge  \n \n Page 5 of 16 \u00a9 Aquaveo 2024   \nFigure 4      RCH rate contours  \n4.1 Effect of IBOUND  \nThe IBOUND can affect recharge.  \n1. Double -click on the same cell where the recharge rate was edited. The 3D Grid \nCell Properties  dialog will appear with the MODFLOW  tab active.  \n2. Chan ge the value in the IBOUND  row to \u201cInactive\u201d.  \n3. Click OK to exit the 3D Grid Cell Properties  dialog.  \nThe cell is no longer visible because the IBOUND value is inactive (0) as shown in Figure \n5. \n \nFigure 5     The inactive cell is no longer visible  \nThis cell will not be included in MODFLOW\u2019s computations. The recharge value assigned \nto that cell will be ignored.  \n4. Double -click on the  \u201c RCH\u201d item in the Project Explorer to bring up the \nMODFLOW Recharge Package  dialog.  \nNotice in the spreadsheet that the first cell is not editable. Again, this is because the \nrecharge to that cell will be ignored by MODFLOW.  \n\nGMS Tutorials   MODFLOW \u2013 Recharge  \n \n Page 6 of 16 \u00a9 Aquaveo 2024  5 Changing the Recharge Option (NRCHOP)  \nOften it is useful for the recharge that would have been applied to a cell in layer 1 to be \napplied to a cell in a lower layer below the original cell. If for some reason the cell in layer \n1 became dry during a simulation, the recharge applied to that cell would be ignored by \nMODFLOW. However, it is generally desired that the recharge value would be applied to \na lower cell. This can be accomplished by changing the Recharge option . \n1. Change the Recharge option (NRCHOP)  to \u201c(3) Recharge at highest acti ve cell\u201d.  \nNotice that the first item in the spreadsheet is now editable because there is an active cell \nbelow the inactive cell in layer 1.  \n2. Select OK to exit the MODFLOW Recharge Package  dialog.  \nThe recharge dataset has now updated as well. The view will l ook like Figure 6. \n \nFigure 6      RCH rate contours  \nNow inactivate all the cells in the column below the inactive cell.  \n3. Right -click on the \u201c  Ibound\u201d item in the Project Explorer and select \nProperties\u2026  to open the Ibound Array  dialog.  \n4. Change the value in the Layer  edit field to \u201c2\u201d. The spreadsheet will update with \nvalues from layer 2.  \n5. Change the value to \u201c0\u201d in row 1 colum n 1. \n6. Change the value in the Layer  edit field to \u201c3\u201d.  \n7. Again, change the value to \u201c0\u201d in row 1 column 1.  \n8. Click OK to exit the Ibound Array  dialog.  \nNotice that no cells in the column below cell id 1 are visible.  \n9. Double -click on the \u201c  RCH\u201d item in the Proje ct Explorer to bring up the \nMODFLOW Recharge Package  dialog.  \nNotice that the first item in the spreadsheet is not editable. If no cells are active in a \ncolumn of the grid then the recharge value will be ignored by MODFLOW.  \n5.1 Recharge at Specified vertical ce lls \nThe \u201cRecharge at specified vertical cells\u201d option allows recharge to be assigned to a \nparticular cell. When this option is selected, another array (IRCH) is available for editing.  \n\nGMS Tutorials   MODFLOW \u2013 Recharge  \n \n Page 7 of 16 \u00a9 Aquaveo 2024  1. Change the Recharge option (NRCHOP)  to \u201c(2) Recharge at specified vertic al \ncells\u201d.  \n2. Change the item in the View/Edit  drop-down list to \u201cIRCH. Layer indicator\u201d.  \nNotice that the first item in the spreadsheet is not editable. There are no active cells in \nthis column.  \n3. Change the value in row 1 column 2 to \u201c2\u201d (for layer 2).  \n4. Change the value in row 1 column 3 to \u201c3\u201d (for layer 3).  \n5. Click OK to exit the MODFLOW Recharge Package  dialog.  \nThe \u201c  RCH Rate\u201d dataset has updated and the view will look like Figure 7. \n \nFigure 7      RCH rate contours  \n6 Transient Model  \nNow look at the recharge package data with a transient model.  \n1. Select File | New and click Don\u2019t Save  at the prompt.  \n2. Click Open   to bring up the Open  dialog.  \n3. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n4. Browse to the data files for this tutorial and select \u201cmf2k_recharge_trans .gpr\u201d. \n5. Click Open  to import the project and close the Open  dialog.  \nThis i s the same MODFLOW model except that it is transient with four stress periods.  \n6. Double -click on the \u201c  RCH\u201d item in the Project Explorer to bring up the \nMODFLOW Recharge Package  dialog.  \nThis model is using the \u201c(2) Recharge at specified vertical cells\u201d opti on. The \u201cRECH. Flux\u201d \nand the \u201cIRCH. Layer indicator\u201d data change with the stress periods.  \n7. Use the arrow  buttons to cycle through the Stress period  to see how the \n\u201cRECH. Flux\u201d data changes in each stress period.  \nNotice that the Use previous  checkbox is ch ecked for the third stress period. This means \nthat the data from stress period 2 is reused in stress period 3 for the \u201cRECH. Flux\u201d.  Also, \nnotice that the Multiplier  is \u201c2.0\u201d in stress period 4 instead of \u201c1.0\u201d. This means that the \nvalues in the \u201cRECH. Flu x\u201d array will be multiplied by 2.0 when MODFLOW runs.   \n\nGMS Tutorials   MODFLOW \u2013 Recharge  \n \n Page 8 of 16 \u00a9 Aquaveo 2024  For transient models with many stress periods it can be difficult to edit the Use previous  \nand the Multiplier  by cycling through the stress periods. All of the Use previous  and \nMultiplier  values can b e edited by selecting the Edit All Use previous/Multipliers  button.  \n8. Click the Edit All Use previous/Multipliers\u2026  button to bring up the Edit All \nUse Previous / Multipliers  dialog.  \nThis dialog displays the Use Previous  and Multiplier  values for each stress period, \nallowing for quick editing of many stress periods. A value of \u201c0\u201d for Use previous  will \nleave the checkbox unchecked while a non -zero value will set the check on.  \n9. Click OK to close the Edit All Use Previous / Multipliers  dialog.  \n10. Change the item in the View/Edit  drop-down list to \u201cIRCH. Layer indicator\u201d.  \n11. Use the arrow  buttons to cycle through the Stress period  to see how the \n\u201cIRCH. Layer indicator\u201d data changes in each stress period.  \n12. Click OK to close the MODFLOW Recharge Package  dialog.  \n6.1 Recharge Dataset  \n1. Select the \u201c  RCH Rate\u201d item in the Project Explorer to change the view ( Figure \n8). \n \nFigure 8      RCH rate contours  \nNotice that cells in different layers are visible because of the options set in the \nMODFL OW Recharge Package  dialog. The Time St eps window  (Figure 9) is available for \nselecting different time steps for the \u201c  RCH Rate\u201d dataset. These time steps \ncorrespond to the MODFLOW stress periods. Notice that the times that are displayed are \nin date/ time format because a reference time has been associated with the MODFLOW \nmodel.  \n\nGMS Tutorials   MODFLOW \u2013 Recharge  \n \n Page 9 of 16 \u00a9 Aquaveo 2024   \nFigure 9       Time Steps window  \n2. Cycle through the times steps by selecting each one in the Time Steps window.  \nNotice that either the recharge rate or the layer assignment changes with each stress \nperiod.  \n6.2 Cell Editing of Recharge  \nWhen the \u201c  RCH Rate\u201d dataset is active it is clear which cells have recharge applied to \nthem for a particular stress period. When a different dataset is active different cel ls may \nbe active than those with the recharge dataset. This can cause some confusion when \nediting the recharge for cells. The clearest way to see which cells have recharge applied \nis to make the \u201c  RCH Rate\u201d dataset active.  \n1. Select the first time step in th e Time Steps window for the \u201c  RCH Rate\u201d \ndataset.  \nThe view will look like Figure 8. \n2. Using the Select Cells   tool, select the cell shown in Figure 10 (IJK: 1,1,2).  \n3. Right -click on the selected cell and select Sources/Sinks  to bring up the \nMODFLOW Sources/Sinks  dialog.  \nNotice that, for row 1 in the Layer  column of the spreadsheet, the value is \u201c<transient>\u201d. \nThe assigned layer varies with time. The layer values for each stress period  can be \nedited via the  button above the drop -down arrow in the cell with the \u201c<transient>\u201d \nvalue.  \n4. Click the  button in the Layer  column or row 1 to open the XY Series Editor  \ndialog.  \n\nGMS Tutorials   MODFLOW \u2013 Recharge  \n \n Page 10 of 16 \u00a9 Aquaveo 2024   \nFigure 10      RCH rate cell to  select  \n5. Enter \u201c1\u201d in the Layer  column on the first row of the spreadsheet.  \n6. Click OK to exit the XY Series Editor  dialog.  \n7. Click OK to exit the MODFLOW Sources/Sinks  dialog.  \nThe visible cells on the grid will change ( Figure 11). \n \nFigure 11      RCH rate c ontours  \nChanging the layer updated the \u201c  RCH Rate\u201d dataset so that a different cell would be \nactive for the first time step of the dataset. This is why the top cell is now visible. In \naddition, because the layer value changed for the first stress period, making it different \nfrom the layer value for the second stress period, the Use previous  option has been \nchanged in the MODFLO W Recharge Package  dialog.  \n8. Double -click on the \u201c  RCH\u201d item in the Project Explorer to bring up the \nMODFLOW Recharge Package  dialog.  \n9. Change the item in the View/Edit  drop-down list to \u201cIRCH. Layer indicator\u201d.  \n10. Click the Edit All Use previous/Multipliers  button to open a Edit All Use \nPrevious / Multipliers  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Recharge  \n \n Page 11 of 16 \u00a9 Aquaveo 2024  Notice that the value for Use Previous  for stress period 2 (row 2) is now \u201c0\u201d. Prior to \nediting the layer for the selected cell this value was \u201c1\u201d.  \n11. Click Cancel  to close the Edit All Use Previou s / Multipliers  dialog.  \n12. Click Cancel  to close the MODFLOW Recharge Package  dialog.  \nRecharge can be edited even if the \u201c  RCH Rate\u201d dataset is not the active dataset.  \n13. Select the \u201c  elevation\u201d item in the Project Explorer.  \n14. Using the Select Cells   tool, sele ct the cell shown in Figure 12 (IJK: 3,3,2).  \n  \nFigure 12      Elevation contours  \n15. Right -click on the selected cell and select Sources/Sinks  to bring up the \nMODFLOW Sources/Sinks  dialog.  \nEven though recharge is not assigned to this cell, GMS allows recharge to be edited \nwhen this cell is selected. Recharge could be assigned to the selec ted cell by editing the \nvalue in the Layer  column.  \n16. Click OK to exit the MODFLOW Sources/Sinks  dialog.  \n7 Conceptual Model  \nUsing the conceptual model to define recharge is shown in various other GMS tutorials. \nHere, the focus will be on how Map\u2192MODFLOW is desi gned to work with recharge.  \n1. Select the File | New command and select Don\u2019t Save  at the prompt.  \n2. Click Open   to bring up the Open  dialog.  \n3. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n4. Browse to the recharge  directory and select \u201cmf2k_recharge_con_mod.gpr\u201d.  \n5. Click Open  to import the project and close the Open  dialog.  \nThe view will look like Figure 13. The active coverage has a single polygon with recharge \nassigned to it. The MODFLOW model currently does not include the recharge package.  \n\nGMS Tutorials   MODFLOW \u2013 Recharge  \n \n Page 12 of 16 \u00a9 Aquaveo 2024   \nFigure 13      Initial vi ew of the project  \n6. Right -click on the \u201c  recharge 1\u201d coverage and select the Map To  | \nMODFLOW/MODPATH  command.  \nNotice in the Project Explorer that the recharge (RCH) package is now part of the \nMODFLOW simulation. The values from the polygon in the coverage have been \ntransferred to the associated cells in the grid. Next, view where the values have been \nassigned.  \n7. Select the \u201c  RCH Rate\u201d item in the Project Explorer.  \nThe view will look like Figure 14. The blue cells have been assigned a value for recharge \nand the red cells have a value of zero. Notice that the cell in the center of the grid was \nassigned a recharge value even though it is only slightly overlapped by the polygon. Each \ncell is given the same recharge value even though the area of overlap with the polygon is \ndifferent for each cell.  \n \n\nGMS Tutorials   MODFLOW \u2013 Recharge  \n \n Page 13 of 16 \u00a9 Aquaveo 2024  Figure 14     Spatial distribution of recharge  \n8. Double -click on the \u201c  RCH\u201d item in  the Project Explorer to bring up the \nMODFLOW Recharge Package  dialog.  \nNotice that the Recharge option (NRCHOP)  is set to \u201c(3) Recharge at highest active cell\u201d. \nIf recharge is not part of the MODFLOW model, and the Map\u2192MODFLOW  command is \nexecuted with a re charge coverage, then the recharge package will be initialized and \nNRCHOP will be set to (3).  \n9. Select OK to exit the MODFLOW Recharge Package  dialog.  \n10. Select \u201c  recharge 2\u201d in the Project Explorer to make it active.  \nThis coverage has two polygons. Notice tha t both polygons overlap with the cell in the \ncenter of the grid.  \n11. Right -click on the \u201c  recharge 2\u201d coverage and select the Map To  | \nMODFLOW/MODPATH  command.  \nThe view will look like Figure 15. The blue cells were assigned recharge from the polygon \non the right and the green cells were assigned recharge from the polygon on the left. The \nred cells have a value of zero assigned. Notice that the center cell is blue. Because the \npolygon on the right has a larger overlapping area, the center cell is associated with the \npolygon on the right.  \n \nFigure 15      RCH rate contours  \n12. Right -click on the \u201c  recharge 1\u201d coverage and select the Map To | \nMODFLOW/MODPATH  command.  \nThe view should look like Figure 14. Notice that the center cell has been assigned a \nvalue from the polygon in the \u201c  recharge 1\u201d coverage. All of the cells that don\u2019t overlap \nwith the \u201c  recharge 1\u201d coverage  have a value of 0.0 assigned. When the \nMap\u2192MODFLOW  command is executed with a recharge coverage, the recharge is \ninitially set to zero and then the values from the pol ygons are applied.  \n13. Right -click on the \u201c  Conceptual Model\u201d item in the Project Explorer and select \nthe Map To  | MODFLOW/MODPATH  command to open the Map \u2192 Model  \ndialog.  \n\nGMS Tutorials   MODFLOW \u2013 Recharge  \n \n Page 14 of 16 \u00a9 Aquaveo 2024  14. Select All applicable coverages  and click OK to close the Map \u2192 Model  dialog.  \nThe view will look like Figure 16. Notice that the center cell is blue and has a value of \n0.0003 assigned. This is because the \u201c  recharge 1\u201d coverage assigned a value of \n0.0001 and the \u201c  recharge 2\u201d coverage added a value of 0.0002. So the final value in \nthe cell is the sum of values from each coverage that was mapped.  \n \nFigure 16      RCH rate contours  \nThe specified layer is n ot assigned using the conceptual model. If the recharge package \nis initialized and the NRCHOP is set to \u201c(2) Recharge at specified vertical cells\u201d then \nGMS will not modify the layer assignments in the recharge package when the \nMap\u2192MODFLOW  command is execut ed. \n8 Model with Parameters  \nThe final topic covered will be parameters in the recharge package. Information on \nparameters in MODFLOW models can be found in other GMS tutorials. This section \nfocuses on how parameters affect visualization of recharge in GMS.  \n1. Select the File | New command and select Don\u2019t Save  at the prompt.  \n2. Click Open   to bring up the Open  dialog.  \n3. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n4. Browse to the data files for this tutorial and select \u201cmf2k_recharge_param.gpr\u201d.  \n5. Click Open  to import the project and close the Open  dialog.  \n6. Switch to Oblique View  . \nThe view will look like Figure 17. The MODFLOW model is transient  and has multiple \nrecharge parameters.  \n\nGMS Tutorials   MODFLOW \u2013 Recharge  \n \n Page 15 of 16 \u00a9 Aquaveo 2024   \nFigure 17      Initial view of project  \n7. Select the \u201c  RCH Rate\u201d  item in the Project Explorer.  \nThe view will look like Figure 18. This shows the recharge values on the grid.  \n \nFigure 18      RCH rate contours  \n8. Cycle through the time steps to view the recharge at the different time steps.  \n9. Double -click on the \u201c  RCH\u201d item in the Project Explorer to bring up the \nMODFLOW Recharge Package  dialog.  \nNotice that the values in the spreadsheet include \u201c -3.0\u201d, \u201c -1.0\u201d, \u201c0.0\u201d, \u201c0.0001\u201d. However, \nin the view of the grid there are values between \u201c0.0\u201d and \u201c0.000 4\u201d. These values come \nfrom defined parameters.  \n10. Click OK to exit the MODFLOW Recharge Package  dialog.  \n11. Select MODFLOW  | Parameters\u2026  to open the Parameters  dialog.  \nNotice there are four recharge parameters. The values displayed on the grid come from \nthe Value  specified in this dialog. The RCH_3 parameter uses the \u201c<Pilot points>\u201d option. \nThis means that the values shown on the grid are interpolated from an associated scatter \npoint set.  \n12. Click OK to exit the Parameters  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Recharge  \n \n Page 16 of 16 \u00a9 Aquaveo 2024  13. Right -click the \u201c  RCH Rate\u201d item in the Project Explorer and select the Display \nKey Values  command.  \nThe view will change to be like Figure 19. Notice that the values dis played now include \nthe negative numbers from the MODFLOW Recharge Package  dialog. Cycle through the \ntime steps to see the recharge parameter key values in different stress periods.  \n \nFigure 19      RCH Rate Contours of parameter ke y values  \nMODFLOW supports a more complicated way to define recharge parameters using \nclusters. This is supported in GMS but it cannot be visualized. For more information \nabout these types of parameters see the tutorial \u201cMODFLOW \u2013 Advanced Parameter \nOptions\u201d.  \n9 Conclusion  \nThis concludes the \u201cMODFLOW  \u2013 Recharge\u201d  tutorial. The following key topics were \ndiscussed and demonstrated:  \n\uf0b7 Recharge package inputs.  \n\uf0b7 How to visualize the data in the Recharge Package.  \n\uf0b7 The effect of IBOUND on recharge.  \n\uf0b7 The effect of the  specified layer option on recharge.  \n\uf0b7 How the Map\u2192MODFLOW  command works with recharge.  \n\uf0b7 How parameters affect the display of recharge.  \n \n\n", "filename": "MODFLOW-Recharge.pdf", "pages": 16}, "MODFLOW-RegionalToLocalSs": {"text": "GMS Tuto rials  MODFLOW \u2013 Regional to Local Model Conversion, Steady -State  \n Page 1 of 14 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Regional -to-Local Model Conversion, Steady -\nState  \nCreate a local model from a regional model using convenient tools  \n \nObjectives   \nThis tutorial will use the convenient tools provided in GMS to perform the steps involved in a typical \nregional -to-local model conversion. This tutorial uses a steady -state model. A transient example is \nprovided in the \u201cMODFLOW \u2013 Regional -to-Local Model Conversion, Transient\u201d tutorial.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2012 Conceptual \nModel Approach II  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 Geostatistics  \n\uf0b7 MODFLOW Interface  \n\uf0b7 MODAEM  \n Time  \n\uf0b7 25\u201340 minutes  \n \nGMS 10. 8 \n\nGMS Tuto rials  MODFLOW \u2013 Regional to Local Model Conversion, Steady -State  \n Page 2 of 14 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Outline  ................................ ................................ ................................ ..........................  3 \n1.2 Getting Started  ................................ ................................ ................................ ..............  4 \n2 Importing the Regional Model  ................................ ................................ ............................  4 \n3 Converting the Layer Data to a Scatter Point Set  ................................ .............................  5 \n4 Building the Local Conceptual Model  ................................ ................................ ................  6 \n4.1 Creating a New Coverage  ................................ ................................ ............................  6 \n4.2 Creating the Boundary Arcs and the Polygon  ................................ ...............................  6 \n4.3 Marking the Specified Head Arcs  ................................ ................................ ..................  7 \n5 Creating the Local MODFLOW Model  ................................ ................................ ................  8 \n5.1 Creating the Grid  ................................ ................................ ................................ ..........  8 \n5.2 Activating the Cells  ................................ ................................ ................................ ....... 9 \n5.3 Mapping the Properties  ................................ ................................ ...............................  10 \n5.4 Interpolating the Layer Data  ................................ ................................ .......................  10 \n5.5 Saving and Running the Local Model  ................................ ................................ .........  10 \n6 MODAEM Regional Model  ................................ ................................ ................................ . 11 \n6.1 Saving MODAEM  ................................ ................................ ................................ ........  12 \n6.2 Adjusting the Coverage Setup  ................................ ................................ ....................  12 \n6.3 Running the Local Model  ................................ ................................ ............................  13 \n7 Conclusion  ................................ ................................ ................................ .........................  14 \n \n1 Introduction  \nFor many modeling studies, determining an appropriate set of boundary conditions can \nbe difficult. It is often the case that classical boundaries such as rock outcroppings, rivers, \nlakes, and groundwater divides, may be located at a great distance from the  site of \ninterest. In such cases, it is often convenient to perform the modeling study in two \nphases.  \nIn the first phase, a large, regional -scale model is constructed, and the model is extended \nto well -defined boundaries. During the second stage, a second , smaller, local -scale \nmodel is constructed that occupies a small area within the regional model. The \ngroundwater elevations computed from the regional model are applied as specified head \nboundary conditions to the local -scale model.  \nThe layer data, inclu ding elevations and transmissivities, are also interpolated from the \nregional to the local model. A more detailed representation of the local -flow conditions, \nincluding low -capacity wells and barriers not included in the regional flow model can be \nconstruc ted in the local -scale model. Regional -to-local model conversion is often referred \nto as \u201ctelescopic grid refinement\".  \nGMS provides a convenient set of tools that can be used for regional -to-local model \nconversion. This tutorial describes the steps involve d in a typical regional -to-local model \nconversion using MODFLOW.  \nThe site modeled in this tutorial is shown in Figure 1. The main features of the regional \nmodel are shown. Most of the boundaries are no -flow boundaries corresponding to \ngroundwater -flow divides, bedrock outcroppings, and natural flow boundaries. A river \nruns through the left side of the model. The narrow regions where the river enters and \nexits the mode l are modeled as specified head boundaries. There are four major \nproduction wells in the region. The site will be modeled using two layers: a lower confined \nlayer and an upper unconfined layer.  \nThe local site is situated in the interior of the model. The l ocal site corresponds to a \nchemical plant with a small spill. Once the regional model is completed, a local -scale \nmodel is to be developed and then used to analyze a number of injection/extraction well \nplacement scenarios. The wells are part of a treatment  system that is being designed.  \nGMS Tutorials   MODFLOW \u2013 Regional to Local Model Conversion, Steady -State  \n \n Page 3 of 14 \u00a9 Aquaveo 2024  \nWells\nLocal Site BoundaryRiverFixed\nHead\nBoundary\nFixed\nHead\nBoundary \n      Figure 1      Regional model  \nThe basic goal of the regional -to-local model conversion process is to create a 2D scatter \npoint  set containing the heads and layer data arrays from the regional model, create the \nlocal model, and interpolate the heads and layer data to the local model. A 2D scatter \npoint set is used since the MODFLOW arrays should be interpolated on a layer -by-layer  \nbasis using 2D interpolation. GMS provides a set of tools that greatly simplify this \nprocess. The basic steps are as follows:  \n1. Generate the regional model and compute a solution.  \n2. Use the MODFLOW Layers \u2192 2D Scatter Points \u2026 command to create the \nscatter poi nt set with the layer and head data from the regional model.  \n3. Create the 3D grid for the local -scale model.  \n4. Interpolate the heads and layer data values from the scatter points to the \nMODFLOW layer arrays for the local -scale model.  \n5. Each of these steps will b e described in more detail below.  \n1.1 Outline  \nThis tutorial will demonstrate and discuss the following:  \n1. Opening a regional conceptual model.  \n2. Converting the layer data to a scatter point set.  \n3. Building a local conceptual model and mapping it to a 3D grid.  \n4. Mapping the conceptual model to a MODFLOW simulation.  \n5. Interpolating the layer data.  \n6. Running MODFLOW.  \n7. Running MODAEM.  \n8. Using the MODAEM head instead of the specified head, and rerunning \nMODFLOW.  \nGMS Tutorials   MODFLOW \u2013 Regional to Local Model Conversion, Steady -State  \n \n Page 4 of 14 \u00a9 Aquaveo 2024  1.2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state. Click Don\u2019t Save if asked to save changes.  \n2 Importing the Regional Model  \nThe first step in the model conversion process is to build a regional model. Since the \nfocus of this tutorial is primarily on the conversion process, a previously -constructed \nmodel will be imported.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the reg2loc_ss \\reg2loc_ss  directory and select \u201cregmod.gpr\u201d.  \n4. Click Open  to import the project and close the Open  dialog . \nThe top layer of the two -layer model is now being viewed ( Figure 2). The arrow buttons in \nthe Mini-Grid Toolbar  can be used to view the bottom layer. The wells are located in the \nbottom layer. When finished, return to the top layer.  \nThis model was constructed using the concep tual model approach. The boundary of the \nlocal site is indicated with a red rectangle. The conceptual model consists of three \ncoverages. The coverage being viewed is for the sources and sinks. There is also a \ncoverage defining recharge zones and a coverage  defining hydraulic conductivity zones \nfor the top layer. The imported project includes the solution for the regional model with \nvisible contours of computed head.  \n \nFigure 2      The initial view of the project  \n\nGMS Tutorials   MODFLOW \u2013 Regional to Local Model Conversion, Steady -State  \n \n Page 5 of 14 \u00a9 Aquaveo 2024  3 Converting the Laye r Data to a Scatter Point Set  \nThe first step in converting the regional model to a local model is to convert the \nMODFLOW layer data to a 2D scatter point set.  \n1. Select the \u201c  3D Grid Data\u201d folder in the Project Explorer to make it active.  \n2. Select Grid | MODFLOW Layers \u2192 2D Scatter Points\u2026  to bring up the \nMODFLOW Layers \u2192 Scatter Points  dialog.  \n3. Enter \u201cRegional Data\u201d as the Scatter point set name . \n4. In the Datasets  section, turn on Layer elevations  and Computed heads . \n5. Click Select Dataset\u2026  under Computed head s to bring up the Select Dataset  \ndialog.  \n6. Select the \u201cHead\u201d dataset under the \u201c  regmod (MODFLOW)\u201d solution.  \n7. Click OK to exit the Select Dataset  dialog.  \n8. Click OK to exit the MODFLOW Layers \u2192 Scatter Points  dialog.  \nA set of scatter points should appear at th e location of the cell centroids ( Figure 3). This \nscatter point set has a dataset for the computed heads and for the top and bottom \nelevations of the model layers.  \n \n      Figure 3      The layer data converted to scatter points  \n\nGMS Tutorials   MODFLOW \u2013 Regional to Local Model Conversion, Steady -State  \n \n Page 6 of 14 \u00a9 Aquaveo 2024  4 Building the Local Conceptual Model  \nThere are numerous approaches to building the local model. A common approach is to \nmark the boundaries of the local model as specified head boundaries using the computed \nhead values from the regional model. The following method accomplishes this objective:  \nA rectangular grid is constructed where two opposite boundaries are parallel to head \ncontours from the regional mod el (i.e., a constant head value along each boundary). The \nother two boundaries are no -flow boundaries and are perpendicular to the head contours \nfrom the regional model.  \nThe simplest way to build the local model is to create a conceptual model in the Map \nmodule. To do this, create a new conceptual model:  \n1. Expand the \u201c  Map Data\u201d folder in the Project Explorer.  \n2. Right -click on the \u201c  Regional Model\u201d item and select Duplicate to create a new \n\u201c Regional Model (2)\u201d item.  \n3. Right -click on \u201c  Regional Model (2)\u201d and  select Properties\u2026 to bring up the \nConceptual Model Properties  dialog.  \n4. Enter \u201cLocal Model\u201d as the Name . \n5. Click OK to close the Conceptual Model Properties  dialog . \n4.1 Creating a New Coverage  \nNext, to create a new source/sink coverage:  \n1. Expand the \u201c  Local Model\u201d, right -click on the \u201c  ss\u201d coverage, and select \nDelete . \n2. Right -click on \u201c  Local Model\u201d  and select New Coverage\u2026  to bring up the \nCoverage Setup  dialog.  \n3. Enter \u201clocal ss\u201d as the Coverage name . \n4. In the Sources/Sinks/BCs  column, turn on Layer Range  and Specified Head \n(CHD) . \n5. Change the Default layer range  to be \u201c1\u201d to \u201c2\u201d.  \n6. Click OK to close the Coverage Setup  dialog.  \nIn this tutorial, the recharge and hydraulic conductivity coverages will be used to \nconstruct the local model. While the boundaries of the coverages are larger than \nthey generally need to be, it is not necessary to change them here . \n4.2 Creating the Boundary Arcs and the Polygon  \n1. Use the Zoom   tool to drag a box around the local site boundary (the red \nrectangle).  \n2. Select the \u201c  local ss\u201d cover age in the Project Explorer to make it the active \ncoverage.  \nNow create the boundaries as follows:  \n\nGMS Tutorials   MODFLOW \u2013 Regional to Local Model Conversion, Steady -State  \n \n Page 7 of 14 \u00a9 Aquaveo 2024  3. Using the Create Arc   tool, create four arcs, two parallel to the contours, and \ntwo perpendicular to the contours as shown in Figure 4. Double -click on the \ncorners to end e ach arc.  \nThere should be a node at each corner and two vertices on each arc.  \n \n      Figure 4      Boundary arcs to be created  \nUse the arcs to build a polygon defining the model domain.  \n4. Click Build Polygons   to create a polygon from the arcs. The polygon is \nindicated by the area within the arcs changing to a light gray ( Figure 5). \n \n      Figure 5      The polygon created from the boundary arcs  \n4.3 Marking the Specified Head Arcs  \nThe specified head boundaries need to be marked next:  \n\nGMS Tutorials   MODFLOW \u2013 Regional to Local Model Conversion, Steady -State  \n \n Page 8 of 14 \u00a9 Aquaveo 2024  1. Using the Select Arcs   tool while pressing the Shift key, select the arcs on the \nleft and right sides of the model.  \n2. Click Properties   to open the Attribute Table dialog.  \n3. In the All row of the spreadsheet, select \u201cspec. head (CHD)\u201d from the Type  drop-\ndown. This sets both arcs a s specified head arcs.  \n4. Click OK to close the Attribute Table  dialog.  \nAt this point, select the nodes of the specified head arcs and assign a head value.  \n5. Using the Select Points \\Nodes   tool, select the two nodes on the left side of \nthe model by holding dow n the Shift key. \n6. Click Properties   to open the Attribute Table dialog.  \n7. In the Head -Stage  (ft) column, enter a head value of \u201c1050.0\u201d for the spec. head \n(CHD)  rows for each node.  \n8. Click OK to close the Attribute Table  dialog.  \nRepeat steps 5 \u20138 for the two no des on the right side of the model but assign a spec. \nhead (CHD)  value of \u201c1100.0\u201d.  \n5 Creating the Local MODFLOW Model  \nIt is now possible to convert the conceptual model to a grid model. The first step in this \nprocess is to create a new grid frame that fits the local model.  \n1. In the Project Explorer,  right-click on the empty space and select New | Grid \nFrame  to create a new grid frame.  \n2. Right -click on \u201c  Grid Frame\u201d in the Project Explorer and select Fit to Active \nCoverage .  \n3. If desired, use the Grid Frame   tool to position the grid frame to better match \nthe local grid boundary ( Figure 6).  \n \n      Figure 6      Grid frame encomp assing the active coverage  \n5.1 Creating the Grid  \nNext, to create the grid:  \n\nGMS Tutorials   MODFLOW \u2013 Regional to Local Model Conversion, Steady -State  \n \n Page 9 of 14 \u00a9 Aquaveo 2024  1. In the Project Explorer, right -click on the \u201c  Grid Frame\u201d and select Map To | 3D \nGrid to bring up the Create Finite Difference Grid  dialog.  \n2. Click OK to confirm deletion of the existing grid.  \n3. Click OK to confirm deletion of the current MODFLOW and MODPATH data.  \n4. In the X-Dimension  section, enter \u201c60\u201d for the Number cells . \n5. In the Y-Dimension  section, enter \u201c50\u201d for the Number cells . \n6. In the Z-Dimension  section, enter \u201c2\u201d for the Number cells.  \n7. Click OK to create the grid and close the Create Finite Difference Grid  dialog.  \nA grid will appear ( Figure 7).  \n8. Using the Zoom   tool, drag a box around the grid to zoom in to just the grid \narea.  \n \n      Figure 7      The finite difference grid  \n5.2 Activating the Cells  \nNext, to inactivate the exterior cells:  \n1. Select the \u201c  3D Grid Data\u201d folder in the Project Explorer to make it active.  \n2. Select MODFLOW  | New Simulation\u2026  to bring up the MODFLOW Global/Basic \nPackage  dialog.  \n3. Click OK to accept the defaults and close the MODFLOW Global/Basic Package  \ndialog.  \n4. Select the \u201c  Map Data \u201d folder in the Project Explorer to make it active . \n5. Select Feature Objects  | Activate Cells in Coverage(s) .  \nIf the arcs match the grid boundary closely, there may not be any cells inactivated. If the \ngrid extends significantly beyond the arcs, some cells will be inactivated.  \n\nGMS Tutorials   MODFLOW \u2013 Regional to Local Model Conversion, Steady -State  \n \n Page 10 of 14 \u00a9 Aquaveo 2024  5.3 Mapping the Properties  \nNext, to convert the MODFLOW data to the grid:  \n1. Right -click on the \u201c  Local Model\u201d conceptual model in the Project Explorer and \nselect Map To | MODFLOW/MODPATH  to bring up the Map \u2192 Model  dialog.  \n2. Select All applic able coverages  and click OK to close the Map \u2192 Model  dialog.  \nNote: At this point, the local -scale model does not include the wells involved in the pump -\nand-treat system. These could be added at a later time.  \n5.4 Interpolating the Layer Data  \nThe final step in the conversion process is to interpolate the regional data from the \nscatter points to the MODFLOW layer arrays.  \n3. Right -click on the \u201c  Regional Data\u201d scatter set in the Project Explorer and \nselect Interpolate To | MODFLOW Layers\u2026  to bring up the Interpolate  to \nMODFLOW Layers  dialog.  \n4. Click OK to accept the defaults and close the Interpolate to MODFLOW Layers  \ndialog.  \n5. Turn off \u201c  2D Scatter Data\u201d folder to make it easier to see the other information \n(Figure 8). \n \n      Figure 8      After the scatter point set is turned off  \n5.5 Saving and Running the Local Model  \nIt is now possible to save the MODFLOW model and run the simulati on. \n1. Select the \u201c  3D Grid Data\u201d folder in the Project Explorer to make it active.  \n2. Select File | Save As\u2026  to bring up the Save As  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Regional to Local Model Conversion, Steady -State  \n \n Page 11 of 14 \u00a9 Aquaveo 2024  3. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n4. Enter \u201clocmod.gpr\u201d as the File name . \n5. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n6. Select MODFLOW  | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n7. When the simulation is finished, turn on Read solution on exit  and Turn on \ncontours (if not on already) . \n8. Click  Close  to close the MODFLOW  model wrapper dialog.  \n9. Zoom   in the local model to see the contour lines within it.  \nA set of head contours, closely resembling the head contours from the regional model, \nare now visible ( Figure 9). At this point, the local -flow model is complete, and the injection \nand extraction wells could be added for the pump -and-treatment simulations.  \n \n      Figure 9      The local model showing contour lines  \n6 MODAEM Regional Model  \nA regional MODAEM model can also be used to create a local MODFLOW model. For a \nmore detailed description of MODAEM see the \u201c MODAEM \u201d tutorial. Instead of using a \nspecified head  boundary in the \u201c  local ss \u201d coverage to assign heads to the MODFLOW \nmodel, use a MODAEM head  boundary. A MODAEM head  boundary condition is linked \nto a MODAEM conceptual model.  \nWhen the Map \u2192 MODFLOW  command is selected, the locations of all of the cells  \nassociated with the MODAEM head  boundary are found. Then a MODAEM model runs in \nthe background and computes the head at the cell locations. MODAEM also computes \nthe flow across the MODAEM head  boundary. The MODAEM head  boundary not only \nassigns heads to t he MODFLOW model, but it also creates a flow observation.  \n\nGMS Tutorials   MODFLOW \u2013 Regional to Local Model Conversion, Steady -State  \n \n Page 12 of 14 \u00a9 Aquaveo 2024  6.1 Saving MODAEM  \nNotice that there is now a \u201c  Reg MODAEM\u201d conceptual model in the \u201c  Map Data\u201d \nfolder in the Project Explorer. The next step is to run the MODAEM model to see the \nhead contours.  \n1. Expand  the \u201c  Reg MODAEM\u201d conceptual model in the Project Explorer and \nselect the \u201c  ss\u201d coverage within it to make it the active coverage.  \n2. Click Run MODAEM    to bring up the MODAEM  model wrapper dialog. This \nruns the MODAEM model for the \u201c  Reg MODAEM\u201d concept ual model.  \n3. When MODAEM is finished running, click Close  to exit the MODAEM  model \nwrapper dialog.  \nThe head contours from the \u201c  Reg MODAEM\u201d conceptual model should now be visible \n(Figure 10). \n \n      Figure 10      Local model after MODAEM run  \n6.2 Adjusting the Coverage Setup  \nNow to change the \u201clocal ss\u201d coverage of the \u201cLocal Model\u201d conceptual model to use a \nMODAEM head boundary instead of a specified head boundary:  \n1. Expand the \u201c  Local Model\u201d conceptual model and select the \u201c  local ss\u201d \ncoverage to make it active.  \n2. Double -click on the \u201c  local ss\u201d coverage to bring up the Coverage Setup  \ndialog.  \n3. In the Sources/Sinks/BCs  column, turn  on MODAEM head . \n4. Select \u201cReg MODAEM\u201d from the MODAEM models  drop-down.  \n5. Click OK to exit the Coverage Setup  dialog.  \n6. While holding down the Shift key, use the Select Arcs   tool to select the two \nspecified head arcs (the arcs on the left and right sides).  \n\nGMS Tutorials   MODFLOW \u2013 Regional to Local Model Conversion, Steady -State  \n \n Page 13 of 14 \u00a9 Aquaveo 2024  7. Click Properties   to open the Attribute Table dialog.  \n8. In the Type  column on the All row, select \u201cMODAEM head\u201d from the drop -down.  \n9. Click OK to exit the Attribute Table  dialog.  \n6.3 Running the Local Model  \nIt is now possible to convert the local conceptual model to the 3D grid.  \n1. Right -click on the \u201c  Local Model\u201d conceptual model in the Project Explorer and \nselect Map To | MODFLOW/MODPATH  to bring up the Map \u2192 Model  dialog.  \n2. Select All applicable coverages  and click OK to close the Map \u2192 Model  dialog.  \n3. Select File | Save As\u2026  to bring up the Save As  dialog.  \n4. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n5. Enter \u201clocmod2.gpr\u201d as the File name . \n6. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n7. Select the \u201c  3D Grid Data\u201d folder in the Project Explorer.  \n8. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n9. When the model finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n10. Click Close  to exit the MODFLOW  model  wrapper dialog.  \nA set of head contours similar to the head contours from the regional model should now \nbe visible ( Figure 11). The head contours from the regional MODAEM model are slightly \ndifferent from the MODFLOW regional model, so the sides of the local -flow model that \nshould represent parallel flow are most likely not perpendicular to the head contours from \nthe MODAEM regional model. For this reaso n, the head contours do not match as well as \nthey did for the conversion from the MODFLOW regional model.  \n \n      Figure 11      The local head contours are similar to the regional head contours  \n\nGMS Tutorials   MODFLOW \u2013 Regional to Local Model Conversion, Steady -State  \n \n Page 14 of 14 \u00a9 Aquaveo 2024  7 Conclusion  \nThis concludes the \u201cMODFL OW \u2013 Regional -to-Local Model Conversion , Steady -State\u201d  \ntutorial. The following key concepts were discussed and demonstrated:  \n\uf0b7 The Grid | MODFLOW Layers \u2192 2D Scatter Points \u2026 command converts the \nMODFLOW elevation data into scatter points.  \n\uf0b7 The basic steps for  doing regional -to-local model conversion in GMS are:  \n1. Generate the regional model and compute a solution.  \n2. Use the MODFLOW Layers \u2192 2D Scatter Points \u2026 command to create the \nscatter point set with the layer and head data from the regional model.  \n3. Create the 3 D grid for the local -scale model.  \n4. Interpolate the heads and layer data values from the scatter points to the \nMODFLOW layer arrays for the local -scale model.  \n\uf0b7 A local MODFLOW model can be constructed from a regional MODAEM model.  \n \n", "filename": "MODFLOW-RegionalToLocalSs.pdf", "pages": 14}, "MODFLOW-RegionalToLocalTrans": {"text": "GMS Tutorials   MODFLOW \u2013 Regional -to-Local Model Conversion, Transient  \n Page 1 of 11 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Regional -to-Local Model Conversion, \nTransient  \nCreate a local model from a regional model using convenient tools \nprovided in GMS  \n \nObjectives   \nThis tutorial instructs on how to use the convenient tools provided in GMS to perform the steps involved in \na typical regional -to-local model conversion. This tutorial uses a transient model. A steady -state example \nis provided in the \u201cMODFLOW \u2013 Regional -to-Local Model Conversion, Steady -State\u201d tutorial.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2012 Regional -to-\nLocal Model Conversion, \nSteady -State.  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 Geostatistics  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 20\u201335 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   MODFLOW \u2013 Regional -to-Local Model Conversion, Transient  \n Page 2 of 11 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Importing the Regional Model  ................................ ................................ ............................  2 \n3 Converting the Layer Data to a Scatter Point Set  ................................ .............................  3 \n4 Building the Local Conceptual Model  ................................ ................................ ................  5 \n4.1 Creating a New Coverage  ................................ ................................ ............................  5 \n4.2 Creating the Boundary Arcs and Building the Polygon  ................................ .................  5 \n4.3 Marking the Specified Head Arcs  ................................ ................................ ..................  6 \n5 Creating the Local MODFLOW Model  ................................ ................................ ................  7 \n5.1 Creating the Grid  ................................ ................................ ................................ ..........  7 \n5.2 Creating a New MODFLOW Model  ................................ ................................ ...............  8 \n5.3 Inactivating Cells  ................................ ................................ ................................ ...........  8 \n5.4 Mapping the Properties  ................................ ................................ ................................ . 9 \n6 Interpolating the Layer Data  ................................ ................................ .............................  10 \n7 Saving and Running the Local Model  ................................ ................................ ..............  10 \n8 Conclusion  ................................ ................................ ................................ .........................  11 \n \n1 Introduction  \nThe \u201c MODFLOW \u2013 Regional -to-Local Model Conversion , Steady -State \u201d tutorial describes \nthe basic regional -to-local conversion methods. That tutorial should be completed prior to \nstarting this one. This tutorial uses the same model as the one in the steady -state tutorial \nwith the exception that the model is transient. The background information and model \ndescription hav e been omitted from this tutorial because they can be found in the steady -\nstate tutorial.  \nThis tutorial will discuss and demonstrate importing a regional conceptual model and \nconverting the layer data to a scatter point set. A local conceptual model and a 3D grid \nwill be created, the conceptual model will be mapped to a MODFLOW simulation, the \nlayer data interpolated, and a MODFLOW model executed.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select the File | New command to ensure that the \nprogram settings are restored to their default state. Click Don\u2019t Save  if asked to \nsave changes.  \n2 Importing the Regional Model  \nThe first step in the model conversion process is to b uild a regional model. Since the \nfocus of this tutorial is primarily on the conversion process, a previously constructed \nmodel will be imported.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Brow se to the reg2loc \\reg2loc  directory and select \u201cregmod.gpr\u201d.  \n4. Click Open  to import the project and exit the Open  dialog.  \nThe bottom layer (layer 2) of the two -layer model is now being viewed ( Figure 1). The \nwells are located in the bottom layer. When finished viewing the bottom layer, use the \n\nGMS Tutorials   MODFLOW \u2013 Regional -to-Local Model Conversion, Transient  \n \n Page 3 of 11 \u00a9 Aquaveo 2024  arrow buttons in the Mini-Grid Toolbar   to go to the top layer \n(layer 1).  \nThis model was construc ted using the conceptual model approach. The boundary of the \nlocal site is indicated with a red rectangle. The imported project includes the solution for \nthe regional model. Contours of computed head should be visible.  \n \n     Figure 1      The initial project, showing the wells on layer 2  \n3 Converting the Layer Data to a Scatter Point Set  \nThe first step in converting the regional model to a local model is to convert the \nMODFLOW layer data to a 2D scatter point set.  \n1. Select the \u201c  3D Gr id Data\u201d folder in the Project Explorer to make it active.  \n2. Select Grid | MODFLOW Layers \u2192 2D Scatter Points\u2026  to open the \nMODFLOW Layers \u2192 Scatter Points dialog.  \n3. Enter \u201cRegional Data\u201d as the Scatter point set name . \n4. Turn on Only create scatter points within selected coverage . \n5. Click Select Coverage \u2026 to bring up the Select Coverage  dialog.  \n6. Expand \u201c  Regional Model\u201d and select the \u201c  Scatter Points\u201d coverage.  \n7. Click OK to close the Select Coverage  dialog.  \n8. In the Datasets  section, turn on Layer elevations , Flow package properties , \nRecharge , and Computed heads . \n\nGMS Tutorials   MODFLOW \u2013 Regional -to-Local Model Conversion, Transient  \n \n Page 4 of 11 \u00a9 Aquaveo 2024  9. Click Select Dataset \u2026  under Computed heads  to bring up the Select Dataset \ndialog.  \n10. Select the \u201c  Head\u201d dataset under \u201c  regmod (MODFLOW)\u201d.  \n11. Click OK to close the Select Dataset  dialog.  \n12. In the spreadsheet in the Layer subdivision  section, enter \u201c2\u201d and \u201c3\u201d in the \nNumber of local model layers  column for grid layers 1 and 2, respectively.  \n13. At the bottom of the Layer subdivision section, turn on Bias thickness of new top \nlayer . \nThe dialog sho uld now look like Figure 2. \n \n      Figure 2      MODFLOW Layers \u2192 Scatter Points dialog  \n14. Click OK to exit the MODFLOW Layers \u2192 Scatter Points  dialog.  \nA set of scatter points should appear at the location of the cell centroids in the local site \n(Figure 3). This scatter point set has a dataset for the computed heads, recharge, \nhydraulic conductivity, and the top and bottom elevations of the model layers.  \n\nGMS Tutorials   MODFLOW \u2013 Regional -to-Local Model Conversion, Transient  \n \n Page 5 of 11 \u00a9 Aquaveo 2024   \n      Figure 3      Scatter points in the local site on layer 1  \n4 Building the Local Conceptual Mode l \nThe simplest way to build the local model is to create a conceptual model in the Map \nmodule. To do this:  \n1. Right -click on \u201c  Map Data\u201d in the Project Explorer and select New Conceptual \nModel\u2026  to bring up the Conceptual Model Properties  dialog.  \n2. Enter \u201cLocal  Model\u201d as the Name . \n3. Click OK to close the Conceptual Model Properties  dialog.  \n4.1 Creating a New Coverage  \nNext to create a new source/sink coverage under the new \u201cLocal Model\u201d:  \n1. Right -click on \u201c  Local Model\u201d and select New Coverage\u2026  to open the \nCoverage Setup dialog.  \n2. Enter \u201clocal ss\u201d as the Coverage name . \n3. In the Sources/Sinks/BCs  column, turn on Layer range  and Specified Head \n(CHD).  \n4. Change the Default layer range  to be \u201c1\u201d to \u201c5\u201d.  \nClick OK to close the Coverage Setup  dialog.  \n4.2 Creating the Boundary  Arcs and Building the Polygon  \nNext to create the boundary arcs:  \n\nGMS Tutorials   MODFLOW \u2013 Regional -to-Local Model Conversion, Transient  \n \n Page 6 of 11 \u00a9 Aquaveo 2024  1. Using the Zoom   tool, drag a box around the local site boundary (the red \nrectangle).  \n2. Select \u201c  local ss\u201d under \u201c  Local Model\u201d in the Project Explorer to make it \nactive.  \n3. Using the Create Arc  tool, create a single arc forming a rectangle directly on \ntop of the red rectangle ( Figure 4). If the red rectangle isn\u2019t visible, turn on \u201c\nAnnotation Data\u201d in the Project Explorer.  \n \n      Figure 4      Arc created on boundary of local model, layer 2  \nNext to build a polygon defining the model domain:  \n4. Select Feature Objects | Build Polygons  to create a polygon ( Figure 5). \n \n      Figure 5      The polygon created from the arc, when selected  \n4.3 Marking the Specified Head Arcs  \nThe next step is to mark the specified head boundaries.  \n1. Using the Select Arcs  tool, select the boundary arc of the model.  \n2. Click Properties   to open the Attribute Table dialog.  \n3. In the Type  column, select \u201cspec. head (CHD)\u201d from the drop -down.  \n4. Click OK to close the Attribute  Table  dialog.  \n \n\nGMS Tutorials   MODFLOW \u2013 Regional -to-Local Model Conversion, Transient  \n \n Page 7 of 11 \u00a9 Aquaveo 2024  5 Creating the Local MODFLOW Model  \nIt is now possible to convert the conceptual model to a grid model. The first step is to \ncreate a new grid frame that fits the local model.  \n1. In the Project Explorer,  right-click on the empty space and select New | Grid \nFrame . \n2. Right -click on the \u201c  Grid Frame\u201d and select Fit to Active Coverage .  \nThe grid frame will reduce in size to just outside the red rectangle.  \nIf desired, use the Grid Frame   tool to position the grid frame to better match the local \ngrid bo undary.  \n5.1 Creating the Grid  \nNext, to create the grid:  \n1. Right -click on \u201c  Grid Frame\u201d in the Project Explorer and select Map To | 3D \nGrid to bring up the Create Finite Difference Grid  dialog.  \n2. Click OK at the prompt to delete the existing grid.  \n3. Click OK at the prompt to delete all current MODFLOW and MODPATH data.  \n4. In the X-Dimension  section, enter \u201c60\u201d for the Number cells . \n5. In the Y-Dimension  section, enter \u201c40\u201d for the Number cells . \n6. In the Z-Dimension  section, enter \u201c5\u201d for the Number cells . \n7. Click OK to create the grid and close the Create Finite Difference Grid  dialog.  \n8. Zoom   in on the newly -created grid. The view should be similar to The new \nlocal grid image . \n \n      Figure 6      The new local grid  \n\nGMS Tutorials   MODFLOW \u2013 Regional -to-Local Model Conversion, Transient  \n \n Page 8 of 11 \u00a9 Aquaveo 2024  5.2 Creating a New MODFLOW Model  \nNow create the new MODFLOW simulation by doing the following:  \n1. Select the \u201c  3D Grid Data\u201d folder in the Project Explorer to make it active.  \n2. Select MODFLOW  | New Simulation\u2026  to bring up the MODFLOW Global/Basic \nPackage  dialog.  \n3. Click Packages\u2026  to bring up the MODFLOW Packages / Processes  dialog.  \n4. In the Optional packages / processes  section, turn on CHD1 \u2013 Time -Variant \nSpecified -Head and RCH1 - Recharge . \n5. Select OK to close the MODFLOW Packages / Processes  dialog and return to \nthe MODFLOW Global/Basic Package  dialog. \n6. In the Model type  section, select Transient.  \n7. Click Stress Periods\u2026  to bring up the Stress Periods  dialog.  \n8. Enter \u201c7\u201d as the Number of stress periods . \n9. Turn on Use dates/times . \n10. From the following table, enter the times and number of time steps for the stress \nperiods:  \n Start  Num Time Steps  \n1 4/15/1991 12:00:00 AM  3 \n2 4/20/1991 12:00:00 AM  4 \n3 4/30/1991 12:00:00 AM  6 \n4 5/20/1991 12:00:00 AM  10 \n5 7/19/1991 12:00:00 AM  20 \n6 10/17/1991 12:00:00 AM  30 \n7 4/15/1992 12:00:00 AM  40 \nEnd 12/1/1993 12:00:00 AM  \n \n11. Click OK to exit the Stress Periods  dialog.  \n12. Click OK to exit the MODFLOW Global/Basic  Package  dialog.  \n5.3 Inactivating Cells  \n1. Select the \u201c  Map Data\u201d folder in the Project Explorer to make it active . \n2. Select Feature Objects  | Activate Cells in Coverage(s) .  \nIf the arcs match the grid boundary closely, there may not be any cells inactivated. If the \ngrid (purple) extends significantly beyond the boundary arc (red), some cells between \nthem will be inactivated ( Figure 7). \n\nGMS Tutorials   MODFLOW \u2013 Regional -to-Local Model Conversion, Transient  \n \n Page 9 of 11 \u00a9 Aquaveo 2024   \n      Figure 7      Cells inactivated between the grid frame and coverage boundary arc  \n5.4 Mapping the Properties  \nNext to convert the MODFLOW data to the grid:  \n1. Right -click on the \u201c  Local Model\u201d conceptual model in the Project Explorer and \nselect Map To | MODFLOW/MODPATH  to bring up the Map \u2192 Model  dialog.  \n2. Select All applicable coverages  and click OK to close the Map \u2192 Model  dialog.  \nThe MODFLOW data will appear around the edges of the grid ( Figure 8). \n \n      Figure 8      The MODFLOW data mapped to the grid (right next to the red boundary)  \n\nGMS Tutorials   MODFLOW \u2013 Regional -to-Local Model Conversion, Transient  \n \n Page 10 of 11 \u00a9 Aquaveo 2024  6 Interpolating the Layer Data  \nThe final step in the conversion process is to interpolate the regional data from the \nscatter points to the MODFLOW layer arrays.  \n1. Right -click on the \u201c  Regional Data\u201d  scatter set in the Project Explorer and \nselect Interpolate To | MODFLOW Layers\u2026  to open the Interpolate to \nMODFLOW Layers dialog.  \n2. In the MODFLOW data  section, turn on Flow package data , Recharge , and CHD \nBCs. \n3. Click Automap  and GMS will automatically map datasets to MODFLOW layers.  \n4. Click OK to close the  Interpolate to MODFLOW Layers  dialog.  \nGMS will take a few moments to interpolate the scatter points to the MODFLOW arrays.  \n5. Once the interpolation completes, turn off \u201c  2D Scatter Data\u201d to make it easier \nto see the grid.  \n7 Saving and Running the Local Mode l \nIt is now possible to save the MODFLOW model and run the simulation.  \n1. Select \u201c  3D Grid Data\u201d to make it active.  \n2. Select File | Save As\u2026 to bring up the Save As  dialog.  \n3. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n4. Enter \u201clocmod.gpr\u201d for the File name . \n5. Click Save to save the project under the new name and close the Save As  \ndialog.  \n6. Select MODFLOW  | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n7. When the simulation finishes, turn on Read solution on exit  and Turn on contours \n(if not on already) . \n8. Click Close  to exit the MODFLOW  model wrapper dialog.  \nA set of head contours that closely resemble the head contours from the regional model \nshould appear ( Figure 9). At this point, the local flow model is complete and the injection \nand extraction wells could be added for the pump -and-treat simulations.  \n\nGMS Tutorials   MODFLOW \u2013 Regional -to-Local Model Conversion, Transient  \n \n Page 11 of 11 \u00a9 Aquaveo 2024   \n      Figure 9      Cont ours visible after MODFLOW run  \n8 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 Regional -to-Local Model Conversion, Transient\u201d  \ntutorial. The following key concepts were discussed and demonstrated:  \n1.  The Grid | MODFLOW Layers \u2192 2D Scatter Points\u2026  command converts the \nMODFLOW elevation, flow package properties, recharge, and computed heads \ndata into scatter points.  \n2. The basic steps for conducting a regional -to-local model conversion in GMS are \nas follows:  \n\uf0b7 Generate the regional model and compute a so lution.  \n\uf0b7 Use the MODFLOW Layers \u2192 2D Scatter Points\u2026  command to create the \nscatter point set with the layer and head data from the regional model.  \n\uf0b7 Create the 3D grid for the local scale model.  \nInterpolate the heads and layer data values from the scatter poi nts to the MODFLOW \nlayer arrays for the local -scale model.  \n\n", "filename": "MODFLOW-RegionalToLocalTrans.pdf", "pages": 11}, "MODFLOW-SaveModflow6": {"text": "GMS Tutorials   MODFLOW \u2013 Saving MODFLOW 6  \n Page 1 of 10 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Saving MODFLOW 6  \nSave a MODFLOW 6 Simulation in Native Text Format  \n \nObjectives   \nThis tutorial explains how to save MODFLOW simulations in MODFLOW 6 native text format.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Saving Native \nText Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 Geostatistics  \n\uf0b7 Text Editor Software  \n Time  \n\uf0b7 25\u201340 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 Saving MODFLOW 6  \n Page 2 of 10 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Exporting a MODFLOW Simulation  ................................ ................................ ....................  2 \n2.1 Saving the Project  ................................ ................................ ................................ .........  3 \n2.2 Exporting MODFLOW 6 from GMS  ................................ ................................ ...............  4 \n2.3 Viewing the MODFLOW 6 Text Files  ................................ ................................ ............  4 \n3 MODFLOW Simulations with Unsupported Features  ................................ .......................  6 \n3.1 Saving the Project with MODFLOW 6  ................................ ................................ ...........  6 \n4 MODFLOW Simulations with Unsupported Parameters  ................................ ...................  7 \n4.1 Saving the Project with MODFLOW 6  ................................ ................................ ...........  8 \n5 Importing a MODFLOW -USG Simulation  ................................ ................................ ...........  9 \n5.1 Saving the Project with MODFLOW 6  ................................ ................................ ...........  9 \n6 Conclusion  ................................ ................................ ................................ .........................  10 \n \n1 Introduction  \nMODFLOW 6 requires that older MODFLOW project files be converted into the file format \nit uses. GMS allows saving MODFLOW project files into the MODFLOW 6 file format. \nThis feature is similar to the process used to save native text files.  \nCurrently, GMS do es not convert MODFLOW -LGR files to MODFLOW 6. Also, not all \nMODFLOW packages are supported in MODFLOW 6.  \nThis tutorial will demonstrate:  \n\uf0b7 Exporting a MODFLOW 2000 simulation to MODFLOW 6  \n\uf0b7 Exporting a MODFLOW simulation with unsupported features or parameter s to \nMODFLOW 6  \n\uf0b7 Exporting a MODFLOW -USG simulation to MODFLOW 6  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.   \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state . \n2 Exporting a MODFLOW Simulation  \nStart with importing a MODFLOW simulation. This simulation is one of the example files \nthat ships with the USGS MODFLOW source code.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cMODFLOW Name Files (*.mfn;*.nam)\u201d from the Files of type  drop-down.  \n3. Browse to the modflow6 \\modflow6 \\modfgrid  directory and select \u201c modfgrid.mfn \u201d. \n4. Click Open  to close the Open  dialog and bring up the MODFLOW Translator  \ndialog.  \nThis dialog appears w hen importing MODFLOW native text files. The MODFLOW \ntranslator allows valid MODFLOW simulations to be imported into GMS.  \n5. Select MODFLOW 2000  (the default option).  \n\nGMS Tutorials   MODFLOW \u2013 Saving MODFLOW 6  \n \n Page 3 of 10 \u00a9 Aquaveo 2024  6. Click OK to initiate the translator. The MODFLOW Translator  dialog will \ndisappear briefly  then reappear to show the progress of the translation.  \nMODFLOW will run and export a new set of files, including an HDF5 file. GMS will work \nwith these files, preserving the original native text model files.  \n7. When the file conversion is complete, click Done  to close the MODFLOW \nTranslator  dialog.  \nA MODFLOW model similar to Figure 1 should appear.  \n \nFigure 1     Imported  MODFLOW model  \n2.1 Saving the Project  \nNow it is possible to save the project as if MODFLOW were going to be run.  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Browse to the modflow6 \\modflow6  directory . \n3. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n4. Enter \u201cmodf grid.gpr\u201d as the File name . \n5. Click Save to save the project and close the Save As  dialog.  \nWhen a project is saved in GMS, a GPR file is created. The GPR file contains GMS -\nspecific data. If a MODFLOW simulation is in the current project, then a folder is cre ated \nthat has all of the MODFLOW inputs. The new folder name will use the name of the \n\nGMS Tutorials   MODFLOW \u2013 Saving MODFLOW 6  \n \n Page 4 of 10 \u00a9 Aquaveo 2024  current project name with \u201c_MODFLOW\u201d added to the end. In this project, a new folder \ncalled \u201cmodfgrid_MODFLOW\u201d was created.  \n2.2 Exporting MODFLOW 6 from GMS  \nNow to export the  simulation in to the  MODFLOW 6 native text format : \n1. Select MODFLOW | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage dialog.  \n2. In the MODFLOW version  section, turn on Save MODFLOW 6  copy . \n3. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n4. Select File | Save  to save the project.  \nBy turning on the Save MODFLOW 6  copy  option, an additional set of MODFLOW input \nfiles are saved in the MODFLOW 6 text format.  \n2.3 Viewing the MODFLOW 6 Text Files  \nThe next step is to go look at the MODFLOW 6 text files that were just saved.  \n1. Right -click on the \u201c  MODFLOW \u201d item in the Project Explorer  and select Open \nContaining Folder\u2026  to bring up a new window in Windows Explorer.  \n2. Browse to the modflow6 \\modflow6 \\modfgrid_MODFLOW_mf6  directory to bring \nup the MODFLOW 6 tex t files ( Figure  2). \n \n      Figure  2      Native text MODFLOW  6 files saved From GMS  \n3. Using a text editor, open the \u201cmodfgrid.mfn.log\u201d file.  \nThis file is created as the model is saved in MODFLOW 6 format.  Near the bottom of the \nfile you can see that some \u201cNOTES\u201d are printed. The BAS6 and LPF packages are not \ndirectly supported in MODFLOW 6. The information in these packages is contained in the  \nIC, DIS, NPF, and STO packages. The SIP solver is also not supported in MODFLOW 6; \nit is replaced by the IMS package (similar to the SMS solver in MODFLOW -USG). In this \n\nGMS Tutorials   MODFLOW \u2013 Saving MODFLOW 6  \n \n Page 5 of 10 \u00a9 Aquaveo 2024  case the MODFLOW 6 simulation supports all of the features of the MODFLOW 2000 \nmodel b ut there are other cases where certain features and packages are not supported.  \n4. Using a text editor, open the \u201cmfsim.nam\u201d file ( Figure 3). \n \nFigure 3      MODFLOW 6 mfsim.nam text file from GMS  \nThis file is required for all MODFLOW 6 simulations. The file must be named \u201cmfsim.nam\u201d \nand should not be renamed. Notice that the other files have the prefix modfgrid. This file \nhas MODFLOW 6 inputs for  time discretization (TDIS), groundwater models (GWF6), and \nthe solver (IMS).  \n5. Using a text editor, open the \u201cmodfgrid.nam\u201d name file ( Figure 4). \n \nFigure 4      MODFLOW 6 name file  \nThis file is similar to the MODFLOW name file from previous versions. Notice the different \npackages that are included under the BEGIN PACKAGES section.  \n\nGMS Tutorials   MODFLOW \u2013 Saving MODFLOW 6  \n \n Page 6 of 10 \u00a9 Aquaveo 2024  3 MODFLOW Simulations with Unsupported Features  \nNow to open a sim ulation with features which  are not supported in MODFLOW 6 . \n1. Select File | New to clear the current project and start a new one.  \n2. Click Open   to bring up the Open  dialog.  \n3. Select \u201cMODFLOW Name Files (*.mfn;*.nam)\u201d from the Files of type  drop-down.  \n4. Browse to the modflow6 \\modflow6 \\mnw1  directory and select \u201c mnw1.nam \u201d. \n5. Click Open  to close the Open  dialog and bring up the MODFLOW Translator  \ndialog.  \n6. Select MODFLOW 200 0. \n7. Click OK to initiate the translator. The MODFLOW Translator  dialog will \ndisappear briefly  then reappear to show the progress of the translation.  \n8. When the file conversion is complete, click Done  to close the MODFLOW \nTranslator  dialog.  \nA MODFLOW model similar to Figure 5 should appear.  \n \nFigure 5     Imported MODFLOW model  \n3.1 Saving the Project with MODFLOW 6  \nNow it is possible to save the project as if MODFLOW 6 were going to be run.  \n1. Select MODFLOW | Globa l Options\u2026  to bring up the MODFLOW Global/Basic \nPackage dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Saving MODFLOW 6  \n \n Page 7 of 10 \u00a9 Aquaveo 2024  2. In the MODFLOW version  section, turn on Save MODFLOW 6  copy . \n3. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n4. Select File | Save As\u2026  to bring up the Save As  dialog.  \n5. Browse to the modflow6 \\modflow6  directory . \n6. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n7. Enter \u201cmnw1 .gpr\u201d as the File name . \n8. Click Save to save the project and close the Save As  dialog.  \nWhen this model is saved in MODFLOW 6 format some errors are report ed and the \nMODFLOW 6 Export  dialog appears.  \n9. Scroll to the bottom of the text window in the MODFLOW 6 Export  dialog.  \nNotice that the BCF package is not supported by MODFLOW 6. The BCF package \ncannot be converted to the NPF and STO packages. Since these packages are required \nfor a MODFLOW 6 model, an error is reported, and the export is aborted.  \n10. Click OK to close the MOD FLOW 6 Export  dialog.  \n4 MODFLOW Simulations with Unsupported Parameters  \nNow to open a simulation with parameters that are not supported by MODFLOW 6.  \n1. Select File | New to clear the current project and start a new one.  \n2. Click Open   to bring up the Open  dialog . \n3. Select \u201cMODFLOW Name Files (*.mfn;*.nam)\u201d from the Files of type  drop-down.  \n4. Browse to the \\modflow6 \\modflow6 \\etsdrt  directory and select \u201c etsdrt.nam \u201d. \n5. Click Open  to close the Open  dialog and bring up the MODFLOW Translator  \ndialog.  \n6. Select MODFLOW 200 5 (the default option).  \n7. Click OK to initiate the translator. The MODFLOW Translator  dialog will \ndisappear briefly, then reappear to show the progress of the translation.  \n8. When the file conversion is complete, click Done  to close the MODFLOW \nTranslator  dialog .  \nA MODFLOW model similar to Figure 6 should appear.  \n\nGMS Tutorials   MODFLOW \u2013 Saving MODFLOW 6  \n \n Page 8 of 10 \u00a9 Aquaveo 2024   \nFigure 6      Imported MODFLOW model  \n4.1 Saving the Project with MODFLOW 6  \nNow it is poss ible to save the project as if MODFLOW were going to be run.  \n1. Select MODFLOW | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage dialog.  \n2. In the MODFLOW version  section, turn on Save MODFLOW 6  copy . \n3. Click OK to exit the MODFLOW Global/Basic Packag e dialog.  \n4. Select File | Save As\u2026  to bring up the Save As  dialog.  \n5. Browse to the modflow6 \\modflow6  directory . \n6. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n7. Enter \u201cetsdrt .gpr\u201d as the File name . \n8. Click Save to save the project and close the Save As  dialog.  \nWhen this model is saved in MODFLOW 6 format some errors are reported and the \nMODFLOW 6 Export  dialog is shown.  \n9. Scroll to the bottom of the text window in the MODFLOW 6 Export  dialog.  \nNotice that \u201cparameters\u201d are not supported by MODFLOW 6.  Thus, an error is reported \nand the export is aborted.  \n10. Click OK to close the MODFLOW 6 Export  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Saving MODFLOW 6  \n \n Page 9 of 10 \u00a9 Aquaveo 2024  5 Importing a MODFLOW -USG Simulation  \nNow to read in a MODFLOW -USG simulation : \n1. Select File | New to clear the current project and start a new one.  \n2. Click Open  to bring up the Open  dialog.  \n3. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n4. Browse to the modflow6 \\modflow6 \\usg directory and select \u201c usg.gpr\u201d. \n5. Click Open  to import the file and close the Open  dialog . \nA model similar to Figure 7 should appear.  \n \nFigure 7      MODFLOW -USG model with pilot points  \n5.1 Saving the Project with MODFLOW 6  \nNow it is possible to save the project as if MODFLOW were going to be run.  \n1. Select MODFLOW | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage dialog.  \n2. In the MODFLOW version  section, turn on Save MODFLOW 6  copy . \n3. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n4. Select File | Save As\u2026  to bring up the Save As  dialog.  \n5. Browse to the modflow6 \\modflow6  directory . \n6. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n7. Enter \u201cusg_mf6 .gpr\u201d as the File name . \n8. Click Save to save the project and close the Save As  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Saving MODFLOW 6  \n \n Page 10 of 10 \u00a9 Aquaveo 2024  This simulation saves without any errors or warnings because MODFLOW 6 supports all \nof the packages in this model. Further, this type of grid can be represented by the DISV \npackage in MODFLOW 6.  \n6 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 Saving MODFLOW 6\u201d t utorial.  The following topics \nwere discussed and demonstrated:  \n\uf0b7 MODFLOW 2000, 2005, NWT, USG can be saved to MODFLOW 6.  \n\uf0b7 Not all MODFLOW 2000, 2005, NWT, USG packages are supported by \nMODFLOW 6.  \n \n", "filename": "MODFLOW-SaveModflow6.pdf", "pages": 10}, "MODFLOW-SaveNativeText": {"text": "GMS Tutorials   MODFLOW \u2013 Saving Native Text  \n Page 1 of 16 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Saving Native Text  \nSave a MODFLOW Simulation in Native Text Format  \n \nObjectives   \nThis tutorial explains how to save MODFLOW simulations in MODFLOW's native text format. GMS \nprovides functionality that saves native text files which include MODFLOW documentation. These files are \neasy to read and clarify the contents of the file.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2012 Grid \nApproach  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 Text Editor Software  \n Time  \n\uf0b7 25\u201340 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 Saving Native Text  \n Page 2 of 16 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Importing the Simulation  ................................ ................................ ................................ .... 2 \n2.1 Saving the Project  ................................ ................................ ................................ .........  3 \n2.2 Viewing MODFLOW Files  ................................ ................................ .............................  4 \n2.3 Exporting Native Text from GMS  ................................ ................................ ..................  6 \n2.4 Viewing the Native Text Files ................................ ................................ ........................  6 \n3 Importing the Simulation with Parameters  ................................ ................................ ........  8 \n3.1 Exporting Native Text from GMS  ................................ ................................ ..................  9 \n3.2 Viewing the Native Text  ................................ ................................ ..............................  10 \n4 Importing the Simulation with Pilot Points  ................................ ................................ ...... 11 \n4.1 Exporting Native Text from GMS  ................................ ................................ ................  12 \n4.2 Viewing the Native Text  ................................ ................................ ..............................  13 \n4.3 Exporting Native Text from GMS with External Arrays  ................................ ...............  15 \n5 Conclusion  ................................ ................................ ................................ .........................  16 \n \n1 Introduction  \nGMS uses a modified version of MODFLOW that can read data from HDF51 files. Large \nportions of the MODFLOW inputs are stored in an HDF5 file when creating a MODFLOW \nmodel in  GMS. Large MODFLOW models are stored more efficiently using HDF5. \nCompression ratios of 95% are common when compared to text files. The read/write \ntimes for HDF5 files are also much faster.  \nEven though using HDF5 files with MODFLOW is extremely efficient,  many users prefer \nto also save MODFLOW simulations in the native MODFLOW format. This is particularly \ntrue when archiving a completed modeling project.  \nNative MODFLOW text files can be saved from GMS. Since GMS version 10.0, these text \nfiles contain docum entation comments that more clearly identify the contents of each line \nin the MODFLOW input file. Parameter definitions are also included in the text files.2 This \ntutorial discusses and demonstrates the native text exporting options available in GMS \nusing various MODFLOW simulations (including one with parameters and one with pilot \npoints), as well as changing the array saving options before saving the simulation in \nnative text format.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.   \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2 Importing the Simulation  \nStart by importing a MODFLOW simulation. This simulation is one of the example files \nthat ships with the USGS MODFLOW source code.  \n                                                      \n1 See www. hdfgroup.org. HDF5 is a binary, cross -platform file format for storing data.  \n2 Earlier versions of GMS also exported native text files, but these files only removed references to \nthe HDF5 fil e. No documenting comments and parameters were written to the text files.  \nGMS Tutorials   MODFLOW \u2013 Saving Native Text  \n \n Page 3 of 16 \u00a9 Aquaveo 2024  1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cMODFLOW Name Files (*.mfn;*.nam)\u201d from the Files of type  drop-down.  \n3. Browse to the text\\text\\mnw1  directory and select \u201c mnw1.nam \u201d. \n4. Click Open  to close the Open  dialog and bring up the MODFLOW Translator  \ndialog.  \nThis dialog appears when importing MODFLOW native text files. When OK is clicked, \nMODFLOW will run and export a new set of files, including an HDF5 file. GMS will work \nwith these files, preserving the or iginal native text model files. The MODFLOW translator \nallows valid MODFLOW simulations to be imported into GMS.  \n5. Select MODFLOW 2000  (the default option).  \n6. Click OK to initiate the translator. The MODFLOW Translator  dialog will \ndisappear briefly, then reapp ear to show the progress of the translation.  \n7. When the file conversion is complete, click Done  to close the MODFLOW \nTranslator  dialog.  \nA MODFLOW model similar to Figure 1 should appear.  \n \nFigure 1      Imported MODFLOW model  \n2.1 Saving the Project  \nNow it is possible to save the project as if MODFLOW were going to be run.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Browse to the text\\text directory . \n3. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n4. Enter \u201cmnw1.gpr\u201d as the File name . \n5. Click Save to save the project and close the Save As  dialog.  \nWhen a project is saved in GMS, a GPR file is created. The GPR file contains GMS -\nspecific data. If a MODFLOW simulation is in the current project, then a folder is created \nthat has all of the MODFLOW inputs. The new folder name will use the name of the \ncurrent project name with \u201c_MODFLOW\u201d added to the end. In this  project, a new folder \ncalled \u201cmnw1_MODFLOW\u201d was created.  \n\nGMS Tutorials   MODFLOW \u2013 Saving Native Text  \n \n Page 4 of 16 \u00a9 Aquaveo 2024  2.2 Viewing MODFLOW Files  \nTo quickly view the MODFLOW input files, do the following:  \n1. Right -click on the \u201c  MODFLOW\u201d item in the Project Explorer and select Open \nContaining Folder\u2026  to bring up a new wind ow in Windows Explorer.  \nA file browser showing the directory where the MODFLOW files are stored will appear. \nFiles similar to those in Figure 2 should be present.  \n \n      Figure 2      MODFLOW input files saved from GMS  \nAll of the files in this directory are text files except for the \u201cmnw1.h5\u201d file. The next step is \nto examine the contents of the files.  \n2. Using a text editor, open the \u201cmnw1.bc6\u201d file.  \nThis is the BCF package file. This file contains information on the hydraulic properties of \nthe grid cells ( Figure 3). Notice the lines that begin with \u201cHDF5\u201d. When MODFLOW reads \nthese lines, it will get data from the \u201cmnw1.h5\u201d file. The lines are arrays that define the \naquifer properties (storage, hydraulic conductivity, and transmissivity).  \n \n      Figure 3      MODFLOW BCF package file saved from GMS  \n\nGMS Tutorials   MODFLOW \u2013 Saving Native Text  \n \n Page 5 of 16 \u00a9 Aquaveo 2024  There are many free viewers available to browse the contents of HDF5 files. Figure 4 \nshows \u201cmnw1.h5\u201d as seen in HDFView3, an application provided by the developers of \nHDF5 which allows viewing and editing of HDF5 files.  \n \n      Figure 4      HDFView of \u201cmnw1.h5\u201d  \nNow to look at the original MODFLOW files. The original BCF file contains similar \ninformation as in the BC6 file. However, the information is in a different format.  \n3. Right -click on the \u201c  MODFLOW\u201d item in the Project Explorer and select Open \nContaining Folder\u2026  to bring up a new window in Windows Explorer.  \n4. Browse to the text\\text\\mnw1  directory.  \nThis is the directory containing the original MODFLOW files. Files similar to those in \nFigure 5 should be present.  \n \n      Figure 5      Original MODFLOW input files  \n5. Open \u201c mnw1.bcf \u201d in a text editor ( Figure 6). \n                                                      \n3 See http://www.hdfgroup.org/products/java/hdf -java-html/hdfview/.  \n\nGMS Tutorials   MODFLOW \u2013 Saving Native Text  \n \n Page 6 of 16 \u00a9 Aquaveo 2024   \n      Figure 6      MODFLOW BCF file  \nWhen the two files are compared, notice that the numbers on lines 1 and 2 of the file are \nthe same. However, in the original files, some text is on the right side of the file. \nMODFLOW will ignore this text because it is only expecting to read numbers on those \nlines. Also notice that instead of referencing an HDF5 file for the aquifer properties, the \nvalues for these arrays are listed in this file.  \n2.3 Exporting Native Text from GMS  \nNow to export the simulation in MODFLOW native text format:  \n1. Close the text editor and  Windows Explorer windows and return to GMS.  \n2. Select MODFLOW | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage dialog.  \n3. In the MODFLOW version  section, turn on Save native text copy . \n4. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n5. Select File | Save  to save the project.  \nBy turning on the Save native text copy  option, an additional set of MODFLOW input files \nare saved in the native text format.  \n2.4 Viewing the Native Text Files  \nThe next step is to go look at the BCF package file in the nativ e text files that were just \nsaved.  \n1. Right -click on the \u201c  MODFLOW\u201d item in the Project Explorer and select Open \nContaining Folder\u2026  to bring up a new window in Windows Explorer.  \n2. Browse to the text\\text\\mnw1_MODFLOW_text  directory to bring up the \nMODFLOW nat ive text files ( Figure 7). \n\nGMS Tutorials   MODFLOW \u2013 Saving Native Text  \n \n Page 7 of 16 \u00a9 Aquaveo 2024   \n      Figure 7      Native text MODFLOW files saved From GMS  \n3. Using a text editor, open the \u201cmnw1.bc6\u201d file ( Figure 8). \n \n      Figure 8      MODFLOW BCF file saved in native text format From GMS  \nNotice that this file is very similar to the original MODFLOW text file. There are some \nmino r differences such as the format of the numbers. Look at the comments on the right \nside of the file. These all begin with the \u201c#\u201d symbol. The number on this line indicates the \nMODFLOW input dataset number for the BCF file.  \nAfter the number, notice the doc umented variable name that is read from this line. These \ndataset numbers and variable names come straight from the MODFLOW documentation \nso they will be those mentioned in the Online Guide to MODFLOW BCF documentation \n(Figure 9).4 Notice the dataset numbers and the variable names. These are the items \nwritten in the comments on the right side of the BCF file shown above.  \n                                                      \n4 See http://water.usgs .gov/nrp/gwsoftware/modflow2000/MFDOC/index.html?bcf.html   \n\nGMS Tutorials   MODFLOW \u2013 Saving Native Text  \n \n Page 8 of 16 \u00a9 Aquaveo 2024   \n      Figure 9      Online Guide to MODFLOW  \nFeel free to view some of the other MODFLOW input files at this point. When finished, \nclose the text editors and file browser and return to GMS.  \n3 Importing the Simulation with Parameters  \nNow it is necess ary to import another MODFLOW simulation that has parameters.  \n1. Select File | New to clear the current project and start a new one.  \n2. Click Open   to bring up the Open  dialog.  \n3. Select \u201cMODFLOW Name Files (*.mfn;*.nam)\u201d from the Files of type  drop-down.  \n4. Browse t o the text\\text\\etsdrt  directory and select \u201c etsdrt.nam\u201d . \n5. Click Open  to close the Open  dialog and bring up the MODFLOW Translator  \ndialog.  \n6. Select MODFLOW 2005  as the version to use and click OK to initiate the \ntranslator.  \n7. Once the translator is finished, click Done  to close the MODFLOW Translator  \ndialog.  \nA MODFLOW model similar to Figure 10 should be visible.  \n\nGMS Tutorials   MODFLOW \u2013 Saving Native Text  \n \n Page 9 of 16 \u00a9 Aquaveo 2024   \n      Figure 10      MODFLOW model of  the etsdrt simulation  \n8. Select MODFLOW | Parameters\u2026  to bring up the Parameters  dialog.  \nFour parameters imported as part of the simulation will be visible ( Figure 11).  \n \n      Figure 11      MODFLOW parameters  \n9. Click OK to exit the Parameters  dialog.  \nWhen exporting the native text files, the parameters will be included in the text files as \nwell. \n3.1 Exporting Native Text from GMS  \nTo save this simulation in native text format, do the following:  \n\nGMS Tutorials   MODFLOW \u2013 Saving Native Text  \n \n Page 10 of 16 \u00a9 Aquaveo 2024  1. Select MODFLOW | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage  dialog.  \n2. In the MODFLOW version  section, turn on Save native text copy . \n3. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n4. Select File | Save As\u2026  to bring up the Save As  dialog.  \n5. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n6. Browse to the text\\text directory . \n7. Enter \u201cetsdrt.gpr\u201d as the File na me. \n8. Click Save  to export the files and close the Save As  dialog.  \n3.2 Viewing the Native Text  \nNow to view the text files to see how the parameters were included in the files:  \n1. Right -click on the \u201c  MODFLOW\u201d item in the Project Explorer and select Open \nContaining  Folder\u2026  to bring up a new window in Windows Explorer.  \n2. Browse to the text\\text\\etsdrt_MODFLOW_text  directory.  \nThe files shown in Figure 12 should be p resent.  \n \n      Figure 12      MODFLOW native text files  \nNow to look at some of the files that have parameters defined. The ETS, DRT, RCH, and \nLPF packages all have parameters defined. First look at the ETS package.  \n3. Using a text ed itor, open the \u201cetsdrt.ets\u201d file ( Figure 13). \n\nGMS Tutorials   MODFLOW \u2013 Saving Native Text  \n \n Page 11 of 16 \u00a9 Aquaveo 2024   \nFigure 13      ETS package file  \nNotice that the parameter \u201cETS -Max\u201d has been included in the file (see lines 3 and 7). \nNow to look at the DRT file.  \n4. Using a text editor, open the \u201cetsdrt.drt\u201d file.  \nThe file should look like Figure 14. \n \n        Figure 14      DRT package file  \nNotice lines 2, 3b, and 6. These lines define the parameter and its usage in the \nsimulation. Also notice that the total width of the text in this file is much greater than the \ntext in other files pre viously examined. The documentation comments are all aligned on \nthe right side of the file and a small buffer is placed between the comments and the \nMODFLOW inputs. This makes reading the documentation easier than with non -aligned \ncomments.  \n4 Importing the S imulation with Pilot Points  \nNow to read in a MODFLOW simulation that uses pilot points5 with an array parameter:  \n5. Select File | New to clear the current project and start a new one.  \n6. Click Open   to bring up the Open  dialog.  \n7. Select \u201cProject Files (*.gpr )\u201d from the Files of type  drop-down.  \n8. Browse to the text\\text\\pilot directory and select \u201c pilot.gpr\u201d . \n9. Click Open  to import the file and close the Open  dialog . \nA model similar to Figure 15 should appear.  \n                                                      \n5 Pilot points are used with PEST as part of automated model calibration. To learn more about pilot \npoints, complete the\u201d MODFLOW \u2013 PEST Pilot Points\u201d tutorial.  \n\nGMS Tutorials   MODFLOW \u2013 Saving Native Text  \n \n Page 12 of 16 \u00a9 Aquaveo 2024   \nFigure 15      MODFLOW model with pilot points  \n4.1 Exporting Native Text from GMS  \nTo save this simulation in native text format, do the following:  \n1. Select MODFLOW | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage  dialog.  \nNotice that the Save native text copy  option is not available in the MODFLOW version  \nsection. This option will only work when Forward  is selected in the Run options  section. \nTypically, a model calibration would be completed, then a final forward run model would \nbe completed with the calibrated parameter values. The native text would then be \nexported. With the stochastic option, a switch back to a forward run is neces sary in order \nto save the native text.  \n2. In the Run options  section, select Forward . \n3. In the MODFLOW version  section, turn on Save native text copy . \n4. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n5. Select File | Save As\u2026  to bring up the Save As  dialo g. \n6. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n7. Browse to the text\\text directory . \n8. Enter \u201cpilot.gpr\u201d as the File name . \n9. Click Save  to export the files and close the Save As  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Saving Native Text  \n \n Page 13 of 16 \u00a9 Aquaveo 2024  4.2 Viewing the Native Text  \nNow view the text files and see how the parameters were included in the files.  \n1. Expand the \u201c  3D Grid Data\u201d folder and the \u201c  grid\u201d item in the Project \nExplorer.  \n2. Right -click on \u201c  MODFLOW\u201d and select Open Containing Folder\u2026  to bring \nup a Windows Explorer window.  \n3. Browse to the text/text/p ilot_MODFLOW_text  directory.  \nThe files shown in Figure 16 should be present.  \n \n      Figure 16      MODFLOW native text files  \nNow to review some of the files that are related to the pilot points, beginning with the LPF \npackage:  \n4. Using a text editor, open the \u201cpilot.lpf\u201d file ( Figure 17). \n\nGMS Tutorials   MODFLOW \u2013 Saving Native Text  \n \n Page 14 of 16 \u00a9 Aquaveo 2024   \n      Figure 17      LPF package file  \nNotice that all the lines in the file have the 8 and 9 line numbers. These lines define the \npilot point parameters. The pilot point parameters are named pp#_#, where the first # is  \nthe index of the pilot point set (it is possible to have multiple sets of pilot point \nparameters) and the second # is an index for the point number.  \nThe next file to review is the multiplier file. This is where the multiplier arrays related to \neach pilot  point are written.  \n5.  Using a text editor, open the \u201cpilot.mlt\u201d file ( Figure 18). \nA multiplier array is created for each pilot point. When MODFLOW runs , the value at \neach point is multiplied by its multiplier array, resulting in one array for each pilot point. All \nof these arrays are then combined (added together) to create the final value at each cell. \nLooking at text files with array data can be diffic ult since the arrays contain such large \namounts of data.  \nGMS has exporting options to allow arrays to be external from the MODFLOW package \nfiles. One of these options is demonstrated here.  \n \n\nGMS Tutorials   MODFLOW \u2013 Saving Native Text  \n \n Page 15 of 16 \u00a9 Aquaveo 2024   \n      Figure 18      MLT package file  \n4.3 Exporting Native Text from GMS with External Arrays  \nThe next step is to save this simulation in native text format again with external arrays.  \n1. In GMS, select Edit | Preferences\u2026  to bring up the Preferences  dialog.  \n2. Select \u201cMODFLOW\u201d from the list on the left and turn on Save copy of MODFLOW \nsimulation in native text format . \n3. Select \u201cWrite external arrays to \u2018arrays\u2019 folder\u201d from the drop -down and click OK \nto exit the Preferences  dialog.  \n4. Select File | Save  to export the  files. \nReturn to the Windows Explorer window where the native text files are shown. A new \ndirectory called \u201carrays\u201d should have been created. First, look at the MLT file again and \nthen it will possible to examine the arrays that were created in the \u201carray s\u201d folder.  \n5. Using a text editor, open the \u201cpilot.mlt\u201d file.  \nInstead of seeing large amounts of floating point numbers in this file, there are simply  \nreferences to external files ( Figure 19). This is accomplished through the \u201cOPEN/CLOSE\u201d \nstatement on each row in the file. Notice the format of the names of the array files.  \nExternal arrays are placed in their own text files and are named using the followi ng \npattern: \u201cmyProject_array_PACKAGE_VARIABLE_LAYERorSP\u201d.  \nIn this example, the first pilot point multiplier array is named \u201cpilot_array_MLT_pp1_1.txt\u201d. \nSo \u201cpilot\u201d is the project name. \u201cMLT\u201d is the package. And \u201cpp1\u201d is the variable (or \nparameter). Lastly,  \u201c1\u201d refers to the pilot point index.  Here are two more examples:  \n\uf0b7 The ibound array for layer 1 would have the following name: \n\u201cmyProject_array_BAS_IBOUND_1.txt\u201d.  \n\uf0b7 The recharge array for stress period 3 would have the following name: \n\u201cmyProject_array_RCH_RE CH_3.txt\u201d.  \n\nGMS Tutorials   MODFLOW \u2013 Saving Native Text  \n \n Page 16 of 16 \u00a9 Aquaveo 2024   \n      Figure 19      MLT package file with external arrays  \n6. Return to Windows Explorer and open the arrays  directory. Notice all of the \nexternal arrays created when the native text files were saved.  \nTo export the arrays , it was necessary to turn on a preference that will remain turned on \nin any new GMS project unless it is reset. To reset this preference setting:  \n7. Select Edit | Preferences\u2026  to bring up the Preference  dialog.  \n8. Select \u201cMODFLOW\u201d from the list on the left.  \n9. Turn off Save copy of MODFLOW simulation in native text format . \n10. Click OK to exit the Preference  dialog.  \n5 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 Saving Native Text\u201d tutorial.  The following topics were \ndiscussed and demonstrated:  \n\uf0b7 HDF5 is a binary, cross -platform file format.  \n\uf0b7 GMS stores most of the MODFLOW data in an HDF5 file.  \n\uf0b7 GMS can export native text format MODFLOW files.  \n\uf0b7 Native text format MODFLOW files from GMS also include useful documentation \ncomments.  \n\uf0b7 It is possible to export native text for mat MODFLOW files from GMS with external \narrays.  \n \n\n", "filename": "MODFLOW-SaveNativeText.pdf", "pages": 16}, "MODFLOW-SFR2Package": {"text": "GMS Tutorials   MODFLOW \u2013 SFR2 Package  \n Page 1 of 19 \u00a9 Aquaveo 2024   \n GMS 10.7 Tutorial  \nMODFLOW \u2013 SFR2 Package  \nThe MODFLOW Streamflow -Routing (SFR2) Package Interface in \nGMS  \n \nObjectives   \nLearn how to create a model containing SFR1/SFR2 -type streams.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach I  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 55\u201365 minutes  \n \nGMS 10.7  \n\nGMS Tutorials   MODFLOW \u2013 SFR2 Package  \n Page 2 of 19 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Stream Basics  ................................ ................................ ................................ ......................  4 \n2.1 Reaches and Segments  ................................ ................................ ...............................  4 \n2.2 Routing  ................................ ................................ ................................ .........................  4 \n3 Getting Started  ................................ ................................ ................................ .....................  4 \n3.1 Open the Starting Project  ................................ ................................ .............................  5 \n4 Digitize and Set Up the Stream Arcs  ................................ ................................ ..................  6 \n4.1 Create a Conceptual Model  ................................ ................................ ..........................  6 \n4.2 Create a Conceptual Model  ................................ ................................ ..........................  6 \n4.3 Create the Arcs  ................................ ................................ ................................ .............  7 \n4.4 Correct the Arc Directions  ................................ ................................ .............................  7 \n4.5 Stream Reach and Segment Numbering  ................................ ................................ ...... 9 \n5 Assign Arc Attributes  ................................ ................................ ................................ ..........  9 \n5.1 Arc A  ................................ ................................ ................................ .............................  9 \n5.2 Arc B through H  ................................ ................................ ................................ ..........  11 \n5.3 Channel Cross Sections  ................................ ................................ .............................  11 \n5.4 Segment IDS  ................................ ................................ ................................ ..............  12 \n6 Map \u2192 MODFLOW  ................................ ................................ ................................ .............  12 \n6.1 SFR2 Package Dialog  ................................ ................................ ................................  13 \n6.2 Save the Project and Run MODFLOW  ................................ ................................ ....... 13 \n6.3 Compare the Solutions  ................................ ................................ ...............................  14 \n6.4 Compare the Solutions  ................................ ................................ ...............................  15 \n6.5 Flow Budget  ................................ ................................ ................................ ................  16 \n7 Creating an SFR Parameter  ................................ ................................ ..............................  17 \n7.1 Flow Budget  ................................ ................................ ................................ ................  18 \n8 Conclusion  ................................ ................................ ................................ .........................  19 \n \n1 Introduction  \nThe MODFLOW SFR2 package is used to model streamflow routing and unsaturated \nflow beneath streams. It is an evolution of the SFR1 package, which was derived from \nSTR1, the original MODFLOW stream package. The SFR2 package is very similar to the \nSFR1 packag e, with the main difference being support for unsaturated flow beneath \nstreams. The SFR2 package can read files prepared for the SFR1 package.  \nBecause of the grid -independent conceptual model approach that GMS has long \nsupported, GMS is an ideal modeling interface for creating streams. Stream segments \nand reaches must be listed in a particular order that can be quite tricky to get right if \npreparing a file by hand. GMS takes care of stream ordering automatically with a simple \npoint -and-click stream creatio n interface so the user rarely has to worry about it.  \nThis tutorial illustrates how to create a model containing SFR1/SFR2 type streams. The \nmodel in this tutorial is from the MODFLOW SFR1 Package documentation. The problem \nis a hypothetical one \u201cdeveloped  for an alluvial basin in a semiarid region in which \nrecharge to the aquifer is primarily leakage from streams that enter the basin from \nmountains on the northwest, northeast, and southeast\u201d.1 One grid layer is used.  \n                                                      \n1 Prudic, David E.; Konikow ,  Leonard F.; and Banta, Edward R., 2004. A New Streamflow -Routing \n(SFR1) Package to Simulate Stream -Aquifer Interaction with MODFLOW \u20132000 , U.S. Geological \nSurvey Open -File Report 2004 \u20131042. https://pubs.usgs.gov/of/2004/1042/ofr2004 -1042.pdf . \nGMS Tutorials   MODFLOW \u2013 SFR2 Package  \n \n Page 3 of 19 \u00a9 Aquaveo 2024   \n      Figure 1      An SFR1 stream net work2 \nThe simulation has two stress periods. In the first stress period, the wells in the middle of \nthe model extract water from the model and draw down the water table. In the second \nstress period, the wells are turned off and th e head recovers from the draw down. The \nstream data is held constant for both stress periods.  \nThis tutorial will demonstrate and discuss:  \n\uf0b7 Adding stream feature arcs by digitizing a background image.  \n\uf0b7 Ensuring that the stream arcs are pointing in the right d irection.  \n\uf0b7 Assigning attributes to the stream arcs  \n\uf0b7 Saving and running the model  \n                                                      \n2 Prudic (2004), p.14.  \n\nGMS Tutorials   MODFLOW \u2013 SFR2 Package  \n \n Page 4 of 19 \u00a9 Aquaveo 2024  2 Stream Basics  \n2.1 Reaches and Segments  \nThe SFR2 package divides streams into reaches and segments.  \nA stream reach is a section of a stream that is associated with a \nparticular fin ite-difference cell used to model ground -water flow and \ntransport. A segment is a group of reaches that have (1) uniform rates of \noverland flow and precipitation to them; (2) uniform rates of \nevapotranspiration from them; (3) uniform or linearly changing p roperties \n(for example; streambed elevation, thickness, and hydraulic conductivity, \nand stream depth and width); (4) tributary flows or specified inflow or \noutflow (only in the first reach); and (5) diversions (only from the last \nreach).3 \nIn GMS, a stream segment corresponds to a single arc. A stream reach \ndoesn\u2019t have a corresponding representation in the conceptual model but \nexists only on the grid cells after having mapped the conceptual model to \nthe grid.  \n2.2 Routing  \nIn addition to tracking flow between st reams and the underlying aquifer, the MODFLOW \nstream packages (STR1, SFR1 and SFR2) also route the flow of water through a stream \nnetwork. The stream network can include tributaries, diversions, and lakes (in conjunction \nwith the Lake Package).  \nRouting is accomplished by determining the inflows for a reach (which are specified for \nthe most upstream reach), adding or subtracting leakage to the aquifer, and allowing any \nremainder to pass to the next downstream reach as inflow. The process is repeated for \nthe next downstream reach and so forth.  \nThis is different from the MODFLOW River Package, which only tracks flow between the \nriver and the aquifer. With the River Package, once water has entered the river, it is lost \nto the model. With the stream packages, tha t water can travel downstream and possibly \nreenter the aquifer at another point.  \nUnlike the River package, the water depth is calculated based on the flow rather than \nbeing manually entered. There are several different options available for calculating wat er \ndepth, including using Manning\u2019s equation or a depth versus flow table.  \n3 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.   \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n                                                      \n3 Prudic (2004), p.2.  \nGMS Tutorials   MODFLOW \u2013 SFR2 Package  \n \n Page 5 of 19 \u00a9 Aquaveo 2024  3.1 Open the Starting Project  \nThe point of this tutorial is to illustrate the SFR2 package, so previously created files will \nbe imported rather than spending time entering the other MODF LOW inputs.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the sfr2\\sfr2\\ directory and select \"start.gpr\".  \n4. Click Open  to import the project and exit the Open  dialog.  \nA grid with some streams and contour lines should be visible ( Figure 2). \n \n      Figure 2      Initial project appearance  \n5. Right -click in a blan k spot in the Project Explorer and select Expand All . \nNotice the Project Explorer includes a 3D grid and a MODFLOW simulation ( Figure 3). \n\nGMS Tutorials   MODFLOW \u2013 SFR2 Package  \n \n Page 6 of 19 \u00a9 Aquaveo 2024   \n      Figure 3      Project Explorer at the project beginning  \n4 Digitize and Set Up the Stream Arcs  \nIn GMS, it is only possible to create streams by using the conceptual model approach. \nThis is done by mapping feature objects to the grid. Streams cannot be created directly \non the grid. The stream arcs will be created by digitizing the background image.  \n4.1 Create a Conceptual Model  \nFirst, it is necessary to create a MODFLOW conceptual model.  \n1. Right -click in a blank spot in the Project Explorer a nd select New | Conceptual \nModel  to bring up the Conceptual Model Properties dialog.  \n2. Enter \"Test 1\" as the Name . \n3. Click OK to close the Conceptual Model Properties  dialog.  \n4.2 Create a Conceptual Model  \n1. Right -click on the \"  Test 1\" conceptual model and select New Coverage\u2026  to \nbring up the Coverage Setup dialog.  \n2. Enter \"Streams\" as the Coverage name . \n3. In the Sources/Sinks/BCs  column, scroll down and turn on Stream  (SFR2) . \n4. Enter \u201c1500.0\u201d as the Default elevation. so the coverage will be above the grid.  \n\nGMS Tutorials   MODFLOW \u2013 SFR2 Package  \n \n Page 7 of 19 \u00a9 Aquaveo 2024  5. Click OK to close the Coverage Setup  dialog.  \n6. Select the new \u201c  Streams\u201d coverage to make it active.  \n4.3 Create the Arcs  \nNow, create the arcs for the streams. Refer to Figure 4 for the first four steps below.  \n1. Using the Create Arc   tool, create an arc along the path of Green Creek (from \nthe top left corner down to the Blue River).  \n2. Create an arc for the Ditch (from G reen Creek to Little Creek).  \n3. Create an arc for Little Creek (from the right edge to Green Creek).  \n4. Create an arc for the Blue River (from the right edge to the left edge).  \nNow that the arcs have been digitized, the background image is no longer necessary.  \n5. In the Project Explorer, turn off the \u201c  GIS Layers\u201d folder.  \n \n      Figure 4      Location of stream arcs after digitizin g (arcs bolded for clarity)  \n4.4 Correct the Arc Directions  \nArcs have a direction associated with them. The directi on is from the starting node to the \nending node and is defined when the arc is first created. Usually the direction doesn\u2019t \nmatter, but with streams they must go from upstream to downstream (just as water \nflows). The direction can be displayed and reversed  if needed.  \n\nGMS Tutorials   MODFLOW \u2013 SFR2 Package  \n \n Page 8 of 19 \u00a9 Aquaveo 2024  To check the arc direction and make sure all the arcs are pointing from upstream to \ndownstream, do the following.  \n6. Click Display Options   to bring up the Display Options  dialog.  \n7. Select \u201c  Map Data\u201d from the list on the left.  \n8. On the Map tab, near the bottom of the first section, turn on Arc direction arrows . \n9. Click OK to close the Display Options  dialog.  \nArrows should now be visible on the arcs. The arrows should be pointing as shown in       \nFigure  5. If any of the arcs are pointing in the wrong direction, do the following:  \n10. Using to the Select Arcs   tool, select the arc, then right -click and select \nReverse Arc Direction  to change the  direction of the flow along the arc.  \n11. Repeat step 5 for any arcs pointing the wrong direction.  \n \n      Figure 5      Arc flow directions  \nWith all arcs pointing the correct direction, the flow arrows can be turned off.  \n12. Click Display  Options   to bring up the Display Options  dialog.  \n13. Select \u201c  Map Data\u201d from the list on the left.  \n14. On the Map tab, near the bottom of the first section, turn off Arc direction arrows . \n15. Click OK to close the Display Options  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 SFR2 Package  \n \n Page 9 of 19 \u00a9 Aquaveo 2024  4.5 Stream Reach and Segment Numbering  \nGMS automatically numbers stream segments and reaches. Numbering in the SFR2 \npackage dialog is covered later in this tutorial.  \nThe SFR1 package documentation states that \u201ct he numbering of segments and reaches \nis important. Segments  are numbered s equentially from the farthest upstream  segment to \nthe last downstream segment \u2026. Reaches within a segment must  be numbered \nsequentially  from the farthest upstream reach in a segment to the last  downstream \nreach \u201d.4 Figure 6 gives an example of stream and segment numbering.  \n \n      Figure 6      Illustration of stream segment and reach numbering5  \nGMS assigns an integer ID number to each arc automa tically as it is created. This ID \nnumber is NOT the stream segment number. Stream segment and reach numbers are \nonly determined when the Map \u2192 MODFLOW  command is executed. Be careful to not \nconfuse arc ID numbers with stream segment numbers.  \n5 Assign Arc Attributes  \nNow review how to assign the stream attributes to the arcs.  \n5.1 Arc A  \n1. Using the Select Arcs   tool, double -click on arc A (see Figure 7) to bri ng up \nthe Attribute Table  dialog.  \n                                                      \n4 Prudic (2004), p.3  \n5 Ibid.  \n\nGMS Tutorials   MODFLOW \u2013 SFR2 Package  \n \n Page 10 of 19 \u00a9 Aquaveo 2024  2. Select \u201cstream (SFR2)\u201d from the drop -down in the Type  column.  \n3. Enter the remaining values as given in the following table. Only columns \nrequiring changes are shown, and some require scrolling to the right to see:  \nICALC  FLOW  HCOND1  THICKM1  ELEVUP  HCOND2  THICKM2  ELEVDN  \ntable (4)  25.0 0.00003  3.0 1095.0  0.00003  3.0 1075.0  \n4. Scroll to the far right and click on the  button in the Flow Table  column to \nbring up the Stream Flow Table  dialog.  \n5. Enter the following into the spreadsheet:  \nFlow  Depth  Width  \n0.5 0.25 3.0 \n1.0 0.4 3.5 \n2.0 0.55 4.2 \n4.0 0.7 5.3 \n7.0 0.8 7.0 \n10.0 0.9 8.5 \n20.0 1.1 12.0 \n30.0 1.25 14.0 \n50.0 1.4 17.0 \n75.0 1.7 20.0 \n100.0  2.6 22.0 \n \n6. When finished, click OK to close the Stream Flow Table  dialog.  \n7. Click OK to close the Attribute Table  dialog.  \n8. Click on a blank spot in the Graphics Window to deselect arc A.  \nNotice that arc A is now a different color than the rest of the stream arcs.  \n \n      Figure 7      Arcs with letters to d istinguish them  \n\nGMS Tutorials   MODFLOW \u2013 SFR2 Package  \n \n Page 11 of 19 \u00a9 Aquaveo 2024  5.2 Arc B through H  \n1. Using the Select Arcs   tool, double -click on arc B to bring up the Attribute \nTable  dialog.  \n2. Repeat steps 2 \u20133 from section 5.1 to assign the values shown in Table 1 and \nTable 2 below.  \n3. Click OK to exit the Attribute Table  dialog.  \n4. Repeat steps 1 \u20133 for arcs C through H.  \nNote that Table 2 is a continuation of Table 1 due to width limitations.  \n \nArc () Type  ICALC  Diversion  FLOW  ROUGHCH  ROUGHBK  CDPTH  FDPTH  AWDPTH  BWDTH  \nA \nStream \n(SFR2)  \n table (4)   25.0       \nB wide channel (1)    0.03      \nC specified (0) \uf0fc 10.0       \nD wide channel (1)   10.0 0.03      \nE power function (3)      0.3 0.35 3.8 0.6 \nF wide channel (1)    0.03      \nG cross section (2)   150.0 0.025 0.045     \nH cross section (2)    0.025 0.045     \n      Table 1      Stream arc attributes  \n \nArc () HCOND1  THICKM1  ELEVUP  WIDTH1  DEPTH1  HCOND2  THICKM2  ELEVDN  WIDTH2  DEPTH2  \nA 0.00003  3.0 1095 .0   0.00003  3.0 1075 .0   \nB 0.00003  3.0 1075 .0 12.0  0.00003  3.0 1050 .0 12.0  \nC 0.00003  2.0 1075 .0 10.0 2.0 0.00003  2.0 1060 .0 6.0 1.0 \nD 0.00003  3.0 1080 .0 10.0  0.00003  3.0 1060 .0 10.0  \nE 0.00003  3.0 1060 .0   0.00003  3.0 1045 .0   \nF 0.00003  3.0 1045 .0 12.0  0.00003  3.0 1025 .0 12.0  \nG 0.00006  3.0 1040 .0   0.00006  3.0 1025 .0   \nH 0.00006  3.0 1025 .0   0.00006  3.0 990.0   \n      Table 2      Stream arc attributes , continued  \n5.3 Channel Cross Sections  \nBecause arcs G and H use a cross section to determine the stream depth, the cross \nsection points need to be entered.  \n1. Using the Select Arcs   tool, double -click on arc G to bring up the Attribute \nTable  dialog.  \n2. Scroll to the right to the Channel Cross Section  column and click the  button \nto bring up the XY Series Editor  dialog.  \n3. Enter the following values in the XY Series Editor : \n \nDistance  Elevation  \n0 20 \n10 13 \n80 10 \n\nGMS Tutorials   MODFLOW \u2013 SFR2 Package  \n \n Page 12 of 19 \u00a9 Aquaveo 2024  100 2 \n150 0 \n170 10 \n240 13 \n250 20 \n4. Click OK to exit the XY Series Editor  dialog.  \n5. Click OK to exit the Attribute Table  dialog.  \n6. Repeat steps 1 \u20135 for arc H, using the table below for the XY Series Editor  dialog:  \n \nDistance  Elevation  \n0 25 \n10 17 \n80 13 \n100 4 \n150 0 \n170 10 \n240 16 \n250 20 \n7. Click in a blank spot in the Graphics Window to deselect all arcs.  \nAll of the arcs should now have changed to the same color as arc A.  \n5.4 Segment IDS  \nGMS can display the stream segment ID numbers by doing the following.  \n1. Click Display Options   to bring up the Display Options  dialog.  \n2. Select \u201c  Map Data\u201d from the list on the left.  \n3. At the bottom of the first section on the Map tab, turn on Segment ID . \n4. Click OK to exit the Display Options  dialog.  \nNotice the \u201c0\u201d displayed in t he middle of each arc. The conceptual model has not yet \nbeen mapped to the grid using the Map \u2192 MODFLOW  command. Until this is done, \nGMS does not know how the stream segments should be numbered. After the Map \u2192 \nMODFLOW is done, the stream segment numbers w ill follow the rule of upstream to \ndownstream.  \n6 Map \u2192 MODFLOW  \nEverything that was needed has been entered to in the conceptual model and can now \nbe mapped to the grid.  \n1. Select Feature Objects | Map \u2192 MODFLOW  to bring up the Map \u2192 Model  \ndialog.  \n2. Click OK to accept the defaults and close the Map \u2192 Model  dialog .  \nNotice the stream segment numbers are no longer all zeroes. The stream segments have \nbeen numbered so that downstream numbers are always greater than upstream \nnumbers.  \n\nGMS Tutorials   MODFLOW \u2013 SFR2 Package  \n \n Page 13 of 19 \u00a9 Aquaveo 2024  6.1 SFR2 Package Dialog  \nThe strea ms in the conceptual model have now been mapped to the grid. The \nMODFLOW Stream (SFR2) Package  dialog shows all of the stream segments and \nreaches on the grid.  \n1. Turn on and select \u201c  3D Grid Data\u201d in the Project Explorer to make it active.  \n2. Select MODFLOW  | Optional Packages | SFR2 \u2013 Streamflow -Routing\u2026  to \nbring up the MODFLOW Stream (SFR2) Package  dialog ( Figure 8). \n \n      Figure 8      MODFLOW Stream (SFR2) Package dialog  \nThe stream segments are listed in the top spreadsheet and the reaches in the bottom \nspreadsheet. GMS calculated the reach lengths (RCHLEN) during the Map \u2192 \nMODFLOW  process.  \nSegment numbers (NSEG), reach cell IDs , and the ISEG or IREACH numbers cannot be \nedited \u2014and segments and reaches cannot be added \u2014in this dialog. Stream data can \nonly be created by mapping to MODFLOW from a conceptual model. If a MODFLOW \nsimulation with SFR2 data is imported, it will populate t he stream package dialog even if \na conceptual model doesn\u2019t exist.  \n3. Click OK to exit the MODFLOW Stream (SFR2) Package  dialog.  \n6.2 Save the Project and Run MODFLOW  \nNow to save the project and run MODFLOW:  \n1. Save   the project.  \n\nGMS Tutorials   MODFLOW \u2013 SFR2 Package  \n \n Page 14 of 19 \u00a9 Aquaveo 2024  2. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n3. When the model finishes, turn on Read solution on exit and Turn on contours (if \nnot on already).  \n4. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.  \nThe Graphics Window should appear  similar to Figure 9. \n \n      Figure 9      Solution showing the contours  \n6.3 Compare the Solutions  \nCompare the new solution with the original one from the USGS.  \n1. Click Contour Options   to bring up the Dataset Contour Options \u2013 3D Grid \u2013 \nHead  dialog.  \n2. In the Contour method  section, select \u201cLinear\u201d from the first drop -down and \u201cUse \ncolor ramp\u201d from the second drop -down.  \n3. In the Contour interval  section, select \u201cSpecified values\u201d from the drop -down and \nenter \u201c5\u201d in the field to the right of the drop -down.  \n4. In the spreadsheet below that, enter \u201c1000.0\u201d for dark blue, \u201c1020.0\u201d for cyan, \n\u201c1040.0\u201d for green, \u201c1060.0\u201d for yellow\u201d, and \u201c1080.0\u201d for red.  \nThe dialog should appear as in Figure 10. \n\nGMS Tutorials   MODFLOW \u2013 SFR2 Package  \n \n Page 15 of 19 \u00a9 Aquaveo 2024   \n      Figure 10      Contour Options dialog  \n5. Click OK to exit the Dataset Contour Options \u2013 3D Grid \u2013 Head dialog.  \n6. In the Project Explorer, turn on the \u201c  GIS Layers\u201d folder.  \nNotice how the GMS contours match the contours on the background image pretty \nclosely. The match isn\u2019t perfect for a couple of reasons. First, the stream input generated \nby GMS differs some from the original USG S input. In particular, the reach lengths are \ndifferent. The original USGS files, which were built by hand, contain rough estimates for \nthe length of the stream channel within each model cell. GMS, on the other hand, \ncalculates this value by intersecting t he stream arcs with the grid cells.  \nThe second reason why the contour lines differ is due to the different methods used by \nthe USGS and GMS to interpolate and generate contour lines from gridded data.  \n7. Turn off the \u201c  GIS Layers\u201d folder.  \n6.4 Compare the Solutions  \nSince this model is transient, a good way to examine the results is to use an animation. In \nthis case, animate the color filled contours.  \n1. Click Contour Options   to bring up the Dataset Contour Options \u2013 3D Grid \u2013 \nHead dialog.  \n2. In the Contour meth od section, select \u201cColor Fill\u201d from the first drop -down.  \n3. Click OK to close the Dataset Contour Options \u2013 3D Grid \u2013 Head dialog.  \n4. Select Display | Animate\u2026  to bring up the Animation Wizard \u2013 Options  dialog.  \n5. Accept the defaults and click Next  to bring up the Animation Wizard \u2013 Datasets  \ndialog.  \n6. Click Finish  to accept the defaults and close the Animation Wizard \u2013 Datasets  \ndialog.  \n\nGMS Tutorials   MODFLOW \u2013 SFR2 Package  \n \n Page 16 of 19 \u00a9 Aquaveo 2024  Depending on the speed of the computer being used, it may take a minute or two to \ngenerate the animation. After it is  finished generating, the animation file can be viewed in \na media player application outside of GMS. The animation clearly shows how the wells \ndraw down the head in the first stress period and how the head recovers in the second \nstress period.  \n6.5 Flow Budget  \nNow to look at the flow budget for streams:  \n1. Select MODFLOW| Flow Budget\u2026  to bring up the Flow Budget  dialog.  \nNotice the entries in the Flow In  and Flow Out  columns on the Stream Leakage  row. \nThere is more flow in than out because the streams are mostly los ing water. Water is \nflowing from the streams into the aquifer in most places, but there is some flow out from \nthe aquifer to the streams.  \n2. Click OK to close the Flow Budget  dialog.  \nWith other MODFLOW packages, clicking on a feature object in the map module will \nallow the flow associated with that object to be visible. GMS does this by using the \nMODFLOW OBS process. Streams are not part of the OBS process, so this is not \navailable. However, the flow can be viewed on a cell -by-cell basis.  \n3. In the Project Explor er, select the \u201c  3D Grid Data\u201d item to make it active.  \n4. Select and then right -click on \u201c  CCF (SFR2_GMS.ccf) and select CCF \u2192 \nDatasets . \nNotice that a number of datasets have appeared within the solution folder.  \n5. Select \u201c  STREAM LEAKAGE\u201d to make it active.  \n6. Click Contour Options   to bring up the Dataset Contour Options \u2013 3D Grid \u2013 \nSTREAM LEAKAGE dialog.  \n7. In the Contour method  section, select \u201cBlock Fill\u201d from the first drop -down.  \n8. In the Contour interval  section, select \u201cNumber\u201d from the drop -down and enter \n\u201c10\u201d in the field to the right of the drop -down.  \n9. Click OK to exit the Dataset Contour Options \u2013 3D Grid \u2013 STREAM LEAKAGE \ndialog.  \nThe Graphics Window should appear similar to Figure 11.  \n\nGMS Tutorials   MODFLOW \u2013 SFR2 Package  \n \n Page 17 of 19 \u00a9 Aquaveo 2024   \n      Figure 11      Block Fill showing stream in/out flow  \nUsing the Select Cells   tool, move the mouse over the grid cells and watch the status \nbar at the bottom of the Graphics Window to see what the stream flow is throughout the \ngrid. \n7 Creating an SFR Parameter  \nAn SFR parameter can be created by changing the conductance on the first S FR \nsegment at the top -left of the model to use a parameter instead of specifying the \nconductance value.  \n1. Select \u201c  Map Data\u201d in the Project Explorer to make it active.  \n2. Using the Select Arcs   tool, double -click on the top -left arc to open the \nAttribute Tabl e dialog.  \n3. In the HCOND1  and HCOND2  columns, enter \u201c -10.0\u201d.  \n4. Click OK to exit the Attribute Table  dialog.  \n5. Select Feature Objects | Map \u2192 MODFLOW  to bring up the Map \u2192 Model  \ndialog.  \n6. Click OK to accept the defaults and close the Map \u2192 Model  dialog.  \n7. Select MODF LOW | Parameters\u2026  to bring up the Parameters dialog.  \n8. Click Initialize from Model .  \n\nGMS Tutorials   MODFLOW \u2013 SFR2 Package  \n \n Page 18 of 19 \u00a9 Aquaveo 2024  Notice that a new parameter has been created.   \n9. Enter \u201c0.00003\u201d in the Value  column. Adjust the column width for Value  if needed \nto see the entry.  \n10. Click OK to exit the Param eters  dialog.  \n11. Select MODFLOW | Optional Packages | SFR2 \u2013 Streamflow -Routing\u2026  to \nbring up the MODFLOW Stream (SFR2) Package dialog.  \nNotice that the Segments  table now has Hc1fact  and Hc2fact  columns at the far right \n(scroll all the way to the right to see them).  The values listed in these columns are \nmultiplied by the parameter value to give the final conductance values for the SFR \nboundary condition.  \n12. Click OK to exit the MODFLOW Stream (SFR2) Package  dialog.  \n7.1 Flow Budget  \nNow it is possible to save the chan ges and run MODFLOW.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cSFR2_GMS2.gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n5. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n6. When the model finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n7. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog. \nNotice that the new solution is the same as the previous run ( Figure 12). \nGMS Tutorials   MODFLOW \u2013 SFR2 Package  \n \n Page 19 of 19 \u00a9 Aquaveo 2024   \nFigure 12      Solution using SFR parameters  \n8 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 SFR2 Package\u201d tutorial. The following  key concepts \nwere discussed and demonstrated in this tutorial : \n\uf0b7 It is possible to use GMS to create MODFLOW models with STR1, SFR1, and \nSFR2 type streams.  \n\uf0b7 Streams must be created in the Map module using Feature Objects and cannot \nbe created directly on the grid.  \n\uf0b7 It is necessary to make sure that the stream arcs are oriented from upstream to \ndownstream correctly.  \n\uf0b7 The conceptual model does not have to include all aspects of the model . In this \ncase, the conceptual model contained only the streams and the other boundary \nconditions were already part of the grid.  \n\uf0b7 GMS automatically determines the proper ordering of the stream data for input to \nMODFLOW based on the orientation and topology of the stream arcs.  \n\uf0b7 Other MODFLOW packages allow feature objects to be selected to see the flow \nin or out of that object. The streams packages do not support this feature.  \n\uf0b7 GMS supports SFR parameters.  \n \n\n", "filename": "MODFLOW-SFR2Package.pdf", "pages": 19}, "MODFLOW-StochasticModeling-IndicatorSimulations": {"text": "GMS Tutorials   MODFLOW \u2013 Stochastic Modeling, Indicator Simulations  \n Page 1 of 9 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Stochastic Modeling, Indicator Simulations  \nUse T -PROGS to create multiple material sets and run MODFLOW \nstochastically  \n \nObjectives   \nThis tutorial teaches how to use the indicator simulation approach to  perform a stochastic simulation in \nGMS . \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Stochastic \nModeling, Parameter \nRandomization  \n\uf0b7 T-PROGS  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 Stochastic & T -PROGS  Time  \n\uf0b7 35\u201350 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling, Indicator Simulations  \n Page 2 of 9 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 Importing the Project  ................................ ................................ ................................ ..... 3 \n3 The Indicator Simulation  ................................ ................................ ................................ ..... 4 \n3.1 The MODFLOW Model Data ................................ ................................ .........................  4 \n3.2 Selecting the Stochastic Option  ................................ ................................ ....................  5 \n3.3 Saving the Project and Running MODFLOW  ................................ ................................  5 \n4 Analyzing the Results  ................................ ................................ ................................ .........  5 \n4.1 Importing and Viewing the MODFLOW Solutions  ................................ .........................  5 \n4.2 Displaying Pathlines  ................................ ................................ ................................ ..... 6 \n4.3 Probabilistic Capture Zone Analysis  ................................ ................................ .............  7 \n5 Conclusion  ................................ ................................ ................................ ...........................  9 \n \n1 Introduction  \nGMS supports three methods for performing stochastic simulations: parameter \nrandomization, indicator simulations, and PEST Null Space Monte Carlo. The indicator \nsimulation approach is described in this tutorial. With the indicator simulation approach, \nmultiple equally probable \u201crealizations\u201d of the aquifer stratigraphy are generated. These \nrealizations represent different distributions of material (indicator) zones within the \naquifer. A set of aquifer properties is associated with the materials, and the model is run \nonce for each of the n realizations.  \nIn GMS, the multiple realizations of the aqu ifer heterogeneity are typically generated \nusing the T -PROGS software. T -PROGS can be used to generate two types of output: \nmultiple material sets (arrays of material IDs), or multiple MODFLOW HUF input sets. In \neach case, GMS can launch MODFLOW in batch m ode and generate a flow solution for \neach model instance. This tutorial uses a predefined set of materials generated by T -\nPROGS. The steps involved in running a T -PROGS simulation are described in the \u201c T-\nPROGS \u201d tutorial.  \nThe model imported in this tutorial is based on the Longhorn Army Ammunition \nProduction (LHAAP) site in Texas used in the \u201c T-PROGS \u201d tutorial. While using the same \nsite boundaries, the grid used in this simulation will have only one layer to facilitate a \nshorter run time. A predefined T -PROGS simulation containing 30 material sets will be \nused.  \nThe material sets will be used with the stresses and boundary conditions depicted in       \nFigure  1. There is a small drinking water well on the right side of the model. This well \naverages 25 m3/d. The regional ground water flow is from left to right. Specified head \nboundaries will be used at the left and right edges of the model at 180 m and 170 m, \nrespectively.  \nOnce the model is set up, MODFLOW will run in stochastic mode to generate 30 \nsolutions. Pathlines will be created. A dataset will be generated representing probability \nof capture by the extraction well. This d ataset will then be contoured to illustrate capture \nzone boundaries for different probabilities of capture.  \nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling, Indicator Simulations  \n \n Page 3 of 9 \u00a9 Aquaveo 2024  \n \nRegional \nGround Water \nFlow Direction  H = 170 m  \nExtraction Well  \nBoundary of \nLocal Scale \nModel  H = 180 m   \n      Figure 1      Conceptual representation of site to be modeled  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2.1 Importing the Project  \nFirst, import a project containing the MODFLOW model and the material sets generated \nby T-PROGS by doing the following:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the sto_matset  \\sto_matset \\ directory and select \u201c lhaap.gpr \u201d. \n4. Click Open  to impo rt the project and exit the Open  dialog . \nA one layer MODFLOW model should appear ( Figure 2). It is rotated at a 40\u02da angle and \nshowing a four -material distribution. Now view the different material sets generated by T -\nPROGS:  \n5. Fully expand the \u201c  3D Grid Data \u201d folder  in the Project Exp lorer  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling, Indicator Simulations  \n \n Page 4 of 9 \u00a9 Aquaveo 2024  6. Review the material sets in the \u201c  Simulation \u201d folder by selecting each in turn. \nUse the up and down arrow keys on the keyboard to cycle through the material \nsets.  \n \n      Figure 2      The initial model, showing four materi al sets  \n3 The Indicator Simulation  \n3.1 The MODFLOW Model Data  \nMost of the MODFLOW data for this model (boundary conditions, well pumping rate, top \nand bottom elevations, and so on) has already been entered. However, review the \nMODFLOW data that are somewhat more  unique to this type of simulation.  \n1. Select MODFLOW  | LPF \u2013 Layer Property Flow\u2026  to open the LPF Package  \ndialog.  \nAt the top of the dialog, notice that the Use material IDs  option is selected for the Layer \nproperty entry method . This means that an array of K (hydraulic conductivity) values will \nnot be entered as is normally the case with MODFLOW. Instead, material IDs are used to \ndefine the K values.  \n2. Click Material IDs \u2026 to open the Materials dialog.  \nThis dialog illustrates the material IDs assigned to cells. These material IDs are inherited \nfrom the active material set generated by T -PROGS.  \n3. Click OK to exit the Materials dialog.  \n4. Click Material Properties \u2026 to open the Materials dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling, Indicator Simulations  \n \n Page 5 of 9 \u00a9 Aquaveo 2024  This dialog is used to assign aquifer properties \u2014including hydraulic conductivity \u2014to \neach of the materials used by the model. Notice that a value has been assigned for \nHorizontal k  and Vertical k  for each material. Since this is a one layer model only the \nhydraulic conducti vity value will be used. When the MODFLOW model is saved, GMS \nuses the array of material IDs and the list of material properties to automatically generate \nthe array of K values required by MODFLOW.  \n5. Click OK to exit the Materials  dialog.  \n6. Click OK to exit the LPF Package dialog.  \n3.2 Selecting the Stochastic Option  \nBefore running MODFLOW, it is necessary to turn on the appropriate stochastic \nsimulation options. First, select the stochastic run option:  \n1. Select MODFLOW  | Global Options\u2026  to open the  MODFLOW Global/Basic \nPackage dialog.  \n2. In the Run Options  section, select Stochastic . \n3. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \nNext, specify the use of the material set method (as opposed to parameter \nrandomization) in this stochastic simul ation. When choosing the material set option, \nspecify which group (folder) of material sets to use. In this case, only one group called \n\u201cSimulation \u201d is specified.  \n4. Select MODFLOW  | Stochastic \u2026 to open the Stochastic Options dialog.  \n5. Select Material sets . \n6. Select \u201cSimulation \u201d from the drop -down to the right of Material sets . \n7. Click OK to exit the Stochastic Options  dialog.  \n3.3 Saving the Project and Running MODFLOW  \nNow to save the project and run MODFLOW in stochastic mode:  \n1. Select File | Save As\u2026  to bring up the Save As dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cmatsto.gpr \u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog . \n5. Select MODFLOW  | Run MODFLOW  to bring up the Stochastic MODFLOW  \nmodel wrapper dialog.  \nMODFLOW is now running in stochastic mode. As each model run finishes, the \nspreadsheet at the top will indicate whether or not the run converged.  \n4 Analyzing the Results  \n4.1 Importing and Viewing the MODFLOW Solutions  \nOnce all the M ODFLOW runs are completed, import the solutions.  \nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling, Indicator Simulations  \n \n Page 6 of 9 \u00a9 Aquaveo 2024  1. Turn on Read solution on exit  and Turn on contours (if not on already) . \n2. Click Close  to close the Stochastic MODFLOW  dialog and open the Reading \nStochastic Solutions  dialog.  \n3. Click OK to import the solutions and close the Reading Stochastic Solutions  \ndialog.  \nContour lines and other symbols will appear on the model ( Figure 3).  \n \n      Figure 3      The model after the stochastic MODFLOW run  \nNotice the new \u201c  matsto (MODFLOW)(STO) \u201d folder in the Project Explorer . The folder \ncan be expanded in order to view the individual solutions. Notice that the contours vary \ngreatly depen ding on the distribution of materials. The head loss occurs primarily in the \nclay zones. While viewing a particular solution, notice that the material set is updated to \ncorrespond to the material set used to generate that particular solution.  \n4.2 Displaying Pa thlines  \nBefore performing the probabilistic capture zone analysis, first view the capture zones \ncorresponding to individual solutions.  \n1. Select MODPATH | Create Particles at Wells\u2026  to bring up the Generate \nParticles at Wells  dialog.  \n2. Click OK to accept the default options and close the Generate Particles at Wells  \ndialog.  \nA set of pathlines should appear ( Figure 4). When clicking on different MODFLOW \nsoluti ons in the Project Explorer , the pathlines will be automatically updated. Notice how \ndramatically the capture zone changes from one solution to the next.  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling, Indicator Simulations  \n \n Page 7 of 9 \u00a9 Aquaveo 2024   \n      Figure 4      Pathlines stretching from the well  \n4.3 Probabilistic Captur e Zone Analysis  \nWith a MODFLOW stochastic solution set, it is possible to perform a probabilistic capture \nzone analysis for the wells in the model. A probabilistic capture zone analysis is \nperformed by placing one or more particles in each cell and trackin g the particles forward \nin time using MODPATH to see if they reach a well. If any of the particles from a cell \nreach the well, a counter for the cell is updated. After running MODPATH on each of the \nMODFLOW solutions, the percentage of particles from a par ticular cell that are eventually \ncaptured by the well is computed and saved as the capture probability for the cell. The \ncapture probability dataset can then be contoured.  \n1. Right -click on \u201c  matsto (MODFLOW)(STO) \u201d and select Risk Analysis\u2026  to \nbring up the Risk Analysis Wizard  dialog.  \n2. Select \u201cMODFLOW\u201d from the box at the top.  \n3. Select Probabilistic capture zone analysis  below the box.  \n4. Click Next  to go to the Capture Zone Analysis  dialog.  \nThis dialog can be used to specify options for the position and number of particles for \neach cell.  \n5. In the Particle starting locations  section, select Distribute particles on water table \nsurface . \n6. In the Tracking duration  section, select To end . \n7. Click Finish  to close the Capture Zone Analysis  dialog.  \nA progress bar should appear at the bottom of the Graphics Window, showing the \nprogress of computing the number of particles captured at the well. When the \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling, Indicator Simulations  \n \n Page 8 of 9 \u00a9 Aquaveo 2024  computations are finished, a new \u201c  well\u201d dataset will be added to the \u201c  matsto \n(MODFLOW)(STO) \u201d folder. This dataset contains the probability that any particles placed \nat the water table will reach the well.  \nThe best way to view this dataset is to turn on color filled contours.  \n8. Click Contour Options   to open the Dataset Contour Options \u2013 3D Grid \u2013 well \ndialog.  \n9. Select \u201c Color Fill \u201d from the top Contour method  drop-down.  \n10. Click Color Ramp\u2026 to open the Choose color ramp  dialog . \n11. Select the Hue 1 color palette.  \n12. Click OK to exit the Choose color ramp  dialog.  \n13. Turn on Legend . \n14. Click OK to exit the Dataset Contour  Options \u2013 3D Grid \u2013 well dialog.  \n15. Turn off the \u201c  Particle Sets \u201d folder in the Project Explorer  to make the contours \nmore visible.  \nA zone of probability now extends from the well ( Figure 5). \n \n      Figure 5      Zone of probability in contours  \n \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling, Indicator Simulations  \n \n Page 9 of 9 \u00a9 Aquaveo 2024  5 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 Stochastic Modeling, Indicator Simulations\u201d tutorial. \nThe following key concepts were discussed and demonstrat ed in this tutorial:  \n\uf0b7 GMS supports two types of stochastic approaches: parameter randomization and \nindicator simulations  \n\uf0b7 The Risk Analysis Wizard  can be used to do a probabilistic capture zone \nanalysis.  \n \n", "filename": "MODFLOW-StochasticModeling-IndicatorSimulations.pdf", "pages": 9}, "MODFLOW-StochasticModeling-Inverse": {"text": "GMS Tutorials   MOD FLOW \u2013 Stochastic Modeling, Inverse  \n Page 1 of 11 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Stochastic Modeling, Inverse  \nUse PEST to calibrate multiple MODFLOW simulations using material \nsets \n \nObjectives   \nThis tutorial will show how to use the stochastic inverse modeling option for MODFLOW and calibrate \nmultiple MODFLOW models with equally probable \u201crealizations\u201d of the aquifer stratigraphy. This approach \nis demonstrated using the LPF and HUF packages . \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Advanced \nPEST  \n\uf0b7 MODFLOW \u2013 Stochastic \nModeling, Indicator \nSimulations  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 PEST  \n\uf0b7 Parallel PEST  \n\uf0b7 Stochastic & T -PROGS  Time  \n\uf0b7 45\u201360 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MOD FLOW \u2013 Stochastic Modeling, Inverse  \n Page 2 of 11 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 Importing the Project  ................................ ................................ ................................ ..... 3 \n2.2 Reviewing the MODFLOW Model Data  ................................ ................................ ........  4 \n3 Selecting the Stochastic Option  ................................ ................................ .........................  5 \n3.1 Saving the Project and Running MODFLOW  ................................ ................................  5 \n3.2 Importing and Viewing the MODFLOW Solutions  ................................ .........................  6 \n4 Using PEST SVD Assist  ................................ ................................ ................................ ...... 7 \n4.1 Saving the Project and Running MODFLOW  ................................ ................................  8 \n4.2 Importing and Viewing the MODFLOW Solutions  ................................ .........................  8 \n4.3 Probabilistic Capture Zones  ................................ ................................ ..........................  8 \n5 Stochastic Inverse with HUF  ................................ ................................ ..............................  9 \n5.1 Importing and Viewing the MODFLOW Solutions  ................................ .......................  10 \n6 Conclusion  ................................ ................................ ................................ .........................  11 \n \n1 Introduction  \nGMS supports three methods for performing stochastic simulations: parameter \nrandomization, indicator simulations, and PEST Null Space Monte Carlo. These \napproaches are described in separate tutorials. This tutorial will use the indicator \nsimulation approac h in conjunction with PEST to create multiple calibrated MODFLOW \nmodels.  \nThe indicator simulation approach allows for generation of multiple, equally probable \nrealizations of the aquifer stratigraphy. These realizations represent different distributions \nof material (indicator) zones within the aquifer. A set of aquifer properties is associated \nwith the materials and the model is run once for each of the N realizations.  \nIn GMS, the multiple realizations of the aquifer heterogeneity are typically generated \nusing the T -PROGS software. T -PROGS can be used to generate two types of output: \nmultiple material sets (arrays of material IDs), or multiple MODFLOW HUF input sets.  \nFor this tutorial, a pre -defined set of material sets generated by T -PROGS will be used. \nThe steps involved in running a T -PROGS simulation are described in the \u201c T-PROGS \u201d \ntutorial.  \nA groundwater model for a medium -sized basin is shown in Figure 1. The basi n \nencompasses 72.5 square kilometers. It is in a semi -arid climate, with average annual \nprecipitation of 0.381 m/yr. Most of this precipitation is lost through evapotranspiration. \nThe recharge that reaches the aquifer eventually drains into a small stream at the center \nof the basin.  \nThis stream drains to the north and eventually empties into a lake with an elevation of \n304.8 m. Three wells in the basin also extract water from the aquifer. The perimeter of \nthe basin is bounded by low permeability crystallin e rock. There are ten observation wells \nin the basin. There is also a stream flow gauge at the bottom end of the stream.  \nThis tutorial will discuss and demonstrate opening a MODFLOW model using the LPF \npackage, running PEST in stochastic inverse mode, and running Parallel PEST with SVD \nAssist in stochastic inverse mode. It will then show how to view probabilistic capture \nzones, open a MODFLOW model using the HUF package, and running PEST in \nstochastic inverse mode.  \nMultiple realizations of the aquifer prope rties have been generated.  \nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling, Inverse  \n \n Page 3 of 11 \u00a9 Aquaveo 2024   \n      Figure 1      Sample model used in calibration exercise  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2.1 Importing the Project  \nFirst, import a project containing the MODFLOW model and the material sets generated \nby T-PROGS:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files  (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the sto_inv_matset \\sto_inv_matset \\ directory and select \u201c lpf.gpr \u201d. \n4. Click Open  to import the project and exit the Open  dialog . \nA one layer MODFLOW model showing a four -material distribution should be vis ible \n(Figure 2).  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling, Inverse  \n \n Page 4 of 11 \u00a9 Aquaveo 2024   \n      Figure 2      The initial one layer MODFLOW model  \nNow view the different material sets generated by T -PROGS:  \n5. Fully expand the \u201c  3D Grid Data \u201d folder  in the Project Explorer :  \n6. Select the \u201c  TPROGS 1\u201d material set, then use the up and down arrow keys on \nthe keyboard to cycle through the material sets.  \n2.2 Reviewing the MODFLOW Model Data  \nMost of the MODFLOW data for the mod el (boundary conditions, well pumping rate, top \nand bottom elevations, etc.) has already been entered. Before continuing, review the \nMODFLOW data that are somewhat more unique to this type of simulation.  \n1. Select MODFLOW  | LPF \u2013 Layer Property Flow\u2026  to open the LPF Package \ndialog.  \nAt the top of the dialog, notice that the Use material IDs  option is selected for the Layer \nproperty entry method . This means that an array of K (hydraulic conductivity) values will \nnot be entered, as is normally the case with MODFL OW. Instead, material IDs will be \nused to define the K values.  \n2. Click Material IDs \u2026 to open the Materials dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling, Inverse  \n \n Page 5 of 11 \u00a9 Aquaveo 2024  This dialog illustrates the material IDs assigned to cells. These material IDs are inherited \nfrom the active material set generated by T -PROGS.  \n3. Click OK to exit the Materials  dialog.  \n4. Click Material Properties \u2026 to open the Materials dialog.  \nThis dialog is used to assign aquifer properties, including hydraulic conductivity, to each \nof the materials used by the model. Notice that a key  value has been assigned in the \nHorizontal k (m/d)  column for each material. Defined parameters are also being used with \nthe materials. When the MODFLOW model is saved, GMS uses the array of material IDs, \nthe list of material properties, and the parameters  to automatically generate the array of K \nvalues required by MODFLOW.  \n5. Click OK to exit the Materials dialog.  \n6. Click OK to exit  the LPF Package dialog.  \n7. Select MODFLOW | Parameters \u2026 to open the Parameters dialog.  \nNotice that the dialog lists four parameters that correspond to the four materials that are \nassigned to the model grid.  \n8. Click OK to exit the Parameters  dialog.  \n3 Selecting the Stochastic Option  \nBefore running MODFLOW, turn on the appropriate stochastic simulation options. First, \nselect the stochastic i nverse run option:  \n1. Select MODFLOW  | Global Options\u2026  to open the MODFLOW Global/Basic \nPackage dialog.  \n2. In the Run options  section, select the Stochastic Inverse . \n3. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \nNext, specify the use of the material set method (as opposed to HUF set) in the \nstochastic simulation. When choosing the material set option, specify the desired group \n(folder) of material sets to use. In this case, use the \u201c TPROGS \u201d folder that has only two \nsimulations.  \n4. Select MODFLOW  | Stocha stic\u2026  to bring up the Stochastic Options  dialog.  \n5. In the Simulation Method  section, select Material sets . \n6. Select \u201c TPROGS \u201d from the Material sets  drop-down.  \n7. Click OK to exit the Stochastic Options  dialog.  \n3.1 Saving the Project and Running MODFLOW  \nNow save the p roject and run MODFLOW in stochastic mode.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter  \u201clpf_sto.gpr \u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog . \nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling, Inverse  \n \n Page 6 of 11 \u00a9 Aquaveo 2024  5. Select MODFLOW  | Run MODFLOW  to bring up the MODFLOW/PEST \nParameter Estimation dialog . \nPEST  and MODFLOW are now running in stochastic inverse mode. As each model run \nfinishes, the spreadsheet on the lower right will indicate the number of PEST iterations, \nthe model error, and the parameter values. Depending on the speed of the computer, the \nsimu lation may take several minutes to complete.  \n3.2 Importing and Viewing the MODFLOW Solutions  \nOnce all the MODFLOW runs are completed, import the solutions.  \n1. Turn on Read solution on exit  and Turn on contours (if not on already) . \n2. Click Close  to close the MODFLOW /PEST Parameter Estimation  dialog and \nbring up the Reading Stochastic Solutions  dialog.  \n3. Click OK to close the Reading Stochastic Solutions  dialog and import the \nsolutions.  \n4. Fully expand the new \u201c  lpf_sto (MODFLOW)(STO) \u201d folder in the Project \nExplorer.  \n5. Select the \u201c  lpf_sto001 (MODFLOW)\u201d solution in the Project Explorer.  \nThe model should appear similar to Figure 3. \n \n      Figure 3      Contours for the lpf_sto001 solution  \n6. Select the \u201c  lpf_sto002 (MODFLOW)\u201d solution in the Project Explorer.  \nNotice that the contours for each solution vary greatly according to the distribution of \nmaterials (compare Figure 3 and Figure 4). Notice also that the material set is updated to \ncorrespond to the material set used to generate each particular solution.  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling, Inverse  \n \n Page 7 of 11 \u00a9 Aquaveo 2024   \nFigure 4      Contours for the lpf_sto00 2 solution  \n4 Using PEST SVD Assist  \nInstead of specifying a single value for each material, it is possible to use pilot points to \nestimate the HK of each material. Specifying pilot points and undertaking a stochastic \ninverse model with early versions of PEST  would have taken too much time because of \nthe number of model runs required. However, SVD -Assist greatly reduces the number of \nrequired runs, and the process can be sped up further by using Parallel PEST.  \nFirst, assign pilot points to the parameters then turn on Parallel PEST and SVD Assist:  \n1. Select MODFLOW | Parameters\u2026  to open the Parameters dialog.  \n2. Select \u201c <Pilot points> \u201d from the  drop-down in the Value  column for the \n\u201cHK_Sand \u201d parameter row.  \n3. Click the  button above the  drop-down on the \u201c HK_Sand \u201d parameter row \nto bring up the 2D Interpolation Options  dialog.  \n4. In the Interpolating from  section , select \u201csand\u201d from the Dataset  drop-down.  \n5. Click OK to exit the 2D Interpolation Options  dialog.  \n6. Repeat steps 2 \u20135 for the other three parameters (\u201cHK_Silt\u201d, \u201cHK_ ClSilt\u201d, and \n\u201cHK_ClSand\u201d), selecting the appropriate material for the dataset in step 4.  \n7. Click OK to exit the Parameters  dialog.  \n8. Select MODFLOW | Parameter Estimation \u2026 to open the PEST dialog.  \n9. In the Parallel PEST  section, turn on Use Parallel PEST .  \n10. In the SVD options  section, turn on Use SVD  and Use SVD -Assist . \n11. Select OK to exit the PEST  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling, Inverse  \n \n Page 8 of 11 \u00a9 Aquaveo 2024  4.1 Saving the Project and Running MODFLOW  \nBefore running MODFLOW in stochastic mode, save the project:  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter  \u201clpf_sto1.gpr \u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog . \n5. Click Run MODFLOW   to bring up the MODFLOW/PEST Parameter \nEstimation  dialo g. \nParallel PEST and MODFLOW now run in stochastic inverse mode. The time needed to \nfinish this run will vary depending on the speed of the computer running it.  \n4.2 Importing and Viewing the MODFLOW Solutions  \nOnce all the MODFLOW runs are completed, import the  solutions:  \n1. Turn on Read solution on exit  and Turn on Contours (if not on already) . \n2. Click Close  to exit the MODFLOW/PEST Parameter Estimation  dialog and bring \nup the Reading Stochastic Solutions  dialog.  \n3. Click OK to import the solutions and close the Readin g Stochastic Solutions  \ndialog.  \n4. Fully expand the new \u201c  lpf_sto1 (MODFLOW)(STO) \u201d folder in the Project \nExplorer . \nNotice that the observation targets for these new results are more similar than those in \nthe previous stochastic inverse run.  \n4.3 Probabilistic Capture Zones  \nNow import the results from a stochastic inverse run using the \u201c TPROGS_A \u201d material \nsets:  \n1. Select MODFLOW | Read Solution\u2026  to bring up the Open  dialog.  \n2. Select \u201cMODFLOW Name Files (*.mfn)\u201d from the drop -down to the right of the \nFile name  field.  \n3. Browse to the sto_inv_matset \\sto_inv_matset \\run1_MODFLOW  directory and \nselect \u201c run1.mfn \u201d.  \n4. Click Open  to exit the Open  dialog and bring up the Reading Stochastic \nSolutions  dialog.  \n5. Click OK to import all of the solutions and close the Reading Stochastic Sol utions  \ndialog.  \n6. Right -click on the new \u201c  run1 (MODFLOW)(STO) \u201d folder  in the Project Explorer  \nand select Risk Analysis \u2026 to bring up the Risk Analysis Wizard  dialog.   \n7. Below the list field, select Probablistic capture zone analysis . \n8. Click Next  to go to the Capture Zone Analysis  dialog.  \n9. Click Finish  to run the analysis and close the Capture Zone Analysis  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling, Inverse  \n \n Page 9 of 11 \u00a9 Aquaveo 2024  MODPATH is now running in the background. A progress bar should update as \nMODPATH is run for each of the simulations in the stochastic solution. When M ODPATH \nis finished running, GMS will create a new dataset for each well in the model. The \nprobability of capture from each cell to each well in the model can be viewed.  \n10. Expand \u201c  Display Themes \u201d in the Project Explorer  and select \u201c color fill \ncontours \u201d. \nContours similar to Figure 5 will now be visible showing the probabilistic capture zone for \nthe well near the top of the model.  \n \n      Figure 5      Probabilistic c apture zone for a well  \n5 Stochastic Inverse with HUF  \nThe stochastic inverse approach can also be used with multiple HUF data sets. Now \nimport a project with multiple HUF datasets and run a stochastic inverse model.  \n1. Save  the current  project.  \n2. Click  New  to start a new project and reset to GMS defaults.  \n3. Click  Open   to bring up the Open  dialog.  \n4. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n5. Browse to the sto_inv_matset \\sto_inv_matset \\ directory and select \u201c huf.gpr \u201d. \n6. Click Open  to open the project and exit the Open  dialog.  \n7. Select \u201c  3D Grid Data\u201d to make it active.  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling, Inverse  \n \n Page 10 of 11 \u00a9 Aquaveo 2024  8. Select Edit | Select by ID\u2026  to bring up the Find Grid Cell  dialog.  \n9. Enter \u201c1452\u201d in the Cell ID  field and click OK to close the Find Grid Cell  dialog.  \n10. Switch to Side View  . \nThe model should appear similar to Figure 6. This model is the same as the one \npreviously used. However, this model uses the HUF package instea d of the LPF \npackage. Notice the different hydrogeologic units defined in the HUF package now \nvisible.  \n \n      Figure 6      Hydrogeologic units from the HUF package  \n11. Select MODFLOW | Global Options \u2026 to open the MODFLOW Global/Basic \nPackage dialog.  \n12. In the Run Options  section, select the Stochastic Inverse option.  \n13. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n14. Select MODFLOW | Stochastic\u2026  to bring up the Stochastic Options  dialog.  \n15. In the Simulation Metho d section, select HUF sets  and select \u201c TPROGS \u201d from \nthe drop -down to the right.  \n16. Click OK to exit the Stochastic Options  dialog.  \n17. Select File | Save As \u2026 to bring up the Save As  dialog.  \n18. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n19. Enter  \u201chuf_sto.gpr \u201d as the File name . \n20. Click Save  to save the project under the new name and close the Save As  \ndialog . \n21. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW/PEST \nParameter Estimation  dialog.  \nParallel PEST and MODFLOW are now running in stochastic in verse mode. The model \nrun may take several minutes, depending on the speed of the computer being used.  \n5.1 Importing and Viewing the MODFLOW Solutions  \nOnce all the MODFLOW runs are completed, import the solutions.  \n1. Turn on Read solution on exit  and Turn on cont ours (if not on already) . \n2. Click Close  to close the MODFLOW/PEST Parameter Estimation  dialog and \nbring up the Reading Stochastic Solu tions dialog.  \n3. Click OK to import all converged solutions and close the Reading Stochastic \nSolutions  dialog.  \n4. Switch to Plan V iew . \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling, Inverse  \n \n Page 11 of 11 \u00a9 Aquaveo 2024  5. Fully expand the \u201c  3D Grid Data\u201d folder.  \n6. Select the \u201c  huf_sto 002 (MODFLOW)\u201d solution in the \u201c  huf_sto \n(MODFLOW)(STO)\u201d folder.  \nThe model should appear similar to Figure 7. Notice that the HUF data is updated to \ncorrespond to the HUF set used to generate that particular solution. Feel free to review \nthe \u201c  huf_sto 001 (MODFLOW)\u201d solution as well.  \n \n      Figure 7      The final view of the model for the huf_sto002 solution  \n6 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 Stochastic Modeling, Inverse\u201d tutorial. The following \nkey concepts were discussed and demonstrated in this tutorial:  \n\uf0b7 Calibratin g multiple models using the stochastic inverse modeling option.  \n\uf0b7 The stochastic inverse modeling approach supports material sets and HUF sets.  \n\uf0b7 Material sets and HUF sets can be created using TPROGS.  \n\uf0b7 The Risk Analysis Wizard  can be used to do a probabilistic  capture zone \nanalysis.  \n \n\n", "filename": "MODFLOW-StochasticModeling-Inverse.pdf", "pages": 11}, "MODFLOW-StochasticModeling-NullSpaceMonteCarloI": {"text": "GMS Tutorials   MODFLOW \u2013 Stochastic Modeling, PEST Null Space Monte Carlo I  \n Page 1 of 13 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Stochastic Modeling, PEST Null Space Monte \nCarlo I  \nUse PEST to create  multiple calibrated MODFLOW simulations  \nObjectives   \nThe PEST Null Space Monte Carlo modeling option for MODFLOW is described. Null  Space Monte Carlo \nis used to create multiple calibrated MODFLOW models . \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Advanced \nPEST  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 PEST  \n\uf0b7 Parallel PEST  \n\uf0b7 Stochastic & T -PROGS  Time  \n\uf0b7 30\u201340 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling, PEST Null Space Monte Carlo I  \n Page 2 of 13 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 Importing the Project  ................................ ................................ ................................ ..... 4 \n3 Using the Null Space Monte Carlo Method  ................................ ................................ ........  5 \n3.1 The MODFLOW Run Options  ................................ ................................ .......................  5 \n3.2 Parameter Options  ................................ ................................ ................................ ........  6 \n3.3 Saving the Project and Running PEST  ................................ ................................ .........  6 \n3.4 Importing and Viewing the MODFLOW Solutions  ................................ .........................  8 \n4 Conclusion  ................................ ................................ ................................ .........................  12 \n5 Further Reading  ................................ ................................ ................................ .................  13 \n \n1 Introduction  \nGMS supports three methods for performing stochastic simulations: parameter \nrandomization, indicator simulations, and PEST Null Space Monte Carlo. The first two \napproaches are described in separate tutorials. This tutorial will introduce the PEST Null \nSpac e Monte Carlo method.  \nThis tutorial borrows heavily from John Doherty\u2019s PEST Workshop  document.1 Further, \nall credit for this approach to quantifying model uncertainty goes to Doherty and his co -\nauthors.  \nThere is always a significant amount of uncertainty  associated with a groundwater model. \nThis uncertainty can be associated with the conceptual model, the field data, or the input \nparameters of the model. Some model parameters \u2014such as hydraulic conductivity \u2014are \nparticularly prone to uncertainty. This uncer tainty can be reduced by calibrating a model \nto observation data (monitoring wells, stream flows, and so on). However, even a well -\ncalibrated model can have significant uncertainty associated with it.  \nThe challenge with a groundwater model is to explore th e uncertainty while maintaining a \ncalibrated model (i.e., a good fit with field -measured values). The generation of model \ninput parameters that will respect calibration constraints is a time -consuming matter since \na parameter estimation exercise must be un dertaken for each new set of parameters. \nTwo tools provided with PEST greatly reduce the amount of time required to perform \ncalibration -constrained Monte Carlo analysis of a groundwater model.  \nThe first is the use of SVD -Assist in the calibration process.  The second is the pre -\ncalibration null space2 projection. This projection expresses the differences between the \nstochastic parameter fields and the simplified calibration parameter field specified to \ncalibrate the model. By using both of these utilities, it is possible to obtain parameter sets \nthat respect both the stochastic variability of the subsurface as well as the field -measured \nvalues. This is accomplished with only a handful of runs per realization.  \nThis tutorial starts with a calibrated MODFLOW mo del used as a starting point to create \nadditional calibrated models with different hydraulic conductivity (HK). Pilot points have \nbeen used to estimate  HK fields. PEST \u2014running in SVD -Assist mode \u2014was used to \ncalibrate the model.  \nA groundwater model for an unconfined alluvial aquifer in Wisconsin, USA, is shown in \nFigure 1. The alluvium is highly variable in terms of hydraulic conductivity. In some areas, \n                                                      \n1 Doherty, John. Date unknown. PEST Workshop, Regularized Inversion and Predictive Error \nVariance Analysis . Watermark Numerical Computing, Corinda, Australia, 66 pages.  \n2 The null space is comprised of individual parameters, or combinations of parameters, that have \nno effect on model outputs under calibration conditions. These combinations of parameters can \ntherefore be added to any set of parameters that calibrates the model, thus producing another set \nof parameters that also calibrates the model.  \nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling , PEST Null Space Monte Carlo I  \n \n Page 3 of 13 \u00a9 Aquaveo 2024  it is composed of well -sorted gravels with high conductivity, while in other areas it is \ncomposed of sandy silts with low conductivity. While the location and description of the \nmodel area are accurate, the observation wells used in this exercise are not field -\nmeasured v alues.  \n \n      Figure 1      Study area  \nThe model is bounded on the east by Lake Wisconsin and on the south by the Wisconsin \nRiver. A stream (Otter Creek) is used as the western boundary. Based on observed \nheads, it is assumed that  a significant amount of recharge occurs along the northern \nboundary. The aquifer becomes very thin when approaching the northern and western \nboundaries.  \nThis tutorial discusses and demonstrates opening a MODFLOW model calibrated using \nPEST with SVD -Assist , setting up a Null Space Monte Carlo model run, and running \nParallel PEST with SVD -Assist and Null Space parameter projection for multiple model \nruns.  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling , PEST Null Space Monte Carlo I  \n \n Page 4 of 13 \u00a9 Aquaveo 2024  2.1 Importing the Project  \nFirst, import a project containing the MODFLOW solution:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject F iles (*.gpr) from the Files of type  drop-down.  \n3. Browse to the sto_pest_nsmc_I \\sto_pest_nsmc_I  directory and select \u201c start.gpr \u201d. \n4. Click Open  to import the project and exit the Open  dialog . \nA one layer MODFLOW model with observation wells should appear ( Figure 2). \n \n       Figure 2      Calibrated MODFLOW model  \n5. Fully expand the \u201c  3D Grid Data \u201d folder in the Project Explorer  and all folders \nunder it.  \n6. Right -click on the \u201c  start (MODFLOW) \u201d folder and select Properties\u2026  to bring \nup the Properties  dialog.  \nThis dialog allows for reviewing the error associated with the model. This model is fairly \nwell calibrated.  Notice that Root Mean Squared Resi dual (Head)  has a value of about \n\u201c1.33\u201d, and Sum of Squared Weighted Residual (Head+Flow)  has a value of about \n\u201c197.56\u201d. Most of the computed heads at the observation wells are within acceptable \nlimits (green targets); several of the observations wells hav e computed heads just outside \nof acceptable limits (yellow targets) and one observation well has significant error (red \ntarget).  \n7. Click OK to exit the Properties  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling , PEST Null Space Monte Carlo I  \n \n Page 5 of 13 \u00a9 Aquaveo 2024  8. Select the \u201c  HK Parameter -100\u201d dataset in the Project Explorer.   \nThe Main Graphics Wi ndow should appear similar to Figure 3. \n \n      Figure 3      Hydraulic conductivity (HK) field for calibrated model  \nThis model was calibrated using PEST with SVD -Assist and pilot points to estimate the \nhydraulic conductivity (HK) of the aquifer. Figure 3 shows the final estimate of  HK. When \nrunning PEST with the Null Space Monte Carlo method, different HK fields will be created \nthat will also calibrate the model.  \n9. Select the \u201c  Head \u201d dataset in the Project Explorer  to reset back to the original \nview.  \n3 Using the Null Space Monte Carlo Method  \n3.1 The MODFLOW Run Options  \nNow, set up a Null Space Monte Carlo run using the steps below. For this tutorial, only \nthree realizations will be performed. When done, there will be three different MODFLOW \nmodels with different HK arrays that all calibrate  the model.  \n1. Select MODFLOW  | Global Options\u2026  command to open the MODFLOW \nGlobal/Basic Package dialog.  \n2. In the Run options  section, select Stochastic Inverse . \nNotice that the text below the Stochastic Inverse  option has changed to explain that the \nstochastic method is PEST Null Space Monte Carlo . \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling , PEST Null Space Monte Carlo I  \n \n Page 6 of 13 \u00a9 Aquaveo 2024  3. Click Stochastic Options \u2026 to open the Stochastic Options dialog.  \nThis dialog is used to change the stochastic options. The other options available in this \ndialog are explained in separate tutorials. With the data that is currently loaded in GMS, \nthe only stochastic inverse option available is PEST Null Space Monte Carlo. In order to \nuse the Null Space Monte Carlo method, there must be a model that has already been \ncalibrated using PEST with SVD -Assist.  \n4. Click the Options \u2026 button next to PEST NSMC  to open the Monte Carlo \nOptions dialog.  \nLeave most of the inputs in this dialog at their default values. The number of realizations \nto be run needs to be changed, and PEST  needs an indication of the amount of \nacceptable error for the model. The random seed will be also specified to allow \nreplication of the results of the sample solution for this tutorial.  \n5. Enter \u201c 3\u201d for Number of realizations . \n6. Enter \u201c 200.0 \u201d for Termination t hreshold (PHISTOPTHRESH) .  \nThis value tells PEST to stop when the total model error is 200 or less. Remember that \nthe total error for this calibrated model was about 197.  \n7. Select \u201c Yes\u201d from the RANDPAR \u2013 Specify random seed  drop-down.  \n8. Enter \u201c 100\u201d for RANDPA R \u2013 Random seed . \n9. Click OK to exit the Monte Carlo Options  dialog.  \n10. Click OK to exit the  Stochastic Options  dialog.  \n11. Click OK to exit the  MODFLOW Global/Basic Package dialog.  \n3.2 Parameter Options  \nNext, select which parameters should vary during the Monte Carlo p rocess.  \n1. Select MODFLOW  | Parameters\u2026  to bring up the Parameters  dialog.  \n2. On the \u201cHK_100\u201d row, check the box in the Stochastic Randomize  column.  \nTurning on this option indicates the desire to vary the values at the pilot points that \nestimate the HK_100 para meter during the Monte Carlo runs.  \n3. Click OK to exit the Parameters  dialog.  \n3.3 Saving the Project and Running PEST  \nNow save the project and run PEST in stochastic mode.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr )\u201d from the Save as type  drop-down.  \n3. Enter  \u201csto.gpr \u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog . \n5. Select MODFLOW  | Run MODFLOW \u2026 to bring up the MODFLOW/PEST \nParameter Estimation  dialog.  \nParallel PEST  and MODFLOW are now running in stochastic inverse mode. There are \nfour sections of the dialog (see Figure 4). \nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling , PEST Null Space Monte Carlo I  \n \n Page 7 of 13 \u00a9 Aquaveo 2024   \n      Figure 4      The grap h, PEST iterations, runs, and output sections (clockwise from top left) of \nthe MODFLOW/PEST Parameter Estimation dialog  \nThe top left section features a graph that shows the model error vs. PEST iteration. To \nthe right of the graph is a spreadsheet showing the model error and the parameter values \nfor each PEST iteration. Below that, in the bottom right section, is another spreadsheet \nshowing the results for each realization (run) and includes the number of PEST iterations, \nthe model error, and the parameter values. In the bottom left section, a text window \nshows the output PEST prints to the screen when run from the command line.  \nThere are many steps involved in running PEST with the Null Space Monte Carlo \nmethod. GMS runs several PEST utilities to make all of this happen. The following is a list \nof the steps involved.  \n6. PEST runs MODFLOW once for each parameter to compute a Jacobian matrix. \nIn this case, there is a steady state model and Parallel PEST is being used, so \nthis step is completed fairly quickly.     \n7. PPCOV is a PEST utility that generates uncertainty information for the pilot \npoints. The PPCOV utility generates a covariance matrix for the pilot points. This \nmatrix is created using the variogram that is specified as part of the interpolation \noptions f or the pilot points. For this reason, kriging must be used with the pilot \npoints if using the Null Space Monte Carlo method.  \n8. RANDPAR is a PEST utility that generates random values for the parameters \nthat are being randomized, saving one file for each reali zation. In this example, \nthese files are named \u201csto000_random1.par\u201d, \u201csto000_random2.par\u201d, and \n\u201csto000_random3.par\u201d.  \n9. PNULPAR is a PEST utility that modifies the random parameter values through \nNull Space projection, generating one file for each realization . In this example, \nthese files are named \u201csto000_random_nul1.par\u201d, \u201csto000_random_nul2.par\u201d, \nand \u201csto000_random_nul3.par\u201d. An explanation of how PNULPAR calculates \nvalues is given below:  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling , PEST Null Space Monte Carlo I  \n \n Page 8 of 13 \u00a9 Aquaveo 2024  In this process the difference is first taken between each parameter set and \nthe calibration parameter; this difference is then projected onto the calibration \nnull space, and the projected difference re -added to the calibration parameter \nset. If the model were linear, and if the cutoff between null and solution \nspaces were sharp, each new parameter set obtained in this way would \ncalibrate the model with an identical objective function to that achieved using \nthe calibration parameter set. However, in general, random parameter sets \nmodified in this manner do not result in perf ectly calibrated models, and will \nthus require adjustment in order that calibration constraints be respected. \nSuch adjustment takes place through alterations made to the calibration \nsolution space (leaving the null space untouched).3 \n10. SVDAPREP is a PEST uti lity that creates a new PEST input file (PST) using \ninformation from the original PEST run in step 1. PEST then runs SVD -assisted \nparameter estimation, greatly reducing the number of model runs required for \neach PEST iteration.  \n11. For each realization, two st eps are required:  \na. PARREP is a PEST utility that substitutes the parameter values \ngenerated by PNULPAR in step 4 for the current realization.  \nb. PEST is launched using the parameter values for the current realization \nand runs until the objective function is at  or below PHISTOPTHRESH or \nuntil that maximum number of PEST iterations is reached.  \nThe time required for this process can vary depending on the speed of the computer \nbeing used. If PEST fails while executing the run, adjust the Parallel PEST wait time to a \nvalue of \u201c0.1\u201d (or greater) instead of the default value of \u201c0.001\u201d. This is specified in the \nPEST dialog accessed by selecting MODFLOW | Parameter Estimation \u2026 in GMS.  \n3.4 Importing and Viewing the MODFLOW Solutions  \nOnce all the MODFLOW runs are completed, t he solutions can be imported. Notice that, \nfor this example, the model error for each of the realizations is less than 200. Each of \nthese new models is calibrated to the same level of error as the original model.  \n1. Turn on Read solution on exit  and Turn on c ontours (if not on already) . \n2. Click Close  to close the MODFLOW/PEST Parameter Estimation  dialog and \nopen the Reading Stochastic Solutions  dialog.  \n3. Click OK to close the Reading Stochastic Solutions  dialog and import all \nconverged solutions.  \n4. Fully expand the new \u201c  sto (MODFLOW)(STO) \u201d folder in the Project Explorer . \n5. View each of the three individual solutions within that folder by selecting each in \nturn. \nNotice how the observation targets change with each solution and that the targets \ngenerally remain within a cceptable error limits ( Figure 5). \n                                                      \n3 Doherty (Date unknown).  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling , PEST Null Space Monte Carlo I  \n \n Page 9 of 13 \u00a9 Aquaveo 2024    \n  \n      Figure 5      Computed heads from stochastic MODFLOW models  \n6. Right -click on \u201c  sto (MODFLOW)( STO) \u201d and select Statistical Analysis . \nThis creates new datasets based on the MODFLOW outputs. Among the new datasets \nshould be \u201c  mean_Head \u201d, \u201c min_Head \u201d, \u201c max_Head \u201d, and \u201c stdev_Head \u201d.  \n7. Select \u201c  stdev_Head \u201d. \nThe Graphics Window should appear similar  to Figure 6. Notice that there is very little \nvariability in the computed heads around the locations of the observation points; while in \ngrid cells with no observati on points there are standard deviation values up to 6.6.  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling , PEST Null Space Monte Carlo I  \n \n Page 10 of 13 \u00a9 Aquaveo 2024   \n      Figure 6      Standard deviation of computed heads from stochastic MODFLOW models  \nNow to compare HK datasets to see the different HK fields that will still calibrate the \nmodel:  \n8. Select the \u201c  HK Parameter -100\u201d dataset under the \u201c  Parameters\u201d folder in \nthe \u201c  start (MODFLOW) \u201d folder.  \n9. Select the \u201c  HK Parameter -100\u201d dataset under the \u201c  Parameters\u201d folder in \nthe \u201c  sto001 (MODFLOW) \u201d folder.  \n10. Select in turn the \u201c  HK Pa rameter -100\u201d dataset under the \u201c  Parameters\u201d \nfolder in the \u201c  sto00 2 (MODFLOW) \u201d and \u201c  sto00 3 (MODFLOW) \u201d folders.  \nNotice the different distribution of HK values ( Figure 7). \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling , PEST Null Space Monte Carlo I  \n \n Page 11 of 13 \u00a9 Aquaveo 2024     \n  \n      Figure 7      Unique HK fields that calibrate the model  \nThe statistics about the different HK arrays that calibrate the model can be viewed at this \npoint. New datasets were created describing the variability  in the HK arrays when \nexecuting the Statistical Analysis  command. Datasets show the minimum, maximum, \nmean, and standard deviation of HK for each grid cell. View these datasets to get a feel \nfor how much variability can occur in the HK input array and still result in a calibrated \nmodel.  \n11. Select the \u201c  stdev_HK P arameter -100\u201d dataset  under the \u201c  sto \n(MODFLOW)(STO) \u201d folder in the Project Explorer . \n12. Select the \u201c  Head \u201d display theme under the \u201c  Display Themes \u201d folder in the \nProject Explorer . \nThe Graphics Window should appear similar to Figure 8. Notice the maximum standard \ndeviation value for HK is around 224.0. This means there are areas in this model where \nthe HK value can vary significantly, and yet the model will still mat ch field -measured head \nvalues.  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling , PEST Null Space Monte Carlo I  \n \n Page 12 of 13 \u00a9 Aquaveo 2024   \n      Figure 8      Standard Deviation of HK Input Array  \n4 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 Stochastic Modeling, PEST Null Space Monte Carlo I\u201d \ntutorial. The following key concepts were discussed and demonstrated in this tutorial:  \n\uf0b7 It is possible to create multiple calibrated models using the PEST Null Space \nMonte Carlo approach.  \n\uf0b7 GMS runs several PEST utilities to automate the process of running the Null \nSpace Monte Carlo method.  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling , PEST Null Space Monte Carlo I  \n \n Page 13 of 13 \u00a9 Aquaveo 2024  5 Further Reading  \n\u2014Doherty, J. 2005. PEST: Model -Independent Parameter Estimation . Watermark \nNumerical Computing, Corinda, Australia.  \n\u2014Doherty, J. 2006. Addendum to PEST Manual . Watermark Numerical Computing, \nCorinda, Australia.  \n\u2014Moore, C. and Doherty, J. 2005. \u201cThe  role of the calibration process in reducing model \npredictive error\u201d. Water Resources Research , Vol. 41, No 5. W05050.  \n\u2014Moore, C. and Doherty, J. 2006. \u201cThe cost of uniqueness in groundwater model \ncalibration\u201d. Advances in Water Resources, Vol. 29, Issue 4 , April, pp. 605 \u2013623. \n\u2014Tonkin, M. and Doherty, J. 2005. \u201cA hybrid regularized inversion methodology for \nhighly parameterized models\u201d. Water Resources Research , Vol. 41, W10412, \ndoi:10.1029/2005WR003995, 2005.  \n\u2014Tonkin, M. and Doherty, J. 2007. \u201cEfficient no nlinear predictive error variance for highly \nparameterized models\u201d. Water Resources Research , Vol. 43, W07429, \ndoi:10.1029/2006WR005348.  \n \n", "filename": "MODFLOW-StochasticModeling-NullSpaceMonteCarloI.pdf", "pages": 13}, "MODFLOW-StochasticModeling-NullSpaceMonteCarloII": {"text": "GMS Tutorials   MODFLOW \u2013 Stochastic Modeling, PEST Null Space Monte Carlo II \n Page 1 of 11 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Stochastic Modeling, PEST Null Space Monte \nCarlo I I \nUse results from PEST NSMC to evaluate the probability of a \nprediction   \nObjectives   \nLearn how to use the results from a PEST Null Space Monte Carlo (NSMC) simulation to set up a new \nstochastic simulation with MODFLOW . \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Stochastic \nModeling, PEST Null Space \nMonte Carlo I  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 PEST  \n\uf0b7 Stochastic & T -PROGS  Time  \n\uf0b7 35\u201350 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling, PEST Null Space Monte Carlo II \n Page 2 of 11 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 Importing the Project  ................................ ................................ ................................ ..... 4 \n3 Using the NULL Space Monte Carlo Method  ................................ ................................ ..... 5 \n3.1 The MODFLOW Run Options  ................................ ................................ .......................  5 \n3.2 Creating the new well  ................................ ................................ ................................ ... 6 \n3.3 Removing the observations  ................................ ................................ ..........................  7 \n3.4 Saving the Project and Running MODFLOW  ................................ ................................  7 \n3.5 Importing and Viewing the MODFLOW Solutions  ................................ .........................  8 \n3.6 Risk Analysis  ................................ ................................ ................................ ................  9 \n4 Conclusion  ................................ ................................ ................................ .........................  11 \n \n1 Introduction  \nGMS supports parameter randomization, indicator simulations (T -PROGS), and PEST \nNull Space Monte Carlo (NSMC) as methods for performing stochastic simulations. The \nfirst two approaches are described in separate tutorials. This tutorial will explain features \nof GMS associated wit h the PEST NSMC method. It is highly recommended that the \n\u201cMODFLOW \u2013 Stochastic Modeling, PEST Null Space Monte Carlo I \u201d tutorial be \ncompleted prior to this tutorial.  \nThe \u201cMODFLOW \u2013 Stochastic Modeling, PEST Null Space Monte Carlo I\u201d tutorial \ndiscussed how  the NSMC method is used to create multiple calibrated MODFLOW \nmodels. This exercise is useful for exploring the uncertainty associated with the \ncalibrated model. However, a groundwater model is normally used to help make some \nkind of future prediction. Th e usual process for using a model to make a prediction is to \nuse historical data to create a calibrated groundwater model and then modify the \ncalibrated model to account for some future scenario and evaluate the prediction.  \nFor example, to figure out how m uch drawdown a well would cause if an area was in a \ndrought for a prolonged period of time, first create a calibrated groundwater model using \nhistorical information on water levels, pumping rates at wells, and rainfall. The calibrated \nmodel would be used a s a starting point, the inputs would be modified to simulate a \ndrought, and the model would be run. The model outputs would then be reviewed and a \nprediction would be made on the amount of drawdown caused by a well in such a \nscenario.  \nUncertainty is always  associated with various inputs (hydraulic conductivity, recharge, \nwater levels, and so on) to the groundwater model. All have error associated with their \ninput values. More often than not, the model is better than a scientific guess because the \nstudy area  has been analyzed and the different processes that affect groundwater have \nbeen taken into account when building the model. Because historical data was used to \nmake sure that the model matches what has been measured in the past, the model is \nbetter than a  less sophisticated approach.  \nNSMC is a method for quantifying the amount of uncertainty associated with the \nprediction. Instead of creating a single calibrated model, PEST NSMC is used to create \nmultiple calibrated models. The model can be modified to acc ount for future conditions, \nthen multiple models can be run using the different parameter values that PEST \ncalculated. A distribution of results for this prediction can then be viewed.  \nThe previously -mentioned drawdown example can present a mean drawdown with a \nstandard deviation instead of presenting a single value. In this way, the prediction is \nmuch more solid because the amount of uncertainty associated with the prediction has \nbeen quantified. If the amount of uncertainty is unacceptably high, then mor e work may \nbe required, such as collecting more field data or better calibrating the original model.  \nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling , PEST Null Space Monte Carlo I I \n \n Page 3 of 11 \u00a9 Aquaveo 2024  A groundwater model for an unconfined alluvial aquifer in Wisconsin, USA, is shown in       \nFigure  1. The alluvium is highly variable in terms of hydraulic conductivity. In some areas, \nit is composed of well -sorted gravels with high conductivity, while in other areas it is \ncomposed of sandy silts with low  conductivity. The location and description of the model \narea are accurate, but the observation wells used in this exercise are not field -measured \nvalues.  \n \n      Figure 1      Study area  \nThe model is bounded on the east by Lake Wi sconsin and on the south by the Wisconsin \nRiver. A stream (Otter Creek) is used as the western boundary. Based on observed \nheads, it is assumed that there is a significant amount of recharge occurring along the \nnorthern boundary. The aquifer becomes very t hin as on the northern and western \nboundaries.  \nThis tutorial discusses and demonstrates opening a project with multiple calibrated \nMODFLOW solutions that were calibrated using PEST NSMC. The tutorial modifies the \nMODFLOW simulation, sets up a stochastic ru n using the results from PEST NSMC, and \nthen runs MODFLOW in stochastic mode.  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling , PEST Null Space Monte Carlo I I \n \n Page 4 of 11 \u00a9 Aquaveo 2024  2.1 Importing the Project  \nFirst to import a project containing the MODFLOW solution:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the Tutorials \\MODFLOW \\sto_pest_nsmc_II  directory and select \n\u201cnsmcII.gpr \u201d. \n4. Click Open  to import the project and exit the Open  dialog . \nA one -layer MODFLOW model with observation wells should appear ( Figure 2). \n \n      Figure 2      Calibrated MODFLOW model  \n5. Fully expand the \u201c  3D Grid Data \u201d folder  in the Project Explorer . \n6. Select the \u201c  nsmcII001 (MODFLOW)\u201d solution.  \n7. Select  in turn each of the other solutions and review the variability in the \ncomputed heads between them.  \n8. Double-click on \u201c  nsmcII.mfo\u201d in the Project Explorer  to bring up the View Data \nFile dialog . If Never ask this again  has been previously turned on, this di alog will \nnot appear. If this is the case, skip step 9.  \n9. Select the desired text editor from the Open with  drop-down and click OK to open \nthe MFO file in the desired text editor and close the View Data File  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling , PEST Null Space Monte Carlo I I \n \n Page 5 of 11 \u00a9 Aquaveo 2024  The file will open in the selected text editor ( Figure 3). This file describes the PEST \nNSMC run.  \n \n      Figure 3      Stochastic output file (nsmcII.mfo) displayed in Notepad  \n10. Scroll through the file to see that this stochastic simulation comprised 30 different \nmodels.  \nEach line in the file describes a model run. Notice that the name of the simulation, the \nnumber of PEST iterations, the model error, and the parameter values are giv en on each \nline. \nThe original calibrated model had a total model error of 197.5. During the NSMC run, \nPEST would run each model until the total model error was less than 200.0 (the value \nspecified for the PEST input parameter PSTOPTHRESH). Model runs 2, 10 , and 21 had \nmodel error above the 200.0 and so they were removed from the stochastic folder in the \nproject explorer. Model run 29 encountered some kind of problem so it was reported as a \nfailed run.  \n11. Close the text file and return to GMS.  \n3 Using the NULL Sp ace Monte Carlo Method  \n3.1 The MODFLOW Run Options  \nNow, modify the MODFLOW run to analyze the capture zone of a proposed well using \nthe steps below. Then run MODFLOW in stochastic mode using the results from the \nPEST NSMC run.  \n1. Select MODFLOW  | Global Options\u2026  to open the MODFLOW Global/Basic \nPackage dialog.  \n2. In the Run options  section, select Stochastic . \n3. Click Stochastic Options \u2026 to open the Stochastic Options dialog.  \nThis dialog is used to change the stochastic options. The PEST NSMC option is still \ngoing to b e used, but it is necessary to select the PEST NSMC stochastic solution that \nwill be used as input for the new stochastic simulation.  \n4. Select \u201c nscmII (MODFLOW)(STO) \u201d from the drop -down to the right of PEST \nNSMC . \n5. Click OK to exit the  Stochastic Options  dialo g. \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling , PEST Null Space Monte Carlo I I \n \n Page 6 of 11 \u00a9 Aquaveo 2024  6. Click OK to exit the  MODFLOW Global/Basic Package dialog.  \n3.2 Creating the new well  \n1. Zoom   in by dragging a box around the area shown in Figure 4. \n \n      Figure 4      Area in model where new well will be created  \n2. Select the \u201c  wells\u201d coverage under the \u201c  Lake Wisconsin\u201d conceptual model \nto make it active.  \n3. Select \u201c  grid\u201d to make it active.  \n4. Using the Select Cells   tool, select Cell ID 2356 ( Figure 5). \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling , PEST Null Space Monte Carlo I I \n \n Page 7 of 11 \u00a9 Aquaveo 2024   \n      Figure 5      Location of new well in Cell ID 2356  \n5. Right -click on the selected cell and select Sources/Sinks \u2026 to open the \nMODFLOW Sources/Sinks dialog.  \n6. Select Wells  (WEL)  from the list on the left.  \n7. Click Add BC  to create a new well.  \n8. Enter \u201c Well 4A \u201d in the Name  column on the 2356  row. \n9. Enter \u201c -65000.0 \u201d in the Q (flow) (ft^3/d)  column.  \n10. Click  OK to exit the MODFLOW Sources/Sinks  dialog.  \n11. Frame   the project.  \n3.3 Removing the observations  \nIt is necessary to remove the head observations since a model scenario that is \ninconsistent with these head measurements is being run.  \n1. Select MODFLOW | Observations\u2026  to open the Observations dialog.  \n2. In the Coverages (head observations)  section, uncheck the box in the Use \ncolumn in the spreadsheet.  \n3. Click  OK to exit the Observations  dialog.  \n3.4 Saving the Project and Running MODFLOW  \nNow to save the project and run PEST in stochastic mode:  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling , PEST Null Space Monte Carlo I I \n \n Page 8 of 11 \u00a9 Aquaveo 2024  3. Enter  \u201cnsmcII_forward.gpr \u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog . \n5. Select MODFLOW  | Run MODFLOW  to bring up the Stochastic MODFLOW  \ndialog.  \nMODFLOW is now running in stochastic mode. The spreadsheet in the top section shows \nthe parameter values for each model run  and whether the model converged. Below the \nspreadsheet, a text window displays the output that MODFLOW prints to the screen \nwhen running MODFLOW from the command line.  \n \n      Figure 6      Stochastic MODFLOW dialog  \nFor each model  run, GMS reads the parameter values calculated by PEST in the \nprevious NSMC run and saves those parameter values to the SEN package file for \nMODFLOW 2000 or to the PVAL package file for MODFLOW 2005 and NWT. \nMODFLOW then executes that model run. This proc ess may take several minutes.  \n3.5 Importing and Viewing the MODFLOW Solutions  \nOnce all the MODFLOW runs are completed, import the solutions.  \n1. Turn Read solution on exit  and Turn on contours (if not on already) . \n2. Click Close  to close the Stochastic MODFLOW  dialog  and open the Reading \nStochastic Solutions  dialog.  \n3. Click OK to close the Reading Stochastic Solutions  dialog and import all \nconverged solutions.  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling , PEST Null Space Monte Carlo I I \n \n Page 9 of 11 \u00a9 Aquaveo 2024  4. Expand the new \u201c  nsmcII_forward (MODFLOW)(STO) \u201d folder  in the Project \nExplorer  and review the individual solutions.  \n3.6 Risk Analysis  \nNow, use the \u201cnsmcII_forward\u201d set of stochastic solutions to examine the capture zone \nfor the new well.  \n1. Right -click on the \u201c  nsmcII_forward (MODFLOW)(STO) \u201d folder in the Project \nExplorer  and select the Risk Analysis\u2026  to bring up the Risk Analysis Wizard  \ndialog.  \n2. Below the list, select Probabilistic capture zone analysis . \n3. Click Next  to go to the Capture Zone Analysis  dialog.  \n4. In the Particle termination at cells with weak sinks  section, select Stop in cells \nwith weak sinks . \n5. Click Finish  to close the Capture Zone Analysis  dialog.  \nGMS is now running MODPATH on each of the MODFLOW solutions. A particle is placed \non the water table surface at each cell in the model grid and then the particle is tracked \nforward in  time to determine the cell where the particle terminates.  \nWhen the model finishes running, the Graphics Window will appear similar to Figure 7. \n \n      Figure 7      Probabilistic capture zone for proposed well  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling , PEST Null Space Monte Carlo I I \n \n Page 10 of 11 \u00a9 Aquaveo 2024  Figure 8 show capture zones from individual solutions computed by MODFLOW. Notice \nthe differ ence in the shape and location of the various capture zones. This is due to the \nuncertainty associated with this model.  \nEven though the model has been calibrated to field -measured water level data, PEST \nNSMC can be used to create multiple calibrated model s that show significant differences \nin the capture zone for the well. This makes it more reasonable to discuss modeling \nresults in terms of uncertainty and probability than in terms of the results from a single \nmodel.  \n  \n  \n      Figure 8      Capture zones from individual runs  \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling , PEST Null Space Monte Carlo I I \n \n Page 11 of 11 \u00a9 Aquaveo 2024  4 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 Stochastic Modeling,  PEST Null Space Monte Carlo II \u201d \ntutorial. The following key concepts were discussed and demonstrated in this tutorial:  \n\uf0b7 It is possible create a n ew stochastic solution using the results of a completed \nPEST Null Space Monte Carlo run.  \n\uf0b7 The Risk Analysis tools in GMS allow the creation of probabilistic capture zones.  \n \n", "filename": "MODFLOW-StochasticModeling-NullSpaceMonteCarloII.pdf", "pages": 11}, "MODFLOW-StochasticModeling-ParameterRandomization": {"text": "GMS Tutorials   MODFLOW \u2013 Stochastic Modeling, Parameter Randomization  \n Page 1 of 13 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Stochastic Modeling, Parameter Randomization  \nRun MODFLOW in Stochastic (Monte Carlo) Mode by Randomly \nVarying Parameters  \nObjectives   \nThis tutorial shows how to develop a stochastic (Monte Carlo) simulation using parameter randomization. \nIt explains Random Sampling versus Latin Hypercube. It will go over defining parameters and parameter \nzones, as well as, running MT3DMS on all the MODFLOW solutions and performing a threshold analysis.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Automated \nParameter Estimation  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 Stochastic & T -PROGS  Time  \n\uf0b7 40\u201360 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 Stochastic Modeling, Parameter Randomization  \n Page 2 of 13 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Random Sampling vs. Latin Hypercube  ................................ ................................ ........  3 \n2 Getting Started  ................................ ................................ ................................ .....................  4 \n2.1 Importing the Project  ................................ ................................ ................................ ..... 4 \n3 Model Parameterization  ................................ ................................ ................................ ...... 5 \n3.1 Defining the Parameter Zones  ................................ ................................ ......................  5 \n3.2 Mapping the Key Values to the Grid Cells  ................................ ................................ .... 6 \n3.3 Selecting the Stochastic Option  ................................ ................................ ....................  7 \n3.4 Editing the Parameter Data  ................................ ................................ ..........................  7 \n3.5 Saving the Project and Running MODFLOW  ................................ ................................  8 \n3.6 Importing and Viewing the MODFLOW Solutions  ................................ .........................  8 \n4 MT3DMS  ................................ ................................ ................................ ...............................  9 \n4.1 Importing the MT3DMS Project ................................ ................................ .....................  9 \n4.2 Selecting the MODFLOW Stochastic Simulation  ................................ ........................  10 \n4.3 Saving and Running MT3DMS in Stochastic Mode  ................................ ....................  10 \n4.4 Importing and Viewing the MT3DMS Solutions ................................ ...........................  10 \n4.5 Threshold Analysis  ................................ ................................ ................................ ..... 11 \n4.6 Statistical Analysis  ................................ ................................ ................................ ...... 12 \n5 Conclusion  ................................ ................................ ................................ .........................  13 \n \n1 Introduction  \nA significant amount of uncertainty is always associated with a groundwater model. This \nuncertainty can be associated with the conceptual model or with the data and parameters \nassociated with the various components of the model. Some model parameters \u2014such as \nhydraulic conductivity and recharge \u2014are particularly prone to uncertainty. Calibrating a \nmodel to a rich set of observation data (monitoring wells, stream flows, etc.) may \nsomewhat reduce this uncertainty. However, calibration data are often scarce, and even \nwell-calibrated models have a high level of uncertainty.  \nOne method for dealing with uncertainty is to utilize a stochastic modeling approach. With \na non -stoch astic approach, a single model is developed that represents the best estimate \nof the real system being simulated. This model is used to make predictions.  \nWith a stochastic approach, a set of models is constructed where each model in the set is \nthought to be equally probable. Each model is then used to make a prediction or simulate \na given scenario, and the results are used to estimate a probability or risk that a certain \noutcome will occur. While this approach still relies on underlying model assumptions t o \ngenerate initial parameter estimates, it more honestly reflects the uncertainty associated \nwith modeling.  \nGMS includes two basic methods for generating stochastic simulations: parameter \nrandomization and indicator simulations. With the parameter randomiz ation method, \nselected model parameters are randomized using either a Random Sampling or Latin \nHypercube approach. Each combination of input parameters defines a model instance. \nWith the indicator simulation approach, multiple equally probable realizations  of the \naquifer heterogeneity are generated and each realization is used to define a model \ninstance.  \nThis tutorial illustrates how to develop a stochastic simulation using parameter \nrandomization. Parameter randomization utilizes many of the tools describe d in the \n\u201cMODFLOW \u2013 Automated Parameter Estimation \u201d tutorial. Therefore, it is recommended \nthat that tutorial be completed prior to beginning this one.  \nThe model in this tutorial is a two -layer model representing an aquifer in East Texas. This \nis the same model featured in the \u201c MODFLOW \u2013 Conceptual Model Approach  1\u201d tutorial. \nThe model is bounded on the bottom and right sides by rivers represented with specified \nhead boundaries and bounded on the north by a no -flow boundary corresponding to a \nGMS  Tutorials   MODFLOW \u2013 Stochastic Modeling, Parameter Randomization  \n \n Page 3 of 13 \u00a9 Aquaveo 2024  bedrock outcro pping. The model includes two extraction wells and three drains. The \nmodel was developed to analyze the long -term consequences of a proposed landfill.  \nThis tutorial randomizes the recharge, the leakage from the landfill, and the hydraulic \nconductivity asso ciated with the top layer. After developing multiple MODFLOW \nsimulations using the Latin Hypercube sampling method, the contaminant transport \nresulting from each flow model will be simulated using MT3DMS. Finally, the results will \nbe processed using the th reshold analysis option in the GMS Risk Analysis Wizard . \nThis will be accomplished by opening a MODFLOW model and solution, setting up \nparameters in coverages, mapping them to MODFLOW, and then running MODFLOW in \nstochastic mode. An MT3DMS project will the n be opened, MT3DMS will be run in \nstochastic mode, and both a risk and a statistical analysis will be run.  \n1.1 Random Sampling vs. Latin Hypercube  \nGMS provides two methods for performing parameter randomization: Random Sampling \nand Latin Hypercube.  \nWith the Random Sampling method, a mean, a standard deviation, a minimum value, and \na maximum value are specified for each parameter. In addition, the parameter can be \nspecified as log transformed, which is typically the case for hydraulic conductivity. The \nnumber of simulations is also specified. For each simulation, a random number is \ngenerated for each parameter according to the specified distribution using the mean, \nstandard deviation, maximum, and minimum. GMS supports both normal and uniform \ndistributions. The  more simulations generated, the greater the confidence that all options \nhave been explored.  \nThe Latin Hypercube method is an attractive alternative to the Random Sampling method \nsince it allows for a greater degree of confidence with fewer model runs. Thi s can be \nespecially useful for complex models that require large amounts of computational time. \nAs with the Random Sampling method, the mean, standard deviation, minimum, \nmaximum, and the number of segments for each parameter, are specified for each \nparame ter. The probability distribution curve for each parameter is then divided up into n \nsegments of equal probability. Figure 1 shows a normal distribution for a paramet er that \nhas six segments. Note that each segment has an equal area \u2014not an equal distance \u2014\nbetween values.  \n \n      Figure 1      Latin hypercube segmentation for a parameter with a normal distribution and six \nsegments  \nValueFrequency\n123\n654\nGMS  Tutorials   MODFLOW \u2013 Stochastic Modeling, Parameter Randomization  \n \n Page 4 of 13 \u00a9 Aquaveo 2024  The idea b ehind the Latin Hypercube approach is that the parameter space (all possible \ncombinations of parameter values) should be sampled as completely as possible with a \nlimited number of model runs. Once the segments are defined, each parameter is then \nrandomized  until a value is found that lies within each probability segment. The random \nnumbers for each parameter are combined with the random numbers from the other \nparameters such that all possible combinations of segments are sampled. The total \nnumber of model r uns is the product of the number of segments for each parameter.  \nFor example, if there are three parameters with four segments each and one with five, \nthe total number of simulations would be 4 * 4 * 4 * 5 = 320. In GMS, the total area under \nthe probabili ty curve is further limited by the specified maximum and minimum parameter \nrange. This gives the maximum parameter range while still maintaining the best chance \nfor model stability. The greater certainty from a smaller number of runs comes from \nguaranteein g that a more complete set of parameter combinations is tested.  \nThis tutorial uses the Latin Hypercube approach.  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the pr ogram settings \nare restored to their default state.  \n2.1 Importing the Project  \nThe first step is to import a modeling project representing a completed MODFLOW model \nfor the East Texas site.  \n1. Click Open   to bring up the Open  dialog . \n2. Select \u201cProject Files (*.gpr) \u201d from the Files of type  drop-down.  \n3. Browse to  the sto_param \\sto_param \\ directory  and select \u201c tex.gpr \u201d. \n4. Click Open  to import the project and exit the Open  dialog . \n5. In the Project Explorer, fully expand \u201c  Map Data\u201d to make the coverages \nvisible.  \nA MODFLOW model with a solution and a set of GIS coverages should now be visible \n(Figure 2). The four coverages include a source/sink, a recharge, and two layer attribute \ncover ages.  \n\nGMS  Tutorials   MODFLOW \u2013 Stochastic Modeling, Parameter Randomization  \n \n Page 5 of 13 \u00a9 Aquaveo 2024   \n      Figure 2      The initial MODFLOW model  \n3 Model Parameterization  \nThe first steps in setting up a stochastic model are similar to those used to start an \ninverse model because the input needs to be \u201cparameterized\u201d. This involves identifying \nwhich parts of the model input need to be randomized. The parameters with the high est \nuncertainty are obvious candidates for parameterization.  \nWhen parameterizing a model, care should be taken to keep the number of selected \nparameters small. If too many parameters are chosen, unreasonably large numbers of \nmodel runs must be completed i n order to adequately explore a sufficient combination of \nparameters. For this model, only three parameters will be used to ensure that the model \nrun times will be as short as possible.  \n3.1 Defining the Parameter Zones  \nThe conceptual model approach used in GMS  allows for quickly defining the parameter \nzones because the conceptual model consists of zones of recharge and hydraulic \nconductivity defined by polygons. The polygons will be marked as parameter zones by \nassigning a key value to each polygon. The key val ue should be a value that is not \nexpected to occur normally in the MODFLOW input. A negative value typically works well.  \nSetting up the Recharge Zones  \nFirst, set up the recharge zones. The recharge polygons are shown in Figure 3. Define a \nparameter for both the small polygon defining the landfill and the larger polygon \nencompassing the rest of the site. The key values associated with the two zones are \nshown on the poly gons in the figure. The \u201c -200\u201d zone represents recharge to the aquifer \nfrom rainfall. The \u201c -100\u201d zone represents leakage from the landfill to the aquifer.  \n\nGMS  Tutorials   MODFLOW \u2013 Stochastic Modeling, Parameter Randomization  \n \n Page 6 of 13 \u00a9 Aquaveo 2024   \n      Figure 3      Recharge zones representing aquifer recharge ( -200) an d landfill leakage ( -100) \nTo assign the key values to the polygons:  \n1. Select  the \u201c Recharge \u201d coverage  to make it active . \n2. Using  the Select Polygon   tool, double -click on the landfill polygon (see \nFigure 3) to bring up the Attribute Table  dialog.  \n3. Enter \u201c -100\u201d in the Recharge rate (m/d)  column in the spreadsheet.  \n4. Click OK to close the Attribute Table  dialog.  \n5. Double -click on the aquifer recharge polygon (anywhere outside the landfill \npolygon) to bring up the Attribute Table  dialog.  \n6. Repeat steps 3 \u20134, entering \u201c -200\u201d for the Recharge rate (m/d) . \nSetting up the Hydraulic Conductivity Zone  \nThe next step is to parameterize the hydraulic conductivity fo r the top layer. For \nsimplicity, assume that the hydraulic conductivity is constant for the entire layer.  \n1. Select \u201c  Layer 1 \u201d in the Project Explorer to make it active.  \n2. Using  the Select Polygon   tool, double -click in the aquifer recharge polygon \nto bring u p the Attribute Table  dialog.  \n3. Enter \u201c -300\u201d in the Horizontal K (m/d)  column in the spreadsheet.  \n4. Click OK to close the Attribute Table  dialog.  \n3.2 Mapping the Key Values to the Grid Cells  \nOnce the key values are assigned to the polygons, they must be mapped to the cells in \nthe MODFLOW grid.  \n1. Select Feature Objects | Map \u2192 MODFLOW  to bring up the Map \u2192 Model  \ndialog.  \n2. Click OK to accept the defaults and close the Map \u2192 Model  dialog.  \n\nGMS  Tutorials   MODFLOW \u2013 Stochastic Modeling, Parameter Randomization  \n \n Page 7 of 13 \u00a9 Aquaveo 2024  3.3 Selecting the Stochastic Option  \nBefore editing the parameter data, it is necessary to turn on the stochastic option. This \noption is located in the MODFLOW Global/Basic Package  dialog.  \n1. Select MODFLOW  | Global Options\u2026  to open the MODFLOW Global/Basic \nPackage  dialog.  \n2. In the Run options  section, select Stochastic . \n3. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n3.4 Editing the Parameter Data  \nTwo options are available when running a stochastic simulation using parameter zones: \nRandom Sampling and Latin Hypercube. With Random Sampling, t he total number of \nruns is specified directly in the Parameters  dialog. With the Latin Hypercube method, the \ntotal number of MODFLOW runs is calculated from the number of segments specified for \neach parameter. This tutorial will use the Latin Hypercube met hod and three parameters, \ngiving each parameter three segments for a total of 27 (3*3*3) MODFLOW runs.  \nThe next step is to create a list of parameters and enter a mean and standard deviation \nfor each parameter that defines a normal probability distribution  curve for the parameter \nvalue. It is also necessary to define bounds for the parameters to keep the values within \nan acceptable range.  \n1. Select MODFLOW  | Parameters\u2026  to open the Parameters dialog.  \nThis dialog is used to manage the list of parameters and is explained in detail in the \n\u201cMODFLOW \u2013 Automated Parameter Estimation \u201d tutorial.  \n2. Click Initialize From Model  to automatically set all three parameters.  \nNotice that the parameters have been given default names. The next step is to enter a \nstarting (mean), mi nimum, and maximum value for each parameter.  \n3. Check the box in the Stochastic Randomize  column for each of the parameters.  \n4. Enter the following data into the parameters spreadsheet:  \nName  Value  Min  Max  \nHK_300  16.0 1.0 100.0 \nRCH_200  0.0288  0.01 0.05 \nRCH_100  0.0003  0.0001  0.0005  \n5. Check the box in Log Xform  column on the hydraulic conductivity parameter row \n(\u201cHK_300 \u201d)  \n6. Uncheck the box in the Log Xform  column for each of the two recharge \nparameters (\u201cRCH_200\u201d and \u201cRCH_100\u201d).  \n7. Click Yes if a dialog appears asking to set the standard deviation between a max \nand min value.  \nThe spreadsheet in the Stochastic Runs  section displays the parameter values for each \nstochastic run.  \n8. In the Stochastic Runs  section, select \u201cLatin Hypercube\u201d from the Stochastic \noption  drop-down.  \nIn the Stochastic option  drop-down, three different options are available: \u201cRandom \nSampling\u201d, \u201cLatin Hypercube\u201d, and \u201cUser -Defined\u201d. The \u201cUser -Defined\u201d option lets the \nGMS  Tutorials   MODFLOW \u2013 Stochastic Modeling, Parameter Randomization  \n \n Page 8 of 13 \u00a9 Aquaveo 2024  user set the number of runs and enter in the parameter valu es for each run. This is a \nconvenient way to set up customized model sensitivity runs or stochastic simulations.  \n9. Enter the following values for the standard deviation and number of segments in \nthe lower spreadsheet:  \nName  HK_300  RCH_200  RCH_100  \nStd. \nDeviation  0.5 0.01 0.0001  \nNum \nSegments  3 3 3 \n10. Click Repopulate Runs  then scroll down in the spreadsheet and notice that the \nparameter values for each run are displayed.  \n11. Click OK to exit the Parameters  dialog.  \n3.5 Saving the Project and Running MODFLOW  \nNow to save the project and run MODFLOW in Stochastic mode:  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c mfsto.gpr \u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog . \n5. Select MODFLOW  | Run MODFLOW  to bring up the Stochastic MODFLOW  \nmodel wrapper dialog.  \nMODFLOW is now running in Stochastic mode. The spreadsheet at the top shows the set \nof parameter val ues associated with each model run. The lower window shows the text \noutput from MODFLOW.  \n3.6 Importing and Viewing the MODFLOW Solutions  \nOnce all the MODFLOW runs are completed, the next step is to import the solutions.  \n1. Turn on Read solution on exit  and Turn o n contours (if not on already) . \n2. Click Close  to close the Stochastic MODFLOW  dialog, and open the Reading \nStochastic Solutions  dialog.  \nThe first column indicates whether or not each model run has converged. Some \ncombinations of parameter values result in un stable models.  \nNow, choose which of the solutions to import; all converged model solutions are checked \nby default.  \n3. Click OK to import the solutions and exit the Reading Stochastic Solutions  dialog.  \n4. Fully expand the \u201c  3D Grid Data \u201d folder in the Project E xplorer.  \n5. Select the \u201c  mfsto001 (MODFLOW)\u201d solution to make it active.  \nThis folder contains the results of the first stochastic simulation ( Figure 4). Feel free to \nreview all 27 of the solutions to see the variety in the range of answers. Some of the \nsolutions may indicate flooded cells (blue triangle symbols). This means that the \ncomputed water table elevation is above the ground surface.  \n\nGMS  Tutorials   MODFLOW \u2013 Stochastic Modeling, Parameter Randomization  \n \n Page 9 of 13 \u00a9 Aquaveo 2024  Note that once an individual  solution folder is selected in the Project Explorer , it is \npossible to use the up and down arrows on the keyboard to cycle through the solutions.  \n \n      Figure 4      Results of the \"mfsto001\" stochastic MODFLOW simulation  \n4 MT3DMS  \nThe next step is to run an MT3DMS model using the results from each MODFLOW \nsolution generated by the stochastic flow simulation. The MT3DMS model consists of one \nspecies, leachate from the landfill, entering the model from mass flux in the recharge and \ntraveling toward the river and nearby well. A concentration will be assigned to the \nrecharge coming from the landfill polygon. Because the recharge for the landfill area in \nthe MODFLOW model was varied as a parameter, the mass flux (recharge rate X \nconcentr ation) of contaminant leaving the landfill will vary for each model run. Then the \ncomputed transport solutions will be imported and  probabilistic threshold concentration \nanalysis will be performed.  \n4.1 Importing the MT3DMS Project  \nFirst, read in the MT3DMS project:  \n1. Save   the project in its current state, including the stochastic solutions.  \n2. Click Open   to bring up the Open  dialog.  \n3. Select \u201cModel Super Files\u201d from the Files of type  drop-down.  \n4. Browse to the sto_param \\sto_param \\leachate_MT3DMS  directory and select \n\u201cleachate.mts \u201d. \n5. Click Open  to import the file into the current project and exit the Open  dialog . \nThe MT3DMS model that was imported is a simple transport model with a concentration \nassigned to the recharge at the cells in the location  of the landfill. The initial concentration \nfor the entire model is set to zero. All of the other sources/sinks have a zero \nconcentration. The simulation is set to run for 3000 days with output every 300 days. The \nleachate plume should migrate to the south  and be captured by the well, the river, or \nboth.  \n\nGMS  Tutorials   MODFLOW \u2013 Stochastic Modeling, Parameter Randomization  \n \n Page 10 of 13 \u00a9 Aquaveo 2024  4.2 Selecting the MODFLOW Stochastic Simulation  \nThe MT3DMS model is already set up, but it is still necessary to specify that MT3DMS \nshould run in batch mode with the stochastic MODFLOW solution.  \n1. Select MT3DMS  | Run Options\u2026  to open the Run Options dialog.  \n2. Select Batch run with selected MODFLOW solution set .  \nThere is currently only one MODFLOW solution set in GMS so \u201c mfsto \n(MODFLOW)(STO) \u201d should appear in the combo box below the selected radio button.  \n3. Click OK to exit the Run Options  dialog.  \n4.3 Saving and Running MT3DMS in Stochastic Mode  \nNow to save the project and run MT3DMS using the MODFLOW stochastic results:  \n1. Save   the project.  \n2. Select MT3D MS | Run MT3D MS\u2026  to bring up the MT3DMS Using Stochastic \nMODFLOW  dialog . \nMT3DMS is now running in stochastic mode. The spreadsheet at the top shows each \nmodel, and as each model run is completed, the spreadsheet will update the status for \nthe run as converged or not converged. It will take several minutes for all 27 model run s \nto be completed, depending on the speed of the computer being used.  \n4.4 Importing and Viewing the MT3DMS Solutions  \nOnce all the MT3DMS runs are completed, import the solutions as follows:  \n1. Turn on Read solution on exit  and Turn on contours (if not on already) . \n2. Click Close  to exit the MT3DMS Using Stochastic MODFLOW dialog and bring \nup the Reading Stochastic Solutions  dialog.  \nThis dialog appears after the MT3DMS run dialog closes, listing each MT3DMS solution \nand whether it converged (just as with the MODFLOW s tochastic run).  \n3. Click OK to import the solutions and exit the Reading Stochastic Solutions  dialog.  \n4. Select the \u201c  mfsto001 (MT3DMS)\u201d solution under the \u201c  mfsto \n(MT3DMS)(STO)\u201d folder.  \nContours should be visible around the landfill similar to Figure 5. Feel free to explore the \nremaining solutions under the \u201c  mfsto (MT3DMS)(STO)\u201d folder to see the results of the \nstochastic transport simulation.  \n\nGMS  Tutorials   MODFLOW \u2013 Stochastic Modeling, Parameter Randomization  \n \n Page 11 of 13 \u00a9 Aquaveo 2024   \nFigure 5      Contours visible around the landfill  \n4.5 Threshold Analysis  \nNow that the MT3DMS solution set has been imported, a threshold analysis can be \ncompleted on the computed leachate concentrations. A threshold analysis can be used to \ngenerate a dataset representing the probability that a set of conditions is satisfied. For \nthis case, it is necessary to generate a plot indicating the probability that the leachate \nconcentration exceeds \u201c10.0\u201d.  \nTo do this, a rule will be set up to mark leac hate concentrations above \u201c10.0\u201d. GMS then \nsearches through all the selected solutions and counts how many times the leachate \nconcentration is exceeded for each cell. This number is then divided by the total number \nof solutions (27, in this case). These re sults are then contoured as a probability threshold \ndataset.  \n1. Right -click on \u201c  mfsto (MT3DMS)(STO) \u201d in the Project Explorer  (the folder \ncontaining the individual MT3DMS stochastic solutions) and select Risk \nAnalysis\u2026  to bring up the Risk Analysis Wizard  dialog.  \n2. Select \u201cMT3DMS \u201d in the box at the top.  \n3. Click Next  to go to the Threshold Analysis  dialog.  \nThis dialog allows the threshold analysis rules to be defined. Because there is only one \ncontaminant \u2014leachate \u2014only one rule is needed.  \n4. On row 1, select \u201c >\u201d from the drop -down in the Operator  column.  \n5. In the Value  column, enter \u201c 10.0\u201d as the concentration.  \n6. Below the spreadsheet, enter \u201c above10 \u201d as the Analysis title . \n7. Click Finish  to close the Threshold Analysis  dialog.  \n8. When the analysis finishes, select the new \u201c   above10\u201d dataset in \u201c  mfsto \n(MT3DMS)(STO) \u201d in the Project Explorer.  \nThis dataset contains the probability that the leachate concentration will be above \u201c10.0\u201d \nfor each of the time steps of our MT3DMS model. The best way to view this dataset is to \nturn o n color -filled contours.  \n9. Click Contour Options   to open the Dataset Contour Options \u2013 3D Grid \u2013 \nabove10 dialog.  \n\nGMS  Tutorials   MODFLOW \u2013 Stochastic Modeling, Parameter Randomization  \n \n Page 12 of 13 \u00a9 Aquaveo 2024  10. Turn on Legend  in the lower left corner of the dialog.  \n11. Select \u201cColor fill\u201d from the top drop -down in the Contour method  section.  \n12. Click Color Ramp\u2026 to open the Choose color ramp  dialog . \n13. Select the Hue 1 color palette.  \n14. Click OK to close the Choose  color ramp  dialog . \n15. Click OK to exit the Dataset Contour Options \u2013 3D Grid \u2013 above10 dialog.  \nA probability plume should now extend from the landfill similar to Figure 6. Feel free to \ncycle through the time steps to see the probabilities at the different times.  \n \n      Figure 6      Leachate probability plume at time step 1 (300.0)  \n4.6 Statistical Analysis  \nThe mean, min, max, and standard deviation datasets can be generated from the output \nof a stochastic run. Create these statistical datasets for the MT3DMS stochastic run using \nthe ste ps below.  \n1. Right -click on \u201c  mfsto (MT3DMS)(STO) \u201d and select Statistical Analysis\u2026  to \ngenerate several new statistical datasets from the MT3DMS stochastic \nsimulation.  \n2. Once GMS is finished creating the datasets, select the \u201c  mean_leachate \u201d \ndataset in the Project Explorer.  \n3. Select time step 10 (it has a value of \u201c3000.0\u201d).  \n4. Select the \u201c  max_leachate \u201d dataset and select time step 10.  \nNotice the broad range of concentrations that are computed from the stochastic runs. \nFeel free to compare various time steps in the various datasets.  \n \n \n\nGMS  Tutorials   MODFLOW \u2013 Stochastic Modeling, Parameter Randomization  \n \n Page 13 of 13 \u00a9 Aquaveo 2024  5 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 Stochastic Modeling, Parameter Randomization\u201d \ntutorial. The following key concepts were discussed and demonstrated in this tutorial:  \n\uf0b7 GMS supports two types of stochastic approaches: parame ter randomization and \nindicator simulations.  \n\uf0b7 With parameter randomization, it is possible to do Random Sampling, Latin \nHypercube sampling, or user -defined sampling.  \n\uf0b7 It is possible to run an MT3DMS model using a set of stochastic MODFLOW \nsolutions, but curr ently GMS does not support running MT3DMS stochastically \nitself (randomizing the MT3DMS parameters).  \n\uf0b7 It is possible to run the Risk Analysis Wizard  on any folder of solutions. One of \nthe options in the Risk Analysis Wizard  is a threshold analysis.  \n\uf0b7 It is po ssible to generate the mean, min, max, and standard deviation of a \nstochastic simulation by selecting the Statistical Analysis  menu option when \nright-clicking on a folder of solutions.  \n \n", "filename": "MODFLOW-StochasticModeling-ParameterRandomization.pdf", "pages": 13}, "MODFLOW-STRPackage": {"text": "GMS Tutorials   MODFLOW \u2013 STR Package  \n Page 1 of 19 \u00a9 Aqua veo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 STR Package  \nThe MODFLOW Stream (STR) Package Interface in GMS  \n \nObjectives   \nLearn how to create a model containing STR -type streams. This tutorial will show how to create a \nconceptual model of the streams using arcs and orient them from upstream to downstream. It will discuss \nstream segment and reach numbering. It will also show how to create a parameter for stream \nconductance.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach I  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 25\u201340 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 STR Package  \n Page 2 of 19 \u00a9 Aqua veo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Stream Package Basics  ................................ ................................ ................................ ...... 4 \n2.1 Reaches and Segments  ................................ ................................ ...............................  4 \n2.2 Routing  ................................ ................................ ................................ .........................  4 \n3 Getting Started  ................................ ................................ ................................ .....................  4 \n3.1 Opening the Starting Project  ................................ ................................ .........................  4 \n3.2 Saving the Project with a New Name  ................................ ................................ ............  6 \n4 Digitizing and Setting Up the Stream Arcs  ................................ ................................ ........  6 \n4.1 Creating a Conceptual Model  ................................ ................................ .......................  7 \n4.2 Creating a Coverage  ................................ ................................ ................................ ..... 7 \n4.3 Creating the Arcs  ................................ ................................ ................................ ..........  7 \n4.4 Correcting the Arc Directions  ................................ ................................ ........................  8 \n4.5 Stream Reach and Segment Numbering  ................................ ................................ ...... 9 \n5 Assigning Arc and Node Attributes  ................................ ................................ .................  10 \n5.1 Arc A  ................................ ................................ ................................ ...........................  10 \n5.2 Arcs B through  H ................................ ................................ ................................ ........  11 \n5.3 Segment IDs  ................................ ................................ ................................ ...............  12 \n5.4 Assigning Node Attributes  ................................ ................................ ..........................  12 \n6 Map \u2192 MODFLOW  ................................ ................................ ................................ .............  13 \n6.1 STR Package Dialog  ................................ ................................ ................................ .. 13 \n6.2 Saving the Project and Running MODFLOW  ................................ ..............................  14 \n6.3 Comparing the Solutions  ................................ ................................ ............................  15 \n6.4 Flow Budget  ................................ ................................ ................................ ................  16 \n6.5 Flow from Arcs  ................................ ................................ ................................ ............  17 \n6.6 Flow i n the Stream Channel  ................................ ................................ .......................  18 \n7 Conclusion  ................................ ................................ ................................ .........................  19 \n \n1 Introduction  \nThe MODFLOW STR package is used to model the effects of rivers on aquifers while \ntracking the amount of flow in the river. The STR package is an evolution of the River \npackage and a precursor to the SFR2 package. Unlike the River package, however, flow \nis routed through the stream. The STR package also allows rivers to go dry during a \ngiven period of the simulation.  \nFor the STR package, simple channel hydraulics and Manning\u2019s equation are used to \ncompute the stage in the stream. GMS supports all three stre am packages (SFR2 \nincorporates all features of the older SFR1 package).  \nBecause of the grid -independent conceptual model approach that GMS supports, GMS is \nan ideal modeling interface for creating streams. Stream segments and reaches must be \nlisted in a pa rticular order that can be quite tricky to get right if preparing a file by hand. \nGMS takes care of stream ordering automatically with a simple point -and-click stream \ncreation interface so the user rarely has to worry about it.  \nThis tutorial illustrates ho w to create a model containing STR type streams. The model in \nthis tutorial is an STR adaptation from the SFR1 documentation ( Figure 1). The problem \nis a hypothetical one \u201cdeveloped for an alluvial basin in a semiarid region in which \nrecharge to the aquifer is primarily leakage from streams that enter the basin from \nmountain s on the northwest, northeast, and southeast\u201d.1 One grid layer is used.  \n                                                      \n1 Prudic, David E.; Konikow, Leonard F.; Banta, Edward R., (2004). A New Streamflow -Routing \n(SFR1) Package to Simulate Stream -Aquifer Interaction with MODFLOW -2000 , U.S. Geological \nSurvey Open -File Report 2004 \u20131042, p.13. https://pubs.usgs.gov/of/2004/1042/ofr2004 -1042.pdf  \nGMS Tutorials   MODFLOW \u2013 STR Package  \n Page 3 of 19 \u00a9 Aquaveo 2024   \n      Figure 1      The stream network2 \nThe simulation has two stress periods. In the first stress period, the wells in the middle of \nthe model extract water  from the model and draw down the water table. In the second \nstress period, the wells are turned off and the head recovers from the draw down. The \nstream data is held constant for both stress periods.  \nThis tutorial will demonstrate and discuss:  \n\uf0b7 Adding str eam feature arcs by digitizing a background image.  \n\uf0b7 Ensuring that the stream arcs are pointing in the right direction.  \n\uf0b7 Assigning attributes to the stream arcs and nodes.  \n\uf0b7 Saving and running the model.  \n\uf0b7 Examining the solution.  \n                                                      \n2 Prudic (2004), p.14.  \n\nGMS Tutorials   MODFLOW \u2013 STR Package  \n Page 4 of 19 \u00a9 Aquaveo 2024  2 Stream Package Basics  \n2.1 Reaches an d Segments  \nThe STR package divides streams into reaches and segments.  \nStreams superimposed on the aquifer are divided into reaches and segments. A segment \nis a stream or diversion in which streamflow from surface sources are added at the \nbeginning of the segment or subtracted (in the case of a diversion) at the end of a \nsegment. A reach is the part of a segment that corresponds to an individual cell in the \nfinite -difference grid used to simulate ground -water flow in an aquifer. A segment may \nconsist of one  or more reaches.3 \nIn GMS, a stream segment corresponds to a single arc. A stream reach doesn\u2019t have a \ncorresponding representation in the conceptual model but exists only on the grid cells \nafter having mapped the conceptual model to the grid.  \n2.2 Routing  \nIn addition to tracking flow between streams and the underlying aquifer, the MODFLOW \nstream packages (STR1, SFR1 and SFR2) also route the flow of water through a stream \nnetwork. The stream network can include tributaries, diversions, and lakes (in conjunction \nwith the Lake Package).  \nRouting is accomplished by determining the inflows for a reach (which are specified for \nthe most upstream reach), adding or subtracting leakage to the aquifer, and allowing any \nremainder to pass to the next downstream reach as inflo w. The process is repeated for \nthe next downstream reach and so forth.  \nThis is different from the MODFLOW River Package, which only tracks flow between the \nriver and the aquifer. With the River Package, once water has entered the river, it is lost \nto the m odel. With the stream packages, that water can travel downstream and possibly \nreenter the aquifer at another point.  \nUnlike the River package, the water depth is calculated based on the flow rather than \nbeing manually entered. There are several different op tions available for calculating water \ndepth, including using Manning\u2019s equatio n or a depth versus flow table.  \n3 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.   \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n3.1 Opening the Starting Project  \nThe point of this tutorial is to illustrate the STR package, so previously created files will \nbe imported rather than spending time entering the other MO DFLOW inputs.  \n                                                      \n3 Prudic, David E. (1989). Documentation of a Computer Program to Simulate Stre am-Aquifer \nRelations Using a Modular, Finite Difference, Ground -Water Flow Model, U.S. Geological Surveay \nOpen -File Report 88 \u2013729, p.3. http://pubs.usgs.gov/of/1988/0729/report.pdf  \nGMS Tutorials   MODFLOW \u2013 STR Package  \n Page 5 of 19 \u00a9 Aquaveo 2024  1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the str\\str\\ directory and select \u201cstart.gpr\u201d.  \n4. Click Open  to import the project and exit the Open  dialog.  \nA grid with some st reams and contour lines should appear ( Figure 2).  \n \n      Figure 2      Initial project appearance  \n5. Right -click in a blank spot in the Project Explorer and select Expand All . \nNotice the Project Explorer includes a 3D grid and a MODFLOW simulation ( Figure 3).  \n\nGMS Tutorials   MODFLOW \u2013 STR Package  \n Page 6 of 19 \u00a9 Aquaveo 2024   \n      Figure 3      Project Explorer at the project beginning  \n3.2 Saving the Project with a New Name  \nBefore making changes, it is good to save the project with a new  name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cSTR_GMS.gpr\u201d as the File name . \n4. Click  Save  to save the project under the new name and close the Save As  \ndialog.  \nIt is recomm ended to Save   the project periodically throughout the tutorial . \n4 Digitizing and Setting Up the Stream Arcs  \nIn GMS, it is only possible to create streams by using the conceptual model approach. \nThis is done by mapping feature objects to the grid. Streams c annot be created directly \non the grid. Instead, stream arcs are created by digitizing the background image.  \n\nGMS Tutorials   MODFLOW \u2013 STR Package  \n Page 7 of 19 \u00a9 Aquaveo 2024  4.1 Creating a Conceptual Model  \nFirst, to create a MODFLOW conceptual model:  \n1. Right -click in a blank area in the Project Explorer and select New | Concep tual \nModel\u2026  to bring up the Conceptual Model Properties  dialog.  \n2. Enter \u201cTest 1\u201d as the Name . \n3. Click OK to close the Conceptual Model Properties  dialog.  \n4.2 Creating a Coverage  \n1. Right -click on the \"  Test 1\" conceptual model and select New Coverage\u2026  to \nbring up the Coverage Setup dialog.  \n2. Enter \"Streams\" as the Coverage name . \n3. In the Sources/Sinks/BCs  column, scroll down and turn on Stream.  \n4. Enter \u201c1500.0\u201d as the Default elevation so the coverage will be above the grid.  \n5. Click OK to close the Coverage Setup  dialog.  \n6. Select the new \u201c  Streams\u201d coverage to make it active.  \n4.3 Creating the Arcs  \nNow, create the arcs for the streams. Refer to Figure 4 for the  first four steps below.  \n1. Using the Create Arc   tool, create an arc along the path of Green Creek (from \nthe top left corner down to the Blue River).  \n2. Create an arc for the Ditch (from Green Creek to Little Creek).  \n3. Create an arc for Little Creek (from the ri ght edge to Green Creek).  \n4. Create an arc for the Blue River (from the right edge to the left edge).  \nNow that the arcs have been digitized, the background image is no longer necessary.  \n5. In the Project Explorer, turn off the \u201c  GIS Layers\u201d folder.  \n\nGMS Tutorials   MODFLOW \u2013 STR Package  \n Page 8 of 19 \u00a9 Aquaveo 2024   \n      Figure 4      Location of stream arcs after digitizin g (arcs bolded for clarity)  \n4.4 Correcting the Arc Directions  \nArcs have a direction associated with them. The direction is from the starting node to the \nending node and is defined when the arc is first created. Usually the direction doesn\u2019t \nmatter, but stream arcs must go from upstream to downstream. The direction can be \ndisplayed and reversed if needed.  \nTo check the arc direction and make sure all the arcs are pointing from upstream to \ndownstream, do the following.  \n1. Click Display Options   to bring up the Display Options  dialog.  \n2. Select \u201c  Map Data\u201d from the list on the left.  \n3. On the Map tab, near the bottom of the first section, turn on Arc direction arrows . \n4. Click OK to close the Display Options  dialog.  \nArrows should now be visible on the arcs. The arrows should be pointing as shown in       \nFigure  5. If any of the arcs are pointing in  the wrong direction, do the following:  \n5. Using to the Select Arcs   tool, select the arc, then right -click and select \nReverse Arc Direction  to change the direction of the flow along the arc.  \n6. Repeat step 5 for any arcs pointing the wrong direction.  \n\nGMS Tutorials   MODFLOW \u2013 STR Package  \n Page 9 of 19 \u00a9 Aquaveo 2024   \n      Figure 5      Arc directions.  \nWith all arcs pointing the correct direction, the flow arrows can be turned off.  \n7. Click Display Options   to bring up the Display Options  dialog.  \n8. Select \u201c  Map Data\u201d from the list on the left.  \n9. On the Map tab, near the bottom of the first section, turn off Arc direction arrows . \n10. Click OK to close the Display Options  dialog.  \n4.5 Stream Reach and Segment Numbering  \nGMS automatically numbers stream segments and reaches. However, be aware of the \nconcept as th e numbering will be seen in the STR package dialog (covered later in this \ntutorial).  \nAccording to the STR package documentation, \u201c Segments are numbered sequentially \nfrom the farthest  upstream segment to the last downstream segment , as are reaches \nwithin ea ch segment.\u201d4 Figure 6 illustrates stream and segment numbering.  \n                                                      \n4 Prudic (1989 ), p.3  \n\nGMS Tutorials   MODFLOW \u2013 STR Package  \n Page 10 of 19 \u00a9 Aquaveo 2024   \n      Figure 6      Illustration of stream segment and reach numbering5 \nGMS assigns an integer ID number to each arc automatically as it is created. This ID \nnumber is not the stream segment number. Stream segment and reach numbers are only \ndetermined when the Map \u2192 MODFLOW  command is executed. Be careful to not \nconfuse arc ID n umbers with stream segment numbers.  \n5 Assigning Arc and Node Attributes  \nNow to assign the stream attributes to the arcs.  \n5.1 Arc A  \n1. Using the Select Arcs   tool, double -click on arc A (see Figure 7) to bring up \nthe Attribute Table  dialog.  \n2. Select \u201cstream\u201d from the drop -down in the Type  column.  \n3. Enter the remaining values as given in the following table. Only the columns with \nchanges are shown, and some may require scrolling to the right to see:  \nName  Cond.  Width  Roughness  Inc. flow  \nA 0.0003  20.0 0.03 25.0 \n4. Click OK to close the Attribute Table  dialog.  \n5. Click on a blank spot in the Graphics Window to deselect arc A.  \n                                                      \n5 Prudic (2004), p.3  \n\nGMS Tutorials   MODFLOW \u2013 STR Package  \n Page 11 of 19 \u00a9 Aquaveo 2024   \n      Figure 7      Arcs with letters to distinguish them  \n5.2 Arcs B through H  \n1. Using the Select Arcs   tool, double -click on arc B to bring up the Attribute \nTable  dialog.  \n2. Repeats steps 2 \u20133 from section Error! Reference source not found.  to assign \nhe values shown in the table below.  \n3. Click OK to exit the Attribute Table  dialog.  \n4. Repeat steps 1 \u20133 for arcs C through H, using the values in the table below.  \nARC \n(Figure \n7) Name  Type  Cond.  Width  Sinuosity  Roughness  Diversion  Inc. \nflow \nB B stream  0.0003  20.0 1.0 0.03  -1.0 \nC C stream  0.0003  5.0 1.0 0.03 \uf0fc 10.0 \nD D stream  0.0003  12.0 1.0 0.03  10.0 \nE E stream  0.0003  15.0 1.0 0.03  -1.0 \nF F stream  0.0003  27.0 1.1 0.03  -1.0 \nG G stream  0.0003  45.0 1.0 0.025  150.0  \nH H stream  0.0003  52.0 1.0 0.025  -1.0 \nThe default \u201c -1.0\u201d in the Inc. flow  column denotes that the incoming flow is the sum of the \nimmediately upstream tributary segments.  \n\nGMS Tutorials   MODFLOW \u2013 STR Package  \n Page 12 of 19 \u00a9 Aquaveo 2024  5.3 Segment IDs  \nGMS can display the stream segment ID numbers by doing the following:  \n1. Click Display Options   to bring up the Display Options  dialog.  \n2. Select \u201c  Map Data\u201d from the list on the left.  \n3. At the bottom of the first section on the Map tab, turn on Segment ID . \n4. Click OK to exit the Display Options  dialog.  \nNotice the \u201c0\u201d displayed in the middle of each arc. The conceptual model has not yet \nbeen mapped to th e grid using the Map \u2192 MODFLOW  command. Until this is done, \nGMS does not know how the stream segments should be numbered. After the Map \u2192 \nMODFLOW is done, the stream segment numbers will follow the rule of upstream to \ndownstream.  \n5.4 Assigning Node Attributes  \nNow to assign the stream attributes to the nodes:  \n1. Select the \u201c  Streams\u201d coverage to make it active.  \n2. Using the Select Points/Nodes   tool, double -click node A as indicated in \nFigure 8 to bring up the Attribute Table  dialog.  \n3. Enter the top and bottom elevation as indicated in the table below.  \n Top elev.  Bot. elev.  \nA 1095   1092  \nB 1075  1072  \nC 1080  1078  \nD 1060  1056  \nE 1045  1040  \nF 1025  1020  \nG 1040  1036  \nH 990 984 \nNotice that no value is entered in the Head/Stage  column for the stream nodes. These \nwill be calculated when MODFLOW runs.  \n4. Click OK to close the Attribute Table  dialog.  \n5. Repeat steps 2 \u20134 for nodes B through H, using the elevations listed for each in \nthe table above.  \n6. Click on a blank spot in the Graphics Window to deselect all nodes.  \n\nGMS Tutorials   MODFLOW \u2013 STR Package  \n Page 13 of 19 \u00a9 Aquaveo 2024   \n      Figure 8      Nodes with letters to distinguish them  \n6 Map \u2192 MODFLOW  \nWith everything entered, the stream arcs and nodes can now be m apped to the grid.  \n1. Select Feature Objects | Map \u2192 MODFLOW  to bring up the Map \u2192 Model  \ndialog.  \n2. Click OK to accept the defaults and close the Map \u2192 Mod el dialog.  \nNotice the stream segment numbers are no longer all zeroes. The stream segments have \nbeen number ed so that downstream numbers are always greater than upstream \nnumbers.  \n6.1 STR Package Dialog  \nThe streams in the conceptual model have now been mapped to the grid. Now to review \nall of the stream segments and reaches on the grid:  \n1. Select \u201c  3D Grid Data \u201d in the Project Explorer to make it active.  \n2. Select MODFLOW  | Optional  Packages  | STR \u2013 Stream \u2026 to bring up the \nMODFLOW Stream ( STR) Package  dialog ( Figure 9). \n\nGMS Tutorials   MODFLOW \u2013 STR Package  \n Page 14 of 19 \u00a9 Aquaveo 2024   \n      Figure 9      MODFLOW Stream (STR) Package dialog  \nThe stream segments are listed in the top right spreadsheet, and the reaches are listed in \nthe bottom spreadsheet. GMS calculated the conductance during the Map \u2192 MODFLOW  \nprocess.  \nNotice that most fields in this dialog can be edited, though segment numbers and reach \ncell IDs cannot be edited, and segments and reaches cannot be added. Stream data can \ntherefore only be created by mapping to MODFLOW from a conceptual model. If a \nMODFLOW si mulation with STR data is imported, it will populate the stream package \ndialog even if a conceptual model is not present.  \n3. Just above the bottom spreadsheet, turn on Save ISTCB2 info to *.ccf2 file . \nThis writes stream flow in each stream reach to a CCF2 file. The information written to \nthis file can be reviewed after running MODFLOW.  \n4. Click OK to exit the MODFLOW Stream (STR) Package  dialog.  \n6.2 Saving the Project and Running MODFLOW  \nNow to save the proje ct and run MODFLOW:  \n1. Save   the project . \n2. Select MODFLOW  | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n3. After the model finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and exit  the MODFLOW  model wrapper dialog.  \n\nGMS Tutorials   MODFLOW \u2013 STR Package  \n Page 15 of 19 \u00a9 Aquaveo 2024  5. Make sure \u201c  GIS Layers\u201d is turned off.  \nThe Graphics Window should appear similar to Figure 10. \n \n      Figure 10      The contours are clearly visible  \n6.3 Comparing the Solutions  \nTo compare the new solution with the original one from the USGS:  \n1. Click Contour Options   to bring up the Dataset Contour Options \u2013 3D Grid \u2013 \nHead  dialog.  \n2. In the Contour interval section, select \u201c Specified Values \u201d from the drop -down .  \n3. Enter \u201c5\u201d in the field to the right of the drop -down.  \n4. In the spreadsheet below that, enter \u201c1000.0\u201d for dark blue, \u201c1020.0\u201d for cyan, \n\u201c1040.0\u201d for green, \u201c1060.0\u201d for yellow, and \u201c1080.0\u201d for red.  \nThe dialog should appear similar to Figure 11. \n\nGMS Tutorials   MODFLOW \u2013 STR Package  \n Page 16 of 19 \u00a9 Aquaveo 2024   \n      Figure 11      Dataset Contour Options dialog  \n5. Click OK to exit the Dataset Contour Option s \u2013 3D Grid \u2013 Head  dialog.  \n6. Turn on \u201c GIS Layers \u201d in the Project Explorer.  \nNotice how the GMS contours match the contours on the background image pretty \nclosely. The match isn\u2019t perfect for two reasons. First, the stream input generated by \nGMS differs some  from the original USGS input. In particular, the reach lengths are \ndifferent. The original USGS files, which were built by hand, contain rough estimates for \nthe length of the stream channel within each model cell. GMS, on the other hand, \ncalculates this v alue by intersecting the stream arcs with the grid cells.  \nThe second reason why the contour lines differ is due to the different methods used by \nthe USGS and GMS to interpolate and generate contour lines from gridded data.  \n7. Turn off the \u201c  GIS Layers \u201d folde r. \n6.4 Flow Budget  \nNow to look at the flow budget for the streams:  \n1. Select MODFLOW | Flow Budget\u2026  to bring up the Flow Budget  dialog.  \nNotice the entries in the Flow In  and Flow Out  columns on the Stream Leakage  row. \nThere is more flow in than out because the streams are mostly losing water. Water is \nflowing from the streams into the aquifer in most places, but there is some flow out from \nthe aquifer to the streams.  \n2. Click OK to close the Flow Budget  dialog.  \n3. Selec t \u201c  3D Grid Data \u201d in the Project Explorer to make it active.  \n\nGMS Tutorials   MODFLOW \u2013 STR Package  \n Page 17 of 19 \u00a9 Aquaveo 2024  4. Select and then right -click on \u201cCCF (STR_GMS.ccf)\u201d  and select CCF \u2192 \nDatasets. \nNotice that a number of datasets have appeared within the solution folder.  \n5. Select \u201c  STREAM LEAKAGE\u201d to make it acti ve. \n6. Click Contour Options   to bring up the Dataset Contour Options \u2013 3D Grid \u2013 \nSTREAM LEAKAGE  dialog.  \n7. In the Contour method  section, select \u201c Block Fill \u201d from the first drop -down.  \n8. In the Contour interval  section, select \u201c Number \u201d from the drop -down and enter \n\u201c10\u201d in the field to the right of the drop -down.  \n9. Click OK to exit the Dataset Contour Options \u2013 3D Grid \u2013 STREAM LEAKAGE  \ndialog.  \nThe Graphics Window will appear similar to Figure 12 when the first time step is selected.  \n \n      Figure 12      Block Fill showing stream in/out flow  \nUsing the Select Cells   tool, move the mouse cursor over the grid  cells and watch the \nstatus bar at the bottom of the Graphics Window to see what the stream flow is \nthroughout the grid.  \n6.5 Flow from Arcs  \nSince the streams are created using the conceptual model, selecting the arcs allows for \nviewing the computed flow into o r out of the aquifer.  \n1. Select the \u201c  Head\u201d coverage.  \n2. Next select the \u201c  Streams \u201d coverage in the Project Explorer to make it active.  \n3. Using the Select Arcs   tool, select arc A (see Figure 7) in the northwest \nportion of the model.  \n\nGMS Tutorials   MODFLOW \u2013 STR Package  \n Page 18 of 19 \u00a9 Aquaveo 2024  4. Look at the status bar at the bottom of the GMS window to see information on the \nselected arc. \u201c COMPUTED FLOW \u201d will be listed, showing a value around \u201c14.5\u201d \n(depending on the exact geometry of the arc).  \n5. Select other arcs as desired to see their computed flow.  \n6.6 Flow in the Stream Channel  \nIn the MODFLOW Stream ( STR) Package  dialog, the Save ISTCB2 info to *.ccf2 file  \noption was turned on. This file contains information about the calculated flow out  of each \nstream reach.  \n1. Right -click on \u201cCCF (STR_GMS.ccf2)\u201d in the Project Explorer and select CCF \u2192 \nDatasets . \nA new dataset should appear at the bottom of the solution folder. This dataset shows the \nstream reach flow at each cell.  \n2. Select \u201c  STREAM FLOW OU T\u201d to make it active.  \n3. Click Contour Options   to bring up the Dataset Contour Options \u2013 3D Grid \u2013 \nSTREAM FLOW OUT  dialog.  \n4. In the Contour interval  section, select \u201c Unique Values \u201d from the drop -down.  \n5. Click OK to exit the Dataset Contour Options \u2013 3D Grid \u2013 STREAM FLOW OUT  \ndialog.  \nThe Graphics Window will appear similar to Figure 13. Select different time steps to see \nhow the data changes with time.  \n \n      Figure 13      Stream Reach Flow  \n\nGMS Tutorials   MODFLOW \u2013 STR Package  \n Page 19 of 19 \u00a9 Aquaveo 2024  7 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 STR Package\u201d tut orial. The following  key concepts \nwere demonstrated and discussed in this tutorial : \n\uf0b7 Use GMS to create MODFLOW models with STR and SFR type streams.  \n\uf0b7 Streams must be created in the Map module using Feature Objects and cannot \nbe created directly on the grid.  \n\uf0b7 Make sure the stream arcs are oriented from upstream to downstream correctly.  \n\uf0b7 The conceptual model does not have to include all aspects of the model. In this \ncase, the conceptual model contained only the stream arcs and nodes. The other \nboundary conditions  were already part of the grid.  \n\uf0b7 GMS automatically determines the proper ordering of the stream data for input to \nMODFLOW based on the orientation and topology of the stream arcs.  \n\uf0b7 Click on feature objects and see the flow in or out of that object.  \n\uf0b7 View the computed flow out of each stream reach using the CCF2 file.  \n \n", "filename": "MODFLOW-STRPackage.pdf", "pages": 19}, "MODFLOW-SUBPackage": {"text": "GMS Tutorials   MODFLOW \u2013 SUB Package  \n Page 1 of 12 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 SUB Package  \nThe MODFLOW SUB Package Interface in GMS  \n \nObjectives   \nThis tutorial demonstrates how to use the MODFLOW SUB package interface in GMS.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach I  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 40\u201360 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 SUB Package  \n Page 2 of 12 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 Importing the Project  ................................ ................................ ................................ ..... 3 \n2.2 Saving the Model with a New Name  ................................ ................................ .............  4 \n3 Adding the SUB Package Using the Grid Approach ................................ .........................  4 \n3.1 Enabling the SUB Package  ................................ ................................ ..........................  4 \n3.2 Adding No -Delay Interbeds  ................................ ................................ ...........................  4 \n3.3 Adding Delay Interbeds  ................................ ................................ ................................  5 \n3.4 Additional Options  ................................ ................................ ................................ .........  6 \n3.5 Enabling Vertical Displacement Output  ................................ ................................ ........  6 \n3.6 Saving and Running MODFLOW  ................................ ................................ ..................  6 \n3.7 Examining the Solution  ................................ ................................ ................................ . 7 \n4 Building a Conceptual Model  ................................ ................................ .............................  8 \n4.1 Importing and Renaming the Original Model  ................................ ................................  8 \n4.2 Creating the Conceptual Model  ................................ ................................ ....................  8 \n4.3 Creating Layer 1 Coverage  ................................ ................................ ...........................  9 \n4.4 Creating the Polygon  ................................ ................................ ................................ .... 9 \n4.5 Setting Layer 1 Polygon Properties  ................................ ................................ ..............  9 \n4.6 Setting Layer 2 Polygon Properties  ................................ ................................ ............  10 \n4.7 Setting Layer 2 Polygon Properties  ................................ ................................ ............  10 \n5 Mapping to MODFLOW  ................................ ................................ ................................ ...... 10 \n5.1 SUB Package Array Values  ................................ ................................ ........................  11 \n5.2 Saving and Running MODFLOW  ................................ ................................ ................  11 \n5.3 Examine the Flow Budget  ................................ ................................ ...........................  12 \n6 Conclusion  ................................ ................................ ................................ .........................  12 \n \n1 Introduction  \nThe Subsidence and Aquifer -System Compaction (SUB) Package was developed by the \nUSGS to simulate aquifer compaction and land subsidence. The SUB package simulates \ncompaction of interbeds, including both elastic (recoverable) and inelastic (not \nrecoverable)  compaction. It also includes the ability to simulate interbeds where drainage \nfrom the interbed is immediate (no -delay) or delayed.  \nThe problem for this tutorial is illustrated in Figure 1. The model is based on a U.S. \nGeological Survey (USGS) model, which is described as follows:  \nAntelope Valley, California, is a topographically closed basin in the \nwestern part of the Mojave Desert, about 50 miles nor theast of Los \nAngeles. The Antelope Valley ground -water basin is about 940 square \nmiles and is separated from the northern part of Antelope Valley by faults \nand low -lying hills. Prior to 1972, ground water provided more than 90 \npercent of the total water s upply in the valley; since 1972, it has provided \nbetween 50 and 90 percent. Most ground -water pumping in the valley \noccurs in the Antelope Valley ground -water basin, which includes the \nrapidly growing cities of Lancaster and Palmdale. \u2026  \nThe ground -water fl ow system consists of three aquifers: the upper, \nmiddle, and lower aquifers. The aquifers, which were identified on the \nbasis of the hydrologic properties, age, and depth of the unconsolidated \ndeposits, consist of gravel, sand, silt, and clay alluvial depo sits and clay \nand silty clay lacustrine deposits. Prior to ground -water development in \nthe valley, recharge was primarily the infiltration of runoff from the \nsurrounding mountains. Ground water flowed from the recharge areas to \nthe playas where it discharg ed either from the aquifer system as \nevapotranspiration or from springs. Partial barriers to horizontal ground -\nwater flow, such as faults, have been identified in the ground -water \nbasin. Water -level declines owing to ground -water development have \nGMS Tutorials   MODFLOW \u2013 SUB Package  \n \n Page 3 of 12 \u00a9 Aquaveo 2024  eliminate d the natural sources of discharge, and pumping for agricultural \nand urban uses have become the primary source of discharge from the \nground -water system. Infiltration of return flows from agricultural irrigation \nhas become an important source of recharge t o the aquifer system.1 \nThe model has been discretized into a grid that consists of 43 rows, 60 columns, and \nthree layers. Each layer corresponds to the three aquifers. The simulation covers an 80 \nyear period \u2014from 1915 through 1995 \u2014with the first year being  steady -state.  \n \n      Figure 1      MODFLOW model for Antelope Valley  \nThis tutorial will discuss and demonstrate adding the SUB package to an existing \nsimulation using the grid approach, and creating a simple conceptual model to illustrate \nhow the SUB package can be modeled conceptually and mapped to MODFLOW.  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \nIf GMS is already running, select File | New  to ensure that the program settings are \nrestored to t heir default state. Click Don\u2019t Save  if asked to save changes.  \n2.1 Importing the Project  \nFirst, import the project:  \n1. Click Open   to bring up the Open  dialog.  \n                                                      \n1 Leighton, David A.; Phillips, Steven P. (2003). Simulation of Ground -Water Flow and Land \nSubsidence, Antelope Valley Ground -Water Basin, California . Water -Resources Investigations \nReport 03 -4016. U.S. Geological Survey, p.1. \nhttp://pubs.usgs.gov/wri/wrir034016/wrir034016.book.pdf  \n\nGMS Tutorials   MODFLOW \u2013 SUB Package  \n \n Page 4 of 12 \u00a9 Aquaveo 2024  2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down  \n3. Browse to the  sub\\sub folder and selec t \u201cstart.gpr\u201d.  \n4. Click Open  to import the project and exit the Open  dialog.  \nA MODFLOW model similar to that in Figure 1 should appear.  \n2.2 Saving the Model with a New Name  \nBefore making changes, save the model with a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cavgrid.gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n3 Adding the SUB Package Using the Grid Approach  \nBegin by adding the SUB package using the grid approach.  \n3.1 Enabling the SUB Package  \nThe first step is to turn on the SUB package by doing the  following:  \n1. Select MODFLOW | Global Options\u2026  to open the MODFLOW Global/Basic \nPackage  dialog.  \n2. Click Packages\u2026  to open the MODFLOW Packages / Processes  dialog.  \n3. In the Optional packages / processes  section, turn on SUB \u2013 Subsidence . \n4. Click OK to exit the MODF LOW Packages / Processes  dialog.  \n5. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n3.2 Adding No -Delay Interbeds  \nNext, to add no -delay interbeds for the first and second model layers:  \n1. Select MODFLOW | Optional Packages | SUB \u2013 Subsidence\u2026  to open the \nMODFLOW SUB Package  dialog.  \nThe Options  tab of the dialog contains general package values on the left, and delay \ninterbed material zone values on the right. The No Delay Interbeds  and Delay Interbeds  \ntabs are used for creating interbeds and setting the int erbed array values.  \n2. On the No Delay Interbeds  tab, click Insert Row   twice to create two new \ninterbed systems in the No-delay interbed layers (LN)  spreadsheet.  \n3. Enter \u201c1\u201d in the Layer  column on row 1. \n4. Enter \u201c2\u201d in the Layer  column on row 2. \nThe array value s for a particular interbed system are shown by selecting an item in the \ndesired system in the interbed layer spreadsheet.  \n\nGMS Tutorials   MODFLOW \u2013 SUB Package  \n \n Page 5 of 12 \u00a9 Aquaveo 2024  5. Select row 1 in the No-delay interbed layers (LN)  spreadsheet to show its values \nin the HC for system  array editor on the right.  \n6. Click 2D Dataset \u2192 Array  to bring up the Select Dataset  dialog.  \n7. In the Solution  section, select the \u201cPreconsolidated Head\u201d dataset and click OK \nto exit the Select Dataset dialog.  \n8. Select \u201c(Sfe) Elastic skeletal storage coef\u201d from the View/Edit  drop-down.  \n9. Click Constant \u2192 Array  to bring up the Grid Value  dialog.  \n10. Enter \u201c1.5e -4\u201d as the Constant value for grid  and click OK to exit the Grid Value  \ndialog.  \n11. Select \u201c(Sfv) Inelastic skeletal storage coef\u201d from the View/Edit  drop-down.  \n12. Click Constant \u2192 Array  to bring u p the Grid Value  dialog.  \n13. Enter \u201c8.0e -3\u201d as the Constant value for grid  and click OK to exit the Grid Value  \ndialog.  \n14. Select row 2 in the No-delay interbed layers (LN)  spreadsheet.  \n15. Select \u201c(HC) Preconsolidation head or stress (ft)\u201d from the View/Edit  drop-down.  \n16.  Repeat steps 6 \u201313, entering \u201c9.0e -5\u201d for the \u201c(Sfe) Elastic skeletal storage coef\u201d \nand \u201c5.0e -3\u201d for the \u201c(Sfv) Inelastic skeletal storage coef\u201d.  \n3.3 Adding Delay Interbeds  \nNow to add delay interbeds for the first and second layers:  \n1. On the Delay In terbeds  tab, click Insert Row   twice to create two new interbed \nsystems in the Delay interbed layers (LDN)  spreadsheet.  \n2. Enter \u201c1\u201d in the Layer  column on row 1 and \u201c2\u201d in the Layer  column on row 2. \n3. Select row 1 in the Delay interbed layers (LDN)  spreadshee t. \n4. Select \u201c(RNB) nequiv and areal extent\u201d from the View/Edit  drop-down.  \n5. Click Constant \u2192 Array  to bring up the Grid Value  dialog.  \n6. Enter \u201c1.0\u201d as the Constant value for grid  and click OK to close the Grid Value  \ndialog.  \n7. Select \u201c(DZ) bequiv  equivalent thickness (ft)\u201d from the View/Edit  drop-down.  \n8. Click Constant \u2192 Array  to bring up the Grid Value  dialog.  \n9. Enter \u201c5.5\u201d as the Constant value for grid  and click OK to close the Grid Value  \ndialog.  \n10. Select \u201c(NZ) Material zone numbers\u201d from the View/Ed it drop-down.  \n11. Click Constant \u2192 Array  to bring up the Grid Value  dialog.  \n12. Enter \u201c1\u201d as the Constant value for grid  and click OK to close the Grid Value  \ndialog.  \n13. Select \u201c(Dstart) Starting head in interbeds (ft)\u201d from the View/Edit  drop-down.  \n14. Click 2D Dataset \u2192  Array  to bring up the Select Dataset  dialog.  \n15. Select \u201cStarting Head 1\u201d from the Solution  section and click OK to close the \nSelect Dataset  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 SUB Package  \n \n Page 6 of 12 \u00a9 Aquaveo 2024  16. Select \u201c(DHC) Starting preconsolidation head (ft)\u201d from the View/Edit  drop-down.  \n17. Click 2D Dataset \u2192 Array  to bring up the Select Dataset  dialog.  \n18. Select \u201cPreconsolidated Head\u201d from the Solution  section and click OK to close \nthe Select Dataset  dialog.  \n19. Select row 2 in the Delay interbed layers (LDN)  spreadsheet and repeat steps 4 \u2013\n18 using the values from the followin g table:  \nSystem  Layer  RNB  DZ NZ Dstart  DHC  \n2 2 1.0 4.7 2 Starting Head 2  Preconsolidated Head  \n3.4 Additional Options  \n1. On the Options  tab, enter \u201c2\u201d in the Number of Material Zones (NMZ)  field.  \n2. In the Delay interbed material zone properties (DP)  spreadsheet, enter the \nfollowing values:  \nID Vertical K (ft/d)  Elastic spec. storage  Inelastic spec. storage  \n1 1.0e-6 5.0e-6 6.0e-4 \n2 0.5e-6 5.0e-6 6.0e-4 \n3.5 Enabling Vertical Displacement Output  \nNext to turn on the generation of vertical displacement data, which for layer 1 is the same \nas subsidence. The vertical displacement will be shown as a dataset in the MODFLOW \nsolution.  \n1. Click SUB Output Options\u2026  to open the MODFLOW SUB Package Output \nOption s dialog.  \n2. Click Populate Time Steps\u2026  to bring up the Populate Time Steps  dialog.  \n3. Select \u201cSpecified output last time step each stress period\u201d from the drop -down \nand click OK to close the Populate Time Steps  dialog.  \n4. In the All row, scroll to the right in the spreadsheet and check the box in the Save \nvert. disp. (Ifl8)  column.  \n5. Click OK to exit the MODFLOW SUB Package Output Options  dialog.  \n6. Click OK to exit the MODFLOW SUB Package  dialog.  \n3.6 Saving and Running MODFLOW  \nNow it is possible to save the changes and run MODFLOW.  \n1. Save   the project.  \n2. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n3. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the sol ution and close the MODFLOW  model wrapper \ndialog.  \n5. Save   the project with the new solution.  \n\nGMS Tutorials   MODFLOW \u2013 SUB Package  \n \n Page 7 of 12 \u00a9 Aquaveo 2024  3.7 Examining the Solution  \nNow it is possible to look more closely at the computed solution. First, to look at the flow \nbudget entries for the SUB package:  \nFlow Budget  \n1. Expand the \u201c  3D Grid Data\u201d folder, select the \u201c  Head\u201d dataset under the \u201c  \navgrid (MODFLOW)\u201d solution.  \n2. Select the final time step in the Time Step window.  \n3. Select MODFLOW | Flow Budget\u2026  to display the Flow Budget  dialog.  \nThe flow budget values for the SUB  package include the INST. IB STORAGE  and \nDELAY IB STORAGE . The values are approximately as shown in the table below. These \nvalues will be used to compare again later in the tutorial when building the same model \nusing the conceptual approach.  \nType  Flow In  Flow Out  \nINST. IB STORAGE  298,086  -6,406  \nDELAY IB STORAGE  149,747  -1,210  \n4. Select OK to close the Flow Budget  dialog.  \nViewing Vertical Displacement  \n5. Select \u201c  VerticalDisplacement\u201d under \u201c  avgrid (MODFLOW)\u201d.  \n6. If necessary, scroll to the bottom of the Time Step window and select the last \ntime step.  \nThe vertical displacement in the model varies from near zero to as high as about 6.9 ft in \ncell ID 1486.  \n7. Switch between the \u201c  VerticalDisplacement\u201d and \u201c  DrawDown\u201d datasets and \nnotice the similarities between th e grid contours of the two datasets.  \nCreating a Vertical Displacement Plot  \nNext to generate a plot that shows the vertical displacement for a single cell.  \n8. Select the \u201c  VerticalDisplacement\u201d dataset in the Project Explorer.  \n9. Select Grid | Find Cell\u2026  to brin g up the Find Grid Cell  dialog.  \n10. Enter \u201c1486\u201d as the Cell ID  and click OK to exit the Find Grid Cell  dialog.  \nCell 1486 will be selected in the Graphics Window.  \n11. Click Plot Wizard   to bring up the Step 1 of 2  page of the Plot Wizard  dialog.  \n12. In the Plot Type  section, select \u201cActive Dataset Time Series\u201d from the list on the \nleft.  \n13. Click Finish  to close the Plot Wizard  dialog.  \nThe generated plot is shown in Figure 2. Again, switching back and forth between the \u201c  \nVerticalDisplacement\u201d and \u201c  DrawDown\u201d  datasets in the Project Explorer shows there \nis a relationship between the two.  \n\nGMS Tutorials   MODFLOW \u2013 SUB Package  \n \n Page 8 of 12 \u00a9 Aquaveo 2024  14. Save   the project.  \n \n      Figure 2      Vertical displacement plot for cell ID 1486  \n4 Building a Conceptual Model  \nNext to use the conceptual model approach to add the same interbeds to the initial \nmodel.  \n4.1 Importing and Renaming the Original Model  \n1. Select File | New to close the grid -based mode l and reset to defaults.  \n2. Select Open   to bring up the Open  dialog.  \n3. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n4. Browse to the sub\\sub folder and select \u201cstart.gpr\u201d.  \n5. Click Open  to import the project and exit the Open  dialog.  \n6. Select File | Save As\u2026  to bring up the Save As  dialog.  \n7. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n8. Enter \u201cavconc.gpr\u201d as the File name . \nClick Save  to save the project under the new name and close the Save As  dialog.  \n4.2 Creating the Conceptual Model  \n1. Right -click in a blank spot in the Project Explorer and select New | Conceptual \nModel\u2026  to bring up the  Conceptual Model Properties  dialog.  \n2. Enter \u201cAntelope Valley\u201d as the Name . \n3. Select \u201cBCF\u201d from the Flow package  drop-down.  \n4. Under Advanced package options to include , turn on SUB \u2013 Subsidence.  \n5. Click OK to close the Conceptual Model Properties  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 SUB Package  \n \n Page 9 of 12 \u00a9 Aquaveo 2024  4.3 Creating Layer 1 Coverage  \n1. Right -click on the \u201c  Antelope Valley\u201d conceptual model and select New \nCoverage\u2026  to bring up the Coverage Setup  dialog.  \n2. Enter \u201clayer 1\u201d a s the Coverage name . \n3. In the Areal Properties  column, turn on SUB Delay Interbed  and SUB Non -delay \nInterbed.  \n4. Click OK to exit the Coverage Setup  dialog.  \n4.4 Creating the Polygon  \n1. Select the \u201c  layer 1\u201d coverage to make it active.  \n2. Turn off \u201c  GIS Layers\u201d in the Project Explorer.  \n3. Using the Create Arc   tool, create a quadrilateral arc surrounding the grid. \nEnd the arc on the beginning point to form a closed polygon (see Figure 3). \n4. Select Feature Objects | Build Polygons  to turn it into a polygon.  \n \n      Figure 3      Creating a polygon that encompasses the model grid  \n4.5 Setting Layer 1 Polygon Properties  \n1. Using the Selec t Objects   tool, double -click anywhere inside the newly created \npolygon to bring up the Attribute Table  dialog.  \n2. Enter the values from the right column in the table below into the fields indicated \nin the left column of the table. Leave all other properties  at the default values.  \n\nGMS Tutorials   MODFLOW \u2013 SUB Package  \n \n Page 10 of 12 \u00a9 Aquaveo 2024  SUB Sfe (elast. skel. st. coef, ND)  0.00015  \nSUB Sfv (inelast. skel. st. coef, ND)  0.008  \nSUB RNB (nequiv, D)  1.0 \nSUB DZ (bequiv equiv. thick., D)  (ft) 5.5 \nSUB Vertical k (D)  (ft/d)  1.0e-006 \nSUB Elastic spec. storage (D)  5.0e-006 \nSUB Inelastic spec. storage (D)  0.0006  \nClick OK to exit the  Attribute Table  dialog.  \n4.6 Setting Layer 2 Polygon Properties  \n1. Right -click on the \u201c  layer 1\u201d coverage in the Project Explorer and select \nDuplicate  to create the \u201c Copy of layer 1\u201d coverage.  \n2. Right -click on \u201c  Copy of layer 1\u201d and select Coverage Setup\u2026  to bring up the \nCoverage Setup  dialog.  \n3. Enter \u201clayer 2\u201d as the Coverage name .  \n4. Change the Default layer range  to \u201c2\u201d to \u201c2\u201d.  \nClick OK to exit the  Coverage Setup  dialog.  \n4.7 Setting Layer 2 Polygon Properties  \n1. Select \u201c  layer 2\u201d to make it active.  \n2. Using the Select Objects   tool, double -click anywhere inside the polygon to \nbring up the Attribute Table  dialog.  \n3. Enter the values from the right column in the table below into the fields indicated \nin the le ft column of the table. Leave all other properties at the default values.  \nSUB Sfe (elast. skel. st. coef, ND)  0.00009  \nSUB Sfv (inelast. skel. st. coef, ND)  0.005  \nSUB RNB (nequiv, D)  1.0 \nSUB DZ (bequiv equiv. thick., D)  (ft) 4.7 \nSUB Vertical k (D)  (ft/d) 5.0e-007 \nSUB Elastic spec. storage (D)  5.0e-006 \nSUB Inelastic spec. storage (D)  0.0006  \nClick OK to exit the  Attribute Table  dialog.  \n5 Mapping to MODFLOW  \nThe conceptual model is set up so now it can be mapped to the MODFLOW grid.  \n1. Select Feature Objects | Map \u2192 MODFLOW  to bring up the Map \u2192 Model  \ndialog.  \n2. Click OK to accept the defaults and close the Map \u2192 Model  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 SUB Package  \n \n Page 11 of 12 \u00a9 Aquaveo 2024  5.1 SUB Package Array Values  \nNow it is possible to take a look at the data in MODFLOW that was mapped to the SUB \npackage from the conceptual model.  \n1. Select MODFLOW | Optional Packages | SUB \u2013 Subsidence\u2026  to open the \nMODFLOW SUB Package dialog.  \nOn the Options  tab, note that two materials have been created in the Delay interbed \nmaterial zone properties (DP) spreadsheet.  \n2. On the No Delay Interbeds tab, switch between the different arrays using the \nView/Edit  drop-down and the layer spreadsheet.  \nNote that the \u201c(Sfe) Elastic skeletal storage coef\u201d and \u201c(Sfv) Inelastic skeletal storage \ncoef\u201d values have been properly mapped, and the \u201c (HC) Preconsolidation  head or stress \n(ft)\u201d values were mapped to the default value (0.0).  \n3. Select \u201c(HC) Preconsolidation head or stress (ft)\u201d from the View/Edit  drop-down.  \n4. Select row 1 in the No-delay interbed layers (LN) spreadsheet.  \n5. Click 2D Dataset \u2192 Ar ray to bring up the Select Dataset  dialog.  \n6. Select \u201cPreconsolidated Head\u201d and click OK to exit the Select Dataset  dialog.  \n7. Select row 2 in the No-delay interbed layers (LN)  spreadsheet.  \n8. Click 2D Dataset \u2192 Array  to bring up the Select Dataset  dialog.  \n9. Select \u201c Preconsolidated Head\u201d and click OK to exit the Select Dataset  dialog.  \n10. On the Delay Interbeds  tab, select \u201c(Dstart) Starting head in interbeds (ft)\u201d from \nthe View/Edit  drop-down.  \n11. Select row 1 in the Delay interbed layers (LDN)  spreadsheet.  \n12. Click 2D Dataset \u2192 Array  to bring up the Select Dataset  dialog.  \n13. Select \u201cStarting Head 1\u201d and click OK to close the Select Dataset  dialog.  \n14. Select row 2 in the Delay interbed layers (LDN)  spreadsheet.  \n15. Click 2D Dataset \u2192 Array  to bring up the Select Dataset  dialog.  \n16. Select \u201cS tarting Head 2\u201d and click OK to close the Select Dataset  dialog.  \n17. Select \u201c(DHC) Starting preconsolidation head (ft)\u201d from the View/Edit  drop-down.  \n18. Select row 1 in the Delay interbed layers (LDN)  spreadsheet.  \n19. Click 2D Dataset \u2192 Array  to bring up the Select D ataset  dialog.  \n20. Select \u201cPreconsolidated Head\u201d and click OK to close the Select Dataset  dialog.  \n21. Select row 2 under Delay interbed layers (LDN)  and repeat steps 19 \u201320. \n22. Click OK to exit the MODFLOW SUB Package  dialog.  \n5.2 Saving and Running MODFLOW  \nNow it is possi ble to save the changes and run MODFLOW.  \n1. Save   the project.  \n2. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n\nGMS Tutorials   MODFLOW \u2013 SUB Package  \n \n Page 12 of 12 \u00a9 Aquaveo 2024  3. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to close the MODFLOW  model wrapper dialog.  \n5. Save   the project with the new solution.  \n5.3 Examine the Flow Budget  \nNow to review the computed solution more closely:  \n1. Expand the \u201c  3D Grid Data\u201d folder, then select the \u201c  Head\u201d dataset in the \u201c\n avconc  (MODFLOW)\u201d solution in the Project Explorer.  \n2. Select the last time step in the Time Step window.  \n3. Select MODFLOW | Flow Budget\u2026  to display the Flow Budget  dialog.  \nThe flow budget should match the values previously observed when adding the SUB \npackage using  the grid method. The values are shown in the table below.   \n \n \n \n6 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 SUB Package\u201d tutorial. The following key concepts \nwere discussed and demonstrated:  \n\uf0b7 GMS supports the MODFLOW SUB package.  \n\uf0b7 SUB data can be entered and viewed in the MODFLOW SUB  Package  dialog.  \n\uf0b7 SUB data can be entered in a conceptual model and then mapped to a \nMODFLOW model.  \n \nType  Flow In  Flow Out  \nINST. IB STORAGE  298,000  -6,400  \nDELAY IB STORAGE  150,000  -1,210  \n", "filename": "MODFLOW-SUBPackage.pdf", "pages": 12}, "MODFLOW-SWI-TwoAquiferSystem": {"text": "GMS Tutorials   MODFLOW \u2013 SWI2 Package, Two -Aquifer System  \n Page 1 of 12 \u00a9 Aquaveo 2024   \n \n \n \n \n \n \n \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 SWI2 Package, Two -Aquifer System  \nA Simple Example Using the MODFLOW SWI2 (Seawater Intrusion) \nPackage  \n \nObjectives   \nThis tutorial reviews the interface to the MODFLOW SWI2 package in GMS.  \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Grid \nApproach  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 15\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 SWI2 Package, Two -Aquifer System  \n Page 2 of 12 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 Importing the Flow Model  ................................ ................................ .............................  3 \n2.2 Saving the Project  ................................ ................................ ................................ .........  4 \n3 Examining the Model  ................................ ................................ ................................ ...........  4 \n3.1 Wells  ................................ ................................ ................................ .............................  4 \n3.2 Stress Periods  ................................ ................................ ................................ ..............  4 \n3.3 Setting Up the SWI2 Package  ................................ ................................ ......................  5 \n3.4 Creating the 2D Grid  ................................ ................................ ................................ ..... 7 \n3.5 Importing the Dataset  ................................ ................................ ................................ ... 8 \n3.6 Copying the 2D Dataset to the Zeta Arrays  ................................ ................................ .. 8 \n4 Setting the Effective Porosity (SSZ)  ................................ ................................ ...................  9 \n4.1 Seeing the Source Types (ISOURCE)  ................................ ................................ ..........  9 \n5 Saving the Running MODFLOW  ................................ ................................ .......................  10 \n6 Viewing the Solution  ................................ ................................ ................................ .........  10 \n6.1 Creating the Zeta Surface Dataset  ................................ ................................ .............  10 \n6.2 Creating a 2D Dataset of the Surface  ................................ ................................ .........  10 \n6.3 Animating the Surface  ................................ ................................ ................................  11 \n7 Conclusion  ................................ ................................ ................................ .........................  12 \n \n1 Introduction  \nGMS includes an interface to the SWI2 (Seawater Intrusion) package available in \nMODFLOW -2005. The SWI2 documentation describes the package as follows:  \nThe SWI2 Package is designed to simulate regional seawater intrusion in coastal \naquifer systems. The main advantage of using the SWI2 Package instead of variable -\ndensity groundwater flow and dispersive solute transport codes, such as SEAWAT \nand SUTRA, is t hat fewer model cells are required for simulations using the SWI2 \nPackage because every aquifer can be represented by a single layer of cells. This \nreduction in number of required model cells and the elimination of the need to solve \nthe advective -dispersiv e transport equation results in substantial model run -time \nsavings.1 \nFor a more detailed general explanation of the SWI2 package, please refer to the SWI2 \npackage documentation. This tutorial is based off of the third example problem included \nwith the SWI2  documentation.  \nThe model is a simple, two -dimensional simulation that illustrates the SWI2 package. \nThere is one interface separating seawater from freshwater and the model shows how \nthe interface between the seawater and the freshwater moves over time.  \nThe problem is further described in the SWI2 package documentation as follows:  \nExample 3 simulates transient movement of the freshwater -seawater interface in \nresponse to changing freshwater inflow in a two -aquifer coastal aquifer system. The \nproblem domain is 4,000 m long, 41 m high, and 1 m wide. Both aquifers are 20 m \nthick and are separated by a leaky layer 1 m thick. The aquifers are confined, storage \nchanges are not considered (all MODFLOW stress periods are steady -state), and the \ntop and bottom of each  aquifer is horizontal. The top of the upper aquifer and bottom \nof the lower aquifer are impermeable.  \n                                                      \n1 Bakker, Mark; Schaars, Frans; Hughes, Joseph D.; Langevin, Christian D.; and Dausman, Alyssa \nM. (2013). \u201cDocumentation of the seawater intrusion (SWI2) package for MODFLOW\u201d in \nTechnique s and Methods Book 6, Modeling Techniques . U.S. Geological Survey, chapter A46, pp. \niii, 1. http://pubs.usgs.gov/tm/6a46/tm6 -a46.pdf . \nGMS Tutorials   MODFLOW \u2013 SWI2 Package, Two -Aquifer System  \n \n Page 3 of 12 \u00a9 Aquaveo 2024  The domain is discretized into 200 columns that are each 20 m long (DELR), 1 row \nthat is 1 m wide (DELC), and 3 layers that are 20, 1, and 20 m thick. A t otal of 2,000 \nyears are simulated using two 1,000 -year stress periods and a constant time step of \n2 years. The hydraulic conductivity of the top and bottom aquifers are 2 and 4 m/d, \nrespectively, and the horizontal and vertical hydraulic conductivity of th e confining \nunit are 1 and 0.01 m/d, respectively. The effective porosity is 0.2 for all model layers.  \nThe left 600 m of the model domain extends offshore and the ocean boundary is \nrepresented as a general head boundary condition (GHB) at the top of model layer 1. \nA freshwater head of 0 m is specified at the ocean bottom in all general head \nboundaries. The GHB conductance that controls outflow from the aquifer into the \nocean is 0.4 square meter per day (m2/d) and corresponds to a leakance of 0.02 d -1 \n(or a resistance of 50 days).2  \nThis tutorial will discuss and demonstrate importing a simple two -dimensional \nMODFLOW model, turning on the SWI2 package, and entering the required data. It will \nalso demonstrate creating a matching 2D grid, importing a 2D dataset  representing the \nstarting surface (fresh/salt interface), and importing the dataset to the SWI package.  \nThe model will then be saved and MODFLOW will be run. A 2D grid will be \ncreated to visualize the freshwater -seawater surface, and the surface will be \nanimated to visualize its action over time.  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n3. If asked to save changes, click Don\u2019t Save  to close the dialog and restore GMS \nto a default state.  \n2.1 Importing the Flow Model  \nThe tutorial will begin by importing an existing model that does not use the SWI2 \npackage. The SWI2 package will be added to the mod el later in the tutorial.  \n1. Click  Open  to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the swi2ex03 \\swi2ex03 \\ directory and select \u201cstart.gpr\u201d.  \n4. Click Open to import the project and exit the Open  dialo g.  \nA model grid like the one shown in Figure 1 should appear. Notice that it is in front view, \nshowing the X -Z plane. The Z magnification has been exaggerated by a factor of 20 in \norder to view the model better.  \n                                                      \n2 Bakker, et al (2013), pp. 21 \u201322. \n\nGMS Tutorials   MODFLOW \u2013 SWI2 Package, Two -Aquifer System  \n \n Page 4 of 12 \u00a9 Aquaveo 2024   \n      Figure 1      Initial flow model  \nAlso notice that there a re two wells on the right edge of the model and some symbols in \nthe top layer on the left indicating general head boundary conditions. The wells inject \nfreshwater into the model and the general head boundary represents the ocean floor. The \ncontours are of the head dataset and indicate that flow is occurring from right to left.  \n2.2 Saving the Project  \nBefore making changes, save the project with a new name indicating this is the SWI2 \npackage example 3.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select  \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cswi2ex3.gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \nIt is recommended to periodically Save   while progressing through the tutorial.  \n3 Examining the Model  \nNow to review the flow model:  \n3.1 Wells  \n1. Fully expand the \u201c  3D Grid Data\u201d folder in the Project Explorer.  \n2. Right -click on \u201c  MODFLOW\u201d and select Optional Packages | WEL \u2013 Well\u2026  to \nopen the MODFLOW Well Package dialog.  \n3. In the Stress period  field, switch between \u201c1\u201d and \u201c2\u201d.  \nNotice how the value in the Q (flow)(m^3/d)  during the second stress period is halved.  \n4. Click Cancel  to exit the MODFLOW Well Package  dialog.  \n3.2 Stress Periods  \n1. In the Project Explorer, double -click on the \u201c  Global\u201d package to bring up the \nMODFLOW Global/Basic Package  dialog.  \nNotice the Model type  is Transient . \n2. Click Stress Periods\u2026  to open the Stress Periods dialog.  \n\nGMS Tutorials   MODFLOW \u2013 SWI2 Package, Two -Aquifer System  \n \n Page 5 of 12 \u00a9 Aquaveo 2024  Notice there are two stress periods, and both are set as steady state. There are two \nstress periods because th e pumping rate for the wells changes halfway through the \nsimulation. Each stress period is 1,000 years long (365,000 days), with 500 time -steps. \nEach time -step is therefore 2 years long.  \n3. Click Cancel  to exit the Stress Periods  dialog.  \n3.3 Setting Up the SWI2 P ackage  \nNow it is time to turn on the SWI2 Package and enter the data.  \n1. Click Packages\u2026  to bring up the MODFLOW Packages / Processes  dialog.  \n2. In the Optional packages / processes section, turn on SWI2 \u2013 Seawater \nIntrusion . \n3. Click OK to exit the MODFLOW Package s / Processes dialog.  \n4. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \nThe SWI2 Package Dialog  \nThe package is now enabled so the required data can be entered.  \n1. In the Project Explorer, right -click on \u201c  MODFLOW\u201d and select Optional \nPackages | SWI2 \u2013 Seawater Intrusion\u2026  to bring up the SWI2 Package  dialog \n(Figure 2). \n \n      Figure 2      SWI2 Package dialog  \nThe data required by the SWI2 package is entered in this dialog. The package consists of \nfour tables (listed on the left) and some arrays (the large area on the right). The tables \nare as follows:  \n\uf0b7 \u201cSwiText\u201d: A list of lines of text (or comments) that can appear at t he top of the \nSWI2 package file.  \n\nGMS Tutorials   MODFLOW \u2013 SWI2 Package, Two -Aquifer System  \n \n Page 6 of 12 \u00a9 Aquaveo 2024  \uf0b7 \u201cSwiOptions\u201d: A list of variables that control the SWI2 package, consisting of \ndatasets 1 \u20134 in the SWI2 input file. Refer to the SWI2 documentation for the \nmeaning of each variable.  \n\uf0b7 \u201cSwiNU\u201d: A list of the dimensionless den sities for each zone or for each surface, \ndepending on whether a stratified (ISTRAT = 1) or continuous (ISTRAT = 0) \nsimulation is being used (respectively).  \n\uf0b7 \u201cSwiObservations\u201d: A list of observations.  \nThere are also three arrays accessed by the buttons at t he top of the dialog: Surfaces \n(ZETA)\u2026 , Effective Porosity (SSZ)\u2026 , and Source Types (ISOURCE)\u2026 .  \nSetting the Number of Surfaces  \n1. Select \u201cSwiOptions\u201d from the list on the left.  \n2. Enter \u201c1\u201d for NSRF . \nNSRF is the number of surfaces, zeta, or interfaces (these th ree terms are used \ninterchangeably) between zones of differing water density. This model will have two \nzones \u2014freshwater and seawater \u2014so just one surface needs to divide them.  \n3. Enter \u201c1\u201d for ISTRAT . \nIf ISTRAT = 1, it is a stratified model, meaning the densit y of the water in each zone is \nspecified. If ISTRAT = 0, a continuous model is used, meaning the density of each \nsurface is specified, and the density varies linearly between the surfaces. This affects \nhow many density values need to be specified.  \n4. Leave th e rest of the options in the \u201cSwiOptions\u201d table at their default settings.  \nSetting the Fluid Density for Each Zone  \nBecause a stratified (ISTRAT = 1) model is being used, specify the dimensionless density \nof the water in each zone. Dimensionless density \u03bd (unitless) is defined as the following:  \n\u03bd = (\u03c1 - \u03c1f) / \u03c1 f \nwhere \u03c1 = the fluid density [M/L3] and \u03c1 f = the density of freshwater [M/L3] \nTo set the fluid density, do the following:  \n5. Select \u201cSwiNU\u201d from the list on the left.  \n6. Enter \u201c0\u201d in the NU column of row 1 of the table. This is the dimensionless \ndensity for zone 1, which is freshwater.  \n7. Enter \u201c0.025\u201d in the NU column of row 2. This is the dimensionless density for \nzone 2, which is seawater.  \nSetting the Surfaces (Zeta)  \nThis model has one surface, so the starting location must be entered.  \n1. Click Surfaces (ZETA)\u2026  to open the MODFLOW SWI Package \u2013 Surfaces \n(ZETA) dialog.  \nThe resulting dialog shows the zeta arrays, which are the surfaces between different \nzones (i.e., freshwater, brackish -water, seawater).  \n2. Change between the three layers by using the Layer  field.  \nGMS Tutorials   MODFLOW \u2013 SWI2 Package, Two -Aquifer System  \n \n Page 7 of 12 \u00a9 Aquaveo 2024  Notice that the surface is specified in each model layer and that there is data for each \nlayer. This can be confusing. Although, the freshwater -seawater interface is typically \nthought of as a two -dime nsional array, the SWI2 package requires the surface be \nspecified for every layer, which makes it a 3D array. The documentation explains this:  \nAn elevation for each surface needs to be specified for every cell in the model\u2026 For \nthe case of a surface that i s present at only one point in the vertical everywhere, the \nsame grid of zeta values may be entered for every model layer and SWI2 will \ndetermine in which cells the elevation of the zeta surface falls between the top and \nmodel of each layer.3 \nThe surface m ust be reasonably smooth or MODFLOW may have a harder time \nconverging. There are a number of options for entering the surface data, including the \nfollowing:  \n\uf0b7 Entering the data by hand in the dialog or copying/pasting from a spreadsheet for \neach layer.  \n\uf0b7 Copyi ng a 2D dataset to each layer of the zeta surface array via the 2D Dataset \n\u2192 ZETA\u2026  button in the SWI2 Package dialog. This requires a 2D grid which \nmatches the 3D grid. A dataset on the 2D grid is chosen and intelligently copied \nto the zeta arrays.  \n\uf0b7 Copying  a 3D dataset on the 3D grid to the zeta surface array using the 3D \nDataset \u2192 Grid\u2026  button in the array editor dialog. The 3D dataset may be \ncreated by interpolating from 2D scatter points or a raster.  \nIn this case, since this is a contrived example, the m ost likely scenario is that the zeta \nsurface was created in a spreadsheet. It would be preferable to see the surface, so \ncreate a 2D grid, import the surface as a dataset on the 2D grid, and then use the 2D \nDataset \u2192  ZETA\u2026  button in the SWI2 Package dialog  to get the data to the zeta array.  \n3. Click OK to exit the MODFLOW SWI Package \u2013 Surfaces (ZETA)  dialog.  \n4. Click OK to exit the SWI2 Package  dialog.  \n3.4 Creating the 2D Grid  \nFirst to create a 2D grid which matches the 3D grid:  \n1. In the Project Explorer, right -click on \u201c  grid\u201d and select Convert To | 2D Grid  to \nbring up the Z Value  dialog.  \n2. Click OK to accept the default z value and close the Z Value  dialog.  \nNotice the line which appeared above the 3D grid ( Figure 3). This is the 2D grid that will \nrepresent the zeta surface once it is in place with the correct dataset mapped to it.  \n                                                      \n3 Bakker, et al (2013), p. 18.  \n\nGMS Tutorials   MODFLOW \u2013 SWI2 Package, Two -Aquifer System  \n \n Page 8 of 12 \u00a9 Aquaveo 2024   \nFigure 3      The 2D grid appears as a horizontal line above the 3D grid in this \nview \n3.5 Importing the Dataset  \nNow to import a dataset to the 2D grid:  \n1. Right -click on the 2D \u201c  grid\u201d item and select Import Dataset\u2026  to bring up the \nDataset Filename  dialog.  \n2. Select \u201cText  Files (*.txt;*.csv)\u201d from the Files of type  drop-down.  \n3. Select \u201cZeta_1.txt\u201d and click Open  to close the Dataset Filename  dialog and \nbring up the Step 1 of 2  page of the Text Import Wizard  dialog.  \n4. In the section below the File import options  section, turn o n Heading row.   \n5. Click Next >  to go to the Step 2 of 2  page of the Text Import Wizard  dialog.  \n6. Click Finish  to import the dataset and close the Text Import Wizard  dialog.  \nThe 2D grid line that was previously above the 3D grid is now slanting down from left t o \nright through the 3D grid ( Figure 4). This represents the zeta surface.  \n \n      Figure 4      Slanting zeta surface visualized using a 2D grid. Seawater is on \nthe left, freshwater on the right  \n3.6 Copying the 2D Dataset to the Zeta Arrays  \n1. Right -click \u201c  MODFLOW\u201d in the Project Explorer and select Optional Packages \n| SWI2 \u2013 Seawater Intrusion\u2026  to bring up the SWI2 Package  dialog.  \n2. Click 2D Dataset \u2192 ZETA\u2026  to bring up the Select Dataset  dialog.  \n3. Select \u201cZeta_1\u201d and click OK to close the Select Dataset  dialog.  \nThe zeta arrays have now been set. To view this, do the following:  \n4. Click Surfaces (ZETA)\u2026  to bring up the MODFLOW SWI Package \u2013 Surfaces \n(ZETA)  dialog.  \n5. Scroll to the right to see how the values for layer 1 change along the grid profile.  \n\nGMS Tutorials   MODFLOW \u2013 SWI2 Package, Two -Aquifer System  \n \n Page 9 of 12 \u00a9 Aquaveo 2024  6. View the values for layers 2 and 3 by selecting the desired layer in the Layer  field \nand scrolling to the right to view the values.  \n7. Click OK to close the MODFLOW SWI Package \u2013 Surfaces (ZETA)  dialog.  \n4 Setting the Effective Porosity (SSZ)  \nTo set the effective porosity:  \n1. Click Effective Porosity (SSZ)\u2026  to bring up the MODFLOW SWI Package \u2013 \nEffective Porosity (SSZ)  dialog.  \n2. Click Constant \u2192 Grid\u2026  to bring up the Grid Value  dialog.  \n3. Enter \u201c0.2\u201d as the Constant value for grid  and click OK to close the Grid Value  \ndialog.  \n4. Click OK to close the MODFLOW SWI Package \u2013 Effective Porosity (SSZ)  \ndialog.  \n4.1 Seeing the Source Types (ISOURCE)  \nThe ISOURCE array is used to indicate what type of water (freshwater, seawater, etc.) \nthe sources and sinks should be injecting/extracting from the model. The ISOURCE array \nis the same size as the grid, so there is one value per cell.  \nThe wells n eed to be on the right side of the model to inject freshwater. The default \nISOURCE value of \u201c0\u201d means that \u201csources and sinks have the same fluid density as the \nactive zone at the top of the aquifer.\u201d4 Since freshwater is on the right side of the model, \nand the wells will be injecting freshwater, the default ISOURCE value of \u201c0\u201d is fine.  \nIf the ISOURCE is less than \u201c0\u201d, \u201csources have the same fluid density as the zone with \nthe number equal to the absolute value of ISOURCE. Sinks have the same fluid density \nas the active zone at the top of the aquifer. This option is useful for modeling of the ocean \nbottom where infiltrating water is salt, yet exfiltrating water is of the same type as the \nwater at the top of the aquifer.\u201d5 The general head cells on the left o f the model represent \nthe bottom of the ocean, so set them as follows.  \n1. Click Source Types (ISOURCE)\u2026  to bring up the MODFLOW SWI Package \u2013 \nSource Types (ISOURCE)  dialog.  \n2. Select the field in column 1 of row 1 in the spreadsheet and enter \u201c -2\u201d. \n3. Repeat step 2  for columns 2 through 30.  \n4. Click OK to close the MODFLOW SWI Package \u2013 Source Types (ISOURCE)  \ndialog.  \nClick OK to close the SWI2 Package  dialog.  \n \n                                                      \n4 Bakker, et al (2013), p. 44.  \n5 Ibid. \nGMS Tutorials   MODFLOW \u2013 SWI2 Package, Two -Aquifer System  \n \n Page 10 of 12 \u00a9 Aquaveo 2024  5 Saving the Running MODFLOW  \nBefore running MODFLOW, it is important to save the project. Because the file name  is \ndifferent than the existing solution, both the old and the new solution will be present for \ncomparison in the project.  \n1. Save   the project.  \n2. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n3. When the model finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.  \nThe Graphics Window should appear similar to Figure 5. \n \n      Figure 5      After the MODFLOW run  \n6 Viewing the Solution  \nThe solution includes the position of the surface between the freshwater zone and the \nseawater zone,  for every time step. This surface is saved in the budget, or CCF file, \nlabeled \u201c swi2ex3.swizeta \u201d. \n6.1 Creating the Zeta Surface Dataset  \n1. In the Project Explorer, under the \u201c  swi2ex3 (MODFLOW)\u201d solution, select \u201c  \nCCF (swi2ex3.swizeta)\u201d.  \n2. Right -click on \u201c  CCF (swi2ex3.swizeta)\u201d and select View Values\u2026  to bring up \nthe View Values  dialog.  \nNotice the column labeled \u201cZETASRF 1\u201d. This is the location of the surface. In order to \nvisualize the surface, first extract it as a dataset.  \n3. Click Done  to close the View V alues  dialog.  \n4. Right -click on \u201c  CCF (swi2ex3.swizeta)\u201d and select CCF \u2192 Datasets . \nNotice the new \u201cZETASRF 1\u201d dataset.  \n5. Select \u201cZETASRF 1\u201d to make it active.  \n6.2 Creating a 2D Dataset of the Surface  \nGMS is now contouring the surface dataset. A zeta surface 3D ar ray (instead of a 2D \nsurface) is not a very good way to visualize the surface as it causes the same issue as \n\nGMS Tutorials   MODFLOW \u2013 SWI2 Package, Two -Aquifer System  \n \n Page 11 of 12 \u00a9 Aquaveo 2024  experienced before. It is preferable to see a 2D surface instead of a 3D array in this case. \nThe SWI2 interface in GMS includes a way to convert th e 3D array into a 2D surface.  \n1. Right -click on \u201c  MODFLOW\u201d in the Project Explorer and select Optional \nPackages | SWI2 - Seawater Intrusion\u2026  to bring up the SWI2 Package  dialog.  \n2. Click 3D Dataset \u2192 2D Dataset\u2026  to bring up the Select Dataset  dialog.  \n3. Select \u201cZE TASRF 1\u201d in the Solution  section.  \n4. Turn on All time steps . \n5. Click OK to close the Select Dataset  dialog and open the New Dataset Name  \ndialog.  \n6. Click OK to accept the default name and close the New Dataset Name  dialog.  \n7. Click OK to close the SWI2 Package  dialog . \nA new 2D dataset named \u201c  ZETASRF 1\u201d will appear under \u201c  grid\u201d in the Project \nExplorer.  \n8. Select \u201c  ZETASRF 1\u201d under \u201c  grid\u201d to make it active.  \n9. In the time step window below the Project Explorer, select different time steps to \nsee how the surface changes  with time.  \nNotice that the seawater zone expands under the freshwater zone over time. Also, the \nfreshwater zone pushes to the left due to the injection of the freshwater wells. The last \ntime step is shown in Figure 6. \n10. Save   the project.  \n \n      Figure 6      Time step 1000  \n6.3 Animating the Surface  \nNow it is possible to create an animation that shows the surface moving.  \n1. Select Display | Animate\u2026  to bring up the Options  page of the Animation Wizard  \ndialog.  \n2. Click Next >  to accept the defaults and go to the Datasets  page of the Animation \nWizard  dialog.  \n3. Select Use constant interval . \n4. Enter \u201c7300\u201d as the Time interval . \n5. Click Finish  to close the Animation Wizard  dialog.  \nIf desired, view the generated animation file in a media application outside of GMS. The \nanimation may take a few moments to generate, depending on the speed of the computer \nused. Notice that the freshwater pushes to the left at the beginning of the simulation, and \nthe seawater pushes back to the right in the second half of the simulation when the well \ninjection rate is reduced.  \n\nGMS Tutorials   MODFLOW \u2013 SWI2 Package, Two -Aquifer System  \n \n Page 12 of 12 \u00a9 Aquaveo 2024  7 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 SWI2 Package, Two -Aquifer System\u201d tutorial. The \nfollowing  key concepts were discussed and demonstrated:  \n\uf0b7 GMS includes an interface to the SWI2 Seawater Intrusion package.  \n\uf0b7 GMS includes methods to do the following:  \no Convert a 2D dataset to a 3D zeta surface  \no Convert a 3D zeta surface to a 2D dataset  \no Convert a 3D dataset representing a zeta surface solution to a 2D \ndataset  \n \n", "filename": "MODFLOW-SWI-TwoAquiferSystem.pdf", "pages": 12}, "MODFLOW-TransientCalibration": {"text": "GMS Tutorials   MODFLOW \u2013 Transient Calibration  \n Page 1 of 14 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Transient Calibration  \nCalibration transient MODFLOW models  \n \nObjectives   \nGMS  provides a powerful suite of tools for inputting and managing transient data. These tools allow all \ndata to be managed using a date/time format that eliminates much of the extra data processing that is \noften required with modeling projects. This tutorial illustrates how these tools are used with transient \nmodel calibration.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Managing \nTransient Data  \n\uf0b7 MODFLOW \u2013 Model \nCalibration  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 20\u201335 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 Transient Calibration  \n Page 2 of 14 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Importing the Project  ................................ ................................ ................................ ...........  3 \n3 Save the Project with a New Name ................................ ................................ .....................  3 \n4 Entering Transient Data in the Map Module  ................................ ................................ ...... 3 \n4.1 Importing Transient Recharge Data  ................................ ................................ ..............  4 \n4.2 Importing Pumping Well Data  ................................ ................................ .......................  5 \n4.3 Assigning Storage Parameters  ................................ ................................ .....................  6 \n5 Initializing MODFLOW Stress Periods  ................................ ................................ ...............  7 \n5.1 Changing the MODFLOW Simulation to Transient  ................................ .......................  7 \n5.2 Setting Up the Stress Periods  ................................ ................................ .......................  7 \n6 Converting the Conceptual Model ................................ ................................ ......................  8 \n7 Saving and Running MODFLOW  ................................ ................................ ........................  9 \n8 Creating Observation Wells  ................................ ................................ ................................  9 \n9 Importing Transient Head Observations  ................................ ................................ .........  11 \n10 Saving and Running MODFLOW  ................................ ................................ ......................  11 \n11 Creating a Time Series Plot  ................................ ................................ ..............................  12 \n11.1 Creating Transient Observation Plots in Excel  ................................ ...........................  13 \n12 Conclusion  ................................ ................................ ................................ .........................  14 \n \n1 Introduction  \nBuilding a transient simulation typically requires the management of large amounts of \ntransient data from a variety of sources, including pumping well data, recharge data, river \nstages, and water levels in observation wells. Gathering and formatting such data can be \nvery tedious. GMS provides tools for importing time series data and converting that d ata \nto inputs for MODFLOW models.  \nThe model in this tutorial is the same one used in the \u201c MODFLOW \u2013 Conceptual Model \u201d \ntutorial. It starts with a steady state model then sets up MODFLOW stress periods and \nimports transient recharge and pumping data. Next, t he tutorial will show importing a set \nof transient -field-observed heads from observation wells and then calibrating the model. \nFinally, it will demonstrate adjusting the hydraulic conductivity, specific storage, and \nspecific yield values to see how they af fect the model.  \nThis tutorial will discuss and demonstrate:  \n\uf0b7 Opening a MODFLOW model and solution.  \n\uf0b7 Setting up a transient observation coverage.  \n\uf0b7 Importing transient head observations.  \n\uf0b7 Creating plots to visualize error in the model.  \n\uf0b7 Adjusting model parameters to better match the transient data.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n3. If asked to sav e changes, click Don\u2019t Save  to close the dialog and restore GMS \nto a default state.  \nGMS Tutorials   MODFLOW \u2013 Transient Calibration  \n \n Page 3 of 14 \u00a9 Aquaveo 2024  2 Importing the Project  \nFirst, import the project:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the trans_calib \\trans_calib  directory and select \u201c start.gpr \u201d. \n4. Click Open  to import the file and exit the Open  dialog . \nA MODFLOW model with a set of head contours should be visible ( Figure 1). \n \n      Figure 1      The initial model after importing  \n3 Save the Project with a New Name  \nBefore continuing, save the project with a new name.  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Select \u201cProject  Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201ctrans1 .gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog . \nIt is strongly recommended to save the project periodically.  \n4 Entering Transient Data in th e Map Module  \nThe first step in setting up the transient model is to associate the transient data with the \nrecharge polygon and the pumping well in the Map m odule . \n\nGMS Tutorials   MODFLOW \u2013 Transient Calibration  \n \n Page 4 of 14 \u00a9 Aquaveo 2024  4.1 Importing Transient Recharge Data  \nStart with assigning the transient recharge rate for the re charge polygon by importing \ntime series data from a text file. Transient data can be imported for polygons, arcs, \npoints, or nodes. The format for the text files is shown in Figure 2. \n \n      Figure 2      Example of transient recharge data in a text file  \nOnly a date field is present in the example above, though GMS supports specifying both \na date and a time. The Id column matches the Date  data with a particular polygon.  \n1. Fully expand the \u201c  Map Data\u201d folder in the Project Explorer.  \n2. Under the \u201c  East Texas \u201d conceptual model, select the \u201c  Recharge \u201d coverage \nto make it active.  \n3. Click Open   to bring up the Open  dialog.  \n4. Select \u201cText Files (*.txt ;*.csv )\u201d from the Files of type  drop-down.  \n5. Select \u201c recharge.csv \u201d and click Open  to exit the Open  dialog and bring up Step 1 \nof 2 of the Text Import Wizard  dialog (top shown in Figure 3). \nThis wizard is used to import text data into a GMS project. Note that if the text file being \nimported has a heading row, the Heading row  box must be checked for the data to be \nproperly imported (red arrow in Figure 3). In this example, there is not a heading row so \nthe box should not be checked here.  \n \n      Figure 3      The top of the Text Import Wizard dialog  \n6. Click Next  > to go to Step 2 of 2  of the Text Import Wizard  dialog.  \n7. Select \u201c Transient polygon data \u201d from the GMS data type  drop-down.  \n8. In the File preview  section in the Type  row, select \u201c ID\u201d from the drop -down  in the \nfirst (left -hand) column.  \n9. Select \u201c Date \u201d from the drop -down in the second (middle) column.  \n10. Select \u201c Recharge rate TS \u201d from the drop -down in the third (right -hand) column.  \nThe dialog should appear similar to Figure 4. \n11. Click on Finish  to close the Text Import Wizard  dialog.  \n12. When asked to make the time series a step function, click Yes. \n\nGMS Tutorials   MODFLOW \u2013 Transient Calibration  \n \n Page 5 of 14 \u00a9 Aquaveo 2024   \nFigure 4      Step 2 of 2 page o f the Text Import Wizard dialog  \n4.2 Importing Pumping Well Data  \nIn addition to the transient recharge data, the simulation will also contain a transient \npumping schedule for a well in the model. Pumping well data is typically imported using \ntwo files. The firs t file contains the name, screen geometry, and xy coordinates of the \nwells. The second file contains the pumping schedules. Since the well locations are \nalready defined, only import the pumping schedules. The format for the second file is \nshown in Figure 5. \n \n      Figure 5      Pumping schedule data file format  \nWhen importing text data for points, it is important to indicate to GMS to which point the \ndate and time data belongs. This can be done using a name, an id, or an xy coordinate. \nIn the case above, a name is being used. The first time an entry is found for a particular \nwell, if the well is steady state, it is changed to transient, and a pumping rate time series \nis created for the well. Each time a subsequent line is read with the same well name, \nGMS adds a point to the time series. The dates and times can be  in any standard format.  \nDo the following to import the well pumping data file:  \n1. Select the \u201c  Sources&Sinks \u201d coverage to make it active.  \n2. Click Open   to bring up the Open  dialog.  \n3. Select \u201c Text Files (*.txt ;*.csv )\u201d from the Files of type  drop-down.  \n4. Select \u201c pumping.csv \u201d and click Open  to exit the Open  dialog and bring up Step 1 \nof 2 of the Text Import Wizard  dialog.  \n5. As there is not a heading row in this file, click Next  > to go to Step 2 of 2  of the \nText Import Wizard  dialog.  \n6. Select \u201c Pumping data \u201d from the GMS data type  drop-down.  \n\nGMS Tutorials   MODFLOW \u2013 Transient Calibration  \n \n Page 6 of 14 \u00a9 Aquaveo 2024  7. In the File preview  section on the Type  row, select \u201c Name \u201d from the drop -down in \nthe first (left -hand) column.  \n8. Select \u201c Date \u201d from the drop -down in the second (middle) column.  \n9. Select \u201cFlow  rate TS \u201d from the drop -down in the third (rig ht-hand) column.  \nThe dialog should appear similar to Figure 6. \n \n      Figure 6      Second step of the Text Import Wizard dialog for the pumping data  \n10. Click Finish  to close Step 2 of 2  of the Text Import Wizard  dialog.  \n11. Click Yes at the prompt to import the pumping data as a step function.  \n12. Using the Select Points \\Nodes   tool, double -click on the well on the east \n(right) side of the model to open the Attribute Table dialog.  \n13. Notice that the Flow rate  says \u201c <transient> \u201d. To see the curve, click on the   \nbutton to bring up the XY Series Editor  dialog.  \n14. Click Cancel  to close the XY Series  Editor dialog.   \n15. Click Cancel  to exit the Attribute Table  dialog.  \n4.3 Assigning Storage Parameters  \nNext, assign the storage coefficient to the aquifer. Since this is a two -layer model with an \nupper unconfined aquifer and a lower confined aquifer, specific yie ld and specific storage \nmust be assigned.  \n1. Double -click on the \u201c  Layer 1\u201d  coverage in the Project Explorer  to bring up the \nCoverage Setup  dialog.  \n2. In the Areal Properties  column, turn on Specific yield . \n3. Click OK to exit the Coverage Setup  dialog.  \n4. Using the Select Polygon s  tool, double -click on the polygon to open the \nAttribute Table dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Transient Calibration  \n \n Page 7 of 14 \u00a9 Aquaveo 2024  5. Enter \u201c0.01\u201d in the Spec. yield  column of the spreadsheet.  \n6. Click OK to exit the Attribute Table  dialog.  \n7. Double -click on the \u201c  Layer 2 \u201d coverage in the Project Explor er to bring up the \nCoverage Setup  dialog.  \n8. In the Areal Properties  column, turn on Specific storage . \n9. Click OK to exit the Coverage Setup  dialog.  \n10. Using the Select Polygon s  tool, double -click on the polygon to open the \nAttribute Table dialog.  \n11. Enter \u201c0.0001 \u201d in the Spec. storage (1/m)  column of the spreadsheet.  \n12. Click OK to exit the Attribute Table  dialog.  \n5 Initializing MODFLOW Stress Periods  \nMODFLOW discretizes time using stress periods and time steps. A length of time is \nassociated with each stress period, and boundary conditions (or stresses) can change at \nthe beginning of a stress period. Stress periods are subdivided into time steps. Before \nconverting the conceptual model, set up the stress periods.  \n5.1 Changing the MODFLOW Simulation to Transient  \nStart with changing the current MODFLOW simulation from a steady state simulation to \ntransient.  \n1. In the Project Explorer , expand \u201c  3D Grid Data\u201d folder until the contents of the \n\u201c MODFLOW \u201d item are visible.  \n2. Right -click on the  \u201c Global \u201d package and select Properties \u2026 to open the \nMODFLOW Global/Basic Package dialog.  \n3. In the Model type  section, select \u201c Transient \u201d. \n5.2 Setting Up the Stress Periods  \nNow to set up the stress period information for MODFLOW:  \n1. Click Stress Periods \u2026 to open the Stress Periods dialog.  \n2. Enter \u201c37\u201d as the Number of stress periods . \nIt is necessary for the stress periods to match the times where the input data in the map \nmodule changes. For example, the value for recharge changes monthly. Therefore, make \nsure that the stress periods start at those times a nd at the time corresponding to changes \nin the pumping schedules.  \n3. Turn on Use dates/times . \nWhen the Use dates/times  option is used, all input fields in the MODFLOW interface in \nthe 3D Grid  module expect the date/time format for input. The date/time format is used to \ndisplay time values such as the time step values when post -processing. If this option is \nnot used, scalar time values (e.g., 100, 120, etc.) are displayed.  \n4. Using any text editor application, open the \u201cstress_periods.txt\u201d file found in the \nTutorials \\MODFLOW \\trans_calib \\ directory . \n\nGMS Tutorials   MODFLOW \u2013 Transient Calibration  \n \n Page 8 of 14 \u00a9 Aquaveo 2024  5. Press Ctrl-A to select all of the text in the file and Ctrl-C to copy the text to the \nclipboard.  \n6. Return to GMS and click in the Start  column of row 1 in the Stress Periods  \ndialog.  \n7. Press Ctrl-V to paste the dates i nto the spreadsheet from the clipboard.  \nThis should give monthly stress periods from Oct 1, 1992 through Oct 1, 1995. The dialog \nshould look similar to Figure 7. \n8. The first stress period (row 1) should have a Length  of \u201c0.0\u201d and the box in the \nSteady state  column should be checked (if not, change them).  \n \n      Figure 7      Stress Periods dialog  \nAt this point, the number of tim e steps and the multiplier for each stress period can be \nadjusted. For this example, the default values will be used.  \n9. Click OK to exit the Stress Periods  dialog.  \n10. If a warning appears indicating the first stress period is zero or negative, click OK \nto conti nue. \n11. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n6 Converting the Conceptual Model  \nNow convert the conceptual model data to MODFLOW input data.  \n1. Right -click on the \u201c  East Texas \u201d conceptual model and select Map to | \nMODFLOW/MODPATH  to bring up the Map \u2192 Model  dialog.  \n2. Select All applicable coverages  and click OK to close the Map \u2192 Model  dialog.  \n3. If necessary, select OK to acknowledge that the xy series will be extrapolated to \nthe numerical model.  \n\nGMS Tutorials   MODFLOW \u2013 Transient Calibration  \n \n Page 9 of 14 \u00a9 Aquaveo 2024  7 Saving and Running MODFLOW  \nNow save th e model and launch MODFLOW.  \n1. Save   the project.  \n2. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n3. Once MODFLOW has finished, turn on Read solution on exit  and Turn on \ncontours (if not on already) . \n4. Click Close  to close the MODFLOW  model wrap per dialog and import the new \nsolution.  \nThe contours should change ( Figure 8). \n5. Expand the \u201c  trans1 (MODFLOW) \u201d solution in the Project Explorer  and se lect \nthe \u201c  Head \u201d dataset.  \n6. Use the Time Steps  window below the Project Explorer to cycle through a few of \nthe different time steps of the solution to see how the pumping schedules of the \nwells affect the computed heads.  \n \n      Figure 8      Changed contours after MODFLOW run  \n8 Creating Observation Wells  \nNow to use a shape file to define the locations of the observation wells, and then import \nthe time series data of the transient observed heads.  \n1. Right -click on the \u201c East Texas \u201d conceptual model and select New \nCoverage \u2026 to open the Coverage Setup dialog.  \n2. Enter \u201c Obs\u201d as the Coverage name .  \n3. In the Observation Points  column, turn on the Trans. Head . \n4. Near the bottom of the dialog, select \u201cBy layer number\u201d from the 3D gr id layer \noption for obs. pts . drop-down.  \n5. Click OK to exit the Coverage Setup  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Transient Calibration  \n \n Page 10 of 14 \u00a9 Aquaveo 2024  6. Click Open   to bring up the Open  dialog.  \n7. Select \u201cShapefiles (*.shp)\u201d from the Files of type  drop-down.  \n8. Browse to the trans_calib \\trans_calib  directory and select \u201c wells_pts.shp \u201d. \n9. Click Open  to import the shapefile and exit the Open  dialog . \nThe shapefile will appear under \u201cGIS Layers\u201d in the Project Explorer.  \n10. Right -click on \u201c  wells_pts.shp \u201d and select Convert to | Feature Objects  to \nbring up the Step 1 of 3 page of the GIS to Feature Objects  Wizard  dialog.  \n11. Select \u201cObs\u201d from the Select a coverage for mapping  drop-down menu and select \nthe \u201cwells_pts.shp\u201d in the Map Shapefile ? section.  \n12. Click Next  > to go to the Step 2 of 3 page of the GIS to Feature Objects  Wizard  \ndialog.  \n13. In the Mapping  preview  section on the Mapping  row, select \u201cName\u201d from the \ndrop-down in the NAME  column ( Figure 9). \n \n      Figure 9      Mapping the Name  \n14. Click  Next  > to go to the Step 3 of 3  page of the GIS to Feature Objects Wizard  \ndialog.  \n15. Click  Finish  to close the GIS to Feature Objects Wizard  dialog.  \n16. Right -click on the \u201c  Obs\u201d coverage and select Attribute Table \u2026 to open the \nAttribute Table  dialog.  \n17. If necessary, change the Feature type  to \u201cPoints\u201d.  \n18. On the All row of the spreadsheet, select \u201cobs. pt\u201d from the Type  drop-down.  \n19. Click OK to exit the Attribute Table  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Transient Calibration  \n \n Page 11 of 14 \u00a9 Aquaveo 2024  9 Importing Transient Head Observations  \nPoints in the \u201c  Obs\u201d coverage have now been created from the points in the shape file. \nNow import the transient head data.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cText Files (*.txt;*.csv)\u201d from the Files of type  drop-down.  \n3. Browse to the trans_calib \\trans_calib  directory and select \u201c well_head.txt \u201d. \n4. Click Open  to exit the Open  dialog and bring up the Step 1 of 2  page of the Text \nImport Wizard  dialog . \n5. In the section below the File import options  section, turn on Heading row . \n6. Click Next  > to go to the Step 2 of 2  page of the Text Import Wizard  dialog.  \n7. Select \u201cTransient observation data\u201d from the GMS data type  drop-down.  \nNotice how GMS has automatically mapped the Type  row in the File preview  section \nbased on the names of the columns in the header.  \n8. Click Finish  to exit the Text Import Wizard  dialog.  \n9. Using the Select Points \\Nodes   tool, double -click on the west (left) \nobservation well to bring up the Attribute Table  dialog.  \n10. In the Obs. Trans. Head  column in the spreadsheet, click on the  button to \nbring up the  XY Series Editor  dialog.  \n11. When done reviewing the time series, click on OK to close the XY Series Editor  \ndialog.  \n12. Click OK to close the Attribute Table  dialog.  \n13. Repeat steps 9 \u201312 for each of the other two observation wells, if desired.  \n10 Saving and Running MOD FLOW  \nIt is now possible to save the model and launch MODFLOW.  \n1. Save   the project.  \n2. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n3. Once MODFLOW has finished, turn on Read solution on exit  and Turn on \ncontours (if not on already) . \n4. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.  \n5. Right -click on the \u201c  trans1 (MODFLOW) \u201d solution folder and select \nProperties \u2026 to bring up the Properties  dialog.  \nThe Properties  dialog shows the model error. Notice there is only an error associated \nwith heads. Currently, the model only has head observations and lacks any flow \nobservations.  \n6. Click OK to exit the Properties  dialog.  \n7. Expand the \u201c  trans1 (MODFLOW) \u201d folder  in the Project Explorer  and select the \n\u201c Head \u201d dataset.  \n\nGMS Tutorials   MODFLOW \u2013 Transient Calibration  \n \n Page 12 of 14 \u00a9 Aquaveo 2024  8. Use the Time Steps  window to cycle through the different time steps of the \nsolution.  \nNotice that targets on the observations change as the time steps change. If the current \ntime step of the MODFLOW heads is before or after the time series data for a particular \nwell, then the target for that well will appear washed out (or faded) as in Figure 10. \n \n      Figure 10      Well targets showing as washed out  \n11 Creating a Time Series Plot  \nGMS can create a time series plot useful for transient observation data.  \n1. Click Plot Wizard   to bring up the Step 1 of 2  page of the Plot Wizard  dialog.  \n2. In the Plot Type  section, select \u201c Time Series \u201d from the list on the left.  \n3. Click Next  > to go to the Step 2 of 2  page of the Plot Wizard  dialog.  \n4. In the lower section, turn on Calibration Target  and Observed Values . \n5. In the spreadsheet on row 1 (the row with \u201c MW45 \u201d in the Points  column), check \nthe box in the Show  column.  \n6. Click Finish to create the plot.  \nA plot similar to Figure 11 should appear.  \n\nGMS Tutorials   MODFLOW \u2013 Transient Calibration  \n \n Page 13 of 14 \u00a9 Aquaveo 2024   \n      Figure 11      A plot of the time series  \nNotice that the computed heads are sometimes within the min/max of the calibration \ntarget (green targets) and at other times the computed heads are just outside of the \ncalibration target well (yellow targets). Time series plots for the other two wells can also \nbe made at this poin t, if desired, by repeating steps 1 \u20136 and checking the box next to \n\u201cUS448769\u201d or \u201cSW387921\u201d in step 5 instead the one next to \u201cMW45\u201d.  \n11.1 Creating Transient Observation Plots in Excel  \nThe transient observation plots in GMS are useful for quickly understanding the \nrelationship between the observed data and the computed values from MODFLOW. \nHowever, when preparing reports of modeling projects, it is useful to use a spreadsheet \napplication (such as Microsoft Excel) to create plots. The transient observation data c an \nbe exported from GMS to a text file. This text file can then be opened in the spreadsheet \napplication and used to generate plots for a report.  \nIf the spreadsheet application is installed with the ability to run macros, continue with the \nsteps below. Ot herwise, skip to the next section.  \n1. Select MODFLOW | Observations \u2026 to bring up the Observations  dialog.  \n2. Click Export Trans. Obs...  to bring up the Transient Observation Filename  \ndialog.  \n3. Accept the default File name of \u201cTransObservation.csv \u201d and click Save  to close \nthe Transient Observation Filename  dialog.  \n4. Click OK to close the Observations  dialog.  \n5. In Windows Explorer, browse to the trans_calib \\trans_calib  directory and double -\nclick on \u201c modflow trans obs plotter.xls \u201d to open it into the default spreadsheet \napplication.  \n6. In the spreadsheet application, enter \u201c TransObservation.csv \u201d in the File name  \nfield and click Import File . \n7. Click Yes at the prompt to delete existing sheets.  \nA macro should run to create a new sheet for each observation point along with a plot.  \nThese sheets are a copy of the \u201ctemplate \u201d base  sheet with the data for each observation \n\nGMS Tutorials   MODFLOW \u2013 Transient Calibration  \n \n Page 14 of 14 \u00a9 Aquaveo 2024  point added to the sheet. The base sheet can be modified with the desired plotting \noptions, and the macro can be run again to create plots with the desired customizations.  \nFeel free to try adjusting the hydraulic conductivity and the storage parameters to see if \nthis results in a better fit with the observation data.  \n12 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 Transient Calibration\u201d tutorial. The following key \nconcepts were discussed and demonstrated in this tutorial:  \n\uf0b7 When bringing up the properties dialog for objects in the Map module, it is \npossible to enter transient data by using the  and  button s. \n\uf0b7 It is possible to import transient data for points, arcs, polygons, and nodes using \nthe Text Import Wizard  dialog. The points, arcs, polygons, and nodes must \nalready exist in the active coverage.  \n\uf0b7 It is possible to use a shapefile to define the location of observation wells.  \n\uf0b7 It is possible to import transient head observations.  \n\uf0b7 It is possible to create time series plots with calibration targets to show how well \na model fits the observed data.  \n \n\n", "filename": "MODFLOW-TransientCalibration.pdf", "pages": 14}, "MODFLOW-TransientCalibrationPumpTest": {"text": "GMS Tutorials   MODFLOW \u2013 PEST Transient Pump Test Calibration  \n Page 1 of 15 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 PEST Transient Pump Test Calibration  \nTools for c alibrati ng transient MODFLOW models  \n \nObjectives   \nLearn how to setup a transient simulation, import transient observation data, and use PEST to calibrate \nthe model . \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 PEST Pilot \nPoints  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 30\u201345 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 PEST Transient Pump Test Calibration  \n Page 2 of 15 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  3 \n2 Importing the Project  ................................ ................................ ................................ ...........  3 \n2.1 Save the Project with a New Name  ................................ ................................ ..............  4 \n3 Setting up the Transient MODFLOW Model  ................................ ................................ ...... 4 \n3.1 Entering MODFLOW Stress Period Data  ................................ ................................ ...... 5 \n3.2 Regarding Initial Conditions  ................................ ................................ ..........................  5 \n4 Entering Pumping Data  ................................ ................................ ................................ ....... 6 \n5 Importing Transient Observation Data  ................................ ................................ ..............  6 \n5.1 Adjusting the Coverage Set Up ................................ ................................ .....................  7 \n5.2 Importing Transient Data Text File  ................................ ................................ ................  7 \n6 Saving and Running MODFLOW  ................................ ................................ ........................  9 \n7 Creating a Time Series Plot  ................................ ................................ ................................  9 \n8 Running PEST  ................................ ................................ ................................ ....................  10 \n9 Pilot Points  ................................ ................................ ................................ .........................  12 \n9.1 Using Pilot Points with the Parameters  ................................ ................................ ....... 12 \n10 Running PEST with SVD -Assist  ................................ ................................ .......................  13 \n11 Conclusion  ................................ ................................ ................................ .........................  15 \n \n1 Introduction  \nPump test data is a common type of transient data available to groundwater model \ndevelopers. This tutorial will take an existing steady state MODFLOW model and update \nthe model to simulate a pump test.  \nThe model in this tutorial is the same model used in the \u201c MODFLOW \u2013 Generating Data \nfrom Solids \u201d tutorial. The study area is shown in plan view in Figure 1. In the previous \ntutorial, the production well near the center of the study area was pumping during the \npump test. The other two production wells were not pumping during the test. A few  head \nmeasurements were taken at these wells during the test. One monitoring well was \nsampled frequently during the pump test. Other monitoring wells underwent less frequent \nmeasurements.  \nProduction Wells\nSpecified Head\nBoundaryNo Flow\nBoundary\n \n      Figure 1      Study area for ground water model  \nThere are two main aquifers in the area, as shown in the cross section in Figure 2. The \nlower -confined aquifer (red) is overla in by an upper unconfined aquifer (green). The lower \naquifer is where the pumping well and main observation well are located. In some areas, \nthere is an aquitard (yellow) that overlays portions of the lower aquifer.  \nGMS Tutorials   MODFLOW \u2013 PEST Transient  Pump Test  Calibration  \n \n Page 3 of 15 \u00a9 Aquaveo 2024   \n      Figure 2      Cross section through the study area  \nTransient observation data at multiple observation wells will be imported. The model has \nalready been parameterized into different zones of hydraulic conductivity (HK), specific \nyield (SY), and specific storage (SS) for the upper and lower aquifers; there is also a \nparameter for estimating recharge. The model will be run with the current parameter \nvalues to see how well the model matches the pump test. Then PEST will optimize the \nparameter values. Finally, pilot points will be plotted with the parameters to see if it is \npossible to improve the match between the simulated and field -observed values.  \nThis tutorial will demonstrate and discuss:  \n\uf0b7 Opening a MODFLOW model and solution.  \n\uf0b7 Setting up MODFLOW stress periods.   \n\uf0b7 Importing transient observation data and creating plots.  \n\uf0b7 Running PEST to calibrate the transient model.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.   \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2 Importing the Project  \nFirst, import the project:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the Tutorials \\MODFLOW \\trans_pest_pumptest  directory and select \n\u201cstart.gpr\u201d.  \n4. Click Open  to import the project and exit the Open  dialog . \nA MODFLOW model with a solution and a set of map coverages will appear ( Figure 3). \n\nGMS Tutorials   MODFLOW \u2013 Transient Calibration  \n \n Page 4 of 15 \u00a9 Aquaveo 2024   \n      Figure 3      Steady state MODFLOW model  \n2.1 Save the Project with a New Name  \nBefore continuing, save the project with a new name.  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr )\u201d from the Save as type drop-down.  \n3. Enter \u201c pumptest.gpr \u201d as the File name . \n4. Click Save  to save the file under the new name and close the Save As  dialog . \nIt is recommended to save the project periodically.  \n3 Setting up the Transient MODFLOW Model  \nThe pump test  occurred over a two -week period. Data was collected at the main \nobservation well during the first three days while the well was pumping, and then more \nsporadically over the next ten days while the well was off. Set up the transient \nMODFLOW model to have a t least two stress periods: one stress period with the well on \nfor 3 days and one stress period with the well off for 10 days.  \n1. Select MODFLOW | Global Options \u2026 to open the MODFLOW Global/Basic \nPackage dialog.  \n2. In the Model type  section, select Transient . \n3. Click on Stress Periods \u2026 to bring up the Stress Periods  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 PEST Transient  Pump Test  Calibration  \n \n Page 5 of 15 \u00a9 Aquaveo 2024  3.1 Entering MODFLOW Stress Period Data  \nIn the Stress Periods  dialog, it is possible to set the number of stress periods, how long \neach period will be, and the number of time steps in each period.  \n1. Increase the Number of stress periods  to \u201c3\u201d.  \n2. In the spreadsheet, enter \u201c0.0\u201d in the Start  column on row 2 (this is the second \nstress period). The Length  of the first stress period will be updated automatically \nto \u201c0.0\u201d. \n3. Enter \u201c 3.0\u201d in the Start  column of r ow 3. The Length  of the second stress period \nwill be updated automatically to \u201c 3.0\u201d. \n4. Enter \u201c13.0\u201d in the Start  column of the End row. The Length  of the third stress \nperiod will be updated automatically to \u201c 10.0\u201d. \n5. Enter \u201c 10\u201d in the Num. Time Steps  column for rows 2 and 3. \n6. Enter \u201c1.5\u201d in the Multiplier  column for rows 2 and 3.  \nThis increases the number of time steps at the beginning of the stress period so that the \neffect of the change in stresses can be seen more accurately. When finished, the dia log \nshould appear similar to Figure 4.  \n7. Click OK to exit the Stress Periods  dialog.  \n8. Click OK at the prompt. The first stress period has a length of zer o because it is \na steady state stress period.  \n9. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n \n      Figure 4      Stress Periods dialog  \n3.2 Regarding Initial Conditions  \nWith a transient model, it is important to have an initial condition that is consistent with \nthe model inputs. If the initial condition is not consistent with model parameters, then the \nmodel response in the early time steps will reflect not only the model  stresses but also \n\nGMS Tutorials   MODFLOW \u2013 Transient Calibration  \n \n Page 6 of 15 \u00a9 Aquaveo 2024  the adjustment of computed head values to offset the lack of correspondence between \nthe model inputs and the initial head values.1  \nIn this case, the first stress period has been set to be steady state. This will prevent any \nlack of corr espondence between model inputs and the initial heads for the transient \nstress periods. This is important when calibrating a transient model. When allowing a tool \nlike PEST to change the model inputs, it is necessary to make sure that the initial heads \ncorrespond to the new inputs that PEST has chosen. The easiest way to do this is to \nhave the first stress period of the model be steady state.  \n4 Entering Pumping Data  \nIt is necessary to update the well data so that the well will have the appropriate pumping \nrate for the first stress period and 0.0 for the second stress period. Edit the well data in \nthe WEL Package.  \n1. Select MODFLOW  | Optional Packages  | WEL \u2013 Well\u2026 to open the MODFLOW \nWell Package  dialog.  \nThis dialog contains a spreadsheet listing all of the pumping wells in the model. Currently, \nall of the wells have a flow rate of \u201c0.0\u201d.  \n2. Enter \u201c2\u201d in the Stress period  field.  \n3. Uncheck Use previous  to the right of Stress period . \n4. For the well named \u201cw -15\u201d (r ow 2 of the spreadsheet), e nter \u201c -130000.0 \u201d in the Q \n(flow)(ft^3/d)  column.  \n5. Enter \u201c3\u201d in the Stress period  field.  \n6. Uncheck Use previous . \n7. For the well named \u201cw -15\u201d, e nter \u201d0.0\u201d in the Q (flow) (ft^3/d)  column.  \n8. Select OK to exit the MODFLOW Well Package  dialog .  \n5 Importing Transient Observation Data  \nThe transient field -measured head values should now be imported. This type of data can \nbe imported using the Text Import Wizard  dialog. The Text Import Wizard  dialog can \nimport transient data in multiple formats, inc luding date/time and relative time. In this \nexample problem, relative time is being used, where the beginning of the simulation is \ntime \u201c0.0\u201d and the units are days. The format for this kind of data is shown in Figure 5. \n \n      Figure 5      Transient observation data file using relative time  \n                                                      \n1 Anderson, Mary P. and Woessner, William W. (1991). Applied Ground Water Modeling. Academic \nPress, Waltham, Massachusetts , p.199.  \n\nGMS Tutorials   MODFLOW \u2013 PEST Transient  Pump Test  Calibration  \n \n Page 7 of 15 \u00a9 Aquaveo 2024  5.1 Adjusting the Coverage Set Up  \nBefore importing the transient observation data, make sure that the coverage with the \nobservation points is set up correctly.  \n1. Fully expand the \u201c  Map Data \u201d folder in the Project Explorer.  \n2. Double -click on the \u201c Obs\u201d coverage  under the \u201c  MODFLOW \u201d conceptual \nmodel to bring up the Coverage Setup  dialog . \n3. In the Observation Po ints column, turn on Trans. Head.  \n4. Click OK to exit the Coverage Setup  dialog.  \n5.2 Importing Transient Data Text File  \nIt is now possible to import the transient observation data.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cText Files (*.txt;*.csv)\u201d from t he Files of type  drop-down.  \n3. Select \u201c obs_wells_trans.csv \u201d and click Open  to exit the Open  dialog and bring up \nthe Step 1 of 2  page of the Text Import Wizard dialog ( Figure 6). \nThis wizard is used to import text data into a GMS project.  \n \n      Figure 6      Text Import Wizard with Heading row checked  \n4. In the section below the File import options  section, turn on Heading row . \n5. Click Next  to go to the Step 2 of 2  page of the Text Import Wizard  dialog.  \n6. Select \u201cTransient observation data\u201d from the GMS data type  drop-down.  \nThe dialog should appear similar to Figure 7. \n\nGMS Tutorials   MODFLOW \u2013 Transient Calibration  \n \n Page 8 of 15 \u00a9 Aquaveo 2024   \n      Figure 7      Step 2 of the Text Import Wizard  \nNotice that the Name , Time , and Head  columns were automatically recognized by GMS. \nThere are two time columns, one in units of days and one in units o f minutes. This \nexample will only use the data in the Time (days)  column. The Time (min)  column will be \nignored for this example, and is therefore not mapped in the Type  row. The dialog is \nalready set up in the desired way.  \n7. Click Finish  to close the Text I mport Wizard  dialog.  \n8. Using the Select Objects   tool, double -click on the \u201cmw \u2013 3\u201d well near the \ncenter of the model to bring up the Attribute Table  dialog.  \n9. View the imported time series data clicking the  button in the Obs. Trans \nHead  column to bring up the XY Series Editor  dialog ( Figure 8).  \n10. When done reviewing the data, click Cancel  to exit the XY Series Editor  dialog.  \n11. Click Canc el to exit the Attribute Table  dialog.  \n \n      Figure 8      Time series data for well \u201cmw - 3\u201d \n\nGMS Tutorials   MODFLOW \u2013 PEST Transient  Pump Test  Calibration  \n \n Page 9 of 15 \u00a9 Aquaveo 2024  6 Saving and Running MODFLOW  \nTo save the model and launch MODFLOW:  \n1. Save   the project.  \n2. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n3. Once MODFLOW has finished, turn on Read solution on exit  and Turn on \ncontours (if not on already).  \n4. Click Close  to close the MODFLOW  model wrapper dialog.  \nThe contours should change ( Figure 9). The current view shows the top layer of the grid. \nThe pumping well and some of the observation wells are in layer 5.  \n5. Use the Mini Grid Toolbar  to change to layer \u201c5\u201d. \n6. Expand the \u201c 3D Grid  Data\u201d folder in the Project Explorer so the \u201c  pumptest \n(MODFLOW) \u201d solution is visible and expanded.  \n7. Select the \u201c  Head \u201d dataset to make it active.  \n8. Use the Time Step  window below the Project Explorer to cycle through the \ndifferent time steps of the soluti on to see the effect of the pump test.  \n \n      Figure 9      The contours changed slightly after running MODFLOW  \n7 Creating a Time Series Plot  \nOne of the useful tools for working with transient calibration data is the time series plo t. \nThis plot allows seeing how well the simulated heads match the field measurements.  \n1. Click Plot Wizard   to bring up the Step 1 of 2  page of the Plot Wizard  dialog.  \n2. In the Plot Type  section, select \u201cTime Series\u201d from the list on the left.  \n3. Click Next  to go  to the Step 2 of 2  page of the Plot Wizard  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Transient Calibration  \n \n Page 10 of 15 \u00a9 Aquaveo 2024  4. In the bottom section, turn on Calibration Target  and Observed Values . \n5. Below those options, check the box in the Show  column on the \u201cmw - 3\u201d row.  \n6. Click Finish  to close the Plot Wizard  dialog and generate the plot.  \nA plot similar to Figure 10 will appear.  The model simulated heads are currently a little \nlow at this particular well. Use PEST to help  calibrate the transient model.  \n \n      Figure 10      Time series plot  \nTo view other observation wells in the model, do the following:  \n7. Right -click on the plot and select Plot Data\u2026  to bring up the Data Options  \ndialog.  \n8. In the bott om section on the Plot Wizard - Step 2 of 2  tab, uncheck the Show  box \nnext to \u201cmw - 3\u201d and check the Show  box next to the desired point (well).  \n9. Click OK to close the Data Options  dialog.  \n10. Repeat steps 7 \u20139 to view a plot for any of the other wells.  \n11. When done  reviewing the other wells, change the plot back to displaying the data \nfor the \u201cmw - 3\" well.  \nThe plot will change according to which point is selected in the Data Options  dialog.  \n8 Running PEST  \nChange the MODFLOW simulation so that PEST is used to estimate  the values of HK \n(hydraulic conductivity), SY (specific yield), and SS (specific storage) of the upper and \nlower aquifer. Allow PEST to estimate the value of recharge (RCH).  \n1. Select MODFLOW | Global Options \u2026 to open the MODFLOW Global/Basic \nPackage dialog.  \n2. In the Run options  section, select Parameter Estimation . \n3. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \nAt this point, the model would normally be parameterized. Model parameterization is \nexplained in the \u201c MODFLOW \u2013 Automated Parameter Estimation \u201d tutorial. This model \nhas already been parameterized, so it is now possible to run PEST. This model uses \n\nGMS Tutorials   MODFLOW \u2013 PEST Transient  Pump Test  Calibration  \n \n Page 11 of 15 \u00a9 Aquaveo 2024  material zones to assign properties to the aquifers. The HK, SY, and SS parameter key \nvalues have been entered in the Material s dialog.  \n4. If desired,  view the material properties  by selecting  Edit | Material s\u2026 to bring up \nthe Materials dialog.  \n5. Click Cancel  when done to close the dialog .  \nWhile t his next step can be completed without Parallel PEST , it will take significantl y \nlonger to complete.  \n6. Select MODFLOW | Parameter Estimation \u2026 to open the PEST dialog.  \n7. In the Parellel PEST  section, turn on Use Parallel PEST . \n8. In the SVD options  section, turn on Use SVD  options.  \n9. Click OK to exit the PEST  dialog.  \nIt is now possible to run Parallel PEST.  \n10. Select File | Save As \u2026 to bring up the Save As  dialog.  \n11. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n12. Enter \u201c pumptest_pest.gpr \u201d as the File name . \n13. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n14. Click Run MODFLOW   to bring up the MODFLOW model wrapper dialog.  \nDepending on the speed of the computer being used, Parallel PEST will take several \nminutes to run this problem. When the run finishes, notice that PEST completed 2 \niterations and ha d a final model error of about 697. \n15. When MODFLOW is finished, turn on Read solution on exit  and Turn on contours \n(if not on already) . \n16. Click Close  to exit the MODFLOW  model wrapper dialog.  \nThe contours and time series plot should update ( Figure 11). Notice the minor \nimprovement in the match by using the field -observed values.  \nIt is desirable to improve the fit between the simulated and the observed heads. This can \nbe do ne by adjusting some of the PEST input parameters to allow PEST to run more with \nthis model, or by using pilot points with the parameters. In this tutorial, pilot points will be \nused to try to get a better fit at all of the wells.  \n\nGMS Tutorials   MODFLOW \u2013 Transient Calibration  \n \n Page 12 of 15 \u00a9 Aquaveo 2024   \n      Figure 11      Time series plot after PEST run  \n9 Pilot Points  \nNow import pilot point data. For more information on pilot points, refer to the \u201c MODFLOW \n\u2013 Pest Pilot Points \u201d tutorial.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cText Files (*.txt;*.csv)\u201d from the Files of type  drop-down.  \n3. Select \u201c pp.txt \u201d and click Open  to exit the Open  dialog and bring up the Step 1 of \n2 page of the Text Import Wizard  dialog.  \n4. In the section below the File import options  section, turn on Heading row . \n5. Click Next  to go to the Step 2 of 2  page of the Text Import Wizard  dialog.  \n6. Change the GMS data type  drop-down menu to be \u201c2D scatter points\u201d.  \n7. Click Finish  to import the pilot point data and close the Text Import Wizard  \ndialog.  \n9.1 Using Pilot Points with the Parameters  \nIt is necessary to change the MODFLOW parameters to use the imported pilot points.  \n1. Select MODFLOW | Parameters \u2026 to bring up the Parameters  dialog.  \n2. In the spreadsheet in the Parameters section, click on the drop -down  button \nin the Value  column on the \u201cHK_15\u201d row and select \u201c <Pilot points> \u201d. \nThe interpolation options associated with the pilot points can be changed by clicking on \nthe  button above the drop -down  button in the Value  column.  \n3. Click on the  button in the Value  column on the \u201c HK_15 \u201d row to bring up the \n2D Interpolation Options dialog.  \n\nGMS Tutorials   MODFLOW \u2013 PEST Transient  Pump Test  Calibration  \n \n Page 13 of 15 \u00a9 Aquaveo 2024  In this dialog, select the scatter point set and dataset used with the parameter as well as \nthe interpolation scheme.  \n4. In the Interpolating from  section, select \u201cHK_15\u201d from the Dataset drop-down.  \n5. Click OK to exit the 2D Interpolation Options  dialog.  \n6. Repeat steps 2 \u20135 for the \u201cHK_30\u201d and \u201cRCH_300\u201d rows, selecting \u201c HK_30 \u201d and \n\u201cRCH_300 \u201d (respectively)  in step 4.  \n7. When finished, select OK to exit the Parameters  dialog.  \n10 Running PEST with S VD-Assist  \nNow run Parallel PEST again. However, this time use the SVD -Assist option. Currently, \nthere are 24 pilot points for each parameter. This means that for each PEST iteration, \nPEST will run MODFLOW once for each existing pilot point. For this model,  that would be \na total of 72 MODFLOW runs in addition to runs for the other 3 parameters. Using SVD -\nAssist, PEST can decrease the number of necessary MODFLOW runs for each PEST \niteration.  \n1. Select MODFLOW | Parameter Estimation \u2026 to open the PEST dialog.  \n2. In the SVD options  section, turn on Use SVD -Assist . \n3. Click OK to exit the PEST  dialog.  \n4. Select File | Save As \u2026 to bring up the Save As  dialog.  \n5. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n6. Enter \u201c pumptest_pest_pp.gpr \u201d as the File name . \n7. Click Save  to save the project under the new name and close the Save As  \ndialog . \n8. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \nDepending on the speed of the computer being used, Parallel PEST may take several \nminutes to run this problem. When finished, PEST will have completed five iterations and \nwill have a final model error of about 19.6. \n9. When PEST finishes, turn on Read solution on exit  and Turn on contours (if not \non already) . \n10. Click Close  to import the solution and close the MODFLOW  model w rapper \ndialog.  \nThe contours and time series plot should update, and the time series curve for the \nobservation well should appear similar to Figure 12. The match betwee n the field values \nand the model simulated values have significantly improved.  \n\nGMS Tutorials   MODFLOW \u2013 Transient Calibration  \n \n Page 14 of 15 \u00a9 Aquaveo 2024   \n      Figure 12      Time series Plot after PEST Calibration  \nTo see the final hydraulic conductivity and recharge arrays:  \n11. Fully expand the \u201c  pumptest_pest_pp (MODFLOW) \u201d solution in the Project \nExplorer .  \n12. Select \u201c  HK Parameter -30, -15\u201d.  \nThis dataset displays the final hydraulic conductivity array computed from the pilot points. \nThe recharge is also available. The model should appear similar t o Figure 13. \n \n      Figure 13      Final appearance of the model  \n\nGMS Tutorials   MODFLOW \u2013 PEST Transient  Pump Test  Calibration  \n \n Page 15 of 15 \u00a9 Aquaveo 2024  11 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 PEST Transient Pump Test Calibratio n\u201d tutorial.  The \nfollowing key concepts were discussed and demonstrated:  \n\uf0b7 Importing transient observation data with the Text Import Wizard . \n\uf0b7 Using PEST to calibrate transient MODFLOW models.  \n\uf0b7 It is important to have the first stress period as steady state wh en calibrating a \ntransient model so that the computed heads for the first transient stress period \nare consistent with the model input parameters.  \n\uf0b7 Viewing the final array values from parameters that use pilot points by selecting \nthe dataset under the MODFLO W solution.  \n \n", "filename": "MODFLOW-TransientCalibrationPumpTest.pdf", "pages": 15}, "MODFLOW-UnsupportedPackage": {"text": "GMS Tutorials   MODFLOW \u2013 Unsupported Packages  \n Page 1 of 19 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Unsupported Packages  \nRunning and editing unsupported packages in GMS  \n \nObjectives   \nThis tutorial explains how to import and use unsupported MODFLOW packages in GMS . \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Grid \nApproach  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 30\u201345 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW \u2013 Unsupported Packages  \n Page 2 of 19 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Unsupported Package and Supported Executable  ................................ ...........................  2 \n2.1 Description of Problem  ................................ ................................ ................................ . 2 \n2.2 Getting Started  ................................ ................................ ................................ ..............  4 \n2.3 Import ing the MODFLOW Model  ................................ ................................ ..................  4 \n2.4 Viewing the Unsupported Packages  ................................ ................................ .............  5 \n2.5 Saving and Running MODFLOW  ................................ ................................ ..................  6 \n2.6 Examining the Solution  ................................ ................................ ................................ . 7 \n3 Unsupported Package and GMS Compatible Executable  ................................ ................  8 \n3.1 Importing the Project  ................................ ................................ ................................ ..... 9 \n3.2 Importing the MODFLOW Model  ................................ ................................ ................  10 \n3.3 Viewing the Unsupported Packages  ................................ ................................ ...........  11 \n3.4 Saving and Running MODFLOW CFP  ................................ ................................ ........  11 \n3.5 Reading the Solution  ................................ ................................ ................................ .. 12 \n3.6 Adding a Well ................................ ................................ ................................ ..............  12 \n3.7 Running MODFLOW CFP  ................................ ................................ ..........................  14 \n3.8 Reading the Solution  ................................ ................................ ................................ .. 14 \n4 Unsupported Package and Third -Party Executable ................................ ........................  14 \n4.1 Importing the MODFLOW Model  ................................ ................................ ................  15 \n4.2 Copying Unsupported Package Data  ................................ ................................ ..........  16 \n4.3 Running MODFLOW FMP2  ................................ ................................ ........................  17 \n4.4 Reading the Solution  ................................ ................................ ................................ .. 18 \n5 Conclusion  ................................ ................................ ................................ .........................  19 \n \n1 Introduction  \nGMS has the ability to use MODFLOW packages that are not yet supported directly \nthrough the user interface. It also has the ability to run MODFLOW through a text \ninterface with a third -party (external) MODFLOW executable.  \nThis tutorial discusses and demon strates:  \n\uf0b7 Importing, running, and analyzing a MODFLOW 2005 simulation using an \nunsupported package.  \n\uf0b7 Importing, running, and analyzing a MODFLOW CFP simulation with \nunsupported packages using an executable with GMS H5 support.  \n\uf0b7 Adding a well to the MODFLOW CFP simulation and examining the change.  \n\uf0b7 Importing, running, and analyzing a MODFLOW FMP2 simulation with \nunsupported packages using a third -party executable.  \n2 Unsupported Package and Supported Executable  \nThis section demonstrates how to import and run a MO DFLOW model which includes a \npackage not supported in GMS. This is done using a MODFLOW executable available \nfrom the GMS interface.  \n2.1 Description of Problem  \nThis model (Figure 1) is a sample distributed with MODFLOW 2005 . \nGMS Tutorials   MODFLOW \u2013 Unsupported Packages  \n \n Page 3 of 19 \u00a9 Aquaveo 2024   \n      Figure 1      RES Package example problem  \nThe test problem1 illustrates the use of RES1 and shows the comparison of results \nbetween RES1 and the River package. The test  problem uses a model grid consisting of \none layer, 12 rows, and 12 columns. Cell dimensions in the horizontal directions are 100 \nfeet on each side. The shaded area in Figure 1 represents  the area of potential \ninundation behind a dam and is defined by nonzero values in the IRES array.  \nFor the example problem, the ground water system is homogeneous and isotropic and \nhas a transmissivity of 10,000 ft2/d and a storage coefficient (specific yield) of 0.20. The \nthickness of reservoir -bed sediments is two feet. The vertical hydraulic conductivity of the \nreservoir -bed sediments is 1 ft/d.  \nThe combination of reservoir -bed hydraulic conductivity, thickness, an d cell area results \nin a reservoir -bed hydraulic conductance of 5,000 ft2/d for each cell in the area subject to \ninundation by the reservoir. The land -surface elevation in the area subject to inundation \nincreases along rows from a minimum of six feet in co lumn 4 to a maximu m of 10 feet in \ncolumn 10 .  \nAn additional reservoir cell in column 11 with a land -surface elevation of 21 feet was \nincluded to allow RESl to compute design characteristics over the range from six to 21 \nfeet . The cell has no effect on cal culations of flow between the reservoir and the \ngroundwater system because the maximum stage for the simulation is 14 f eet.  \nRecharge from precipitation and evapotranspiration were assumed to be negligible for \nthis problem. The General -Head Boundary (GHB) package  was used to represent flow \nalong the outside edges of columns 1 and 12 and flow was not allowed to cross the \nboundaries along the outside  edges of rows 1 and 12 .  \nInitial ground water levels were set at zero throughout the modeled area. Initially, t he \nimpoundment area is specified to be dry and a flood results in the reser voir filling for \n                                                      \n1 Fenske, John P.; Leake, S.A.; and Prudic, David E. 1996. \u201cDocumentation of a computer program \n(RES1) to simulate leakage from reservoirs using the modular finite -difference ground -water flow \nmodel (MODFLOW)\u201d in U.S. Geological Survey Open -File Report 96 -364, p.51. \nhttp://pubs.usgs.gov/of/1996/0364/report.pdf .  \n\nGMS Tutorials   MODFLOW \u2013 Unsupported Packages  \n Page 4 of 19 \u00a9 Aquaveo 2024  seven days . The problem simulates transient flow for a total of 9 days. Three stress \nperiods were use d to represent the flood with 1 day time steps . \n2.2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.   \n2.3 Importing the MODFLOW Model  \nImport the model by doing the following:  \n1. Click Open   to bring up the Open  dialog.  \n2. Browse to the unsupported \\restest  folder . \n3. Select \u201cMODFLOW Name Files (*.mfn;*.nam)\u201d from the Files of type  drop-down.  \n4. Select \u201c restest.nam \u201d and click Open  to close the Open  dialog and bring up the \nMODFLOW Translator  dialog.   \n5. Select MODFLOW 2005  and click OK to initiate the translator.   \n6. Once MODFLOW 2005 has terminated successfully, click Done  to close the \nMODFLOW Translator  dialog.  \nThis imports the model. In the graphics window, there should be a grid with symbols \nrepresenting the specified head boundary conditions along the left and right columns of \nthe grid as shown in Figure 2. \n \n      Figure 2      Imported RES Package example  \n\nGMS Tutorials   MODFLOW \u2013 Unsupported Packages  \n \n Page 5 of 19 \u00a9 Aquaveo 2024  7. Select File | Save  As\u2026  to bring up the Save As  dialog.  \n8. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n9. Enter \u201c restest.gpr \u201d as the File name  and click Save  to save the file and close the \nSave As  dialog . \n2.4 Viewing the Unsupported Packages  \nBefore running the simulation, view the list of files included in the simulation\u2019s name file.   \n1. Select MODFLOW | Name File\u2026  to bring up the MODFLOW Name File  dialog \n(Figure 3). \nThis dialog lists the files in the MODFLOW simulation\u2019s name file, including unsupported \npackages that will be included when the simulation runs. Files that are listed as \nunsupported can be opened and edited f rom this dialog and can also be removed from \nthe simulation. Toward the bottom of the list of name file items, the RES package is listed \nas unsupported.  \nThe RES package sample problem as shipped with MODFLOW 2005 doesn\u2019t have \nbinary head and flow budget ou tput turned on. In order to view the head and flow budget \nsolution through the GMS interface, these need to be turned on.  \n \n      Figure 3      The MODFLOW Name File dialog  \n1. Click OK to exit the MODFLOW Name File  dialog.  \n2. Select MODFLOW | OC \u2013 Output Control\u2026  to bring up the MODFLOW Output \nControl  dialog.  \n3. In the Output interval  section, select Output at every time step  and turn on Save \nheads to *.hed file  and Save cell by cell flow terms to *.ccf file . No other changes \nshould be m ade. \n4. Click OK to exit the MODFLOW Output Control  dialog.  \nTo view the RES package contribution to the flow budget, CCF file binary output must be \nturned on for the RES package text file. The text file can be opened and edited from the \nMODFLOW Name File  dialog.  \n\nGMS Tutorials   MODFLOW \u2013 Unsupported Packages  \n Page 6 of 19 \u00a9 Aquaveo 2024  5. Select MODFLOW | Name File\u2026  to bring up the MODFLOW Name File  dialog.  \nNotice that the unit number for the \u201crestest.ccf\u201d file (near the top of the list) is \u201c 40\u201d. This \nnumber will be used later.  \n6. Scroll down to the \u201cRES\u201d line and click Edit\u2026 to bring  up the View Data File  \ndialog. If you have already designated a text editor and checked the Never ask \nthis again  box in this dialog, the dialog will not appear and you can skip to step 8.  \n7. Select the desired text editor from the Open with  drop-down and clic k OK to \nclose the View Data File  dialog and open the RES package file in the selected \ntext editor.  \nIn the text file, the second value on the first line needs to be changed to the CCF unit \nnumber. The RES package uses a fixed file format with each integer t aking 10 \ncharacters. When changing the value, make sure it stays within the 10 character \nboundary.  \n8. Change the space before the \u201c 0\u201d value on the first line to \u201c 4\u201d so the value is now \n\u201c40\u201d (red arrow in Figure 4). \n9. Select File | Save  to save the change, then return to GMS.  \n10. Click OK to exit the MODFLOW  Name File  dialog.  \n \n      Figure 4      RES Package text file  \n2.5 Saving and Run ning MODFLOW  \nNow save the simulation and run MODFLOW. When using unsupported packages from a \nversion of MODFLOW supported by the GMS interface, MODFLOW can be run directly.  \n1. Save   the project.  \n2. Click Run Modflow   (or select MODFLOW  | Run MODFLOW ) to bring up the \nMODFLOW  model wrapper dialog.  \n3. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.  \n\nGMS Tutorials   MODFLOW \u2013 Unsupported Packages  \n \n Page 7 of 19 \u00a9 Aquaveo 2024  5. Save   the project with the MODFLOW solution.  \n2.6 Examining the Solution  \nThe contours for the \u201cHead\u201d dataset should now appear ( Figure 5). Now examine the \nsolution.  \n1. Click on the \u201c  Head \u201d dataset in the Project Explor er to make it active.  \n2. Use the Time Steps  window to cycle through the different time steps of the \nsolution to see how the head values change as the reservoir fills.  \nThe head values across the grid begin to equalize as the reservoir fills over the \nsimulation.  \n3. In the Time Steps  window, select the first time step (\u201c1.0\u201d).  \n4. Select MODFLOW  | Flow Budget\u2026  to bring up the Flow Budget  dialog.  \nOn the Cells tab  in the Flow In  column, the TOTAL FLOW  is 345,000 ft3/d. This is the \nflow into the model due to res ervoir leakage.  \n5. Click OK to exit the Flow Budget  dialog.  \n \n      Figure 5      RES Package head contours  \n\nGMS Tutorials   MODFLOW \u2013 Unsupported Packages  \n Page 8 of 19 \u00a9 Aquaveo 2024  3 Unsupported Package and GMS Compatible Executable  \nThis section of the tutorial describes and demonstrates how to import and run a \nMODFLOW model that includes an unsupported package. It uses a MODFLOW \nexecutable compiled to work with the GMS H5 file format.2 \nThe model in Figure 6 is based on  a sample model distributed with MODFLOW CFP, \ndescribed as follows:  \nAn example problem consist ing of four model rows and columns, three model layers, and \nfive stress periods  is presented. Model cells are 10 m eters in length and width and one \nmeter  thick. A  constant -head boundary is assigned along column 1 for all three model \nlayers, with a value equal to 20.0 m eters  above an arbitrary datum. No -flow boundaries \nexist around the outer edges of the model domain.  \nEach layer was assigned as a convertible layer in the LPF package , with constant \nhorizontal and vertical hydraulic conductivity equal to 1,000 and 200 m/d, respectively. \nSpecific yield and storage coefficient for each layer were assigned values of \u201c0.2\u201d and \n\u201c0.00002 \u201d, respec tively.  \nFor the CFPM1 exampl e problem, conduit pipes were activated, and five nodes and four \npipes (10 m eters  in length) were designed with the geometry and connections presented \nin Figure 6. Mean pipe water temperature was assigned a value of 25\u00b0C. The elevations \nof the pipes were assigned as 4.5 m eters  above the datum, and SA_EXCHANGE was \nset to \u201c1\u201d so the CFP would use the surface area of pipes in cells to compute the pipe \nconductance.  \nSoluti on controls for the pipe flow equations included a value of \u201c0.000001 \u201d for \nconvergence criterion (EPSILON), 100 maximum iterations (NITER), and the relaxation \nparameter (RELAX) equal to \u201c1.0\u201d. Each pipe diameter, tortuosity, and roughness heights \nwere set to constant values of \u201c0.1\u201d, \u201c1.0\u201d, and \u201c0.01\u201d meters , respectively. The critical \nReynolds numbers (NRe) for each pipe were assigned constant values equal to \u201c10.0\u201d for \nLCRITREY_P and \u201c20.0\u201d for TCRITREY_P.  \nThese values may be lower than generally expected for straight, non -tortuous, and rough \npipes . Nevertheless, they were chosen so that both laminar and turbulent pipe flow \nequations could be demonstrated using this example problem. A constant node head \nequal to 20.0 m eters  above the datum was assi gned for node 2, and a solution was \ndesired for the remaining node heads.  \nConduit wall permeabilities were assigned values of 5.0 m/d. The transient model \nboundary is net recharge. Values of \u201c0.003 \u201d, \u201c0.001 \u201d, \u201c0.002 \u201d, \u201c0.003 \u201d, \u201c0.002 \u201d m/d were \nassigned fo r net recharge to the uppermost active model layer for stress periods 1 \nthrough 5, respectively, using the RCH Package. The CRCH Package was employed, \nwhich routed all of the net recharge assigned to MODFLOW cell 3,3,1 (j,i,k) into conduit \nnode 4. 3 \nFor th is tutorial, the model was changed to have a horizo ntal hydraulic conductivity of 10 \nm/d. \n                                                      \n2 See http://modflow.org/aquaveo -modflow  for more details.  \n3 Shoemaker, W. Barclay; Kuniansky, Eve L.; Birk, Steffen; Bauer, Sebastian; and Swain, Eric D. \n2008, \u201cDocumentation of a Conduit Flow Process (CFP) for M ODFLOW -2005\u201d in U.S. Geological \nSurvey Techniques and Methods 6 -A24, p.33 . http://pubs.usgs.gov/tm/tm6a24/pdf/tm6 -A24.pdf .  \nGMS Tutorials   MODFLOW \u2013 Unsupported Packages  \n \n Page 9 of 19 \u00a9 Aquaveo 2024   \n      Figure 6      Conduit Flow Process Mode 1 (CFPM1) example problem  \n3.1 Importing the Project  \nBegin with opening a project showing the loca tion of conduit network:  \n1. Select File | New to restore program settings to their default state.  \n2. Click Open   to bring up the Open  dialog.  \n3. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n4. Browse to the unsupported directory and select \u201c start.gpr \u201d. \n5. Click Open to import the project and close the Open  dialog.   \nThe project should show a diagram of the conduit network ( Figure 7). \n \n      Figure 7      Starting CFP project with conduit network  \n\nGMS Tutorials   MODFLOW \u2013 Unsupported Packages  \n Page 10 of 19 \u00a9 Aquaveo 2024  3.2 Importing the MODFLOW Model  \nThe next step is to import the MODFLOW CFP model. The sample problem contains \nthree packages that are currently not supported by GMS: the CFP, CRCH, and COC \npackage s, which are only available in MODFLOW CFP. To import the model, use the \nMODFLOW -2005 importer since MODFLOW CFP is based on MODFLOW -2005 and it \nsupports all of the other packages used by the model.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cMODFLOW  Name Files (*.mfn;*.nam)\u201d from the File of type  drop-down.  \n3. Browse to the unsupported \\CFPM 1 folder and select \u201c CFPM1.nam \u201d. \n4. Click Open  to close the Open  dialog and bring up the MODFLOW Translator  \ndialog.   \n5. Select MODFLOW 2005  and click OK to initiate the translator.   \n6. Once MODFLOW 2005 has terminated successfully, click Done  to finish \nimporting the file and close the MODFLOW Translator  dialog.  \nA grid should appear with symbols representing the specified head boundary conditions \non the left (Figure 8). \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c CFPM1.gpr \u201d for the File name and click Save  to create the new project file \nand close the Save As  dialog . \n \n      Figure 8      Specified head boundary conditions on the left  \n\nGMS Tutorials   MODFLOW \u2013 Unsupported Packages  \n \n Page 11 of 19 \u00a9 Aquaveo 2024  3.3 Viewing the Unsupported Packages  \nBefore running the simulation, view the unsupported packages.   \n1. Select MODFLOW | Name File\u2026  to bring up the MODFLOW Name File  dialog.   \nThis dialog lists the files included in the simulation\u2019s name file. Toward the bottom of the \nlist of name file items, the CFP, COC, and CRCH packages should be listed.  \n2. Click OK to exit the MODFLOW Name File  dialog.  \n3.4 Saving and Running MODFLOW CFP  \nNow the project is ready to run MODFLOW CFP. When using unsupported packages \nfrom a version of MODFLOW supported by the GMS interface, MODFLOW can be run \ndirectly. Because this project  uses MODFLOW CFP, which isn\u2019t supported by the GMS \ninterface,  it is necessary to first change the simulation to use the Run MODFLOW  dialog \nin order to use a different executable.  \n1. Select MODFLOW  | Global Options \u2026 to bring up the MODFLOW Global/Basic \nPackag e dialog.  \n2. In the MODFLOW version  section, turn on Use custom Run dialog . \n3. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n4. Save   the project.  \n5. Click Run Modflow   (or select MODFLOW  | Run MODFLOW ) to bring up the \nRun MODFLOW  dialog.  \nThis dialog allows custom options to be entered for running MODFLOW, including a \ndifferent name file, MODFLOW executable, and added command line options. The \nCommand line  section at the bottom of the dialog shows the command line that will run \nMODFLOW. To run MODFLOW CFP, it is necessary to change to a different executable. \nGMS includes a MODFLOW CFP executable compatible with the GMS MODFLOW H5 \nfile format used by this tutorial.  \n6. In the MODFLOW version  section, select 2005 .  \nNote the path to the MODFLOW 200 5 executable in the Command line  section of the \ndialog. To change to the MODFLOW CFP executable, do the following:  \n7. In the MODFLOW version  section, select Custom  and click the Browse   \nbutton to the right to bring up the Open  dialog .  \n8. Browse to the \\models \\mf-cfp\\ directory under the GMS folder for your installation \nof GMS. In a typical installation of the 64 -bit version, this will be C:\\Program \nFiles \\GMS 10. 5 64-bit\\models \\mf-cfp\\.  \n9. Select \u201cMODFLOW executable (*.exe)\u201d from the Files of type  drop-down.  \n10. Selec t \u201cmf2k5cfp_h5.exe \u201d and click on Open  to close the Open  dialog.  \n11. Click OK to close the Run MODFLOW  dialog and open a DOS command prompt \nwindow which will run MODFLOW.   \n12. When MODFLOW 2005 terminates successfully, press any key to continue. This \ncloses the DO S command prompt window and returns to GMS.  \n\nGMS Tutorials   MODFLOW \u2013 Unsupported Packages  \n Page 12 of 19 \u00a9 Aquaveo 2024  3.5 Reading the Solution  \nWhen using the Run MODFLOW  dialog, it is necessary to manually import the \nMODFLOW solution.  \n1. Select MODFLOW | Read Solution\u2026  to bring up the Open  dialog.  \n2. Select \u201cMODFLOW Name File (*.mfn )\u201d from the drop -down to the right of the File \nname  field.  \n3. Browse to the unsupported \\CFPM1_MODFLOW  directory and select \n\u201cCFPM1.mfn\u201d.  \n4. Click Open  to read the solution.  \n5. Save   the project with the new solution.  \nThe solution should change the contours to show  the solution head values ( Figure 9).  \n6. Click on the \u201c  Head \u201d dataset in the Project Explorer and change between time \nsteps to further examine the head values.  \n7. The solu tion can also be further reviewed by right -clicking on the \u201cCFPM1.out\u201d \nfile in the Project Explorer and selecting View File . \n8. When done, return to GMS.  \n9. Select \u201c  Head\u201d to make it active and select the \u201c100.0\u201d time step.  \n \n      Figure 9      CFPM1 contours  \n3.6 Adding a Well  \nNow add a well to the simulation to see how it affects the results:  \n\nGMS Tutorials   MODFLOW \u2013 Unsupported Packages  \n \n Page 13 of 19 \u00a9 Aquaveo 2024  1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c CFPM1 -well.gpr \u201d as the File name . \n4. Click Save  to save the project and close the Save As  dialog.  \n5. Using the Select Cells   tool, select the cell in row 2 and column 4 ( IJK = 2,4,1, \nsee Figure 10). \n \n      Figure 10      Cell to select for added well  \n6. Right -click on the selected cell and select Sources/Sinks \u2026 to bring up the \nMODFLOW Sources/Sinks  dialog.  \n7. Select \u201cWells  (WEL)\u201d from the list on the left.  \n8. Click on the Add BC  button. Two rows should be added to the spreadsheet \nabove the button.  \n9. On row 8 in the Q (flow) (m^3/d)  column, enter\u201c -1.0\u201d. \n10. Click OK to close the MODFLOW Sources/Sinks  dialog.  \nA well boundary condition  symbol should appear in the cell ( Figure 11). \nSelect this cell  \nGMS Tutorials   MODFLOW \u2013 Unsupported Packages  \n Page 14 of 19 \u00a9 Aquaveo 2024   \n      Figure 11      The well has appeared in cell 2,4,1  \n3.7 Running MODFLOW CFP  \nNext, run the s imulation with the added well:  \n1. Save   the project.  \n2. Click Run MODFLOW   (or select MODFLOW  | Run MODFLOW ) to bring up \nthe Run MODFLOW  dialog.  \n3. In the MODFLOW version  section, select Custom  and make sure \n\u201cmf2k5cfp_h5.exe \u201d is the executable in the file path to the right of Custom . \n4. Click OK to close the Run MODFLOW  dialog and bring up a DOS command \nprompt window that runs MODFLOW CFP.  \n5. Once MODFLOW finishes, press any key to close the window and return to \nGMS.  \n3.8 Reading the S olution   \nNow import the solution with the well by doing the following:  \n1. Select MODFLOW  | Read Solution\u2026  to bring up the Open  dialog.  \n2. Select \u201cMODFLOW Name Files\u201d from the drop -down to the right of the File name  \nfield.  \n3. Select \u201cCFPM1 -well.mfn\u201d and click Open  to import the solution.  \n4. Save   the project.   \nBoth simulation solutions are available in the Project Explorer.  \n5. Click back and forth between the \u201c  Head \u201d datasets under \u201c  CFPM1\u201d and \u201c  \nCFPM1 -well\u201d to see the difference adding the well has made.  \nDifferences  can also be found by inspecting the solution output files.   \n4 Unsupported Package and Third -Party Executable  \nThis section of the tutorial looks at importing and running a model using an unsupported \npackage using a third -party MODFLOW executable. To run MODF LOW using a third -\nparty executable, turn on the options to save a native text copy of the simulation, and \nthen use the Run MODFLOW  dialog to run the simulation.  \nThe sample model distributed with MODFLOW FMP2 is shown in Figure 12. It includes \nthe FMP2, SFR2, UZF1, and MNW1 packages, and is a complex model which is \n\nGMS Tutorials   MODFLOW \u2013 Unsupported Packages  \n \n Page 15 of 19 \u00a9 Aquaveo 2024  described in further detail in the MODFLOW FMP2 documentation.4 This section of the \ntutorial will demonst rate using unsupported packages and third -party executables within \nGMS.  \n \n      Figure 12      FMP2 example problem  \n4.1 Importing the MODFLOW Model  \nIn this section, import the MODFLOW FMP2 model. The model is distributed with a \nMODFLOW  FMP2 executable that is based on MODFLOW -2005, so MODFLOW -2005 \ncan be used to import the model.  \n1. Select File | New to restore program settings to their defaults.  \n2. Click Open  to bring up the Open  dialog.  \n3. Select \u201cMODFLOW Name Files (*.mfn;*.nam)\u201d from the Files of type  drop-down.  \n4. Browse to the \\Tutorials \\MODFLOW \\unsupported \\ex1 folder and select \n\u201cex1.nam \u201d. \n5. Click Open  close the Open  dialog and bring up the MODFLOW Translator  dialog.   \n6. Select MODFLOW 2005  and click OK to initiate the translation.   \n                                                      \n4 Schmid, W., Hanson, R.T., 2009, The Farm Process Version 2 (FMP2) f or MODFLOW -2005 \u2014\nModifications and Upgrades to FMP1: U.S. Geological Survey Techniques and Methods 6 -A32, \n102 p.  \n\nGMS Tutorials   MODFLOW \u2013 Unsupported Packages  \n Page 16 of 19 \u00a9 Aquaveo 2024  7. Once MODFLOW 2005 has terminated successfully, click Done  to close the \nMODFLOW Translator  dialog.  \nA grid should appear with symbols representing the general head, SFR2, and MNW1 \nboundary conditions ( Figure 12). \nIn order to run MODFLOW, it is necessary to create a native text export using the Run \nMODFLOW  dialog.   \n8. Select MODFLOW |  Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage  dialog.  \n9. In the  MODFLOW version  section, turn on Save native text copy  and Use custom \nRun dialog .  \n10. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n11. Select MODFLOW | OC \u2013 Output Control\u2026  to bring up the MODFLOW Output \nControl  dialog.  \n12. In the Output interval  section, select Output at every time step .  \n13. Click OK to exit the MODFLOW Output Control  dialog.  \n14. Select File | Save  As\u2026  to bring up the Save As  dialog.  \n15. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n16. Enter \u201c ex1.gpr \u201d as the File name . \n17. Click Save  to create the new project file and close the Save As  dialog . \n4.2 Copying Unsupported Package Data  \nBefore running the simulation, view the unsupported package file.   \n1. Select MODFLOW | Name File\u2026  to bring up the MODFLOW Name File  dialog.  \nToward the bottom of  the list of name file items, notice the unsupported FMP package \nalong with several unsupported data files.  \n2. Click the Edit\u2026 button at the right of the FMP  package row to bring up the View \nData File  dialog.  \n3. Select the desired text editor from the Open with  drop-down.  \n4. Click OK to close the View Data File  dialog and open the file in the selected text \neditor.  \nThere are several lines that begin with \u201cOPEN/CLOSE\u201d or \u201cEXTERNAL\u201d ( Figure 13). \nWhen the MODFLOW reads the FMP package data, these lines direct MODFLOW to \nread data from different files. The lines beginning with \u201cOPEN/CLOSE\u201d read the file \ncontents for the named file on the fly. The lines beginning with \u201cEXTERNAL\u201d read  the \ncontents from a file listed in the name file with the given unit number.  \nBecause the GMS importer copies unsupported package files without interpreting the \ncontents, these files are not copied. For the simulation to run correctly, the associated \nfiles will need to be copied into the native text folder.  \nGMS Tutorials   MODFLOW \u2013 Unsupported Packages  \n \n Page 17 of 19 \u00a9 Aquaveo 2024   \n      Figure 13      The ex1.fmp file as viewed in Notepad  \n5. Close the text editor.  \n6. Open a Windows Explorer window outside of GMS and browse to the \n\\Tutorials \\MODFLOW \\unsupporte d\\ex1 folder.  \n7. Open a second Windows Explorer window and browse to the \n\\Tutorials \\MODFLOW \\unsupported \\ex1\\ex1_MODFLOW_text  folder.  \n8. Copy the FMP _IN folder and all of the files beginning with \u201cex1.in_\u201d to the \nex1_MODFLOW_text  folder. Be careful to only copy t he files instead of moving \nthem. There should be six files copied in addition to the folder.  \n9. Close both windows and return to GMS.  \n10. Click OK to exit the MODLFOW Name File  dialog.  \n4.3 Running MODFLOW FMP2  \nNow run MODFLOW:  \n1. Click Run Modflow   (or select MODFLOW | Run MODFLOW ) to bring up the \nRun MODFLOW  dialog.  \nThe Run MODFLOW  dialog will appear. In this dialog, it\u2019s necessary to change to the \nname file contained in the ex1_MODFLOW_text folder, and change to use the custom \nexecutable included with the sample simu lation.  \n2. Click on the Name file  Browse   button to bring up the Open  dialog.  \n3. Select \u201cName file or super file (*.mfn;*.nam, *,mfs)\u201d from the Files of type  drop-\ndown.  \n4. Navigate to the \\Tutorials \\MODFLOW \\unsupported \\ex1\\ex1_MODFLOW_text  \nfolder and select \u201c ex1.mfn \u201d. \n5. Click Open  to close the Open  dialog. Notice that the Name file  path has \nchanged.  \n6. In the MODFLOW version  section, select Custom . \n7. Click on the Custom  Browse   button to bring up the Open  dialog.  \n8. Select \u201cMODFLOW executables (*.exe)\u201d from the Files o f type  drop-down.  \n\nGMS Tutorials   MODFLOW \u2013 Unsupported Packages  \n Page 18 of 19 \u00a9 Aquaveo 2024  9. Browse to the \\Tutorials \\MODFLOW \\unsupported \\ex1 folder and select \n\u201cMF2K5_FMP 2_rls32.exe \u201d. \n10. Click Open  to close the Open  dialog. Notice that the Custom  path has changed.  \n11. Click OK to close the Run MODFLOW  dialog and run MODFLOW.   \nA DOS command prompt window will show the progress of the MODFLOW run. When \nthe simulation is completed, the text \u201cNormal termination of simulation\u201d will appear near \nthe bottom of command window.  \n12. When MODFLOW finishes, press any key to close the DOS command prom pt \nwindow.  \n4.4 Reading the Solution  \nNext, import the MODFLOW solution:  \n1. Select MODFLOW | Read Solution\u2026  to bring up the Open  dialog.  \n2. Select \u201cMODFLOW Name File (*.mfn)\u201d from the drop -down to the right of the File \nname  field.  \n3. Navigate to the \\Tutorials \\MODFLOW \\unsupported \\ex1\\ex1_MODFLOW_text  \nfolder and select \u201cex1.mfn\u201d.  \n4. Click Open  to import the solution and close the Open  dialog.  \n5. Click Contours   to open the Dataset Contour Options \u2013 3D Grid \u2013 Head  \ndialog.  \n6. Click OK to accept the defaults and close the Dataset Con tour Options \u2013 3D Grid \n\u2013 Head  dialog.  \n7. When the alert appears, click Yes to turn on contours.  \nThe contours will appear, reflecting the head solution values ( Figure 14). \n\nGMS Tutorials   MODFLOW \u2013 Unsupported Packages  \n \n Page 19 of 19 \u00a9 Aquaveo 2024   \n      Figure 14      FMP2 contours  \n8. Select MODFLOW  | Flow Budget\u2026  to bring up the Flow Budget  dialog.  \nNotice the values for the FMP package on the \u201cFARM WELLS\u201d and \u201cFARM NET RECH\u201d \nrows.  \n9. Once done examining the flow budget information, click OK to close the Flow \nBudget  dialog.  \n5 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 Unsupported Packages\u201d tutorial. The following topics \nwere demonstrated and discussed:  \n\uf0b7 GMS has the ability to import and run MODFLOW simulations with unsupported \npackages.  \n\uf0b7 The Name File  dialog shows the supported and unsupported packages used by a \nMODFLOW simulation.  \n\uf0b7 The MODFLOW Run  dialog provides the ability to run a simulation using an \nexternal MODFLOW executable.  \n\uf0b7 When using an external executable, the solution can be manually imported and \nexamined in GMS.  \n\n", "filename": "MODFLOW-UnsupportedPackage.pdf", "pages": 19}, "MODFLOW-USG-Calibration": {"text": "GMS Tutorials   MODFLOW -USG \u2013 Calibration  \n Page 1 of 14 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW -USG \u2013 Calibration  \nGenerate observation data in a MODFLOW -USG model  \n \nObjectives   \nThis tutorial instructs how to use the GMS tools to create observation data for MODFLOW -USG.  \nPrerequisite Tutorials  \n\uf0b7 MODLOW \u2013 Model \nCalibration  \n\uf0b7 MODFLOW -USG \u2013 \nQuadtree  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 15\u201330 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   MODFLOW -USG \u2013 Calibration  \n Page 2 of 14 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ............  2 \n2 Getting Started  ................................ ................................ ................................ ....... 3 \n2.1 Importing the Starting Project  ................................ ................................ ..........  3 \n2.2 Saving with a Different Name  ................................ ................................ ..........  3 \n3 Converting to MODFLOW -USG  ................................ ................................ ............  4 \n4 Generating Observation Data for MODFLOW -USG  ................................ ............  4 \n5 Saving and Running MODFLOW  ................................ ................................ ..........  7 \n5.1 Viewing the Model Error  ................................ ................................ ..................  8 \n5.2 Changing the Observation Target Display Options  ................................ ....... 10 \n6 Creating a MODFLOW -USG Model on a Voronoi UGrid  ................................ ... 10 \n6.1 Creating the UGrid  ................................ ................................ .........................  10 \n6.2 Creating the MODFLOW -USG Simulation  ................................ ....................  11 \n6.3 Saving and Running MODFLOW -USG  ................................ .........................  12 \n7 Creating a MODFLOW -USG Model on a Quadtree UGrid  ................................  12 \n7.1 Creating the UGrid  ................................ ................................ .........................  12 \n7.2 Creating the MODFLOW -USG Simulation  ................................ ....................  13 \n7.3 Saving and Running MODFLOW -USG  ................................ .........................  14 \n8 Conclusion  ................................ ................................ ................................ ...........  14 \n9 References  ................................ ................................ ................................ ............  14 \n \n1 Introduction  \nAn important part of any groundwater modeling exercise is the model calibration process. \nIn order for a groundwater model to be used in any type of predictive role, it must be \ndemonstrated that the model can successfully simulate observed aquifer behavior. \nCalibration is a process  wherein certain parameters of the model, such as recharge and \nhydraulic conductivity, are altered in a systematic fashion. Then, the model is repeatedly \nrun until the computed solution matches field -observed values within an acceptable level \nof accuracy.  \nMost versions of MODFLOW include an observation process within the model. \nMODFLOW -USG does not, so the steps to set up observation data vary slightly from \nother versions of MODFLOW. Various utility programs have been developed as part of \nthe PEST suite of tools. They are used to compute observation data with MODFLOW -\nUSG. After MODFLOW -USG successfully runs a model, these PEST utilities are used to \npost-process the MODFLOW outputs in order to compare the model simulated values \nwith the field -observed values.  \nThis tutorial starts with a MODFLOW 2000 model that includes observation data, and \nconverts that model to a MODFLOW -USG model. Different types of UGrids are \ngenerated using the same conceptual model to show how observations work with \nQuadtree and Voronoi  grids.  \nFamiliarity with conceptual modeling, model calibration, MODFLOW -USG, and \nunstructured grid generation is assumed. The prerequisite tutorials should be completed \nprior to starting this tutorial.  \nThis tutorial discusses and demonstrates opening a MO DFLOW 2000 model and \nconverting it to a MODFLOW -USG simulation. It then generates observation data for the \nMODFLOW -USG model, runs MODFLOW -USG, and reviews the results. Creation of a \nVoronoi UGrid and MODFLOW -USG simulation, as well as quadtree UGrid and \nMODFLOW -USG simulation, will be shown.  \n \nGMS Tutorials   MODFLOW -USG \u2013 Calibration  \n \n Page 3 of 14 \u00a9 Aquaveo 2024  2 Getting Started  \nDo the following to get started.  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2.1 Importing the Starting Project  \nBegin by importing a previously constructed MODFLOW -2000 model.  \n1. Click Open  to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the Tutorials \\MODFLOW -USG \\Calibration \\ directory and select \n\u201cbigval .gpr\u201d. \n4. Click Open  to import the project and exit the Open  dialog.  \nA model similar to Figure 1 should appear.  \n \n      Figure 1      MODFLOW -2000 model  \nThe model has observation wells with calibration targets displayed next to each point. \nThere is also a flow observation associated with the river boundary condition (blue \nsymbols).  \n2.2 Saving with a Different Name  \nBefore making any ch anges, save the project under a new name.  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Calibration  \n \n Page 4 of 14 \u00a9 Aquaveo 2024  2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c calib-usg.gpr \u201d as the File name . \n4. Click Save  to save the project under the new name and c lose the Save As  \ndialog.  \nIt is recommended to Save   periodically while progressing through the model.  \n3 Converting to MODFLOW -USG  \nNow to create a MODFLOW -USG model from the MODFLOW 2000 model:  \n1. Right -click on the \u201c  MODFLOW \u201d in the Project Explorer  and select Convert to \nMODFLOW -USG Simulation . \n2. Click No when prompted to include inactive cells in the new UGrid.  \n3. Click OK when prompted regarding the PCG package not being copied to the \nMODFLOW -USG simulation.  \nThe PCG package is a solver package that is not supported in USG. USG supports the \nSMS solver package and this has been included in the new simulation.  \n4. Turn off the \u201c 3D Grid Data \u201d folder in the Project Explorer . \nNotice that the UGrid looks identical to the 3D Grid but is not displaying any contour s \n(Figure 2). The calibration targets are still visible and are showing the computed values \nfrom the MODFLOW -2000 model on the 3D Grid.  \n \n      Figure 2      After conversion to USG  \n4 Generating Observation Data for MODFLOW -USG  \nNow to create observation data for this MODFLOW -USG model:  \n\nGMS Tutorials   MODFLOW -USG \u2013 Calibration  \n \n Page 5 of 14 \u00a9 Aquaveo 2024  1. Under \u201c  ugrid\u201d  in the Project Explorer , right-click on \u201c MODFLOW \u201d and \nselect Observations \u2026 to bring up the MODF LOW -USG Observations  dialog.  \nThis dialog displays a series of tables representing field -measured data, generated from \ndata entered in the coverages of the conceptual model.  \n2. Click on Generate PEST Obs. Data\u2026  to bring up the Generate Observations  \ndialog ( Figure 3). \n \n      Figure 3      Generate Observations dialog  \nThe dialog allows choosing from the coverages in the current project that have \nobservation data. In this case, two coverages have observation data. Head \nmeasurements are in the \u201c  Observation Wells \u201d coverage and flow measurements are \nin the \u201c  Sources & Sinks \u201d coverage.  \nNotice that below the Head Observation Coverages  section, there  is an option to select \nan interpolation scheme (IDW, Kriging). This is used to interpolate from the model grid \ncells to the observation wells.  \n3. In the Head Observation Coverages  section, turn on \u201c Observation Wells \u201d.  \n4. In the Flow Observation Coverages  section, turn on \u201c Sources & Sinks \u201d. \n5. Leave all other options at the defaults and click OK to generate the observation \ndata.  \nA new \u201cWells\u201d table should be visible in the right side of the dialog ( Figure 4). \n\nGMS Tutorials   MODFLOW -USG \u2013 Calibration  \n \n Page 6 of 14 \u00a9 Aquaveo 2024   \n      Figure 4      MODFLOW -USG Observations dialog Wells table  \nThe items in this table represent the observation well data found in the \u201c  Observation \nWells\u201d cov erage, showing the coverage name, point id, and point name. The last column \nis an alias. The PEST utilities used to compute observation information have certain rules \nfor the names of observations. The alias column ensures that these rules are met without \nany required interaction. If the user -defined name assigned to the point meets these \nrules, then the user -defined name will be used as the alias.  \n6. Select \u201c Well To Node \u201d from the list on the left.  \nThe entries in this table represent the interpolation from th e UGrid cells to the observation \npoint. The table shows the alias of the well, the UGrid cell id ( Node  ID), and an \ninterpolation factor. The PEST  utility uses the cell ids and factors to interpolate from the \nMODFLOW head output file to each observation well.  \n7. Select \u201c Well Sample \u201d from the list on the left.  \nThis table represents the measurements taken at the observation wells. The table lists a \nwell alias, a date/time, and a head value. If the model was transient, it would most likely \nhave multiple measurements at each well with a different date/time for each \nmeasurement. Since this model is steady state, only one measurement for each well and \nthe dat e of 1950 -01-01 00:00:00 has been assigned. The date is meaningless in this \ncase, but a date must be assigned for the PEST utility to function so GMS uses this date \nas the default.  \n8. Select \u201c Flow  Observations \u201d from the list on the left.  \nThis table lists any  flow observations that are included in the coverages of the conceptual \nmodel and is similar to the \u201cWells\u201d table. The table lists the coverage name, the type of \nfeature (i.e., POINT, ARC, ARCGROUP, POLYGON), the feature ID, the feature name, \nand an alias.  This alias is just like the alias for the observations wells. In this model, \nnotice that one flow observation is on an arc  group. This arc group comprises several \narcs that are used to define the river in the middle of the model.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Calibration  \n \n Page 7 of 14 \u00a9 Aquaveo 2024  9. Select \u201c Flow  Sample \u201d from  the list on the left.  \nThis table lists the flow measurements taken from field data. It is just like the \u201cWell \nSample\u201d table.  \n10. Click OK to exit the MODFLOW -USG Observations  dialog.  \n5 Saving and Running MODFLOW  \nNow to run MODFLOW:  \n1. Save   the project.  \n2. Right -click on the \u201c  MODFLOW \u201d item  under \u201c ugrid \u201d item and select Open \nContaining Folder  to bring up the \\Tutorials \\MODFLOW -USG \\Calibration \\calib-\nusg_MODFLOW -ugrid  directory in Windows Explorer.  \nThis is the directory where the MODFLOW -USG input files are saved. N otice that there \nare several files with \u201ccalib -usg.obsusg.\u201d and \u201ccalib -usg.obsusgf.\u201d as part of the file name. \nThese are not MODFLOW input files, but are used as inputs for the PEST utilities.  \nThere are also several batch files in the folder. These batch files are used to call the \nPEST utilities after MODFLOW runs. The main batch file is named \u201cusgobs.bat\u201d. This is \nthe batch file that runs once MODFLOW has terminated successfully  \n3. Close Windows Explorer and return to GMS.  \n4. Click Run MODFLOW   to bring up the  MODFLOW  model wrapper dialog.  \n5. When the model finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n6. Click Close  to import the solution, exit the MODFLOW  model wrapper dialog, \nand bring up a GMS prompt.  \nThe prompt states that \u201cTh e current project includes both a 3D Grid and a UGrid. The \nobservation targets will be drawn using data from the active dataset on the active 3D \nGrid. This display option can be edited in the Map Data Display Options under the section \n\u2018Projects including 3 D Grid & UGrid, MODFLOW targets use\u2019.\u201d  \n7. Click OK to close the prompt.  \nThe model should update to appear similar to Figure 5. \n\nGMS Tutorials   MODFLOW -USG \u2013 Calibration  \n \n Page 8 of 14 \u00a9 Aquaveo 2024   \nFigure 5      Contours after the initial MODFLOW run  \n5.1 Viewing the Model Error  \nNow to compare the model error for the MODFLOW -USG model to the MODFLOW -2000 \nmodel:  \n1. Right-click on the \u201c  calib-usg (MODFLOW)\u201d solution and select Properties\u2026 \nto bring up the Properties  dialog.  \nThe values should match those shown in Figure 6. \n\nGMS Tutorials   MODFLOW -USG \u2013 Calibration  \n \n Page 9 of 14 \u00a9 Aquaveo 2024   \n      Figure 6      Model error for MODFLOW -USG model  \n2. Select OK to exit the Properties  dialog.  \n3. Right -click on the \u201c  bigval (MODFLOW) \u201d solution under \u201c grid\u201d and select \nProperties \u2026 to bring up the Properties  dialog.  \nThe values should match those shown in Figure 7. Note that the error is slightly different \nfor the two models. This is expected since this MODFLOW -USG model is a copy of the \n3D grid model. The difference in the observations comes by using the PEST utilities to \ncalculate the computed values instead of using the MODFLOW OBS package.  \n \nFigure 7      Model error for MODFLOW -2000 model  \n4. Select OK to exit the Properties  dialog.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Calibration  \n \n Page 10 of 14 \u00a9 Aquaveo 2024  5.2 Changing the Observation Target Display Options  \nNow to change the display options so that the targets will reflect the computed values \nfrom the MODFLOW -USG simulation.  \n1. Click Display Options   to bring up the Display Options  dialog. \n2. Select \u201c Map Data \u201d from the list on the left.  \n3. On the Map tab at the bottom of the section on the right, select \u201cUGrid\u201d from the \nProject including 3D Grid & UGrid, MODFLOW targets use  drop-down.  \n4. Click OK to exit the Display Options  dialog.  \nAs expected, the targets look nearly the same as the targets did when using the data \nfrom the 3D grid. If there is only a 3D Grid or only a UGrid, then this display option has no \neffect on the observation points. However, when a project has both a 3D Grid \nMODFLOW simulation and a UGrid MODFLOW simulation, this display option is used to \ndetermine the source of the computed values for the observation points.  \n6 Creating a MODFLOW -USG Model on a Voronoi UGrid  \nNow, create a second UGrid using the Voronoi  criteria.  \n6.1 Creating the UGrid  \n1. Right -click on \u201c  3D Grid Data \u201d in the Project Explorer  and select Delete . \nDeleting the 3D Grid before creating Voronoi and quadtree UGrids with corresponding \nMODFLOW -USG simulations avoids the message about having both a 3D Grid and a \nUGrid associated with the observation data.  \n2. Select \u201c Sources & Sinks \u201d in the Project Explorer  to make it active.  \n3. Right -click on \u201c Sources & Sinks \u201d and select Map To | UGrid to bring up the \nMap \u2192 UGr id dialog.  \n4. Select \u201c3D\u201d from the Dimension  drop-down.  \n5. Select \u201cVoronoi\u201d from the UGrid type  drop-down.  \n6. Enter \u201c1\u201d in the Number of cells  field in the Z-Dimension  section.  \n7. Click OK to close the Map \u2192 UGrid  dialog . \n8. Uncheck the box next to \u201c  ugrid \u201d in the Project Explorer  to better see the newly \ncreated \u201c  ugrid (2)\u201d . \nThe new UGrid should be similar to Figure 8. \n\nGMS Tutorials   MODFLOW -USG \u2013 Calibration  \n \n Page 11 of 14 \u00a9 Aquaveo 2024   \n      Figure 8      Voronoi UGrid  \n6.2 Creating the MODFLOW -USG Simulation  \nNow, create a MODFLOW -USG simulation on the UGrid. Start with creating a new \nMODFLOW simulati on. Then, use the layer interpolation tools to set the elevations of the \ngrid and convert the conceptual model by mapping it to MODFLOW.  \n1. Right -click on \u201c  ugrid (2) \u201d and select Rename . \n2. Enter \u201cvoronoi\u201d and press Enter  to set the new name.  \n3. Right -click on \u201c  voronoi \u201d and select New MODFLOW \u2026 to bring up the \nMODFLOW Global/Basic Package  dialog.  \n4. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n5. Right -click on \u201c  Layers \u201d and select Interpolate to | MODFLOW Layers  to bring \nup the Interpolate to MODFLOW Laye rs dialog.  \n6. Click OK to accept the defaults, close the Interpolate to MODFLOW Layers  \ndialog, and interpolate the layer elevations to \u201c  voronoi\u201d.  \n7. Right -click on \u201c BigVal \u201d and select Map to | MODFLOW/MODPATH  to bring up \nthe Map \u2192 Model dialog.  \n8. Click OK to accept the defaults, close the Map \u2192 Model  dialog, and convert the \nconceptual model to \u201c  voronoi\u201d. This process may take a few moments.  \n9. Right -click on \u201c  MODFLOW \u201d under \u201c  voronoi \u201d and select Observations \u2026 to \nbring up the MODFLOW -USG Observations  dialog.  \nNotice that the observation data has already been populated. This happens as part of \nmapping the data to MODFLOW.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Calibration  \n \n Page 12 of 14 \u00a9 Aquaveo 2024  10. Click Generate PEST Obs. Data \u2026 to bring up the Generate Observations  \ndialog.  \nNotice that both coverages listed have a check next to them . \n11. Click OK to exit the Generate Observations  dialog.  \n12. Click OK to exit the MODFLOW -USG Observations  dialog.  \n6.3 Saving and Running MODFLOW -USG  \nNow to run MODFLOW using the Voronoi UGrid:  \n1. Save   the project.  \n2. Click Run MODFLOW   to bring up the MODFLOW  model wrap per dialog.  \n3. When the model finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and exit the MODFLOW  model wrapper dialog.  \n5. Select the \u201c Observation Wells \u201d coverage to make the observation targets \nvisible.  \nNotice that the observation targets are similar to those in the original model.  \n7 Creating a MODFLOW -USG Model on a Quadtree UGrid  \nNow, create the quadtree UGrid and its corresponding MODFLOW -USG simulation.  \n7.1 Creating the UGrid  \n1. Select \u201c Sour ces & Sinks \u201d to make it active.  \n2. Right -click on \u201c Sources & Sinks \u201d and select Map To | UGrid  to bring up the \nMap \u2192 UGrid  dialog.  \n3. Select \u201c3D\u201d from the Dimension  drop-down.  \n4. Select \u201cQuadtree / Octree\u201d from the UGrid type  drop-down.  \n5. In both the X-Dimension  and Y-Dimension  sections, select the Cell size  option \nand enter \u201c 200.0 \u201d in the Cell size  field.  \n6. Click OK to close the Map \u2192 UGrid  dialog.  \n7. Turn off \u201c  voronoi \u201d to better view the new \u201c  ugrid (2)\u201d.  \nThe new UGrid should appear similar to Figure 9. \n\nGMS Tutorials   MODFLOW -USG \u2013 Calibration  \n \n Page 13 of 14 \u00a9 Aquaveo 2024   \n      Figure 9      Quadtree UGrid  \n7.2 Creating the MODFLOW -USG Simulation  \nNow to create a MODFLOW -USG simulation using the procedure show in section 6.2. \n1. Right -click on \u201c ugrid (2) \u201d and select Rename .  \n2. Enter \u201cquadtree \u201d and press Enter  to set the new name . \n3. Right -click on \u201c quadtree \u201d and select New MODFLOW \u2026 to bring up the \nMODFLOW Global/Basic Package  dialog.  \n4. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n5. Right -click on \u201c Layers \u201d and select Interpolate to | MODFLOW Layers  to bring \nup the Interpolate to MODFLOW Layers  dialog.  \n6. Click OK to close the Interpolate to MODFLOW Layers  dialog.  \n7. Right -click on \u201c  BigVal \u201d and select Map to | MODFLOW/MODPATH  to bring up \nthe Map \u2192 Model  dialog.  \n8. Click OK to accept the defaults and close the Map \u2192 Model  dialog. This process \nmay take a few moments.  \n9. Right -click on \u201c  MODFLOW \u201d under \u201c  quadtree\u201d  and select Observations \u2026 \nto bring up the MODFLOW -USG Observations  dialog.  \n10. Click Generate PEST Obs. Data \u2026 to bring up the Generate Observations  \ndialog.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Calibration  \n \n Page 14 of 14 \u00a9 Aquaveo 2024  11. Click OK to exit the Generate Observations  dialog.  \n12. Click OK to exit the MODF LOW -USG Observations  dialog.  \n7.3 Saving and Running MODFLOW -USG  \nNow to run MODFLOW using the quadtree UGrid:  \n1. Save   the project.  \n2. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n3. When the model finishes, turn on Read solution on exit  and Turn o n contours (if \nnot on already) . \n4. Click Close  to exit the MODFLOW  model wrapper dialog.  \n5. Select \u201c Observation Wells \u201d to make the observation targets visible.  \nNotice the observation targets are similar to the original model. Feel free to compare the \nmodel err or of the three MODFLOW -USG simulations.  \n8 Conclusion  \nThis concludes the \u201c MODFLOW -USG \u2013 Calibration \u201d tutorial. The following key concepts \nwere discussed and demonstrated in this tutorial:  \n\uf0b7 PEST utilities are used to calculate model computed values at observations.  \n\uf0b7 Use the conceptual model tools in GMS to generate observation data for \nMODFLOW -USG.  \n9 References  \n\uf0b7 Panday, Sorab ; Langevin, C.D. ; Niswonger, R.G. ; Ibaraki, Motomu ; and Hughes, \nJ.D. (2013 ). \u201cMODFLOW \u2013USG version 1: An Unstructured Grid Version of \nMODFLOW for Simulating Groundwater Flow and Tightly Coupled Processes \nUsing a Control Volume Finite -Difference Formulation \u201d. U.S. Geological Survey, \nTechniques and Methods 6 \u2013A45. http://pubs.usg s.gov/tm/06/a45/pdf/tm6 -\nA45.pdf .  \n\uf0b7 Doherty, John.  (January 2014).  Groundwater Data Utilities: Part C: Programs \nWritten for Unstructured Grid Models. Watermark Numerical Computing.  \n \n\n", "filename": "MODFLOW-USG-Calibration.pdf", "pages": 14}, "MODFLOW-USG-CLNObservations": {"text": "GMS Tutorials   MODFLOW -USG  \u2013 CLN Observations  \n Page 1 of 11 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW -USG  \u2013 CLN Observation Wells  \nCreate CLN well observations in GMS  \nObjectives   \nLearn how to create CLN well observations  using MODFLOW -USG and GMS . \nPrerequisite Tutorials  \n\uf0b7 MODFLOW -USG CLN \nProcess  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW -USG Model & \nInterface  \n Time  \n\uf0b7 20\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW -USG  \u2013 CLN Observations  \n Page 2 of 11 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Description of Problem  ................................ ................................ ................................ . 2 \n1.2 Outline  ................................ ................................ ................................ ..........................  3 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n3 Creating the CLN Well  ................................ ................................ ................................ .........  4 \n4 Creating the Observation Point  ................................ ................................ ..........................  6 \n5 Map to MODFLOW  ................................ ................................ ................................ ...............  7 \n6 Review Model Inputs  ................................ ................................ ................................ ...........  7 \n6.1 CLN WEL package  ................................ ................................ ................................ ....... 7 \n6.2 CLN \u2013 Connected Linear Network  ................................ ................................ ................  8 \n6.3 Observations ................................ ................................ ................................ .................  9 \n7 Saving and Running MODFLOW  ................................ ................................ ........................  9 \n8 Examining the Results  ................................ ................................ ................................ ...... 10 \n9 Changing the Observation or Well Name  ................................ ................................ ........  10 \n10 Conclusion  ................................ ................................ ................................ .........................  11 \n \n1 Introduction  \nHead observations for CLN (Connected Linear Network) wells can be created to measure \nthe computed head in a CLN node (cell). The process is similar to creating head \nobservations in the groundwater domain, but with some key differences.  \nCreating a CLN observation well requires two steps:  \n1. Create a CLN well that is non -pumping  \n2. Create an observation point that is linked to the CLN well and will be used by \nPEST to determine the head at the point.  \nAn observation can be as sociated with a CLN well that is pumping (if you wanted to know \nthe draw down at that well), but in general observation wells are not pumped.  \n1.1 Description of Problem  \nThe problem in this tutorial is the same simulation ( Figure 1) described in the \nMODFLOW -USG CLN Process  tutorial, but with simplified stress periods.  \nThe system consists of two aquifers that are separated by a 50 -foot-thick confining unit.  \nIn addition to th e simulation of two multi -node wells (wells A and B)  modeled using the \nCLN process , there are 15 other single -node wells modeled using the WEL package.1 \n \n                                                      \n1 K.J. Halford and R.T. Hanson. (2002). User Guide for the Drawdown -Limited, Multi -Node Well \n(MNW) Package for the U.S. Geological Survey\u2019s Modular Three -Dimensional Finite Difference \nGround -Water Flow Model, Vers ions MODFLOW -96 and MODFLOW -2000. Open -File Report 02 -\n293, pp15 \u201317. https://water.usgs.gov/nrp/gwsoftware/modflow2000/MNW_text.pdf.  \nGMS Tutorials   MODFLOW -USG  \u2013 CLN Observations  \n \n Page 3 of 11 \u00a9 Aquaveo 2024    \nFigure 1       Flow model from MNW1 documentation2 \n1.2 Outline  \nThis tutorial  will demonstrate the following topics:  \n1. Opening an existing simulation that uses the CLN package.  \n2. Adding a CLN well and an observation point to the simulation using a \nconceptual model.  \n3. Running the simulation and examining the results.  \n2 Getting Started  \nDo th e following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n3. Click Open   (or File | Open \u2026) to bring up the Open  dialog.  \n4. Browse to the ClnObservation  directory and select \u201cstart.gpr\u201d.  \n5. Click Open  to import the file and close the Open  dialog.  \n                                                      \n2 Ibid, p.16.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 CLN Observations  \n \n Page 4 of 11 \u00a9 Aquaveo 2024   \n      Figure 2      Imported CLN process example  \nThe Graphics Window should appear as in Figure 2. This model has well, drain, and \nchanging head (CHD) sources/sinks. In addition, the orange symbols in the upper left and \nright are the CLN nodes represented by Well -A and Well -B. \nBefore continui ng, save the project with a new name.  \n6. Select File | Save As\u2026  to bring up the Save As  dialog.  \n7. Browse to the ClnObservations  directory.  \n8. Enter \u201cClnObservations.gpr\u201d as the File name . \n9. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n10. Click Save  to save the project file and close the Save As  dialog.  \n3 Creating the CLN Well \nThe first step is to create a non -pumping CLN well. The well will be created in the middle \nof the model (approximately).  \n1. In the Project Explorer, right -click on \u201c  CLN wells\u201d and s elect Attribute \nTable\u2026  to open the Attribute Table  dialog for this cover age. \n2. Turn on Show coordinates . \n3. Change the BC type  to \u201cANY/NONE\u201d.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 CLN Observations  \n \n Page 5 of 11 \u00a9 Aquaveo 2024  4. The last row is blank. In the last row, enter the values on Table 1 below to \ncreate the observation well ( Figure 3): \nName  Obs1  \nX 16700  \nY 26300  \nZ 0 \nType  well (CLN)  \nFlow rate  0 \nUse screen  \uf0fe (on)  \nTop scr.  500 \nBot scr.  0 \nIFLIN  \uf0a8 (off)  \nIFCON  Thiem with skin (1)  \nFSKIN  1 \nFANISO  1 \nFRAD  0.5 \nCONDUITK  43100000  \nTable 1    Observation well  \n \nFigure 3      Observation well created using the Attribute Table dialog  \n5. Click OK to close the Attribute Table  dialog.  \nA new well should appear in approximately the middle of the model. When a CLN well is \ncreated in the MODFLOW model, after mapping the coverage to MODFLOW, two things \noccur:  \n\uf0b7 CLN cells are created that are connected to the 3D groundwater cells  \n\uf0b7 A well is created in the lowest CLN cell  \nIn this case a well screen from 500.0 to 0.0 will result in 2 CLN cells, one CLN cell for \neach layer in the grid and t he CLN well will be placed in the CLN cell associated with \nlayer 2.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 CLN Observations  \n \n Page 6 of 11 \u00a9 Aquaveo 2024  4 Creating the Observation Point  \nThe second step is to create the observation point that will be associated with the CLN \ncell where the CLN well \u201cObs1\u201d is located. The observation point will  be \u201clinked\u201d to the \nCLN cell by being in the same groundwater cell and by having the same name as the \nCLN well (in this case \u201cObs1\u201d). The observation point does not need to be in the exact \nsame location as the CLN well, but it can be. The computed head for  this observation \npoint will be the head in the CLN cell, not the groundwater cell nor the location of the \nobservation point.  \n1. Right -click on \u201c  CLN\u201d in the Project Explorer  and select New Coverage\u2026  to \nbring up the Coverage Setup  dialog.  \n2. Enter \u201cObservations \u201d for the Coverage name . \n3. In the Observation Points  section, turn on \u201cTrans. Head\u201d.  \n4. Click OK to close the Coverage Setup  dialog.  \nA new \u201c  Observations\u201d coverage will appear in the Project Explorer.  \n5. In the Project Explorer, right -click on \u201c  Observations\u201d a nd select Attribute \nTable  to open the Attributes Table  dialog for the coverage.  \n6. Turn on Show coordinates . \n7. In the blank row, enter the values found in Table 2 below:  \nName  Obs1  \nX 15800  \nY 25800  \nZ 0 \nType  obs.pt  \nTable 2    Observation point  \n \nFigure 4      Observation well created using the Attribute Table dialog  \n8. Click the   button in the Obs. Trans. Head  column to open the XY Series \nEditor . \n9. Enter the values in Table 3 below : \n \n\nGMS Tutorials   MODFLOW -USG  \u2013 CLN Observations  \n \n Page 7 of 11 \u00a9 Aquaveo 2024  Time (d)  Obs. Trans. Head  \n10 152 \n500 148 \n900 159 \nTable 3      XY series values  \n \nFigure 5      XY Series of the observed head values over time  \n10. Click OK to exit the XY Series Editor  dialog.  \n11. Change the Obs. Trans. Head Interval  to \u201c2.0\u201d.  \n12. Leave the remaining fields at the default values an d click OK to exit the \nAttribute Table  dialog.  \n5 Map to MODFLOW  \nThe data added in the conceptual model needs to be mapped to the grid model.  \n1. Right -click on the \u201c  CLN\u201d conceptual model and select Map To | \nMODFLOW/MODPATH  to open the Map \u2192 Model  dialog.  \n2. Check All applicable coverages and click OK to close the Map \u2192 Model  dialog.  \n6 Review Model Inputs  \nThe values mapped to the MODFLOW -USG simulation can now be viewed.  \n6.1 CLN WEL package  \n1. Select MODFLOW | Optional Packages  | CLN WEL \u2013 CLN Well\u2026  to bring up \nthe MOD FLOW CLN Wells Package  dialog.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 CLN Observations  \n \n Page 8 of 11 \u00a9 Aquaveo 2024   \nFigure 6      CLN Wells Package dialog  \nNotice the new Obs1 well appears and has a pumping rate of zero.  \n2. Click OK to close MODFLOW CLN Wells Package  dialog.  \n6.2 CLN \u2013 Connected Linear Network  \n1. Select MODF LOW | Optional Packages  | CLN \u2013 Connected Linear \nNetwork\u2026  to bring up the CLN Process  dialog.  \n2. Select \u201cSegmentNodes\u201d from the list on the left. A table will appear to the right \nof the list.  \nThe CLN process contains nodes that can be connected together. For this simulation \nthere are three CLN wells, and each well consists of two nodes. Each well has a unique \nClnSegmentId , and each node has a unique IFNO  value. Well -A is made up of the two \nnodes wit h a ClnSegmentId  of \u201c1\u201d, and Well -B is made up of the two nodes with a \nClnSegmentId  of \u201c2\u201d. The new well, Obs1, is made up of the two nodes with a \nClnSegmentId  of \u201c3\u201d.  \n3. Select \u201cNodes\u201d from the list on the left. The table on the right will change to \nshow node information.  \nThis table shows the values for each CLN node.  \n4. Click OK to close the CLN Process  dialog.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 CLN Observations  \n \n Page 9 of 11 \u00a9 Aquaveo 2024   \nFigure 7      CLN Process dialog  \n6.3 Observations  \n1. Select MODFLOW | Observations\u2026  to bring up the MODFLOW -USG  \nObservations  dialog.  \nThe Observations dialog shows the observation data that will be used with PEST utilities. \nNotice with \u201cWells\u201d selected on the left, there is one well listed, the Obs1 well.  \n2. Select \u201cCln Well To Node\u201d from the list on the left.  \nNotice there is one well listed, t he Obs1 well, and the Node ID  is the CLN node ID (6).  \n3. Select \u201cCln Well Sample\u201d from the list on the left.  \nNotice the times and head observations are listed in the table.  \n4. Click OK to close the MODFLOW -USG Observations  dialog  \n7 Saving and Running MODFLOW  \nThe c hanges should now be saved before running MODFLOW.  \n1. Click Save   to save the project.  \n2. Click the Run MODFLOW   macro in the toolbar to bring up the MODFLOW  \nmodel wrapper dialog.  \n3. When MODFLOW finishes, check the Read solution on exit  and Turn on \ncontours (if not on already)  boxes.  \n4. Click Close  to close the MODFLOW  model wrapper dialog.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 CLN Observations  \n \n Page 10 of 11 \u00a9 Aquaveo 2024  5. Click Save   to save the project with the new solution.  \nThe simulation should now appear as shown in Figure 8. \n \n      Figure 8      Solution with CLN observation well  \n8 Examining the Results  \nExamine the solution and compare it to the solution using the MNW2 package.  \n1. If necessary, expand the \u201c  ClnObservations  (MODFLOW)\u201d item in the  \nProject Explorer.  \n2. In the \u201c  ClnObservations (MODFLOW)\u201d folder select the \u201c  Head\u201d dataset.  \n3. In the Time Steps  window, use the down arrow key to step through the time \nsteps and watch how the contours and the calibration target changes . \n9 Changing the Observation or Well Name  \nTo illustrate that the observation point name and the CLN well name must match for the \nobservation to be linked to the CLN well:  \n1. In the Project Explorer, right -click on \u201c  Observations\u201d and select Attribute \nTable  to open the Attribute Table  dialog for the coverage.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 CLN Observations  \n \n Page 11 of 11 \u00a9 Aquaveo 2024  2. Change the Name  to \u201cObs2\u201d.  \n3. Click OK to close the Attribute Table  dialog.  \nNotice that GMS provides a warning that the link between the observation point and the \nCLN well will be broken.  \n4. Click Accept Changes  to close the warning dialog.  \n10 Conclusion  \nThis concludes the tutorial. Here are the key concepts from this tutorial:  \n\uf0b7 Head observations can be associated with CLN Wells.  \n\uf0b7 An observation point is \u201clinked\u201d to a CLN Well by being in the same 3D grid cell \nas the CLN Well and by having the same name.  \n \n", "filename": "MODFLOW-USG-CLNObservations.pdf", "pages": 11}, "MODFLOW-USG-CLNProcess": {"text": "GMS Tutorials   MODFLOW -USG  \u2013 CLN Process  \n Page 1 of 10 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW -USG  \u2013 CLN Process  \nCreate CLN process with MODFLOW -USG  in GMS  \nObjectives   \nLearn how to use the CLN process in GMS using the conceptual model interface to create multi -layer \nwells . \nPrerequisite Tutorials  \n\uf0b7 MODFLOW  \u2013 Managing \nTransient Data  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 30\u201345 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW -USG  \u2013 CLN Process  \n Page 2 of 10 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Description of Problem  ................................ ................................ ................................ . 2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n3 Creating the Conceptual Model  ................................ ................................ ..........................  5 \n4 Importing the Well Data  ................................ ................................ ................................ ....... 5 \n5 Setting the CLN Map Data  ................................ ................................ ................................ ... 6 \n6 Mapping the CLN Wells  ................................ ................................ ................................ ....... 6 \n7 Saving and Running MODFLOW  ................................ ................................ ........................  8 \n8 Examining the Results  ................................ ................................ ................................ ........  8 \n9 Conclusion  ................................ ................................ ................................ .........................  10 \n \n1 Introduction  \nThe Connected Linear Network (CLN) process was developed for MODFLOW -USG to \nmodel one -dimensional connected features that are much smaller than a groundwater \nflow model\u2019s cells.1 For MODFLOW -USG, the CLN process can be used to replace wells \nthat would use the MNW1 or MNW2 package in other versions of MODFLOW.  \nThis tutorial demons trates how to use multi -node wells with MODFLOW -USG. An existing \nsimulation that uses the MNW2 package will be opened. That simulation will be changed \nto use MODFLOW -USG. CLN wells will be added using a conceptual model. The new \nsimulation will then be run  and the results will be examined.  \n1.1 Description of Problem  \nThe problem in this tutorial is the same simulation ( Figure 1) described in the MNW1 \ndocumentation as follows : \nThe system consists of two aquifers that are separated by a 50 -foot-\nthick confining unit. The upper aquifer is unconfined, has a hydraulic \nconductivity of 60 ft/d, and has a uniform base of 50 ft above the \ndatum. The lower aquifer is confined and has a t ransmissivity of \n15,000 ft2/d. Storage coefficients of 0.05 and 0.0001 were assigned \nto layers 1 and 2, respectively. The 66 -mi2 area of the test problem \nwas divided into  21 rows of 14 columns. Uniform  square cells that \nmeasured 2,500 ft on a side were use d throughout the simulated \narea. Specified heads and drains are assigned in layer 1 and are \nmaintained at the same elevations for all stress periods . \nA period of 1,000,970 days was simulated with 5 stress periods. The \nfirst two stress periods simulated ste ady-state conditions, which were \nachieved by having each stress period be 500,000 days long. \nRecharge during stress periods 1 and 2 was a uniform 7 inches per \nyear (in./yr). No pumpage was extracted during stress period 1 but \nmulti -node wells were simulate d. About 950,000 ft3/d of pumpage \nwas extracted during stress period 2; this is about 35 percent of the \ntotal volumetric budget. Transient conditions were simulated during \nstress periods 3, 4, and 5, which were periods of 60, 180, and 730 \ndays, respectivel y. Uniform recharge rates of 2, 0, and 12 in./yr, \n                                                      \n1 Panday, Sorab , Langevin, C.D., Niswonger, R.G., Ibaraki, Motomu, and Hughes, J.D. (2013). \nMODFLOW \u2013USG version 1: An unstructured grid version of MODFLOW for simulating \ngroundwater flow and tightly coupled processes using a control volume finite -difference formulation: \nU.S. Geological Survey Techniques and Methods. Book 6, chap. A45, 66 p., \nhttp://pubs.usgs.gov/tm/06/a45.  \nGMS Tutorials   MODFLOW -USG  \u2013 CLN Process  \n \n Page 3 of 10 \u00a9 Aquaveo 2024  respectively, were applied during stress periods 3, 4, and 5. In \naddition to the simulation of two multi -node wells (wells A and B), \nthere are 15 other single -node wells that have a combined discharge \nof 93 5,350 ft3/d for stress periods 2 through 5 .2 \nFor this tutorial, the single cell wells will be modeled using the WEL package, and the \nmulti -cell wells (Well -A and Well -B) will be modeled using the CLN package.  \n  \nFigure 1       Flow model from MNW1 documentation3 \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n3. Click Open   (or File | Open \u2026) to bring up the Open  dialog.  \n4. Browse to the ClnP rocess  directory and select \u201cmnw2.gpr\u201d.  \n5. Click Open  to import the file and close the Open  dialog.  \n                                                      \n2 K.J. Halford and R.T. Hanson. (2002). User Guide for the Drawdown -Limited, Multi -Node Well \n(MNW) Package for the U.S. Geological Survey\u2019s Modular Thr ee-Dimensional Finite Difference \nGround -Water Flow Model, Versions MODFLOW -96 and MODFLOW -2000. Open -File Report 02 -\n293, pp15 \u201317. https://water.usgs.gov/nrp/gwsoftware/modflow2000/MNW_text.pdf.  \n3 Ibid, p.16.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 CLN Process  \n \n Page 4 of 10 \u00a9 Aquaveo 2024  The Graphics Window should appear as in Figure 2. Purple diamond -shaped symbols \nrepresenting the specified head boundary conditions appear along the right column of the \ngrid. Wells are represented by yellow squares grouped mostly in the top half. The drain \npackage b oundary conditions are represented by the row of green circles near the center \nof the grid.  \n \n      Figure 2      Imported CLN package example  \nIn order to use the CLN process, MODFLOW -USG needs to be used.  \n6. Select MODFLOW  | Global O ptions  to bring up the MODFLOW Global/Basic \nPackage  dialog.  \n7. In the MODFLOW version  section, select the USG  radio button.  \n8. Click OK to close the MODFLOW Global/Basic Package  dialog.  \n9. An alert will appear, advising that MODFLOW -USG doesn\u2019t support the MNW2 \npackage. Click Yes to turn off the package and continue.  \n10. An alert will appear, stating that MODFLOW -USG only supports the SMS solver, \nand the solver has been switched to that one. Cli ck OK to continue.  \nBefore making any further changes, save the project with a new name.  \n11. Select File | Save As\u2026  to bring up the Save As  dialog.  \n12. Browse to the Tutorials \\MODFLOW -USG \\ClnP rocess  directory.  \n13. Enter \u201cCLNwells.gpr\u201d as the File name . \n14. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n15. Click Save  to save the project file and close the Save As  dialog.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 CLN Process  \n \n Page 5 of 10 \u00a9 Aquaveo 2024  3 Creating the Conceptual Model  \nNow create a conceptual model and coverage for the CLN wells by doing the following:  \n1. Right -click on an empty spo t in the Project Explorer and select New | \nConceptual Model \u2026 to bring up the Conceptual Model Properties  dialog.  \n2. Enter \u201cCLN\u201d as the Name . \n3. Select \u201cMODFLOW\u201d from the Type  drop-down.  \n4. Select \u201cBCF\u201d from the Flow package  drop-down.  \n5. Click OK to close the Concept ual Model Properties  dialog.  \nA new \u201c  CLN\u201d conceptual model should appear under \u201c  Map Data\u201d in the Project \nExplorer . \n6. Right -click on \u201c  CLN\u201d in the Project Explorer  and select New coverage\u2026  to \nbring up the Coverage Setup  dialog.  \n7. Enter \u201cCLN wells\u201d for the Coverage name . \n8. In the Sources/Sinks/BCs  section, turn on \u201cWells\u201d and \u201cWells (CLN)\u201d.  \n9. Set the Default layer range  to go from \u201c 1\u201d to \u201c2\u201d. \n10. Click OK to close the Coverage Setup  dialog.  \nA new \u201c  CLN wells\u201d coverage will appear in the Project Explorer.  \n4 Importing  the Well Data  \nNow import the well data that contains the well locations and the well screen elevations \nby doing the following:  \n1. Select File | Open \u2026 to bring up the Open  dialog.  \n2. Select \u201cText Files (*.txt; *.csv)\u201d from the Files of type  drop-down.  \n3. Select \u201cwe lls.txt\u201d and click Open  to close the Open  dialog and bring up the Text \nImport Wizard \u2013 Step 1 of 2  dialog.  \n4. Below the File import options  section, turn on Heading row  and click Next  to go \nfrom the Text Import Wizard \u2013 Step 1 of 2  dialog page to the Step 2 of 2 dialog \npage.  \n5. Select \u201cWell data\u201d from the GMS data type  drop-down.  \nThe type row in the File preview  section should fill with Name , X, Y, Screen Top , and \nScreen Bottom  data from the imported file.  \n6. Click on Finish  to import the well data and close the Text Import Wizard \u2013 Step 2 \nof 2 dialog.  \nWells should appear near the end and beginning of the third row from the top in the \nGraphics Window. Now to go through the same process to import the pumping data:  \n7. Select File | Open \u2026 to bring up the Open  dialog.  \n8. Select \u201cText Files (*.txt; *.csv)\u201d from the Files of type  drop-down.  \n9. Select \u201cpumping.txt\u201d and click Open  to close the Open  dialog and bring up the \nText Import Wizard \u2013 Step 1 of 2  dialog.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 CLN Process  \n \n Page 6 of 10 \u00a9 Aquaveo 2024  10. Below the File import options  section, turn on Heading row  and click Next to go \nfrom the Text Import Wizard \u2013 Step 1 of 2  dialog page to the Step 2 of 2 dialog \npage.  \n11. Select \u201cPumping data\u201d from the GMS data type  drop-down.  \n12. Click Finish  to import the pumping data and close the Text Import Wizard \u2013 Step \n2 of 2 dialog.  \n13. An alert will appear asking if the time series should be a step function. Click Yes \nto continue.  \n5 Setting the CLN Map Data  \nThe well data has been imported with the \u201cWells\u201d boundary condition type. To change the \ntype to \u201cWells (CLN)\u201d and enter some addition al data:  \n1. Right -click on the \u201c  CLN wells\u201d coverage and select Attribute Table\u2026  to bring \nup the Attribute Table  dialog.  \n2. Using the All row, set the following (scrolling to the right as needed):  \n\uf0b7 Select \u201cwell (CLN)\u201d from the Type  column drop -down.  \n\uf0b7 Select \u201cThie m with skin (1)\u201d from the IFCON  column drop -down.  \n\uf0b7 Enter \u201c1.0\u201d in the FSKIN  column.  \n\uf0b7 Enter \u201c1.0\u201d in the FANISO  column.  \n\uf0b7 Enter \u201c0.5\u201d in the FRAD  column.  \n\uf0b7 Enter \u201c4.31e7\u201d in the CONDUITK  column. The display will change this to \n\u201c43100000.0\u201d.  \n3. Click OK to exit the Attribute Table  dialog.  \n6 Mapping the CLN Wells  \nThe CLN wells in the conceptual model should now be mapped to the MODFLOW \nsimulation.  \n1. Right -click on the \u201c  CLN wells\u201d coverage and select Map To | \nMODFLOW/MODPATH . The CLN wells should now be mapped to the \nMODFLOW model.  \n2. Uncheck the \u201c  CLN wells\u201d coverage in the Project Explorer . \nThe two outer wells in the third row should now be orange. The two inner wells on the \nthird row should remain yellow (Figure 3). The values mapped to the MODFLOW -USG \nsimulation can now be viewed.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 CLN Process  \n \n Page 7 of 10 \u00a9 Aquaveo 2024   \n      Figure 3      Mapped CLN wells  are in orange, unmapped wells are in yellow  \n3. Select MODFLOW | Optional Packages  | CLN \u2013 Connected Linear Network \u2026 \nto bring up the CLN Process  dialog.  \n4. Select \u201cSegment Nodes\u201d from the list on the left. A table will appear to the right of \nthe list.  \nThe CLN process contains nodes that can be connected together. For this simulation \nthere are two CLN wells, and each well consists of two nodes. Each well has a unique \nClnSegmentId , and ea ch node has a unique IFNO  value. Well -A is made up of the two \nnodes wit h a ClnSegmentId  of 1, and Well -B is made up of the two nodes with a \nClnSegmentId  of 2. \n5. Select \u201cNodes\u201d from the list on the left. The table on the right will change to show \nnode informa tion. \nThis table shows the values for each CLN node. In the MNW2 simulation, Well -A is active \nduring the first stress period, but isn\u2019t pumping. When the well is active but not pumping, \nthe well connection between the two layers allows flow between them.  \nWhen mapping multi -cell wells to MODFLOW in GMS, by default they don\u2019t become \nactive until the stress period where pumping begins. To make Well -A active in the first \nstress period, change the IBOUND  value for its nodes.  \n6. In the rows with IFNO  values of \u201c1\u201d and \u201c2,\u201d enter \u201c1\u201d in the IBOUND  column \n(scroll to the right as needed).  \n7. Select \u201cGroundwater Connections\u201d from the list on the left.  \nThe table on the right will change to show the connections between the CLN process and \nnodes and the groundwater process ce lls. The IGWNOD  column contains the cell ID of \nthe connected groundwater node.  \n8. Select \u201cConduit Types\u201d from the list on the left.  \nThis table shows the conduit types generated for each CLN node and the associated \nmapped values for FRAD  and CONDUITK  previousl y entered in the Map module.  \n9. Select \u201cTransient IBOUND\u201d from the list on the left.  \nThis table can be edited when cells become active and inactive. The nodes for Well -A \nhave been changed to be active from the beginning of the simulation. There are currently \nno entries in this table.  \n10. Click OK to close the CLN Process  dialog.  \n11. Select MODFLOW | Optional Packages  | CLN WEL  \u2013 CLN Well  to bring up the \nMODFLOW CLN Wells Package  dialog.  \nThis dialog shows the wells for the CLN process along with the associated flow rat es for \nthe different stress periods. The Cell ID  column toward the left is the CLN node ID (or \nIFNO). GMS has moved the CLN wells into their own dialog, but the well data for all wells \nwill be saved out as one wells file for the model run.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 CLN Process  \n \n Page 8 of 10 \u00a9 Aquaveo 2024  12. Click OK to clos e the MODFLOW CLN Wells Package  dialog.  \n7 Saving and Running MODFLOW  \nThe changes should now be saved before running MODFLOW.  \n1. Click Save   to save the project.  \n2. Click the Run MODFLOW   macro in the toolbar to bring up the MODFLOW  \nmodel wrapper dialog.  \n3. When MODFLOW finishes, check the Read solution on exit  and Turn on \ncontours (if not on already)  boxes.  \n4. Click Close  to close the MODFLOW  model wrapper dialog.  \n5. Click Save   to save the project with the new solution.  \nThe simulation should now appear similar t o Figure 4. \n \n      Figure 4      Solution with CLN wells  \n8 Examining the Results  \nExamine the solution and compare it to the solution using the  MNW2 package.  \n1. If necessary, expand the \u201c  CLNwells (MODFLOW)\u201d item in the  Project \nExplorer.  \n2. In the \u201c  CLNwells (MODFLOW)\u201d folder select the \u201c  Head\u201d dataset.  \n3. In the Time Steps  window select the last time step (step 110).  \n\nGMS Tutorials   MODFLOW -USG  \u2013 CLN Process  \n \n Page 9 of 10 \u00a9 Aquaveo 2024  4. If necessary, expand the \u201c  mnw2 ( MODFLOW)\u201d item in the Project Explorer.  \n5. In the \u201c  mnw2 (MODFLOW)\u201d folder select the \u201c  Head\u201d dataset.  \n6. In the Time Steps  window select the last time step (step 110).  \nIn changing between the MNW2 head dataset and the CLN head dataset, notice the \nslight difference between the head values. The difference in drawdown can also be seen \nwhen switching between the \u201cDrawDown\u201d datasets in the solution folders.  \nTo get a more accurate comparison of the two solutions, use the Data Calculator  to \ncalculate the differe nce in the head values for the last stress period.  \n7. Select Edit | Data set Calculator \u2026 to bring up the Data Calculator  dialog.  \n8. Expand the \u201cCLNwells (MODFLOW)\u201d folder and select the \u201cHead\u201d dataset.  \n9. Scroll the Time steps  list to the last time step (110) and cl ick on it to select it.  \n10. Double -click on the \u201cHead\u201d dataset under \u201cCLNwells (MODFLOW)\u201d. The dataset \nlabel with the time step (\u201cd5:110\u201d) should be added to the Expression  field.  \n11. Click on subtract  - to enter it in the Expression  field.  \n12. Expand the \u201cmnw2 (MODFL OW)\u201d folder and select the \u201cHead\u201d dataset.  \n13. Scroll the Time steps  list to the last time step (110) and click on it to select it.  \n14. Double -click on the \u201cHead\u201d dataset under \u201cmnw2 (MODFLOW)\u201d. The dataset \nlabel with time step (\u201cd3:110\u201d) should be added to the Expression  field.  \nThe Expression  field should now be \u201cd5:110 \u2013 d3:110\u201d.  \n15. Enter \u201cdifference\u201d in the Result  field and click on Compute . \n16. Click on the Done  button to exit the Data Calculator  dialog.  \nA newly calculated \u201c  difference\u201d dataset should appear in the Project Explorer giving  \nthe difference in the head values for each cell. The maximum difference value should be \napproximately -0.6 ft near the upper left corner of the grid ( Figure 5). \n \n      Figure 5      Final result, showing the difference in Head values  \n  \n\nGMS Tutorials   MODFLOW -USG  \u2013 CLN Process  \n \n Page 10 of 10 \u00a9 Aquaveo 2024  9 Conclusion  \nThis concludes the tutorial. Here are the key concepts from this tutorial:  \n\uf0b7 GMS has the ability to create multi -cell wells using the CLN Process with the \nMap module.  \n\uf0b7 CLN Process values can be edited viewed in the CLN Process  dialog.  \n\uf0b7 CLN well flow rates can be edited and viewed in the CLN Well  dialog. Well data \nis still saved out in the wells package file.  \n \n \n", "filename": "MODFLOW-USG-CLNProcess.pdf", "pages": 10}, "MODFLOW-USG-ComplexStratigraphy": {"text": "GMS Tutorials   MODFLOW -USG \u2013 Complex Stratigraphy  \n Page 1 of 20 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW -USG  \u2013 Complex Stratigraphy  \nCreate a MODFLOW -USG model of a site with complex 3D \nstratigraphy using GMS  \nObjectives   \nGMS supports building MODFLOW -USG models with multiple types of unstructured grids. This tutorial \nshows how to generate 3D unstructured grids of complex stratigraphy . \nPrerequisite Tutorials  \n\uf0b7 Stratigraphy Modeling \u2013 \nHorizons and Solids  \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach I  \n\uf0b7 UGrid Creation  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 Subsurface  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 30\u201350 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW -USG \u2013 Complex Stratigraphy  \n Page 2 of 20 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Description of Problem  ................................ ................................ ................................ . 4 \n2 Getting Started  ................................ ................................ ................................ .....................  5 \n2.1 Open the Starting Project  ................................ ................................ .............................  5 \n2.2 Save with a Different Name  ................................ ................................ ..........................  6 \n3 Quadtree UGrids  ................................ ................................ ................................ ..................  6 \n3.1 Create a  2D Quadtree UGrid  ................................ ................................ ........................  6 \n3.2 Create and View a 3D Quadtree UGrid  ................................ ................................ ........  8 \n3.3 Create a MODFLOW -USG Model  ................................ ................................ ...............  10 \n3.4 Map to MODFLOW  ................................ ................................ ................................ ..... 11 \n3.5 Save and Run MODFLOW  ................................ ................................ .........................  11 \n4 Voronoi UGrids  ................................ ................................ ................................ ..................  12 \n4.1 Create the 2D Voronoi UGrid  ................................ ................................ ......................  12 \n4.2 Create a 3D Voronoi UGrid  ................................ ................................ .........................  13 \n4.3 Create a MODFLOW -USG Model  ................................ ................................ ...............  14 \n4.4 Map to MODFLOW  ................................ ................................ ................................ ..... 14 \n4.5 Save and Run MODFLOW  ................................ ................................ .........................  15 \n5 VTK Unstructured Grids  ................................ ................................ ................................ .... 16 \n5.1 Import the VTK Unstructured Grid File  ................................ ................................ ........  16 \n5.2 Create a 3D UGrid  ................................ ................................ ................................ ...... 17 \n5.3 Create a MODFLOW -USG Model  ................................ ................................ ...............  18 \n5.4 Map to MODFLOW  ................................ ................................ ................................ ..... 18 \n5.5 Save and Run MODFLOW  ................................ ................................ .........................  19 \n6 Conclusion  ................................ ................................ ................................ .........................  20 \n \n1 Introduction  \nMODFLOW -USG (for UnStructured  Grid), was developed to support a wide variety of \nstructured and unstructured grid types, including nested grids and grids based on \nprismatic triangles, rectangles, hexagons, and other cell shapes. Flexibility in grid design \ncan be used, for example, to f ocus resolution along rivers and around wells  or to \nsubdiscretize individual layers to better represent hydrostratigraphic units.   \nAn extremely powerful feature is MODFLOW -USG\u2019s subdiscretization capability to better \nrepresent hydrostratigraphic  units. Traditional MODFLOW requires that grid layers be \ncontinuous throughout the model domain even if the particular stratigraphic unit ends or \npinches out (see Figure 1). \n \n      Figure 1      MODFLOW 2000 finite difference grid with pinching layer  \n\nGMS Tutorials   MODFLOW -USG \u2013 Complex Stratigraphy  \n \n Page 3 of 20 \u00a9 Aquaveo 2024  With MODFLOW -USG, the grid layer can simply end. Figure 2 shows examples of \ncomplex gridding from the MODFLOW -USG documentation.1 \n \n      Figure 2      Complex stratigraphy examples  \nAs seen from the figures, MODFLOW -USG allows layers to be discontinuous or even \noffset from one another. Figure 3 shows the same model as in Figure 1, created instead \nusing a MODFLOW -USG compatible UGrid. Notice how the pinching layer is \ndiscontinuous and stops upon reaching a minimum thickness.  \n \n      Figure 3      Example of a UGrid with pinching layer  \nThis tutorial focuses on using the horizons approach in GMS to generate a 3D \nunstructured grid for complex stratigraphy. Using GMS, complex 3D unstructured grids \n                                                      \n1 Panday, Sorab; Lan gevin, Christian.D.; Niswonger, Richard G.; Ibaraki, Motomu; and Hughes, \nJoseph D., (2013). \u201cMODFLOW -USG version 1: An Unstructured Grid Version of MODFLOW for \nSimulating Groundwater Flow and Tightly Coupled Processes Using a Control Volume Finite -\nDifferen ce Formulation\u201d in Techniques and Methods 6 \u2013A45,U.S. Geological Survey, pp. 38 \u201339. \nhttps://pubs.usgs.gov/tm/06/a45/pdf/tm6 -A45.pdf . \n\nGMS Tutorials   MODFLOW -USG \u2013 Complex Stratigraphy  \n \n Page 4 of 20 \u00a9 Aquaveo 2024  can be quickly and easily generated from a variety of subsurface data, including \nboreholes, user -defined cross sections, TINs, rasters, and conceptual  models.  \n1.1 Description of Problem  \nThe site to be modeled in this tutorial is a small coastal aquifer with three production \nwells  (Figure 4). The no -flow boundary on the  upper left corresponds to a parallel -flow \nboundary, and the no -flow boundary on the left corresponds to a thinning of the aquifer \ndue to a high bedrock elevation. A stream provides a river boundary condition on the \nlower left, and the remaining boundary i s a coastal boundary simulated with a specified \nhead condition.  \n \n      Figure 4      Site conceptual model  \nA fence diagram of the site is shown in Figure 5. The stratigraphy of the site consists of \nan upper and lower aquifer with minor semi -confining units with significantly lower \nhydraulic properties. The upper aquifer has a hydraulic conductiv ity of 10 feet per day \nand the lower aquifer has a hydraulic conductivity of 30 feet per day. The wells extend to \nthe lower aquifer. The recharge to the aquifer is about one foot per year.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Complex Stratigraphy  \n \n Page 5 of 20 \u00a9 Aquaveo 2024   \n      Figure 5      Fence diagram of sit e\u2019s subsurface  \nThis tutorial will discuss and demonstrate:  \n\uf0b7 Importing an existing GMS project.  \n\uf0b7 Generating 2D and 3D quadtree UGrids (the latter using the horizons method).  \n\uf0b7 Generating 2D and 3D Voronoi UGrids (the latter using the horizons method).  \n\uf0b7 Importin g a VTK unstructured grid file.  \n\uf0b7 Generating a 3D UGrid using the horizons method.  \n\uf0b7 Mapping the model to MODFLOW.  \n\uf0b7 Running a simulation.  \nAs shown above, this tutorial assumes an understanding of how to use the horizons \nmethod to create subsurface models and the conceptual modeling approach for \nassigning MODFLOW model properties. Therefore, the \u201c Stratigraphy Modeling  \u2013 \nHorizons and Solids \u201d and the \u201c MODFLOW  \u2013 USG  \u2013 Quadtree \u201d tutorials should be \ncompleted prior to beginning this tutorial.  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2.1 Open the Starting Project  \nTo open a GMS project that contains the shape files giving the model geometry:  \n1. Click Open   to bring up the Open  dialog . \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Complex Stratigraphy  \n \n Page 6 of 20 \u00a9 Aquaveo 2024  3. Browse to the ComplexStratigraphy \\ComplexStratigraphy \\ directory and select \n\u201cstart.gpr \u201d. \n4. Click Open  to import the project and exit the Open  dialog.  \nThe model should appear similar to Figure 6. \n \n      Figure 6      The imported model  \n2.2 Save w ith a Different Name  \nBefore making any changes, it is advised to save the project under a new name.  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c olele.gpr \u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \nSave   the project periodically throughout the tutorial.  \n3 Quadtree UGrids  \n3.1 Create a 2D Quadtree UGrid  \nThis project already contains a conceptual model of both map data and subsurf ace data. \nTherefore, this tutorial will start by generating the grid.  \n1. Right -click in a blank space in the Project Explorer  and select New | Grid Frame . \n2. Right -click on \u201c  Grid Frame\u201d and select Fit to Active Coverage . \nThis ensures the grid is big enough to include the site.  \n3. Right -click on \u201c  Grid Frame\u201d and select Map To | UGrid  to open the Map \u2192 \nUGrid dialog.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Complex Stratigraphy  \n \n Page 7 of 20 \u00a9 Aquaveo 2024  Now to create a 2D quadtree grid with a base cell size of 500 ft, and refined around the \nwells, the river, and the coastal boundary.  \n4. Select \u201c2D\u201d from the Dimension  drop-down.  \n5. Select \u201c Quadtree/Octree \u201d from the UGrid type  drop-down.  \n6. In both the X-Dimension  and Y-Dimension  sections, select Cell size  as the Cell \nsize method . \n7. Enter \u201c 500.0 \u201d as the Cell Size  in both sections.  \n8. Click OK to close the Map \u2192 UGrid  dialog.   \nThe new 2D UGrid should be similar to that in Figure 7. The large cells in the UGrid have \na cell size of about 500.2  \n9. Zoom   in around the wells, the river, or the coastal boundary to see the \nsmaller cells.  \n10. When done, click the Frame   macro.  \nThe size of the cells around the boundary conditions are specified in the \u201cR efine\u201d  \nattributes of those boundary conditions.3 \n \n      Figure 7      2D quadtree UGrid  \nNow to rename the UGrid that was just created:  \n11. Right -click on  \u201c ugrid \u201d and select Rename .  \n12. Enter \u201c quadtree \u201d and press Enter  to set the new name.  \n                                                      \n2 The size will not be exactly 500 because the grid frame defines the extents of the grid. If the cells \nneed to be exactly 500 feet square, adjust the extents of the grid frame to be a multiple of 500.  \n3 Grid refinement is explained in the \u201cMODFLOW -USG \u2013 Quadtree\u201d tutorial.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Complex Stratigraphy  \n \n Page 8 of 20 \u00a9 Aquaveo 2024  3.2 Create and View a 3D Quadtree UGrid  \nIt is now possible t o use the 2D quadtree UGrid and the subsurface data (boreholes, \ncross sections, and conceptual model) to create a 3D quadtree UGrid. If desired, explore \nthe borehole and cross section data to see the current subsurface conceptual model. In \nthe interest of time, the tutorial will not go through any of the steps to explore the \nsubsurface data.  \n1. Turn off \u201c quadtree\u201d in the Project Explorer  \n2. Select \u201c Borehole Data \u201d in the Project Explorer  to make it active.  \n3. Select Boreholes | Horizons \u2192 UGrid \u2026 to bring up the Horizon Elevations  \npage of the Horizons to UGrid  dialog.  \nThe data and the options used to generate the UGrid are selected here. In the first step \nof the wizard, the subsurface data to be used is specified. In this example, the borehole \ndata, the user -defin ed cross sections, and the conceptual model will be used.  \n4. In the Boreholes  section, turn on Use boreholes  and Use borehole cross \nsections . \n5. In the Conceptual model  section, turn on Use horizons conceptual model . \n6. Click Next  to go to the Top and Bottom Elevat ions page of the  Horizons to UGrid  \ndialog.  \nIn this step, the 2D UGrid to be extruded into a 3D UGrid is selected. Since there is \ncurrently only one UGrid in the project, it is not necessary to change the selected Primary \nUGrid . However, the top and the bot tom of the UGrid will need to be defined. In this case, \nthere is a TIN that defines the ground surface of the site. The bottom of the boreholes will \nbe used for the bottom of the UGrid.  \n7. In the Top elevation  section, select the TIN elevations  option.  \n8. Click Next  to go to the Build UGrid  page of the Horizons to UGrid  dialog.  \nThis page of the dialog allows specifying the interpolation option (this tutorial will use the \ndefault) as well as various m eshing options . The Minimum element thickness  option \nensures tha t all cells/elements in the UGrid have a thickness greater than or equal to the \nspecified minimum.  \n9. In the Meshing options  section, turn on Minimum element thickness  and enter \n\u201c2.0\u201d in the field just below that.  \n10. Click Finish  to exit the Horizons to UGrid  dialog and create the 3D UGrid.  \nThe 3D UGrid generation should complete quickly. Now to rename the new UGrid and \nview it in 3D:  \n11. Right -click on \u201c  quadtree (2) \u201d and select Rename .  \n12. Enter \u201c quadtree -3d\u201d and press  Enter  to set the new name.  \n13. Turn off \u201c Grid Frame\u201d  and \u201c  Map Data\u201d in the Project Explorer . \n14. Switch to Oblique View  . \nThe 3D UGrid should appear similar to Figure 8. \n\nGMS Tutorials   MODFLOW -USG \u2013 Complex Stratigraphy  \n \n Page 9 of 20 \u00a9 Aquaveo 2024   \n      Figure 8      3D quadtree UGrid  \nNow to examine the properties of the newly created UGrid:  \n15. Uncheck \u201c  quadtree \u201d in the Project Explorer  and select \u201c  quadtree -3d\u201d to \nmake it active .  \n16. Right -click on \u201c  quadtree -3d\u201d and select Properties \u2026 to open the UGrid \nProperties  dialog.  \nThis dialog provides information on the extents of the UGrid. This includes the number of \ncells and nodes as well as the type of cells (2D/3D). There will be about 2693 cells and \n5265 nodes.  \n17. Click OK to exit the UGrid Properties  dialog.  \nIt is now possible to view the five different layers of the UGrid. In the previous figure, the \nlight green layer and the brown layer were clearly visible. These are layers 1 and 5 \nrespectively. There are three other layers that are not as easy to see. Use the single  \nlayer viewing option to see the different layers of the UGrid. This option is found near the \ntop of the GMS window.  \n18. Turn on Single layer  in the Mini Grid Toolbar  . \nThe view of the UGrid has now changed and only the cells in layer 1 are visible.  \n19. Change th e Layer  value to \u201c 2\u201d. \nThe view of the UGrid should now look similar the left side of Figure 9. \n\nGMS Tutorials   MODFLOW -USG \u2013 Complex Stratigraphy  \n \n Page 10 of 20 \u00a9 Aquaveo 2024   \n      Figure 9      Layer 2 of 3D quadtree UG rid and side view cells  \nThis layer represents two low permeability lenses at this site. These lenses are disjointed \nfrom one another and they cover only a portion of the modeled site. This is an example of \nhow a 3D UGrid supports discontinuous layers. Note  that all of the cells in this layer have \na thickness of at least two feet (this was part of the input to the Horizons \u2192 UGrid  \ncommand). These lenses do not extend any further because any cells beyond the current \nextent would have had a thickness of less than 2 feet.  \nNotice at the face of the circled cell face on the left side of Figure 9. This face is adjacent \nto another cell face in a different layer, as can be seen in the right side of the figure. The \nadjacent cell outlined in pink is in layer 1, but is adjacent to cells in layers 1, 2, an d 3. \nData regarding cell face adjacency and face areas is written to the DISU package. \nMODFLOW -USG uses the information in the DISU package to allow flow between these \ncells.  \nFeel free to review the other layers  included in the UGrid by changing the Layer  value. \nWhen finished, do the following:  \n20. Turn off Single layer  in the Mini Grid Toolbar . \n21. Switch to Plan View  . \n3.3 Create a MODFLOW -USG Model  \nNow to create the MODFLOW -USG model:  \n1. Select MODFLOW | New Simulation \u2026 to bring up the MODFLOW Global/Basic \nPackage  dialog.  \nNotice in the dialog, under the MODFLOW version  section, that the only version available \nis USG . This is because the MODFLOW simulation is being created on a UGrid. All of the \nother versions of MODFLOW can only be used on a structured 3D grid.  \n2. Click OK to accept the defaults and exit the MODFLOW Global/Basic Package  \ndialog.  \nThe aquifer properties also need to be defined. This example will use materials to assign \naquifer properties.  \n3. Select MODFLOW | LPF \u2013 Layer Property Flow \u2026 to open the LPF Package \ndialog.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Complex Stratigraphy  \n \n Page 11 of 20 \u00a9 Aquaveo 2024  4. In the Layer property entry method  section, select Use material IDs . \n5. Click OK to exit the LPF Package  dialog.  \n3.4 Map to MODFLOW  \nNow to assign the conceptual model values to the MODFLOW model:  \n1. Right -click on the \u201c  MODFLOW \u201d conceptual model  in the Project Explorer  and \nselect Map To  | MODFLOW/MODPATH  to bring up the Map \u2192 Model  dialog.  \n2. Click OK to accept the defaults and close the Map \u2192 Model  dialog.  \nBoundary condition symbols for specified head, rivers, and wells should appear. To see \nthe sy mbols better, it is possible to turn off the cell faces on the UGrid.  \n3. Right -click on \u201c  UGrid Data \u201d and select Display Options \u2026 to bring up the \nDisplay Options  dialog.  \n4. Select \u201cUGrid: quadtree -3d\u201d from the list on the left.  \n5. On the UGrid  tab, turn off Cell f aces . \n6. Click OK to exit the Display Options  dialog.  \nNotice the MODFLOW boundary conditions as shown in Figure 10. The river boundary \n(blue symbols) on the south is assigned only to layer 1 of the UGrid. The coastal, \nspecified head boundary (purple symbols) is assigned to all five layers. The wells were \nassigned to layer 5. If desired, use the single layer viewing op tion to see the boundary \nconditions in particular layers.  \n \n      Figure 10      Quadtree UGrid with MODFLOW boundary conditions  \n3.5 Save and Run MODFLOW  \nNow it is possible to run MODFLOW. At this point, it is a good idea to run the MODFLOW \nModel Checker  to verify there are no obvious errors in the model.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Complex Stratigraphy  \n \n Page 12 of 20 \u00a9 Aquaveo 2024  1. Select MODFLOW | Check Simulation \u2026 to bring up the Model Checker  dialog.  \n2. Click Run Check . \nThis command searches through the MODFLOW inputs for obvious errors such as \nnegative values for hydraulic conductivity, and so on. The model should not have any \nwarnings or errors.  \n3. Click Done  to exit the Model Checker  dialog.  \n4. Save   the project.  \n5. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n6. When the model finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n7. Click Close  to import the solution and close the MODFLOW  dialog.  \nThe Graphics Window should display contours  similar to Figure 11. Notice that there is \nsome drawdown around the wells.  \n \n      Figure 11      MODFLOW head contours  \n4 Voronoi UGrids  \n4.1 Create the 2D Voronoi UGrid  \nNow to create another MO DFLOW -USG model using a Voronoi UGrid. Since all the \nmodel data is defined using the conceptual model approach, this process is fast. Follow \nthe same procedure employed to create the 3D quadtree UGrid.  \n1. First, turn off \u201c  quadtree -3d\u201d to hide the 3D quadtre e UGrid.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Complex Stratigraphy  \n \n Page 13 of 20 \u00a9 Aquaveo 2024  2. Expand the \u201c  MODFLOW \u201d conceptual model below the  \u201c Map Data \u201d item in \nthe Project Explorer . \n3. Right -click \u201c  SourceSink \u201d and select Map To  | UGrid  to bring up the Map \u2192 \nUGrid  dialog.  \n4. Select \u201c2D\u201d from the Dimension  drop-down.  \n5. Select \u201cVoronoi\u201d from t he UGrid type  drop-down.  \n6. Click OK to close the Map \u2192 UGrid  dialog and generate the Voronoi UGrid.  \n7. Right -click on \u201c ugrid \u201d and select Rename .  \n8. Enter \u201c voronoi \u201d and press Enter  to set the new name.  \n9. Right -click on \u201c  UGrid Data \u201d and select Display Options \u2026 to open the Display \nOptions  dialog.  \n10. Select \u201cUGrid: voronoi\u201d from the list on the left.  \n11. On the UGrid  tab, turn on Cell faces  and turn off Face c ontours . \n12. Click OK to exit the Display Options  dialog.  \nNotice the 2D Voronoi grid ( Figure 12). Like the quadtree grid, the Voronoi grid is refined \naround the wells and the other boundary conditions.  \n \n      Figure 12      2D Voronoi UGrid  \n4.2 Create a 3D Voronoi UGrid  \nIt is now possible to create the 3D Voronoi UGrid.  \n1. Select the \u201c  Borehole Data \u201d folder in the Project Explorer  to make it active.  \n2. Select Boreholes | Horizons \u2192 UGrid \u2026 to bring up the Horizons Elevations  \npage of the Horizons to UGrid  dialog.  \n3. Click Next  to go to the Top and Bottom Elevations  page of the Horizons to UGrid  \ndialog.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Complex Stratigraphy  \n \n Page 14 of 20 \u00a9 Aquaveo 2024  4. In the Primary UGrid  section, select \u201c  voronoi \u201d. \n5. Click Finish  to close the Horizons to UGrid  dialog and create the 3D UGrid.  \n6. Turn off \u201c voronoi \u201d in the Project Explorer  to hide the 2D UGrid.  \n7. Right -click on \u201c  voronoi (2) \u201d and select Rename .  \n8. Enter \u201c voronoi -3d\u201d and press Enter  to set the new name.  \n9. Switch to Oblique View   to view the UGrid in 3D.  \nA 3D Voronoi grid similar to Figure 13 should now be visible. This grid looks similar to the \n3D quadtree UGrid. View the different layers of this UGrid using the single layer viewing \noption (just as with the 3D quadtree UGrid).  \n \n      Figure 13      3D Voronoi UGrid  \n4.3 Create a MODFLOW -USG Model  \nNow to create the MODFLOW -USG model:  \n1. Right -click on \u201c  voronoi -3d\u201d and select New MODFLOW\u2026  to open the \nMODFLOW Global/Basic Package dialog.  \n2. Click OK to accept the defaults and exit the MODFLOW Global/Basic Package  \ndialog.  \nNow to define the aquifer properties for this model as done previously:  \n3. Select MODFLOW | LPF \u2013 Layer Property Flow \u2026 to open the LPF Package \ndialog.  \n4. In the Layer property entry method section, select Use material IDs . \n5. Click OK to exit the LPF Package  dialog.  \n4.4 Map to MODFLOW  \nNow to assign the conceptual model values to the MODFLOW model:  \n\nGMS Tutorials   MODFLOW -USG \u2013 Complex Stratigraphy  \n \n Page 15 of 20 \u00a9 Aquaveo 2024  1. Select the \u201c  MODFLOW \u201d conceptual model to make it active.  \n2. Select Feature Objects | Map \u2192 MODFLOW  to bring up the Map \u2192 Model  \ndialog.  \n3. Click OK to accept the defaults and close the Map \u2192 Model  dialog.  \n4. Right -click on \u201c  UGrid Data \u201d and select Display Options \u2026 to open the Display \nOptions  dialog.  \n5. Select \u201cUGrid: voronoi -3d\u201d from the list on the left.  \n6. On the UGrid  tab, turn off Cell faces  and click OK to exit the Display Options  \ndialog.  \n7. Turn off \u201c voronoi\u201d.  \n8. Switch to Plan View  . \nBoundary condition symbols for specified head, rivers, and wells should appear similar to \nFigure 14. \n \n      Figure 14      MODFLOW boundary conditions on a Voronoi UGrid  \n4.5 Save and Run MODFLOW  \nNow it is possible to run MODFLOW.  \n1. Save   the project.  \n2. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n3. When the model finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and close the MODFLOW  dialog.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Complex Stratigraphy  \n \n Page 16 of 20 \u00a9 Aquaveo 2024  The contours  should appear similar to Figure 15. Feel free to compare this solution with \nthe previous ones.  \n \n      Figure 15      MODFLOW computed head contours on Voronoi UGrid  \n5 VTK Unstructured Grids  \n5.1 Import the VTK Unstructured Grid File  \nIn the last part of this tutorial, a VTK unstructured grid matching the site boundary  will be \nimported. The horizons will then be converted t o make a 3D UGrid for the site.  \n1. Turn off  \u201c voronoi -3d\u201d in the Project Explorer  to hide the UGrid.  \n2. Click Open   to bring up the Open  dialog . \n3. Select \u201cAll Files (*.*)\u201d from the Files of type  drop-down.  \n4. Browse to the ComplexStratigraphy \\ComplexStratigraphy \\ directory and select \n\u201ctri-quad.vtu \u201d. \n5. Click Open  to import the file and exit the Open  dialog.  \nThe UGrid should be similar to the one in Figure 16. VTK unstructured g rids are very \nflexible and can contain many different types of cells (1D, 2D, 3D). The Horizons \u2192 \nUGrid command will work with any UGrid that contains only 2D cells. This particular \nUGrid contains only triangles and quadrilaterals.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Complex Stratigraphy  \n \n Page 17 of 20 \u00a9 Aquaveo 2024   \n      Figure 16      UGrid comprising triangle and quadrilateral cells  \n5.2 Create a 3D UGrid  \nIt is now possible to create the 3D UGrid.  \n1. Select \u201c  Borehole Data \u201d in the Project Explorer  to make it active.  \n2. Select Boreholes | Horizons \u2192 UGrid \u2026 to bring up the Horizon Elevations  page \nof the Horizons to UGrid  dialog.  \n3. Click Next  to go to the Top and Bottom Elevations  page of the Horizons to UGrid  \ndialog.  \n4. In the Primary UGrid  section, select \u201c tri-quad \u201d and click Finish  to close the \nHorizons to UGrid  dialog.  \n5. In the Project Explorer, hide  \u201c tri-quad \u201d. \n6. Right -click on \u201c  tri-quad (2) \u201d and select Rename .  \n7. Enter \u201c tri-quad -3d\u201d  and press Enter  to set the new name.  \n8. Right -click on \u201c  UGrid Data \u201d and select Display Options \u2026 to bring up the \nDisplay Options  dialog.  \n9. Select \u201cUG rid: tri -quad -3d\u201d from the list on the left.  \n10. On the UGrid  tab, turn on Cell faces  and turn off Face c ontours . \n11. Click OK to exit the Display Options  dialog.  \n12. Switch to Oblique View   to view the UGrid in 3D.  \nThe 3D UGrid should be similar to Figure 17. This grid looks similar to the previously -\ncreated 3D UGrids. Feel free to view the different layers of this UGrid as done with the \nprevious ones.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Complex Stratigraphy  \n \n Page 18 of 20 \u00a9 Aquaveo 2024   \n      Figure 17      3D UGrid created from tri -quad 2D UGrid  \n5.3 Create a MODFLOW -USG Model  \nNow to create the MODFLOW -USG model:  \n1. Right -click on \u201c  tri-quad -3d\u201d and select New MODFLOW \u2026 to bring up the \nMODFLOW Global/Basic Package  dialog.  \n2. Click OK to accept the defaults and exit the MODFLOW Global/Basic Package  \ndialog.  \nNext, define the aquifer properties for this model as done previously.  \n3. Select MODFLOW | LPF \u2013 Layer Property Flow \u2026 to open the LPF Package \ndialog.  \n4. In the Layer property entry method  section, select Use material IDs . \n5. Click OK to exit the LPF Package  dialog.  \n5.4 Map to MODFLOW  \nNow to assign the conceptual model values to the MODFLOW model:  \n1. Select the \u201c MODFLOW \u201d conceptual model to make it active.  \n2. Select Feature Objects | Map \u2192 MODFL OW to bring up the Map \u2192 Model  \ndialog.  \n3. Click OK to accept the defaults and exit the Map \u2192 Model  dialog.  \n4. Right -click on \u201c UGrid Data \u201d and select Display Options \u2026 to bring up the \nDisplay Options  dialog.  \n5. Select \u201cUGrid: trid -quad -3d\u201d from the list on the lef t. \n6. On the UGrid  tab, turn off Cell faces  and click OK to close the Display Options  \ndialog.  \n7. Switch to Plan View  . \n\nGMS Tutorials   MODFLOW -USG \u2013 Complex Stratigraphy  \n \n Page 19 of 20 \u00a9 Aquaveo 2024  Boundary condition symbols for specified head, rivers, and wells should appear, similar to \nFigure 18. \n \n      Figure 18      MODFLOW boundary conditions on a 3D  UGrid  \n5.5 Save and Run MODFLOW  \nNow it is possible to run MODFLOW.  \n1. Save   the project.  \n2. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n3. When the model finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and close the MODFLOW  dialog.  \nThe contours  should be similar to those in Figure 19. Feel free to compare this solution \nwith the others in the tutorial.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Complex Stratigraphy  \n \n Page 20 of 20 \u00a9 Aquaveo 2024   \n      Figure 19      MODFLOW computed head contours on 3D  UGrid  \n6 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 USG Complex Stratigraphy\u201d tutorial. The following key \nconcepts were discussed and demonstrated in this tutorial:  \n\uf0b7 The Horizons  \u2192 UGrid  command can create 3D UGrids of complex \nstratigraphy.  \n\uf0b7 The Horizons \u2192 UGrid  comman d can create a variety of 3D UGrids.  \n\uf0b7 The Horizons \u2192 UGrid  command will work on imported VTK unstructured grids \nthat are comprised of 2D cells.  \n\uf0b7 Multiple UGrids and multiple MODFLOW -USG simulations can exist in the same \nGMS project.  \n \n\n", "filename": "MODFLOW-USG-ComplexStratigraphy.pdf", "pages": 20}, "MODFLOW-USG-ConvertingFromModflow2005": {"text": "GMS Tutorials   MODFLOW -USG  \u2013 Converting from MODFLOW -2005  \n Page 1 of 10 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW -USG \u2013 Converting from MODFLOW -2005  \nHow to convert a non -MODFLOW -USG model into a MODFLOW -\nUSG model  \nObjectives   \nLearn how to create a MODFLOW -USG model from an existing, non -MODFLOW -USG model in GMS . \nPrerequisite Tutorials  \n\uf0b7 MODFLOW  \u2013 Grid \nApproach  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 15\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW -USG  \u2013 Converting from MODFLOW -2005  \n Page 2 of 10 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Importing a MODFLOW -2005 Model  ................................ ................................ ...................  2 \n2.1 Saving and Running MODFLOW -2005  ................................ ................................ .........  3 \n3 Changing to MODFLOW -USG  ................................ ................................ .............................  4 \n3.1 Saving and Running MODFLOW -USG  ................................ ................................ .........  5 \n3.2 Comparing Results  ................................ ................................ ................................ ....... 5 \n4 Importing a MODFLOW -2005 Model and Converting to a UGrid  ................................ ..... 6 \n4.1 Saving and Running MODFLOW -2005  ................................ ................................ .........  7 \n5 Converting from a 3D Grid to a UGrid  ................................ ................................ ................  7 \n5.1 Comparing Grids  ................................ ................................ ................................ ...........  8 \n5.2 Saving and Running MODFLOW -USG  ................................ ................................ .........  8 \n5.3 Comparing Results  ................................ ................................ ................................ ....... 9 \n6 Conclusion  ................................ ................................ ................................ .........................  10 \n \n1 Introduction  \nMODFLOW -USG supports most of the packages from MODFLOW -2005. It can import \nand use structured grid model files from MODFLOW -2000 and MODFLOW -2005. For \nsimple models, it is easy to convert them for use in MODFLOW -USG. The GMS interface \nmakes this process simple.  \nConverting the model from using a structured grid to an unstructured grid requires a bit \nmore work, including the creation of a DISU file. In GMS, the model must firs t be \nconverted to a new type of unstructured grid object (i.e., a UGrid). This conversion is \nhandled automatically by GMS, which creates the DISU file automatically so no manual \nfile editing is needed.  \nThis tutorial discusses and demonstrates importing a m odel built for MODFLOW -2005, \nsaving it, running it, and reviewing the results. The model is then switched to use \nMODFLOW -USG using a structured grid, the model is saved, MODFLOW is run, and the \nresults are reviewed. The tutorial then compares the MODFLOW -2005 and MODFLOW -\nUSG results.  \nThe later part of the tutorial imports a more complex MODFLOW -2005 model, saves it, \nruns it, and reviews the results. The model is converted to use MODFLOW -USG using an \nunstructured grid, then saved, run, and the results are re viewed. Finally the MODFLOW -\n2005 and MODFLOW -USG results are compared.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.   \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2 Importing a MODFLOW -2005 Model  \nStart by opening a MODFLOW -2005 model. This model is one of the USGS sample \nmodels shipped with MODFLOW -2005.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cMODFLOW Name Files (*.mfn;*.nam)\u201d from the Files of type  drop-down.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 Converting from MODFLOW -2005  \n \n Page 3 of 10 \u00a9 Aquaveo 2024  3. Browse to the usg-from-mf2005 \\usg-from-mf2005 \\test1ss  directory and select \n\u201ctest1ss.nam \u201d. \n4. Click Open  to exit the Open  dialog and bring up the MODFLOW Translator  \ndialog.  \n5. Select MOD FLOW 2005  and click OK to begin the translation process.  \n6. When it finishes  translating the file into a standard GMS format, click Done  to \nclose the MODFLOW Translator  dialog.  \nA simple, steady -state model should appear ( Figure 1). It uses the Streamflow Routing, \nGeneral -Head Boundary, Recharge, and Evapotranspiration packages.  \n \n      Figure 1      The imported model  \n2.1 Saving and Running MODFLOW -2005  \nNow to save the project and run MODFLOW 2005:  \n1. Click Save   to open the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Click Up One Level   to go to the usg-from-mf2005 \\usg-from-mf2005  folder .  \n4. Enter \u201c test1ss.gp r\u201d as the File name . \n5. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 Converting from MODFLOW -2005  \n \n Page 4 of 10 \u00a9 Aquaveo 2024  6. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n7. When it finishes, turn on Read solution on exit  and Turn on contours (if not on \nalready) . \n8. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.  \nBlock fill contours should be visible on the model, similar to Figure 2. \n \n      Figure 2      Block fill contours after obtaining a solution  \n3 Changing to MODFLOW -USG  \nNow, change the model to use MODFLOW -USG. Other than changing the solver , no \nother changes should be made to the model. The model will still use the same structured \ngrid. \n1. Select MODFLOW | Global Options \u2026 to open the MODFLOW Global/Basic \nPackage dialog.  \n2. In the MODFLOW version  section, select USG . \n3. Click OK to close the MODFLOW Global/Basic Package  dialog.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 Converting from MODFLOW -2005  \n \n Page 5 of 10 \u00a9 Aquaveo 2024  A warning will appear stating that MODFLOW -USG only supports the SMS solver. This is \nbecause MODFLOW -USG uses the SMS Sparse Matrix solver developed by the USGS.1 \n4. Click OK to close the warning dialog.  \n3.1 Saving and Running MODFLOW -USG  \nNow to run MODFLOW again and compare the results:  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Enter \u201c test1ss -usg.gpr \u201d as the File name . \n4. Click Save  to save the file under the n ew name and close the Save As  dialog.  \n5. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n6. When it finishes, turn on Read solution on exit  and Turn on contours (if not on \nalready) . \n7. Click Close  to import the solution and close the MODFLOW  model  wrapper \ndialog.  \nNotice that the block -fill contours are still visible.  \n8. Save   the project with the new solution.  \n3.2 Comparing Results  \nNow to compare the results:  \n3. In the Project Explorer , alternately click on the \u201c  test1ss (MODFLOW) \u201d solution \nand the \u201c  test1ss -usg (MODFLOW) \u201d solution.  \nNotice that the solutions appear to be identical.  \n4. Double -click the \u201c  test1ss.out \u201d file in the Project Explorer  to bring up the View \nData File  dialog. Note that if the Never ask this again  option was previously \nchecked in t his dialog, this dialog will not appear. In this case, skip to step 4.  \n5. Select the desired text editor from the Open with  drop-down and click OK to open \nthe file in that text editor.  \n6. Repeat steps 2 \u20133 with the \u201c  test1ss -usg.out \u201d file in the Project Explorer . \n7. In the external text editor, scroll to the bottom of each file and compare the \nvolumetric budget results ( Figure 3). \nNotice that the results are very similar, thoug h not exactly the same. This demonstrates \nthat a MODFLOW -2005 model using a structured grid can be converted to MODFLOW -\nUSG and produce very similar results with very little effort, so long as the original model \ndoes not use any packages that are not suppo rted by MODFLOW -USG.  \n8. When finished examining the files, close both and return to GMS.  \n                                                      \n1 The LMG (or SAMG) solver developed by Fraunhofer SCAI also works with MODFLOW -USG and \nmay also be available in the GMS license. Contact Aquaveo at http://www.aquaveo.com/  for \nlicensing information.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 Converting from MODFLOW -2005  \n \n Page 6 of 10 \u00a9 Aquaveo 2024   \n      Figure 3      Comparing the volumetric budget results  \n4 Importing a MODFLOW -2005 Model and Converting to a UGrid  \nNow to open another MODFLO W-2005 model that uses the UZF package. This package \nis not supported by MODFLOW -USG. In this case, the structured grid will be converted \ninto an unstructured grid.  \n1. Click New  to start a new project and reset back to default settings. If asked to \nsave, cl ick Don\u2019t Save . \n2. Click Open   to bring up the Open  dialog.  \n3. Select \u201cMODFLOW Name Files (*.mfn;*.nam)\u201d from the Files of type  drop-down.  \n4. Browse to the usg-from-mf2005 \\usg-from-mf2005 \\UZFtest2  directory and select \n\u201cUZFtest2.nam \u201d. \n5. Click Open  to close the Open  dialog and bring up the MODFLOW Translator  \ndialog.  \n6. Select MODFLOW 2005  and click OK to begin the translation into the standard \nGMS format.  \n7. When it finishes, click Done  to close the MODFLOW Translator  dialog.  \nA model similar to the one shown in Figure 1 should now be visible, but with some \nadditional symbols ( Figure 4). This mode l uses the same grid layout as before. However, \nthis model is transient and uses the UZF and Well packages instead of the Recharge and \nEvapotranspiration packages.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 Converting from MODFLOW -2005  \n \n Page 7 of 10 \u00a9 Aquaveo 2024   \n      Figure 4      Model is slightly different than in Figure 1 \n4.1 Saving and Running MODFLOW -2005  \nNext, to save the project and run MODFLOW -2005:  \n1. Click Save   to open the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save  as type  drop-down.  \n3. Click Up One Level   to go to the usg-from-mf2005 \\usg-from-mf2005  folder . \n4. Enter \u201c UZFtest2.gpr \u201d as the File name . \n5. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n6. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n7. When it finishes, turn on Read solution on exit  and Turn on contours (if not on \nalready) . \n8. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.  \nThe model should have block -fill contours similar to those show n in Figure 2 will be \nvisible on the model.  \n9. Save   the project with the solution.  \n5 Converting from a 3D Grid to a UGrid  \nMODFLOW -USG supports unstructured grids, or grids with all different kinds of cells an d \ndiscontinuous layers. GMS provides support for these types of grids using an \n\nGMS Tutorials   MODFLOW -USG  \u2013 Converting from MODFLOW -2005  \n \n Page 8 of 10 \u00a9 Aquaveo 2024  unstructured grid \u2014or UGrid \u2014object. This tutorial will now demonstrate converting the \nmodel from using a structured grid to an unstructured grid. No new cell types will be \nintrod uced into the model, and no discontinuous layers will be created, but the model will \nuse a grid that supports this.  \n1. Right -click on \u201c  MODFLOW \u201d in the Project Explorer  and select Convert to \nMODFLOW -USG Simulation . \n2. Click No when asked to include inactive cel ls in the new UGrid.  \n3. Click OK when advised that the SIP and UZF packages are not supported by \nMODFLOW -USG.  \nNotice that GMS created a new Project Explorer folder  called \u201c UGrid Data \u201d. This folder \ncontains one \u201c  UGrid\u201d containing (among other things) a new \u201c  MODFLOW\u201d \nsimulation.  \n5.1 Comparing Grids  \nGMS created the UGrid from only the active cells of the structured, 3D grid. Therefore, \nthe grids have a different number of cells.  \n1. Right -click on the structured \u201c  grid\u201d in the Project Explorer and select \nProperties\u2026  to open the Properties dialog.  \nNotice the Number of cells  is \u201c150\u201d (scroll down the list if needed).  \n2. Click OK to exit the Properties  dialog.  \n3. Right -click on the \u201c  ugrid \u201d and select Properties \u2026 to open the UGrid  \nProperties dialog.  \nNotice the Number of cells is \u201c116\u201d. The number is lower because the inactive cells in the \nstructured grid were not preserved in the UGrid.  \n4. Click OK to exit the UGrid  Properties  dialog.  \nNow hide the old model while working with the new model.  \n5. Turn off \u201c 3D Grid Data \u201d in the Project Explorer  to hide the old model.  \n5.2 Saving and Running MODFLOW -USG  \nTo save the project and run MODFLOW -USG:  \n1. Save   the project . \n2. Select the \u201c  MODFLOW\u201d simulation under \u201c  ugrid \u201d in the Project Explorer to \nmake it active.  \n3. Click Run MODFLOW   to bring up  the MODFLOW  model wrapper dialog.  \n4. When MODFLOW -USG finishes, turn on Read solution on exit  and Turn on \ncontours (if not on already) . \n5. Click Close  to import the solution and exit the MODFLOW  model wrapper dialog.  \nBlock -fill contours similar to those shown i n Figure 2 should now be visible ( Figure 5). \n6. If needed , click Contours   to open the Dataset Contour Options -UGrid -Head  \ndialog.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 Converting from MODFLOW -2005  \n \n Page 9 of 10 \u00a9 Aquaveo 2024  7. Select \u201cBlock Fill\u201d from the Contour method  drop-down.  \n8. Click OK to close the Dataset Contour Options -UGrid -Head  dialog.  \n \n      Figure 5      Block fill similar to Figure 2 \n5.3 Comparing Results  \nNow to compare the results of the two models:  \n1. Double -click \u201c  UZFtest2.out \u201d under the 3D grid MODFLOW solution to bring up \nthe View Data File  dialog. If the Never ask this again  option was previously \nturned on, this dialog will not appear. In this case, skip to step 3.  \n2. Select the desired text editor f rom the Open with  drop-down and click OK to \nclose the View Data File  dialog and open the file in the selected external text \neditor.  \n3. Follow steps 1 \u20132 for the \u201c  UZFtest2.out \u201d file under the UGrid MODFLOW \nsolution.  \n4. Scroll to the bottom of each file and compa re the volumetric budget results.  \nNotice that the results are quite different. The new USG model doesn\u2019t include the UZF \npackage, so there is no Recharge or ET. The Recharge and EVT packages in the new \nmodel could be used to mimic what the UZF package is d oing in the old model. However, \nthat goes beyond the scope of this tutorial.  \nVersion 1.3 (released in December 2015) of MODFLOW -USG does not support the HUF, \nMNW1, MNW2, and UZF MODFLOW -2005 packages.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 Converting from MODFLOW -2005  \n \n Page 10 of 10 \u00a9 Aquaveo 2024  6 Conclusion  \nThis concludes the \u201cMODFLOW -USG: Converting from MODFLOW -2005\u201d tutorial.  The \nfollowing  key concepts were discussed and demonstrated in this tutorial : \n\uf0b7 A model can be converted to MODFLOW -USG and run with a structured grid by \nsimply changing an option in the MODFLOW Global/Basic Package  dialog.  \n\uf0b7 To co nvert a model to an unstructured grid, right -click on the model and select \nthe Convert to MODFLOW -USG Simulation  command. This creates a new \nUGrid and MODFLOW simulation.  \n\uf0b7 Some MODFLOW -2005 packages, such as UZF, are not supported in \nMODFLOW -USG.  \n \n", "filename": "MODFLOW-USG-ConvertingFromModflow2005.pdf", "pages": 10}, "MODFLOW-USG-GncPackage": {"text": "GMS Tutorials   MODFLOW -USG  \u2013 GNC Package  \n Page 1 of 10 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW -USG  \u2013 GNC Package  \nThe GNC (Ghost Node Correction) package interface in GMS  \nObjectives   \nLearn how GMS supports the GNC (Ghost Node Correction) package for MODFLOW -USG . \nPrerequisite Tutorials  \n\uf0b7 MODFLOW  \u2013 Grid \nApproach  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 15\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW -USG  \u2013 GNC Package  \n Page 2 of 10 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 Opening an Existing Model  ................................ ................................ ...........................  3 \n2.2 Examining the Solution  ................................ ................................ ................................ . 4 \n3 Using the GNC Package  ................................ ................................ ................................ ...... 5 \n3.1 Adding GNC Data  ................................ ................................ ................................ .........  5 \n3.2 Saving and Running MODFLOW  ................................ ................................ ..................  7 \n4 Comparing Solutions  ................................ ................................ ................................ ..........  7 \n4.1 Comparing Heads  ................................ ................................ ................................ .........  7 \n4.2 Comparing Velocity Vectors ................................ ................................ ..........................  9 \n5 Conclusion  ................................ ................................ ................................ .........................  10 \n \n1 Introduction  \nThe Ghost Node Correction (GNC) package is an optional package included \nin MODFLOW -USG. It can be used to correct errors in the model that are created \u201cwhen \na line between two connected nodes does not bisect the shared face at a right angle .\u201d1 \nThe typical reason these errors would exist is if there is a nested or quadtree grid \nrefinement present in the model grid. This tutorial is based on the first example problem \nincluded with the MODFLOW -USG documentation.  \nThis tutorial will discuss and demonstrate:  \n\uf0b7 Opening a model containing a nested grid.  \n\uf0b7 Running the model and examining the results.  \n\uf0b7 Turning on the GNC package.  \n\uf0b7 Using GMS to compute the GNC package data.  \n\uf0b7 Saving and ru nning the model.  \n\uf0b7 Comparing the new results to the old.  \nFigure 1 shows a conceptualization of ghost nodes.  \n                                                      \n1 Panday, Sorab; Langevin, Christian.D.; Niswonger, Richard G.; Ibaraki, Motomu ; and Hughes, \nJoseph D., (2013). \u201cMODFLOW \u2013USG version 1: An Unstructured Grid Version of MODFLOW for \nSimulating Groundwater Flow and Tightly Coupled Processes Using a Control Volume Finite -\nDifference Formulation\u201d in Techniques and Methods 6 \u2013A45,U.S. Geolog ical Survey, 66 p.  \nGMS Tutorials   MODFLOW -USG  \u2013 GNC Package  \n \n Page 3 of 10 \u00a9 Aquaveo 2024   \n      Figure 1      Ghost node conceptualization for nested grids2 \n2 Getting Started  \nTo get started, do the following:  \n1. If necessary, launch GMS.   \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2.1 Opening  an Existing Model  \nTo start by opening a MODFLOW -USG one -layer, confined model based on the nested \ngrid example included with the MODFLOW -USG documentation:  \n1. Click Open   to bring up the Open  dialog . \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the GncPackage \\ directory and select \u201c nested.gpr \u201d. \n4. Click Open  to import the project and exit the Open  dialog.  \nThe project should appear similar to Figure 2. Flow is from left to right with the cells on \nthe left side set as constant head cells with a value of \u201c1.0\u201d. Cells on the right side are set \nas constant head cells with a value of \u201c0.0\u201d.  \n                                                      \n2 Ibid, p.24.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 GNC Package  \n \n Page 4 of 10 \u00a9 Aquaveo 2024   \n      Figure 2      Nested grid example included with MODFLOW -USG  \n2.2 Examining the Solution  \nThis project file includes a solution. Review the solution by doing the following:  \n1. Double -click on \u201c  nested.out \u201d under the \u201c  nested (MODFLOW)\u201d solution in \nthe Project Explorer  to bring up the View Data File  dialog. If the Never ask this \nagain  option was previously turned on, this dialog will not appear. If this is the \ncase, skip to step 3.  \n2. Select the desired text editor from the Open with  drop-down and click OK to open \nthe desired  text editor and close the View Data File  dialog.  \n3. In the external text editor, scroll to the bottom of the file to the volumetric budget \nsection ( Figure 3). \n\nGMS Tutorials   MODFLOW -USG  \u2013 GNC Package  \n \n Page 5 of 10 \u00a9 Aquaveo 2024   \n      Figure 3      Budget for model without ghost nodes  \nNotice the total in and total out is \u201c118.2359\u201d . According to the MODFLOW -USG \ndocumentation, \" Using Darcy\u2019s Law and the input parameters for this problem, the correct \ngroundwater flow rate through the aquifer system is 116.67 m3/d.\"3 A MODFLOW 2005 \nsimulation of the same area without the refined grid cells would match this groundwater \nflow rate.  \nThe error is small \u2014about 1.3 percent. The error is due to the 3 -to-1 refinement of the \nnested grid and the fact that the line connecting the centers of some cells to their \nadjacent cells does not perpendicularly bisect the faces between the cells.  \n3 Using th e GNC Package  \nIn order to reduce the error in the model, this tutorial will demonstrate how to use the \nGNC package.  \n1. Close the text editor and return to GMS.  \n2. Double -click the \u201c  Global \u201d package in the Project Explorer  to bring up the \nMODFLOW Global/Basic Pa ckage  dialog.  \n3. Click Packages \u2026 to bring up the MODFLOW Packages / Processes  dialog.  \n4. Turn on GNC \u2013 Ghost Node Correction . \n5. Click OK to close the MODFLOW Packages / Processes  dialog.  \n6. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n3.1 Adding GNC Data  \nWith the package enabled, it is now possible to supply the data.  \n1. Right -click on \u201c  MODFLOW \u201d and select Optional Packages  | GNC \u2013 Ghost \nNode Correction \u2026 to bring up the GNC Package  dialog.  \n                                                      \n3 Panday, et al (2013), pp. 46 -47. \n\nGMS Tutorials   MODFLOW -USG  \u2013 GNC Package  \n \n Page 6 of 10 \u00a9 Aquaveo 2024  The package consists of three tables, listed in the left column of the  dialog. Refer to the \nMODFLOW -USG documentation for details about each.  \n\uf0b7 \u201cGncText \u201d: A list of text lines that can appear at the top of GNC package files.  \n\uf0b7 \u201cGncFlags \u201d: A list of options, or flags, used to control the GNC package.  \n\uf0b7 \u201cGncNodes \u201d: A list of ghost  node data for each ghost node.  \n2. Select \u201c GncNodes \u201d from the list on the left. Following is a brief explanation4 for \neach column:  \n\uf0b7 NodeN  is the node number of the cell in which the ghost node is located.  \n\uf0b7 NodeM  is the node number of the connecting cell, m, to which flow occurs \nfrom ghost node.  \n\uf0b7 NodeJ  is the node number of a contributing cell j, which contributes to the \ninterpolated head value at the ghost node . \n\uf0b7 AlphaJ  is the contributing factor \u03b1j of the ghost node.  \nGhost node data can be added by hand. In this case, GMS will calculate the data.  \n3. Turn on Create points at ghost node locations when generating . \n4. Click Generate Ghost Node Data . \n5. Click OK to exit the GNC Package  dialog.  \nThe \u201cGncNodes\u201d table is now populated. A new UGrid named \u201c  Ghost Nodes\u201d has als o \nbeen created. It has points where GMS calculated that ghost nodes should be located. \nTo see the points, turn on the display of UGrid points.  \n6. Click Display Options   to bring up the Display Options  dialog.  \n7. Select \u201cUgrid: Ghost Nodes\u201d from the list on the left. \n8. On the UGrid  tab, turn on Points  and click OK to close the Display Options \ndialog.  \nThe model should appear similar to Figure 4. \n                                                      \n4 Panday, et al (2013).  \n\nGMS Tutorials   MODFLOW -USG  \u2013 GNC Package  \n \n Page 7 of 10 \u00a9 Aquaveo 2024   \n      Figure 4      Model after creating ghost nodes  \n3.2 Saving and Running MODFLOW  \nNow to save the model with a new name so both the old and the new solutions will be  \navailable in the project after running MODFLOW.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c nestedGnc.gpr \u201d as the File name  and click Save  to save under the new \nname and exi t the Save As  dialog.  \n4. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n5. When the model finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n6. Click Close  to import the solution and exit the MODFLOW  model wrapper d ialog.  \n4 Comparing Solutions  \n4.1 Comparing Heads  \nTo review the output to see if the error in the model was reduced:  \n\nGMS Tutorials   MODFLOW -USG  \u2013 GNC Package  \n \n Page 8 of 10 \u00a9 Aquaveo 2024  1. Double -click on \u201c  nestedGnc.out\u201d in the Project Explorer to bring up the View \nData File  dialog. If the Never ask this again  option had previously  been turned \non, this dialog will not appear. If this is the case, skip to step 3.  \n2. Select the desired external text editor from the Open with  drop-down and click \nOK to open the output file in that text editor and close the View Data File  dialog.  \n3. In the external text editor, scroll to the volumetric budget section at the bottom of \nthe file.  \nNotice that the total in and total out is now very close to the ideal of 116.67 m3/d, \ndemonstrating that the GNC package reduced the error in the model. Now to look at  the \ndifference in the calculated heads at the cells using the dataset calculator to create a new \ndataset that is the difference between the two MODFLOW solutions.  \n4. Select \u201c  ugrid\u201d in the Project Explorer to make it active.  \n5. Click Data Calculator   to bring  up the Data Calculator  dialog.  \n6. In the Expression  field, enter \u201c abs(d2 -d6)\u201d. \nThis expression will create a dataset generated from the absolute value of the difference \nbetween dataset d2 [nested (MODFLOW)/Head] and dataset d6 [nestedGnc \n(MODFLOW) /Head].  \n7. In the Result  field, enter \u201c Head Difference \u201d. This is the name of the new dataset.  \n8. Click Compute . \nNotice the new dataset appears in the Datasets  list. \n9. Click Done  to exit the Data Calculator  dialog.  \nThe \u201cHead Difference\u201d dataset is now contoured on the UGrid (Figure 5). The maximum \ndifference in the head values is only about \u201c0.014\u201d.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 GNC Package  \n \n Page 9 of 10 \u00a9 Aquaveo 2024   \n      Figure 5      Contours of the difference in calculated head  \n4.2 Comparing Velocity Vectors  \nAnother way to see the difference in the two solutions is to look at the velocity vectors.  \n1. Right -click on \u201c  CCF (nested.ccf) \u201d under \u201c  nested (MODFLOW) \u201d and select \nCCF \u2192 Velocity Vectors  to create a new \u201c  Velocity vectors\u201d  dataset . \n2. Repeat step 1 for the \u201c  CCF (nestedGnc.ccf)\u201d dataset under the \u201c  \nnestedGnc (MODFLOW) \u201d solution.  \n3. Click Display Options   to bring up the Display Options  dialog . \n4. Select \u201cUgrid: ugrid\u201d from the list on the left.  \n5. On the UGrid  tab in the bottom sect ion, turn off Face contours  and turn on \nVectors . \n6. Click OK to close the Display Options  dialog . \n7. Click on the \u201c Velocity vectors \u201d dataset  under the \u201c nestedGnc \n(MODFLOW) \u201d solution.  \nNotice the vector arrows ( Figure 6). \n\nGMS Tutorials   MODFLOW -USG  \u2013 GNC Package  \n \n Page 10 of 10 \u00a9 Aquaveo 2024   \n      Figure 6      Velocity vectors  \n8. Alternate between the two \u201c Velocity vectors \u201d datasets  in the two solutions to \ncompare them.  \nNotice the velocity vectors in the solution created using ghost nodes are generally \nstraighter (left to right) than the ones created without ghost nodes.  \n5 Conclusion  \nThis concludes the \u201cMODFLOW -USG \u2013 GNC Package\u201d tutorial. The following  key \nconcepts were discussed and demonstrated in thi s tutorial : \n\uf0b7 GMS includes an interface to the Ghost Node Correction (GNC) package.  \n\uf0b7 The GNC package is used to correct errors in the model that are created \u201cwhen a \nline between two connected nodes does not bisect the shared face at a right \nangle\u201d.  \n\uf0b7 Typically,  the errors that the GNC Package corrects are small.  \n \n\n", "filename": "MODFLOW-USG-GncPackage.pdf", "pages": 10}, "MODFLOW-USG-MDT_3D": {"text": "GMS Tutorials   MODFLOW -USG Transport \u2013 MDT Package 3D Transport  \n Page 1 of 15 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW -USG Transport \u2013 MDT Package 3D Transport  \nUse the Matrix Diffusion Transport (MDT) package in GMS to simulate \nmatrix diffusion in a three -dimensional model using a semi -analytic \napproximation  \n \nObjectives   \nLearn how to use the Matrix Diffusion Transport (MDT) package with MODFLOW -USG Transport to \nsimulate matrix diffusion in a three -dimensional field scale model with an unstructured grid. \nPrerequisite Tutorials  \n\uf0b7 MOD FLOW -USG  \u2013 \nComplex Stratigraphy  \n\uf0b7 MODFLOW -USG Transport \n\u2013 Grid Approach  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW -USG  Transport  \n Time  \n\uf0b7 30\u201340 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Package 3D Transport  \n Page 2 of 15 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n3 Enable MODFLOW -USG Transport  ................................ ................................ ....................  4 \n4 Defining the BCT Package  ................................ ................................ ................................ .. 5 \n5 Defining a Prescribed Concentration Source  ................................ ................................ ... 6 \n6 Output Control  ................................ ................................ ................................ .....................  7 \n7 Saving and Running MODFLOW -USG Transport  ................................ .............................  7 \n8 Examining the Results  ................................ ................................ ................................ ........  8 \n9 Activating the MDT Package  ................................ ................................ .............................  10 \n10 Defining the MDT Package  ................................ ................................ ................................  11 \n11 Adjusting Values in the BCT Package to Fit Conceptual Model  ................................ .... 11 \n12 Saving and Running MODFLOW  ................................ ................................ ......................  12 \n13 Examining the Results  ................................ ................................ ................................ ...... 12 \n14 Conclusion  ................................ ................................ ................................ .........................  15 \n \n1 Introduction  \nThe Matrix Diffusion Transport (MDT) package works with MODFLOW -USG Transport \nand MODFLOW 6. The MDT package allows existing flow and chemic al transport models  \nto be upgrade d to include a full accounting of matrix diffusion effects.  The MDT package \nis based on the semi -analytic matrix diffusion method implemented in the REMChlor -MD \nmodel1, 2, 3. The development of this simulation capability has been supported by the \nDepartment of Defense Environmental Security Technology Certification Program \n(ESTCP) and it represents a collaborative effort between Clemson University, GSI \nEnvironmental, and Aqua veo. \nThe MDT matrix diffusion method is conceptually similar to dual porosity methods, where \nthe volume of each element is divided into \u201cmobile\u201d and \u201cimmobile\u201d fractions. Solute \ntransport occurs by advection and dispersion in the mobile fraction, but only by diffusion \nin the immobile fraction. With the MDT package, the concentration profile in the immobile \nfraction is approximated using a dynamic function that expresses the concentration as a \nfunction of distance from the mobile/immobile interface. This fun ction is recomputed at \neach time step in each element using the current and previous concentrations in the \nmobile fraction, along with the integral of the concentration profile in the immobile \nfraction. The mass transfer to or from the mobile/immobile frac tions is then computed as \na linear concentration -dependent source term.  \nThis tutorial demonstrates how the MDT package can be used with a MODFLOW -USG \nTransport simulation to simulate diffusion in a three -dimensional heterogeneous porous \nmedia system where the heterogeneity occurs at the sub -gridblock scale. This example is \nbased on the unstructured grid flow model developed in the MODFLOW -USG \u2013 Complex \n                                                      \n1Farhat, S.K., C .J. Newell, R.W. Falta, and K. Lynch, 2018. REMChlor -MD User\u2019s \nManual, developed for the Environmental Security Technology Certification Program \n(ESTCP) by Clemson University, Clemson, SC and GSI Environmental Inc., Houston, TX, \nhttps://www.serdp -estcp.org/Program -Areas/Environmental -Restoration/Contaminated -\nGroundwater/Persistent -Contamination/ER -201426  \n2 Falta, R. W., and W. Wang, 2017, A semi -analytical method for simulating matrix \ndiffusion in numerical transport models, J ournal of Contaminant Hydrology, V. 197, p. 39 -\n49. \n3 Muskus, N., and R.W. Falta , 2018, Semi -analytical method for matrix diffusion in \nheterogeneous and fractured systems with parent -daughter reactions, Journal of \nContaminant Hydrology , V. 218, p. 94 -109. \nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Package 3D Transport  \n \n Page 3 of 15 \u00a9 Aquaveo 2024  Stratigraphy tutorial, with a hypothetical release of trichloroethylene (TCE) into the \naquifer.  \nFor a mor e detailed description of the semi -analytic method used in the MDT package, \nplease refer to the REMChlor -MD user\u2019s guide1 and related journal papers2, 3. The input \nvariables used in the MDT package are described in the MDT Process for MODFLOW -\nUSG Transport  User\u2019s Guide4. \nThis example uses a five -layer Voronoi UGrid from the MODFLOW -USG Complex \nStratigraphy tutorial and adds the MODFLOW -USG BCT and MDT packages. The layers \nare discontinuous, and have different properties, but the properties are assumed to be  \nconstant within each layer. The conceptual model is that there are sub -gridblock scale \nheterogeneities such as discontinuous sand, silt, and clay layers that exist throughout the \nmodel domain. These local -scale heterogeneities give rise to strong matrix d iffusion \neffects during contaminant transport.  \nWith the MDT approach, the transport in the model is simulated with localized matrix \ndiffusion into and out of the low permeability (low -K) parts of each cell using the semi -\nanalytic method. The local low per meability zones in each cell are not specifically \ndiscretized; rather they are represented in the model in an average sense, using the \nvolume fraction (VOLFRACMD) of higher permeability (high -K) material, and the \ncharacteristic diffusion length in the low -K material (DIFFLENMD). The conceptual model \nfor transport is that advective flow occurs in only 20% of the overall volume (the high -K \nfraction) with local matrix diffusion into and out of the remaining 80% low -K fraction.  \nThis tutorial will demonstrate t he following topics:  \n1. Opening an existing MODFLOW -USG flow simulation.  \n2. Activating the BCT package  \n3. Activating the MDT package.  \n4. Running the simulation and examining the results.  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n3. Click Open   (or File | Open \u2026) to bring up the Open  dialog.  \n4. Browse to the data files for this tutorial and select \u201colele.gpr\u201d.  \n5. Click Open  to import the file and close the Open  dialog.  \nThe Graphics Win dow should appear as in Figure  1. \n                                                      \n4 Panday, S., R.W. Falta, S. Farhat, K. Pham, and A. Lemon, 2021, Matrix Diffusi on Transport \n(MDT) Process for MODFLOW -USG Transport, https://www.gsienv.com/product/modflow -usg/ \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Package 3D Transport  \n \n Page 4 of 15 \u00a9 Aquaveo 2024   \nFigure  1      Imported MODFLOW -USG flow model  \nThis model has a five -layer Voronoi UGrid with local refinement around three pumping \nwells. General heads have been s et along the coastal boundary, and a river boundary \ncondition exists along the lower left of the model. The no -flow boundary to the left occurs \nas the aquifer thins and the no -flow boundary in the upper left of the model is a parallel \nflow boundary.   \nThe five model layers are discontinuous and can be viewed by turning on the Single layer  \noption in the Mini-Grid Toolbar  and changing the layer values. A total of 2627 elements \nare used in this 3D grid.    \nBefore continuing, save the project with a new name.  \n6. Select File | Save As\u2026  to bring up the Save As  dialog.  \n7. Browse to the directory for this tutorial.  \n8. Enter \u201colele_transport.gpr\u201d as the File name . \n9. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n10. Click Save  to save the project file and close the Save As  dialog.  \n3 Enable MODFLOW -USG Transport  \nMODFLOW -USG Transport simulations use the MODFLOW -USG Transport model . To \nset up this model, complete the following : \n1. Switch to the UGrid  module.  \n2. Select MODFLOW | Global Options \u2026 to bring up the MODFLOW Global/Basic \nPackage  dialog.  \n3. Under the MODFLOW version  section, select USG Transport . \n4. Under the Model type  section, select Transient . \n5. Click the Stress Periods  button to open the Stress Periods  dialog . \n6. Change the Number of stress periods  to \u201c2\u201d.  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Package 3D Transport  \n \n Page 5 of 15 \u00a9 Aquaveo 2024  7. For the fi rst stress period, set the Length  to \u201c3650\u201d days and the Num Time Steps  \nto \u201c20\u201d time steps.   \n8. For the second stress period, set the Length  to \u201c32850\u201d days and the Num Time \nSteps  to \u201c180\u201d time steps.   \n9. Turn on the Steady state  option for both time periods ( for a steady -state flow \nfield).  \n10. Click OK to close the Stress Periods  dialog.  \n \nFigure 2        Stress period settings  \n11. Click the Packages  button to open the MODFLOW Packages  / Processes  dialog  \n12. In the Optional packages  / processes  section, turn on BCT \u2013 Block Centered \nTransport , and PCB \u2013 Prescribed Concentration . \n13. Click OK to exit the MODFLOW Packages  / Processes  dialog.  \n14. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \nA warning will appear: \u201cSwitching to USG Transport is one way. You cannot switch back \nto any other MODFLOW version later. Proceed?\u201d.  \n15. Click Yes to close the warning message.  \n4 Defining the BCT Package  \nThe parameters for the BCT transport package can now be defined.  \n1. Select MODFLOW | Optional Packages  | BCT \u2013 Block Centered Transport \u2026 to \nbring up the BCT Process  dialog.  \n2. In the list on the left, select Variables . \n3. Review the options here  and enter the following:   \na. Adsorption (IADSORB) : \u201cLinear adsorption (1) \u201d.   \nb. Dispersion formula (IDISP) : \u201cIsotropic  dispersion (1) \u201d. \n4. In the list on the left, select Aquifer Properties . \n5. Enter the following values in the Constant Value  column : \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Package 3D Transport  \n \n Page 6 of 15 \u00a9 Aquaveo 2024  a. PRSITY: \u201c0.08\u201d. This is the effective porosity used for transport. This \nvalue is based on our conceptual model where the overall porosity is 0.4, \nbut the flow only occurs in 20% of the material (the high -K fraction).  \nb. BULKD: \u201c1.6\u201d. This is the dry bulk density value used for adsorption.  \nc. DL: \u201c20\u201d. This is the longitudinal dispersivity.  \n6. In the list on the left, select Species.   \n7. Enter \u201cTCE\u201d under Speci es Name  \n8. In the list on the left, select Species Properties.   \n9. Enter the following value in the Constant Value  column:  \na. ADSORB : \u201c0.05\u201d. K d value for TCE; this value will give a retardation \nfactor R=2.  \n10. Click OK to close the BCT Process dialog.  \n11. Select Edit | Units to open the Units  dialog.  \n12. Set the Concentration  units to \u201cppb\u201d.  \n13. Click OK to close the Units  dialog.  \n5 Defining a Prescribed Concentration Source  \nNext to impose a time -dependent prescribed concentration of TCE in a single cell in grid \nlayer  1.  \n1. Using the Select  Cells   tool, select cell 886 as shown in Figure 3. \n \nFigure 3     Select cell 886 in layer 1  \n2. Right -click and  select Sources/Sinks  to open the MODFLOW Source/Sinks  \ndialog.  \n3. From the list on the lift, s elect Concentration (PCB) .  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Package 3D Transport  \n \n Page 7 of 15 \u00a9 Aquaveo 2024  4. Click Add BC  to add an entry to the table . \n5. Under Concentration  ppb, in the 886 row, click the  to open the XY Series \nEditor . \n6. At Time  0.0 enter a value of \u201c1000 \u201d.   \n7. At Time  3650 enter a value of \u201c1\u201d.   \nThis will maintain the TCE concentration in cell 886 at a value of 1000 \u00b5g/L for 10 years, \nand then will switch  it to a value of 1 \u00b5g/L for the remaining 90 years of the simulation.  \nThis is intended to simulate a contaminant source that is removed (mostly) after 10 years.  \n \n8. Click OK to exit the XY Series Editor . \n9. Click OK to exit MODFLOW Sources/Sinks  dialog.  \n10. Click anywhere outside the grid to unselect cell 886.  \n6 Output Control  \nTo specify t he output options:  \n1. Select MODFLOW  | OC \u2013 Output Control  to open the MODFLOW  Output \nControl  dialog.  \n2. Turn on the Save concentration s to *.con file  option.  \n3. Click OK to exit the MODFLOW  Output Control  dialog.  \n7 Saving and Running MODFLOW -USG Transport  \nThe change s should now be saved before running MODFLOW -USG Transport.  \n1. Click Save   to save the project.  \n2. Click the Run MODFLOW   macro in the toolbar to bring up the MODFLOW  \nmodel wrapper dialog.  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Package 3D Transport  \n \n Page 8 of 15 \u00a9 Aquaveo 2024  3. When MODFLOW finishes, check on the Read solution on exit  and Turn on \ncontours (if not on already)  boxes.  \n4. Click Close  to close the MODFLOW  model wrapper dialog.  \n5. Click Save   to save the project with the new solution.  \nThe solution set should appear in the Project Explorer.  \n8 Examining the Results  \nNext to make some adjustments to improve the appearance of the TCE contours.  \n1. In the Project Explorer, select the \u201c  TCE\u201d dataset to make it active.  \n2. Click the Display Options   macro to open the Display Options  dialog.  \n3. Next to Face contours  click Options  to open the Dataset Contour Opti ons \u2013UGrid \n\u2013 TCE dialog.  \n4. Under Contour Method  select \u201c Color Fill and Linear \u201d and \u201c Use color ramp \u201d.   \n5. Click the Color Ramp  button to open the Choose color ramp  dialog.  \n6. Select the Color Ramp Shader  pallette . \n7. Click OK to close the Choose color ramp  dialog  \n8. Under Data range , turn on Specify a range  and enter a \u201c1\u201d for Min and \u201c1000\u201d for \nMax.   \n9. Turn off the Fill below  and Fill above  boxes.  \n10. Under Contour interval  select \u201c Specified Values \u201d and enter \u201c3 \u201d.   \n11. Turn off the Fill continuous color range  option.  \n12. In the  End Value  column, enter \u201c10\u201d for row 1and enter \u201c100\u201d for row 2. \n13. Click OK to exit the Dataset Contour Options ,  \n14. OK to exit the Display Options  dialog . \n15. In the Time Steps  Window , select the  \u201c10,950 \u201d time step .  \nThis is 20 years afte r the source has been removed. The contour plot should look similar \nto Figure 4 and Figure 5 for layers 1 and 5, respectively. The plume is discharging into \nthe ocean and  also migrating towards two of the extraction wells (in layer 5 where the \nwells are screened).  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Package 3D Transport  \n \n Page 9 of 15 \u00a9 Aquaveo 2024   \nFigure 4      Simulated TCE plume in layer  1 after 10,950 days without matrix diffusion  \n \nFigure 5      Simulated TCE plume in layer 5 after 10,950 days without matrix diffusion  \n16. Using the Select  Cells   tool, select cell 840 in layer 1 as in Figure 6. \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Package 3D Transport  \n \n Page 10 of 15 \u00a9 Aquaveo 2024   \nFigure 6     Select cell 840 in layer 1  \n17. Click the Plot Wizard   macro to open the Plot Wizard dialog . \n18. Under Plot Type , select the Activ e Dataset Time Series  option.  \n19. Click Finish  to close the Plot Wizard  dialog and generate the plot.  \nThe Active Dataset Time Series  plot should appear similar to Figure 7. \n \nFigure 7      The Active Dataset Time Series  for cell 840  \n9 Activating the MDT Package  \nBefore continuing, save the project.  \n1. Click Save   to save the project.  \nTo activate the MDT package:  \n2. Select MODFLOW | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage  dialog.  \n3. Click Packages \u2026 to bring up the MODFLOW Packages / Processes  dialog.  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Package 3D Transport  \n \n Page 11 of 15 \u00a9 Aquaveo 2024  4. In the Optional packages  / processes  section, turn on MDT \u2013 Matrix Diffusion \nTransport . \n5. Click OK to exit the MODFLOW Packages  / Processes  dialog.  \n6. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n10 Defining the MDT Package  \nWith the MDT package activated, the parameters for the MDT package can now be \ndefined.  \n1. Select MODFLOW | Optional Packages  | MDT \u2013 Matrix Diffusion Transport \u2026 \nto bring up the MDT Package  dialog.  \n2. In the list on the left, select Variables . \nReview the options here. For this example, the default settings will be used.  \n3. In the list on the left, select Aquifer Properties . \n4. Enter the following values in the Constant Value  column:  \na. MDFLAG : \u201c2.0\u201d. This variable is a flag that tells the MDT package how \nmatrix diffusion will be handled. Choosing a value of 2 tells the package \nto allow matrix diffusion into embedded low permeability zones with a \nfinite diffusion length.  \na. VOLFRACMD : \u201c0.2\u201d. This is the vo lume fraction of high -K material in \neach cell.  \nb. PORMD : \u201c0.4\u201d. This is the porosity of the low -K material.  \nc. RHOBMD : \u201c1.6\u201d. Dry bulk density of the low -K material.  \nd. DIFFLENMD : \u201c1.64\u201d. This is the characteristic diffusion length in the low -\nK material in each cell. The value here was chosen to be 0.5m, but since \nthe dimensions of this model are in feet, the value is converted to units of \nfeet. More information on the estimation of the diffusion length is \navailable in the REMChlor -MD User\u2019s Guide1.  \ne. TORTMD : \u201c0.3\u201d. Tortuosity of the low -K material in each cell.  \n5. In the list on the left, select Species Properties . \n6. Enter the following Constant Values : \nf. KDMD : \u201c0.25\u201d. K d value for the lo w-K material, selected to give a \nretardation factor R=2.  \ng. DIFFMD : \u201c9.3e -4\u201d. The TCE diffusion coefficient, ft2/d due to the choice \nof units in this model.  \n7. Click OK to close the MDT Package  dialog.  \n11 Adjusting Values in the BCT Package to Fit Conceptual Model  \nThe transport properties of the high -K part of each cell are defined in the BCT \npackage.With the MDT VOLFRACMD parameter set to 0.2, the high -K material is \nassumed to only occupy 20% of the cell. In case, adjust the corresponding porosity and \nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Package 3D Transport  \n \n Page 12 of 15 \u00a9 Aquaveo 2024  Kd values in the BCT package so that this simulation is consistent with the previous one \nwithout matrix diffusion.   \n1. Select MODFLOW | Optional Packages  | BCT \u2013 Block Centered Transport \u2026 to \nbring up the BCT Process  dialog.  \n2. In the list on the left, select Aquifer Propert ies. \n3. Enter the following value:  \na. PRSITY : \u201c0.4\u201d. This is the porosity of the high -K material in each cell.  \nSince the volume fraction of high -K material (VOLFRACMD) is 20%, this \nis equivalent to the effective porosity value of 0.08 used in the previous \nsimul ation without matrix diffusion.  \n4. In the list on the left, select Species Properties.   \n5. Enter the following value:  \na. ADSORB : \u201c0.25\u201d. K d value for TCE; this value will give a retardation \nfactor R=2 for the porosity value of 0.4. This is consistent with the \nprevious simulation without matrix diffusion.  \n6. Click OK to close the BCT Process dialog.  \nWith the revised transport parameter values, this transport model will exactly match the \nprevious model without matrix diffusion if the diffusion coefficient in MDT is set to a very \nsmall (but non -zero) number.   \n12 Saving and Running MODFLOW  \nThe changes should now be saved before running MODFLOW -USG Transport.  \n1. Click Save   to save the project.  \n2. Click the Run MODFLOW   macro in the toolbar to bring up the MODFLOW  \nmodel wrapper dialog.  \n3. When MODFLOW finishes, check on the Read solution on exit  and Turn on \ncontours (if not on already)  boxes.  \n4. Click Close  to close the MODFLOW  model wrapper dialog.  \n5. Click Save   to save the project with the new solution.  \nThe solution set  should appear in the Project Explorer.  \n13 Examining the Results  \nTo examine the results, complete the following:  \n1. In the Project Explorer, select the \u201c  TCE\u201d dataset to make it active.  \n2. In the Time Step s Window , select the  \u201c10,950 \u201d time step.  \nThis is 20 years  after the source has been removed. The contour plots should look similar \nto Figure 8 and Figure 9 for layers 1 and 5, respectively. The plume is discharging into \nthe ocean and also migrating towards two of the extraction wells (in layer 5 where the \nwells are screened).  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Package 3D Transport  \n \n Page 13 of 15 \u00a9 Aquaveo 2024   \nFigure 8      Simulated TCE plume in layer 1 after 10,950 days with matrix diffusion  \n \nFigure 9      Simulated TCE plume in layer 5 after 10,950 days with matrix diffusion  \n3. Using the Select  Cells   tool, select cell 840 in layer 1 as in Figure 10. \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Package 3D Transport  \n \n Page 14 of 15 \u00a9 Aquaveo 2024   \nFigure 10      Select cell 840 in layer 1  \n4. Click the Plot Wizard   macro to open the Plot Wizard dialog . \n5. Under Plot Type , select the Activ e Dataset Time Series  option.  \n6. Click Finish  to close the Plot Wizard  dialog and generate the plot.  \nThe Active Dataset Time Series  plot should appear similar to Figure 11. Note the \nsignificant difference of this time series with Figure 7, which was computed without matrix \ndiffusion.  \n \nFigure 11     The Active Dataset Time Series  for cell 840  \n  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Package 3D Transport  \n \n Page 15 of 15 \u00a9 Aquaveo 2024  14 Conclusion  \nThis concludes the tutorial. Here are the key concepts from this tutorial:  \n\uf0b7 The MODFLOW -USG Transport MDT package can be used to simulate matrix \ndiffusion in heterogeneous porous media for cases where diffusion occurs at the \nsub-gridblock scale.   \n\uf0b7 Normal grid elements are used with embedded matrix diffusion occurring over a \nfinite distance in the matrix material in each element.  \n \n", "filename": "MODFLOW-USG-MDT_3D.pdf", "pages": 15}, "MODFLOW-USG-MDT_DiscreteFracture": {"text": "GMS Tutorials   MODFLOW -USG Transport \u2013 MDT Discrete Fracture  \n Page 1 of 7 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW -USG Transport \u2013 MDT Discrete Fracture  \nUse the Matrix Diffusion Transport (MDT) package in GMS to simulate \ndiffusion from a fracture using a semi -analytic approximation  \n \nObjectives   \nLearn how to use the Matrix Diffusion Transport (MDT) package with MODFLOW -USG Transport to \nsimulate diffusion from a single fracture . \nPrerequisite Tutorials  \n\uf0b7 MOD FLOW -USG  Transport  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW -USG  Transport  \n Time  \n\uf0b7 15\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Discrete Fracture  \n Page 2 of 7 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ............  2 \n2 Getting Started  ................................ ................................ ................................ ....... 3 \n3 Activating  the MDT Package  ................................ ................................ .................  4 \n4 Defining the MDT Package \u2013 Discrete Fracture Model  ................................ ...... 4 \n5 Saving and Running MODFLOW  ................................ ................................ ..........  5 \n6 Examining the Results  ................................ ................................ ..........................  5 \n7 Conclusion  ................................ ................................ ................................ .............  7 \n \n1 Introduction  \nThe Matrix Diffusion Transport package (MDT) works with MODFLOW -USG Transport. \nThe MDT package allows existing flow and chemic al transport models  to be upgraded to \ninclude a full accounting of matrix diffusion effects.  The MDT package is based on the \nsemi -analytic matrix diffusion method implemented in the REMChlor -MD model1, 2, 3. The \ndevelopment of this simulation capability has been supported by the Department of \nDefense Environmental Security Technology Certificatio n Program (ESTCP) and it \nrepresents a collaborative effort between Clemson University, GSI Environmental, and \nAquaveo.  \nThe MDT matrix diffusion method is conceptually similar to dual porosity methods, where \nthe volume of each element is divided into \u201cmobil e\u201d and \u201cimmobile\u201d fractions. Solute \ntransport occurs by advection and dispersion in the mobile fraction, but only by diffusion \nin the immobile fraction. With the MDT package, the concentration profile in the immobile \nfraction is approximated using a dynami c function that expresses the concentration as a \nfunction of distance from the mobile/immobile interface. This function is recomputed at \neach time step in each element using the current and previous concentrations in the \nmobile fraction, along with the int egral of the concentration profile in the immobile \nfraction. The mass transfer to or from the mobile/immobile fractions is then computed as \na linear concentration -dependent source term.  \nThis tutorial demonstrates how the MDT package can be used with a MODF LOW -USG \nTransport simulation to simulate diffusion in a single  fracture . This example is based on a \nbenchmarking problem that w as developed with REMChlor -MD. For a more detailed \ndescription of the semi -analytic method used in the MDT package, please refer to the \nREMChlor -MD user\u2019s guide1 and related journal papers2, 3. The input variables used in \nthe MDT package are described in the MDT Process for MODFLOW -USG Transport \nUser\u2019s Guide4. \n                                                      \n1 Farhat, S.K., C.J. Newell, R.W. Falta, and K. Lynch, 2018. REMChlor -MD User\u2019s Manual, \ndeveloped for the Environmental Security Technology Certification Program (ESTCP) by Clemson \nUniversity, Clemson, SC and GSI Environmental Inc., Houston, TX, https://www.serdp -\nestcp.org/Program -Areas/Environmental -Restoration/Contaminated -Groundwater/Persistent -\nContamination/ER -201426  \n2 Falta, R.W., and W. Wang, 2017, A  semi -analytical method for simulating matrix diffusion in \nnumerical transport models, J ournal of Contaminant Hydrology, V. 197, p. 39 -49. \n3 Muskus, N., and R.W. Falta, 2018, Semi -analytical method for matrix diffusion in heterogeneous \nand fractured system s with parent -daughter reactions, Journal of Contaminant Hydrology , V. 218, \np. 94 -109. \n4 Panday, S., R.W. Falta, S. Farhat, K. Pham, and A. Lemon, 2021, Matrix Diffusion Transport \n(MDT) Process for MODFLOW -USG Transport, https://www.gsienv.com/product/modflow -usg/ \nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Discrete Fracture  \n \n Page 3 of 7 \u00a9 Aquaveo 2024  The problem in this tutorial consist s of a single layer, one -dimensional unstructured grid \n(UGrid) with a MODFLOW -USG Transport simulation. The head values have been set for \nthe grid.  \nFor the this example, only the fracture itself is discretized, and the semi -analytic method \nis used to compute the matrix diffusion from the fra cture into the adjacent rock matrix. \nThis example is based on a test problem presented by Falta and Wang2 where water \ncontaining tritium is injected into a 100\u00b5m fracture at a pore velocity of 0.1 m/day. The \ntritium concentration is maintained at the upstr eam end of the grid for a period of 30 \nyears, followed by injection of clean water. Additional model parameters are given in \nTable 1.  \nTable 1.  Parameters used in the fractured rock matrix diffusion comparison  \nParameter  Fracture  Matrix  \nFracture aperture, \u03bcm 100  \nPorosity , \u03d5 1.0 0.01 \nTortuosity , \u03c4 1.0 0.1 \nRetardation factor, R 1.0 1.0 \nDarcy  velocity , vx (m/d)  0.1 0 \nDiffusion coefficient of tritium, D (m2/s) 1.6E-9                    1.6E-9                           \ntritium decay rate (1/yr)  0.0561  0.0561  \nLoading period, t1, (years)  30  \nThis tutorial will demonstrate the following topics:  \n1. Opening an existing MODFLOW -USG Transport simulation.  \n2. Activating the MDT package.  \n3. Running the simulation and examining the results.  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n3. Click Open   (or File | Open \u2026) to bring up the Open  dialog.  \n4. Browse to the data files for this tutorial and select \u201cstart.gpr\u201d.  \n5. Click Open  to import the file and close the Open  dialog.  \n \nFigure 1      Imported MODFLOW -USG Transport model  \nThe Graphics Window should appear as in Figure 1. This model has a single layer UGrid. \nSpecified heads (CHD) have been set at each end. A total of 61 elements are used in this \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Discrete Fracture  \n \n Page 4 of 7 \u00a9 Aquaveo 2024  1D grid. These elements have dimensions of 1 m in the direction of flo w (x-direction), 1 m \nperpendicular to the flow (y -direction), and 0.0001 m vertically (z -direction). The very \nsmall vertical dimension reflects the 100 \u00b5m fracture aperture.  \nThe hydraulic head in the leftmost element is maintained at a constant head of 11  m \nusing the CHD package, while the rightmost element is maintained at a head of 10 m. \nThe horizontal hydraulic conductivity was set to a value of 2190 m/yr, resulting in a Darcy \nvelocity of 36.5 m/yr or 0.1 m/d. Since the fracture porosity was set to 1 in  the BCT \npackage, the pore velocity is equal to the Darcy velocity in this example.  \nThe tritium (Species 1) is introduced at the upstream end of the grid using a transient \nconcentration boundary (PCB package) with a value of 1 for 30 years, followed by a \nvalue of 0 for 30 more years.  \nBefore continuing, save the project with a new name.  \n6. Select File | Save As\u2026  to bring up the Save As  dialog.  \n7. Browse to the data files for this tutorial.  \n8. Enter \u201cmodel -mdt.gpr\u201d as the File name . \n9. Select \u201cProject Files (*.gpr)\u201d from  the Save as type  drop-down.  \n10. Click Save  to save the project file and close the Save As  dialog.  \n3 Activating the MDT Package  \nWith the flow model set up, the MDT package can now be activated and added to the \nMODFLOW simulation. To activate the MDT package:  \n1. Switch to the UGrid  module.  \n2. Select MODFLOW | Global Options \u2026 to bring up the MODFLOW Global/Basic \nPackage  dialog.  \n3. Click Packages \u2026 to bring up the MODFLOW Packages / Processes  dialog.  \n4. In the Optional packages  / processes  section, turn on MDT \u2013 Matrix Diffusion \nTransport . \n5. Click OK to exit the MODFLOW Packages  / Processes  dialog.  \n6. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n4 Defining the MDT Package \u2013 Discrete Fracture Model  \nWith the MDT package activated, the parameters for the MDT package c an now be \ndefined.  \n1. Select MODFLOW | Optional Packages  | MDT \u2013 Matrix Diffusion Transport \u2026 \nto bring up the MDT Package  dialog.  \n2. In the list on the left, select Variables . \nReview the options here. For this example, the default settings will be used.  \n3. In the li st on the left, select Aquifer Properties . \n4. Enter the following for the Constant V alue column:  \na. MDFLAG : \u201c4.0\u201d. This variable is a flag that tells the MDT package how \nmatrix diffusion will be handled. Choosing a value of 4 tells the package \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Discrete Fracture  \n \n Page 5 of 7 \u00a9 Aquaveo 2024  to allow matrix di ffusion from both the top and bottom of the element into \nan infinite media. This example uses this option because it is directly \nmodeling only the fracture volume in this example.  \nb. VOLFRACMD : \u201c1.0\u201d. This is the volume fraction of high permeability \nmaterial in the element. Since this example is only modeling the fracture \nitself, use the value of 1.  \nc. PORMD : \u201c0.01\u201d. This is the porosity of the unfractured rock.  \nd. RHOBMD : \u201c2.0\u201d. This is the dry bulk density of the rock, which is not \nused in this simulation of triti um transport.  \ne. DIFFLENMD : \u201c1.0e -010\u201d. The characteristic diffusion length is used with \nother MDFLAG options but is not needed for MDFLAG=4. Nonetheless, \na small non -zero value has been added.  \nf. TORTMD : \u201c0.1\u201d. This is the tortuosity on the rock matrix.  \n5. In the list on the left, select Species Properties . \n6. Enter the following for the Constant V alue column:  \na. DECAYMD: \u201c0.0561\u201d. This is the tritium decay rate, 1/yr.  \nb. DIFFMD: \u201c0.0504576\u201d. This is the tritium molecular diffusion coefficient, \nm2/yr. \n7. Click OK to clo se the MDT Package  dialog.  \n5 Saving and Running MODFLOW  \nThe changes should now be saved before running MODFLOW -USG Transport.  \n1. Click Save   to save the project.  \n2. Click the Run MODFLOW   macro in the toolbar to bring up the MODFLOW  \nmodel wrapper dialog.  \n3. When MODFLOW finishes, check the Read solution on exit  and Turn on \ncontours (if not on already)  boxes.  \n4. Click Close  to close the MODFLOW  model wrapper dialog.  \n5. Click Save   to save the project with the new solution.  \nThe solution set should appear in the Proj ect Explorer.  \n6 Examining the Results  \nIn order to more clearly see how the MDT package impacted the simulation, compare the \nresults. This can be done by using the Plot Wizard  to create a time series plot.  \n1. In the Project Explorer, select the \u201c  Species 1\u201d dat aset to make it active.  \n2. Click the Plot Wizard   macro to open the Plot Wizard dialog . \n3. Under Plot Type , select the Activity Dataset Time Series  option.  \n4. Click Finish  to close the Plot Wizard  dialog and generate the plot.  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Discrete Fracture  \n \n Page 6 of 7 \u00a9 Aquaveo 2024  5. Using the Select Cells   tool, select the first cell on the left in the Graphics \nWindow.  \nThe Active Dataset Time Series  plot should appear similar to Figure 2. \n \nFigure 2      The Active Dataset Time Series for the first cell  \n6. Using the Select Cells   tool, select the second cell on the left.  \nThe Active Dataset Time  Series plot should update to appear similar to Figure 3. Note \nhow the solution changes. If desired, s elect additional cells moving to the right  to further \nsee how the solution changes.  \n \nFigure 3     The Active Dataset Time Series for the second cell  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Discrete Fracture  \n \n Page 7 of 7 \u00a9 Aquaveo 2024   \nThe results calculated using the MDT Package in MODFLOW -USG Transport4 are \ncompared to an analytical solution and to the REMChlor -MD solution in  Figure 4. The \nMDT package results are identical to the REMChlor -MD results and closely approximate \nthe exact analytical solution.  \n \nFigure 4      Comparison of MODFLOW -USG MDT Package output with REMChlor -MD (semi -\nanalytical) and the analytical solution.  \n7 Conclusion  \nThis concludes the tutorial. Here are the key concepts from this tutorial:  \n\uf0b7 The MODFLOW -USG Transport MDT package can be used to simulate  matrix \ndiffusion from a single or multiple fractures in fractured porous materials.  \n\uf0b7 The MDT package allows for two main simulation approaches: a discrete fracture \napproach, where the fracture is directly simulated and matrix diffusion occurs into \ninfinite  surrounding matrix material, and an equivalent porous media approach \nwhere normal grid elements are used with embedded matrix diffusion occurring \nover a finite distance in the matrix material in each element.  \n \n\n", "filename": "MODFLOW-USG-MDT_DiscreteFracture.pdf", "pages": 7}, "MODFLOW-USG-MDT_EquivalentPorous": {"text": "GMS Tutorials   MODFLOW -USG Transport \u2013 MDT Equivalent Porous Media  \n Page 1 of 6 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW -USG Transport \u2013 MDT Equivalent Porous \nMedia Approach  \nUse the Matrix Diffusion Transport (MDT) pa ckage in GMS to simulate \ndiffusion from fractures using a semi -analytic approximation  \n \nObjectives   \nLearn how to use the Matrix Diffusion Transport (MDT) package with MODFLOW -USG Transport to \nsimulate diffusion from a single fracture or from a set of parallel fractures . \nPrerequisite Tutorials  \n\uf0b7 MOD FLOW -USG  Transport  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW -USG  Transport  \n Time  \n\uf0b7 15\u201330 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Equivalent Porous Media  \n Page 2 of 6 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n3 Activating  the MDT Package  ................................ ................................ ...............................  4 \n4 Defining the MDT Package  ................................ ................................ ................................ .. 5 \n5 Run MODFLOW and Examine the Results  ................................ ................................ ........  5 \n6 Conclusion  ................................ ................................ ................................ ...........................  6 \n \n1 Introduction  \nThe Matrix Diffusion Transport package (MDT) works with MODFLOW -USG Transport. \nThe MDT package allows existing flow and chemic al transport models  to be upgraded to \ninclude a full accounting of matrix diffusion effects. The MDT package is based on the \nsemi -analytic matrix diffusion method implemented in the REMChlor -MD model1, 2, 3. The \ndevelopment of this simulation capability has been supported by  the Department of \nDefense Environmental Security Technology Certification Program (ESTCP) and it \nrepresents a collaborative effort between Clemson University, GSI Environmental, and \nAquaveo.  \nThe MDT matrix diffusion method is conceptually similar to dual porosity methods, where \nthe volume of each element is divided into \u201cmobile\u201d and \u201cimmobile\u201d fractions. Solute \ntransport occurs by advection and dispersion in the mobile fraction, but only by diffusion \nin the immobile fraction. With the MDT package, the conc entration profile in the immobile \nfraction is approximated using a dynamic function that expresses the concentration as a \nfunction of distance from the mobile/immobile interface. This function is recomputed at \neach time step in each element using the curre nt and previous concentrations in the \nmobile fraction, along with the integral of the concentration profile in the immobile \nfraction. The mass transfer to or from the mobile/immobile fractions is then computed as \na linear concentration -dependent source ter m. \nThis tutorial demonstrates how the MDT package can be used with a MODFLOW -USG \nTransport simulation to simulate diffusion in a series of parallel fractures. Th is example is \nbased on a benchmarking problem that w as developed with REMChlor -MD. For a more \ndetailed description of the semi -analytic method used in the MDT package, please refer \nto the REMChlor -MD user\u2019s guide1 and related journal papers2, 3. The input variables \nused in the MDT package are described in the MDT Process for MODFLOW -USG \nTransport Us er\u2019s Guide4. \nThe problems in this tutorial consist of a single layer, one -dimensional unstructured grid \n(UGrid) with a MODFLOW -USG Transport simulation. The head values have been set for \nthe grid.  \n                                                      \n1 Farhat, S.K., C.J. Newell, R.W. Falta, and K. Lynch, 2018.  REMChlor -MD User\u2019s Manual, \ndeveloped for the Environmental Security Technology Certification Program (ESTCP) by Clemson \nUniversity, Clemson, SC and GSI Environmental Inc., Houston, TX, https://www.serdp -\nestcp.org/Program -Areas/Environmental -Restoration/Contaminated -Groundwater/Persistent -\nContamination/ER -201426  \n2 Falta, R.W., and W. Wang, 2017, A semi -analytical method for simulating matrix diffusion in \nnumerical transport models, J ournal of Contaminant Hydrology, V. 197, p. 39 -49. \n3 Muskus, N., and R.W. Falta, 2018, Semi -analytical method for matrix diffusion in heterogeneous \nand fractured syste ms with parent -daughter reactions, Journal of Contaminant Hydrology , V. 218, \np. 94 -109 \n4 Panday, S., R.W. Falta, S. Farhat, K. Pham, and A. Lemon, 2021, Matrix Diffusion Transport \n(MDT) Process for MODFLOW -USG Transport, https://www.gsienv.com/product/modflow -usg/ \nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Equivalent Porous Media  \n \n Page 3 of 6 \u00a9 Aquaveo 2024  This tutorial will demonstrate the following topics:  \n1. Openi ng an existing MODFLOW -USG Transport simulation.  \n2. Activating the MDT package.  \n3. Running the simulation and examining the results.  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensur e that the program settings \nare restored to their default state.  \n3. Click Open   (or File | Open \u2026) to bring up the Open  dialog.  \n4. Browse to the data files for this tutorial and select \u201cstart.gpr\u201d.  \n5. Click Open  to import the file and close the Open  dialog.  \n \nFigure 1      Imported MODFLOW -USG Transport model  \nThe Graphics Window should appear as in Figure 1. This model has a single layer UGrid. \nSpecified heads (CHD) have been set at each end. A total of 61 elements are used in this \n1D grid. These elements have dimensions of 1 m in the direction of flow (x -direction), 1 m \nperpendicular to the flow (y -direction), and 1 m vertically (z -direction ).  \nThe hydraulic head in the leftmost element is maintained at a constant head of 11 m \nusing the CHD package, while the rightmost element is maintained at a  head of 10 m.  \nThe tr acer (Species 1) is introduced at the upstream end of the grid using a transient \nconcentration boundary (PCB package) with a value of 1 for 50 years, followed by a \nvalue of 0 for 150 more years.  \nA general modeling approach, which can be used for systems with multiple fractures, \ninvolves using an equivalent porous media approach. With this method, normal full -sized \nelements are used with the fractures embedded inside the elements. From a flow \nperspective, it is possible to calculate an equivalent porous media hydraulic conductivity \nthat gives the same overall flow, averaged over the entire area (the Darcy velocity). Since \nthe fractures occupy only a small fraction of the volume, the pore velocity in the fractures \nis much higher than the Darcy velocity of the entire rock mass.  \nThe MDT package can simulate matrix diffusion in a system of embedded parallel \nfractures using the method described in Muskus and Falta3. In order to do this, it is \nnecessary to generate a numerical grid with full -sized dimensions, and then specify the \nfracture characteristics, namely the fracture spacing and aperture. Then the volume \nfraction of high permeability material (the fractures) is equal to the fracture aperture \ndivided by the fracture spacing. This is the V OLFRACMD variable in the MDT package. \nThe characteristic diffusion length used in the MDT package, DIFFLENMD is equal to \none-half of the fracture spacing.  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Equivalent Porous Media  \n \n Page 4 of 6 \u00a9 Aquaveo 2024  This example of using the equivalent porous media approach is based on a test problem \nfrom Muskus and  Falta2 involving a system of parallel fractures with a fracture spacing of \n0.5 m and fracture apertures of 100 \u00b5m.  \nWith an equivalent porous media approach, the hydraulic conductivity value reflects the \nvalue averaged over the entire rock mass. Following the example in Muskus and Falta3, \nthe pore velocity in the fractures is 100 m/yr. The volume fraction of the fractures is \n0.0001m/0.5m = 0.0002. Then the bulk Darcy velocity is 0.02 m/yr. With a hydraulic \ngradient of 1/60, this Darcy velocity is achieved w ith a hydraulic conductivity (HK) of 1.2 \nm/yr.  \nAdditional parameters used in this example are given in Table 2.  \nTable 2.  Parameters used in the fractured rock matrix diffusion simulation  \nParameter  Fracture  Matrix  \nFracture aperture, \u03bcm  100  \nPorosity , \u03d5 1.0 0.1 \nTortuosity , \u03c4 1.0 0.1 \nRetardation factor, R 1.0 2.0 \nPore  velocity , (m/yr)  100 0 \nDiffusion coefficient, D (m2/s) 1.0E-9                           1.0E-9                           \ndecay rate (1/yr)  0.0  0.0  \nLoading period, t1, (years)  50  \nBefore continuing, save the project with a new name.  \n6. Select File | Save As\u2026  to bring up the Save As  dialog.  \n7. Enter \u201cmodel -mdt_parallel.gpr\u201d as the File name . \n8. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n9. Click Save  to save the project file and close the Save As  dialog.  \n3 Activating the MDT Package  \nWith the flow model set up, the MDT package can now be activated and added to the \nMODFLOW simulation. To activate the MDT package:  \n1. Switch to the UGrid  module.  \n2. Select MODFLOW | Global Options \u2026 to bring up the MODFLOW Global/Basic \nPackage  dialog.  \n3. Click Packages \u2026 to bring up the MODFLOW Packages / Processes  dialog.  \n4. In the Optional packages  / processes  section, turn on MDT \u2013 Matrix Diffusion \nTransport . \n5. Click OK to exit the  MODFLOW Packages  / Processes  dialog.  \n6. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Equivalent Porous Media  \n \n Page 5 of 6 \u00a9 Aquaveo 2024  4 Defining the MDT Package  \nNow the new matrix diffusion package parameters can be entered. The retardation factor \nvalue of 2.0 in the matrix will be achieved by e ntering a bulk density value (RHOBMD) of \n2.0 and a soil -water distribution coefficient (KDMD) value of 0.05.  \n1. Select MODFLOW | Optional Packages  | MDT \u2013 Matrix Diffusion Transport \u2026 \nto bring up the MDT Package  dialog.  \n2. In the list on the left, select Aquifer Properties . \n3. Enter the following for the Constant V alue column:  \na. MDFLAG : \u201c2.0\u201d. This variable is a flag that tells the MDT package how \nmatrix diffusion will be handled. Choosing a value of 2 tells the package \nto allow matrix diffusion into embedded matrix bl ocks with a finite \ndiffusion length. This example uses this option because it is using an \nequivalent porous media approach in this example.  \nb. VOLFRACMD : \u201c0.0002\u201d. This is the volume fraction of high permeability \nmaterial in the element. In this case it is th e fracture aperture divided by \nthe fracture spacing.  \nc. PORMD : \u201c0.1\u201d.  \nd. RHOBMD : \u201c2.0\u201d.  \ne. DIFFLENMD : \u201c0.25\u201d. The characteristic diffusion length is one -half of the \nfracture spacing  \nf. TORTMD : \u201c0.1\u201d.  \n4. In the list on the left, select Species Properties . \n5. Enter the fol lowing for the Constant V alue column:  \na. KDMD : \u201c0.05\u201d.  \nb. DECAYMD : \u201c0\u201d. No decay.  \nc. DIFFMD : \u201c0.03159\u201d.  \n6. Click OK to close the MDT Package  dialog.  \nIt is necessary to change the decay rate in the high permeability zone using the BCT \npackage.  \n7. Select MODFLOW | Optional Packages  | BCT \u2013 Block Centered Transport \u2026 to \nbring up the BCT Process dialog.  \n8. In the list on the left, select Species Properties . \n9. For the Constant Value column, under FODRW , enter \u201c0.0\u201d. This variable is the \ndecay rate for the species.  \n10. Click OK to close the BCT Process  dialog.  \n5 Run MODFLOW and Examine the Results  \nThe changes should now be saved before running MODFLOW -USG Transport.  \n1. Click Save   to save the project.  \n2. Click the Run MODFLOW   macro in the toolbar to bring up the MODFLOW  \nmodel wrapper dialog.  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Equivalent Porous Media  \n \n Page 6 of 6 \u00a9 Aquaveo 2024  3. When MODFLOW finishes, check the Read solution on exit  and Turn on \ncontours (if not on already)  boxes.  \n4. Click Close  to close the MODFLOW  model wrapper dialog.  \n5. Click Save   to save the project with the new solution.  \nThe solution set sh ould appear in the Project Explorer. In order to more clearly see how \nthe MDT package impacted the simulation, compare the results. As before, this can be \ndone by using the Plot Wizard  to create a time series plot.  \n6. In the Project Explorer, select the \u201c  Species 1\u201d dataset to make it active.  \n7. Click the Plot Wizard   macro to open the Plot Wizard dialog . \n8. Under Plot Type , select the Activity Dataset Time Series  option.  \n9. Click Finish  to close the Plot Wizard  dialog and generate the plot.  \n10. Using the Select Cells   tool, select the second cell from the left.  \nThe Active Dataset Time Series  plot should appear similar to Figure 2. \n \nFigure 2     The Active Dataset Time Series for the second cell  \n6 Conclusion  \nThis concludes the tutorial. Here are the key concepts from this tutorial:  \n\uf0b7 The MODFLOW -USG Transport MDT package can be used to simulate matrix \ndiffusion from multiple fractures in fractured porous materials.  \n\uf0b7 The MDT package allows an equivalent porous media approach where normal \ngrid elements are used with embedded matrix diffusion occurring over a finite \ndistance in the matrix material in each element.  \n \n00.20.40.60.81.0\n0 10000 20000 30000 40000 50000 60000 70000Active Dataset Time Series\nCell Id: 2Value\nTime\n", "filename": "MODFLOW-USG-MDT_EquivalentPorous.pdf", "pages": 6}, "MODFLOW-USG-MDT_Matrix": {"text": "GMS Tutorials   MODFLOW -USG Transport \u2013 MDT Matrix Diffusion  \n Page 1 of 8 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW -USG Transport \u2013 MDT Matrix Diffusion  \nUse the Matrix Diffusion Transport (MDT) pa ckage in GMS to simulate \nmatrix diffusion in heterogeneous sand/clay system using a semi -\nanalytic approximation   \n \nObjectives   \nLearn how to use the Matrix Diffusion Transport (MDT) package with MODFLOW -USG Transport to \nsimulate  matrix  diffusion in a heterogeneous sand/clay system . \nPrerequisite Tutorials  \n\uf0b7 MOD FLOW -USG  Transport  \n\uf0b7  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW -USG  Transport  \n Time  \n\uf0b7 30\u201340 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Matrix Diffusion  \n Page 2 of 8 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  4 \n3 Activating  the MDT Package  ................................ ................................ ...............................  5 \n4 Defining the MDT Package  ................................ ................................ ................................ .. 5 \n5 Saving and Running MODFLOW  ................................ ................................ ........................  6 \n6 Examining the Results  ................................ ................................ ................................ ........  6 \n7 Conclusion  ................................ ................................ ................................ ...........................  8 \n \n1 Introduction  \nThe Matrix Diffusion Transport package (MDT) works with MODFLOW -USG Transport. \nThe MDT package allows existing flow and chemic al transport models  to be upgraded to \ninclude a full accounting of matrix diffusion effects.  The MDT package is based on the \nsemi -analytic matrix diffusion method implemented in the REMChlor -MD model1, 2, 3. The \ndevelopment of this simulation capability has been supported by the Department of \nDefense Environmental Security Technology Certification Program (ESTCP) and it \nrepresents a collaborative effort between Clemson University, GSI Environmental, and \nAquaveo.  \nThe MDT matrix diffusion method is conceptually similar to dual porosity methods, where \nthe volume of each element is divided into \u201cmobile\u201d and \u201cimmobile\u201d fractions. Solute \ntransport occurs by advection and dispersion in the mobile fraction, but only by diffusion \nin the immobile fraction. With the MDT package, the concentration profile in the immobile \nfraction is approximated using a dynamic function that expresses the concentr ation as a \nfunction of distance from the mobile/immobile interface. This function is recomputed at \neach time step in each element using the current and previous concentrations in the \nmobile fraction, along with the integral of the concentration profile in the immobile \nfraction. The mass transfer to or from the mobile/immobile fractions is then computed as \na linear concentration -dependent source term.  \nThis tutorial demonstrates how the MDT package can be used with a MODFLOW -USG \nTransport simulation to simula te diffusion in a heterogeneous porous media system \nwhere the heterogeneity occurs at the sub -gridblock scale. This example is based on a \nbenchmarking problem that was developed with REMChlor -MD. For a more detailed \ndescription of the semi -analytic method used in the MDT package, please refer to the \nREMChlor -MD user\u2019s guide1 and related journal papers2, 3. The input variables used in \nthe MDT package are described in the MDT Process for MODFLOW -USG Transport \nUser\u2019s Guide4. \n                                                      \n1 Farhat, S.K., C.J. Newell, R.W. Falta, and K. Lynch, 2018. REMChlor -MD User\u2019s Manual, \ndeveloped for the Environmental Security Technology Certification Program (ESTCP) by Clemson \nUniversity, Clemson, SC and GSI Environmental Inc., Houston, TX, https://www.serdp -\nestcp.org/ Program -Areas/Environmental -Restoration/Contaminated -Groundwater/Persistent -\nContamination/ER -201426  \n2 Falta, R.W., and W. Wang, 2017, A semi -analytical method for simulating matrix diffusion in \nnumerical transport models, J ournal of Contaminant Hydrology, V. 197, p. 39 -49. \n3 Muskus, N., and R.W. Falta, 2018, Semi -analytical method for matrix diffusion in heterogeneous \nand fractured systems with parent -daughter reactions, Journal of Contaminant Hydrology , V. 218, \np. 94 -109. \n4Panday, S., R.W. Falta, S. Farhat , K. Pham, and A. Lemon, 2021, Matrix Diffusion Transport \n(MDT) Process for MODFLOW -USG Transport, https://www.gsienv.com/product/modflow -usg/ \nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Matrix Diffusion  \n \n Page 3 of 8 \u00a9 Aquaveo 2024  For this example, a simulation of t he Doner5 (2008) laboratory matrix diffusion experiment \nis performed. The experiment was conducted in a 1.07 x 0.03 x 0.84m tank filled with \nsand and four embedded clay lenses. A tracer solution consisting of 400 mg/L of \nfluorescein was injected into the s and box for 22 days, followed by clean water for 100 \ndays. Diffusion of the fluorescein into the clay lenses resulted in extensive back diffusion \nduring the clean water flushing period. Chapman6 et al. (2012) simulated this experiment \nusing high resolution  2-D numerical models with 9,000 to 24,000 elements.  \nUsing the semi -analytic matrix diffusion method in MDT, the laboratory experiment is \nsimulated using a one -dimensional grid (UGrid) with only 50 elements. With this \napproach, the flow and transport in t he sand is simulated with localized matrix diffusion \ninto and out of the clay lenses using the semi -analytic method. The clay lenses are not \nspecifically discretized; rather they are represented in the model in an average sense, \nusing the volume fraction ( VOLFRACMD) of sand, and the characteristic diffusion length \nin the clay (DIFFLENMD). This example is based on a test problem presented by Muskus \nand Falta3. Additional model parameters are given in Table 1.  \nTable 1.  Input parameters used to simulate Doner5 (2008) experiment  \nParameter  Value  \nDarcy velocity, vx (m/yr)  31.29  \nSand porosity, \u03d5 0.45 \nMatrix porosity, \u03d5l 0.6 \nSand retardation (fl), R 1.39 \nMatrix retardation, Rl 1 \nMatrix tortuosity, \u03c4l 0.3 \nDiffusion coefficient (fl), D (m2/yr) 1.73E -02 \nSource  concentration (fl), C0 (mg/L)  400 \n\u0394x (m) 0.0214  \n\u0394y (m) 0.03 \n\u0394z (m) 0.84 \nSand volume fraction, Vf 0.711  \nCharacteristic diffusion length, L (m) 0.0405  \nNumber of elements ( x-dir) 50 \n\u0394t (d) 0.5 \nNumber of time steps  244 \n \nThis tutorial will demonstrate  the following topics:  \n1. Opening an existing MODFLOW -USG Transport simulation.  \n2. Activating the MDT package.  \n3. Running the simulation and examining the results.  \n                                                      \n5Doner , L.A., 2008, Tools to Resolve Water Quality Benefits of Upgradient Contaminant Flux \nReduction, MS thesis, Colorado State University, Fort Collins, CO.  \n6Chapman, S.W., B.L. Parker, T.C. Sale, and L.A. Doner, 2012, Testing high resolution numerical \nmodels f or analysis of contaminant storage and release from low permeability zones, Journal of \nContaminant Hydrology, 136 -137, 106 -116. \nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Matrix Diffusion  \n \n Page 4 of 8 \u00a9 Aquaveo 2024  2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running , select File | New to ensure that the program settings \nare restored to their default state.  \n3. Click Open   (or File | Open \u2026) to bring up the Open  dialog.  \n4. Browse to the data files for this tutorial  and select \u201cstart.gpr\u201d.  \n5. Click Open  to import the file and close the Open  dialog.  \n6. Click on the Front View   macro to show the sand tank model from the side.  \n \nFigure 1      Imported MODFLOW -USG Transport model  \nThe Graphics Window should appear as in Figure 1. This model has a single layer UGrid . \nSpecified heads (CHD) have been set at each end. A total of 50 elements are used in this \n1D grid. The elements have dimensions of 0.0214 m in the direction of flow (x -direction), \n0.03 m perpendicular to the flow (y -direction) and 0.84 m vertically (z -direction).  \nThe hydraulic head in the leftmost element is maintained at a constant head of 1.3281 m \nusing the CHD package, while the rightmost element is maintained at a head of 1 m. The \nhorizontal hydraulic conductivity was set to a value of 100 m/yr, resul ting in a Darcy \nvelocity of 31.29 m/yr.  \nThe fluorescein (Species 1) is introduced at the upstream end of the grid using a \ntransient concentration boundary (PCB package) with a value of 400 for 0.06023 years \n(22 days), followed by a value of 0 for the rema ining 0.2738 years (100 days).  \nBefore continuing, save the project with a new name.  \n7. Select File | Save As\u2026  to bring up the Save As  dialog.  \n8. Browse to the directory for this tutorial.  \n9. Enter \u201cmodel -mdt2.gpr\u201d as the File name . \n10. Select \u201cProject Files (*.gpr)\u201d fr om the Save as type  drop-down.  \n11. Click Save  to save the project file and close the Save As  dialog.  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Matrix Diffusion  \n \n Page 5 of 8 \u00a9 Aquaveo 2024  3 Activating the MDT Package  \nThe MDT package can now be activated and added to the MODFLOW simulation. To \nactivate the MDT package:  \n1. Switch to the UGrid  module.  \n2. Select MODFLOW | Global Options \u2026 to bring up the MODFLOW Global/Basic \nPackage  dialog.  \n3. Click Packages \u2026 to bring up the MODFLOW Packages / Processes  dialog.  \n4. In the Optional packages  / processes  section, turn on MDT \u2013 Matrix Diffusion \nTransport . \n5. Click OK to exit the MODFLOW Packages  / Processes  dialog.  \n6. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n4 Defining the MDT Package  \nWith the MDT package activated, the parameters for the MDT package can now be \ndefined.  \n1. Select MODFLOW | Optional Packages  | MDT \u2013 Matrix Diffusion Transport \u2026 \nto bring up the MDT Package  dialog.  \n2. In the list on the left, select Variables . \nReview the options here. For this example, the default settings will be used.  \n3. In the list on the left, select Aquifer Properties . \n4. Enter the fol lowing values:  \na. MDFLAG : \u201c2.0\u201d. This variable is a flag that tells the MDT package how \nmatrix diffusion will be handled. Choosing a value of 2 tells the package \nto allow matrix diffusion into embedded low permeability zones with a \nfinite diffusion length.  \na. VOLFRACMD : \u201c0.711\u201d. This is the volume fraction of sand in the \nlaboratory experiment tank. This value was calculated by subtracting the \nclay volume from the total tank volume and dividing by the tank volume3. \nb. PORMD : \u201c0.6\u201d. This is the porosity of the clay.  \nc. RHOBMD : \u201c1.6\u201d. Dry bulk density of the clay.  \nd. DIFFLENMD : \u201c0.04052\u201d. This characteristic diffusion length in the clay \nlenses was estimated using the surface area ( Amd) of the clay lenses3 of \n0.193 m2. Given the total tank volume ( V) of 0.027 m3 and the sand \nvolume fraction ( Vf) of 0.711, the characteristic diffusion length ( L) can be \nestimated from a volume balance on the clay3: (1\u2212\ud835\udc49\ud835\udc53)=\ud835\udc34\ud835\udc5a\ud835\udc51\ud835\udc3f .  \ne. TORTMD : \u201c0.3\u201d. Tortuosity of the clay.  \n5. In the list on the left, select Species Properties . \n6. Enter the following val ues: \na. KDMD : \u201c0.0\u201d. K d value for fluorescein in the clay; set to zero for R=1.  \nb. DIFFMD : \u201c0.0173\u201d. The fluorescein diffusion coefficient, m2/yr. \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Matrix Diffusion  \n \n Page 6 of 8 \u00a9 Aquaveo 2024  7. Click OK to close the MDT Package  dialog.  \n5 Saving and Running MODFLOW  \nThe changes should now be saved before running  MODFLOW -USG Transport.  \n1. Click Save   to save the project.  \n2. Click the Run MODFLOW   macro in the toolbar to bring up the MODFLOW  \nmodel wrapper dialog.  \n3. When MODFLOW finishes, check  on the Read solution on exit  and Turn on \ncontours (if not on already)  boxes.  \n4. Click Close  to close the MODFLOW  model wrapper dialog.  \n5. Click Save   to save the project with the new solution.  \nThe solution set should appear in the Project Explorer.  \n6 Examining the Results  \nIn order to more clearly see how the MDT package impacted the simul ation, compare the \nresults. This can be done by using the Plot Wizard  to create a time series plot.  \n1. In the Project Explorer, select the \u201c  Species 1\u201d dataset to make it active.  \n2. Click the Plot Wizard   macro to open the Plot Wizard dialog . \n3. Under Plot Type , select the Activ e Dataset Time Series  option.  \n4. Click Finish  to close the Plot Wizard  dialog and generate the plot.  \n5. Using the Select Cells   tool, select the last cell on the right in the Graphics \nWindow.  \nThe Active Dataset Time Series  plot should appear similar to Figure 2. \n \nFigure 2     The Active Dataset Time Series for the last cell  \n6. Right -click in the plot and select Display Options  to open the Active Dataset \nTime Series Customization  dialog . \n7. Select the Axis tab.  \n0100200300400\n0 20 40 60 80 100 120Active Dataset Time Series\nCell Id: 50Value\nTime\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Matrix Diffusion  \n \n Page 7 of 8 \u00a9 Aquaveo 2024  8. Change the Y Axis  to Log scale.  \n9. Under Y Axis , select the button next to Min/Max  and set Min to \u201c0.01\u201d and Max to \n\u201c1000\u201d.  \n10. Click OK to exit the Active Dataset Time Series Customization  dialog . \nThe Active Dataset Time Series  plot should update to appear similar to Figure 3. The \nextensive tailing of fluorescein that occurs afte r about 35 days is due to matrix diffusion.  \n \nFigure 3      The Active Dataset Time Series with applied log scale  \nThe results calculated using the MDT Package in MODFLOW -USG Transport4 are \ncompared to the experimental results and t o the REMChlor -MD solution in Figure 4. The \nMDT package results are identical to the REMChlor -MD results and approximate the \nlaboratory data. Results from a fine -grid MO DFLOW/MT3DMS numerical model that \ndiscretized the individual clay lenses (8,988 model cells) by Chapman6 et al. (2012) are \nshown as the yellow line . \n \nFigure 4       Comparison of MODFLOW -USG MDT model (50 model cells) output with \nChapman et al. (2012) MODFLOW/MT3DMS model (8,988 model cells), \nREMChlor -MD (semi -analytic)  model (50 model cells), and observed \nconcentrations  \n-210-110010110210310\n0 20 40 60 80 100 120Active Dataset Time Series\nCell Id: 50Value\nTime\n\nGMS Tutorials   MODFLOW -USG Transport \u2013 MDT Matrix Diffusion  \n \n Page 8 of 8 \u00a9 Aquaveo 2024  7 Conclusion  \nThis concludes the tutorial. Here ar e the key concepts from this tutorial:  \n\uf0b7 The MODFLOW -USG Transport MDT package can be used to simulate matrix \ndiffusion in heterogeneous porous media for cases where diffusion occurs at the \nsub-gridblock scale.  \n\uf0b7 Normal grid elements are used with embedded ma trix diffusion occurring over a \nfinite distance in the matrix material in each element.  \n \n", "filename": "MODFLOW-USG-MDT_Matrix.pdf", "pages": 8}, "MODFLOW-USG-PEST": {"text": "GMS Tutorials   MODFLOW -USG \u2013 PEST  \n Page 1 of 11 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW -USG \u2013 PEST  \nModel calibration with PEST  \n \nObjectives   \nThis tutorial shows how to calibrate a MODFLOW -USG model using PEST . \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Model \nCalibration  \n\uf0b7 MODFLOW \u2013 Automated \nParameter Estimation  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 PEST  \n Time  \n\uf0b7 15\u201320 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW -USG \u2013 PEST  \n Page 2 of 11 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n1.2 Importing the Project  ................................ ................................ ................................ ..... 2 \n2 Converting to a MODFLOW -USG Model  ................................ ................................ ............  4 \n2.1 Saving and Running MODFLOW -USG  ................................ ................................ .........  4 \n2.2 Defining Observation Data  ................................ ................................ ............................  5 \n2.3 Resaving the Project and Running MODFLOW -USG  ................................ ...................  5 \n2.4 Running PEST  ................................ ................................ ................................ ..............  6 \n3 MODFLOW \u2013USG with PEST  ................................ ................................ ...............................  7 \n3.1 Importing a Project with Pilot Points  ................................ ................................ .............  7 \n3.2 Running PEST  ................................ ................................ ................................ ..............  8 \n4 Importing a Project to Use with SVD Assist  ................................ ................................ ...... 9 \n4.1 Running PEST  ................................ ................................ ................................ ............  10 \n5 Conclusion  ................................ ................................ ................................ .........................  11 \n \n1 Introduction  \nThis tutorial discusses and demonstrates opening a MODFLOW model and solution, \nconverting it to a MODFLOW -USG model, running PEST, and loading optimal parameter \nvalues.  \nThe \u201c MODFLOW  \u2013 Automated Parameter Estimation\u201d tutorial should be completed prior \nto be ginning this tutorial.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n1.2 Importing the Project  \nFirst to import the modeling project:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the data file directory for this tutorial and select \n\u201cmf2k_pest_zones .gpr\u201d. \n4. Click Open  to import the project and exit  the Open  dialog.  \nThe imported project should appear similar to Figure 1. \n\nGMS Tutorials   MODFLOW -USG \u2013 PEST  \n \n Page 3 of 11 \u00a9 Aquaveo 2024   \n      Figure 1      Initial screen after importing the project  \nNotice that there is now a MODFLOW model with a solution and a set of map coverages \n(Figure 2). Three of the coverages are the source/sink, recharge, and hydraulic \nconductivity coverages used to define the conceptual model. The active coverage \ncontains a set of observed head values from observation wells.  \nFeel free to switch to the \u201c  Sources & Sinks\u201d coverage and use the Select Arc Group  \n tool to select the stream ne twork. This makes the observed flow value visible in the \nstatus bar. Switch back to the \u201c  Observation Wells\u201d coverage when done.  \n \n      Figure 2      Initial appearance of the Project Explorer  \n\nGMS Tutorials   MODFLOW -USG \u2013 PEST  \n \n Page 4 of 11 \u00a9 Aquaveo 2024  2 Converting to a MODFLOW -USG Model  \nThe existing model is a MODFLOW -2000 model. This will be converted to a MODFLOW -\nUSG model before running PEST.  \n1. Right -click on\u201d  MODFLOW\u201d in the Project Explorer and select Convert to \nMODFLOW -USG Simulation \u2026 to bring up a prompt asking to include inactive \ncells in the new UGrid.  \n2. Click No to close the prompt.  \n3. Click OK to acknowledge that the PCG package is not supported by MODFLOW -\nUSG.  \n4. Right -click on \u201c  3D Grid Data \u201d in the Project Explorer and select Delete  to \nremove the 3D grid from the project.  \n5. Select the \u201c  elevation\u201d dataset.  \nThe model should now appear similar to Figure 3. \n \n      Figure 3      Model after conversion to MODFLOW -USG  \n2.1 Saving and Running MODFLOW -USG  \nNext to save the project and run MODFLOW -USG:  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Enter \u201c mfusg_pest .gpr\u201d as the File name .  \n3. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n4. Click Run MOD FLOW   to bring up the MODFLOW  model wrapper dialog.  \n5. Once MODFLOW -USG has finished, turn on Read solution on exit  and Turn on \ncontours (if not on already) . \n\nGMS Tutorials   MODFLOW -USG \u2013 PEST  \n \n Page 5 of 11 \u00a9 Aquaveo 2024  6. Click Close  to import the solution and exit the MODFLOW  dialog.  \nNotice that the contours for the com puted MODFLOW heads are now visible ( Figure 4), \nhowever, the targets for the MODFOW -USG observations wells are not displayed. The \ndata for MODFLOW -USG observations must be generated and saved with the project for \nthese calculations to occur.  \n \n      Figure 4       Imported solution after initial MODFLOW -USG run  \n2.2 Defining Observation Data  \nTo create the MODFLOW -USG observation input data, use th e following steps:  \n1. Select MODFLOW  | Observations \u2026 to bring up the MODFLOW -USG \nObservations dialog.  \n2. Select \u201cWells\u201d from the list on the left.  \n3. Click Generate PEST Obs. Data\u2026  to bring up the Generate Observations  \ndialog.  \n4. In the Head Observation Coverages  section, turn on \u201cObservation Wells\u201d.  \n5. In the Flow Observation Coverages  section, turn on \u201cSources & Sinks\u201d.  \n6. Click OK to generate the observation input data and exit the Generate \nObservations  dialog.  \n7. Click OK to exit the MODFLOW -USG Observations  dialog.  \n2.3 Resavin g the Project and Running MODFLOW -USG  \nNow that the observation data is part of the model setup, save and rerun MODFLOW.  \n1. Save   the project.  \n2. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n\nGMS Tutorials   MODFLOW -USG \u2013 PEST  \n \n Page 6 of 11 \u00a9 Aquaveo 2024  3. Once MODFLOW -USG finishes running, turn on Read solution on exit  and Turn \non contours (if not on already) . \n4. Click Close  to import the solution and close the MODFLOW  dialog.  \nNotice that the calibration targets now appear ( Figure 5). \n \n      Figure 5      Calibration targets are now visible  \n2.4 Running PEST  \nThe original MODFLOW -2000 model included in the initial project had parameters \ndefined. These  parameters were copied to the MODFLOW -USG model. To run PEST , \nchange the model run type to Parameter Estimation . \n1. Select MODFLOW  | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage  dialog . \n2. In the Run options  section, select Parameter Estimation . \n3. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n4. Save   the project.  \n5. Click Run MODFLOW   to bring up the MODFLOW/PEST Paramet er \nEstimation dialog.  \n6. Once PEST has finished, turn on Read solution on exit  and Turn on contours (if \nnot on already).  \n7. Click  Close  to import the solution and close the MODFLOW/PEST Parameter \nEstimation  dialog . \nIn the interest of time, the maximum number of PEST iterations has been limited to 3. If \nthe number of PEST iterations were increased to 10, the model error is less than 11.5.  \nNotice that some of the observation well targets are yellow, indicating that the error has \ndecreased. ( Figure 6). The calculated error norms can now be ins pected.  \n\nGMS Tutorials   MODFLOW -USG \u2013 PEST  \n \n Page 7 of 11 \u00a9 Aquaveo 2024   \n      Figure 6      Some observation well targets are yellow  \n8. Right -click on \u201c  mfusg_pest (MODFLOW)\u201d in the Project Explorer and select \nProperties\u2026  to bring up the Properties  dialog . \nThis dialog displays the model residuals for head and flow as well as the weighted \nresiduals for the combination of head and flow. The Sum of Squared Weighted Residual \n(Head + Flow)  for this model should be approximately \u201c554.0\u201d.  \n9. Click  OK to exit the Prope rties dialog.  \n10. Save   the project.  \n3 MODFLOW \u2013USG with PEST  \n3.1 Importing a Project with Pilot Points  \nPilot points can also be used with MODFLOW -USG and PEST. For more information \nabout pilot points, refer to the \u201cMODFLOW \u2013 PEST Pilot Points\u201d tutorial.  \nNow import a MODFLOW -USG model with pilot points and run PEST by doing the \nfollowing:  \n1. Select File | New to reset GMS back to the default settings . \n2. Click Open   to bring up the Open  dialog.  \n3. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n4. Select \u201cmfusg _pilot .gpr\u201d. \n5. Click Open  to import the project and close the Open  dialog.  \nThe imported project should appear similar to Figure 7. This is a MODFLOW -USG model \nof the s ame area, but with a quadtree grid. The grid is refined around the pumping wells, \n\nGMS Tutorials   MODFLOW -USG \u2013 PEST  \n \n Page 8 of 11 \u00a9 Aquaveo 2024  river, and specified head boundary. The red points are 2D scatter points that will be used \nas pilot points to estimate the HK of the model.  \n \n      Figure 7      Quadtree model with pilot points  \n3.2 Running PEST  \nThe current model is a forward run and must be changed to the Parameter Estimation  \noption to run PEST.  \n1. Select MODFLOW  | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage  dialog.  \n2. In the Run options  section, select Parameter Estimation . \n3. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n4. Select MODFLOW  | Parameter Estimation \u2026 to bring up the PEST  dialog.  \nNotice the Max number of iterations  is set to \u201c2\u201d. Now to save the project and r un PEST:  \n5. Click OK to exit the PEST  dialog.  \n6. Select File | Save As \u2026 to bring up the Save As  dialog.  \n7. Enter \u201c mfusg_pilot_pest .gpr\u201d as the File name .  \n8. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n9. Click Run MODFLOW   to bring up the MODFLOW /PEST Parameter \nEstimation  dialog.  \n10. Once parallel PEST finishes, turn on Read solution on exit  and Turn on contours \n(if not on already) . \n11. Click Close  to import the solution and close the MODFLOW/PEST Parameter \nEstimation  dialog.  \n\nGMS Tutorials   MODFLOW -USG \u2013 PEST  \n \n Page 9 of 11 \u00a9 Aquaveo 2024  In the interest of time, the maximum number of PEST iterations has been limited to 2. If \nthe number of PEST iterations increased to 10, the model error is less than 1.0.  Notice \nthat a few of the observation well targets are yellow, indicating that the error has \ndecreased ( Figure 8).  \nThe calculated error norms can now be inspected.  \n12. Right -click on \u201c  mfusg_pilot_pest (MODFLOW)\u201d in the Project Explorer and \nselect Properties \u2026 to bring up the Properties  dialog.  \nThis dialog shows the model residuals for head and flow as well as the weighted \nresiduals for the combination of head and flow. The Sum of Squared Weighted Residual \n(Head + Flow)  for this model should be approximately \u201c 2800.64\u201d.  \n13. Select OK to exit the Properties  dialog.  \n14. Save   the project.  \n \n      Figure 8      Observation well targets match the model outputs  \n4 Importing a Project to Use with SVD Assist  \nPEST has tools for working with models that ha ve hundreds of parameters. This PEST \ntool is called SVD Assist. SVD Assist can also be used with MODFLOW -USG models. \nThe final step in this tutorial uses a model with over 200 parameters and use PEST SVD \nAssist to calibrate the model.  \n1. Select File | New to reset back to defaults . \n2. Click Open   to bring up the Open  dialog.  \n3. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n4. Select \u201cmfusg_svda .gpr\u201d and click Open  to import the project and exit the Open  \ndialog.  \nThe imported project should appear s imilar to Figure 9. \n\nGMS Tutorials   MODFLOW -USG \u2013 PEST  \n \n Page 10 of 11 \u00a9 Aquaveo 2024  This is a MODFLOW -USG model of the same area, but using a Voronoi grid. The grid is \nrefined around the pumping wells, river, and specified head bo undary. The observation \nwell locations were used to generate the grid, and each observation well is placed at the \ncenter of a cell. The blue points are 2D scatter points that will be used as pilot points to \nestimate the HK of the model.  \n \n      Figure 9      Voronoi grid with refinement  \n4.1 Running PEST  \nThe current model is a forward run and must be changed to the Parameter Estimation  \noption to run PEST.  \n1. Select MODFLOW  | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage  dialog. \n2. In the Run options  section, select Parameter Estimation . \n3. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n4. Select MODFLOW  | Parameter Estimation \u2026 to bring up the PEST  dialog.  \nNotice that in the Parallel PEST  section, Use Parallel PEST  is turned on. Parallel PEST \nwill be used to calibrate this model. Also notice that in the SVD options  section, Use \nSVD-Assist is turned on.  \nNow to save the project and run PEST:  \n5. Click OK to exit the PEST  dialog.  \n6. Select File | Save As \u2026 to bring up the Save As dialog.  \n7. Enter \u201c mfusg_svda_pest .gpr\u201d as the File name .  \n8. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n9. Click Run MODFLOW   to bring up the MODFLOW /PEST Parameter \nEstimation  dialog.  \n\nGMS Tutorials   MODFLOW -USG \u2013 PEST  \n \n Page 11 of 11 \u00a9 Aquaveo 2024  When using SVD Assist, PEST will first run the model one time for every parameter. The \ninformation generated from that first run is used to make groups of super parameters that \nare then estimated by PEST. Notice that the first parameter estimation iteratio n required \n235 model runs and that the subsequent iterations only require 11 model runs.  \n10. Once Parallel PEST finishes, turn on Read solution on exit  and Turn on contours \n(if not on already) . \n11. Click Close  to import the solution and close the MODFLOW/PEST Para meter \nEstimation  dialog.  \nIn the interest of time, the maximum number of PEST iterations has been limited to 2. If \nthe number of PEST iterations increased to 15, the model error is less than 2.0.  Notice \nthat a few of the observation well targets are yellow , indicating that the error has \ndecreased ( Figure 10). The calculated error norms can also be inspected.  \n \n      Figure 10      Observation well targets and model outputs match  \n12. Right -click on \u201c  mfusg_svda_pest (MODFLOW)\u201d in the Project Explorer and \nselect Properties\u2026  to bring up the Properties  dialog.  \nThis dialog shows the model residuals for head and flow as well as the weight ed \nresiduals for the combination of head and flow. The Sum of Squared Weighted Residual \n(Head + Flow)  for this model should be approximately \u201c5,088\u201d.  \n13. Select OK to exit the Properties  dialog.  \n14. Save   the project.  \n5 Conclusion  \nThis concludes the \u201c MODFLOW -USG  \u2013 PEST\u201d  tutorial. The following key topics were \ndiscussed and demonstrated:  \n\uf0b7 PEST can be used with MODFLOW -USG.  \n\uf0b7 Parallel PEST, pilot points, and SVD Assist can also be used with MODFLOW -\nUSG.  \n\n", "filename": "MODFLOW-USG-PEST.pdf", "pages": 11}, "MODFLOW-USG-Quadtree": {"text": "GMS Tutorials   MODFLOW -USG \u2013 Quadtree  \n Page 1 of 12 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW -USG \u2013 Quadtree  \nCreate a MODFLOW -USG model with a locally refined UGrid using \nGMS  \n \nObjectives   \nGMS supports building MODFLOW -USG models with quadtree UGrids. This tutorial shows how to \ngenerate a smoothed quadtree UGrid for a complex model . \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach I  \n\uf0b7 UGrid Creation  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 25\u201340 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   MODFLOW -USG \u2013 Quadtree  \n Page 2 of 12 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 Open the  Starting Project  ................................ ................................ .............................  3 \n2.2 Save with a Different Name  ................................ ................................ ..........................  4 \n3 Create the Conceptual Model  ................................ ................................ .............................  4 \n3.1 Create the Areal Coverage  ................................ ................................ ...........................  4 \n3.2 Setup the Sources and Sinks Coverage  ................................ ................................ ....... 5 \n3.3 Assign Specified Head  ................................ ................................ ................................ .. 5 \n3.4 Assign Rivers  ................................ ................................ ................................ ................  6 \n3.5 Assign Wells  ................................ ................................ ................................ .................  7 \n3.6 Refinement for Grid Generation  ................................ ................................ ....................  7 \n4 Create the Unstructured Grid  ................................ ................................ .............................  8 \n5 Create a MODFLOW -USG Model  ................................ ................................ ......................  10 \n6 Set Grid Elevations  ................................ ................................ ................................ ............  10 \n7 Map to MODFLOW  ................................ ................................ ................................ .............  11 \n8 Save and Run MODFLOW  ................................ ................................ ................................ . 12 \n9 Conclusion  ................................ ................................ ................................ .........................  12 \n \n1 Introduction  \nMODFLOW -USG was developed to allow for a wide variety of grid geometries, including \nthe ability for increased grid resolution around rivers, wells, and other areas of intere st.1 \nOne such type of unstructured grid (UGrid) is a smoothed quadtree UGrid. In a smoothed \nquadtree UGrid, the largest sized cell is refined near areas of interest by splitting each \nsuccessive neighboring cell into four cells until the desired cell size i s reached.  \nGMS has the ability to easily generate smoothed quadtree UGrids from a conceptual \nmodel. Areas of interest can be identified on specific conceptual model objects including \npoints, arcs, and polygons.  \nThe problem in this tutorial is illustrated i n Figure 1. The model is based on the quadtree \nexample problem included with MODFLOW -USG.2 The model consists of a specified \nhead boundary along the ocean to the righ t of the model. It also includes a network of \ncanals modeled using the RIV package and wells modeled using the WEL package.  \nThe locations of the boundary conditions are provided by shapefiles and the elevations \nby raster files. The generated grid is one l ayer thick and contains base cells (the largest \ncells) that are 800 m by 800 m. At specified head and river boundary conditions, the cells \nare refined down to 100 m; and at wells, the cells are refined down to 50 m.  \nThis tutorial will demonstrate and discuss:  \n\uf0b7 Importing an existing GMS project containing model shapefiles.  \n\uf0b7 Creating a conceptual model using the shapefile geometry.  \n\uf0b7 Turning on refinement for grid generation.  \n\uf0b7 Creating a quadtree UGrid.  \n\uf0b7 Creating a MODFLO W-USG model.  \n\uf0b7 Mapping to MODFLOW.  \n\uf0b7 Running the model and examining the results.  \n                                                      \n1 Panday, Sorab; Langevin, Christian.D.; Niswonger, Richard G.; Ibaraki, Motomu; and Hughes, \nJoseph D., (2013). \u201cMODFLOW \u2013USG version 1: An Unstructured Grid  Version of MODFLOW for \nSimulating Groundwater Flow and Tightly Coupled Processes Using a Control Volume Finite -\nDifference Formulation\u201d in Techniques and Methods 6 \u2013A45,U.S. Geological Survey, 66 p.  \n2 Panday, et al (2013).  \nGMS Tutorials   MODFLOW -USG \u2013 Quadtree  \n \n Page 3 of 12 \u00a9 Aquaveo 2024   \n      Figure 1      The Biscayne Bay area of Miami, Florida  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2.1 Open the Starting Project  \nTo open a GMS project that already has the shapefiles which contain the model \ngeometry:  \n1. Click Open   to bring up  the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the Quadtree \\Quadtree \\ directory and select \u201cstart.gpr\u201d.  \n4. Click Open  to import the project and exit the Open  dialog.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Quadtree  \n \n Page 4 of 12 \u00a9 Aquaveo 2024  2.2 Save with a Different Name  \nBefore making any c hanges, it is best to save the project under a new name.  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c biscayne.gpr \u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \nSave   periodically throughout the project.  \n3 Create the Conceptual Model  \nTo create a conceptual model:  \n1. Right -click in a blank space in the Project Explorer  and select New | Conceptual \nModel \u2026 to open the Conceptual Model Properties  dialog . \n2. Enter  \u201cBiscayne \u201d as the Name . \n3. Click OK to close the Conceptual Model Properties  dialog.  \n3.1 Create the Areal Coverage  \nNow to create a coverage with horizontal conductivity and recharge areal properties:  \n1. Right-click on \u201c Biscayne\u201d  in the Project Explorer  and select New Coverage \u2026 \nto open the Coverage Setup dialog . \n2. Enter \u201cAreal\u201d as the  Coverage name . \n3. In the Areal Properties  column,  turn on Recharge rate  and Horizontal K . \n4. Turn on Use to define model boundary  (active area) . \n5. Click OK to create the coverage and close the Coverage Setup  dialog.  \nNext, to convert the shape files to feature objects and build polygons:  \n6. Under \u201c  GIS Layers \u201d in the Project Explorer , turn on \u201c  Biscayne.shp \u201d. \n7. Right -click on \u201c Biscayne.shp \u201d and select Convert To | Feature Objects  to open \nthe GIS to Feature Objects Wizard dialog.  \n8. Click Next  to go to the Step 2 of 3 page of the GIS to Feature Objects Wizard  \ndialog.  \n9. Click Next  to go to the Step 3of 3 page of the GIS to Feature Objects Wizard  \ndialog.  \n10. Click Finish  to create the feature objects and close the GIS to Feature Objects \nWizard  dialog.  \n11. Select \u201c  Areal \u201d in the Project Explorer  to make it active.  \n12. Click Build Polygons  . \n13. Right -click on \u201c  Areal \u201d and select Attribute Table \u2026 to open the Attribute Table \ndialog.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Quadtree  \n \n Page 5 of 12 \u00a9 Aquaveo 2024  14. From the Feature type  drop-down, select \u201c Polygons \u201d. \n15. In the All row in the Recharge rate  column, enter \u201c 1.0e-4\u201d. \n16. In the All row in the Horizontal K  column, enter \u201c 400.0\u201d. \n17. Click OK to save the values and close the Attribute  Table  dialog.  \n3.2 Setup  the Sources and Sinks Coverage  \nNow to create a coverage containing the specified head, river, and well boundary \nconditions:  \n1. Right -click on \u201c  Biscayne \u201d in the Project Explorer  and select New Coverage \u2026 \nto bring up the Coverage Setup  dialog.  \n2. Enter \u201c Sources -Sinks \u201d as the Coverage name . \n3. In the Sources/Sinks/BCs  column, turn on Wells , Specified Head (IBOUND) , and \nRiver .  \n4. Click OK to create the coverage and close the Coverage Setup  dialog.  \nNow it is possible to copy the specified head, river, and w ell geometry from the shapefile \nto the coverage.  \n5. Turn on \u201c  Wells.shp \u201d in the Project Explorer . \n6. Right -click on \u201c  Wells.shp \u201d and select Convert To | Feature Objects  to bring \nup the GIS to Feature Objects Wizard  dialog.  \n7. Make certain both \u201cBiscayne.shp\u201d and  \u201cWells.shp\u201d are selected under Select \nshapefiles to map . \n8. Click Next  to go to the Step 2 of 4 page of the GIS to Feature Objects Wizard  \ndialog.  \n9. Click Next  to go to the Step 3 of 4 page of the GIS to Feature Objects Wizard  \ndialog.  \n10. Click Next  to go to the Step 4 of 4  page of the GIS to Feature Objects Wizard  \ndialog.  \n11. Click Finish  to create the feature objects and close the GIS to Feature Objects \nWizard  dialog.  \n12. Turn off \u201c  Biscayne.shp \u201d and \u201c  Wells.shp \u201d in the Project Explorer . \n3.3 Assign Specified Head  \nNow it is  necessary to set the arc types by setting up the specified head arcs.  \n1. Select \u201c  Sources -Sinks \u201d in the Project Explorer  to make it active.  \n2. Using the Select Arcs   tool, select the 14 arcs along the coastline by holding \ndown the Shift key and clicking on each arc. Zoom   in if necessary.  \n3. Right -click on one of the selected arcs and choose Attribute Table \u2026 to open the \nAttribute Table  dialog.  \n4. Select \u201cspec. head (IBOUND)\u201d from the drop -down in the All row of the Type  \ncolumn. This changes the arcs to specified head.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Quadtree  \n \n Page 6 of 12 \u00a9 Aquaveo 2024  5. Click OK to save the values and close the Attribute Table  dialog.  \n6. Do not  unselect the arcs.  \nThe map should now look similar to Figure 2 (note that the arcs are all still selected). If \nnecessary, select any missed arcs and assign the boundary condition by following the \nsteps above. Once done, reselect all of the coastline arcs by following step 2 above.  \n \n      Figure 2      Specified head boundary condition applied to arcs on coastline  \n3.4 Assign Rivers  \nNow to set up the river arcs:  \n1. With the coastal arcs still selected, select Edit | Invert Selection . \n2. Right -click on \u201c  Sources -Sinks \u201d and select Attrib ute Table \u2026 to bring up the \nAttribute Table  dialog.  \n3. In the All row, select \u201criver\u201d from the drop -down in the Type column.  \n4. In the All row, enter \u201c5000.0\u201d in the Cond.  (m^2/d)/(m)  column.  \n5. Select \u201cNodes\u201d from the Feature type  drop-down.  \n6. Select \u201criver\u201d from the BC type  drop-down.  \nTo set the river stage and bottom elevation, the rasters that were included in the starting \nproject will be used.  \n7. In the All row, click on the  button in the Head -Stage  (m) column and select \n\u201c<Raster>\u201d from the d rop-down to bring up the Select Raster  dialog.  \n8. Select \u201c RiverStage.tif \u201d and click OK to close the Select Raster  dialog.  \n9. In the All row, click on the  button in the Bot. elev.  (m) column and select \n\u201c<Raster>\u201d from the drop -down to bring up the Select Raster  dialog.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Quadtree  \n \n Page 7 of 12 \u00a9 Aquaveo 2024  10. Select \u201c RiverBottoms.tif \u201d and click OK to close the Select Raster  dialog.  \n11. Click OK to close the Attribute Table  dialog.  \n12. Do not  unselect the arcs.  \n3.5 Assign Wells  \nNow to assign the wells:  \n1. Right -click on \u201c  Sources -Sinks \u201d and select Attribute Table \u2026 to bring up the \nAttribute Table  dialog.  \n2. Select \u201cPoints\u201d from the Feature type  drop-down.  \n3. In the All row, select \u201cwell\u201d from the drop -down in the Type  column.  \n4. In the All row, enter \u201c -700.0\u201d in the Flow rate (m^3/d)  column.  \n5. Click OK to save the values and close the Attribute Table  dialog.  \n6. Deselect the arcs by clicking in a blank area in the Graphics Window.  \nThe map should now appear similar to Figure 3. \n \n      Figure 3      Biscayne area conceptual model  \n3.6 Refinement for Grid Generation  \nTo generate the quadtree grid, it is necessary to turn on refinement for the areas of \ninterest. For this model, this involves turning on re finement for the specified head, river \nboundary conditions, and wells.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Quadtree  \n \n Page 8 of 12 \u00a9 Aquaveo 2024  1. Right -click on \u201c  Sources -Sinks \u201d and select Coverage Setup\u2026  to open the \nCoverage Setup dialog.  \n2. In the Sources/Sinks/BCs  column, turn on Refinement . \n3. Click OK to close the Coverage Setup  dialog.  \nNow it is necessary to turn on refinement for each object, beginning with the wells.  \n4. Right -click on \u201c  Sources -Sinks \u201d and select Attribute Table \u2026 to open the \nAttribute Table dialog.  \n5. Select \u201cPoints\u201d from the Feature type  drop-down.  \n6. In the All row, check the box in the Refine  column.  \n7. In the All row, enter \u201c60.0\u201d in the Base size  (m) column. Scroll over to the column \nif necessary.  \nWhen the grid is generated, the cells that contain the wells will be sized to the first cell \nsize below \u201c60.0\u201d. To generat e the grid, the cell size starts at the base cell size and then \ngets divided by two until the size is below \u201c60.0\u201d. The base cell is 800 m, so a Base size  \nof 60 m will result in cell refined to 400 m, 200 m, 100 m, and then 50 m.  \nThe next step is to set th e refinement for the specified head and river arcs. For the river \narcs, it is ideal for the cells to be refined to 100 m, so set the size slightly above 100 m.  \n8. Select \u201cArcs\u201d from the Feature type  drop-down.  \n9. In the All row, check the box in the Refine  colum n. \n10. In the All row, enter \u201c110.0\u201d in the Base size  (m) column.  \n11. Click OK to close the Attribute Table  dialog.  \n4 Create the Unstructured Grid  \nNow it is necessary to set the dimensions of the unstructured grid by using a grid frame. \nThe quadtree UGrid  can be generated without a grid frame, but a grid frame gives more \nprecise control over the size of the generated cells.  \nFor this model, it is ideal to set the base grid cell size (or largest cell size) to 800 m. To \ndo so, use a grid frame set with dimens ions that are a multiple of 800 m.  \n1. Right -click in a blank space in the Project Explorer and select New | Grid Frame . \nA new grid frame should appear . \n2. Right -click on \u201c  Grid Frame \u201d in the Project Explorer  and select Fit To Active \nCoverage . \n3. Right -click on \u201c  Grid Frame \u201d and select Properties \u2026 to open the Grid Frame \nProperties  dialog.  \n4. In the Value  column, enter the values from the table below:  \nOrigin x:  543750.0  \nOrigin y:  2793450.0  \nOrigin z:  0.0 \nDimension x:  44000.0  \nDimension y:  79200.0  \nDimension z:  10.0 \n\nGMS Tutorials   MODFLOW -USG \u2013 Quadtree  \n \n Page 9 of 12 \u00a9 Aquaveo 2024  5. Click OK to exit the Grid Frame Properties  dialog.  \nThe grid frame will adjust to the more specific dimensions just entered. This gives a base \ngrid with 44 columns and 99 rows.  \nNow it is possible to create the quadtree UGrid. While a grid frame can be used to \ndetermine the dimensions of the grid cells, the polygons in the active coverage determine \nthe boundary of the generated cells. If there are no polygons in the active coverage, the \ngenerated cells will fill the grid frame.  \nFor the grid, use the polygons  in the \u201c Areal \u201d coverage.  \n6. Select \u201c  Areal \u201d in the Project Explorer  to make it active.  \n7. Right -click on \u201c  Grid Frame \u201d and select Map To | UGrid to open the Map \u2192 \nUGrid  dialog.  \n8. Select \u201cQuadtree/Octree\u201d from the UGrid type drop-down.  \n9. In the X-Dimension section, select Cell size  as the Cell size method  and enter \n\u201c800.0\u201d as the Cell size . \n10. In the Y-Dimension section, select Cell size  as the Cell size method  and enter \n\u201c800.0\u201d as the Cell size . \n11. In the Z-Dimension section, enter \u201c1\u201d as the Number of cells .  \n12. The options in the Map \uf0d2 UGrid  dialog should match those shown in Figure 4. \n \n      Figure 4      Map \u2192 UGrid dialog  \n13. Click OK to exit the Map \u2192  UGrid  dialog and generate the unstructured grid.  \n14. Right -click on \u201c  Biscayne.tif\u201d in the Project Explorer and select \nTran sparency\u2026  to bring up the Layer Transparency  dialog.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Quadtree  \n \n Page 10 of 12 \u00a9 Aquaveo 2024  15. Set the Transparency  slider to \u201c30%\u201d and click OK to close the Layer \nTransparency  dialog. This makes the UGrid easier to see.  \nThe new quadtree UGrid should appear similar to Figure 5. \n \n      Figure 5      Quadtree grid  \nIt is now possible to check how many cells were generated.  \n16. Right -click on \u201c ugrid \u201d in the Project Explorer  and select Properties \u2026 to open \nthe UGrid Properties dialog.  \nThe generated unstructured grid has around 28,000 cells. Generating a structured grid \nfor the same model using a cell size of 100 m results in a grid with about 185,000 cells.  \n17. Click OK to exit the UGrid Properties  dialog.  \n5 Create a MODFLOW -USG Model  \nNow it is possible to create the MODFLOW -USG model.  \n1. Select MODFLOW | New Simulation \u2026 to bring up the MODFLOW Global/Basic \nPackage  dialog.  \n2. Click OK to accept the defaults and exit the MODFLOW Global/Basic Package  \ndialog.  \n6 Set Grid Elevations  \nThe top and bottom elevations for the model need to be set up. This tutorial will \ninterpolate raster  elevations to MODFLOW layers.  \n\nGMS Tutorials   MODFLOW -USG \u2013 Quadtree  \n \n Page 11 of 12 \u00a9 Aquaveo 2024  1. Right -click on \u201c  Tops.tif \u201d in the \u201c  GIS Layers\u201d folder in the Project Explorer  \nand select Interpolate To | MODFLOW Layers \u2026 to bring up the Interpolate to \nMODFLOW Layers  dialog.  \nThe \u201cTops.tif \u201d dataset has automatically been mapped to \u201cTop Elevations Layer 1\u201d in the \narray in the Dataset \u2192 MODFLOW data  section. Now map \u201cBottoms.tif\u201d to \u201cBottom \nElevation Layer 1\u201d.  \n2. In the Dataset \u2192 MODFLOW  data section, select the \u201cRiverBottom.tif \u201d then \nselect Unmap . \n3. In the Rasters list, select \u201c Bottoms.tif \u201d. \n4. In the MODFLOW data  list, click on \u201c Bottom Elevations Layer 1 \u201d. \n5. Click Map to add the mapping to the array in the Dataset \u2192 MODFLOW data  \nsection.  \n6. Click OK to interpolate the top and bottom values to the MODFLOW model and \nclose the Interpolate to MODFLOW Layers  dialog.  \n7 Map to MODFLOW  \nNow to assign  the conceptual model values to the MODFLOW model:  \n1. Select \u201c  Biscayne \u201d in the Project Explorer  to make it active.  \n2. Select Feature Objects | Map \u2192 MODFLOW  to bring up the Map \u2192 Model  \ndialog.  \n3. Click OK to accept the defaults and close the Map \u2192 Model  dialog.  \nThe boundary condition symbols for specified head, rivers, and wells should appear \n(Figure 6). \n \n      Figure 6      MODFLOW boundary conditi ons assigned from the conceptual model  \n\nGMS Tutorials   MODFLOW -USG \u2013 Quadtree  \n \n Page 12 of 12 \u00a9 Aquaveo 2024  8 Save and Run MODFLOW  \nNow it is possible to run MODFLOW.  \n1. Save   the project.  \n2. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n3. When the model finishes, turn on Read solution on exit  and Turn on contours  (if \nnot on already) . \n4. Click Close  to import the solution and exit the MODFLOW  model wrapper dialog.  \nThe Graphics Window should appear similar to Figure 7. \n \n      Figure 7      MODFLOW -USG head contours  \n9 Conclusion  \nThis concludes the \u201cMODFLOW -USG \u2013 Quadtree\u201d tutorial. The following key concepts \nwere discussed and demonstrated in this tutorial:  \n\uf0b7 GMS supports generating smoothed quadtree UGrids  that can be used with \nMODFLOW -USG.  \n\uf0b7 The localized cell refinement for a generated grid can be controlled by turning on \nrefinement  and setting the base size  in the  conceptual model.  \n\uf0b7 Polygons in the active coverage determine the area in which cells are gener ated.  \n\uf0b7 A grid frame can be used to further control the size and position of the generated \ncells.  \n\n", "filename": "MODFLOW-USG-Quadtree.pdf", "pages": 12}, "MODFLOW-USG-RegionalToLocal": {"text": "GMS Tutorials   MODFLOW -USG \u2013 Regional to Local Model Conversion  \n Page 1 of 12 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW -USG \u2013 Regional to Local Model Conversion  \nCreate a locally refined area in a regional model using MODFLOW -\nUSG and GMS  \n \nObjectives   \nUse the tools provided in GMS to locally refine an area in a regional model . \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach I  \n\uf0b7 MODFLOW -USG \u2013 \nQuadtree  \n\uf0b7 UGrid  Creation  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 Geostatistics  \n\uf0b7 MODFLOW  Interface  \n Time  \n\uf0b7 15\u201330 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   MODFLOW -USG \u2013 Regional to Local Model Conversion  \n Page 2 of 12 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 Reading in the Regional Model  ................................ ................................ .....................  3 \n2.2 Saving with a Different Name  ................................ ................................ .......................  4 \n3 Creating a UGrid  ................................ ................................ ................................ ..................  4 \n3.1 Defining the Refined Area  ................................ ................................ .............................  6 \n3.2 Creating a 3D Refined UGrid  ................................ ................................ ........................  7 \n4 Converting the Layer Data to a Scatter Point Set  ................................ .............................  9 \n5 Creating a MODFLOW -USG Model  ................................ ................................ .....................  9 \n6 Interpolating Layer Elevations  ................................ ................................ ...........................  9 \n7 Mapping to MODFLOW  ................................ ................................ ................................ ...... 10 \n8 Saving and Running MODFLOW  ................................ ................................ ......................  11 \n9 Conclusion  ................................ ................................ ................................ .........................  12 \n \n1 Introduction  \nMODFLOW \u2013USG (UnStructured  Grid) was developed to support a wide variety of \nstructured and unstructured grid types, including nested grids and grids based on \nprismatic triangles, rectangles, hexagons, and other cell shapes. Flexibility in grid design \ncan be used to focus resolution  along rivers and around wells, for example, or to \nsubdiscretize individual layers to better represent hydrostratigraphic units.1  \nIn Figure 1\u2014taken from the MODFLOW -USG documentation2\u2014notice the grid labeled \n\u201cH\u201d. This is an example of a nested grid. MODFLOW -USG allows a single MODFLOW \nsimulation to have different levels of grid refinement within the same simulation. Other \nmodels, such as MODFLOW -LGR, require multiple nested grids with two or more \ncoupled simulations.  \nIn this tutorial, a regional MODFLOW 2000 model will be imported and a MODFLOW -\nUSG model with local refinement will be created. A MODFLOW -USG simulation will be \ncreated, and the layer data will be convert ed to a scatter point dataset. The layer data will \nbe interpolated and mapped from the conceptual model to MODFLOW. MODFLOW will \nthen be run.  \nThis tutorial assumes familiarity with conceptual modeling, MODFLOW -USG, and \nunstructured grid generation. The tu torials listed as prerequisites on the cover page of \nthis document should be completed prior to starting this tutorial.  \n                                                      \n1 Panday, Sorab; Langevin, Christian.D .; Niswonger, Richard G.; Ibaraki, Motomu; and Hughes, \nJoseph D., (2013). \u201cMODFLOW \u2013USG version 1: An Unstructured Grid Version of MODFLOW for \nSimulating Groundwater Flow and Tightly Coupled Processes Using a Control Volume Finite -\nDifference Formulation\u201d in  Techniques and Methods 6 \u2013A45,U.S. Geological Survey, 66 p.  \n2 Ibid, p. 9.  \nGMS Tutorials   MODFLOW -USG  \u2013 Regional to Local Model Conversion  \n \n Page 3 of 12 \u00a9 Aquaveo 2024   \n      Figure 1      Examples of unstructured grids from the MODFLOW -USG documentation  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2.1 Reading in the Regional Model  \nThe first step in the model conversion process is to bu ild a regional model.  Since the \nfocus of this tutorial is primarily on the conversion process, import a previously \nconstructed model.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the Reg2Loc \\ directory and select \u201cregmod.gpr\u201d.  \n4. Click Open  to import the project and exit the Open  dialog . \nA model similar to Figure 2 should appear.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 Regional to Local Model Conversion  \n Page 4 of 12 \u00a9 Aquaveo 2024   \n      Figure 2      Regional MODFLOW 2000 m odel \nThis is the top layer of the two layer model. This model was constructed using the \nconceptual model a pproach.  The boundary of the local site is indicated with a red \nrectangle. The imported project includes the solution for the regional MODFLOW 2000 \nmodel.   \n2.2 Saving with a Different Name  \nBefore making any changes, it is best to save the project under a new  name.  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c refined.gpr \u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \nPeriodically  Save   as the model is developed.  \n3 Creating a UGrid  \nNow to create a 3D UGrid. This grid needs to match the MODFLOW 2000 (mf2k) grid \nexcept the new grid will be refined around the local site using a grid frame with the same \norigin and extents as the mf2k gr id. A map polygon will be used to define the refined area \naround the local site.  \n1. Right -click in a blank space in the Project Explorer  and select New | Grid Frame . \n2. Right -click on \u201c  Grid Frame\u201d in the Project Explorer and select Fit to Active \nCoverage .  \n3. Fully expand \u201c  3D Grid Data \u201d, then right -click on \u201c  grid\u201d and select  \nProperties \u2026 to open the Properties  dialog.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 Regional to Local Model Conversion  \n \n Page 5 of 12 \u00a9 Aquaveo 2024  4. Select the cell in the Value  column of the X origin  row and, while holding down \nthe Shift key, select the cell in the Value  column of the Length in Z  row.  \nThis selects a total of six cells ( Figure 3). \n5. Right -click on one of the selected cells and select Copy .  \n \n      Figure 3      3D Grid Properties dialog  \n6. Click Cancel  to exit the dialog.  \n7. Right -click on \u201c  Grid Frame\u201d and select Properties \u2026 to open the Grid Frame \nProperties  dialog.  \n8. Select the cell in the Value  column of the Origin X  row and, while holding down \nthe Shift key, select the cell in the Value  column of the Dimension z  row. \n9. Right -click on one of the selected cells and select Paste . \nThe values will change to what was copied from the 3D grid properties.  \n10. Click OK to exit the Grid Frame Properties  dialog.  \n11. Fram e  the project.  \nThis displays the entire model area with the grid frame ( Figure 4). \n\nGMS Tutorials   MODFLOW -USG  \u2013 Regional to Local Model Conversion  \n Page 6 of 12 \u00a9 Aquaveo 2024   \n      Figure 4      Framed view with copied properties  \n3.1 Defining the Refined Area  \nIt is now possible to define the refined area around the local site by editing the \u201c  ss\u201d \ncoverage.  \n1. Fully expand the \u201c  Regional Model \u201d in the Project Explorer . \n2. Double -click on the \u201c  ss\u201d coverage to bring up the Coverage Setup  dialog.  \n3. Turn on Refinement  in the Sources/Sinks/BCs  column.  \n4. Click OK to exit the Coverage Setup  dialog.  \n5. Turn off \u201c  grid\u201d in the Project Explorer  to hide the 3D grid  \n6. Using the Create Arc   tool, click out an arc surrounding the local site (the red \nrectangle), clicking on the start point to close the arc.  \n7. Click Build Polygons   to make the newly digitized arc into a polygon (see the \nblack arc surrounding the red rectangle in Figure 5). \n\nGMS Tutorials   MODFLOW -USG  \u2013 Regional to Local Model Conversion  \n \n Page 7 of 12 \u00a9 Aquaveo 2024   \n      Figure 5      New polygon digitized around the local site  \n8. Using the Select Polygon   tool, double -click on the new polygon  to bring up \nthe Attribute Table  dialog.  \n9. Check the box in the Refine  column.  \n10. Enter \u201c 50.0\u201d in the Base size  (ft) column.  \n11. Click OK to exit the Attribute Table  dialog.  \n3.2 Creating a 3D Refined UGrid  \nNow to create the 3D refined UGrid.  \n1. Right -click on \u201c  Grid Fram e\u201d and select Map to  | UGrid  to bring up the Map \u2192 \nUGrid  dialog.  \n2. Select \u201c3D\u201d from the  Dimension  drop-down.  \n3. Select \u201cQuadtree/Octree\u201d from the UGrid type  drop-down.  \n4. In the X-Dimension  section, enter \u201c 70\u201d for the Number of cells . \n5. In the Y-Dimension  section, enter \u201c 50\u201d for the Number of cells . \n6. In the Z-Dimension  section, enter \u201c 2\u201d for the Number of cells . \n7. Click OK to exit the Map \u2192 UGrid  dialog and create the UGrid  \n8. Turn on \u201c  ugrid\u201d in the Project Explorer.  \nA UGrid similar to Figure 6 should appear in the Graphics Window.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 Regional to Local Model Conversion  \n Page 8 of 12 \u00a9 Aquaveo 2024   \n      Figure 6      Locally refined UGrid  \nThe larger cells in the UGrid  exactly match the mf2k grid. The cells gradually become \nsmaller around the area of interest.  \n9. Zoom   in on the local site to see something similar to Figure 7. \n \n      Figure 7      Local refinement of a 3D UGrid  \n10. Frame   the project to view the entire model area.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 Regional to Local Model Conversion  \n \n Page 9 of 12 \u00a9 Aquaveo 2024  4 Converting the Layer Data to a Scatter Point Set  \nNow to convert the MODFLOW 2000 layer elevation information to a scatter point set s o \nthat it is possible to interpolate the elevations to the UGrid. By default, this will create a \nnew scatter set with the MODFLOW top and bottom elevations as datasets.  \n1. Select the \u201c  3D Grid Data \u201d folder in the Project Explorer  to make it active . \n2. Select Grid | MODFLOW Layers \u2192 2D Scatter Points \u2026 to open the \nMODFLOW Layers \u2192 Scatter Points  dialog.  \n3. Accept the default parameters and click OK to exit the MODFLOW Layers \u2192 2D \nScatter Points dialog and create the layer elevation scatter points ( Figure 8). \n \n      Figure 8      2D scatter points converted from MODFLOW layers  \n5 Creating a MODFLOW -USG Model  \nNow it is neces sary to create a MODFLOW -USG model on the UGrid before interpolating \nthe elevations.  \n1. Right -click on \u201c  ugrid \u201d in the Project Explorer  and select New MODFLOW \u2026 to \nbring up the MODFLOW Global/Basic Package  dialog . \n2. Click OK to accept the default model settings  and exit the MODFLOW \nGlobal/Basic Package  dialog.  \n6 Interpolating Layer Elevations  \nNext to interpolate the layer elevations directly to the MODFLOW arrays. The MODFLOW \narrays can be automatically associated with appropriately named datasets. Just accept \nthe defaults in the dialog and the layer elevations will be interpolated to the correct \nMODFLOW array.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 Regional to Local Model Conversion  \n Page 10 of 12 \u00a9 Aquaveo 2024  1. Right -click on \u201c  Layers \u201d in the Project Explorer and select Interpolate To | \nMODFLOW Layers \u2026 to bring up the Interpolate to MODFLOW Layers  dialog.  \n2. Click OK to accept the defaults and exit the Interpolate to MODFLOW Layers  \ndialog.  \n3. Turn off the \u201c  Layers \u201d scatter set in the Project Explorer  to hide it.  \nThe Graphics Window should appear similar to Figure 9. \n \n      Figure 9      After the scatter set has been interpolated  \n7 Mapping to MODFLOW  \nNow to assign the MODFLOW boundary conditions and the aquifer properties:  \n1. Right -click on \u201c  Regional Model\u201d in the Project Explorer  and select Map To | \nMODFLOW/MODPATH  to bring up the Map \u2192 Model  dialog.  \n2. Click OK to accept the defaults and close the Map \u2192 Model  dialog  \nBoundary condition symbols for specified head, rivers, and wells sh ould appear similar to \nFigure 10. \n\nGMS Tutorials   MODFLOW -USG  \u2013 Regional to Local Model Conversion  \n \n Page 11 of 12 \u00a9 Aquaveo 2024   \n      Figure 10      Boundary condition symbols are now visible  \n8 Saving and Running MODFLOW  \nNow it is possible to run MODFLOW.  \n1. Save   the project.  \n2. Run MODFLOW    to bring up the MODFLOW  model wrapper dialog.  \n3. When the model finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and close the MODF LOW  dialog.  \nThe contours  should be similar to Figure 11. \n\nGMS Tutorials   MODFLOW -USG  \u2013 Regional to Local Model Conversion  \n Page 12 of 12 \u00a9 Aquaveo 2024   \n      Figure 11      MODFLOW -USG Head Contours  \n9 Conclusion  \nThis concludes the MODFLO W-USG Regional to Local Model Conversion  tutorial.  The \nfollowing key concepts were discussed and demonstrated in this tutorial:  \n\uf0b7 MODFLOW -USG supports locally refined grids.  \n\uf0b7 Creating locally refined UGrids in GMS.  \n \n\n", "filename": "MODFLOW-USG-RegionalToLocal.pdf", "pages": 12}, "MODFLOW-USG-ShapefileToCLN": {"text": "GMS Tutorials   MODFLOW -USG \u2013 Map Shapefile to CLN  \n Page 1 of 8 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW -USG \u2013 Map Shapefile to CLN  \nMap a Shapefile to the CLN package with MODFLOW -USG in GMS  \n \nObjectives   \nThis tutorial shows how to map shapefile geometry and attributes to the CLN package in GMS.  \nPrerequisite Tutorials  \n\uf0b7 None  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW  Interface  \n Time  \n\uf0b7 20\u201330 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   MODFLOW -USG \u2013 Map Shapefile to CLN  \n Page 2 of 8 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Description of Problem  ................................ ................................ ................................ . 2 \n1.2 Getting Started  ................................ ................................ ................................ ..............  3 \n2 Opening a MODFLOW -USG Project  ................................ ................................ ...................  3 \n3 Mapping to CLN  ................................ ................................ ................................ ...................  4 \n4 Viewing the Mapped Data  ................................ ................................ ................................ ... 5 \n5 Saving and Running MODFLOW  ................................ ................................ ........................  6 \n6 Viewing the Results  ................................ ................................ ................................ .............  6 \n7 Conclusion  ................................ ................................ ................................ ...........................  8 \n \n1 Introduction  \nThe Connected Linear Network (CLN) process was developed for MODFLOW -USG to \nhave the ability to model complex one -dimensional connected features that are much \nsmaller than a groundwater flow model\u2019s cells.1 A three -dimensional arc shapefile can be \nused to store the geometry and attributes of such a linear network.  \nThis tutorial demonstrates how to use a 3D arc shapefile to map g eometry and attributes \nto the CLN process in GMS.  \nThe following topics will be demonstrated in this tutorial:  \n1. Opening an existing MODFLOW -USG simulation.  \n2. Mapping a shapefile to the CLN process.  \n3. Running the simulation and examining the results.  \n1.1 Description of Problem  \nThe problem in this tutorial is shown in Figure 1. It consists of a three layer MODFLOW -\nUSG model. The first and third layers contain specified head boundary conditions along \none side of the model. The middle layer has a low hydraulic conductivity and acts as a \nconfining layer. The model will be modified to include a network of mine tunnels \nconsisting of five vertical shafts connected by a declining tu nnel. When filled with \ngroundwater, the network of tunnels will allow groundwater to travel between the model \nlayers. The first mine shaft is toward the southwest side of the model. It descends 50 m \nfrom the surface to an elevation of 1350 m. From the firs t shaft the descending tunnel \nconnects to each successive shaft with the last shaft descending 500 m to an elevation of \n900 m.  \n                                                      \n1 Panday, Sorab, Langevin, C.D., Niswonger, R.G., Ibaraki, Motomu, and Hughes, J.D. (2013). \nMODFLOW \u2013USG version 1: An unstructured grid version of MODFLOW for simulating \ngroundwater flow and tightly coupled processes using a co ntrol volume finite -difference formulation: \nU.S. Geological Survey Techniques and Methods. Book 6, chap. A45, 66 p., \nhttp://pubs.usgs.gov/tm/06/a45.  \nGMS Tutorials   MODFLOW -USG  \u2013 Map Shapefile to CLN  \n \n Page 3 of 8 \u00a9 Aquaveo 2024   \nFigure 1      Description of problem  \n1.2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2 Opening a MODFLOW -USG Project  \nTo open a project file that already contains the MODFLOW -USG simulation:  \n1. Click Open  (or File | Open\u2026 ) to bring up the Open  dialog.  \n2. Browse to the ShapefileToCLN \\ShapefileToCLN \\ directory and select \u201cstart.gpr\u201d.  \n3. Click Open  to import the file and close the Open  dialog.  \nThe Graphics Window should appear as shown in Figure 2. Before making any further \nchanges, it is best to save the project with a new name.  \n4. Select File | Save As\u2026  to bring up the Save As  dialog.  \n5. Browse to the ShapefileToCLN \\ShapefileToCLN \\ directory.  \n6. Enter \u201cShapefileToCLN.gpr\u201d as the File name . \n7. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n8. Click Save  to save the project file and close the Save As  dialog.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 Map Shapefile to CLN  \n Page 4 of 8 \u00a9 Aquaveo 2024   \n      Figure 2      Startin g project  \n3 Mapping to CLN  \nThe shapefile containing the mine tunnel geometry is included in the project. To view the \nattributes included in the shape file:  \n1. Under \u201c  GIS Layers \u201d in the Project Explorer , right -click on the \u201c  mine.shp\u201d \nfile and select Attribut e Table...  to open the Attributes dialog.  \nAttributes have been specified for the conduit radius (FRAD) and the conductivity for flow \ninside the conduit (CONDUITK).  \n2. Click on OK to close the Attributes  dialog.  \nTo map the shapefile to the CLN process, the CLN  process must first be enabled.  \n3. Select MODFLOW  | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage  dialog.  \n4. Click Packages...  to open MODFLOW Packages / Processes  dialog.  \n5. Turn on the CLN \u2013 Connected Linear Network Process  option.   \n6. Click OK to exit the MODFLOW Packages / Processes  dialog.   \n7. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \nNow to map the shapefile to the CLN process:  \n8. Select the MODFLOW | Optional Packages | CLN \u2013 Connected Linear \nNetwork... menu item to open the CLN Process  dialog.  \n9. In the list on the left -hand side of the dialog, select the \u201c Nodes \u201d item.  \n10. Click on the Map Shapefile to CLN...  button. The Select UGrid  dialog should \nappear.  \n11. Highlight the \u201c  mine.shp \u201d file.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 Map Shapefile to CLN  \n \n Page 5 of 8 \u00a9 Aquaveo 2024  12. Click OK to close  the Select UGrid  dialog and op en the Map Shapefile to CLN \ndialog.  \nThe settings items in this dialog are used when attributes are not specified as arc \nattributes by the shapefile. Since the \u201c  mine.shp\u201d file has attributes for the FRAD and \nCONDUITK values, the settings for FRAD and CON DUITK in this dialog will be ignored.  \nAlso included is a Duplicate Point Tolerance  item. It is used to determine when to \ncombine arc points that are within the given distance of each other into a single point to \nconnect the arcs.  \nFor this problem, adjust t he leakance and turn on the setting to generate a UGrid of the \nCLN network.  \n13. For the Skin leakance 1 (FSKIN)  item set the value to \u201c 5.0\u201d. \n14. For the Maximum CLN node length (MAXNODELEN)  set the value to \u201c 1500 \u201d. \n15. Set the Generate CLN UGrid  value to \u201c On\u201d. \n16. Click on OK to close the Map Shapefile to CLN  dialog and finish mapping the \nshapefile values to the CLN process.  \nThe segments of the shapefile arcs were split based on the MAXNODELEN setting and \nthen intersected with the UGrid to generate the CLN data. The \u201cNodes \u201d table in the CLN \nPackage  dialog should be filled with 13 new CLN nodes (or cells) for the mapped data.  \nIn the table, the IFNO  value is the CLN cell number, FLENG  is the length of the cell, and \nFELEV  is the elevation at the bottom of the cell. STRT is the starting head value which by \ndefault is set to the bottom elevation. Descriptions of the other values can be found in the \nMODFLOW -USG documentation . \n4 Viewing the Mapped Data  \nNow to view other data mapped from the shapefile:  \n1. In the list on the left -hand side of the CLN Process dialog, select the \n\u201cGroundwater Connections \u201d item.  \nThe \u201cGroundwater Connections\u201d table contains the values for each CLN cell to \ngroundwater cell connection. The table should contain rows for 44 connections. The \nIFNO  value is the CLN cell number and the IGWNOD  value is the groundwater cell \nnumber. The FSKIN  value for each cell should be 5.0, which matches the value entered \nin the Map Shapefile to CLN  dialog.  \n2. Select OK to close the CLN P rocess dialog.  \nIn the Graphics W indow, orange square point symbols should have been added to \ndesignate the groundwater cells that have groundwater to CLN connections as shown in \nFigure 3. \nIn the Pro ject Explorer a new UGrid has appeared entitled \u201c  CLN Cells \u201d. This newly \ncreated UGrid has line segment cells matching the CLN cells. The cell numbers for this \nUGrid can be turned on to identify the location of the CLN cells.  \n3. Turn off the \u201c  mine.shp\u201d file in the Project Explorer.  \n4. Select the \u201c  CLN Cells\u201d item in the Project Explorer.  \n5. Select Display | Display Options...  to open the Display Options  dialog.  \n6. Turn on the Cell numbers  option. If desired, increase the font size.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 Map Shapefile to CLN  \n Page 6 of 8 \u00a9 Aquaveo 2024  7. Select OK to close the Display  Options  dialog.  \nThe CLN cells and cell numbers should now appear in the graphics view along with the \norange symbols for CLN groundwater connections as shown in Figure 3.  \n \n      Figure 3      Mapped CLN data \n5 Saving and Running MOD FLOW  \nThe changes should now be saved before running MODFLOW.  \n1. Save   the project.  \n2. Click the Run MODFLOW   macro in the toolbar . \n3. When MODFLOW finishes, check  on the Read solution on exit  and Turn on \ncontours (if not on already)  boxes.  \n4. Click Close  to close th e MODFLOW  model wrapper dialog.  \n6 Viewing the Results  \nAfter running MODFLOW, there will be a slight change in the head contours. A new \nsolution folder named \u201c  ShapefileToCLN (MODFLOW)\u201d has been generated in the \nProject Explorer. Under the solution folder th ere should be two CCF files. The first CCF \nfile, \u201c  CCF (ShapefileToCLN.ccf)\u201d, contains the flow budget information for the \ngroundwater process. The second CCF file, \u201c  CCF (ShapefileToCLN.cln_cb)\u201d, contains \nthe flow budget information for the CLN process.  First, look at the groundwater flow \nbudget.  \n1. Right -click on the \u201c  CCF (ShapefileToCLN.ccf)\u201d file and select the Flow \nBudget...  menu  item to open the Flow Budget dialog.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 Map Shapefile to CLN  \n \n Page 7 of 8 \u00a9 Aquaveo 2024  Notice that there is a flow budget item entitled  CLN. This item gives the amount of flow \nbetween the groundwater grid and the CLN grid. There should be a flow in of \napproximately 112,077.0 and flow out of approximately -112,077.0, signifying the amount \nof groundwater that was transferred through the CLN network.  . \n2. Select OK to close the Flow Budget  dialog.   \nTo get a better feel for the water transfer between the layers, set up flow budget zones \nfor each layer and then view the zone budget.  \n3. Double -click on the \u201c  Zone Budget IDs \u201d dataset item in the Project Explorer to \nbring up the Zone Bud get IDs  dialog.  \n4. Change the Layer  to layer \u201c 2\u201d. \n5. Click Constant \u2192 Layer  to bring up the Layer Value  dialog.  \n6. Enter \u201c2\u201d for the Constant value for layer  field.  \n7. Select OK to close  the Layer Value  dialog.  \n8. Change the Layer  to layer \u201c 3\u201d. \n9. Click Constant \u2192 Layer  to bring up the Layer Value  dialog.  \n10. Enter \u201c3\u201d for the Constant value for layer  field.  \n11. Select OK to close  the Layer Value  dialog.  \n12. Select OK to close the Zone Budget IDs  dialog.  \n13. Right -click on the \u201c  CCF (ShapefileToCLN.ccf)\u201d file and select the Flow \nBudge t... menu  item to open the Flow Budget  dialog.  \n14. At the top of the dialog, select the Zones  tab. \n15. Change the Zone  popup menu to \u201c All Zones \u201d. \nIn the flow budget table, an overall balance should appear at the top followed by entries \nfor zones corresponding to e ach layer. Notice that for layers 2 and 3 all of the  CLN flow is \nleaving each layer, and for layer 1 the majority of the flow is entering the layer.  \n16. Select OK to close the Flow Budget  dialog.  \nNow to view the CLN network flow budget:  \n17. Right -click on the \u201c  CCF (ShapefileToCLN.cln_cb)\u201d file and select the Flow \nBudget...  menu item to open the Flow Budget  dialog for the CLN network.  \nNotice that there is also a GWF  item for the CLN network and the amount is close to the \namount for the groundwater flow budget.  \nThe flow budget for the CLN network can also be viewed for each CLN cell.  \n18. Select OK to close the Flow Budget  dialog.  \n19. Right -click on the \u201c  CCF (ShapefileToCLN.cln_cb)\u201d file and select the View \nValues...  menu item.  \nThis dialog shows the flow budget values for each CLN cell. For the CLN cells touching \ngroundwater cells in only the first layer (1, 2, 6, 7, and 8), the flow is leaving the CLN \nnetwork, and for the cells that touch layer 3, the flow is entering the CLN network.  \n\nGMS Tutorials   MODFLOW -USG  \u2013 Map Shapefile to CLN  \n Page 8 of 8 \u00a9 Aquaveo 2024  7 Conclusion  \nThis concludes the \u201cMODFLOW -USG Shapefile to CLN\u201d tutorial. Here are the key \nconcepts from this tutorial:  \n\uf0b7 GMS has the ability to map a 3D arc shapefile to the CLN process.  \n\uf0b7 The shapefile can include CLN attributes that get mapped to the CLN process.  \n\uf0b7 The CLN process flow budge t can be viewed in GMS.  \n \n", "filename": "MODFLOW-USG-ShapefileToCLN.pdf", "pages": 8}, "MODFLOW-USG-TransportGrid": {"text": "GMS Tutorials   MODFLOW -USG Transport \u2013 Grid Approach  \n Page 1 of 14 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW -USG Transport \u2013 Grid Approach  \nCreating a MODFLOW -USG Transport model using the grid approach  \n \nObjectives   \nConstruct a MODFLOW -USG Transport model using the grid approach. Values are manually assigned to \nthe grid. Simple models can be easily constructed using the grid approach . \nPrerequisite Tutorials  \n\uf0b7 MT3DMS \u2013 Grid Approach  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW -USG  Transport  \n Time  \n\uf0b7 15\u201325 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 Grid Approach  \n Page 2 of 14 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 The MT3DMS Model  ................................ ................................ ................................ ..... 3 \n2.2 Saving With a New Name  ................................ ................................ .............................  4 \n3 Switching to MODFLOW -USG Transport  ................................ ................................ ...........  4 \n3.1 Switching from Steady State to Transient  ................................ ................................ ..... 5 \n3.2 Saving and Running the Model  ................................ ................................ .....................  5 \n4 Enabling Transport  ................................ ................................ ................................ ..............  6 \n5 BCT Package Inputs  ................................ ................................ ................................ ............  7 \n6 Injecting Contaminant at the Well  ................................ ................................ ......................  9 \n7 Output Control  ................................ ................................ ................................ ...................  11 \n8 Saving and Running MODFLOW -USG Transport  ................................ ...........................  11 \n9 Setting Up an Animation  ................................ ................................ ................................ ... 12 \n10 Using a Voronoi Grid  ................................ ................................ ................................ .........  13 \n11 Conclusion  ................................ ................................ ................................ .........................  14 \n \n1 Introduction  \nThis tutorial describes how to perform a MODFLOW -USG Transport simulation within \nGMS. It builds on the MT3DMS \u2013 Grid Approach tutorial, and converts the MT3DMS \nmodel created  in that tutorial into a MODFLOW -USG Transport model. The MT3DMS \nand the MODFLOW -USG Transport models are then compared to see how closely they \nmatch.  \nThe problem in this tutorial ( Figure 1) corresponds to a sample problem described in the \nMT3DMS  documentation.1 The problem consists of a low K zone inside a larger zone. \nThe sides of the region are no flow boundaries. The top and bottom are constant head \nboundaries that cause the flow to move from the top to the bottom of the region. An \ninjection well with a speci fied concentration provides the source of the contaminants. A \npumping well serves to withdraw contaminated water migrating from the injection well. A \nsteady -state flow solution will be computed and a transient transport simulation will be \nperformed over a one-year period.  \n                                                      \n1 Zheng, Chunmiao  and Wang, P. Patrick (December 1999). \u201cA Two -Dimensional Application \nSample\u201d in MT3DMS: A Modular Three -Dimensional Multispecies Transport Model for Simulation of \nAdvection, Dispersion, and Chemical Reactions of Contaminants in Groundwater Systems; \nDocume ntation and User\u2019s Guide , Strategic Environmental Research and Development Program \n(SERDP), U.S. Army Corps of Engineers, Contract Report SERDP -99-1, pp. 152 -154. \nhttp://hydro.geo.ua.edu/mt3d/mt3d manual.pdf  \nGMS Tutorials   MODFLOW -USG Transport \u2013 Grid Approach  \n \n Page 3 of 14 \u00a9 Aquaveo 2024  \nConstant head boundary (H=250 m) (flow model)\nNo mass flux boundary (transport model)\nHyd. Cond. =\n1.474x10-7m/s\nLOW K ZONEINJECTION WELL\nQ = 0.001 m3/s\nC = 57.87 ppm\nPUMPING WELL\nConstant head boundary (H = 36.25 m)Number of rows = 40\nNumber of columns = 32\nAquifer thickness = 10 m\nK = 1.474x10-4 m/s\nPorosity = 0.3\nLongitudinal dispersivity = 20 m\nDispersivity ratio = 0.2\nSimulation time = 1.0 yr\nDX = 1600 mQ = -0.0189 m3/sDY = 2000 mNo flow boundary\n(flow model)\nNo mass flux\nboundary\n(transport model)No flow boundary\n(flow model)\nNo mass flux\nboundary\n(transport model) \n      Figure 1      Sample flow and transport problem  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2.1 The MT3DMS Model  \nStart with reading the MT3DMS model into GMS.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to th e \\MODFLOW -USG -Transport \\mt3d grid directory and select \n\u201cmt3dgrid .gpr\u201d. \n4. Click Open  to import the project and exit the Open  dialog . \n5. In the Project Explorer, under the \u201c mt3dgrid (MT3DMS)\u201d solution  folder , select \nthe \u201c  tracer\u201d dataset . \n6. In the Time Steps  window, scroll to the bottom and select the last time step (13. \n365.0).  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 Grid Approach  \n \n Page 4 of 14 \u00a9 Aquaveo 2024  The model should appear similar to Figure 2. Notice the contaminant injected at the well \nin the top of the model flows around the low conductivity area towards the bottom of the \nmodel. If desired, select different time steps to see how the plume changes over time.  \n \n      Figure 2      MT3D solution  \n2.2 Saving With a New Name  \nNow to save the project under a new name:   \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter  \u201cusg-transport .gpr\u201d as the File name . \n4. Click Save  to save the project with a new name and  close the Save As  dialog . \n3 Switching to MODFLOW -USG Transport  \nNow to switch the model from using MODFLOW 2000 to MODFLOW -USG Transport,  \nthen to create a flow solution.  \n1. Select MODFLOW  | Global Options  to open the MODFLOW Global/Basic \nPackage  dialog.  \n2. In the MODFLOW version  section, select the USG Transport  option . \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 Grid Approach  \n \n Page 5 of 14 \u00a9 Aquaveo 2024  3.1 Switching from Steady State to Transient  \nContaminant transport modeling requires a transient simulation. The MT3DMS model \nused a steady state MODFLOW flow solution with a transient MT3DMS mod el. For this \nexample, it is necessary to change the MODFLOW -USG Transport model to be transient.  \nStress Periods  \nStart with setting the stress period for the model.  \n1. Set the Model type  to Transient . \n2. Click on Stress Periods  to open the Stress Periods  dialog.  \n3. Change the Number of stress  periods  to \u201c2\u201d.  \n4. Change the Length of the second stress period  to \u201c365.0\u201d.  \n5. Change the Num Time Steps  on the second stress period to \u201c20\u201d.  \n6. Click OK to exit the Stress Periods  dialog.  \n7. Click OK to exit the MODFLOW Global/Basic Packa ge dialog.  \n8. Click Yes on the warning dialog about switching to USG Transport, if it appears.  \n9. Click OK on the warning dialog about the SMS solver, if it appears.  \nSpecific Yield  \nNow to set the specific yield parameters:  \n1. Select MODFLOW  | LPF \u2013 Layer Property F low to open the LPF Package  \ndialog.  \n2. Click Specific Storage  to open the Specific Storage  dialog.  \n3. Click Constant \u2192 Grid to open the Grid Value  dialog.  \n4. Enter \u201c1e -4\u201d for the Constant  value for grid . \n5. Click OK to close the Grid Values  dialog.  \n6. Click OK to close the Specific Storage  dialog.  \n7. Click OK to close the LPF Package  dialog.  \n3.2 Saving and Running the Model  \n1. Click the Save   macro.  \n2. Click the Run MOD FLOW   macro to bring up the MODFLOW model wrapper \ndialog.  \n3. When the model finishes, click Close  to import the solution.  \nThe flow solution should appear as shown in Figure 3. \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 Grid Approach  \n \n Page 6 of 14 \u00a9 Aquaveo 2024   \n      Figure 3      Model contours after MODFLOW -USG Transpor t run \n4 Enabling Transport  \nNow start adding contaminant transport to the model. The first process is to enable the \nmain transport package in MODFLOW -USG Transport.  \n1. Select MODFLOW  | Global Options  to open the MODFLOW Global/Basic \nPackage  dialog.  \n2. Click Package s to open the MODFLOW Packages  / Processes  dialog.  \n3. Under Optional packages  / processes , turn on the BCT \u2013 Block Centered \nTransport  option.  \nThe BCT process is needed if transport or density dependent flow is to be included in the \nmodel. The packages/processes that only come with MODFLOW -USG Transport are:  \n\uf0b7 BCT \u2013 Block Centered Transport  \n\uf0b7 DDF \u2013 Density Driven Flow  \n\uf0b7 DPT \u2013 Dual Porosity Transport  \n\uf0b7 PCB \u2013 Prescribed Concentration Boundary  \nThe DDF package only consists of a few values so it is included  with the BCT package \nand is not listed in the MODFLOW Packages  / Processes  dialog. The other \npackages/processes are listed.  \nFor this model, only the BCT process needs to be added.  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 Grid Approach  \n \n Page 7 of 14 \u00a9 Aquaveo 2024   \n      Figure 4      MODFLOW Packages / Processes  dialog  \n4. Click OK to close the MODFLOW Packages  / Processes  dialog.  \n5. Click OK to close the MODFLOW Global/Basic Package  dialog.  \n5 BCT Package Inputs  \nNext to look at the BCT package:  \n1. Select MODFLOW  | Optional Packages  | BCT \u2013 Block Centered Transport  to \nopen th e BCT Process  dialog.  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 Grid Approach  \n \n Page 8 of 14 \u00a9 Aquaveo 2024   \n      Figure 5      BCT Package dialog  \nThe dialog is divided into two parts: one on the left which shows the main sections, and \none on the right which shows the inputs for the current section. Here\u2019s a brief  explanation \nof each section:  \n \nSection  Description  \nComments  Comment lines can be added and will appear at the top of the BCT file.  \nVariables  Variables corresponding to item 1a in the BCT input file.  \nSpecies  The list of species. The number of species equals MCOMP in the Variables section. \nGMS allows the user to give each species a name.  \nAquifer Properties  Cell-by-cell inputs independent of species such as porosity.  \nSpecies Properties  Cell-by-cell inputs that depend on the species, such as adsorption.  \nDDF Comments  Comment lines can be added and will appear at the top of the DDF file.  \nDDF Package  Inputs corresponding to the DDF (Density Driven Flow) package.  \nVariables  \nIt is necessary to turn on the dispersion option.  \n1. Select the Variables  item on the left.  \n2. Change the Dispersion formula (IDISP)  to \u201cIsotropic dispersion (1)\u201d.  \nSpecies  \n1. Select the Species item on the left.  \n2. Under Species Name , change the name to \u201ctracer\u201d.  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 Grid Approach  \n \n Page 9 of 14 \u00a9 Aquaveo 2024  MODFLOW -USG Transport does not save the species name but GMS does.  \nAquifer  Properties  \n1. Select the Aquifer Properties  item on the left.  \nBy default, the aquifer properties use a constant value for the entire grid, but values can \nbe specified on a cell -by-cell basis. The ICBUND array, which specifies which cells will be \nactive when modeling transport, will be ignored based on the ICBNDFLG  value in the \nVariables  section.  \nThe value for bulk density (BULKD) is 0.0 which means that no sorption is being \nmodeled. Now to change the dispersion parameters:  \n2. Change the Constant Value for DL (longitudinal dispersivity) to \u201c20.0\u201d.  \n3. Change the Constant Val ue for DT (transverse dispersivity) to \u201c0.2\u201d.  \nSpecies Properties  \n1. Select Species Properties  on the left.  \nDue to an issue in MODFLOW -USG Transport, the starting concentration cannot be 0.0. \nTherefore, change the concentration to a small number for this model . \n2. For CONC , enter a Constant Value  of \u201c0.001\u201d.  \nThe values for adsorption (ADSORB), and the reaction terms (ZODRW, ZODRS) are all \n0.0 which is correct for our simple model.  \nDDF \nThe DDF Comments  and DDF Package sections are for the Density Driven Flow \npackag e and are included in the BCT Process  dialog in GMS. This example is not \nmodeling density flow, so ignore these sections.  \n1. Click OK to close the BCT Process  dialog.  \n6 Injecting Contaminant at the Well  \nIn this model, a contaminant is injected into the aquifer via the well at the top of the \nmodel. To set this up:  \n1. Select MODFLOW  | Optional Packages  | WEL \u2013 Well to open the MODFLOW \nWell Package  dialog.  \n2. Click Edit AUX  to open the AUX Variables  dialog.  \nGMS Tutorials   MODFLOW -USG Transport \u2013 Grid Approach  \n \n Page 10 of 14 \u00a9 Aquaveo 2024   \n      Figure 6      AUX Variables dialog  \nThis dialog allows defining up to five auxiliary variables (or AUX variables) to be included \nin the well package. With MODFLOW -USG Transport, AUX variables can be used with \nthe WEL, RIV, CHD, and GHB packages to specify a concent ration for water entering the \nmodel via these boundary conditions. If multiple species are used, the concentration can \nbe specified for each species (up to 5) using additional AUX variables. The AUX \nvariables must be named following a specific pattern, whi ch is a \u201cC\u201d followed by a two -\ndigit number with a leading zero. For example, species 1 would use an AUX variable \nnamed \u201cC01\u201d, species 2 would use an AUX variable named \u201cC02\u201d etc.  \n3. In the first row, enter \u201cC01\u201d.  \n4. Click OK to close the AUX Variables  dialog.  \n5. For the well in cell ID \u201c304\u201d, enter \u201c57.87\u201d in the C01 column.  \n6. Click OK to close the MODFLOW Well Package  dialog.  \n \n      Figure 7      MODFLOW Well Package dialog  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 Grid Approach  \n \n Page 11 of 14 \u00a9 Aquaveo 2024  7 Output Control  \nNext to specify the output options by doing the following:  \n1. Select MODFLOW |  OC \u2013 Output Control\u2026  to open the MODFLOW Output \nControl dialog.  \n2. Turn on Save concentration s to *.con file . \n3. Click OK to exit the  MODFLOW  Output Control  dialog.  \n \n      Figure 8      MODFLOW Output Control dialog  \n8 Saving and Running MODFLOW -USG Transport  \nNow to save the simulation and run MODFLOW -USG Transport:  \n1. Save   the project . \n2. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog . \n3. When the  simulation is finished, tu rn on Read solution on exit . \n4. Click Close  to import the solution and close the MODFLOW  dialog.  \n5. In the Project Explorer, under the \u201c  usg-transport (MODFLOW)\u201d solution, \nselect the \u201c  tracer\u201d dataset.  \n6. In the Time Steps window , select the last time step.  \nThe model should appear similar to Figure 9. \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 Grid Approach  \n \n Page 12 of 14 \u00a9 Aquaveo 2024   \n      Figure 9      Contaminant plume from the MODFLOW -USG Transport solution  \n9 Setting Up an Ani mation  \nGenerating an animation facilitates observing how the solution changes over the one -\nyear simulation. Do the following to set up the animation:  \n1. Select Display | Animate\u2026  to bring up the Options  page of the Animation Wizard  \ndialog . \n2. Turn on  Data set and click Next  to go to the Datasets  page of the Animation \nWizard  dialog . \n3. Below Run simulation from time , select Use constant interval  and enter \u201c36.5\u201d as \nthe Time interval . \nThis will result in 11 frames.  \n4. Turn on Display clock . \n5. Click  Finish  to generate the animation and close the Animation Wizard  dialog . \nNow the animation can be opened in an external media player and viewed. If desired, \noutside of GMS, navigate to the directo ry for the animation and open the generated MP4 \nfile in the desired media player. The directory where the animation was saved can be \nfound, and adjusted, on the Options  page of the Animation Wizard  under the File type  \nsection.  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 Grid Approach  \n \n Page 13 of 14 \u00a9 Aquaveo 2024  10 Using a Voronoi Grid  \nMODFLOW -USG Transport works with unstructured grids. To demonstrate this, op en a \nproject that models the same scenario but uses a Voronoi grid.  \n1. Select File | New. Save the current project if prompted.  \n2. Click Open   to bring up the Open  dialog.  \n3. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n4. Browse to \\MODFLOW -USG -Transport \\mt3d grid directory and select \n\u201cvoronoi .gpr\u201d. \n5. Click Open  to import the project and exit the Open  dialog . \nNotice that this model uses an unstructured grid which contains Voronoi grid cells.  \n6. In the Project Explorer, under the \u201c voronoi  (MODFLOW)\u201d solution  folder , select \nthe \u201c  tracer\u201d dataset . \n7. In the Time Steps  window, scroll to the bottom and select the last time step.  \nNotice that the contours of contaminant concentration are similar to those in the previous \nproject ( Figure 10).  \n \n      Figure 10      MODFLOW -USG Transport model using a Voronoi UGrid  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 Grid Approach  \n \n Page 14 of 14 \u00a9 Aquaveo 2024  11 Conclusion  \nThis concludes the \u201c MODFLOW -USG Transport  \u2013 Grid Approach \u201d tutorial. The following \nkey concepts were discussed and demonstrated in this tutorial:  \n\uf0b7 MODFLOW -USG Transport can solve for flow only, or coupled flow and \ntransport.  \n\uf0b7 The main process used for transport is the BCT process. Other packages that \ncan be used fo r transport include:  \n\uf0b7 DDF \u2013 Density Driven Flow  \n\uf0b7 DPT \u2013 Dual Porosity Transport  \n\uf0b7 PCB \u2013 Prescribed Concentration Boundary  \n\uf0b7 It is possible to use the Animation Wizard  to create an animation in GMS.  \n\uf0b7 Contaminant concentration can be added to the model by using AUX variables in \nthe WEL, RIV, CHD, and GHB packages.  \n\uf0b7 The model will generate a cell -by-cell concentration file for each species if the \noption is turned on in the Output Control  package.  \n \n", "filename": "MODFLOW-USG-TransportGrid.pdf", "pages": 14}, "MODFLOW-USG-TVMPackage": {"text": "GMS Tutorials   MODFLOW -USG Transport \u2013 TVM Package  \n Page 1 of 7 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW -USG Transport \u2013 TVM Package  \nUse the Time -Variant Materials package (TVM) in GMS  \n \nObjectives   \nLearn  how to use the Time -Variant Materials package (TVM) with MODFLOW -USG Transport . \nPrerequisite Tutorials  \n\uf0b7 MODFLOW -USG  Transport  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW -USG  Transport  \n Time  \n\uf0b7 20\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 TVM Package  \n Page 2 of 7 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  2 \n3 Changing the Conductivity  ................................ ................................ ................................ . 3 \n4 Map to MODFLOW  ................................ ................................ ................................ ...............  4 \n5 Activating the TVM Package  ................................ ................................ ...............................  5 \n6 Defining the TVM Package  ................................ ................................ ................................ .. 5 \n7 Saving and Running MODFLOW  ................................ ................................ ........................  6 \n8 Examining the Results  ................................ ................................ ................................ ........  6 \n9 Conclusion  ................................ ................................ ................................ ...........................  7 \n \n1 Introduction  \nThe Time -Variant Materials package (TVM) works with MODFLOW -USG Transport. The \nTVM package allows hydraulic conductivity and storage values to be changed as a step \nfunction between stress periods or in a continuous manner through a transient simulation.  \nThis tutorial demonstrates how the TVM package can be used with a MODFLOW -USG \nTransport simulation.  \nThe problem in this tutorial consists of a two layer unstructured grid (UGrid) with a \nMODFLOW -USG Transport simulation. The UGrid contains a well on the seco nd layer \nset with a constant pumping rate.  \nThis tutorial will demonstrate the following topics:  \n1. Opening an existing MODFLOW -USG Transport simulation.  \n2. Creating a transient conductivity coverage and dataset.  \n3. Activating the TVM package.  \n4. Running the simulation  and examining the results.  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n3. Click Open   (or File | Open \u2026) to bring up the Open  dialog.  \n4. Browse to the data files for this tutorial and select \u201cstart.gpr\u201d.  \n5. Click Open  to import the file and close the Open  dialog.  \n6. In the Project Explorer, select the \u201c  Head\u201d dataset.  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 TVM Package  \n \n Page 3 of 7 \u00a9 Aquaveo 2024   \n      Figure 1      Imported MODFLOW -USG Transport model  \nThe Graphics Window should appear as in Figure 1. This model has a two layer UGrid \nwith a refined zone. General heads have been se t at each end. There is a well on the \nsecond layer.  \nBefore continuing, save the project with a new name.  \n7. Select File | Save As\u2026  to bring up the Save As  dialog.  \n8. Browse to the directory for this tutorial.  \n9. Enter \u201cmodel -tvm.gpr\u201d as the File name . \n10. Select \u201cProje ct Files (*.gpr)\u201d from the Save as type  drop-down.  \n11. Click Save  to save the project file and close the Save As  dialog.  \n3 Changing the Conductivity  \nBefore activating the TVM package, start with creating a time -variant dataset for the \nrefined area of the UGrid. This will be done using a separate map coverage which will \nthen be added to the model.  \n1. Right -click on the  \u201c model\u201d  conceptual model and select New Coverage\u2026  to \nbring up the Coverage Setup  dialog.  \n2. Enter \u201ctvm_hk\u201d for the Coverage name . \n3. In the Area Propertie s column, turn on Datasets . \n4. Click the Datasets  button to open the Datasets  dialog.  \n5. Click the Insert Row   button  \n6. In the new row, enter \u201cTVM_HK\u201d.  \n7. Click OK to close the Datasets  dialog.  \n8. Click OK to close the Coverage Setup  dialog.  \nWith the new \u201c  tvm-hk\u201d coverage created, time -variant data needs to be added to the \nrefined area of the UGrid.  \n9. Make certain the \u201c  tvm-hk\u201d coverage is active in the Project Explorer.  \n10. Using the Create Arc   tool, create four arcs around the refined area of the \nUGrid as in Figure 2 below.  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 TVM Package  \n \n Page 4 of 7 \u00a9 Aquaveo 2024   \nFigure 2     Arcs drawn around refined area of the UGrid  \n11. Select the Build Polygons   macro.  \n12. Using the Select Polygon s  tool, double -click on the polygon to open the \nAttribute Table dialog.  \n13. Change the TVM_HK  column to be \u201c<transient>\u201d.  \n14. Click the  button in the TVM_HK  column to open the XY Series Editor .  \n15. Enter the values in Table 1 below to create a time series:  \nTime (d)  TVM_HK  \n0.0 1.5 \n1.0 1.5 \n1.0 3.0 \n101.0  3.0 \n101.0  6.0 \n201.0  6.0 \nTable 1    Time series  \n16. Click OK to close the XY Series Editor . \n17. Click OK to close the Attribute Table  dialog.  \nThe \u201ctvm_hk\u201d coverage now contains time -variant material data that can be added to the \nMODFLOW -USG Transport simulation.  \n4 Map to MODFLOW  \nThe data added in the conceptual model needs to be mapped to the UGrid model.  \n1. Right-click on the \u201c  model\u201d conceptual model and select Map To | \nMODFLOW/MODPATH  to open the Map \u2192 Model  dialog.  \n2. Check All applicable coverages and click OK to close the Map \u2192 Model  dialog.  \nA new dataset, \u201c  TVM_HK\u201d, should appear in the Project Explorer in the MODFLOW \nsimulation.  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 TVM Package  \n \n Page 5 of 7 \u00a9 Aquaveo 2024  5 Activating the TVM Package  \nWith the horizontal conductivity data available, the TVM package can now be activated \nand added to the MODFLOW simulation. To activate the TVM package:  \n1. Switch to the UGrid  module.  \n2. Select MODFLOW | Global Options \u2026 to bring up the MODFLOW Global/Basic \nPackage  dialog.  \n3. Click Packages \u2026 to bring up the MODFLOW Packages / Processes  dialog.  \n4. In the Optional packages  / processes  section, turn on TVM \u2013 Time Varyin g \nMaterials . \n5. Click OK to exit the MODFLOW Packages  / Processes  dialog.  \n6. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n6 Defining the TVM Package  \nWith the time -varying dataset mapped to the simulation and the TVM package activated, \nthe parameters f or the TVM package can now be defined.  \n1. Select MODFLOW | Optional Packages  | TVM \u2013 Time Varying Materials\u2026  to \nbring up the TVM Package  dialog.  \n2. In the list on the left, select HK. \n3. Select Dataset to Array  to bring up the Select Dataset  dialog.  \n4. Under Solution , select \u201c  TVM_HK\u201d.  \n5. Turn on All time steps . \n6. Click OK to close the Select Dataset  dialog.  \n7. Click OK to close the TVM Package  dialog.  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 TVM Package  \n \n Page 6 of 7 \u00a9 Aquaveo 2024   \nFigure 3      TVM Package dialog  \n7 Saving and Running MODFLOW  \nThe changes should now be saved before  running MODFLOW -USG Transport.  \n1. Click Save   to save the project.  \n2. Click the Run MODFLOW   macro in the toolbar to bring up the MODFLOW  \nmodel wrapper dialog.  \n3. When MODFLOW finishes, check  on the Read solution on exit  and Turn on \ncontours (if not on already)  boxes.  \n4. Click Close  to close the MODFLOW  model wrapper dialog.  \n5. Click Save   to save the project with the new solution.  \nThe solution set should appear in the Project Explorer.  \n8 Examining the Results  \nIn order to more clearly see how the TVM package impacted the simulation, compare the \nresults. This can be done by using the Data Calculator  to create a dataset that compares \nthe solution set with the TVM package to the previous solution set.  \n1. Click the  Data Calculator  macro to open the Data Calculator . \n2. In the Datasets  section, select the \u201c  Head\u201d dataset under the \u201c  start \n(MODFLOW)\u201d folder.  \n\nGMS Tutorials   MODFLOW -USG Transport \u2013 TVM Package  \n \n Page 7 of 7 \u00a9 Aquaveo 2024  3. Turn on Use all time steps . \n4. Click Add to Expression . \n5. Click the minus  (-) button.  \n6. In the Datasets  section, select th e \u201c  Head\u201d dataset under the \u201c  model -tvm \n(MODFLOW)\u201d folder.  \n7. Click Add to Expression . \n8. For Result , enter \u201cdiff\u201d.  \n9. Click Compute . \n10. Click Done . \n11. Select the \u201c  diff\u201d dataset in the Project Explorer.  \n12. In the Time Steps  window, use the down arrow key to step through  the time \nsteps and watch how the contours change.  \n \nFigure 4     Last time step of the difference dataset showing the results of the TMV package.  \n9 Conclusion  \nThis concludes the tutorial. Here are the key concepts from this tutorial : \n\uf0b7 Using the TVM Package to add time -varying materials to a MODFLOW -USG \nTransport simulation.  \n\uf0b7 Creating a time -variant dataset using the Map module.  \n\uf0b7 Activating the TVM package for a MODFLOW simulation.  \n \n\n", "filename": "MODFLOW-USG-TVMPackage.pdf", "pages": 7}, "MODFLOW-UZFPackage": {"text": "GMS Tutorials   MODFLOW -USG \u2013 UZF Package  \n Page 1 of 16 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW  \u2013 UZF Package  \nThe MODFLOW Unsaturated -Zone Flow (UZF) Package Interface  \n \nObjectives   \nThis tutorial explains how to use the MODFLOW Unsaturated -Zone Flow (UZF) package and compares it \nto the RCH and EVT packages . \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach I  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 35\u201350 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW -USG \u2013 UZF Package  \n Page 2 of 16 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  4 \n2.1 Importing the Existing Model ................................ ................................ .........................  5 \n2.2 Saving the Model with a New Name  ................................ ................................ .............  5 \n3 Viewing the UZF Boundary Conditions  ................................ ................................ .............  6 \n3.1 The UZF Package Dialog  ................................ ................................ .............................  6 \n3.2 The Sources/Sinks Dialog  ................................ ................................ ............................  6 \n3.3 Running MODFLOW  ................................ ................................ ................................ ..... 7 \n3.4 Examining the Solution  ................................ ................................ ................................ . 8 \n4 Increasing the Infiltration Rate  ................................ ................................ ...........................  9 \n4.1 Running MODFLOW  ................................ ................................ ................................ ..... 9 \n4.2 Examining the Solution  ................................ ................................ ...............................  10 \n5 Using a Conceptual Model  ................................ ................................ ................................  11 \n5.1 Opening the Existing Conceptual Model  ................................ ................................ ..... 11 \n5.2 Examining the Existing Solution ................................ ................................ ..................  11 \n5.3 Changing the Model to Use UZF  ................................ ................................ ................  11 \n5.4 Changing to UZF  ................................ ................................ ................................ ........  12 \n5.5 Examining and Configuring the UZF Package  ................................ ............................  12 \n5.6 Saving and Running MODFLOW  ................................ ................................ ................  12 \n5.7 Examining the Solution  ................................ ................................ ...............................  13 \n5.8 Adding Routing to Streams  ................................ ................................ .........................  13 \n5.9 Configuring the UZF Package ................................ ................................ .....................  14 \n5.10 Saving and Running MODFLOW  ................................ ................................ ................  14 \n5.11 Viewing the Changes  ................................ ................................ ................................ .. 14 \n6 Conclusion  ................................ ................................ ................................ .........................  16 \n \n1 Introduction  \nThe Unsaturated -Zone Flow (UZF)  package was developed by the USGS to more \naccurately model recharge of groundwater through an unsaturated zone. The package \nmodels percolation of precipitation through the unsaturated zone and can include storage \nin the unsaturated zone, groundwater recha rge, evapotranspiration, and surface \ndischarge. The surface discharge can be routed to streams or lakes, or, if a lake or \nstream is not specified, the discharge is removed from the model. The package was \ndesigned to be substituted for the EVT and RCH packa ges, although they can all be used \nat the same time. The UZF package is only available in MODFLOW -2005.  \nThe problem in this tutorial is the same as the model used in the UZF documentation.1 \nThe model was first described in the SFR documentation.2 \nThe hypot hetical stream -aquifer interaction problem used in this \nsimulation was developed for an alluvial basin in a semiarid region. The \nprincipal aquifer comprises unconsolidated deposits of mostly sand and \ngravel. Recharge to the aquifer primarily is leakage fro m the streams that \nenter the basin from the mountains on the northwest, northeast, and \nsouthwest. The main stream in the southern part of the valley is \n                                                      \n1 Niswonger, R.G.; Prudic, David E.; and Regan, R.Steven (2006). \u201cDocumentation of the \nUnsaturated -Zone Flow (UZF1) Package for modeling unsaturated flow between the land surface \nand the water table with MODFLOW -2005\u201d in Techniques and Methods Book 6, Modeling \nTechniques , U.S. Geological Survey, chapter A19. \nhttps://pubs.usgs.gov/tm/2006/tm6a19/pdf/tm6a19.pdf . \n2 Prudic, David E.; Konikow, Leonard F.; and Banta, Edward R. (2004). A new s tream -flow routing \n(SFR1) package to simulate stream -aquifer interaction with MODFLOW -2000 . U.S. Geological \nSurvey Open -File Report 2004 -1042. https://water.usgs.gov/nrp/gws oftware/modflow2000/ofr2004 -\n1042.pdf  \nGMS Tutorials   MODFLOW  \u2013 UZF Package  \n \n Page 3 of 16 \u00a9 Aquaveo 2024  perennial, whereas all other streams in the valley are intermittent with \nsmall drainage areas.  \nStreamfl ow entering the model domain and diversions from streams \nwere the same as that used by Prudic and others and remained the \nsame for all stress periods. Different methods were used to represent the \nrelations between width, depth and flow in the streams. Infi ltration rates \nin the UZF1 Package file and pumping rates in the Well Package file \nwere varied during 12 stress periods but the distribution of infiltration and \npumping among grid cells did not change. The ET demand was specified \nas constant over the entir e modeled area equal to 1.6 ft/yr to a maximum \ndepth of 15 ft below land surface. The LPF Package was used to specify \nhydraulic properties for the aquifer. The hydraulic conductivity and \nspecific yield were 173 ft/d and 0.2, respectively, in the vicinity o f the \nstream channels and the hydraulic conductivity and specific yield were \n35 ft/d and 0.1, respectively, elsewhere in the alluvial basin\u2026  \nThe model grid was divided into uniformly spaced cells 5,000 ft on each \nside. The strongly implicit procedure (SIP)  was used to solve the flow \nequation for test simulation 2. The head -closure criterion was 0.0002. \nThe option to add overland runoff to stream segments was specified in \nthe UZF1 Package; however, no ground -water seepage to land surface \nwas simulated in the  test. The number of stress periods in the \nDiscretization file was 12. Each stress period was 2.628\u00d7106 seconds or \n30.42 days. The first stress period was steady state and had one time \nstep. This allowed for the calculation of initial water contents for th e \nunsaturated zone on the basis of the steady -state infiltration rate. The \nremaining 11 stress periods were transient and were divided into 15 time \nsteps that increased sequentially by a factor of 1.1.3 \nThis tutorial will discuss and demonstrate:  \n\uf0b7 Importin g an existing MODFLOW simulation.  \n\uf0b7 Running the simulation.  \n\uf0b7 Examining the results to understand the UZF package options.  \n\uf0b7 Modifying a conceptual model to use UZF instead of the RCH and EVT \npackages.  \n                                                      \n3 Niswonger, et al (2006), p. 20, 23.  \nGMS Tutorials   MODFLOW  \u2013 UZF Package  \n \n Page 4 of 16 \u00a9 Aquaveo 2024   \n      Figure 1      Flow model from UZF documentation4 \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n3. If asked to save changes, click Don\u2019t Save  to close the dialog and restore GMS \nto a default state.  \n                                                      \n4 Niswonger, et al (2006), p. 20, 23.  \n\nGMS Tutorials   MODFLOW  \u2013 UZF Package  \n \n Page 5 of 16 \u00a9 Aquaveo 2024  2.1 Importing the Existing Model  \nTo start with a MODFLOW model that has already been created:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201c MODFLOW Name Files  (.mfn;*.nam)\u201d from the Files of type  drop-down . \n3. Browse to the uzf\\uzf\\ folder and select \u201c UZFtest2.nam \u201d. \n4. Click Open  to exit the Open  dialog and bring up the MODFLOW Translator  \ndialog.  \n5. Click OK to begin the translation.  \n6. When the dialog states that \u201cMODFLOW 2005 terminated successfully\u201d, click \nDone  to finish importing the file and close the MODFLOW Translator  dialog.  \nThis imports a model showing a grid with symbols representing wells, streams, and \ngeneral head boundary con ditions ( Figure 2). \n \n      Figure 2      Imported MODFLOW model  \n2.2 Saving the Model with a New Name  \nNow it is possible to start making changes, but first it is recommended to save the model \nwith a new name.  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c UZF.gpr \u201d as the File name . \n\nGMS Tutorials   MODFLOW  \u2013 UZF Package  \n \n Page 6 of 16 \u00a9 Aquaveo 2024  4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n3 Viewing the UZF Boundary Conditions  \nBefore running the simulation, view the UZF boundary conditions in the UZF Package \ndialog.  \n3.1 The UZF Package Dialog  \n1. Select MODFLOW | Optional Packages |  UZF \u2013 Unsaturated Zone Flow\u2026  to \nopen the MODFLOW  UZF Package  dialog.  \nThis dialog is used to edit existing UZF boundary conditions and to change options \nassociated with the UZF package. The options located on the left of the dialog apply to \nthe UZF package , while the spreadsheet on the right allows editing of the individual UZF \nboundary conditions. Instead of repeating all of the UZF documentation here, it is \nrecommended to review the UZF documentation (found on the USGS website) for more \ninformation on eac h input option.  \nNow to examine the UZF boundary conditions. The boundary conditions for the UZF \npackage can be edited in the spreadsheet on the right with the different boundary \ncondition arrays selectable using the View/Edit  drop-down. The first four arr ays listed in \nthe combo box can vary per stress period including \u201c Infiltration Rate \u201d, \u201cET Demand Rate \u201d, \n\u201cET Extinction Depth \u201d, and \u201cET Water Content \u201d.  \n2. Below the Stress period  section, select \u201cFINF. Infiltration Rate  (ft/s)\u201d from the \nView/Edit  drop-down.  \n3. Enter \u201c1.0e -09\u201d as the Multiplier . \n4. In the Stress period  section, enter \u201c2\u201d as the current stress period.  \nNotice that the Multiplier  field is now set to \u201c 8.0e-009\u201d. For this simulation, the infiltration \nrate changes via the Multiplier  field through most of the remaining stress periods. View \nthe other arrays for additional UZF boundary conditions, if desired. Refer to the UZF \ndocumentation for a full explanation of each of the inputs to the UZF boundary conditions.  \n5. Click OK to close the MODFLOW UZF Package  dialog.  \n3.2 The Sources/Sinks Dialog  \n1. Switch to the 3D Grid   module by selecting \u201c  3D Grid Data\u201d in the Project \nExplorer . \n2. Select Edit | Select All  to select all of the cells in the 3D grid.  \n3. Right -click on one of the selected cells and select Sources/Sinks \u2026 to open the \nMODFLOW  Source/Sinks  dialog.  \n4. Select \u201cUnsaturated Zone (UZF)\u201d from the list at the left.  \nThis dialog allows editing the properties of a selected boundary condition as well as \nadding additional source/sink boundary  conditions in the selected cells. For the areal \nboundary conditions such as EVT, RCH, and UZF, the package has to be turned on \nbefore it becomes available. For UZF boundary conditions, the values associated with \nstress periods can be entered as a constant  value for all stress periods or as a time -\nvarying XY series.  \n\nGMS Tutorials   MODFLOW  \u2013 UZF Package  \n \n Page 7 of 16 \u00a9 Aquaveo 2024  5. Click OK to exit the MODFLOW Sources/Sinks  dialog.  \n6. Click outside of the grid to unselect the cells.  \n3.3 Running MODFLOW  \nBefore running MODFLOW, it is necessary to change the output options to make i t easier \nto see the results.   \n1. Select MODFLOW | OC \u2013 Output Control \u2026 to open the MODFLOW Output \nControl  dialog.  \n2. In the Output interval  section, select  Output at last time step of each stress \nperiod . \n3. Turn on Save cell by cell flow terms to *.ccf file . \n4. Click OK to exit the MODFLOW Output Control  dialog.  \nNow to save the changes and run MODFLOW:  \n5. Save   the project.  \n6. Click Run Modflow   to bring up the MODFLOW  model wrapper dialog.  \n7. When MODFLOW finishes, turn on Read solution on exit and Turn on contours (if \nnot o n already) . \n8. Click Close  to import the solution and close the MODFLOW  model wrapper \ndialog.   \nBlock -fill contours should appear on the grid ( Figure 3). \n \n      Figure 3      MODFLOW solution  \n\nGMS Tutorials   MODFLOW  \u2013 UZF Package  \n \n Page 8 of 16 \u00a9 Aquaveo 2024  9. Save   the project with the new solution.  \n3.4 Examining the Solution  \nLook more closely at the computed solution. The solution contours show that the \npotential for flow for this model is from the top left down toward the bottom left.  \nThe Flow Budget Dialog  \nNow to examine the flow budget for this simulation:  \n1. Click on the \u201c  Head \u201d dataset to make the Time Step window appear with the \nfirst stress period selected.  \n2. Click outside the grid to make sure none of the cell s are selected and select \nMODFLOW  | Flow Budget \u2026 to bring up the Cells  tab of the Flow Budget  dialog.  \nThe flow budget for all cells for the time step at the end of the first stress period is shown. \nNote that the flow in for UZF RECHARGE  is about \u201c 8.5\u201d and the flow out for GW ET is \nabout \u201c -20.4\u201d. Also note that \u2014at the end of the first stress period \u2014there is no SURFACE \nLEAKAGE . \n3. On the Zones  tab, turn on Use all time steps . \nThe generated spreadsheet shows the flow budget for the last time step of each s tress \nperiod.  \n4. Scroll down through each time step on the spreadsheet and notice the flow \nbudget values for the UZF package.  \nNotice the SURFACE LEAKAGE  is \u201c0.0\u201d in all stress periods.  \n5. Click OK to exit the Flow Budget  dialog.  \nThe OUT File  \nMODFLOW also generat es a flow budget for the unsaturated zone in the MODFLOW list \noutput file. Look at the flow budget for the unsaturated zone.  \n1. Double -click on \u201c  UZF.out\u201d in the Project Explorer  to bring up the View Data \nFile dialog.  \nThis dialog may not appear if the Never  ask this again  option had been previously turned \non. If this is the case, skip to step 3.  \n2. Select the desired text editor from the Open with  drop-down and click OK to open \n\u201cUZF.out\u201d in that text editor and close the View Data File  dialog.  \n3. Search (usually Ctrl-F) for \u201cUnsaturated Zone Package Volumetric Budget\u201d to \nfind the section for time step 1 stress period 1.  \n4. Review the data in this section and any of the other similar sections for other time \nsteps and stress periods.  \n5. Once done reviewing them, close t he \u201cUZF.out\u201d document in the text editor and \nreturn to GMS.  \nA UZF flow budget is printed to the out file at the end of each time step just like the \nvolumetric flow budget for the entire model.  \n\nGMS Tutorials   MODFLOW  \u2013 UZF Package  \n \n Page 9 of 16 \u00a9 Aquaveo 2024  4 Increasing the Infiltration Rate  \nNow to increase the infiltrati on rate to see what affect it has on the model.  \n1. Select MODFLOW | Optional Packages | UZF \u2013 Unsaturated Zone Flow \u2026 to \nopen the MODFLOW UZF Package  dialog.  \n2. In the Stress period  section, enter \u201c2\u201d as the current stress period.  \n3. Select \u201cFINF. Infiltration Rate (ft/s)\u201d from the View/Edit  drop-down.  \n4. Below the Stress period  section, enter \u201c8.0e -008\u201d as the Multiplier . \n5. Click OK to close the MODFLOW UZF Package  dialog.  \n4.1 Running MODFLOW  \nIt is now time to run MODFLOW again to generate a new solution.  \n1. Save   the project.  \n2. Click Run Modflow   to bring up the MODFLOW  model wrapper dialog.  \n3. When MODFLOW finishes, turn on Read solution on exit and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and exit the MODFLOW  model wrapper dialog.  \n5. Select the \u201c  Head\u201d dataset then select time step 2.  \nThe model should appear similar to Figure 4. \n \nFigure 4      After MODFLOW run with changed infiltration rate  \n\nGMS Tutorials   MODFLOW  \u2013 UZF Package  \n \n Page 10 of 16 \u00a9 Aquaveo 2024  4.2 Examining the Solution  \nNow to look at the solution to find out if increasing the infiltration rate caused any UZF \nsurface leakage:  \nThe Flow Budget Dialog  \n1. Select the \u201c  Head \u201d dataset to make the Time St ep window appear, with the \nfirst stress period selected.  \n2. Select the second time step.  \n3. Select MODFLOW  | Flow Budget \u2026 to bring up the Flow Budget  dialog.  \nThe flow budget for all cells for the current time step is shown. Note that SURFACE \nLEAKAGE  is about \u201c -0.128\u201d in the Flow Out  column.  \n4. Click OK to exit the Flow Budget  dialog.  \nCCF Datasets  \nNow it is possible to investigate where the surface leakage is occurring.  \n1. Select and then right -click on \u201c  CCF (UZF.ccf)\u201d in the Project Explorer and \nselect the CCF \u2192 Datasets  command.  \n2. Select \u201c  SURFACE LEAKAGE\u201d to bring up the time steps for that dataset.  \n3. Select time step 2 to see an image similar to Figure 5. \n4. Save   the project.  \nMost of the grid should have a value of zero for the dataset. A few cells have negative \nvalues, indicating surface leakage.  \n \n      Figure 5      Surface leakage cells  \n\nGMS Tutorials   MODFLOW  \u2013 UZF Package  \n \n Page 11 of 16 \u00a9 Aquaveo 2024  5 Using a Conceptual Model  \nThe next step is to us e a conceptual model with UZF data by taking a modified version of \nthe finished model for the \u201cMODFLOW \u2013 SFR Package\u201d tutorial and changing it to use \nthe UZF package.  \n5.1 Opening the Existing Conceptual Model  \n1. Click New  to clear the project and reset to defau lts. \n2. Click Open   to bring up the Open  dialog.  \n3. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n4. Browse to the uzf\\uzf\\ directory and select \u201c SFRmap.gpr \u201d. \n5. Click Open  to import the project and exit the Open  dialog . \nBefore making any changes, it is best to save the project under a new name.  \n6. Select File | Save As \u2026 to bring up the Save As  dialog.  \n7. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n8. Enter \u201c UZFmap.gpr \u201d as the File name . \n9. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n5.2 Examining the Existing Solution  \nBefore changing to the UZF package, it is good to look at the Flow Budget for the existing \nsolution.  \n1. Select MODFLOW  | Flow Budget \u2026 to bring up the Flow B udget  dialog.  \nNotice the flow budget for the Recharge package has a flow in rate of \u201c 145.0 \u201d, and the \nEvapotranspiration (ET) package has a flow out rate of about \u201c -46.09 \u201d. \n2. Click  OK to exit the Flow Budget  dialog.  \n5.3 Changing the Model to Use UZF  \nTo change to the UZF package, it is first necessary to remove the RCH and EVT \npackages from MODFLOW.  \n1. Select MODFLOW | Global Options \u2026 command to bring up the MODFLOW \nGlobal/Basic Packages dialog.  \n2. Select 2005  in the MODFLOW version  section.  \n3. Click Packages \u2026 to bring up t he MODFLOW Packages  / Processes  dialog.  \n4. In the Optional packages / processes  section, turn off RCH1 \u2013 Recharge  and \nEVT1 \u2013 Evapotranspiration . \n5. Click OK to exit the MODFLOW Packages  / Processes  dialog.  \n6. Click OK to exit the MODFLOW Global/Basic Package dialog.  \n\nGMS Tutorials   MODFLOW  \u2013 UZF Package  \n \n Page 12 of 16 \u00a9 Aquaveo 2024  5.4 Changing to UZF  \n1. Fully expand the \u201c  Map Data \u201d folder in the Project Explorer.  \n2. Right -click on \u201c Recharge & ET\u201d  and select Coverage Setup \u2026 to open the \nCoverage Setup dialog.  \n3. In the Areal Properties  column, turn on UZF FINF (Infiltration Rate) , UZF P ET \n(ET Demand Rate) , and UZF EXTDP (ET Extinct. Depth) . \n4. Click OK to exit the Coverage Setup  dialog.  \n5. Right -click on \u201c  Recharge & ET \u201d and select Attribute Table \u2026 to open the \nAttribute Table dialog.  \n6. Select \u201cPolygons\u201d from the Feature type  drop-down.  \n7. Enter \u201c 5.0e-008\u201d in the UZF FINF (Infiltration Rate ) (ft/s ) column.  \n8. Enter \u201c8.5e -008\u201d in the UZF PET  (ET Demand Rate ) (ft/s ) column.  \n9. Enter \u201c15.0\u201d in the UZF EXTDP (ET Extinct. Depth ) (ft) column.  \nNotice that these values match the values for the recharge and evapotranspiration \npackages.  \n10. Click OK to exit the Attribute Table  dialog.  \n11. Right -click on \u201c Recharge & ET \u201d and select Coverage Setup \u2026 to open the \nCoverage Setup dialog.  \n12. In the Areal Properties  column, turn off Recharge rate , Max ET rate , and ET \nExtinction depth . \n13. Click OK to exit the Coverage Setup  dialog.  \nThe conceptual model is set up , so now it can be mapped to the MODFLOW grid.  \n14. Click Map \u2192 MODFLOW   to bring up the Map \u2192 Model  dialog . \n15. Click OK to accept the defaults and close the Map \u2192 Model  dialog.  \n5.5 Examining and Configuring the UZF Package  \nLook at the data in MODFLOW that was mapped from the conceptual model.  \n1. Select MODFLOW | Optional Packages | UZF \u2013 Unsaturated Zone Flow \u2026 to \nbring up the MODFLOW UZF Package  dialog.  \n2. Using the View/Edit  drop-down, review the \u201cFINF. Infiltration Rate  (ft/s)\u201d,  \u201cPET. \nET Demand Rate  (ft/s)\u201d,  and \u201cEXTDP. ET Extinction Depth  (ft)\u201d values. They \nshould be the values entered in the conceptual model.  \nThe default settings for the UZF package have evapotranspiratio n disabled. This option \nmust be turned on in this dialog.  \n3. On the left side of the dialog, turn on Simulate ET (IETFLG) . \n4. Click OK to exit the MODFLOW UZF Package  dialog . \n5.6 Saving and Running MODFLOW  \nThe next step is to save the changes and run MODFLOW.  \n\nGMS Tutorials   MODFLOW  \u2013 UZF Package  \n \n Page 13 of 16 \u00a9 Aquaveo 2024  1. Save   the project.  \n2. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n3. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and exit the MODFLOW  model wrapper dialog.  \n5. Save  the project with the new solution.  \n5.7 Examining the Solution  \nNow to look at the flow budget for the new solution:  \n1. Fully expand the \u201c  3D Grid Data\u201d folder and select \u201c  CCF (UZFmap.ccf)\u201d in \nthe Project Explorer.  \n2. Select MODFLOW  | Flow Budget \u2026 to bring up t he Flow Budget  dialog.  \n3. Notice that the UZF package gives nearly the same flow rate as the RCH \npackage with a flow in rate of about \u201c 144.7 \u201d for UZF RECHARGE .  \n4. Notice that the flow out for GW ET is now about \u201c -56.6\u201d.  \n5. Notice that the SURFACE LEAKAGE  flow out is about \u201c -8.84\u201d. Since the routing \nto streams is not turned on, this amount is leaving the model.  \n6. Click  OK to exit the Flow Budget  dialog.  \n5.8 Adding Routing to Streams  \nNext to add routing from the unsaturated zone to surface streams:  \n1. Turn off \u201c  3D Grid Data \u201d and \u201c  GIS Layers\u201d in the Project Explorer . \n2. Select \u201c  UZF Stream \u201d in the Project Explorer.   \nThis makes the coverage visible in the graphics view. The coverage is made up of the \npolygons labeled \u201c Polygon 1 \u201d through \u201c Polygon 8 \u201d. Each polygon is m atched to a stream \nsegment in the \u201c  Streams\u201d coverage. Once set up, any UZF surface leakage in a given \npolygon routes to its associated stream segment.  \n3. Right -click on \u201c  UZF Stream \u201d and select Coverage Setup \u2026 to open the \nCoverage Setup dialog.  \n4. In the Area l Properties  column, scroll down and turn on UZF IRUNBND . \n5. Click OK to close the Coverage Setup  dialog.  \n6. Right -click on \u201c  UZF Stream \u201d and select Attribute Table \u2026 to open the \nAttribute Table dialog.  \n7. Select \u201cPolygons\u201d from the Feature type  drop-down.  \n8. In the UZF IRUNBND  column of the spreadsheet, change each value to match \nthe polygon number found in the Name  column.  \n9. Click OK to exit the Attribute Table  dialog.  \nThe conceptual model is now set up, so it can be mapped to the MODFLOW grid.  \n10. Click Map \u2192 MODFLOW   to bring up the Map \u2192 Model  dialog . \n\nGMS Tutorials   MODFLOW  \u2013 UZF Package  \n \n Page 14 of 16 \u00a9 Aquaveo 2024  11. Click OK to accept the defaults and close the Map \u2192 Model  dialog.  \n5.9 Configuring the UZF Package  \nNow to review the data in MODFLOW that was mapped from the conceptual model:  \n1. Select MODFLOW | Optional Packages | UZF \u2013 Unsatur ated Zone Flow \u2026 to \nbring up the MODFLOW UZF Package  dialog.  \n2. Select \u201c IRUNBND . Stream segments  / Lakes \u201d from the View/Edit  drop-down.  \nThe values in the spreadsheet now match the values mapped from the conceptual model. \nOne change is still needed to enable the routing of surface discharge to the streams.  \n3. On the left side of the dialog, turn on Route surface discharge to streams / lakes \n(IRUNFLG) . \n4. Click OK to exit the MODFLOW UZF Package  dialog . \n5.10 Saving and Running MODFLOW  \nNow to save the changes and run MODFL OW again:  \n1. Turn on \u201c  3D Grid Data\u201d in the Project Explorer so the results will be visible.  \n2. Select File | Save As \u2026 to bring up the Save As  dialog.  \n3. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n4. Enter \u201c UZFmap2 .gpr\u201d as the File name . \n5. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n6. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n7. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n8. Click Close  to import  the solution and close the MODFLOW  model wrapper \ndialog.  \n5.11 Viewing the Changes  \nNow to view the changes to the output caused by turning on stream routing:  \n1. Right -click on \u201c  CCF (UZFmap2.ccf)\u201d under the \u201c  UZFmap2 (MODFLOW) \u201d \nsolution and select CCF \u2192 Datasets . \n2. Select the \u201c SURFACE LEAKAGE \u201d dataset.  \n3. Click Contours   to open the Dataset Contour Options \u2013 3D Grid \u2013 SURFACE \nLEAKAGE dialog.  \n4. In the Contour method  section, select \u201c Block Fill \u201d from the first drop -down.  \n5. Click OK to exit the Dataset Contour Options \u2013 3D Grid \u2013 SURFACE LEAKAGE  \ndialog.  \nNotice that two of the cells toward the bottom left of the model show surface leakage \n(Figure 6). \n\nGMS Tutorials   MODFLOW  \u2013 UZF Package  \n \n Page 15 of 16 \u00a9 Aquaveo 2024  6. Using Select Cells   while holding down Shift, select the two cells with surface \nleakage.  \n7. Select MODFLOW  | Flow Budget \u2026 to bring up the Flow Budget  dialog.  \nNotice that the flow out rate for STREAM LEAKAGE  is about \u201c -3.21\u201d. The flow out rate for \nSURFACE LEAKAGE  is about  \u201c-9.09\u201d.  \n8. Click OK to exit the Flow Budget  dialog.  \n9. Select the \u201c  Head\u201d dataset under the \u201c  UZFmap (MODFLOW) \u201d solution.  \n10. With the same two cells still selected, select the MODFLOW  | Flow Budget \u2026 \nmenu command.  \nNotice that the flow out rates for STREAM LEAKAGE  and SURFACE LEAKAGE  are \nabout \u201c -3.44\u201d and about \u201c -8.84\u201d, respectively. For this model, turning on stream routing \ncaused a small change to the model in these cells.  \n \nFigure 6      Block fill contours after final MODFL OW run \n  \n\nGMS Tutorials   MODFLOW  \u2013 UZF Package  \n \n Page 16 of 16 \u00a9 Aquaveo 2024  6 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 UZF Package\u201d tutorial. The following key concepts \nwere discussed and demonstrated:  \n\uf0b7 GMS supports the UZF package with MODFLOW -2005.  \n\uf0b7 The UZF package is meant to replace the RCH and EVT packages and provides \nadditional functionality.  \n\uf0b7 UZF data can be viewed and edited in the MODFLOW  UZF Package  dialog.  \n\uf0b7 UZF data can be entered in a conceptual model and then mapped to \nMODFLOW.  \n\uf0b7 The settings in the UZF package may need to be adjusted to match the UZF \nproperties selected in the Map module.   \n", "filename": "MODFLOW-UZFPackage.pdf", "pages": 16}, "MODFLOW-ZONEBUDGET": {"text": "GMS Tutorials   MODFLOW  \u2013 ZONEBUDGET  \n Page 1 of 10 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 ZONEBUDGET  \nUse ZONEBUDGET with a  Multi -layer Model  \n \nObjectives   \nLearn how to use ZONEBUDGET with MODFLOW in GMS . \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Grid \nApproach  \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach I  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 15\u201325 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW  \u2013 ZONEBUDGET  \n Page 2 of 10 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  3 \n2 Import the MODFLOW 2000 Model  ................................ ................................ .....................  3 \n2.1 Viewing the Flow Budget  ................................ ................................ ..............................  3 \n2.2 Running ZONEBUDGET  ................................ ................................ ..............................  4 \n3 Assigning Zone Budget IDs  ................................ ................................ ................................  5 \n3.1 Running ZONEBUDGET  ................................ ................................ ..............................  6 \n4 Assigning Zone Budget IDs from a Conceptual Model  ................................ ....................  7 \n4.1 Reading a Transient MODFLOW Solution  ................................ ................................ .... 8 \n5 Advanced ZONEBUDGET Options  ................................ ................................ .....................  8 \n5.1 Running ZONEBUDGET  ................................ ................................ ..............................  9 \n6 Conclusion  ................................ ................................ ................................ ...........................  9 \n \n1 Introduction  \nZONEBUDGET is a USGS program that reads cell -to-cell flow data produced by \nMODFLOW and calculates water budgets for subregions of the modeled area.  \nThis tutorial builds on the \u201c MODFLOW \u2013 Grid Approach \u201d and the \u201cMODFLOW \u2013\nConceptual Model\u201d  tutorial. Those tu torials should be completed before this one. The \npurpose of this tutorial is not to teach all about ZONEBUDGET, but simply to \ndemonstrate the ZONEBUDGET interface in GMS.  \nThis is a multi -layer MODFLOW model of a site with complex stratigraphy. It is the sa me \nmodel used in the \u201c MODFLOW \u2013 Generating Data from Solids \u201d tutorial. A cross section of \nthe site is shown in Figure 1. \n \n      Figure 1      Multi-layer MODFLOW model  \nThis tutorial discusses and demonstrates:  \n\uf0b7 Importing an existing MODFLOW 2000 model.  \n\uf0b7 Running ZONEBUDGET and viewing the outputs for a steady state MODFLOW \nsolution.  \n\uf0b7 Assigning zone budget IDs to the model grid and running ZONEBUDGET.  \n\uf0b7 Assigning zone budget IDs using a conceptual model.  \n\uf0b7 Running ZONEBUDGET on a transient MODFLOW solution.  \n\nGMS Tutorials   MODFLOW  \u2013 ZONEBUDGET  \n \n Page 3 of 10 \u00a9 Aquaveo 2024  1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2 Import the MODFLOW 2000 Model  \nFirst, it is necessary to import an existing model:  \n1. Click Open   to bring up the Open  dialog.  \n2. Browse to the zonebudget \\zonebudget \\ directory and select \u201cmodel.gpr\u201d.  \n3. Click Open to close the Open  dialog and import the project file.  \nA MODFLOW model with color contours of the head solution should appear ( Figure 2). \n \n      Figure 2      Color contours of the head solution  \n2.1 Viewing the Flow Budget  \nNow to look at the flow budget for the MODFLOW model:  \n1. Select MODFLOW | Flow Budget\u2026  to bring up the Flow Budget  dialog.  \nThe Cells  tab shows the flow budget f or selected cells or, if no cells are selected, the \nbudget is shown for the entire model domain. This model has flow into the model domain \nfrom the constant head and recharge boundary conditions, and flow out through the \nconstant head and well boundary con ditions.  \n2. Select the Zones  tab. \nThis tab provides features similar to USGS ZONEBUDGET, including a more concise \nsummary of the flow budget. The information displayed in this tab comes from GMS \nreading the MODFLOW cell -to-cell flow output file (CCF).  \n\nGMS Tutorials   MODFLOW  \u2013 ZONEBUDGET  \n \n Page 4 of 10 \u00a9 Aquaveo 2024  2.2 Running  ZONEBUDGET  \nNow to run ZONEBUDGET and view the outputs:  \n1. On the USGS ZONEBUDGET  tab, click the Run ZONEBUDGET  button to bring \nup the USGS ZONEBUDGET  dialog.  \n2. Once USGS ZONEBUDGET has finished running, click Close  to close the USGS \nZONEBUDGET  dialog.  \nA sprea dsheet containing the ZONEBUDGET output will appear on the tab. This output is \nvery similar to the output on the Zones  tab. This is the CSV output from ZONEBUDGET. \nTwo other output files were also created. In the Output  section, notice that ZBLST , CSV, \nand CSV2  are selected under Multiple outputs  (Figure 3). \n \n      Figure 3      USGS ZONEBUDGET tab of the Flow Budget dialog  \n3. Select \u201c ZBLST \u201d from the View  drop-down.  \nThis is the ZONEBUDGET listing file. It provides informa tion on the inputs to \nZONEBUDGET as well as the outputs. Scroll to the end of the file to see a report similar \nto what was viewed with the CSV output file.  \n4. Click Open Containing Folder  to open a Windows Explorer window showing the \ndirectory where all of th e ZONEBUDGET input and output files are located.  \nThe files are in the same location as the MODFLOW CCF that is used in the \nZONEBUDGET run ( Figure 4). \n\nGMS Tutorials   MODFLOW  \u2013 ZONEBUDGET  \n \n Page 5 of 10 \u00a9 Aquaveo 2024   \n      Figure 4      ZONEBUDGET input and output files  \nAll of the ZONEBUDGET files have the name as the CCF file, with the added \u201c .ZB\u201d to \nclearly identify the files. The 2.CSV file is the CSV2 file. The IN and ZONE files are inputs \nto ZONEBUDGET.  The BAT file is a Windows batch file that can be used to rerun \nZONEBUDGET.  \n5. Close the Windows Explorer window and return to GMS.  \n6. Click OK to exit the Flow Budget  dialog.  \n3 Assigning Zone Budget IDs  \nWhen running ZONEBUDGET previously, every cell in the model grid was assigned a \nZone Budget ID of 1. The next step is to assign different Zone Budget IDs to parts of the \ngrid. First, assign different Zone Budget IDs to the layers of the grid.  \n1. Expand the folders under \u201c  3D Grid Data \u201d in the Project Explorer until t he \u201c  \nZone Budget IDs \u201d dataset  is visible ( Figure 5). \n\nGMS Tutorials   MODFLOW  \u2013 ZONEBUDGET  \n \n Page 6 of 10 \u00a9 Aquaveo 2024   \n      Figure 5      Zone Budget IDs dataset  \n2. Right -click on \u201c  Zone Budget IDs\u201d and select Properties\u2026  to bring up the \nZone Budget IDs  dialog . \nThis dialog contains an array editor that can be used to edit the Zone Budget IDs. This is \nthe same editor that is used to edit all array inputs for MODFLOW. Now assign a different \nID to each layer in the grid. The dialog is currently showing the IDs for layer 1.  \n3. Chan ge Layer  to \u201c2\u201d. \n4. Click Constant \u2192 Layer\u2026 to bring up the Layer Value  dialog.  \n5. Enter \u201c 2\u201d as the Constant value for layer  and click OK to close the Layer Value  \ndialog.  \n6. Repeat steps 3 \u20135 for layers 3, 4, and 5. Assign the layer number as the Zone \nBudget ID for each layer.  \n7. Once all five layers have had Zone Budget IDs assigned, click OK to exit the \nZone Budget IDs  dialog.  \n8. In the Project Explorer , select \u201c  model (MODFLOW) \u201d to make it active.  \n3.1 Running ZONEBUDGET  \nThe next step is to run ZONEBUDGET again.  \n1. Select MODF LOW | Flow Budget \u2026 to bring up the Flow Budget  dialog.  \n2. On the USGS ZONEBUDGET  tab, click Run ZONEBUDGET  to bring up the \nUSGS ZONEBUDGET  dialog.  \n3. Once USGS ZONEBUDGET has finished, click Close  to exit the USGS \nZONEBUDGET  dialog.  \n\nGMS Tutorials   MODFLOW  \u2013 ZONEBUDGET  \n \n Page 7 of 10 \u00a9 Aquaveo 2024  Notice that information is av ailable about both the flows from the boundary conditions and \nthe flows exchanged between zones.  \n4. Select \u201c CSV2 \u201d from the View  drop-down.  \nThe CSV2 output file contains the same information that the CSV output file contains, but \nin a different format.  \n5. Click OK to exit the Flow Budget  dialog.  \n4 Assigning Zone Budget IDs from a Conceptual Model  \nThe next step is to assign Zone Budget IDs using coverages that are part of a conceptual \nmodel. This can be done by using polygons to assign Zone Budget IDs to different ar eas \nof the model grid.  \n1. Fully expan d the \u201c  Map Data\u201d  folder in the Project Explorer.  \nThere are several coverages. Five will be used to assign Zone Budget IDs.  \n2. Select the \u201c  Zones_layer_2 \u201d coverage.  \n3. Change the current grid layer by changing Lay (k)  to \u201c2\u201d in the Mini Grid  Toolbar  \n(Figure 6). \n \n      Figure 6      Mini Grid Toolbar  \nNotice there are polygons which match with the different mate rial zones (the color of the \ngrid cells changes with the feature polygon boundaries). This model has four major \nmaterial zones. Polygons have been created in the different coverages in order to assign \nIDs to these zones.  \n4. Using the Select Polygon   tool, do uble-click on the polygon that overlaps the \nblue material zone at the top right of the model to bring up the Attribute Table \ndialog.  \n5. Notice that a Zone Budget ID  of \u201c2\u201d is assigned.  \n6. Click OK to exit the Attribute Table  dialog.  \n7. Click the Map \u2192 MODFLOW   macro to bring up the Map \u2192 Model  dialog.  \n8. Click OK to accept the defaults and close the Map \u2192 Model  dialog.  \n\nGMS Tutorials   MODFLOW  \u2013 ZONEBUDGET  \n \n Page 8 of 10 \u00a9 Aquaveo 2024  The Zone Budget IDs have now been assigned to the grid.  \n4.1 Reading a Transient MODFLOW Solution  \nBefore running ZONEBUDGET again, it is necessary to im port a transient MODFLOW \nsolution.  \n1. Select MODFLOW | Read Solution \u2026 to bring up the Open  dialog.  \n2. Select \u201cMODFLOW Name File (*.mfn)\u201d from the drop -down to the right of the File \nname  field.  \n3. Browse to the zonebudget \\zonebudget \\trans_MODFLOW  directory and selec t \n\u201ctrans.mfn \u201d. \n4. Click Open  to import the file.  \n5. Select the \u201c  trans (MODFLOW)\u201d folder in the Project Explorer to make it active.  \nWhen the Flow Budget  dialog appears, the CCF file associated with this solution will be \nshown.  \n5 Advanced ZONEBUDGET Options  \nThe next step is to look at some of the advanced inputs to ZONEBUDGET.  \n1. Select MODFLOW | Flow Budget \u2026 to bring up the Flow Budget  dialog.  \n2. Select the USGS ZONEBUDGET  tab. \nWhen previously running ZONEBUDGET, the model was steady state so there was only \none time step in the CCF file. The current model solution comes from a transient model \nwith multiple time steps. With ZONEBUDGET, time steps can be analyzed all together or \nindividually.  \n3. In the Output  section under Output times , select Specified  (Figure 7). \n \n      Figure 7      Specified output times  \n4. Click Times\u2026 to bring up the Properties  dialog.  \n5. In the Select  column, turn on \u201c 300.0 \u201d, \u201c450.0 \u201d, and \u201c600.0 \u201d (rows 11, 21, and 31).  \n6. Click OK to exit the Properties  dialog.  \n\nGMS Tutorials   MODFLOW  \u2013 ZONEBUDGET  \n \n Page 9 of 10 \u00a9 Aquaveo 2024  ZONEBUDGET also provides functionality to combine zones into composite zones. In \nthis problem, there are four zones. A composite zone comprising zones 1 and 2 can be \nmade, and then ZONEB UDGET will provide a report for zones 1, 2, 3, and 4 individually, \nand another report for the composite zone.  \n7. In the Composite Zones  section, enter \u201c2\u201d for the Number of zones. \n8. Click Edit Zones \u2026 to bring up the Properties  dialog ( Figure 8). \n9. In row 1, enter \u201cupper\u201d in the Name  column and \u201c1,2\u201d in the Zone IDs  column.  \n10. In row 2, enter \u201clower\u201d in the Name  column and \u201c3,4\u201d in the Zone IDs  column.  \n11. Click OK to close the Properties  dialog.  \n \n      Figure 8      Composite zones  \n5.1 Running ZONEBUDGET  \n1. Click Run ZONEBUDGET  to bring up the USGS ZONEBUDGET  dialog.  \n2. Once USGS ZONEBUDGET is finished running, click Close  to exit the USGS \nZONEBUDGE T dialog.  \nNotice that the output contains data from 3 different time steps. To view information about \nthe composite zones, look at the listing file (ZBLST).  \n3. Select \u201c ZBLST \u201d from the View drop-down and scroll to the bottom to see \ninformation on the \u201clower\u201d c omposite zone.  \n4. Click OK to exit the Flow Budget dialog.  \n6 Conclusion  \nThis concludes the \u201cMODFLOW \u2013ZONEBUDGET\u201d tutorial. The following topics were \ndiscussed and demonstrated  \n\uf0b7 GMS includes an interface to the USGS program ZONEBUDGET.  \n\uf0b7 It is possible to view ZONEBUDGET output in GMS.  \n\uf0b7 GMS supports all features of ZONEBUDGET.  \n\nGMS Tutorials   MODFLOW  \u2013 ZONEBUDGET  \n \n Page 10 of 10 \u00a9 Aquaveo 2024  \uf0b7 Zone Budget IDs can be assigned to the grid by manual means or by using the \nconceptual model approach.  \n \n", "filename": "MODFLOW-ZONEBUDGET.pdf", "pages": 10}, "MODFLOW6-ConceptualApproach": {"text": "GMS Tutorials   MODFLOW  6 \u2013 Conceptual  Approach  \n Page 1 of 11 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW  6 \u2013 Conceptual  Approach  \nBuild a MODFLOW 6 model using the conceptual model approach  \n \nObjectives   \nThis tutorial demonstrates converting an existing MODFLOW 2000 conceptual model to a MODFLOW 6 \nsimulation using the conceptual model approach . \nPrerequisite Tutorials  \n\uf0b7 Getting Started  \n\uf0b7 MODLFOW Conc eptual \nModel Approach I  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW -USG Model &  \nInterface  \n Time  \n\uf0b7 25\u201345 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   MODFLOW  6 \u2013 Conceptual  Approach  \n Page 2 of 11 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 Opening the Existing Model  ................................ ................................ ..........................  3 \n3 Saving the Project  ................................ ................................ ................................ ...............  4 \n4 Settin g Up the Grid  ................................ ................................ ................................ ..............  4 \n5 Creating the Simulation  ................................ ................................ ................................ ...... 5 \n6 Mapping from Coverages  ................................ ................................ ................................ .... 5 \n6.1 Mapping the Drain Package  ................................ ................................ .........................  6 \n6.2 Mapping the General Head Boundary  ................................ ................................ ..........  6 \n6.3 Mapping the Recharge Package  ................................ ................................ ...................  7 \n6.4 Mapping the Wells  ................................ ................................ ................................ ........  7 \n6.5 Mapping the Hydraulic Conductivity  ................................ ................................ ..............  8 \n7 Setting the Starting Head  ................................ ................................ ................................ .... 8 \n8 Saving the Data  ................................ ................................ ................................ ....................  9 \n9 Checking the Simulation  ................................ ................................ ................................ ..... 9 \n10 Mapping the DISV Package  ................................ ................................ ................................ . 9 \n11 Saving and Checking the Simulation  ................................ ................................ ...............  10 \n12 Running MODFLOW  ................................ ................................ ................................ ..........  10 \n13 Viewing the Solution  ................................ ................................ ................................ .........  10 \n14 Conclusion  ................................ ................................ ................................ .........................  11 \n \n1 Introduction  \nA simple MODFLOW 6 simulation can be built in GMS using the conceptual model \napproach. Refer to the MODFLOW \u2013 Conceptual Model Approach 1  and MODFLOW \u2013 \nConceptual Model Approach 2  tutorials to learn how to create conceptual models for \nMODFLOW.  \nIn this tutorial, an existing MODFLOW 2000 simulation will be converted to a MODFLOW \n6 simulation. The existing conceptual model will be us ed to generate an unstructured grid \n(UGrid) . A MODFLOW 6 simulation will be created and linked to the UGrid. Then, the \nconceptual model approach will be used to create MODFLOW 6 inputs on the UGrid. \nThen the simulation will be checked and run.  \nThe problem solved in this tutorial is illustrated in Figure 1.  \nThis tutorial models the groundwater flow in the valley sediments bounded by the hills to \nthe nor th and the two converging rivers to the south of a site in eastern Texas in the \nUnited States. The boundary to the north will be a no -flow boundary and the remaining \nboundary will be a general head boundary corresponding to the average stage of the \nrivers.  \nIt is necessary to assume that the influx to the system is primarily through recharge due \nto rainfall. There are some creek beds in the area which are sometimes dry but \noccasionally fill up due to influx from the groundwater. These creek beds will be \nrepresented using drains. Two production wells in the area will also be included in the \nmodel.  \nGMS Tutorials   MODFLOW 6 \u2013 Conceptual  Approach  \n \n Page 3 of 11 \u00a9 Aquaveo 2024  \n \nRiver  Well #1  \nWell #2  \nRiver  Creek beds  Limestone Outcropping  North   \n      Figure 1      Plan view of site to be modeled  \nThis tutorial discusses and demonstrates the following key concepts:  \n\uf0b7 Generating a 3D UGrid  \n\uf0b7 Creating  a MODFLOW 6 simulation  \n\uf0b7 Mapping the coverages to a MODFLOW 6 simulation  \n2 Getting Started  \nDo as follows to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select the File | New command to ensure that the \nprogram settings are restored to their default state.  \n2.1 Opening the Existing Model  \nStart with a previously -created project.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the mf6_conceptual \\ folder and select \u201cstart .gpr\u201d. \n4. Click Open to import the project and exit the Open  dialog.  \nThe project should be visible in the Graphics Window ( Figure  2). The project contains a \nMODFLOW 2000 simulation along with a 3D grid, map coverages, and a background \nmap.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Conceptual  Approach  \n Page 4 of 11 \u00a9 Aquaveo 2024   \nFigure  2     Initial project  \n3 Saving the Project  \nBefore making any changes, save the project under a new n ame.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201ceasttex.gpr\u201d for the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \nIt is recommended to periodically Save   while working through the tutorial and while \nworking on any project.  \n4 Setting Up the Grid  \nMODFLOW 6 requires a 3D UGrid before the simulation can be started. Using the \nexisting coverages, a UGrid can be generated. To  do this:  \n1. In the Project Explorer,  right-click on \u201c  Rivers\u201d and select Map To  | UGrid to \nbring up the Map \u2192 UGrid  dialog . \n2. For both the X-Dimension  and the Y-Dimension , set the Cell size method  to Cell \nsize. \n3. For both the X-Dimension  and the Y-Dimension , set the Cell size  to \u201c20\u201d.  \n4. For the Z-Dimension , set the Cell size method  to Number of cells  and set \nNumber of cells  to \u201c1\u201d.  \n5. Click OK to close the Map \u2192 UGrid  dialog.  \nThe 3D UGrid matches the 3D grid. To see this:  \n6. In the Project Explorer , turn off \u201c  grid\u201d.  \n7. Turn off the \u201c   Grid Frame\u201d.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Conceptual  Approach  \n \n Page 5 of 11 \u00a9 Aquaveo 2024  The 3D UGrid is now clearly visible in the Graphics Window ( Figure 3). \n \nFigure 3      The generated UGrid  \n5 Creatin g the Simulation  \nThe next step is to initialize the MODFLOW 6 simulation.  \n1. In the Project Explorer,  right-click on \u201c  Project\u201d and select New Simulation  | \nMODFLOW 6 to bring up the New MODFLOW 6 Simulation  dialog . \n2. For the Simulation name  enter \u201cEasttex\u201d.  \n3. In the Select UGrid  section, make sure the box next to \u201c  ugrid\u201d is checked.  \nNow select the packages. The input to MODFLOW  6 is subdivided into packages. \nPackages can be selected when setting up the simulation. If needed, packages can also \nbe added to the simulation later. For now, select the following packages:  \n4. In the GWF \u2013 Groundwater Flow Model  section, select the following:  \n\uf0b7 DRN \u2013 Drain  \n\uf0b7 GHB \u2013 General Head Boundary  \n\uf0b7 RCH \u2013 Recharge  \n\uf0b7 WEL \u2013 Well  \n5. Click  OK to exit the  New MODFLOW  6 Simulation  dialog.  \nA new sim ulation (\u201c  Easttex\u201d) will appear in the Project Explorer. Also in the Project \nExplorer, the different packages are listed under the simulation (expanding the \u201cflow\u201d \npackage may be necessary to see all the packages). Along with the optional packages \nthat w ere selected, the standard TDIS, IMS, DISV, IC, NPF, and OC packages are listed. \nThese are the default names given by GMS. The names of the packages can be changed \nif desired.  \n6 Mapping from Coverages  \nThe next process is to map the coverages over to MODFLOW 6. Unlike with other \nversions of MODFLOW, MODFLOW 6 does not use the Map \u2192 MODFLOW  command. \nInstead, the Map from Coverage  command will be used.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Conceptual  Approach  \n Page 6 of 11 \u00a9 Aquaveo 2024  6.1 Mapping the Drain Package  \nTo see how the new Map from Coverage  command works, do the following:  \n1. In the Project  Explorer, double -click on \u201c  DRN\u201d to open the Drain (DRN) \nPackage  dialog.  \nNotice that no drain values have been entered into the DRN package. The drain values \nneed to be applied from the drain coverage. To do this:  \n2. Click OK to close the Drain (DRN) Packag e dialog.  \n3. Right -click on \u201c DRN\u201d and select Map from Covera ge\u2026 to bring up the Select \nCoverage  dialog.  \n4. Select the \u201c  Drains\u201d coverage.  \n5. Click OK to close the Select Coverage  dialog and bring up the Map from \nCoverage  dialog.  \n6. When the mapping process is complete, click OK to close the Map from \nCoverage  dialog.  \nThe Graphics Window should appear similar to Figure 4. The drain values have now \nbeen mapped over to the UGrid and added to the drain package.  \n \nFigure 4      Drains added to model  \n6.2 Mapping the General Head Boundary  \nThe General Head Boundary (GHB) package will be used to simulate the rivers in this \nexample. Map o ver the GHB package by doing the following:  \n1. Right -click on \u201c GHB\u201d and select Map from Covera ge\u2026 to bring up the Select \nCoverage  dialog.  \n2. Select the \u201c  Rivers\u201d coverage.  \nAlthough the coverage is named \u201cRivers\u201d it includes only the general head \nboundary conditions, which are used to model the rivers.  \n3. Click OK to close the Select Coverage  dialog and bring up the Map from \nCoverage  dialog.  \n4. When the mapping process is complete, click OK to close the Map from \nCoverage  dialog.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Conceptual  Approach  \n \n Page 7 of 11 \u00a9 Aquaveo 2024  The GHB values have now been added  to the UGrid causing the Graphics Window to \ndisplay similar to Figure  5. \n \n      Figure  5      General head cells added to model  \n6.3 Mapping the  Recharge Package  \nFor recharge that varies from cell to cell, using the conceptual model approach can save \ntime.  \nThe recharge for this example is a constant value of 0.0003 m/d for the entire domain. It \nwould be just as easy to enter the value manually on the grid as it would be to map over \nthe value.  \nFor the sake of showing how to map recharge values, the conceptual model approach \nwill still be used.  \n1. Right -click on \u201c RCH\u201d and select Map from Covera ge\u2026 to bring up the Select \nCoverage  dialog.  \n2. Select the \u201c  Recharge\u201d coverage.  \n3. Click OK to close the Select Coverage  dialog and bring up the Map from \nCoverage  dialog.  \n4. When the mapping process is complete, click OK to close the Map from \nCoverage  dialog.  \nThe recharge value has been added to the MODFLOW 6 simulation.  \n6.4 Mapping the Wells  \nNow add the wells by doing the following:  \n1. Right -click on \u201c WEL\u201d and select Map from Covera ge\u2026 to bring up the Select \nCoverage  dialog.  \n2. Select the \u201c  Wells\u201d coverage.  \n3. Click OK to close the Select Coverage  dialog and bring up the Map from \nCoverage  dialog.  \n4. When the mapping process is complete, click OK to close the Map from \nCoverage  dialog.  \nThe wells should appear in the Graphics Window as seen in Figure 6. \n\nGMS Tutorials   MODFLOW 6 \u2013 Conceptual  Approach  \n Page 8 of 11 \u00a9 Aquaveo 2024   \nFigure 6      Wells added to model  \n6.5 Mapping the Hydraulic Conductivity  \nWhen there are zones with different hydraulic conductivity values, the conceptual model \napproach is ideal. These zones can be represented as separate polygons . \nFor this example, a constant value of 5.5 m/d is used; therefore it would be just as easy \nto apply the value directly to the UGrid. However, for the sake of demonstration, use the \nconceptual model approach by doing the following:  \n1. Right -click on \u201c NPF\u201d an d select Map from Covera ge\u2026 to bring up the Select \nCoverage  dialog.  \n2. Select the \u201c  Aquifer Layer 1\u201d coverage.  \n3. Click OK to close the Select Coverage  dialog and bring up the Map from \nCoverage  dialog.  \n4. When the mapping process is complete, click OK to close the Map from \nCoverage  dialog.  \nThe hydraulic conductivity has now been set.  \n7 Setting the Starting Head  \nThe next step is to enter a constant value for the initial condition of the starting head. This \nwill be done using the Initial Condition package, as GMS currently does not allow this to \nbe done via the conceptual model.  \nTo set the starting head, do the fo llowing:  \n1. In the Project Explorer, right -click on \u201c IC\u201d and select Open \u2026 to bring up the \nInitial Conditions (IC ) Package  dialog.  \n2. In the Constant f ield, enter \u201c230.0\u201d.  \n3. Click OK to close the Initial Conditions (IC ) Package  dialog.  \nThe starting head has now be en set.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Conceptual  Approach  \n \n Page 9 of 11 \u00a9 Aquaveo 2024  8 Saving the Data  \nBefore running the model simulation, the data needs to be saved. Start with saving the \nproject file.  \n1. Click the Save   macro to save the project.  \nThe project file has now been saved. However, the simulation files needed to run \nMODFLO W 6 have not yet been exported. To export these files, do the following:  \n2. In the Project Explorer, right -click on \u201c  Easttex\u201d and select Save Simulation . \nThe files for the simulation have now been exported.  \n9 Checking the Simulation  \nWith the simulation files exported, the simulation can now be checked. The exported files \nare required in order to perform a model check. When performing the model check, GMS \nwill run MODFLOW 6 in \u201cvalidate\u201d mode where model inputs are checked but no \nequations are solved.  \n1. In the Pr oject Explorer, right -click on \u201c  Easttex\u201d and select Check  \nSimulation\u2026  to bring up the Check MODFLOW 6 Simulation  dialog.  \nNotice that the dialog shows errors about DRN elevations being less than the cell bottom.  \n2. Click OK to close the Check MODFLOW 6 Simul ation  dialog.  \nTo fix the errors, the top and bottom elevations of the model grid need to be set.  \n10 Mapping the DISV Package  \nTo fix the top and bottom elevation, the DISV package will be used. First, review the \nelevation data in the conceptual model.  \n1. Select t he \u201c  Aquifer Layer 1\u201d coverage to make it active . \n2. Using the  Select Polygon s tool, double -click on the polygon to open the \nAttribute Table  dialog.  \nNotice the values set for the top and bottom grid elevations (230 and 175).  \n3. Click Cancel  to close the Attribute Table  dialog.  \nNow to map over the top and bottom elevation values:  \n4. Right -click on \u201c DISV\u201d and select Map from Covera ge\u2026 to bring up the Select \nCoverage  dialog.  \n5. Select the \u201c  Aquifer Layer 1\u201d coverage.  \n6. Click OK to close the Select Coverage  dialog and bring up the Map from \nCoverage  dialog.  \n7. When the mapping process is complete, click OK to close the Map from \nCoverage  dialog.  \nIf desired, view the DISV package attributes to verify that the top and bottom values were \nmapped over correctly.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Conceptual  Approach  \n Page 10 of 11 \u00a9 Aquaveo 2024  11 Saving and Checking the Simulation  \nWith the errors fixed, now check the model again. The files for the simulation will need to \nbe exported again before running the model check. To export the simulation and check \nthe model, complete the following:  \n1. Click the Save   macro to save the project.  \n2. In the Project Explorer, right -click on \u201c  Easttex\u201d and select Save Simulation . \n3. Right -click on \u201c  Easttex\u201d and select Check  Simulation\u2026  to bring up the Check \nMODFLOW 6 Simulation  dialog.  \nNo errors should be reported.  \n4. Click OK to clo se the Check MODFLOW 6 Simulation  dialog.  \n12 Running MODFLOW  \nIt is now possible to run MODFLOW:  \n1. Right -click on \u201c  Easttex\u201d and select Run Simulation  to bring up the Simulation \nRun Queue  model wrapper dialog.  \nThe Simulation Run Queue  shows all simulation model  runs currently in progress. Since \nthis project only has one simulation, only one is shown.  \n2. When MODFLOW 6 finishes, click Load Solution . \n3. Click Close  to exit the Simulation Run Queue  dialog.  \n4. Make sure the \u201c  Head\u201d dataset is active in the Project Explorer.  \n5. Click Display Options   to bring up the Display Options  dialog.  \n6. Select \u201cUGrid: ugrid \u2013 [Active]\u201d from the list on the left.  \n7. Turn off Cell Edges . \n8. Turn on Face contours  and click Options \u2026 to open the Dataset Contour \nOptions \u2013 UGrid \u2013 Head  dialog.  \n9. Change the Contour Method  to \u201cColor Fill and Linear\u201d.  \n10. Click OK to close the Dataset Contour Options \u2013 UGrid \u2013 Head  dialog.  \n11. Click OK to close the Display Options  dialog.  \n13 Viewing the Solution  \nAfter the solution has been loaded and contours set, the Graphics Window shoul d appear \nas in Figure 7.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Conceptual  Approach  \n \n Page 11 of 11 \u00a9 Aquaveo 2024   \nFigure 7      Head values from MODFLOW 6 SIMULATION  \nCompare the head values from MODFLOW 6 to those obtained from running MODFLOW \n2000 by doing the following:  \n1. In the Project Explorer , turn on \u201c  grid\u201d.  \n2. Click Display Options   to bring up the Display Options  dialog.  \n3. Select \u201c3D Grid Data\u201d from the list on the left.  \n4. Turn off Cell Edges . \n5. Next to Contours , click Options \u2026 to open the Dataset Contour Options \u2013 3D G rid \n\u2013 Head  dialog.  \n6. Change the Contour Method  to \u201cColor Fill and Linear\u201d.  \n7. Click OK to close the Datase t Contour Options \u2013 3D Grid \u2013 Head  dialog.  \n8. Click OK to close the Display Options  dialog.  \n9. In the Project Explorer, turn on and off \u201cugrid\u201d to compare the head datasets.  \nThe head datasets should be similar between the MODFLOW 6 simulation and the \nMODFLOW 2000 simulation.  \n14 Conclusion  \nThis concludes the \u201cMODFLOW 6 \u2013 Conceptual Model Approach\u201d tutorial. The following \ntopics  were discussed and demonstrated:  \n\uf0b7 Generally, the same conceptual models that have been used in the past can be \nused with MODFLOW 6.  \n\uf0b7 Conceptual models can be mapped to the simulation using the Map from \nCovera ge\u2026 command.  \n\uf0b7 The MODFLOW 6 model checker is different from the model checker for older \nversions of MODFLOW in that it runs MODFLOW in validate mode.  \n\uf0b7 The model native files must be saved before the model checker can be run.  \n \n\n", "filename": "MODFLOW6-ConceptualApproach.pdf", "pages": 11}, "MODFLOW6-EVT": {"text": "GMS Tutorials   MODFLOW  6 \u2013 Evapotranspiration (EVT) Package  \n Page 1 of 10 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW  6 \u2013 Evapotranspiration Package  \nBuild a MODFLOW 6 model using the Evapotranspiration (EVT) \npackage  \n \nObjectives   \nThis tutorial demonstrates adding evapotranspiration data to a MODFLOW 6 simulation . \nPrerequisite Tutorials  \n\uf0b7 Getting Started  \n\uf0b7 MODLFOW 6 Grid \nApproach  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW -USG Model &  \nInterface  \n Time  \n\uf0b7 25\u201345 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW  6 \u2013 Evapotranspiration (EVT) Package  \n Page 2 of 10 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 Opening the Existing Model  ................................ ................................ ..........................  3 \n3 Saving the Project  ................................ ................................ ................................ ...............  4 \n4 Adding  Array -Based EVT  ................................ ................................ ................................ .... 4 \n4.1 SURFACE ................................ ................................ ................................ .....................  4 \n4.2 RATE  ................................ ................................ ................................ ............................  4 \n4.3 DEPTH  ................................ ................................ ................................ .........................  5 \n4.4 IEVT  ................................ ................................ ................................ ..............................  5 \n5 Change IMS Solver Complexity  ................................ ................................ ..........................  5 \n6 Saving the Simulation  ................................ ................................ ................................ .........  5 \n7 Checking the Simulation  ................................ ................................ ................................ ..... 6 \n8 Running MODFLOW 6  ................................ ................................ ................................ .........  6 \n9 Viewing the Flow Budget  ................................ ................................ ................................ .... 6 \n10 Using List -Based EVT  ................................ ................................ ................................ .........  6 \n10.1  Adding EVT via Cell Properties ................................ ................................ .....................  7 \n11 Saving the Simulation  ................................ ................................ ................................ .........  7 \n12 Checking the Simulation  ................................ ................................ ................................ ..... 7 \n13 Running MODFLOW 6  ................................ ................................ ................................ .........  7 \n14 Viewing the Flow Budget  ................................ ................................ ................................ .... 8 \n15 Using Segments  ................................ ................................ ................................ ..................  8 \n15.1  Changing NSEG  ................................ ................................ ................................ ...........  8 \n15.2  Defining the PXDP Data  ................................ ................................ ...............................  9 \n15.3  Defining the PETM Data  ................................ ................................ ...............................  9 \n16 Saving and Checking the Simulation  ................................ ................................ ...............  10 \n17 Running MODFLOW  ................................ ................................ ................................ ..........  10 \n18 Viewing the Flow Budget  ................................ ................................ ................................ .. 10 \n19 Conclusion  ................................ ................................ ................................ .........................  10 \n \n1 Introduction  \nEvapotranspiration is the moving of water from the ground surface to the atmosphere \nthrough evaporation and transpiration. MODFLOW 6 uses the EVT package for model \nevapotranspiration.   \nThe EVT package requires three parameters to determine evapotranspiration: the \nevapotranspiration  (ET) surface elevation, the maximum ET rate, and the extinction \ndepth. When the head in a cell is at or above the ET surface, ET occurs at the maximum \nET rate. When the head is below the extinction depth, ET is zero. In between these two \npoints, the ET va ries linearly ( Figure 1). \n \n      Figure 1      ET model, from Banta  (2000 )1 \n                                                      \n1 Banta, Edward R. (2000), MODFLOW -2000, The U.S. Geological Survey Modular Ground -Water \nModel \u2014Documentation of Packages for Simulating Evapotranspiration  with a Segmented \n\nGMS Tutorials   MODFLOW 6 \u2013 Evapotranspiration (EVT) Package  \n \n Page 3 of 10 \u00a9 Aquaveo 2024  This tutorial explains how to use the EVT package. It uses a grid -based model (no \nconceptual model) with one layer, some wells and drains, recharge, and constant head \ncells.  \nThis tutorial discusses and demonstrates:  \n\uf0b7 Defining an array -based EVT package.  \n\uf0b7 Defining a list -based EVT package.  \n2 Getting Started  \nDo as follows to  get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New command to ensure that the program \nsettings are restored to their default state.  \n2.1 Opening the Existing Model  \nStart with a previously -created project.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the mf6_evt \\ folder and select \u201cstart .gpr\u201d. \n4. Click Open to import the project and exit the Open  dialog.  \nThe project should be visible in the Graphics Window ( Figure  2). The project contains a \nMODFLOW 6 simulation along with a 3D UGrid. Wells, drains, recharge, and constant \nhead boundary conditions have already been de fined. A solution also exists.  \n \nFigure  2     Initial project  \n                                                                                                                                                 \nFunction (ETS1) and Drains wit h Return Flow (DRT1) . Open -File Report 00 -466, Denver, \nColorado , p.3. http://pubs.usgs.gov/of/2000/0466/report.pdf  . \n\nGMS Tutorials   MODFLOW 6 \u2013 Evapotranspiration (EVT) Package  \n Page 4 of 10 \u00a9 Aquaveo 2024  Currently the head in the top right corner of the model is above the ground surface . This \ncan be seen by moving the mouse over the top right corner or  looking at th e dat aset \nvalues. After adding  EVT, the head should end up below the surface . \n3 Saving the Project  \nBefore making any changes, save the project under a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as  type drop-down.  \n3. Enter \u201cevt.gpr\u201d for the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \nIt is recommended to periodically Save   while working through the tutorial and while \nworking on any project.  \n4 Adding Array -Based EVT  \nThe EVT package has not been added to the simulation. To add this data, the EVT \npackage needs to first be added to the MODFLOW 6 simulation.  \nTo do this:  \n1. Right -click on the \u201c flow\u201d model and select New Package  | EVT. \nA new package \u201c EVT\u201d is  now visible in the Project Explorer under the MODFLOW 6 \nsimulation.  \n2. Right -click on \u201c EVT\u201d and select Open  to bring up the Evapotranspiration  (EVT) \nPackage  dialog.  \nStart with reviewing the EVT options:  \n3. Under Sections , turn on OPTIONS . \nUnder OPTIONS , notice  the READASARRAYS  option is on. EVT can be specified using \nlists or arrays, unless the DISU p ackage is used, in which case list -based input must be \nused.  \n4. Under Sections , turn off OPTIONS . \n4.1 SURFACE  \nSURFACE is the elevation of the ET surface (L). To set this:  \n1. Select the SURFACE  tab. \n2. Ensure \u201c CONSTANT \u201d is selected in the drop-down .  \n3. In the Constant  field, enter a value of \u201c59.0\u201d.  \nThis puts the surface a little bit under that top of the grid which is 60.  \n4.2 RATE  \nRATE is the maximum ET flux rate (LT-1). To set this:  \n1. Select the RATE  tab. \n\nGMS Tutorials   MODFLOW 6 \u2013 Evapotranspiration (EVT) Package  \n \n Page 5 of 10 \u00a9 Aquaveo 2024  2. Ensure \u201cCONSTANT\u201d is selected in the drop-down . \n3. In the Constant  field, enter a value of \u201c0.01\u201d.  \n4.3 DEPTH  \nDEPTH is the ET extinction depth (L). To set this:  \n1. Select the DEPTH  tab. \n2. Ensure \u201cCONSTANT\u201d is selected in the combo box.  \n3. In the Constant  field, enter a value of \u201c6.0\u201d.  \n4.4 IEVT  \nPer USGS\u2019s documentation: \u201cIEVT is the layer number that defines the layer in each \nvertical column where evapotranspiration is applied. If IEVT is omitted, \nevapotranspiration by default is applied to cells in la yer 1.\u201d 2 If the cell is inactive or goes \ndry then the EVT will be assigned the cell below unless the user has turned on the \n\u201cFIXED_CELL\u201d option. To access the IEVT settings:  \n1. Select the IEVT  tab \nFor now leave the IEVT as undefined  \n2. Click OK to close the Evapotranspiration (EVT) Package  dialog.  \n5 Change IMS Solver Complexity  \nThe default settings for the IMS package are now inadequate. Change these settings by \ndoing the following:  \n1. If necessary, right -click on \u201c IMS\u201d and select Unlock .  \n2. Right -click on \u201c IMS\u201d and select Open  to bring up the Iterative Model Solution  \n(IMS) dialog.  \n3. Under Sections , turn on OPTIONS . \n4. Under OPTIONS , change COMPLEXITY  from \u201cSIMPLE\u201d to \u201cCOMPLEX\u201d.  \n5. Click OK to close the Iterative Model Solution (IMS)  dialog.  \n6 Saving the Simulation  \nBefore runni ng the model simulation, the data needs to be saved out. Start with saving \nthe project file.  \n1. Click the Save   macro to save the project.  \nThe project file has now been saved. However, the simulation files needed to run \nMODFLOW 6 have not yet been exported. To export these files, do the following:  \n2. In the Project Explorer, right -click on \u201c  sim\u201d and select Save Simulation . \nThe files for the simulation have now been exported.  \n                                                      \n2 Langevin, C.D., Hughes, J.D., Banta, E.R., Niswonger, R.G., Panday, Sorab, a nd Provost, A.M., \n2017, Documentation for the MODFLOW 6 Groundwater Flow Model: U.S. Geological Survey \nTechniques and Methods, book 6, chap. A55, 197 p., https://doi.org/10.3133/tm6A55.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Evapotranspiration (EVT) Package  \n Page 6 of 10 \u00a9 Aquaveo 2024  7 Checking the Simulation  \nWith the simulation files exported, the simulation can now be checked. The exported files \nare required in order to perform a model check. When performing the model check, GMS \nwill run MODFLOW 6 in \u201cvalidate\u201d mode where model inputs are checked but no \nequations are solved.  \n1. In the Project Explorer, right -click on \u201c  sim\u201d and select Check  Simulation  to \nbring up the Check MODFLOW 6 Simulation  dialog.  \nThere should be no errors .  \n2. Click OK to close the Check MODFLOW 6 Simulation  dialog.  \n8 Running MODFLOW 6  \nIt is now possible to run MODFLOW:  \n1. Right -click on \u201c  sim\u201d and select Run Simulation  to bring up a warning \nmessage.  \nBecause a solution was already loaded into the project, this solution will have to be \nunloaded in order for MODFLOW 6 to run.  \n2. Click OK to close the warning dialog and start the Simulation Run Queue  model \nwrapper  dialog.  \nThe Simulation Run Queue  shows all simulation model runs currently in progress. Since \nthis project only has one simulation, only one is shown.  \n3. When MODFLOW 6 finishes, click Load Solution . \n4. Click Close  to exit the Simulation Run Queue  dialog.  \n9 Viewi ng the Flow Budget  \nReview the flow budget from the solution by doing the following:  \n1. In the Project Explorer, double -click the \u201c  model.lst\u201d item to open a text editor.  \n2. Scroll to the bottom of the file.  \n3. In the VOLUME BUDGET\u2026  section, notice there is some wa ter leaving the \nmodel due to EVT.  \n10 Using List -Based EVT  \nA list can also be used in defining the EVT package.  \nTo do this:  \n1. Right -click on \u201c EVT\u201d and select Open  to bring up the Evapotranspiration  (EVT) \nPackage  dialog.  \n2. Under Sections , turn on OPTIONS . \n3. Under Options , turn off the READASARRAYS  option.  \nNotice how the dialog changed. Now the EVT data is specified using a list of cells. Since \nthe whole top of the grid should have EVT, it will be easier to select the cells first instead \nof manually entering the lis t of cells now.  \n4. Click OK to close the Evapotranspiration (EVT) Package  dialog.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Evapotranspiration (EVT) Package  \n \n Page 7 of 10 \u00a9 Aquaveo 2024  10.1 Adding EVT via Cell Properties  \nTo add EVT to the cell properties, complete the following:  \n1. In the UGrid Single Layer  toolbar ( Figure  3), make sure the Single layer  option is \nchecked and the Layer  is set to \u201c1\u201d.  \n \nFigure  3      UGrid Single Layer toolbar  \n2. Using the Select Cells   tool, select all the cells in the top layer.  This can be \ndone typing CTRL+A , or dragging a box around all cells, or using Edit | Select \nAll command.  \n3. Right -click on any selected cell and select Cell Properties  to open the Cell \nProperties Dialog . \n4. In the Packages  list, select EVT. \n5. Click the Define Period   button to define stress period 1.  \n6. Click the Add Rows   button bring up the Add Stresses  dialog.  \n7. For the SURFACE , enter \u201c59\u201d.  \n8. For the RATE , enter \u201c0.01\u201d.  \n9. For the DEPTH , enter \u201c6\u201d.  \n10. Click OK to close the Add Stresses  dialog.  \nThe Cell Properties D ialog  is now populated with a list of EVT data.  \n11. Click OK to close the Cell Properties Dialog . \n11 Saving the Simulation  \nBefore running the model simulation, the data needs to be saved out.  \n1. Click the Save   macro to save the project.  \n2. In the Project Explorer, right -click on \u201c  sim\u201d and select Save Simulation . \nThe files for the simulation have now been exported.  \n12 Checking the Simulation  \nNow check the simulation again before running MODFLOW 6.  \n1. In the Project Explorer, right -click on \u201c  sim\u201d and select Check  Simulation  to \nbring up the Check MODFLOW 6 Simulation  dialog.  \nThere should be no errors .  \n2. Click OK to close the Check MODFLOW 6 Simulation  dialog.  \n13 Running MODFLOW 6  \nIt is now possible to run MODFLOW:  \n1. Right -click on \u201c  sim\u201d and select Run Simulation  to bring up a warning \nmessage.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Evapotranspiration (EVT) Package  \n Page 8 of 10 \u00a9 Aquaveo 2024  Because a solution was already loaded into the project, this solution will have to be \nunloaded in order for MODFLOW 6 to run.  \n2. Click OK to close the warning dialog and start the Simu lation Run Queue  model \nwrapper dialog.  \nThe Simulation Run Queue  shows all simulation model runs currently in progress. Since \nthis project only has one simulation, only one is shown.  \n3. When MODFLOW 6 finishes, click Load Solution . \n4. Click Close  to exit the Simu lation Run Queue  dialog.  \n14 Viewing the Flow Budget  \nReview the flow budget from the solution by doing the following:  \n1. In the Project Explorer, double -click the \u201c  model.lst\u201d item to open a text editor.  \n2. Scroll to the bottom of the file.  \nIn the VOLUME BUDGET\u2026  section, notice the water loss is the same.  \n15 Using Segments  \nThe next steps will take advantage of the extra functionality in the EVT package by \nspecifying a nonlinear curve, such as the one in Figure 4. \n \n      Figure 4      Nonlinear ET curve with three segments  \nThe segments for the curve are defined in the Evapotranspiration (EVT) Package dialog.  \n1. Right -click on \u201c EVT\u201d and select Open  to bring up the Evapotranspiration  (EVT) \nPackage  dialog.  \n2. Under Sections , turn on DIMENSIONS . \n15.1 Changing NSEG  \nTo change the number of segments:  \n1. Under the DIMENSIONS  section, next to Number of ET segments (NSEG) , click \nthe Change...  button to open the NSEG  dialog.  \n00.250.50.751\n0 0.25 0.5 0.75 1\nPXDPPETM\n\nGMS Tutorials   MODFLOW 6 \u2013 Evapotranspiration (EVT) Package  \n \n Page 9 of 10 \u00a9 Aquaveo 2024  2. In the New number of ET segments (NSEG)  field, enter \u201c3\u201d.  \n3. Click OK to close the NSEG  dialog.  \nScrolling to the right of the table will now show that new columns were added.  \n15.2 Defining the PXDP Data  \nThe order of entering the values for PXDP and PETM is i mportant, as explained in the \npackage documentation:  \nPXDP is a proportion of the extinction depth (dimensionless), measured \ndownward from the ET surface, which, with PETM, defines the shape of \nthe relation between the evapotranspiration rate and head. The value of \nPXDP must be between 0.0 and 1.0, inclusive. Repetitions of PXDP and \nPETM are read in sequence such that the first occurrence represents the \nbottom of the first segment, and subsequent repetitions represent the \nbottom of successively lower segment s. Accordingly, PXDP values for \nlater repetitions (representing lower segments) should be greater than \nPXDP values for earlier repetitions.   \nPETM is a proportion of the maximum evapotranspiration rate \n(dimensionless) which, with PXDP, defines the shape of the relation \nbetween the evapotranspiration rate and head. The value of PETM \nshould be between 0.0 and 1.0, inclusive. Repetitions of PXDP and \nPETM are read in sequence such that the first occurrence represents the \nbottom of the first segment, and subseque nt repetitions represent the \nbottoms of successively lower segments. Accordingly, PETM values for \nlater repetitions (representing lower segments) generally would be less \nthan PETM values for earlier repetitions.3 \nDefine the PXDP values for both points, and  apply the same curve to all the cells in the \ngrid. Note that it is possible to have different curves for each cell.  \n1. In the table, scroll to the right to locate the PXDP1  column.  \n2. For all rows in the PXDP1  column, enter \u201c0.5\u201d.  \n3. Repeat steps 1 \u20132 for the PXDP2  column but enter a value of 0.75.  \n15.3 Defining the PETM Data  \nNext, define the PETM data for both points. Make the same curve applies to all the cells \nin the grid.  \n1. In the table, scroll to the right to locate the PETM 1 column.  \n2. For all rows in the PETM1  column, enter \u201c0.8\u201d.  \n3. In the table, scroll to the right to locate the PETM2  column.  \n4. For all rows in the PETM2  column, enter \u201c0.5\u201d.  \n5. Click OK to close the Evapotranspiration (EVT) Package  dialog.  \n                                                      \n3 Banta (2000), p.8. Emphasis added.  \nGMS Tutorials   MODFLOW 6 \u2013 Evapotranspiration (EVT) Package  \n Page 10 of 10 \u00a9 Aquaveo 2024  16 Saving and Checking the Simulation  \nThe files for the simulation will ne ed to be exported again before running the model \ncheck. To export the simulation and check the model, complete the following:  \n1. Click the Save   macro to save the project.  \n2. In the Project Explorer, right -click on \u201c  sim\u201d and select Save Simulation . \n3. Right -click on \u201c  sim\u201d and select Check  Simulation  to bring up the Check \nMODFLOW 6 Simulation  dialog.  \nNo errors should be reported  \n4. Click OK to close the Check MODFLOW 6 Simulation  dialog.  \n17 Running MODFLOW  \nIt is now possible to run MODFLOW:  \n1. Right -click on \u201c  sim\u201d and select Run Simulation  to bring up a warning \nmessage.  \nBecause a solution was already loaded into the project, this solution will have to be \nunloaded in order for MODFLOW 6 to run.  \n2. Click OK to close the warning dialog and start the Simulation Run Queue  mode l \nwrapper dialog.  \nThe Simulation Run Queue  shows all simulation model runs currently in progress. Since \nthis project only has one simulation, only one is shown.  \n3. When MODFLOW 6 finishes, click Load Solution . \n4. Click Close  to exit the Simulation Run Queue  dialog.  \n5. Make sure the \u201c  Head\u201d dataset is active in the Project Explorer.  \n18 Viewing the Flow Budget  \nReview the flow budget from the solution by doing the following:  \n1. In the Project Explorer, double -click the \u201c  model.lst\u201d item to open a text editor.  \n2. Scroll t o the bottom of the file to review the volume budget.  \n19 Conclusion  \nThis concludes the \u201cMODFLOW 6 \u2013 Evapotranspiration (EVT) Package\u201d tutorial. EVT can \nbe entered using a conceptual model, but that is beyond the scope of this tutorial.  The \nfollowing topics we re discussed and demonstrated:  \n\uf0b7 EVT can be entered as arrays or lists with MODFLOW 6.  \n\uf0b7 Selecting cells and then using the Cell Properties dialog is a convenient way to \nspecify EVT values at specific cells.  \n\uf0b7 A nonlinear curve can be defined for EVT by increasi ng NSEG and specifying the \nPXDP and PETM values.  \n \n\n", "filename": "MODFLOW6-EVT.pdf", "pages": 10}, "MODFLOW6-GridApproach": {"text": "GMS Tutorials   MODFLOW 6 \u2013 Grid Approach  \n Page 1 of 15 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW 6 \u2013 Grid Approach  \nBuild a MODFLOW 6 model using a 3D UGrid  \n \nObjectives   \nThis tutorial  describes  the grid approach to MODFLOW 6 pre -processing . \nPrerequisite Tutorials  \n\uf0b7 Getting Started  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW -USG Model &  \nInterface  \n Time  \n\uf0b7 25\u201335 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW 6 \u2013 Grid Approach  \n Page 2 of 15 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 Creating  the UGrid  ................................ ................................ ................................ ........  3 \n3 Creating the MODFLOW 6 Simulation  ................................ ................................ ................  4 \n4 Temporal Discretization  ................................ ................................ ................................ ...... 5 \n5 Constant Head Package  ................................ ................................ ................................ ...... 5 \n6 The NPF Package ................................ ................................ ................................ .................  6 \n6.1 Options  ................................ ................................ ................................ .........................  6 \n6.2 ICELLTYPE  ................................ ................................ ................................ ..................  7 \n6.3 K ................................ ................................ ................................ ................................ ... 7 \n6.4 K33 ................................ ................................ ................................ ...............................  7 \n7 The Recharge Package  ................................ ................................ ................................ ....... 8 \n8 The Drain Package ................................ ................................ ................................ ...............  8 \n9 The Well  Package  ................................ ................................ ................................ ..............  10 \n10 Discretization  ................................ ................................ ................................ .....................  11 \n11 Initial Conditions ................................ ................................ ................................ ................  12 \n12 Output Control  ................................ ................................ ................................ ...................  12 \n13 Saving the Simulation  ................................ ................................ ................................ ....... 13 \n14 Running MODFLOW  ................................ ................................ ................................ ..........  13 \n15 Viewing the Solution  ................................ ................................ ................................ .........  13 \n15.1  Changing Layers  ................................ ................................ ................................ .........  14 \n15.2  Color Fill Contours and Color Legend  ................................ ................................ .........  14 \n16 Conclusion  ................................ ................................ ................................ .........................  15 \n \n1 Introduction  \nA simple MODFLOW 6 simulation can be built in GMS using the grid approach. The grid \napproach involves working directly with the 3D grid to apply sources/sinks and other \nmode l parameters on a cell -by-cell basis. The grid approach is useful for simple problems \nor academic exercises where cell -by-cell editing is necessary.  \nIn GMS, multiple MODFLOW 6 simulations can be created in a single project. This \nmakes creating and comparin g variations of the same model simple.  \nThis tutorial uses  the first example model that is distributed with MODFLOW 6  (Figure 1). \nThree aquifers will be simulated using three layers in the computational grid. The grid \ncovers a square region measuring 75000 feet by 75000 feet.  \nThe grid will consist of 15 rows and 15 columns, each cell measuring 5000 feet by 5000 \nfeet in plan  view. For simplicity, the elevation of the top and bottom of each layer will be \nflat. The hydraulic conductivity values shown are for the horizontal direction. For the \nvertical direction, the tutorial will use some fraction of the horizontal hydraulic \nconductivity.  \nFlow into the system is due to infiltration from precipitation and is defined as recharge in \nthe input. Flow out of the system is due to buried drain tubes, discharging wells (not \nshown on the diagram), and a lake, which is represented by a cons tant head boundary \non the left. Starting heads will be set equal to zero, and a steady state solution will be \ncomputed.  \nGMS Tutorials   MODFLOW 6 \u2013 Grid Approach  \n \n Page 3 of 15 \u00a9 Aquaveo 2024   \n      Figure 1      Sample problem to be solved  \nThis tutorial discusses and demonstrates the following:  \n\uf0b7 Setting up a MODFLOW 6 simulation  \n\uf0b7 Running MODFLOW 6  \n\uf0b7 Viewing the solution  \n2 Getting Started  \nDo as follows to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New command to ensure that the program \nsettings are restored to their  default state.  \n2.1 Creating the UGrid  \nThe first step is to create the UGrid.  \n1. Right -click in the Graphics Window or Project Explorer and select New | UGrid \n3D\u2026  to open the New UGrid  dialog . \n2. In the New UGrid  dialog, change the length to \u201c75000\u201d in the X-Dimensi on and Y-\nDimension  sections.  \n3. Change the Number cells  to \u201c15\u201d in the X-Dimension  and Y-Dimension  sections.  \n4. Change the Number cells  in the Z-Dimension  section to \u201c5\u201d.  \n5. Make certain all of the Origin  fields are set to \u201c0\u201d.  \n6. Click OK to close the New UGrid dialo g. \n\nGMS Tutorials   MODFLOW 6 \u2013 Grid Approach  \n Page 4 of 15 \u00a9 Aquaveo 2024  A UGrid should be visible in the Graphics Window ( Figure  2). \n \nFigure  2     Initial project  \n3 Creating the MODFLOW 6 Simulation  \nThe next step is to initialize the MODFLOW6 simulation.  \n1. In the  Project Explorer,  right-click on \u201c  Project\u201d and select  New Simulation  | \nMODFLOW  6 to bring up the  New MODFLOW 6 Simulation  dialog . \nFirst, select the UGrid. If multiple UGrids were available, the selected on e becomes \nassociated with the simulation. Since this project only has one UGrid available, use that \none. \n2. In the Select UGrid  section, verify the box next to \u201c  ugrid\u201d is checked.  \nNow select the packages. The input to MODFLOW  6 is subdivided into packages. \nPackages can be selected when setting up the simulation. If needed, packages can also \nbe added to the simulation later. For now, select the following packages:  \n3. In the GWF \u2013 Groundwater Flow Model  section, select the following : \n\uf0b7 CHD \u2013 Constant Head  \n\uf0b7 DRN \u2013 Drain \n\uf0b7 RCH \u2013 Recharge  \n\uf0b7 WEL \u2013 Well  \n4. Click OK to exit the New MODFLOW 6 Simulation  dialog . \nA new simulation (\u201c  sim\u201d) will appear in the Project Explorer. Also in the Project \nExplorer, the different packages are listed under the simulation.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Grid Approach  \n \n Page 5 of 15 \u00a9 Aquaveo 2024  5. Expand the new simula tion \u201c sim\u201d and the \u201cflow\u201d package under it . \nAlong with the optional packages that were selected, the standard TDIS, IMS, DIS, IC, \nNPF, and OC packages are listed. These are the default names given by GMS. The \nnames of the packages can be changed if desir ed. \n4 Temporal Discretization  \nReview the temporal discretization for the simulation in the TDIS package. This package \ncontrols the timing for the simulation.  \n1. In the Project Explorer, right -click on \u201c TDIS\u201d and select Open\u2026 to bring up the \nTemporal Discretiza tion (TDIS ) Package  dialog.  \n2. Turn on OPTIONS  in the Sections  area.  \n3. Change the TIME_UNITS  to \u201cSECONDS\u201d to match the example.  \n4. Under PERIODDATA , change the PERLEN  in the first row to \u201c86400\u201d.  \n5. Click OK to close the Temporal Discretization (TDIS) Package  dialog.  \n5 Constant  Head  Package  \nThe next step is to define the head boundary along the west sides of the model. In some \ncases, it is easier to assign values directly to cells. This can be accomplished by editing \nthe properties of the cells. Before using the command, it is necessary to first select the \ncells in the leftmost column.  \nDo the following to select the cells:  \n1. Select the Select Cells   tool. \n2. Drag a box around all of the cells in the leftmost column of the grid to highlight \nthem ( Figure 3). \n \n      Figure 3      Highlight the leftmost column  \n\nGMS Tutorials   MODFLOW 6 \u2013 Grid Approach  \n Page 6 of 15 \u00a9 Aquaveo 2024  To edit the head value:  \n3. Right -click on one of the selected cells and select Cell Properties\u2026  to bring up \nthe Cell Properties D ialog . \n4. Select \u201cCHD\u201d from the Packages  list on the left.  \n5. Click the Add Rows   button to open the Add Stresses  dialog.  \n6. Enter \u201c0.0\u201d in the Value  column of the HEAD  row. \n7. Click OK to exit the Add Stresses dialog.  \n8. Click OK to close the Cell Properties  Dialog . \nNotice that a diamond symbol is displayed in the cells that were edited, indicating they \nare constant head cells ( Figure 4). \n \n      Figure 4      Constant head cells marked on the left  \n6 The NPF Package  \nThe next step is to enter the data for the Node Property Flow (NPF) package. The NPF \npackage computes the conductance between each of the grid cells and se ts up the finite \ndifference equations for the cell -to-cell flow.  \nTo enter the NPF data:  \n1. In the Project Explorer, right -click on \u201c NPF\u201d and select Open\u2026 to bring up the \nNode Property Flow (NPF) Package  dialog.  \nThe options in the Node Property Flow (NPF) Pac kage  are used to define the cell type, \nhydraulic conductivity, and wetting and drying opti ons for every cell in the model. This \nproblem has five layers. The top layer is convertible, and the other layers are confined.  \n6.1 Options  \nStart by adjusting the options:  \n1. In the Sections  list on the left, select OPTIONS . \n2. Turn on the VARIABLECV  option.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Grid Approach  \n \n Page 7 of 15 \u00a9 Aquaveo 2024  3. Turn on the DEWATERED  option.  \n4. Turn on the PERCHED  option.  \nThese options adjust how vertical conductance and head are calculated.  \n6.2 ICELLTYPE  \nNow, enter the data for the  ICELLTYPE:  \n1. If necessary, select GRIDDATA  from the Sections  list on the left, and deselect \nOPTIONS . \n2. Select the ICELLTYPE  tab. \n3. Turn on Layered  and make certain it is set to layer \u201c1\u201d.  \n4. Enter a value of \u201c 1\u201d for the Constant value.  \n5. Change the layer to layer \u201c2 \u201d. \n6. Enter a value of \u201c0\u201d for the Constant value .  \n7. Similarly set the remaining layers (3 \u20135) to 0.  \n6.3 K \nNext, enter the data for the hydraulic conductivity (K):  \n1. Select the K tab. \n2. Turn on Layered  and make certain it is set to layer \u201c1\u201d.  \n3. Enter a value of \u201c 1e-3\u201d for the Constant value.  \n4. Change the layer to layer \u201c2\u201d.  \n5. Enter a value of \u201c1e -8\u201d for the Constant value .  \n6. Change the layer to \u201c3\u201d.  \n7. Enter a value of \u201c1e -4\u201d for the Constant value . \n8. Change the layer to \u201c4\u201d.  \n9. Enter a value of \u201c5e -7\u201d. \n10. Change the layer to \u201c5\u201d.  \n11. Enter a value of \u201c2e -4\u201d. \n6.4 K33 \nFinally, enter the data for vertical hydraulic conductivity  (K33):  \n1. Select the K33 tab. \n2. Turn on the Define  option.  \n3. Turn on Layered and make certain it is set to layer \u201c1\u201d.  \n4. Enter a value of \u201c1e -3\u201d for the Constant value.  \n5. Change the lay er to \u201c2\u201d.  \n6. Enter a value of \u201c1e -8\u201d for the Constant value.  \nGMS Tutorials   MODFLOW 6 \u2013 Grid Approach  \n Page 8 of 15 \u00a9 Aquaveo 2024  7. Change the layer to \u201c3\u201d.  \n8. Enter a value of \u201c1e -4\u201d for the Constant value.  \n9. Change the layer to \u201c4\u201d.  \n10. Enter a value of \u201c5e -7\u201d for the Constant value.  \n11. Change the layer to \u201c5\u201d.  \n12. Enter a value of \u201c2e -4\u201d for the Constant value.  \n13. Click OK to close the Node Property Flow (NPF) Package  dialog . \n7 The Recharge Package  \nEntering data in the recharge package allows simulation of the recharge to an aquifer due \nto rainfall and infiltration . The Recharge and Evapotranspiration packages can use lists or \narrays to define the data, unless the DISU package is used, in which case only lists can \nbe used. The READASARRAY  option in the Options  section switches between the two \nmodes.  \nTo enter the rechar ge data, do the following:  \n1. In the Project Explorer, right -click on \u201c RCH\u201d and select Open\u2026 to bring up the \nRecharge (RCH) Package  dialog.  \n2. If necessary, select PERIODS  from the Sections  list on the left.  \n3. Select the RECHARGE  tab. \n4. Enter a value of \u201c3e -8\u201d for the Constant value.  \n5. Click OK to exit the Recharge (RCH) Package  dialog.  \n8 The Drain Package  \nThe next step is to define the row of drains in the top layer of the model. To define the \ndrains, first select the cells where the drains will be located, and then select the Cell \nProperties\u2026  command.  \nThe drains are located in the top layer ( Figure 5). \n\nGMS Tutorials   MODFLOW 6 \u2013 Grid Approach  \n \n Page 9 of 15 \u00a9 Aquaveo 2024   \n      Figure 5      Cells to be selected  \nTo select the cells, do the following:  \n1. In the UGrid Single Layer  toolbar , select the Single layer  checkbox.  \n2. Enter \u201c1\u201d for the Layer  then press the Tab key. \n \nFigure 6      UGrid Single Layer toolbar  \n3. Using the Select Cells   tool, draw a box selecting cells 2 \u201310 on row 8 ( Figure \n5). \nTo assign drains to the cells:  \n4. Right -click on one of the selected cells and s elect Cell Properties\u2026  to bring up \nthe Cell Properties Dialog . \n5. Select \u201cDRN\u201d from the Packages list on the left.  \n6. Click the Add Rows   button to open the Add Stresses  dialog.  \n7. Accept the defaults and click OK to exit the Add Stresses  dialog.  \nAt this point, en ter an elevation and a conductance for the selected drains. The drains all \nhave the same conductance, but the elevations are not all the same.  \n8. Adjust the values in the ELEV column in the list of drains so the values match \nthis table. All other values should already match the table:  \nLAY ROW  COL  ELEV  COND  \n1 8 2 0.0 1.0 \n1 8 3 0.0 1.0 \n1 8 4 10.0 1.0 \n1 8 5 20.0 1.0 \n1 8 6 30.0 1.0 \n1 8 7 50.0 1.0 \n\nGMS Tutorials   MODFLOW 6 \u2013 Grid Approach  \n Page 10 of 15 \u00a9 Aquaveo 2024  1 8 8 70.0 1.0 \n1 8 9 90.0 1.0 \n1 8 10 100.0 1.0 \n9. Click OK to close the Cell Properties Dialog . \n10. Deselect the cells by clicking anywhere outside the grid.  \nThe drains should now be marked by circles ( Figure 7). \n \n      Figure 7      Location of drain cells (green circles)  \n9 The Well Package  \nSeveral wells need to be defined. Most of the wells are in the top layer but some ar e in \nthe middle and bottom layers. Wells can be defined by selecting cells and entering data \nas was done with the drain package. However, for this exercise, define all the wells \ndirectly using the Well (WEL) Package  dialog.  \n1. In the Project Explorer, right -click on \u201c WEL\u201d and select Open\u2026 to bring up the \nWell (WEL ) Package  dialog . \n2. Click the Add Rows   button to open the Add Stresses  dialog . \n3. Change the Number of rows to add  to be \u201c15\u201d.  \n4. Click OK to close the Add Stresses  dialog .  \n5. Define the wells using the values in the following table:  \nLAY ROW  COL  Q \n5 5 11 -5 \n3 4 6 -5 \n3 6 12 -5 \n\nGMS Tutorials   MODFLOW 6 \u2013 Grid Approach  \n \n Page 11 of 15 \u00a9 Aquaveo 2024  1 9 8 -5 \n1 9 10 -5 \n1 9 12 -5 \n1 9 14 -5 \n1 11 8 -5 \n1 11 10 -5 \n1 11 12 -5 \n1 11 14 -5 \n1 13 8 -5 \n1 13 10 -5 \n1 13 12 -5 \n1 13 14 -5 \nA copy of this table can be found as a spreadsheet file, named \u201c wellpackage .xls\u201d, \nincluded with the tutorial files. This table can be copied into the dialog using the copy \n(Ctrl+C ) and paste ( Ctrl+V ) commands.  \n6. Click  OK to close the Well (WEL) Package  dialog.  \nNow that all of the wells have been defined, it is possible to see them in the Graphics \nWindow ( Figure 8). \n \nFigure 8     Wells added to the simulation  \n10 Discretization  \nDiscretization information is set through the DIS package:  \n\nGMS Tutorials   MODFLOW 6 \u2013 Grid Approach  \n Page 12 of 15 \u00a9 Aquaveo 2024  1. In the Project Explorer, right -click on \u201c DIS\u201d and select Open\u2026 to bring up the \nStructured Discretization (DIS) Package dialog . \n2. If necessary, select \u201cGRIDDATA\u201d from the Sections  list on the left.  \n3. Select the TOP tab. \n4. Enter a Constant  value of \u201c200\u201d.  \n5. Select the BOTM  tab. \n6. Verify that the Layered  option is on and set to layer \u201c1\u201d.  \n7. Enter a value of \u201c -150\u201d for the Constant value.  \n8. Change the layer to \u201c2\u201d.  \n9. Enter a value of \u201c -200\u201d for the Constant value.  \n10. Change the layer to \u201c3\u201d.  \n11. Enter a value of \u201c -300\u201d for the Constant value.  \n12. Change the layer to \u201c4\u201d.  \n13. Enter a value of \u201c -350\u201d for the Constant value.  \n14. Change the layer to \u201c5\u201d.  \n15. Enter a value of \u201c -450\u201d for the Constant value.  \n16. Click OK to close the Structured Discretization (DIS) Package dialog . \n11 Initial Conditions  \nReview the initial conditions before running the simulation. To do this:  \n1. In the Project Explorer, right -click on \u201c IC\u201d and select Open\u2026 to bring up the \nInitial Conditions (IC) Package dialog . \n2. Verify that the Constant  value is set to \u201c0.0\u201d.  \n3. Click OK to close the Initial Conditions (IC) Package dialog . \n12 Output Control  \nBefore running the simulation, the output needs to be defined. To do this:  \n1. In the Project Explorer, right -click on \u201c OC\u201d and select Open\u2026 to bring up the \nOutput Control (OC) Dialog . \n2. Verify that the Preset output  is set to \u201cAt every time ste p\u201d. \n3. Click OK to close the Output Control (OC) Dialog . \nThis dialog also contains an Options  section. There are two options for the budget file \noutput and the head file output. The BUDGET  FILEOUT  option specifies  a file to which \ndesired flow terms can  be written.  The HEAD  FILEOUT  option specifies a file for head \ninformation.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Grid Approach  \n \n Page 13 of 15 \u00a9 Aquaveo 2024  13 Saving the Simulation  \nAt this point, the MODFLOW 6 data is completely defined and ready for the simulation \nrun. Before running MODFLOW 6, save the simulation as a new project:  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Browse to the mf6_grid directory.  \n3. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n4. Enter \u201cmf6 .gpr\u201d as the File name  and click Save  to save the project and close the  \nSave As  dialog.  \n14 Runni ng MODFLOW  \nIt is now possible to run MODFLOW:  \n1. In the Project Explorer, right -click on \u201c  sim\u201d and select Save Simulation . \n2. In the Project Explorer, right -click on \u201c  sim\u201d and select Run Simulation  to \nbring up the Simulation Run Queue  model wrapper dialog.  \nThe Save Simulation command  exports all of the MODFLOW 6 files necessary for the \nmodel run. The Simulation Run Queue  shows all simulation model runs currently in \nprogress. Since this project only has one simulation, only one is shown.  \n3. When MODFLOW 6 finishes, click Load Solution . \n4. Click Close  to exit the Simulation Run Queue  dialog.  \n5. Make sure the \u201c  Head\u201d dataset is active in the Project Explorer.  \n6. Click Display Options   to bring up the Display Options  dialog.  \n7. Select \u201cUGrid: ugrid \u2013 [Active]\u201d from the list on the left.  \n8. Turn on Face contours  and click Options \u2026 to open the Dataset Contour Options  \n\u2013 UGrid - Head  dialog.  \n9. Change the Contour Method  to \u201cBlock Fill\u201d.  \n10. Click OK to close the Dataset Contour Options  \u2013 UGrid - Head  dialog.  \n11. Click OK to close the Display Options  dialog.  \n15 Viewing the Solution  \nAfter the solution has been loaded and contours set, the Graphics Window should appear \nas in Figure 9.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Grid Approach  \n Page 14 of 15 \u00a9 Aquaveo 2024   \n      Figure 9      Contours of MODFLOW 6 solution  \n15.1 Changing Layers  \nView the solutions on the middle and bottom layers by doing the following:  \n1. Click the up  arrow   in the UGrid Single Layer  toolbar  to go to layer 3 (two \nclicks) or layer 5 (four clicks).  \n2. When finished viewing the middle and bottom layer solutions, use the down  \narrow   to return to layer 1.  \n15.2 Color Fill Contours and Color Legend  \nIt is also possible to display the contours using a color fill option.  \n1. Select Display  | Contour Options \u2026 to bring up the Dataset Contour Options \u2013 \nUGrid \u2013 Head  dialog.  \n2. In the Contour method  section, select \u201c Color Fill \u201d from the top drop -down . \n3. At the bottom left, turn on Legend  if it is not already on.  \n4. Click OK to close the Dataset Contour Options \u2013 UGrid \u2013 Head  dialog.  \nThe Graphics Window should appear similar to Figure 10. \n\nGMS Tutorials   MODFLOW 6 \u2013 Grid Approach  \n \n Page 15 of 15 \u00a9 Aquaveo 2024   \n      Figure 10      Color fill contours with a legend  \n16 Conclusion  \nThis concludes the \u201cMODFLOW 6 \u2013 Grid Approach\u201d tutorial. The following topics were \ndiscussed and demonstrated:  \n\uf0b7 Creating a MODFLOW 6 simulation.  \n\uf0b7 Assigning simulation properties to cells in a UGrid.  \n\uf0b7 Defining package  parameters.  \n\uf0b7 Running the simulation and using the Simulation Run Queue . \n \n\n", "filename": "MODFLOW6-GridApproach.pdf", "pages": 15}, "MODFLOW6-SFR": {"text": "GMS Tutorials   MODFLOW  6 \u2013 Stream  Package  \n Page 1 of 9 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW  6 \u2013 Stream  Package  \nBuild a MODFLOW 6 model using the Stream  (SFR) package  \n \nObjectives   \nThis tutorial demonstrates adding stream data to a MODFLOW 6 simulation using the conceptual model \napproach . \nPrerequisite Tutorials  \n\uf0b7 Getting Started  \n\uf0b7 MODLFOW 6 Conceptual \nModel  Approach  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW -USG Model &  \nInterface  \n Time  \n\uf0b7 25\u201345 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW  6 \u2013 Stream  Package  \n Page 2 of 9 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 Opening the Existing Model  ................................ ................................ ..........................  3 \n3 Saving the Project  ................................ ................................ ................................ ...............  4 \n4 Mappin g from Coverages  ................................ ................................ ................................ .... 4 \n5 Saving the Data  ................................ ................................ ................................ ....................  6 \n6 Checking the Simulation  ................................ ................................ ................................ ..... 6 \n7 Adapt the Stream Coverage to MODFLOW 6  ................................ ................................ .... 6 \n8 Saving and Checking the Simulation  ................................ ................................ .................  7 \n9 Running MODFLOW  ................................ ................................ ................................ ............  7 \n10 Conclusion  ................................ ................................ ................................ ...........................  9 \n \n1 Introduction  \nThe MODFLOW 6 SFR package is used to model streamflow routing and flow beneath \nstreams.  \nThis tutorial illustrates how to add SFR stream data to  a MODFLOW 6 simulation by \nmapping a coverage containing streamflow data. The problem is a hypothetical one \n\u201cdeveloped for an alluvial basin in a semiarid region in which recharge to the aquifer is \nprimarily leakage from streams that enter the basin from m ountains on the northwest, \nnortheast, and southeast\u201d.  \nThe tutorial uses one grid layer. An initial MODFLOW 6 simulation has already been \ncreated for the grid. An existing coverage contains stream data. The existing stream \ncoverage will be modified to work with MODFLOW 6.  \nTo learn how to create conceptual models, refer to the \u201cMODFLOW 6 \u2013 Conceptual \nModel Approach\u201d tutorial.  \nThis tutorial discusses and demonstrates the following key concepts:  \n\uf0b7 Mapping the coverages to a MODFLOW 6 simulation.  \n\uf0b7 Adapting the stre am coverage for MODFLOW 6.  \n\uf0b7 Saving and running the MODFLOW 6 simulation.  \n \n \nGMS Tutorials   MODFLOW 6 \u2013 Stream  Package  \n \n Page 3 of 9 \u00a9 Aquaveo 2024   \n      Figure 1      Plan view of site to be  modeled  \n2 Getting Started  \nDo as follows to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New command to ensure that the program \nsettings are restored to their default state.  \n2.1 Opening the Existing Model  \nStart with a previously -created project.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject File s (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the mf6_sfr \\ folder and select \u201cstart .gpr\u201d. \n4. Click Open to import the project and exit the Open  dialog.  \nThe project should be visible in the Graphics Window ( Figure  2). The project contains a \nMODFLOW 6 simulation along with a 3D UGrid, map coverages, and a background map. \n\nGMS Tutorials   MODFLOW 6 \u2013 Stream  Package  \n Page 4 of 9 \u00a9 Aquaveo 2024  Wells, recharge, evaporation, and general head boundary conditions have already been \ndefined. A solution also exists. But there is no stream package.  \n \nFigure  2     Initial project  \n3 Saving the Project  \nBefore making any changes, save the project under a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cmf6 -sfr.gpr\u201d for the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \nIt is recommended to periodically Save   while working through the tutorial and while \nworking on any project.  \n4 Mapping from Coverages  \nThe stream data on the \u201c   Streams\u201d coverage has not been added to the MODFLOW 6 \nsimulation. To add this data, the SFR package needs to first be added to the MODFLOW \n6 simulation.  \nTo do this:  \n\nGMS Tutorials   MODFLOW 6 \u2013 Stream  Package  \n \n Page 5 of 9 \u00a9 Aquaveo 2024  1. Right -click on the \u201c  GWF_Model\u201d and select New Package  | SFR. \nA new package \u201c SFR\u201d is now visible in the Project Explorer under the MODFLOW 6 \nsimulation.  \n2. Right -click on \u201c SFR\u201d and select Open  to bring up the Streamflow Routing \n(SFR) Package  dialog.  \nNotice  that the dialog does not contain any stream data. To add this data:  \n3. Click OK to close the Streamflow Routing (SFR) Package  dialog.  \n4. Right -click on \u201c SFR\u201d and select Map from Coverage  to open the Select \nCoverage  dialog.  \n5. Select the \u201c  Streams\u201d coverage . \n6. Click OK to close the Select Coverage  dialog and bring up the Map from \nCoverage  dialog.  \n7. When the dialog states it has successfully mapped the coverage to the package, \nclick OK to close the Map from Coverage  dialog.   \nThe stream symbols will appear in the ce lls where the stream arcs are  located ( Figure 3). \nIf desired, the Streamflow Routing (SFR) Package  dialog can be opened again to verify \nthe values have been added to th e SFR package.  \n \nFigure 3      The stream data mapped from the coverage to the SFR package  \n\nGMS Tutorials   MODFLOW 6 \u2013 Stream  Package  \n Page 6 of 9 \u00a9 Aquaveo 2024  5 Saving the Data  \nBefore running the model simulation, the data needs to be saved out. Start with saving \nthe project file.  \n1. Click the Save   macro to save the project.  \nThe project file has now been saved. However, the simulation files needed to run \nMODFLOW 6 have not yet been exported. To export these files, do the following:  \n2. In the Project Explorer, right -click on \u201c  Sim\u201d and select Save Simulat ion. \nThe files for the simulation have now been exported.  \n6 Checking the Simulation  \nWith the simulation files exported, the simulation can now be checked. The exported files \nare required in order to perform a model check. When performing the model check, GMS  \nwill run MODFLOW 6 in \u201cvalidate\u201d mode where model inputs are checked but no \nequations are solved.  \n1. In the Project Explorer, right -click on \u201c  Sim\u201d and select Check  Simulation  to \nbring up the Check MODFLOW 6 Simulation  dialog.  \nNotice there are lots of errors about the stream package. These errors are due to the \nstream coverage being designed for the SFR2 package in MODFLOW 2000.  \n2. Click OK to close the Check MODFLOW 6 Simulation  dialog.  \nThe coverage needs to be adapted to work wi th MODFLOW 6 . \n7 Adapt the Stream Coverage to MODFLOW 6  \nIn order to get MODFLOW 6 to successfully run, the values in the \u201c   Streams\u201d \ncoverage need to be adjusted.  \nStart with adjusting the display to make the stream segments more identifiable.  \n1. Select the \u201c   Streams\u201d coverage to make it active.  \n2. Click Display Options   to bring up the Display Options  dialog.  \n3. Select Map Data  from the list on the left.  \n4. Turn on the Segment ID  option.  \n5. Click the button next to the Segment ID  option to open the Font dialog.  \n6. In the Size section, select \u201c16\u201d to change the font size.  \n7. Click OK to close the Font dialog.  \n8. Click OK to close the Display Options  dialog.  \nWith the segment IDs clearly visible, start editing the attributes for each segment by \ndoing the following:  \n9. Using the Select A rcs  tool, double -click on the arc segment labeled \u201c1\u201d to \nopen the Attribute Table  dialog.  \n10. Change ICALC  to \u201cwide channel (1)\u201d. MODFLOW 6 assumes wide rectangular \nchannels.  \n11. For ROUGHCH , enter \u201c0.03\u201d.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Stream  Package  \n \n Page 7 of 9 \u00a9 Aquaveo 2024  12. For WIDTH1  and WIDTH2 , enter \u201c12\u201d.  \n13. Click OK to close the Attribute Table  dialog.  \n14. Repeat steps 9 \u201313 for arc segments 3, 4, 6, and 8 using the values in the table \nbelow.  \nSegment  ROUGHCH  WIDTH1 and WIDTH2  \n1 .03 12 \n3 .03 12 \n4 .025 55 \n6 .03 15 \n8 .025 40 \nNow that the attributes have been defined, they need to be mapped again to the \nMODFLOW 6 simulation. To do this:  \n15. Right -click on \u201c SFR\u201d and select Map from Coverage  to open the Select \nCoverage  dialog.  \n16. Select the \u201c   Streams\u201d coverage . \n17. Click OK to close the Select Coverage  dialog and bring up the Map from \nCoverage  dialog.  \n18. When the dialog states it has successfully mapped the coverage to the package, \nclick OK to close the Map from Coverage  dialog.  \nThe stream data has now been set.  \n8 Saving and Checking the Simulation  \nWith the errors fixed, now to check t he model again. The files for the simulation will need \nto be exported again before running the model check. To export the simulation and check \nthe model, complete the following:  \n1. Click the Save   macro to save the project.  \n2. In the Project Explorer, right -click on \u201c  Sim\u201d and select Save Simulation . \n3. Right -click on \u201c  Sim\u201d and select Check  Simulation  to bring up the Check \nMODFLOW 6 Simulation  dialog.  \nNo errors should be reported  \n4. Click OK to close the Check MODFLOW 6 Simulation  dialog.  \n9 Running MODFLOW  \nIt is now possible to run MODFLOW:  \n1. Right -click on \u201c  Sim\u201d and select Run Simulation  to bring up a warning \nmessage.  \nBecause a solution was already loaded into the project, this solution will have to be \nunloaded in order for MODFLOW 6 to run.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Stream  Package  \n Page 8 of 9 \u00a9 Aquaveo 2024  2. Click OK to close the wa rning dialog and start the Simulation Run Queue  model \nwrapper dialog.  \nThe Simulation Run Queue  shows all simulation model runs currently in progress. Since \nthis project only has one simulation, only one is shown.  \n3. When MODFLOW 6 finishes, click Load Solutio n. \n4. Click Close  to exit the Simulation Run Queue  dialog.  \n5. Make sure the \u201c  Head\u201d dataset is active in the Project Explorer.  \n6. Click Display Options   to bring up the Display Options  dialog.  \n7. Select \u201cUGrid: ugrid \u2013 [Active]\u201d from the list on the left.  \n8. Turn off Cell Edges . \n9. Turn on Face Contours  and click Options  to open the Dataset Contour Options \u2013 \nUGrid \u2013 Head  dialog.  \n10. Change the Contour Method  to \u201cColor Fill and Linear\u201d.  \n11. Click OK to close the Dataset Contour Options  \u2013 UGrid \u2013 Head  dialog.  \n12. Click OK to close the Display Options  dialog.  \n13. Scroll through the time steps.  \nAfter the solution has been loaded and contours set, the Graphics Window should appear \nas in Figure 4. \n \nFigure 4      Head dataset at the first time step  \n\nGMS Tutorials   MODFLOW 6 \u2013 Stream  Package  \n \n Page 9 of 9 \u00a9 Aquaveo 2024  10 Conclusion  \nThis concludes the \u201cMODFLOW 6 \u2013 Stream Package\u201d tutorial. The following topics were \ndiscussed and demonstrated:  \n\uf0b7 Adding the SFR package to a MODFLOW 6 simulation.  \n\uf0b7 Conceptual mode l objects can be mapped to the model using the Map from \nCoverag e command.  \n\uf0b7 Updating attributes in the conceptual model.  \n \n", "filename": "MODFLOW6-SFR.pdf", "pages": 9}, "MODFLOW6-Transient": {"text": "GMS Tutorials   MODFLOW  6 \u2013 Transient Model  \n Page 1 of 7 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW  6 \u2013 Building a Transient Model  \nCreating transient MODFLOW 6 models with time -varying inputs  \n \nObjectives   \nGMS provides a powerful suite of tools for inputting and managing transient data. These tools allow all \ndata to be managed using a date/time format that eliminates much of the extra data processing that is \noften required with modeling projects. This tutorial illustrates how these  tools are used . \nPrerequisite Tutorials  \n\uf0b7 MODLFOW 6 \u2013 Conceptual \nModel  Approach  \n\uf0b7 MODFLOW \u2013 Building a \nTransient Model  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW -USG Model &  \nInterface  \n Time  \n\uf0b7 15\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW  6 \u2013 Transient Model  \n Page 2 of 7 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Importing and Saving the Project ................................ ................................ .......................  2 \n3 Examining the Transient Conceptual Model  ................................ ................................ ..... 3 \n4 Adding the STO Package  ................................ ................................ ................................ .... 4 \n5 Adding Stress Periods to the TDIS Package  ................................ ................................ ..... 4 \n6 Mapping the Recharge  ................................ ................................ ................................ ........  5 \n7 Mapping the Wells  ................................ ................................ ................................ ...............  6 \n8 Saving the Simulation  ................................ ................................ ................................ .........  6 \n9 Checking the Simulation  ................................ ................................ ................................ ..... 6 \n10 Running MODFLOW 6  ................................ ................................ ................................ .........  7 \n11 Examining the Solution  ................................ ................................ ................................ ....... 7 \n12 Conclusion  ................................ ................................ ................................ ...........................  7 \n \n1 Introduction  \nThis tutorial builds on the MODFLOW \u2013 Building a Transient Model  tutorial . That tutorial \ndemonstrates how to enter and import transient recharge and well pump data. This \ntutorial does not repeat that, but instead demonstrates how to create a transient \nMODFLOW 6 model given the transient conceptual model data.  \nThis tutorial discusses and demonstrates opening a MODFLOW 6 model and solution, \nentering transient data, setting up stress periods and defining additional inputs, running \nMODFLOW, and reviewing the results.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2 Importing and Saving the Project  \nTo import the project:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the mf6_ trans ient\\ directory and select \u201c start.gpr \u201d. \n4. Click Open  to import the project and close the Open  dialog.  \nA MODFLOW 6 model with a solution and a set of map coverages should be visible \n(Figure 1). Two of the coverages are the source/sink and hydraulic conductivity \ncoverages used to define the conceptual model. The third coverage is the recharge \ncoverage.  \nBefore continuing, save the project with a new name.  \n5. Select File | Save As \u2026 to bring up the Save As  dialog.  \n6. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n7. Enter  \u201ctrans .gpr\u201d and click Save to close the Save As  dialog.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Transient Model  \n \n Page 3 of 7 \u00a9 Aquaveo 2024  It is recommended to save the project periodically.  \n \n      Figure 1      The initial project in the Graphics Window  \n3 Examining the Transient Conceptual Model  \nThe initial transient data for the wells and recharge has already been included in the \nconceptual model. To see how to add this data to a conc eptual model, see the \nMODFLOW \u2013 Building a Transient Model  tutorial. Before continuing, review this transient \ndata included with the wells in the conceptual model.  \n1. Right -click the \u201c  Sources & Sinks\u201d coverage and select Attribute Table  to \nopen the Attribut e Table  dialog.  \n2. Make certain the Feature type  is set to \u201cPoints\u201d, Show  is set to \u201cAll\u201d, and BC type  \nis set to \u201cwell\u201d.  \nSee that the Flow rate  column says \u201c<transient>\u201d for all the wells.  \n3. On the first well, click the  button in the Flow rate  column to open the XY \nSeries Editor . \nNotice that the pumping rate varies with time and the time is entered as dates/times, not \njust numbers.  \n4. Click OK to close the XY Series Editor . \n\nGMS Tutorials   MODFLOW 6 \u2013 Transient Model  \n Page 4 of 7 \u00a9 Aquaveo 2024  5. Click OK to close the Attribute Table  dialog.  \nRecharge is also time -varying. If desired, t he Attribute Table  for the \u201c  Recharge\u201d \ncoverage can be viewed following steps similar to those above. The rest of the data is \nconstant, including the river, specified head, and hydraulic conductivity data.  \n4 Adding the STO Package  \nTransient models need to s pecify a storage coefficient. Since this is a one -layer \nunconfined aquifer, the specific yield needs to be assigned. The Storage (STO) package \nincludes the specific yield. To add the STO package, complete the following:  \n1. Right -click on \u201c  flow\u201d model and se lect New Package  | STO. \nThe \u201c STO\u201d package will appear in the Project Explorer. The values for the STO \npackage are defined in the conceptual model.  The polygons in the \u201c  Hydraulic \nConductivity\u201d coverage contain the specific yield. To map those polygons to the STO \npackage, complete the following:  \n2. Right -click the \u201c STO\u201d package and select Map from Coverage  to bring up the \nSelect Coverage  dialog.  \n3. Select the \u201c  Hydraulic Conductivity\u201d coverage.  \n4. Click OK to close the Select Coverage  dialog.  \n5. Click OK to close the Map from Coverage  dialog.  \n6. Double -click on the \u201c STO\u201d package to open the Storage (STO) Package  \ndialog.  \n7. Select the SY tab. \nNotice the specific yield data has been added.  \n8. Click OK to close the Storage (STO) Package  dialog.  \n5 Adding Stress Periods to the TDIS Package  \nMODFLOW 6 discretizes time using stress periods and time steps. This project uses the \nTemporal Discretization (TDIS) package for discretization.  \n1. Right-click the \u201c TDIS\u201d package and select Unlock . \n2. Right -click the \u201c TDIS\u201d package and select Open\u2026  to bring up the Temporal \nDiscretization (TDIS) Package dialog.  \n3. Click Add Rows\u2026  to bring up the Rows To Add dialog.  \n4. Enter \u201c7\u201d for the Number of rows to add at  bottom . \n5. Click OK to close the Rows To Add  dialog.  \nEight stress periods are now in the PERIODDATA  table.  \n6. In the STEADY -STATE flow  column, make certain all the boxes past the first row \nare unchecked so that only the first row is checked on.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Transient Model  \n \n Page 5 of 7 \u00a9 Aquaveo 2024  The steady -state versus transient information for each stress period is actually stored in \nthe STO package, not the TDIS, but GMS presents it as a column in the TDIS package \nfor convenience . \nContinue with entering the remaining values for the PERIODDATA  table.  \n7. From the table below, enter the PERLEN  and NSTP  values.  \nRow  PERLEN  NSTP  \n1 30.0 1 \n2 92.0 2 \n3 59.0 1 \n4 61.0 8 \n5 31.0 4 \n6 30.0 4 \n7 62.0 8 \n8 91.0 8 \nNext set the starting date and time by doing the following:  \n8. Under Sections , turn on OPTIONS . \n9. Make sure TIME_UNITS  is on and set to \u201cDAYS\u201d.  \n10. Turn on START_DATE_TIME . \n11. In the START_DATE_TIME  field, enter \u201c9/1/1985\u201d. Alternatively, the Date/Time  \nbutton can be used to bring up a dialog where the date and time can be selected.  \nNotice the ENDDATE  column now shows t he ending date/time for the stress periods . \n12. Click OK to exit the Temporal Discretization (TDIS) Package  dialog.  \n6 Mapping the Recharge  \nNow to map the recharge values from the conceptual model over to the MODFLOW 6 \nsimulation. To do this:  \n1. Right -click the \u201c RCH\u201d package and select Unlock . \n2. Right -click the \u201c RCH\u201d package and select Open\u2026  to bring up the Recharge \n(RCH) Package dialog.  \n3. Select the RECHARGE tab. \n4. Change the Period  and notice that only the first stress period is defined.  \n5. Click OK to close the Recharge (RCH) Package  dialog.  \n6. Right -click the \u201c RCH\u201d package and select Map from Coverage\u2026  to open the \nSelect Coverage  dialog.  \n7. Select the \u201c  Recharge\u201d coverage.  \n8. Click OK to close the Select Coverage  dialog and start the Map from Coverage  \ndialog.  \n9. When fini shed, click OK to close the Map from Coverage  dialog.  \n10. Right -click the \u201c RCH\u201d package and select Open\u2026  to bring up the Recharge \n(RCH) Package dialog.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Transient Model  \n Page 6 of 7 \u00a9 Aquaveo 2024  11. Select the RECHARGE tab. \n12. Change the Period  and notice that all seven stress periods have been defined.  \n13. Click OK to close the Recharge (RCH) Package  dialog.  \n7 Mapping the Wells  \nThe wells now need to be added to the MODFLOW 6 simulation.  \n1. Right -click the \u201c WEL\u201d package and select Unlock . \n2. Right -click the \u201c WEL\u201d package and select Open\u2026  to bring up the Well (WEL ) \nPackage dialog.  \n3. Change the Period  to \u201c2\u201d and notice that only the first period is defined.  \n4. Click OK to close the Well (WEL ) Package  dialog.  \n5. Right -click the \u201c WEL\u201d package and select Map from Coverage\u2026  to open the \nSelect Coverage  dialog.  \n6. Select the \u201c  Sources & Sinks\u201d coverage.  \n7. Click OK to close the Select Coverage  dialog and start the Map from Coverage  \ndialog.  \n8. When finished, click OK to close the Map from Coverage  dialog.  \n9. Right -click the \u201c WEL\u201d package and select Open\u2026  to bring up the Well (WEL ) \nPackage dialog.  \n10. Change the Period  to \u201c2\u201d and notice that all wells have been defined for the \nsecond period and that Q values have been entered.  \n11. Repeat the previous step to view the other periods.  \n12. Select a cell in the Q column for any of the wells in any of the peri ods. \n13. Click the  Plot All Periods  button to open the XY Series Editor  dialog.  \nThe XY Series Editor  shows the pumping rate (Q) for the well for each stress period. If \nthe XY series is edited here, the changes will be made in the Well (WEL) Package  dialog.  \n14. Click Cancel  to close the XY Series Editor  dialog.  \n15. Click Cancel  to close the Well (WEL ) Package  dialog.  \n8 Saving the Simulation  \nBefore running the model simulation, the data needs to be saved out.  \n1. Click the Save   macro to save the project.  \n2. In the Project Explorer, right -click on \u201c  sim\u201d and select Save Simulation . \nThe files for the simulation have now been exported.  \n9 Checking the Simulation  \nNow check the simulation again before running MODFLOW 6.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Transient Model  \n \n Page 7 of 7 \u00a9 Aquaveo 2024  1. In the Project Explorer, right -click on \u201c  sim\u201d and select Check Simulation  to \nbring up the Check MODFLOW 6 Simulation  dialog.  \nThere should be no errors .  \n2. Click OK to close the Check MODFLOW 6 Simulation  dialog.  \n10 Running MODFLOW 6  \nIt is now possible to run MODFLOW:  \n1. Right -click on \u201c  sim\u201d and select Run Simulation  to bring up a warning \nmessage.  \nBecause a solution was already loaded into the project, this solution will have to be \nunloaded in order for MODFLOW 6 to run.  \n2. Click OK to close the warning dialog and start the Simulation Run Queue  model \nwrapper dialog.  \nThe Simulation Run Queue  shows all simulation model runs currently in progress. Since \nthis project only has one simulation, only one is shown.  \n3. When MODFLOW 6 finishes, click Load Solution . \n4. Click Close  to exit the Simulation Run Queue  dialog . \n11 Examining the Solution  \nReview the MODFLOW 6 solution with the transient values by doing the following:  \n1. Make sure the \u201c  Head\u201d dataset is active in the Project Explorer.  \n2. Click Display Options   to bring up the Display Options  dialog.  \n3. Select \u201cUGrid: UGrid \u2013 [Active]\u201d from  the list on the left.  \n4. Turn on Face contours  and click Options  to open the Dataset Contour Options \u2013 \nUGrid \u2013 Head  dialog.  \n5. Change the Contour method  to \u201cColor Fill\u201d.  \n6. Click OK to close the Dataset Contour Options \u2013 UGrid \u2013 Head  dialog.  \n7. Click OK to close the Display Options  dialog.  \n8. Select different time steps to see how the solution varies with time.  \n12 Conclusion  \nThis concludes the \u201cMODFLOW 6 \u2013 Managing Transient Data\u201d tutorial. The following \ntopics were discussed and demonstrated:  \n\uf0b7 The steady -state versus transient information for each stress period is stored in \nthe STO package but GMS displays it in the TDIS package for convenience.  \n\uf0b7 If the transient conceptual model uses absolute dates/times, the TDIS package \nmust define the START_DATE_TIME and UNITS optio ns. \n\uf0b7 With list packages like WEL, an XY series plot of the values over time can be \nviewed and used to edit the data for a particular well.  \n\n", "filename": "MODFLOW6-Transient.pdf", "pages": 7}, "MODFLOW6-TransportGrid": {"text": "GMS Tutorials   MODFLOW  6 \u2013 Trans port Grid Approach  \n Page 1 of 8 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW  6 \u2013 Transport Grid Approach  \nAdd a MODFLOW 6 transport model to a simulation  \n \nObjectives   \nThe tutorial demonstrates a creating a  MODFLOW 6 simulation that uses both a flow and a transport \nmodel .  \n \nPrerequisite Tutorials  \n\uf0b7 Getting Started  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW -USG Model &  \nInterface  \n Time  \n\uf0b7 25\u201345 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW  6 \u2013 Trans port Grid Approach  \n Page 2 of 8 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 Opening the Existing Model  ................................ ................................ ..........................  3 \n3 Saving the Project  ................................ ................................ ................................ ...............  4 \n4 Creati ng the Transport Model  ................................ ................................ .............................  4 \n5 Advection Package  ................................ ................................ ................................ ..............  5 \n6 Dispersion Package ................................ ................................ ................................ .............  5 \n7 Source  and Sink Mixing Package  ................................ ................................ .......................  5 \n8 Initial Conditions Package  ................................ ................................ ................................ .. 6 \n9 Mobile Storage and Transfer Package  ................................ ................................ ...............  6 \n10 Output Control Package  ................................ ................................ ................................ ...... 6 \n11 GWF -GWT Exchange  ................................ ................................ ................................ ...........  6 \n12 Iterative Model Solution Package  ................................ ................................ .......................  7 \n13 Saving and Checking the Simulation  ................................ ................................ .................  7 \n14 Running MODFLOW  ................................ ................................ ................................ ............  8 \n15 Viewing  the Solution  ................................ ................................ ................................ ...........  8 \n16 Conclusion  ................................ ................................ ................................ ...........................  8 \n \n1 Introduction  \nGMS allows having multiple models attached to a MODFLOW 6 simulation. This tutorial \nwill show how to add a transport model to a MODFLOW 6 simulation that already has a \nflow model.  \nThe problem is a hypothetical one \u201coriginally used for comparin g different MT3DMS \nsolutions (i.e., finite -difference, method -of-characteristics, and TVD advection schemes) \nto each other. \u201d \nThe tutorial uses one grid layer. An initial MODFLOW 6 simulation with a flow model has \nalready been created for the grid.  \nThis tu torial discusses and demonstrates the following key concepts:  \n\uf0b7 Adding a transport model to an existing  MODFLOW 6 simulation.  \n\uf0b7 Defining packages for the transport model.  \n\uf0b7 Saving and running the MOFLOW 6 simulation.  \n \n \nGMS Tutorials   MODFLOW 6 \u2013 Trans port Grid Approach  \n \n Page 3 of 8 \u00a9 Aquaveo 2024   \n      Figure 1      Plan view of site to be  modeled  \n2 Getting Started  \nDo as follows to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New command to ensure that the program \nsettings are restored to their default state.  \n2.1 Opening the Existing  Model  \nStart with a previously -created project.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the mf6_transport_p09 \\ folder and select \u201cstart .gpr\u201d. \n4. Click Open to import the project and exit the Open  dialog.  \nThe project should be visible in the Graphics Window ( Figure  2). The project contains a \nMODFLOW 6 simulation along with  a 3D UGrid. Wells and general head boundary \nconditions have already been defined. A solution also exists. But there is no transport \nmodel.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Trans port Grid Approach  \n Page 4 of 8 \u00a9 Aquaveo 2024   \nFigure  2     Initial project  \n3 Saving the Project  \nBefore making any changes, save the proje ct under a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cp09.gpr\u201d for the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \nIt is recommended to periodically Save   while working through the tutorial and while \nworking on any project.  \n4 Creating the Transport Model  \nThe current MODFLOW 6 simulation contains a flow model. This tutorial will demonstrate \nadding a transport model to th e simulation. Building off the same simulation will save time \nand make it easier to compare the flow and transport models.  \nTo do this:  \n\nGMS Tutorials   MODFLOW 6 \u2013 Trans port Grid Approach  \n \n Page 5 of 8 \u00a9 Aquaveo 2024  1. Right -click on \u201c  p09-mf6\u201d and select New Package  | GWT  to bring up the New \nGroun dwater Transport (GWT) Model  dialog.  \n2. Set the Model name  to \u201ctrans\u201d (the default name).  \n3. Under Select UGrid , make certain the \u201cUGrid\u201d is checked . \n4. Under GWT \u2013 Groundwater Transport Model,  select the following options:  \n\uf0b7 ADV \u2013 Advection  \n\uf0b7 DSP \u2013 Dispersion  \n\uf0b7 SSM \u2013 Source and Sink Mixing  \n5. Click OK to clos e the New Groundwater Transport (GWT) Model  dialog.  \nIn the Project Explorer, notice that a new \u201c  trans\u201d model has been added to the \nMODFLOW 6 simulation. Before running the transport model, the packages need to be \nreviewed and defined.  \n5 Advection Package  \nReview the advection package by doing the following:  \n1. In the Project Explorer, under the \u201c   trans\u201d model, right -click on \u201c  ADV\u201d and \nselect Open\u2026  to bring up the Advection (ADV) Package  dialog.  \n2. Set the SCHEME  to \u201cTVD\u201d.  \n3. Click OK to close the Advection (ADV) Package  dialog.  \n6 Dispersion Package  \nThe dispersion package needs to be defined by doing the following:  \n1. Under the \u201c   trans\u201d model, double -click on \u201c DSP\u201d to open the Dispersion \n(DSP) Package  dialog.  \n2. Select the ALH tab which allows defining longitudinal dispersivity in the horizontal \ndirection.  \n3. Turn on the Define  option.  \n4. Set the Constant to \u201c20.0\u201d.  \n5. Select the ATH1  tab which allows defining the transverse dispersivity in the \nhorizontal direction.  \n6. Turn on the Define  option  \n7. Set the Constant to \u201c4.0\u201d.  \n8. Click OK to close the Dispersion (DSP) Package  dialog.  \n7 Source and Sink Mixing Package  \nNow to define the source and sink mixing package, do this:  \n1. Under the \u201c   trans\u201d model, double -click on \u201c SSM\u201d to open the Source and \nSink Mixing (SSM) Package  dialog.  \n2. Click Set Up From Flow Model  to open the Select GWF6  dialog.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Trans port Grid Approach  \n Page 6 of 8 \u00a9 Aquaveo 2024  3. Check on the \u201c  flow\u201d model.  \n4. Click OK to close the Select GWF6  dialog.  \nNotice two lines were added to the table. GMS searched the flow model for any packages \nwith an AUXILIARY variable named \u201cCONCENTRATION \u201d. It found one in the WEL and \nthe CHD packages.  \n5. Click OK to close the Source and Sink Mixing (SSM) Package  dialog.  \n8 Initial Conditions Package  \nReview the initial conditions package by doing the following:  \n1. Under the \u201c   trans\u201d model, double -click on \u201c IC\u201d to open the Initial Conditions \n(IC) Package  dialog.  \nFor this example, the default constant of 0 will be used.  \n2. Click OK to close the Initial Conditions (IC) Package  dialog.  \n9 Mobile Storage and Transfer Package  \nReview the mobile storage and transfer package by  doing the following:  \n1. Under the \u201c   trans\u201d model, double -click on \u201c MST\u201d to open the Mobile \nStorage and Transfer (MST ) Package  dialog.  \nFor this example, the default porosity of 0.3 will be used.  \n2. Click OK to close the Mobile Storage and Trans fer (MST) Package  dialog.  \n10 Output Control Package  \nReview the output control package by doing the following:  \n1. Under the \u201c   trans\u201d model, double -click on \u201c OC\u201d to open the Output Control \n(OC) Dialog . \n2. Change the Preset output  to be \u201cAt every time step\u201d.  \nThis sets  the output to use all time steps.  \n3. Click OK to close the Output Control (OC) Dialog . \n11 GWF -GWT Exchange  \nNow to connect the flow model and the transport model using the GWF -GWT exchange.  \n1. Right -click on \u201c  p09-mf6\u201d and select New Package  | GWF -GWT . \nThe \u201cGWF -GWT\u201d item will appear in the Project Explorer. There are no options that need \nto be set with the GWF -GWT exchange . Still, the GWF -GWT exchange requires that the \nmodels it is exchanging for be specified.  \n2. Double -click on \u201c  p09-mf6\u201d to open the Simulation Opti ons dialog.  \n3. Under Sections , turn on the EXCHANGES option.  \n4. Click the field under EXG MNAMEA  to open the Select Model  dialog.  \n5. Select the \u201c  flow\u201d model and click OK to close the Select Model  dialog.  \n\nGMS Tutorials   MODFLOW 6 \u2013 Trans port Grid Approach  \n \n Page 7 of 8 \u00a9 Aquaveo 2024  6. Click the field under EXGMNAMEB  to open the Select Model  dialog.  \n7. Select the \u201c  trans\u201d model and click OK to close the Select Model  dialog.  \n8. Click OK to close the Simulation Options  dialog.  \n12 Iterative Model Solution Package  \nThe IMS solver package needs to be defined for the transport model. Do this by \ncompleting t he following:  \n1. Right -click on \u201c  p09-mf6\u201d and select New Package  | IMS. \n2. In the Project Explorer, right -click on \u201c  IMS\u201d and select Rename . \n3. Enter \u201cIMS -trans\u201d as the new name and press Enter . \n4. Double -click on \u201c IMS-trans\u201d to open the Iterative Model Solution (IMS)  dialog.  \n5. Under Sections , turn on OPTIONS . \n6. Under the OPTIONS  section, turn off COMPLEXITY . \n7. Under the NONLINEAR  section, turn on the OUTER_DVCLOSE  option and set it \nto \u201c1e -6\u201d. \n8. Also under the NONLINEAR  section, turn on the OUTER_MAXIMUM  option and \nset it  to \u201c100\u201d.  \n9. Under the LINEAR  section, turn on and set the following:  \n\uf0b7 Set INNER_MAXIMUM  to \u201c300\u201d.  \n\uf0b7 Set INNER_DVCLOSE  to \u201c1e -6\u201d. \n\uf0b7 Set INNER_RCLOSE  to \u201c1e -6\u201d. \n\uf0b7 Set LINEAR_ACCELERATION  to \u201cBICGSTAB\u201d.  \n\uf0b7 Set RELAXATION_FACTOR  to \u201c1\u201d.  \n10. Click OK to close the Iterative Model Solution (IMS)  dialog.  \nBefore running the model, the new IMS package needs to be specified for the transport \nmodel:  \n11. Double -click on \u201c  p09-mf6\u201d to open the Simulation Options  dialog.  \n12. Under Sections , turn on the SOLUTIONGROUPS  option.  \n13. Click the blank field under SLNMNAMES  to open the Select Model (s) dialog.  \n14. Select the \u201c  trans\u201d model and click OK to close the Select Model (s) dialog.  \n15. Click OK to close the Simulation Options  dialog.  \nThe transport model has now been set up.  \n13 Saving and Checking the Simulat ion \nTo export the simulation and check the model, complete the following:  \n1. Click the Save   macro to save the project.  \n2. In the Project Explorer, right -click on \u201c  p09-mf6\u201d and select Save Simulation . \n\nGMS Tutorials   MODFLOW 6 \u2013 Trans port Grid Approach  \n Page 8 of 8 \u00a9 Aquaveo 2024  3. Right -click on \u201c  p09-mf6\u201d and select Check  Simulation  to bring up the Check \nMODFLOW 6 Simulation  dialog.  \nNo errors should be reported.  \n4. Click OK to close the Check MODFLOW 6 Simulation  dialog.  \n14 Running MODFLOW  \nIt is now possible to run MODFLOW:  \n1. Right -click on \u201c  p09-m6\u201d and select Run Simulation  to bring up a warning \nmessage.  \nBecause a solution was already loaded into the project, this solution will have to be \nunloaded in order for MODFLOW 6 to run.  \n2. Click OK to close the warning dialog and start the Simulation Run Queue  model \nwrapper dialog.  \nThe Simulation Run  Queue  shows all simulation model runs currently in progress. Since \nthis project only has one simulation, only one is shown.  \n3. When MODFLOW 6 finishes, click Load Solution . \n4. Click Close  to exit the Simulation Run Queue  dialog.  \n15 Viewing the Solution  \nNow to rev iew the solution by doing the following:  \n1. Make sure the \u201c  Concentration\u201d dataset is active in the Project Explorer.  \n2. Click Display Options   to bring up the Display Options  dialog.  \n3. Select \u201cUGrid: UGrid \u2013 [Active]\u201d from the list on the left.  \n4. Turn off Cell edges. \n5. Turn on Face contours  and click Options  to open the Dataset Contour Options \u2013 \nUGrid \u2013 Concentration dialog.  \n6. Change the Contour method  to \u201cColor Fill\u201d.  \n7. Turn on Specify a range . \n8. For the Min enter \u201c0.01\u201d and leave the Max at the default.  \n9. Click OK to close the Dataset Contour Options \u2013 UGrid \u2013 Concentration  dialog.  \n10. Click OK to close the Display Options  dialog.  \n11. Select different time steps to see how the solution varies with time.  \n16 Conclusion  \nThis concludes the \u201cMODFLOW 6 \u2013 Transport Grid Approach\u201d tutorial. The following \ntopics were discussed and demonstrated:  \n\uf0b7 Adding a transport model to a MODFLOW 6 simulation.  \n\uf0b7 Defining packages for a transport model for use in MODFLOW 6.  \n\uf0b7 Saving and running a MODFLOW 6 simulation that contains both a flow model \nand a transport model.  \n\n", "filename": "MODFLOW6-TransportGrid.pdf", "pages": 8}, "MODFLOW6-ZONEBUDGET": {"text": "GMS Tutorials   MODFLOW  6 \u2013 ZONEBUDGET  \n Page 1 of 8 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW  6 \u2013 ZONEBUDGET  \nUse ZONEBUDGET to analyze model results  \n \nObjectives   \nLearn how to use ZONEBUDGET with MODFLOW 6 in GMS .  \n \nPrerequisite Tutorials  \n\uf0b7 Getting Started  \n\uf0b7 MODFLOW 6 \u2013 Grid \nApproach  \n\uf0b7 MODFLOW 6 \u2013 Conceptual \nModel Approach  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW -USG Model &  \nInterface  \n Time  \n\uf0b7 15\u201325 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW  6 \u2013 ZONEBUDGET  \n Page 2 of 8 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 ZONEBUDGET for a DISV MODFLOW 6 Simulation  ................................ .........................  2 \n2.1 Opening the Existing Model  ................................ ................................ ..........................  2 \n2.2 Accessing the Zone Package  ................................ ................................ .......................  3 \n2.3 Assigning IZONE Values  ................................ ................................ ..............................  3 \n2.4 Saving the Zone Package File  ................................ ................................ ......................  4 \n2.5 Running ZONEBUDGET  ................................ ................................ ..............................  4 \n3 ZONEBUDGET for a DIS MODFLOW 6 Simulation  ................................ ............................  4 \n3.1 Opening the Existing Model  ................................ ................................ ..........................  4 \n3.2 Checking the data  ................................ ................................ ................................ .........  5 \n3.3 Opening the Zone Package  ................................ ................................ ..........................  6 \n3.4 Assigning IZONE Values Using a Dataset  ................................ ................................ .... 6 \n3.5 Saving and Running ZONEBUDGET  ................................ ................................ ............  6 \n4 Running ZONEBUDGET for Multiple Models  ................................ ................................ .... 6 \n4.1 Opening the Existing Model  ................................ ................................ ..........................  7 \n4.2 Running ZONEBUDGET  ................................ ................................ ..............................  7 \n5 Conclusion  ................................ ................................ ................................ ...........................  8 \n \n1 Introduction  \nZONEBUDGET is a USGS program that reads cell -to-cell flow data produced by \nMODFLOW 6 and calculates water budgets for sub -regions of the modeled area.  \nThis tutorial builds o n the \u201c MODFLOW  6 \u2013 Grid Approach \u201d and the \u201cMODFLOW \u2013\nConceptual Model\u201d  tutorial. Those tutorials should be completed before this one. The \npurpose of this tutorial is not to teach all about ZONEBUDGET, but simply to \ndemonstrate the ZONEBUDGET interface in GM S. \nTo learn how to create conceptual models, refer to the \u201cMODFLOW 6 \u2013 Conceptual \nModel Approach\u201d tutorial.  \nThis tutorial discusses and demonstrates:  \n\uf0b7 Importing an existing MODFLOW 6 model.  \n\uf0b7 Assigning zone budget IDs to the model grid and running ZONEBUDGET.  \n\uf0b7 Running ZONEBUDGET and viewing the outputs for a MODFLOW 6 solution \nthat used the DISV package.  \n\uf0b7 Running ZONEBUDGET on a MODFLOW 6 solution that used the DIS package.  \n\uf0b7 Running ZONEBUDGET for multiple GWF models.  \n2 ZONEBUDGET for a DISV MODFLOW 6 Simulation  \nStart with generating and viewing the zone budget for a MODFLOW 6 model that used \nthe DISV package for discretization. Do as follows to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New command to ensure that the program \nsettings are restored to their default state.  \n2.1 Opening the Existing Model  \nStart with a previously -created project.  \n1. Click Open   to bring up the Open  dialog.  \n\nGMS Tutorials   MODFLOW 6 \u2013 ZONEBUDGET  \n \n Page 3 of 8 \u00a9 Aquaveo 2024  2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the mf6_zonebudget  folder and select \u201cdisv .gpr\u201d. \n4. Click Open to import the project and exit the Open  dialog.  \nThe project should be visible in the Graphics Window ( Figure  1). The project contains a \nMODFLOW 6 simulation. It is a DISV model with two layers. Solution files containing the \ncell-by-cell flows data are also included.  \n \nFigure  1     Initial project for DISV model  \n2.2 Accessing the Z one Package  \nNow to look at the flow budget for the MODFLOW 6 model:  \n1. Right -click on \u201c ex-gwf-disvmesh \u201d and select the New Package  | Zones  \ncommand . \nThis will create a new \u201cZones\u201d objects in the Project Explorer. The package values \nnow need to be set.  \n2. Double -click on the \u201c Zones\u201d package item to open the Zone File  dialog.  \nThe Zone File  dialog allows defining the sub -regions by specifying zone numbers. This is \ndone in the IZONE section of the dialog.  \n2.3 Assigning IZONE Values  \nThe IZONE array is associated w ith each layer. In this example, the first layer has an \nIZONE value of 1 and the second layer has a value of 2. The default settings already set \nthe first layer to have a value of 1. To set the value for layer 2, complete the following:  \n1. Change the Layered  field to \u201c2\u201d. \n\nGMS Tutorials   MODFLOW 6 \u2013 ZONEBUDGET  \n Page 4 of 8 \u00a9 Aquaveo 2024  2. Change the Constant  field to \u201c2\u201d. \n3. Select OK to exit the Zone File  dialog . \n2.4 Saving the Zone Package File  \nBefore running ZONEBUDGET, the zone file needs to be saved. To do this:  \n1. Right -click on \u201c ex-gwf-disvmesh \u201d and select the Save Simulation  command.   \nThis will export the zone package file.  \n2.5 Running ZONEBUDGET  \nNow to run ZONEBUDGET and view the outputs:  \n1. Right -click on \u201c ex-gwf-disvmesh.cbc\u201d and select the Run ZONEBUDGET  \ncommand to start the MODFLOW 6 Zone Budget  model wrapper dialog.  \n2. When it has finished, click OK to the MODFLOW 6 Zone Budget  dialog.  \nThree items will be added to the \u201c Package\u201d  folder in the Project Explorer: \u201c  ex-gwf-\ndisvmesh_zone_budget\u201d, \u201c  ex-gwf-disvmesh.lst\u201d and \u201c  ex-gwf-disvmesh.csv\u201d.  \n3. Double -click on the \u201c  ex-gwf-disvmesh.lst\u201d item to open a text file.  \n4. Scroll to the bottom of the file to see the budget summary for the two zones.  \n5. When done, close the text file and return to GMS.   \nThe \u201c  ex-gwf-disvmesh.csv\u201d file contains the same information in a different format . The \ncolumn with the IN terms shows how much water flows into the zone. The column with \nthe OUT terms shows how much water flows out of the zone. The column with the FROM \nterms shows how much water flows from one zone into the current zone. Finally, the \ncolumn with the TO term shows how much water flows from the current zone into a given \nzone.  \n3 ZONEBUDGET for a DIS MODFLOW 6 Simulation  \nNow to generate and view the zone budget for a MODFLOW 6 model that used the DIS \npackage for discretization. Do as follows to  get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New command to ensure that the program \nsettings are restored to their default state.  \n3.1 Opening the Existing Model  \nStart with a previously -created project.  \n1. Click Open   to bring  up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the mf6_zonebudget  folder and select \u201cdis .gpr\u201d. \n4. Click Open to import the project and exit the Open  dialog.  \n\nGMS Tutorials   MODFLOW 6 \u2013 ZONEBUDGET  \n \n Page 5 of 8 \u00a9 Aquaveo 2024  The project should be visible in the Graphics Window  (Figure  2). The project contains a \nMODFLOW 6 simulation. It is a DIS model with two layers.  \n \nFigure  2     Initial project for DIS model  \n3.2 Checki ng the data  \nThis project has a predefined zone data.  \n1. Click on the \u201c  zones\u201d dataset under \u201c Ugrid\u201d.  \nThere are three zones that transition from left to right in the model ( Figure 3). Zone 1 is \non the left. Then zone 2 is in the middle and zone 3 is on the right. These data will be \nassigned to the zonebudget input.  \n \nFigure 3     Predefined Zone I D. \n\nGMS Tutorials   MODFLOW 6 \u2013 ZONEBUDGET  \n Page 6 of 8 \u00a9 Aquaveo 2024  3.3 Opening the Zone Package  \nNow to look at the flow budget for the MODFLOW 6 model:  \n1. Right -click on \u201cZones\u201d \u201d and select the Unlock  command . \nBy default, MODFLOW 6 data and packages are locked when first read into GMS.  \n2. Right -click on the \u201c Zones\u201d package item and select Open\u2026  to open the Zone \nFile dialog . \n3.4 Assigning IZONE Values Using a Dataset  \nFor the zone values , use the predefined dataset for each of the layers. To do this:  \n1. On the IZONE  tab, turn off the Layered  check box and change \u201cCONSTANT\u201d to \n\u201cARRAY \u201d. \n2. Click the Dataset to Array  button to open the Select Dataset  dialog.  \n3. Select the \u201c  zones\u201d dataset.  \n4. Click OK to close the Select Dataset  dialog.  \nThis will assign all of the values of the predefined array to the values in the zones \ndataset.  \n5. Turn on the Layered  check box to see the data in layered format.  \nThe values are the same as the predefined dataset shown in Figure 3. \n6. Click OK to close the Zone File  dialog . \n3.5 Saving and Running ZONEBUDGET  \nNow to save and run ZONEBUDGET then view the outputs:  \n1. Right -click on \u201c ex-gwf-bcf2ss\u201d  and select the Save Simulation  command.  \n2. Right -click on \u201c ex-gwf-bcf2ss.cbc\u201d and select the Run ZONEBUDGET  \ncommand to start the MODFLOW 6 Zone Budget  model wrapper dialog.  \n3. When it has finished, click OK to the MODFLOW 6 Zone Budget  dialog.  \nThree items will be added to the \u201c Package\u201d  folder in the Project Explorer: \u201c  ex-gwf-\nbcf2ss_zone_budget\u201d, \u201c  ex-gwf-bcf2ss.lst\u201d and \u201c  ex-gwf-bcf2ss.csv\u201d. This model is \ntransient so the budget output is for each output time step.   \n4. Double -click on the \u201c  ex-gwf-bcf2ss.lst\u201d item to open a text file.  \n5. Scroll to the bottom of the file to see the budget summary for the two zones.  \n6. When done, close the text file and return to GMS.  \n4 Running ZONEBUDGET for Multiple Models  \nZONEBUDGET can be used with a MODFLOW 6 simulation that contains multiple \nmodels.  \nDo as follows to get started:  \n1. If necessary, launch GMS.  \n\nGMS Tutorials   MODFLOW 6 \u2013 ZONEBUDGET  \n \n Page 7 of 8 \u00a9 Aquaveo 2024  2. If GMS is already running, select File | New command to ensure that the program \nsettings are restored to their default state.  \n4.1 Opening the Existing Model  \nStart with a previously -created project.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the mf6_zonebudget  folder and select \u201clgr .gpr\u201d. \n4. Click Open to import the project and exit the Open  dialog.  \nThe project should be visible in the Graphics Window ( Figure  4). This is MODFLOW 6 \nmodel that has multiple GWF models. The zones have been set up on the \"  child\" \nmodel. The first 5 layers of the grid are zone 1, the next 10 layers are zone 2, and the las t \n10 layers are zone 3.  The parent model also has zones set up: one zone for each layer in \nthe nine layer grid.  \n \nFigure  4     Initial project for model with multiple GWF models  \n4.2 Running ZONEBUDGET  \nNow to run ZONEBUDGET then view the outputs:  \n1. Right -click on \u201c child.cbc\u201d and select the Run ZONEBUDGET  command to \nstart the MODFLOW 6 Zone Budget  model wrapper dialog.  \n2. When it has finished, click OK to close the MODFLOW 6 Zone Budget  dialog.  \nIt was not ne cessary to save the simulation in this case because the Zone file data was \nnot edited. Three items will be added to the \u201c Package\u201d  folder in the Project Explorer: \u201c\n child_zone_budget\u201d, \u201c  child.lst\u201d and \u201c  child.csv\u201d .  \n\nGMS Tutorials   MODFLOW 6 \u2013 ZONEBUDGET  \n Page 8 of 8 \u00a9 Aquaveo 2024  3. Double -click on the \u201c  child.lst\u201d item to open a text file.  \n4. Scroll to the bottom of the file to see the budget summary for the zones.  \n5. When done, close the text file.  \n5 Conclusion  \nThis concludes the \u201cMODFLOW 6 \u2013 ZONEBUDGET\u201d tutorial. The following topics were \ndiscussed and demonstrated:  \n\uf0b7 Adding the Zone File to a MODFLOW 6 simulation.  \n\uf0b7 Running ZONEBUDGET.  \n\uf0b7 Reviewing budget summary.  \n\uf0b7 Assigning zone ids from a dataset.  \n \n\n", "filename": "MODFLOW6-ZONEBUDGET.pdf", "pages": 8}, "MODFLOW6_MDT_3D": {"text": "GMS Tutorials   MODFLOW 6 \u2013 MDT Package 3D Transport  \n Page 1 of 8 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW  6 \u2013 MDT Package 3D Transport  \nUse the Matrix Diffusion Transport (MDT) package in GMS to simulate \nmatrix diffusion in a three -dimensional  model using a semi -analytic \napproximation  \n \nObjectives   \nLearn how to use the Matrix Diffusion Trans port (MDT) package with MODFLOW 6  to simulate matrix \ndiffusion in a three -dimensional field scale model with an unstructured grid . \nPrerequisite Tutorials  \n\uf0b7 MOD FLOW -USG  \u2013 \nComplex Stratigraphy  \n\uf0b7 MODFLOW  6 Transport \u2013 \nGrid Approach  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW -USG  Model & \nInterface  \n Time  \n\uf0b7 20\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW 6 \u2013 MDT Package 3D Transport  \n Page 2 of 8 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n3 Enable Gro undwater Transport  ................................ ................................ ..........................  4 \n4 Defining the MST Package  ................................ ................................ ................................ .. 5 \n5 Defining a CNC Package  ................................ ................................ ................................ ..... 5 \n6 Defining the MDT Package  ................................ ................................ ................................ .. 5 \n7 Output Control  ................................ ................................ ................................ .....................  6 \n8 Linking the Simulations  ................................ ................................ ................................ ...... 6 \n9 Saving and Running MODFLOW 6  ................................ ................................ .....................  7 \n10 Examining the Results  ................................ ................................ ................................ ........  7 \n11 Conclusion  ................................ ................................ ................................ ...........................  8 \n \n1 Introduction  \nThe Matrix Diffusion Transport (MDT) package works with MODFLOW -USG Transport \nand MODFLOW 6. The MDT package allows existing flow and chemic al transport models  \nto be upgraded to include a full accounting of matrix diffusion effects.  The MDT package \nis based on the semi -analytic matrix d iffusion method implemented in the REMChlor -MD \nmodel1, 2, 3. The development of this simulation capability has been supported by the \nDepartment of Defense Environmental Security Technology Certification Program \n(ESTCP) and represents a collaborative effort  between Clemson University, GSI \nEnvironmental, and Aquaveo.  \nThe MDT matrix diffusion method is conceptually similar to dual porosity methods, where \nthe volume of each element is divided into \u201cmobile\u201d and \u201cimmobile\u201d fractions. Solute \ntransport occurs by ad vection and dispersion in the mobile fraction, but only by diffusion \nin the immobile fraction. With the MDT package, the concentration profile in the immobile \nfraction is approximated using a dynamic function that expresses the concentration as a \nfunction of distance from the mobile/immobile interface. This function is recomputed at \neach time step in each element using the current and previous concentrations in the \nmobile fraction, along with the integral of the concentration profile in the immobile \nfractio n. The mass transfer to or from the mobile/immobile fractions is then computed as \na linear concentration -dependent source term.  \nThis tutorial demonstrates how the MDT package can be used with a MODFLOW  6 \nsimulation to simulate diffusion in a three -dimensio nal heterogeneous porous media \nsystem where the heterogeneity occurs at the sub -gridblock scale. This example is based \non the unstructured grid flow model developed in the MODFLOW -USG \u2013 Complex \nStratigraphy tutorial, with a hypothetical release of trichlor oethylene (TCE) into the \naquifer.  \n                                                      \n1Farhat, S.K., C.J. Newell, R.W. Falta, and K. Lynch, 2018. REMChlor -MD User\u2019s \nManual, developed for the Environmental Security Technology Certification Program \n(ESTCP) by Clemson Un iversity, Clemson, SC and GSI Environmental Inc., Houston, TX, \nhttps://www.serdp -estcp.org/Program -Areas/Environ mental -Restoration/Contaminated -\nGroundwater/Persistent -Contamination/ER -201426  \n2 Falta, R.W., and W. Wang, 2017, A semi -analytical method for simulating matrix \ndiffusion in numerical transport models, J ournal of Contaminant Hydrology, V. 197, p. 39 -\n49. \n3 Muskus, N., and R.W. Falta, 2018, Semi -analytical method for matrix diffusion in \nheterogeneous and fractured systems with parent -daughter reactions, Journal of \nContaminant Hydrology , V. 218, p. 94 -109. \nGMS Tutorials   MODFLOW  6 \u2013 MDT Package 3D Transport  \n \n Page 3 of 8 \u00a9 Aquaveo 2024  For a more detailed description of the semi -analytic method used in the MDT package, \nplease refer to the REMChlor -MD user\u2019s guide1 and related journal papers2, 3. The input \nvariables used in the MDT package are described in the MDT Process for MODFLOW -\nUSG Transport User\u2019s Guide4. \nThis example uses a five -layer Voronoi UGrid from the MODFLOW -USG Complex \nStratigraphy tutorial and adds the MODFLOW -USG BCT and MDT packages. The layers \nare discontinuous, and have different prop erties, but the properties are assumed to be \nconstant within each layer. The conceptual model is that there are sub -gridblock scale \nheterogeneities such as discontinuous sand, silt, and clay layers that exist throughout the \nmodel domain. These local -scale heterogeneities give rise to strong matrix diffusion \neffects during contaminant transport.  \nWith the MDT approach, the transport in the model is simulated with localized matrix \ndiffusion into and out of the low permeability (low -K) parts of each cell using  the semi -\nanalytic method. The local low permeability zones in each cell are not specifically \ndiscretized; rather they are represented in the model in an average sense, using the \nvolume fraction (VOLFRACMD) of higher permeability (high -K) material, and the  \ncharacteristic diffusion length in the low -K material (DIFFLENMD). The conceptual model \nfor transport is that advective flow occurs in only 20% of the overall volume (the high -K \nfraction) with local matrix diffusion into and out of the remaining 80% low -K fraction.  \nThis tutorial will demonstrate the following topics:  \n1. Opening an existing MODFLOW 6  flow simulation.  \n2. Adding the transport simulation . \n3. Activating the MDT package.  \n4. Running the simulation and examining the results.  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n3. Click Open   (or File | Open \u2026) to bring up the Open  dialog.  \n4. Browse to the data files for this tutorial and select \u201colele.gpr\u201d.  \n5. Click Open  to import the file and close the Open  dialog.  \nThe Graphics Win dow should appear as in Figure  1. \n                                                      \n4 Panday, S., R.W. Falta, S. Farhat, K. Pham, and A. L emon, 2021, Matrix Diffusion \nTransport (MDT) Process for MODFLOW -USG Transport, \nhttps://www.gsienv.com/product/modflow -usg/ \n\nGMS Tutorials   MODFLOW  6 \u2013 MDT Package 3D Transport  \n \n Page 4 of 8 \u00a9 Aquaveo 2024    \nFigure  1      Imported MODFLOW  6 flow model  \nThis model has a five -layer Voronoi UGrid  with local refinement around three pumping \nwells. General heads have been set along the coastal boundary, and a river boundary \ncondition exists along the lower left of the model. The no -flow boundary to the left occurs \nas the aquifer thins and the no -flow boundary in the upper left of the model is a parallel \nflow boundary.   \nThe five model layers are discontinuous and can be viewed by turning on the Single layer  \noption in the Mini-Grid Toolbar  and changing the layer values. A total of 2627 elements \nare use d in this 3D grid.   \nBefore continuing, save the project with a new name.  \n6. Select File | Save As\u2026  to bring up the Save As  dialog.  \n7. Browse to the directory for this tutorial.  \n8. Enter \u201colele_transport.gpr\u201d as the File name . \n9. Select \u201cProject Files (*.gpr)\u201d from th e Save as type  drop-down.  \n10. Click Save  to save the project file and close the Save As  dialog.  \n3 Enable Groundwater Transport  \nMODFLOW  6 transport simulations use the GWT  model . To set up this model, complete \nthe following : \n1. Right -click on \u201c  olele -transport\u201d and  select New Package  | GWT  to bring up the \nNew Groundwater Transport (GWT) Model  dialog.  \n2. Under GWT \u2013 Groundwater Transport Model,  select the following options:  \n\uf0b7 CNC  \u2013 Constant Concentration  \n\uf0b7 SSM \u2013 Source and Sink Mixing  \n\uf0b7 MDT \u2013 Matrix Diffusion  \n\nGMS Tutorials   MODFLOW  6 \u2013 MDT Package 3D Transport  \n \n Page 5 of 8 \u00a9 Aquaveo 2024  3. Click OK to close the New Groundwater Transport (GWT) Model  dialog.  \n4 Defining the MST Package  \nThe parameters for the MST  transport package can now be defined.  \n1. Double -click on the \u201c  MST\u201d package to bring up the Mobile Storage and \nTransfer (MST) Package  dialog . \n2. Select the POROSITY  tab and enter a Constant  of \u201c0.4\u201d. This is the effective \nporosity used for transport. This value is based on our conceptual model where \nthe overall porosity is 0.4, but the flow only occurs in 20% of the material (the \nhigh-K fraction).  \n3. Select the BULK _DENSITY  tab and turn on Define .  \n4. Enter a Constant  of \u201c1.6\u201d. This is the dry bulk density value used for adsorption.  \n5. Select the DISTCO EF tab and turn on Define .  \n6. Enter a Constant  of \u201c0.05\u201d. This value will give a retardation factor R=2 . \n7. Click OK to close the Mobile Storage and Transfer (MST) Package  dialog.  \n5 Defining a CNC Package  \nNext to impose a time -dependent prescribed concentration  for a single cell .  \n1. Double -click on the \u201c  CNC\u201d package to bring up the Constant Concentration \n(CNC) Package  dialog . \n2. Click Add Rows   to open the Add Stresses  dialog.  \n3. For the CELLID  row in the  Value column , enter \u201c886\u201d.  \n4. For the CONC  row in the  Value column , enter \u201c1000\u201d.  \n5. Click OK to close the Add Stresses  dialog.  \n6. Change the Period  to \u201c2\u201d.  \n7. Click the Define Period   button to bring up the Define Period  dialog.  \n8. Ensure that  Copy from previous period (1)  is selected and click OK to close the \nDefine Period  dialog.  \n9. In the  CONC  column, change  to \u201c1\u201d. \n10. Click OK to close the Constant Concentration (CNC) Package  dialog.  \nThis will maintain the concentration in cell 886 at a value of 1000 \u00b5g/L for 10 years, and \nthen will switch  it to a value of 1 \u00b5g/L for the remaining 90 years of the simulation.  This is \nintended to simulate a contaminant source that is removed (mostly) af ter 10 years.  \n6 Defining the MDT Package  \nWith the MDT package activated, the parameters for the MDT package can now be \ndefined.  \n\nGMS Tutorials   MODFLOW  6 \u2013 MDT Package 3D Transport  \n \n Page 6 of 8 \u00a9 Aquaveo 2024  1. Double -click on the \u201c  MDT\u201d package to bring up the Matrix Diffusion Transport \n(MDT) Package  dialog.  \n2. On the MD_TYPE_FLAG  tab, set the Constant  value to \u201c2 \u201d.  \nThis variable is a flag that tells the MDT package how matrix diffusion will be handled. \nChoosing a value of 2 tells the package to allow matrix diffusion into embedded low \npermeability zones with a finite diffusion length.  \n3. On the MD_FRACTION  tab, set the Constant  value to \u201c0.2 \u201d.  \nThis is the volume fraction of high -K material in each cell.  \n4. On the MD_POROSITY  tab, set the Constant  value to \u201c0.4 \u201d.  \nThis sets  the porosity of the low -K material.  \n5. On the BULK_DENSITY  tab, set the Constant  value to \u201c1.6 \u201d.  \nThis is the d ry bulk density of the low -K material.  \n6. On the MD_DIFF_LENGTH  tab, set the Constant  value to \u201c1.64 \u201d.  \nThis is the characteristic diffusion length in the low -K material in each cell. The value here \nwas chosen to be 0.5m , but since the dimensions of this model are in feet, the value is \nconverted to units of feet. More information on the estimation of the diffusion length is \navailable in the REMChlor -MD User\u2019s Guide1. \n7. On the MD_TORTUOSITY  tab, set the Constant  value to \u201c0. 3\u201d.  \nThis sets thet ortuosity of the low -K material in each cell.  \n8. On the MD_DIST_COEFF  tab, set the Constant  value to \u201c0.0 \u201d. \n9. On the MD_DECAY  tab, set the Constant  value to \u201c0.25 \u201d. \n10. On the MD_DIFF_COEFF  tab, set the Constant  value to \u201c9.3e -4\u201d.  \nThis defines t he TCE diffusion coefficient, ft2/d due to the choice of units in this model  \n11. Under Sections , turn on OPTIONS.  \n12. Under OPTIONS , turn on SORPTION . \n13. Click OK to close the Matrix Diffusion Transport (MDT) Package  dialog . \n7 Output Control  \nTo specify the output options:  \n1. Double -click on the \u201c  OC\u201d package under the \u201c  trans\u201d  model  to bring up the \nOutput Control  (OC) Dialog . \n2. Change the Preset output  option  to \u201cAt every time step\u201d . \n3. Click OK to exit the Output Control  (OC) Dialog . \n8 Linking the Simulations  \n1. Right -click on \u201c  olele -transport\u201d and select New Package  | GWF -GWT . \n\nGMS Tutorials   MODFLOW  6 \u2013 MDT Package 3D Transport  \n \n Page 7 of 8 \u00a9 Aquaveo 2024  The \u201cGWF -GWT\u201d item will appear in the Project Explorer. There are no options that need \nto be set with the GWF -GWT exchange . Still, the GWF -GWT exchange requires that the \nmodels it is exchanging for are specified.  \n2. Double -click on \u201c  olele -transport\u201d to open the Simulation Options  dialog.  \n3. Under Sections , turn on the EXCHANGES option.  \n4. Under the EXCHANGES  section  near the bottom , click the field under \nEXG MNAMEA  to open the Select Model  dialog.  \n5. Select the  \u201c GWF_Model \u201d model and click OK to close the Select Model  \ndialog.  \n6. Click the field under EXGMNAMEB  to open the Select Model  dialog.  \n7. Select the \u201c  trans\u201d model and click OK to close the Select Model  dialog.  \n8. Under Sections , turn on the SOLUTIONGROUPS  option . \n9. Click  the field under SLNMNAMES  to open the Select Model (s) dialog.  \n10. Select the \u201c  trans\u201d model to add it and click OK to close the Select Model (s) \ndialog.  \n11. Click OK to close the Simulation Options  dialog.  \n12. Save   the project.  \n9 Saving and Running MODFLOW  6 \nIt is now possible to run MODFLOW:  \n1. Right -click on \u201c  olele -transport\u201d and select Save  Simulation  \n2. Right -click on \u201c  olele -transport\u201d and select Run Simulation  to bring up a \nwarning message.  \nBecause a solution was already loaded into the project, this soluti on will have to be \nunloaded in order for MODFLOW 6 to run.  \n3. Click OK to close the warning dialog and start the Simulation Run Queue  model \nwrapper dialog.  \nThe Simulation Run Queue  shows all simulation model runs currently in progress. Since \nthis project only has one simulation, only one is shown.  \n4. When MODFLOW 6 finishes, click Load Solution . \n5. Click Close  to exit the Simulation Run Queue  dialog.  \n10 Examining the Results  \nNext to make so me adjustments to  improve the appearance of the Concentration  \ncontours.  \n1. In the Project Explorer, select the \u201c  Concentration \u201d dataset to make it active.  \n2. Click the Display Options   macro to open the Display Options  dialog.  \n3. Next to Face contours  click Options  to open the Dataset Contour Options \u2013 \nUGrid \u2013 Concentration  dialog.  \n\nGMS Tutorials   MODFLOW  6 \u2013 MDT Package 3D Transport  \n \n Page 8 of 8 \u00a9 Aquaveo 2024  4. Under Contour Method  select \u201c Color Fill and Linear \u201d and \u201c Use color ramp \u201d.   \n5. Click the Color Ramp  button to open the Color Options  dialog.  \n6. Select Reverse  in the Palette preview  section. \n7. Click OK to close the Color Options  dialog  \n8. Under Data range , turn on Specify a range  and enter a \u201c1\u201d for Min and \u201c1000\u201d for \nMax.   \n9. Turn off the Fill below  and Fill above  boxes.  \n10. Under Contour interval  select \u201c Specified Values \u201d and enter \u201c3 \u201d.   \n11. Turn of f the Fill continuous color range  option.  \n12. In the End Value  column, enter \u201c10\u201d for row 1and enter \u201c100\u201d for row 2. \n13. Click OK to exit the Dataset Contour Options  dialog.   \n14. OK to exit the Display Options  dialog . \n15. In the Time Steps  Window , scroll though the  time steps.  \nThis is 20 years  after the source has been removed. The plume is discharging into the \nocean and also migrating towards two of the extraction wells (in layer 5 where the wells \nare screened).  \n11 Conclusion  \nThis concludes the tutorial. Here are the key concepts from this tutorial:  \n\uf0b7 The MODFLOW  6 MDT package can be used to simulate matrix diffusion in \nheterogeneous porous media for cases where diffusion occurs at the sub -grid \nblock scale.   \n\uf0b7 Normal grid elements are used with embedded matrix diffusion occur ring over a \nfinite distance in the matrix material in each element.  \n \n", "filename": "MODFLOW6_MDT_3D.pdf", "pages": 8}, "MODFLOW6_MDT_DiscreteFracture": {"text": "GMS Tutorials   MODFLOW  6 \u2013 MDT Discrete Fracture  \n Page 1 of 6 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW  6 \u2013 MDT Discrete Fracture  \nUse the Matrix Diffusion Transport package (MDT) in GMS to simulate \ndiffusion from a fracture using a semi -analytic approximation  \nObjectives   \nLearn how to use the Matrix Diffusion Transport package (MDT) with MODFLOW 6 to simulate diffusion \nfrom a single fracture .  \n \nPrerequisite Tutorials  \n\uf0b7 Getting Started  \n\uf0b7 MODFLOW 6 \u2013 Conceptual \nModel Approach  \n\uf0b7 MODFLOW 6 \u2013 Grid \nTransport  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 20\u201330 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   MODFLOW  6 \u2013 MDT Discrete Fracture  \n Page 2 of 6 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Opening a MODFLOW 6 Simulation  ................................ ................................ ...................  3 \n3 Adding the MDT Package  ................................ ................................ ................................ .... 4 \n4 Defining the MDT Package  ................................ ................................ ................................ .. 4 \n5 Saving and Running the Simulation  ................................ ................................ ..................  5 \n6 Examining the Solution  ................................ ................................ ................................ ....... 5 \n7 Conclusion  ................................ ................................ ................................ ...........................  6 \n \n1 Introduction  \nThe Matrix Diffusion Transport package (MDT) works with MODFLOW 6. The MDT \npackage allows existing flow and chemic al transport models  to be upgraded to include a \nfull accounting of matrix diffusion effects.  The MDT package is based on the semi -\nanalytic matrix diffusion method implemented in the REMChlor -MD model1, 2, 3. The \ndevelopment of this simulation capability has been supported by  the Department of \nDefense Environmental Security Technology Certification Program (ESTCP) and it \nrepresents a collaborative effort between Clemson University, GSI Environmental, and \nAquaveo.  \nThe MDT matrix diffusion method is conceptually similar to dual porosity methods, where \nthe volume of each element is divided into \u201cmobile\u201d and \u201cimmobile\u201d fractions. Solute \ntransport occurs by advection, and dispersion in the mobile fraction, but only by diffusion \nin the immobile fraction. With the MDT package, the con centration profile in the immobile \nfraction is approximated using a dynamic function that expresses the concentration as a \nfunction of distance from the mobile/immobile interface. This function is recomputed at \neach time step in each element using the curr ent and previous concentrations in the \nmobile fraction, along with the integral of the concentration profile in the immobile \nfraction. The mass transfer to or from the mobile/immobile fractions is then computed as \na linear concentration -dependent source te rm. \nThis tutorial demonstrates how the MDT package can be used with a MODFLOW 6 \nsimulation to simulate diffusion in a single fracture . This example is based on a \nbenchmarking problem that was developed with REMChlor -MD. For a more detailed \ndescription of t he semi -analytic method used in the MDT package, please refer to the \nREMChlor -MD user\u2019s guide1 and related journal papers2, 3.  \nThe problems in this tutorial consist of a single layer, one -dimensional unstructured grid \n(UGrid) with a MODFLOW 6 simulation. The head values have been set for the grid.  \nFor this example, only the fracture itself is discretized, and the semi -analytic method is \nused to compute the matrix diffusion from the fracture into the adjacent rock matrix. This \nexample is based on a test pr oblem presented by Falta and Wang2 where water \ncontaining tritium is injected into a 100\u00b5m fracture at a pore velocity of 0.1 m/day. The \ntritium concentration is maintained at the upstream end of the grid for a period of 30 \n                                                      \n1 Farhat, S.K., C.J. Newell, R.W. Falta, and K. Lynch, 2018. REMChlor -MD User\u2019s Manual, \ndeveloped for the E nvironmental Security Technology Certification Program (ESTCP) by Clemson \nUniversity, Clemson, SC and GSI Environmental Inc., Houston, TX, https://www.serdp -\nestcp.org/Program -Areas/Environmental -Restoration/Contaminated -Groundwater/Persistent -\nContamination/ER -201426  \n2 Falta, R.W., and W. Wang, 2017, A semi -analytical method for simulating matrix diffusion in \nnumerical transport models, J ournal of Contaminant Hydrology, V. 197, p. 39 -49. \n3 Muskus, N., and R.W. Falta, 2018, Semi -analytical method for matrix diffusion in heterogeneous \nand fractured systems with parent -daughter reactions, Journal of Contaminant Hydrology , V. 218, \np. 94 -109. \nGMS Tutorials   MODFLOW 6 \u2013 MDT Discrete Fracture  \n Page 3 of 6 \u00a9 Aquaveo 2024  years, followed by injection of clean water. Additional model parameters are given in \nTable 1.  \nTable 1.  Parameters used in the fractured rock matrix diffusion comparison  \nParameter  Fracture  Matrix  \nFracture aperture, \u03bcm  100  \nPorosity , \u03d5 1.0 0.01 \nTortuosity , \u03c4 1.0 0.1 \nRetardation factor, R 1.0 1.0 \nDarcy  velocity , vx (m/d)  0.1 0 \nDiffusion coefficient of tritium, D (m2/s) 1.6E-9                    1.6E-9                           \ntritium decay rate (1/yr)  0.0561  0.0561  \nLoading period, t1, (years)  30  \nThis tutorial will demonstrate the following topics:  \n1. Opening an existing MODFLOW 6 simulation.  \n2. Activating the MDT package.  \n3. Running the simulation and examining the results.  \n2 Opening a MODFLOW 6 Simulation  \nStart with opening a MODFLOW 6 model:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select the File | New command to ensure that the \nprogram settings are restored to their default state.  \nStart with a previously created project.  \n4. Click Open   to bring up the Open  dialog.  \n5. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n6. Browse to the mf6_mdt_discrete  folder and select \u201cstart .gpr\u201d. \n7. Click Open to import the project and exit the Open  dialog.  \nThe project should be visible in the Graphics Window ( Figure  1). \n \nFigure  1     Initial project for the MODFLOW 6 model  \nA total of 61 elements are used in this 1D grid. These elements have dimensions of 1 m \nin the direction of flow (x -direction), 1 m per pendicular to the flow (y -direction), and \n0.0001 m vertically (z -direction). The very small vertical dimension reflects the 100 \u00b5m \nfracture aperture.  \nThe hydraulic head in the leftmost element is maintained at a constant head of 11 m \nusing the CHD package , while the rightmost element is maintained at a head of 10 m. \nThe horizontal hydraulic conductivity was set to a value of 2190 m/yr, resulting in a Darcy \nvelocity of 36.5 m/yr or 0.1 m/d. Since the fracture porosity was set to 1 in the MST  \npackage, the po re velocity is equal to the Darcy velocity in this example.  \n\nGMS Tutorials   MODFLOW 6 \u2013 MDT Discrete Fracture  \n Page 4 of 6 \u00a9 Aquaveo 2024  Before continuing, save the project with a new name.  \n8. Select File | Save As\u2026  to bring up the Save As  dialog.  \n9. Browse to the Tutorials \\MODFLOW 6 \\mf6_mdt_discrete  directory.  \n10. Enter \u201cdiscrete_fracture.g pr\u201d as the File name . \n11. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n12. Click Save  to save the project file and close the Save As  dialog.  \n3 Adding the MDT Package  \nThe MODFLOW 6 simulation has been setup without the MDT package. Both a \ngroundwater flow model and a groundwater transport model have been added. The MDT \npackage can be added by doing the following:  \n1. Right -click on \u201c  trans\u201d and select New Package  | MDT  to add the package.  \nNotice the  \u201c  MDT\u201d package is now shown in the Project  Explorer under the \ngroundwater transport model . Make certain the package is not locked before continuing.  \n2. In the Project Explorer, right -click on \u201c  model -mdt\u201d and select Unlock All .  \n4 Defining the MDT Package  \nThe MDT package can be defined during the process of setting up the GWT model or \nafter the GWT model has been created as in this case. To define the MDT package, do \nthe following:  \n1. Double -click on the \u201c  MDT\u201d package to bring up the Matrix Diffusion Transport \n(MDT) Package  dialog.  \n2. On the MD_TYPE_FL AG tab, set the Constant  value to \u201c4 \u201d. This variable is a flag \nthat tells the MDT package how matrix diffusion will be handled. Choosing a \nvalue of 4 tells the package to allow matrix diffusion from both the top and bottom \nof the element into an infinite m edia. This example uses this option because it is \ndirectly modeling only the fracture volume.  \n3. On the MD_FRACTION  tab, set the Constant  value to \u201c0 \u201d.  This is the volume \nfraction of low permeability material in the element. Since this example is only \nmodeli ng the fracture, the value is zero.   \nNote : this convention is different from that used in  REMChlor -MD and in the \nMODFLOW -USG MDT package where the MDT volume fraction is the fraction of \nhigh permeability material in the element.  \n4. On the MD_POROSITY  tab, set the Constant  value to \u201c0.01 \u201d. This is the porosity \nof the unfractured rock.  \n5. On the BULK_DENSITY  tab, set the Constant  value to \u201c2.0 \u201d. This is the dry bulk \ndensity of the rock, which is not used in this simulation of tritium transport.  \n6. On the MD_D IFF_LENGTH  tab, set the Constant  value to \u201c1e -10\u201d. The \ncharacteristic diffusion length is used with other MD_TYPE_FLAG options, but is \nnot needed for MD_TYPE_FLAG -4. Nonetheless, a small non -zero value has \nbeen added.  \n\nGMS Tutorials   MODFLOW 6 \u2013 MDT Discrete Fracture  \n Page 5 of 6 \u00a9 Aquaveo 2024  7. On the MD_TORTUOSITY  tab, set the Cons tant value to \u201c0.1 \u201d. This is the \ntortuosity in the rock matrix  \n8. On the MD_DIST_COEFF  tab, set the Constant  value to \u201c0.0 \u201d. This is the \nadsorption distribution coefficient, which is not used in this example.  \n9. On the MD_DECAY  tab, set the Constant  value to \u201c0. 0561 \u201d. This is the tritium \ndecay rate, 1/yr.  \n10. On the MD_DIFF_COEFF  tab, set the Constant  value to \u201c0.0504 6\u201d. This is the \ntritium molecular diffusion coefficient, m2/yr. \n11. Click OK to close the Matrix Diffusion Transport (MDT) Package  dialog .  \nThe MDT Package is now set up for the discrete fracture and ready for the simulation \nrun. \n5 Saving and Running the Simulation  \nSave and run the simulation by doing the following:  \n1. Right -click on \u201c  model -mdt\u201d and select Save Project, Simulation and Run  to \nstart the Simulation  Run Queue . \n2. If it appears, click OK on the Info dialog to unload the previous solution.  \n3. Click Load Solution  to import the solution files.  \n4. Click Close  to exit the Simulation Run Queue . \n6 Examining the Solution  \nNow examine the results of the MDT package being included in the transport model.  \n1. Switch to the UGrid   module.  \n2. In the Project Explorer, select the \u201c   Concentration\u201d dataset in the \u201c  trans\u201d \nfolder under the \u201c  model -mdt (MODFLOW 6)\u201d folder.  \n3. Using the Select Cells   tool, select cell 2 (the second cell on the left ). \n4. Click the Plot Wizard   macro to open the Plot Wizard  dialog.  \n5. Under Plot Type , select \u201cActive Dataset Time Series\u201d.  \n6. Click Finish  to close the Plot Wizard  and generate the plot.  \nThe generated plot should appear similar to Figure 2. \n\nGMS Tutorials   MODFLOW 6 \u2013 MDT Discrete Fracture  \n Page 6 of 6 \u00a9 Aquaveo 2024   \nFigure 2     The active dataset time series plot  \n7 Conclusion  \nThis concludes the \u201cMODFLOW 6 \u2013 MDT Discrete Fracture\u201d tutorial. The following topics \nwere discussed and demonstrated:  \n\uf0b7 Adding the MDT Package to MODFLOW 6.  \n\uf0b7 Defining the MDT Package.  \n\uf0b7 Running MODFLOW 6.  \n\uf0b7 Reviewing the MODFLOW 6 solution.  \n \n\n", "filename": "MODFLOW6_MDT_DiscreteFracture.pdf", "pages": 6}, "MODFLOW6_MDT_EquivalentPorous": {"text": "GMS Tutorials   MODFLOW  6 \u2013 MDT Equivalent Porous  \n Page 1 of 6 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW  6 \u2013 MDT Equivalent Porous  \nUse the Matrix Diffusion Transport package (MDT) in GMS to simulate \nmatrix diffusion from fractures using a semi -analytic approximation  \nObjectives   \nLearn how to use the Matrix Diffusion Transport package (MDT) with MODFLOW 6 to simulate diffusion \nfrom a set of parallel fractures .  \n \nPrerequisite Tutorials  \n\uf0b7 Getting Started  \n\uf0b7 MODFLOW 6 \u2013 Conceptual \nModel Approach  \n\uf0b7 MODFLOW 6 \u2013 Grid \nTransport  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n Time  \n\uf0b7 20\u201330 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   MODFLOW  6 \u2013 MDT Equivalent Porous  \n Page 2 of 6 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Opening a MODFLOW 6 Simulation  ................................ ................................ ...................  3 \n3 Adding the MDT Package  ................................ ................................ ................................ .... 4 \n4 Defining the MDT Package  ................................ ................................ ................................ .. 4 \n5 Saving and Running the Simulation  ................................ ................................ ..................  5 \n6 Examining the Solution  ................................ ................................ ................................ ....... 5 \n7 Conclusion  ................................ ................................ ................................ ...........................  6 \n \n1 Introduction  \nThe Matrix Diffusion Transport package (MDT) works with MODFLOW 6. The MDT \npackage allows existing flow and chemic al transport models  to be upgraded to include a \nfull accounting of matrix diffusion effects. The MDT package is based on the semi -\nanalytic matrix diffusion method implemented in the REMChlor -MD model1, 2, 3. The \ndevelopment of this simulation capability has been supported by  the Department of \nDefense Environmental Security Technology Certification Program (ESTCP) and with \ncollaboration between Clemson University, GSI Environmental, and Aquaveo.  \nThe MDT matrix diffusion method is conceptually similar to dual porosity methods, where \nthe volume of each element is divided into \u201cmobile\u201d and \u201cimmobile\u201d fractions. Solute \ntransport occurs by advection, and dispersion in the mobile fraction, but only by diffusion \nin the immobile fraction. With the MDT package, the concentration profile  in the immobile \nfraction is approximated using a dynamic function that expresses the concentration as a \nfunction of distance from the mobile/immobile interface. This function is recomputed at \neach time step in each element using the current and previous c oncentrations in the \nmobile fraction, along with the integral of the concentration profile in the immobile \nfraction. The mass transfer to or from the mobile/immobile fractions is then computed as \na linear concentration -dependent source term.  \nThis tutorial demonstrates how the MDT package can be used with a MODFLOW 6 \nsimulation to simulate diffusion in a series of parallel fractures. Th is example is based on \na benchmarking problem that w as developed with REMChlor -MD. For a more detailed \ndescription of the se mi-analytic method used in the MDT package, please refer to the \nREMChlor -MD user\u2019s guide1 and related journal papers2, 3.  \nThe problems in this tutorial consist of a single layer, one -dimensional unstructured grid \n(UGrid) with a MODFLOW 6 simulation. The h ead values have been set for the grid.  \nThis tutorial will demonstrate the following topics:  \n1. Opening an existing MODFLOW 6 simulation.  \n2. Activating the MDT package.  \n3. Running the simulation and examining the results.  \n                                                      \n1 Farhat, S.K., C.J. Newell, R.W. Falta, and K. Lynch, 2018.  REMChlor -MD User\u2019s Manual, \ndeveloped for the Environmental Security Technology Certification Program (ESTCP) by Clemson \nUniversity, Clemson, SC and GSI Environmental Inc., Houston, TX, https://www.serdp -\nestcp.org/Program -Areas/Environmental -Restoration/Contaminated -Groundwater/Persistent -\nContamination/ER -201426  \n2 Falta, R.W., and W. Wang, 2017, A semi -analytical method for simulating matrix diffusion in \nnumerical transport models, J ournal of Contaminant Hydrology, V. 197, p. 39 -49. \n3 Muskus, N., and R.W. Falta , 2018, Semi -analytical method for matrix diffusion in heterogeneous \nand fractured systems with parent -daughter reactions, Journal of Contaminant Hydrology , V. 218, \np. 94 -109 \nGMS Tutorials   MODFLOW 6 \u2013 MDT Equivalent Porous  \n Page 3 of 6 \u00a9 Aquaveo 2024  2 Opening a MODFLOW 6 Simulation  \nStart with o pening a MODFLOW 6 model:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select the File | New command to ensure that the \nprogram settings are restored to their default state.  \nStart with a previously created project.  \n4. Click Open   to bring up the Open  dialog.  \n5. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n6. Browse to the mf6_mdt_equivalent_porous folder and select \u201cstart .gpr\u201d. \n7. Click Open to import the project and exit the Open  dialog.  \nThe project should be visible in the Graphics Window  (Figure  1). \n \nFigure  1     Initial project for the MODFLOW 6 model  \nThis model has a single layer UGrid. Specified heads (CHD) have been set at each end. \nA total of 61 elements a re used in this 1D grid. These elements have dimensions of 1 m \nin the direction of flow (x -direction), 1 m perpendicular to the flow (y -direction), and 1 m \nvertically (z -direction).   \nThe hydraulic head in the leftmost element is maintained at a constant h ead of 11 m \nusing the CHD package, while the rightmost element is maintained at a head of 10 m.  \nA general simulation approach, which can be used for systems with multiple fractures, \ninvolves using an equivalent porous media approach. With this method, nor mal full -sized \nelements are used with the fractures embedded inside the elements. From a flow \nperspective, it is possible to calculate an equivalent porous media hydraulic conductivity \nthat gives the same overall flow, averaged over the entire area (the Da rcy velocity). Since \nthe fractures occupy only a small fraction of the volume, the pore velocity in the fractures \nis much higher than the Darcy velocity of the entire rock mass.  \nThe MDT package can simulate matrix diffusion in a system of embedded parallel  \nfractures using the method described in Muskus and Falta3. In order to do this, it is \nnecessary to generate a numerical grid with full -sized dimensions, and then specify the \nfracture characteristics, namely the fracture spacing and aperture. Then the volu me \nfraction of high permeability material (the fractures) is equal to the fracture aperture \ndivided by the fracture spacing.  In REMChlor -MD and in the MODFLOW -USG MDT \npackage, t his is the VOLFRACMD variable .  In the MODFLOW 6 MDT package, a \ndifferent conv ention is used, and the volume fraction of the low permeability is specified \nas the MD_FRACTION variable, where MD_FRACTION = 1 \u2013 VOLFRACMD . The \ncharacteristic diffusion length used in the MDT package, MD_DIFF_LENGTH  is equal to \none-half of the fracture s pacing.  \nThis example of using the equivalent porous media approach is based on a test problem \nfrom Muskus and Falta2 involving a system of parallel fractures with a fracture spacing of \n0.5 m and fracture apertures of 100 \u00b5m.  \nWith an equivalent porous media  approach, the hydraulic conductivity value reflects the \nvalue averaged over the entire rock mass. Following the example in Muskus and Falta3, \nthe pore velocity in the fractures is 100 m/yr. The volume fraction of the fractures is \n0.0001m/0.5m = 0.0002. Th en the bulk Darcy velocity is 0.02 m/yr. With our previous \n\nGMS Tutorials   MODFLOW 6 \u2013 MDT Equivalent Porous  \n Page 4 of 6 \u00a9 Aquaveo 2024  hydraulic gradient of 1/60, this Darcy velocity is achieved with a hydraulic conductivity \n(HK) of 1.2 m/yr.  \nAdditional parameters used in this example are given in Table 1.  \nTable 1.  Parameters use d in the fractured rock matrix diffusion comparison.  \nParameter  Fracture  Matrix  \nFracture aperture, \u03bcm  100  \nPorosity , \u03d5 1.0 0.1 \nTortuosity , \u03c4 1.0 0.1 \nRetardation factor, R 1.0 2.0 \nPore  velocity , (m/yr)  100 0 \nDiffusion coefficient, D (m2/s) 1.0E-9                           1.0E-9                           \ndecay rate (1/yr)  0.0  0.0  \nLoading period, t1, (years)  50  \nBefore continuing, save the project with a new name.  \n8. Select File | Save As\u2026  to bring up the Save As  dialog.  \n9. Browse to the Tutorials \\MODFLOW 6 \\mf6_mdt_ equivalent_porous  directory.  \n10. Enter \u201cequivalent_porous.gpr\u201d as the File name . \n11. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n12. Click Save  to save the project file and close the Save As  dialog.  \n3 Adding the MDT Packag e \nThe MODFLOW 6 simulation has been setup without the MDT package. Both a \ngroundwater flow model and a groundwater transport model have been added. The MDT \npackage can be added by doing the following:  \n1. Right -click on \u201c  trans\u201d and select New Package  | MDT  to add the package.  \nNotice the  \u201c MDT\u201d package is now shown in the Project Explorer under the \ngroundwater transport model . Make certain the package is not locked before continuing.  \n2. In the Project Explorer, right -click on \u201c  model_mdt_parallel\u201d and select Unlock \nAll.  \n4 Defining the MDT Package  \nThe MDT package can be defined during the process of setting up the GWT model or \nafter the GWT model has been created as in this case. To define the MDT package, do \nthe following:  \n1. Double -click on the \u201c  MDT\u201d package to  bring up the Matrix Diffusion Transport \n(MDT) Package  dialog.  \n2. On the MD_TYPE_FLAG  tab, set the Constant  value to \u201c2 \u201d. This variable is a flag \nthat tells the MDT package how mat rix diffusion will be handled. Choosing a \nvalue of 2 tells the package to allow  matrix diffusion into embedded matrix blocks \nwith a finite diffusion length. This example uses this option because it is using an \nequivalent porous media approach.  \n\nGMS Tutorials   MODFLOW 6 \u2013 MDT Equivalent Porous  \n Page 5 of 6 \u00a9 Aquaveo 2024  3. On the MD_FRACTION  tab, set the Constant  value to \u201c0.9998 \u201d. This is the \nvolume fraction of the low permeability material.   \nNote : that this definition is different from the VOLFRACMD  variable that is used \nin REMChlor -MD and the MODFLOW USG MDT package. MD_FRACTION = 1 \u2013 \nVOLFRACMD . \n4. On the MD_POROSITY  tab, set the Constant  value to \u201c0.1 \u201d. This is the porosity \nof the unfractured rock.  \n5. On the BULK_DENSITY  tab, set the Constant  value to \u201c2.0 \u201d. This is the dry bulk \ndensity of the unfractured rock . \n6. On the MD_DIFF_LENGTH  tab, set the Constant  value to \u201c0.25 \u201d. This is the \ncharacteristic diffusion  length, which is one -half of the fracture spacing.  \n7. On the MD_TORTUOSITY  tab, set the Constant  value to \u201c0.1 \u201d. \n8. On the MD_DIST_COEFF  tab, set the Constant  value to \u201c0.05 \u201d. This is the \nrock/water distribution coefficient for the chemical. This value, combine d with the \nbulk density of 2.0 and porosity of 0.1 gives a retardation factor of 2.  \n9. On the MD_DECAY  tab, set the Constant  value to \u201c0.0 \u201d. The solute is not \nundergoing decay.  \n10. On the MD_DIFF_COEFF  tab, set the Constant  value to \u201c0.03159 \u201d. This is the \nmolecul ar diffusion coefficient, m2/yr. \n11. Click OK to close the Matrix Diffusion Transport (MDT) Package  dialog .  \nThe MDT Package is now set up for the parallel fracture system  and ready for the \nsimulation run.  \n5 Saving and Running the Simulation  \nSave and run the simulation by doing the following:  \n1. Right -click on \u201c  model_mdt_parallel\u201d and select Save Project, Simulation and \nRun to start the Simulation Run Queue . \n2. If it appears, click OK on the Info dialog to unload the previous solution.  \n3. Click Load Solution  to import the solution files.  \n4. Click Close  to exit the Simulation Run Queue . \n6 Examining the Solution  \nNow examine the results of the MDT package being included in the transport model.  \n1. Switch to the UGrid   module.  \n2. In the Project Explorer, select the \u201c   Concentr ation\u201d dataset in the \u201c  trans\u201d \nfolder under the \u201c  model_mdt_parallel (MODFLOW 6)\u201d folder.  \n3. Using the Select Cells   tool, select cell 2 (the second cell on the left).  \n4. Click the Plot Wizard   macro to open the Plot Wizard  dialog.  \n5. Under Plot Type , select \u201cA ctive Dataset Time Series\u201d.  \n6. Click Finish  to close the Plot Wizard  and generate the plot.  \n\nGMS Tutorials   MODFLOW 6 \u2013 MDT Equivalent Porous  \n Page 6 of 6 \u00a9 Aquaveo 2024   The generated plot should appear similar to Figure 2. \n \nFigure 2     The active dataset time series plot  \n7 Conclusion  \nThis concludes the \u201cMODFLOW 6 \u2013 MDT Equivalent Porous\u201d tutorial. The following \ntopics were discussed and  demonstrated:  \n\uf0b7 The MODFLOW 6 MDT package can be used to simulate matrix diffusion from \nmultiple fractures in fractured porous materials.  \n\uf0b7 The MDT package allows for an equivalent porous media approach to be used \nfor fractured systems where normal grid eleme nts are used with embedded \nmatrix diffusion occurring over a finite distance in the matrix material in each \nelement.  \n \n\n", "filename": "MODFLOW6_MDT_EquivalentPorous.pdf", "pages": 6}, "MODFLOW6_MDT_Sand_Tank": {"text": "GMS Tutorials   MODFLOW  6 \u2013 MDT Sand Tank  \n Page 1 of 9 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW  6 \u2013 MDT Sand Tank  \nUse the Matrix Diffusion Transport package (MDT) in GMS to simulate \nmatrix diffusion in a heterogeneous sand/clay system using a semi -\nanalytic approximation  \nObjectives   \nLearn how to use the Matrix Diffusion Transport package (MDT) with MODFLOW 6 to simulate matrix \ndiffusion in a heterogeneous sand/clay system .  \n \nPrerequisite Tutorials  \n\uf0b7 Getting Started  \n\uf0b7 MODFLOW 6 \u2013 Conceptual \nModel Approach  \n\uf0b7 MODFLOW 6 \u2013 Grid \nTransport  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW -USG Model &  \nInterface  \n Time  \n\uf0b7 20\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW  6 \u2013 MDT Sand Tank  \n Page 2 of 9 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Opening a MODFLOW 6 Simulation  ................................ ................................ ...................  4 \n3 Adding a New GWT Model  ................................ ................................ ................................ .. 5 \n3.1 The TDIS Package  ................................ ................................ ................................ ....... 5 \n3.2 The ADV Package  ................................ ................................ ................................ ........  5 \n3.3 The CN C Package  ................................ ................................ ................................ ........  5 \n3.4 The DSP Package  ................................ ................................ ................................ ........  6 \n3.5 The IC Package  ................................ ................................ ................................ ............  6 \n3.6 The MST Package  ................................ ................................ ................................ ........  6 \n3.7 The SSM Package  ................................ ................................ ................................ ........  7 \n4 The MDT Package  ................................ ................................ ................................ ................  7 \n5 Output Control  ................................ ................................ ................................ .....................  7 \n6 Adding a S econd IMS Package  ................................ ................................ ..........................  7 \n7 Adding a GWF -GWT Exchange  ................................ ................................ ..........................  8 \n8 Saving and Running the Simulation  ................................ ................................ ..................  8 \n9 Examining the Solution  ................................ ................................ ................................ ....... 8 \n10 Conclusion  ................................ ................................ ................................ ...........................  9 \n \n1 Introduction  \nThe Matrix Diffusion Transport package (MDT) works with MODFLOW 6. The MDT \npackage allows existing flow and chemic al transport models  to be upgraded to include a \nfull accounting of matrix diffusion effects.  The MDT package is based on the semi -\nanalytic mat rix diffusion method implemented in the REMChlor -MD model1, 2, 3. The \ndevelopment of this simulation capability has been supported by the Department of \nDefense Environmental Security Technology Certification Program (ESTCP) and it \nrepresents a collaborativ e effort between Clemson University, GSI Environmental, and \nAquaveo.  \nThe MDT matrix diffusion method is conceptually similar to dual porosity methods, where \nthe volume of each element is divided into \u201cmobile\u201d and \u201cimmobile\u201d fractions. Solute \ntransport occu rs by advection, and dispersion in the mobile fraction, but only by diffusion \nin the immobile fraction. With the MDT package, the concentration profile in the immobile \nfraction is approximated using a dynamic function that expresses the concentration as a \nfunction of distance from the mobile/immobile interface. This function is recomputed at \neach time step in each element using the current and previous concentrations in the \nmobile fraction, along with the integral of the concentration profile in the immobil e \nfraction. The mass transfer to or from the mobile/immobile fractions is then computed as \na linear concentration -dependent source term.  \nThis tutorial demonstrates how the MDT package can be used with a MODFLOW 6 \nsimulation to simulate diffusion in a heter ogeneous porous media system where the \nheterogeneity occurs at the sub -gridblock scale. This example is based on a \nbenchmarking problem that was developed with REMChlor -MD. For a more detailed \n                                                      \n1 Farhat, S.K., C.J. Newell, R.W. Falta, and K. Lynch, 2018. REMChlor -MD User\u2019s Manual, \ndeveloped for the Environmental Security Technology Certification Program (ESTCP) by Clemson \nUniversity, Clemson, SC and GSI Environmental Inc., Houston, TX, https://www.serdp -\nestcp.org/Program -Areas/Environmental -Restoration/Contaminated -Groundwater/Persistent -\nContamination/ER -201426  \n2 Falta, R.W., and W. Wang, 2017, A semi -analytical method for simulating matrix diffusion in \nnumerical transport models, J ournal of Contaminant Hydrology, V. 197, p. 39 -49. \n3 Muskus, N., and R.W. Falta, 2018, Semi -analytical method for matrix diffusion in heterogeneous \nand fractured systems with parent -daughter react ions, Journal of Contaminant Hydrology , V. 218, \np. 94 -109. \nGMS Tutorials   MODFLOW 6 \u2013 MDT Sand Tank  \n \n Page 3 of 9 \u00a9 Aquaveo 2024  description of the semi -analytic method used in the MDT package , please refer to the \nREMChlor -MD user\u2019s guide1 and related journal papers2, 3. The input variables used in \nthe MDT package are described in the MDT Process for MODFLOW -USG Transport \nUser\u2019s Guide4. \nFor this example, a simulation of the Doner5 (2008) labora tory matrix diffusion experiment \nis performed. The experiment was conducted in a 1.07 x 0.03 x 0.84m tank filled with \nsand and four embedded clay lenses. A tracer solution consisting of 400 mg/L of \nfluorescein was injected into the sand box for 22 days, fo llowed by clean water for 100 \ndays. Diffusion of the fluorescein into the clay lenses resulted in extensive back diffusion \nduring the clean water flushing period. Chapman6 et al. (2012) simulated this experiment \nusing high resolution 2 -D numerical models w ith 9,000 to 24,000 elements.  \nUsing the semi -analytic matrix diffusion method in MDT, the laboratory experiment is \nsimulated using a one -dimensional grid (UGrid) with only 50 elements. With this \napproach, the flow and transport in the sand is simulated wi th localized matrix diffusion \ninto and out of the clay lenses using the semi -analytic method. The clay lenses are not \nspecifically discretized; rather they are represented in the model in an average sense, \nusing the volume fraction (VOLFRACMD) of sand, and  the characteristic diffusion length \nin the clay (DIFFLENMD).  This example is based on a test problem presented by \nMuskus and Falta3. Additional model parameters are given in Table 1.  \nTable 1.  Input parameters used to simulate Doner5 (2008) experiment.  \nParameter  Value  \nDarcy velocity, vx (m/yr)  31.29  \nSand porosity, \u03d5 0.45 \nMatrix porosity, \u03d5l 0.6 \nSand retardation (fl), R 1.39 \nMatrix retardation, Rl 1 \nMatrix tortuosity, \u03c4l 0.3 \nDiffusion coefficient (fl), D (m2/yr) 1.73E -02 \nSource concentration (fl ), C0 (mg/L)  400 \n\u0394x (m) 0.0214  \n\u0394y (m) 0.03 \n\u0394z (m) 0.84 \nSand volume fraction, Vf 0.711  \nCharacteristic diffusion length, L (m) 0.0405  \nNumber of elements ( x-dir) 50 \n\u0394t (d) 0.5 \nNumber of time steps  244 \n \nThis tutorial will demonstrate the following topics:  \n                                                      \n4Panday, S., R.W. Falta, S. Farhat, K. Pham, and A. Lemon, 2021, Matrix Diffusion Transport \n(MDT) Process for MODFLOW -USG Transport, https://www.gsienv.com/product/modflow -usg/ \n5Doner, L.A., 2008, Tools to Resolve Water Quality Benefits of Upgradient Contaminant Flux \nReduction, MS thesis, Colorado State University, Fort Collins, CO.  \n6Chapman, S.W., B.L. Parker, T.C. Sale, and L.A. Doner, 20 12, Testing high resolution numerical \nmodels for analysis of contaminant storage and release from low permeability zones, Journal of \nContaminant Hydrology, 136 -137, 106 -116. \nGMS Tutorials   MODFLOW 6 \u2013 MDT Sand Tank  \n Page 4 of 9 \u00a9 Aquaveo 2024  1. Opening an existing MODFLOW 6 simulation.  \n2. Activating the MDT package.  \n3. Running the simulation and examining the results.  \n2 Opening a MODFLOW 6 Simulation  \nStart with opening a MODFLOW 6 model:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select  the File | New command to ensure that the \nprogram settings are restored to their default state.  \nStart with a previously created project.  \n4. Click Open   to bring up the Open  dialog.  \n5. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n6. Browse to the mf6_mdt_sank_tank  folder and select \u201cstart .gpr\u201d. \n7. Click Open to import the project and exit the Open  dialog.  \nThe project should be visible in the Graphics Window ( Figure  1). The project contains a \nMODFLOW 6 simulation that has observation data.  \n \nFigure  1     Initial project for the MODFLOW 6 model  \nThis model has a single layer UGrid. Specified heads (CHD) have been set at each end. \nA total of 50 elements are used in this 1D grid. The elements have dimensions of 0.0214 \nm in the direction of flow (x -direction), 0.03 m perpendicular to the flow (y -direction) and \n0.84 m vertically (z -direction).  \nThe hydraulic head in the left -most elemen t is maintained at a constant head of 1.3281 m \nusing the CHD package, while the right -most element is maintained at a head of 1 m. The \nhorizontal hydraulic conductivity was set to a value of 100 m/yr, resulting in a Darcy \nvelocity of 31.29 m/yr.  \n\nGMS Tutorials   MODFLOW 6 \u2013 MDT Sand Tank  \n \n Page 5 of 9 \u00a9 Aquaveo 2024  Before co ntinuing, save the project with a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Browse to the Tutorials \\MODFLOW 6 \\mf6_mdt_sand_tank  directory.  \n3. Enter \u201csand_tank.gpr\u201d as the File name . \n4. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n5. Click Save  to save the project file and close the Save As  dialog.  \n3 Adding a New GWT Model  \nWith the MODFLOW 6 open, a groundwater transport (GWT) model is necessary to use \nthe MDT package. The GWT model can be added by doing the following:  \n1. Switch  to the UGrid  module.  \n2. Right -click on \u201c  sand_tank\u201d and select New Package  | GWT  to bring up the \nNew Groundwater Transport (GWT) Model  dialog.  \n3. In the Select UGrid  section, turn on the \u201cUGrid\u201d grid.  \n4. In the GWT \u2013 Groundwater Transport Model  section, turn on  the following \npackages: ADV, CNC, DSP, MDT, and SSM . \n5. Click OK to close the New Groundwater Transport (GWT) Model  dialog.   \nNotice the  \u201c  trans\u201d model is now shown in the Project Explorer along with the selected \npackages .  \n6. In the Project Explorer, right -click on \u201c  sand_tank\u201d and select Unlock All .  \n3.1 The TDIS Package  \nThe TDIS package defines the temporal discretization for the groundwater transport \nmodel. The package has already been defined for this example.  \n3.2 The ADV Package  \nReview the ADV package before continuing.  \n1. Double -click on the \u201c  ADV\u201d package to bring up the Advection (ADV) Package  \ndialog.  \n2. Check that the SCHEME  option is turned on.  \n3. Click OK to close the Advection (ADV) Package  dialog.  \n3.3 The CNC Package  \nDefine the constant concentration by doing the following.  \n1. Double -click on the \u201c  CNC\u201d package to bring up the Constant Concentration \n(CNC) Package  dialog.  \n2. Click the Add Rows   button to bring up the Add Stresses  dialog.  \n\nGMS Tutorials   MODFLOW 6 \u2013 MDT Sand Tank  \n Page 6 of 9 \u00a9 Aquaveo 2024  3. Accept the default settings (adding 1 row to all defined periods) and click OK to \nclose the Add Stresses  dialog.  \n4. In row 1, enter the following:  \n\uf0b7 LAY set to \u201c1\u201d  \n\uf0b7 CELL2D  set to  \u201c1\u201d  \n\uf0b7 CONC  set to \u201c400.0\u201d  \n5. Change the Period  to \u201c2\u201d.  \n6. Click Define Period   to bring up the Define Period  dialog.  \n7. Make certain Copy from previous period  is selected and click OK to close the \nDefine Period  dialog.  \n8. Change the CONC  column to be \u201c0.0\u201d.  \n9. Click OK to close the Constant Concentration (CNC) Package  dialog.  \n3.4 The DSP Package  \nDefine the dispersion by doing the following:  \n1. Double -click on the \u201c  DSP\u201d package to bring up the Dispersion (DSP) Package  \ndialog.  \n2. On the DIFFC  tab, turn on the Define  option and set the Constant  value to \n\u201c0.03844444\u201d . \n3. Under Sections , turn on OPTIONS . \n4. Turn on the XT3D_O FF option.  \n5. Click OK to close the Dispersion (DSP) Package  dialog.  \n3.5 The IC Package  \nThe IC Package default settings are sufficient for this example. No changes are needed, \nthough the settings may be reviewed if desired.  \n3.6 The MST Package  \nDefine the mobile storage and transfer by doing the following:  \n1. Double -click on the \u201c  MST\u201d package to bring up the Mobile Storage and \nTransfer (MST) Package  dialog.  \n2. On the POROSITY  tab, set the Constant  value to \u201c 0.45\u201d. \n3. On the BULK_DENSITY  tab, turn on the Define  option and set the Constant  \nvalue to \u201c1 .6\u201d. \n4. On the DISTCOEF  tab, turn on the Define  option and set the Constant  value to \n\u201c0.109693 \u201d. \n5. Under Sections , turn on OPTIONS . \n6. Turn on the SORPTION  option.  \n7. Click OK to close the Mobile Storage and Transfer (MST) Package  dialog.  \n\nGMS Tutorials   MODFLOW 6 \u2013 MDT Sand Tank  \n \n Page 7 of 9 \u00a9 Aquaveo 2024  3.7 The SSM Package  \nDefine the source mixing for this exam ple by doing the following:  \n1. Double -click on the \u201c  SSM\u201d package to bring up the Source and Sink Mixing \n(SSM) Package  dialog.  \n2. Under Sections , turn on OPTIONS . \n3. Turn on the SAVE_FLOWS option.  \n4. Click OK to close the Source and Sink Mixing (SSM) Package  dialog.  \n4 The MDT Package  \nThe MDT package can be defined during the process of setting up the GWT model.  \n1. Double -click on the \u201c  MDT\u201d package to bring up the Matrix Diffusion Transport \n(MDT) Package  dialog.  \n2. On the MD_TYPE_FLAG  tab, set the Constant  value to \u201c2 \u201d. \n3. On the MD_FRACTION  tab, set the Constant  value to \u201c0.289 \u201d. \n4. On the MD_POROSITY  tab, set the Constant  value to \u201c0.6 \u201d. \n5. On the BULK_DENSITY  tab, set the Constant  value to \u201c1.6 \u201d. \n6. On the MD_DIFF_LENGTH  tab, set the Constant  value to \u201c 0.04052 \u201d. \n7. On the MD_TORTUOSITY  tab, set the Constant  value to \u201c0.3 \u201d. \n8. On the MD_DIST_COEFF  tab, set the Constant  value to \u201c 9.33e -09\u201d. \n9. On the MD_DIFF_COEFF  tab, set the Constant  value to \u201c0.0173 \u201d. \n10. Under Sections , turn on OPTIONS.  \n11. Turn on the SORPTION  option.  \n12. Click OK to close the Matrix Diffusion Transport (MDT) Package  dialog .  \nThe MDT Package is now set and ready for the simulation run.  \n5 Output Control  \nBefore running the MODFLOW 6 simulation, set the output option for the GWT model.  \n1. Under the \u201c   trans\u201d model, double -click on the \u201c  OC\u201d package to bring up the \nOutput Control (OC) Dialog . \n2. Change the Preset output  to be \u201cAt every time step\u201d.  \n3. Click OK to close the Output Control (OC) Dialog . \n6 Adding a Second IMS Package  \nA second iterative model solution package will be used in this example.  \n1. Right-click on \u201c  sand_tank\u201d and select New Package  | IMS. \n2. Double -click on the \u201c  IMS (2)\u201d package to bring up the Iterative Model Solution \n(IMS)  dialog.  \n\nGMS Tutorials   MODFLOW 6 \u2013 MDT Sand Tank  \n Page 8 of 9 \u00a9 Aquaveo 2024  3. Under Sections , turn on OPTIONS . \n4. Turn on the COMPLEXITY  option and change to be \u201cCOMPLEX\u201d.  \n5. Click OK to close the Iterative Model Solution (IMS)  dialog.  \n7 Adding a GWF -GWT Exchange  \nA GWF -GWT exchange creates a relationship where the GWF Model provides the flow \ndata that informs the GWT Model.  To create this exchange, do the following:  \n1. Right -click on \u201c  sand_tank\u201d and select New Package  | GWF -GWT . \n2. Double -click on \u201c  sand_tank\u201d to open the Simulation Options  dialog.  \n3. Under Sections , turn on EXCHANGES.  \n4. In the EXCHANGES table, click the blank cell under the EXGMNAMEA column \nto bring up the Select Model  dialog.  \n5. Select the \u201cflow_model\u201d model and click OK to close the Select Model  dialog.  \n6. Click the blank cell under the EXGMNAME B column to bring up the Select Model  \ndialog.  \n7. Select the \u201ctrans\u201d model and click OK to close the Select Model  dialog.  \n8. Under Sections , turn o n SOLUTIONGROUPS.  \n9. In the SOLUTIONGROUPS  table, click the blank cell on the second row under \nthe SLNMNAMES  column to open the Select Model(s)  dialog.  \n10. Select the \u201ctrans\u201d model and click OK to close the Select Model(s)  dialog.  \n11. Click OK to close the Simulation  Options  dialog.  \n8 Saving and Running the Simulation  \nNow save and run the simulation:  \n1. Right -click on \u201c  sand_tank\u201d and select Save Project, Simulation and Run  to \nstart the Simulation Run Queue . \n2. If it appears, click OK on the Info dialog to unload the previou s solution.  \n3. Click Load Solution  to import the solution files.  \n4. Click Close  to exit the Simulation Run Queue . \n9 Examining the Solution  \nNow examine the results of the MDT package being included in the transport model.  \n1. Switch to the UGrid   module.  \n2. In the Project Explorer, select the \u201c   Concentration\u201d dataset in the \u201c  trans\u201d \nfolder under the \u201c  sand_tank (MODFLOW 6)\u201d folder.  \n3. Using the Select Cells   tool, select cell 50 (the last cell on the right).  \n4. Click the Plot Wizard   macro to open the Plot Wizard  dialog.  \n5. Under Plot Type , select \u201cActive Dataset Time Series\u201d.  \n\nGMS Tutorials   MODFLOW 6 \u2013 MDT Sand Tank  \n \n Page 9 of 9 \u00a9 Aquaveo 2024  6. Click Finish  to close the Plot Wizard  and generate the plot.  \nThe generated plot should appear similar to Figure 2. \n \nFigure 2     The active dataset time series plot  \n10 Conclusion  \nThis concludes the \u201cMODFLOW 6 \u2013 MDT Sand Tank\u201d tutorial. The following topics were \ndiscussed and demonstrated:  \n\uf0b7 Creating a MODFLOW 6 transport model.  \n\uf0b7 Adding the M DT Package to MODFLOW 6.  \n\uf0b7 Running MODFLOW 6.  \n\uf0b7 Reviewing the MODFLOW 6 solution.  \n\n", "filename": "MODFLOW6_MDT_Sand_Tank.pdf", "pages": 9}, "MODFLOW6_PEST_Obs_SS": {"text": "GMS Tutorials   MODFLOW  6 \u2013 PEST Observations  \n Page 1 of 8 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW  6 \u2013 PEST Observations, Steady State  \nUse PEST Observations with a Steady State MODFLOW 6 Simulation  \n \nObjectives   \nLearn how to use PEST observations with a steady -state MODFLOW 6 simulations .  \n \nPrerequisite Tutorials  \n\uf0b7 Getting Started  \n\uf0b7 MODFLOW 6 \u2013 Grid \nApproach  \n\uf0b7 MODFLOW 6 \u2013 Conceptual \nModel Approach  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW -USG Model &  \nInterface  \n Time  \n\uf0b7 15\u201325 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODFLOW  6 \u2013 PEST Observations  \n Page 2 of 8 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Converting a MODFLOW -USG Simulation  ................................ ................................ .........  2 \n2.1 Opening the Existing MODFLOW -USG Model  ................................ .............................  3 \n2.2 Save MODFLOW 6 Copy  ................................ ................................ .............................  3 \n3 Importing the MODFLOW 6 Simulation  ................................ ................................ ..............  4 \n4 Fixing CHD Package Errors  ................................ ................................ ................................  5 \n5 Creating the PEST Observations Package  ................................ ................................ ........  5 \n6 Map from Coverage  ................................ ................................ ................................ .............  6 \n7 Regenerating the PEST Observation Files  ................................ ................................ ........  6 \n8 Saving and Running the Simulation  ................................ ................................ ..................  7 \n9 Examining the Solution  ................................ ................................ ................................ ....... 7 \n9.1 Statistics  ................................ ................................ ................................ .......................  7 \n9.2 Solution Coverages and Whisker Plots  ................................ ................................ .........  7 \n9.3 Observation Plots  ................................ ................................ ................................ .........  8 \n10 Conclusion  ................................ ................................ ................................ ...........................  8 \n \n1 Introduction  \nMODFLOW 6 includes an observation utility (OBS) which is used to output the computed \nhead, drawdown, and/or flow at spe cific cells at all output times . \nGMS includes additional observation features beyond what comes with MODFLOW 6, \nincluding observations at arbitrary locations and times, comparison of observed and \ncomputed values, whisker plots, and other plots. This functionality is done with the help of \nutility programs that come with PEST, and is very similar to the observation functionality \nGMS provides for MODFLOW -USG. GMS prepares the input files needed by the PEST \nutilities to determine the computed values from the model solution. For more informatio n \nabout using PEST with MODFLOW -USG, refer to the \u201cMODFLOW -USG \u2013 Calibration\u201d \ntutorial.  \nPEST can be used for observations and calibration. This tutorial only covers \nobservations. This tutorial will  convert an existing MODFLOW -USG simulation that uses \nPEST observations to a MODFLOW 6 simulation with PEST observations.  \nThis tutorial discusses and demonstrates : \n\uf0b7 Converting a MODFLOW -USG simulation that uses PEST to a MODFLOW 6 \nsimulation.  \n\uf0b7 Importing MODFLOW 6 files.  \n\uf0b7 Defining the PEST observation package.  \n\uf0b7 Regenerating the PEST observation files.  \n\uf0b7 Saving and running the MODFLOW 6 simulation.  \n\uf0b7 Reviewing the solution.  \n2 Converting a MODFLOW -USG Simulation  \nStart with opening a MODFLOW -USG model:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select the File |  New command to ensure that the \nprogram settings are restored to their default state.  \nGMS Tutorials   MODFLOW 6 \u2013 PEST Observations  \n \n Page 3 of 8 \u00a9 Aquaveo 2024  2.1 Opening the Existing MODFLOW -USG Model  \nStart with a previously created project.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of  type drop-down.  \n3. Browse to the mf6_pest_obs_ss  folder and select \u201cstart .gpr\u201d. \n4. Click Open to import the project and exit the Open  dialog.  \nThe project should be visible in the Graphics Window ( Figure  1). The project contains a \nMODFLOW -USG simulation that has observation data.  \n \nFigure  1     Initial project for the MODFLOW -USG model  \n2.2 Save MODFLOW 6 Copy  \nNow create a MODFLOW 6 simulation from the MODFLOW -USG simulation:  \n1. Select  MODFLOW  | Global Options\u2026  to open the MODFLOW Global/Basic \nPackage  dialog . \n2. Turn on the Save MODFLOW 6 copy  option.  \n3. Click OK to close the MODFLOW Global/Basic Package  dialog.  \n4. Select File | Save As\u2026  to open the Save As  dialog.  \n5. For the File Name , enter \u201cpest_obs_ss\u201d.  \n6. Click Save  to close the Save As  dialog and save the new files.  \n\nGMS Tutorials   MODFLOW 6 \u2013 PEST Observations  \n Page 4 of 8 \u00a9 Aquaveo 2024  GMS just sav ed the MODFLOW -USG simulation files and then r an a conversion program \non the files to create a MODFLOW 6 simulation.  \n3 Importing the MODFLOW 6 Simulation  \nWith the MODFLOW 6 files created, they can now be imported back into GMS:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cAll Files (*.*)\u201d from the Files of type  drop-down.  \n3. Browse to the mf6_pest_obs_ss/pest_obs_ss_MODFLOW_quadtree_mf6 folder \nand select \u201cmfsim.nam\u201d.  \n4. Click Open to import the project and exit the Open  dialog.  \n5. Turn off and collapse the \u201c  quadtree\u201d item in the Project Explorer.  \nThe project should be visible in the Graphics Window ( Figure  2). The MODFLOW 6 \nsimulation will be visible in the Project Explorer.  \n6. Right -click on \u201c  pest_obs_ss\u201d and select Save Project, Simulation and Run  \nto start the Simulation Run Queue .  \nNotice the er ror in the CHD package \u201cCell is already a constant head ((1,32))\u201d. \nConverting a MODFLOW -USG model to MODFLOW 6 is often an imperfect process. In \nthis case, MODFLOW 6 does not allow multiple CHD boundary conditions in the same \ncell whereas in MODFLOW -USG th is was allowed  \n7. Click Remove  to remove the  model run.  \n8. Click Close  to exit the Simulation Run Queue . \n \nFigure  2     MODFLOW 6 model  \n\nGMS Tutorials   MODFLOW 6 \u2013 PEST Observations  \n \n Page 5 of 8 \u00a9 Aquaveo 2024  4 Fixing CHD Package Errors  \nThe CHD error can be fixed by recreating the CHD boundary conditions by mapping from \nthe conceptual model. To do this:  \n1. In the Project Explorer under \u201c   pest_obs_ss\u201d and \u201c   GWF_Model\u201d, right -\nclick on the \u201c  CHD\u201d package and select Map from coverage  to open a Select \nCoverage  dialog.  \n2. Select the \u201c  Sources &  Sinks\u201d coverage and check that the Replace all \npackage data  option has been turned on.  \n3. Click OK to close the Select Coverage  dialog and open the Map from Coverage  \ndialog.  \n4. When it has finished running, click OK to close the Map from Coverage  dialog.  \n5. Right -click on \u201c  pest_obs_ss\u201d and select Save Project, Simulation and Run  \nto start the Simulation Run Queue . \nThis time there are no errors.  \n6. Click Load Solution  to import the solution files.  \n7. Click Close  to exit the Simulation Run Queue . \n8. Turn the \u201c  quadtree\u201d UGr id off and on.  \nNotice the old and new solutions (based on the contours) are virtually identical.  \n9. Turn off the \u201c  quadtree\u201d UGrid.  \n10. Save   the project.  \nThe CHD error has now been resolved.  \n5 Creating the PEST Observations Package  \nThe observation data from the MODFLOW -USG model was not preserved when the \nmodel was converted to a MODFLOW 6 simulation . To add the observation data to the \nMODFLOW  6 model, complete the following:  \n1. Right -click \u201c  GWF_Model \u201d and select the  New Package  | PEST Observations  \ncommand . \nThis a dds a new component in the Project Explorer. It is not a MODFLOW 6 package, but \na GMS component that uses PEST with MODFLOW 6 to determine computed values . \n2. Double -click on the \u201c PEST Observations \u201d package item  to open the \nMODFLOW 6 PEST Observations  dialog . \nThis dialog is somewhat similar to the MODFLOW -USG Observations  dialog. Here the \nPEST input files are created for  the MODFLOW 6 simulation . \n3. Click the Generate PEST Observation Data  button  to open the Generate \nObservations  dialog.  \n4. For the Head observation  coverages , turn on \u201cObservation Wells\u201d.  \n5. For the Flow observation coverages , turn on \u201cSources & Sinks\u201d.  \n6. Click OK to close the Generate Observations  dialog.  \n7. Click OK to close the error message that appears.  \n\nGMS Tutorials   MODFLOW 6 \u2013 PEST Observations  \n Page 6 of 8 \u00a9 Aquaveo 2024  8. In the Errors  tab of the MODFLOW 6 PEST Observations  dialog, review the \nerrors.  \nThe important thing to note is that GMS says: \u201cYou may need to execute \u201cMap from \nCoverage\u201d.\u201d The error is associated with an arc group. The arc group consists of multiple \narcs representing the river system in the \u201c  Sources & Sinks\u201d coverage. Because the \nMODFLOW 6 model was created from a MODFLOW -USG model and then imported, \nGMS does not recognize the connection between the feature objects in the coverages \nand the model boundary conditions. Using the Map from Coverage  command will \nassociate the RIV package boundary conditions with the arc group.  \n9. Click OK to exit the MODFLOW 6 PEST Observations  dialog.  \n6 Map from Coverage  \nThe RIV package needs to be associated with the arc group on the \u201c  Sources & Sinks\u201d \ncoverage. To do this: \n1. In the Project Explorer, right -click on the \u201c  RIV\u201d package and select Map from \nCoverage  to open a Select Coverage  dialog.  \n2. Select the \u201c  Sources & Sinks\u201d coverage and check that the Replace all \npackage data  option has been turned on.  \n3. Click OK to clos e the Select Coverage  dialog and open the Map from Coverage  \ndialog.  \n4. When it has finished running, click OK to close the Map from Coverage  dialog.  \n7 Regenerating the PEST Observation Files  \nNow generate the PEST observation files by doing the following:  \n1. Save   the project  \n2. Double -click on the \u201c PEST Observation s\u201d package item to open the \nMODFLOW 6 PEST Observations  dialog . \n3. Click the Generate PEST Observation Data  button  to open the Generate \nObservations  dialog.  \n4. For the Head observation coverages , turn on \u201cObservation Wells\u201d.  \n5. For the Flow observation coverages , turn on \u201cSources & Sinks\u201d.  \n6. Click OK to close the Generate Observations  dialog . \nTake a moment to click on the different files in the list of files on the left and examine \nwhat they are and the file co ntents. These are the files that PEST uses to calculate the \nobserved values. The files can be edited but it is almost never necessary to do so.  \nThe \u201cmodel.bsamp\u201d file lists all the head observations. There are ten locations where we \nhave observed values.  \nThe \u201cmodel.fsamp\u201d file lists all the flow observations. There is one flow observation and it \nis on the arc group which is used to model the river system . \n7. When done, click OK to exit the MODFLOW 6 PEST Observations  dialog . \n\nGMS Tutorials   MODFLOW 6 \u2013 PEST Observations  \n \n Page 7 of 8 \u00a9 Aquaveo 2024  8 Saving and Running the Simulation  \nNow save and run the simulation again:  \n1. Right -click on \u201c  pest_obs_ss\u201d and select Save Project, Simulation and Run  \nto start the Simulation Run Queue . \n2. If it appears, click OK on the Info dialog to unload the previous solution.  \n3. Click Load Solution  to import the solution files.  \n4. Click Close  to exit the Simulation Run Queue . \nSeveral things just happened:  \n\uf0b7 When the simulation was saved, GMS saved the PEST input files with the \nsimulation along with some batch files used to run PEST.  \n\uf0b7 When the simulation was run, MOD FLOW calculated the head and flow \nsolutions.  \n\uf0b7 When the solution was read, GMS ran some PEST utilities using the input files \nand batch files. PEST used the model solution to determine the computed values \nat the observation points. GMS read the PEST output an d added the data to the \nsolution as it was imported.  \n9 Examining the Solution  \nNow examine the results of the PEST observations using statistics tools, whisker plots, \nand observation plots.  \n9.1 Statistics  \nNotice that in addition to the Head dataset, there are som e PEST related items including \nlinks to three coverages and a \u201cpest_obs_stats.txt\u201d file.  \n1. In the Project Explorer  under \u201c  GWF_Model\u201d, double -click the \u201c  \npest_obs_stats.txt\u201d file to open the file in a text editor.  \nThis file contains observation statistics similar to the statistics that can be found by right -\nclicking on a MODFLOW -USG solution. In fact, let\u2019s compare them.  \n2. Under \u201c  quadtree\u201d, right -click on the \u201c  start (MODFLOW)\u201d solution folder and \nselect Properties  to open the Properties  dialog.  \nCompare th e values to those in the \u201c  pest_obs_stats.txt\u201d file. They should be similar.  \n3. Click OK to close the Properties  dialog.  \n9.2 Solution Coverages and Whisker Plots  \nNow look at the solution coverages and whisker plots:  \n1. In the Project Explorer, turn off the \u201c  UGrid \u201d to see the coverages better.  \n2. Under \u201c  Map Data\u201d, expand both the \u201c  pest_obs_ss (MODFLOW 6)\u201d item \nand the \u201c  GWF_Model\u201d item.  \n3. Select the \u201c  PEST obs arc_groups\u201d coverage to make it active.  \n\nGMS Tutorials   MODFLOW 6 \u2013 PEST Observations  \n Page 8 of 8 \u00a9 Aquaveo 2024  The whisker plot gives an indication of how well the observed flo w to or from the river \nsystem matches the computed value. The \u201cMODFLOW \u2013 Model Calibration\u201d tutorial \nexplains whisker plots.  \n4. Using the Select Arc Groups   tool, click anywhere on the arc group to select \nit. \nNotice the data in the status bar at the bottom of the GMS window.  \n5. Select the \u201c  PEST obs points\u201d coverage.  \nAgain, the whisker plots indicate how well the computed and observed values match.  \nThere is also a \u201c  PEST obs arcs\u201d coverage that includes the arcs that make up the arc \ngroup, but there are no ob servations on the arcs so it can be ignored.  \n9.3 Observation Plots  \nTo view an observation plot from the calibration data, complete the following:  \n1. Right -click the \u201c  PEST obs points\u201d coverage and select the Observations  \ncommand to open the Observations  dialog.  \nIn the Observations  dialog ( Figure 3) the observation data is shown on the left, and a plot \nof the data is shown on the right.  \n2. Select the different plot types and examin e the plots.  \nThe \u201cTime Series\u201d plot is not applicable because the model is steady -state.  \n \nFigure 3     The Observations dialog  \n10 Conclusion  \nThis concludes the \u201cMODFLOW 6 \u2013 PEST Observations, Steady State\u201d tutorial. The \nfollowing top ics were discussed and demonstrated:  \n\uf0b7 Converting a MODFLOW -USG project to MODFLOW 6.  \n\uf0b7 Adding the PEST Observation Package to MODFLOW 6.  \n\uf0b7 Running MODFLOW 6 with PEST.  \n\uf0b7 Reviewing the PEST solution.  \n\n", "filename": "MODFLOW6_PEST_Obs_SS.pdf", "pages": 8}, "MODFLOW6_PEST_Obs_Trans": {"text": "GMS Tutorials   MODFLOW  6 \u2013 PEST Observations  \n Page 1 of 10 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW  6 \u2013 PEST Observations, Trans  \nUse PEST Observations with a Transient  MODFLOW 6 Simulation  \n \nObjectives   \nLearn how to use PEST observations with a transient  MODFLOW 6 simulations .  \n \nPrerequisite Tutorials  \n\uf0b7 Getting Started  \n\uf0b7 MODFLOW 6 \u2013 Grid \nApproach  \n\uf0b7 MODFLOW 6 \u2013 Conceptual \nModel Approach  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW -USG Model &  \nInterface  \n Time  \n\uf0b7 15\u201325 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   MODFLOW  6 \u2013 PEST Observations  \n Page 2 of 10 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Opening an Existing MODFLOW 6 Model  ................................ ................................ ..........  2 \n3 Examine the MODFLOW 6 Simulation  ................................ ................................ ...............  3 \n4 Adding Transient Head Observation Data  ................................ ................................ .........  4 \n5 Adding Transient Flow Observation Data  ................................ ................................ .........  5 \n6 Creating the PEST Observations Package  ................................ ................................ ........  6 \n7 Saving and Running the Simulation  ................................ ................................ ..................  7 \n8 Examining the Solution  ................................ ................................ ................................ ....... 7 \n8.1 Statistics  ................................ ................................ ................................ .......................  7 \n8.2 Solution Coverages and Whisker Plots  ................................ ................................ .........  7 \n8.3 Observation Plots  ................................ ................................ ................................ .........  8 \n9 Using Dates/Times ................................ ................................ ................................ ...............  9 \n9.1 TDIS Package ................................ ................................ ................................ ...............  9 \n9.2 Observations ................................ ................................ ................................ .................  9 \n9.3 PEST Observations  ................................ ................................ ................................ .... 10 \n10 Conclusion  ................................ ................................ ................................ .........................  10 \n \n1 Introduction  \nPEST can be used for observations and calibration. This tutorial is based off the model \nfrom \u201cCSUB Package Problem 4\u201d from the MODFLOW 6 example problems. The model \nis transient with three stress periods.  \nIn this tutorial, t ransient observation well points and flow arcs have been added in a GMS \nconceptual mode l. PEST utilities are used to determine computed head and flow at \nmeasured times and at MODFLOW output times. Some considerations for transient data \nare discussed. For a steady -state example, refer to the \u201cMODFLOW 6 \u2013 PEST \nObservations , Steady State \u201d tutor ial. \nGMS includes additional observation features beyond what comes with MODFLOW 6, \nincluding observations at arbitrary locations and times, comparison of observed and \ncomputed values, whisker plots, and other plots. This functionality is done with the hel p of \nutility programs that come with PEST, and is very similar to the observation functionality \nGMS provides for MODFLOW -USG. GMS prepares the input files needed by the PEST \nutilities to determine the computed values from the model solution. For more infor mation \nabout using PEST with MODFLOW -USG, refer to the \u201cMODFLOW -USG \u2013 Calibration\u201d \ntutorial.  \nThis tutorial discusses and demonstrates : \n\uf0b7 Adding transient head observation data.  \n\uf0b7 Adding transient flow observation data.  \n\uf0b7 Setting up the PEST Observation package.  \n\uf0b7 Saving and running the MODFLOW 6 simulation.  \n\uf0b7 Reviewing the solution.  \n2 Opening an Existing MODFLOW 6 Model  \nStart with opening an existing MODFLOW 6 model:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select the File | New command to ensure that the \nprogram settings are restored to their default state.  \n3. Click Open   to bring up the Open  dialog.  \n\nGMS Tutorials   MODFLOW 6 \u2013 PEST Observations  \n \n Page 3 of 10 \u00a9 Aquaveo 2024  4. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n5. Browse to the mf6_pest_obs_transient  folder and select \u201cstart .gpr\u201d. \n6. Click Open to import the pro ject and exit the Open  dialog.  \nThe project should be visible in the Graphics Window ( Figure  1). The project contains a \nMODFLOW 6 simulation.  \n \nFigure  1     Initial project for the MODFLOW -USG model  \nBefore continuing, save the project under a different name:  \n7. Select File | Save As\u2026  to open the Save As  dialog.  \n8. For the File Name , enter \u201cpest_obs_trans\u201d.  \n9. Click Save  to close the Save As dialog and save the new files.  \n3 Examine the MODFLOW 6 Simulation  \nThe tutorial example has an aquifer system consisting of an unconfined upper aquifer, an \nextensive confining unit, and a confined lower aquifer. The example uses two layers to \nrepresent the  water -table aquifer. It uses one layer to represent the confining unit and \none layer to represent the lower aquifer. The recharge package is used to simulate inflow \nto the flow system. The inflow throughout the entire simulation is at a rate of 5.5x10-4 \nmeters per day. Since the model is under steady -state conditions, all of the flow exits the \nsystem at eight constant -head cells, two of which are in each layer at the bottom of the \nmodel. The eight constant -head cells have head values specified to be 100 me ters. \nDuring stress period 2, each of the two wells draw water from the upper and lower aquifer \nat a rate of 72,000 cubic meters per day. ( MODFLOW 6 \u2013 Example  problems ) \n\nGMS  Tutorials   MODFLOW 6 \u2013 PEST Observations  \n Page 4 of 10 \u00a9 Aquaveo 2024  1. In the Project Explorer, double -click on the \u201c  TDIS\u201d package to open the \nTemporal Discretization (TDIS) Package  dialog.  \nThe example simulation contains three stress periods. The first stress period is an initial \nsteady -state stress period used for computing the head distribution. The second stress \nperiod is used to simulate 60 ye ars of pumping by the two wells . The third st ress period is \nused to simulate 60 years of recovery following cessation of pumping. The second and \nthird stress periods are divided into 60, 1 -year time steps . \n2. Click Cancel  to close the Temporal Discretization (TDIS) Package  dialog.  \n3. In the Project Explore r, select the \u201c  Head\u201d dataset.  \n4. Scroll through the different time steps in the Time Step Window.  \nNotice how the head contours change.  \n4 Adding Transient Head Observation Data  \nTwo coverages exist, one called \u201c  sources and sinks\u201d which includes an arc at the \nbottom of the model to define the CHD cells, and one called \u201c  observation wells\u201d which \nincludes one feature point that is to be used as an observation well. This section shows \nhow to set up the observation well. To do this:  \n1. Select the \u201c  observation wells \u201d coverage to make it active.  \n2. Double -click on the \u201c  observation wells\u201d coverage to open the Coverage Setup  \ndialog.  \n3. Under the Observation Points  section, turn on the Trans. Head  option.  \n4. Click OK to close the Coverage Setup  dialog.  \n5. Using the Select Points/N odes    tool, double -click on the feature point to \nopen the Attribute Table  dialog. The \u201c  observation wells\u201d coverage has only \none feature point.  \n6. In the first row of the table, change the Type  column to \u201cobs. pt\u201d.  \n7. Check that the Layer  column is set to \u201c1\u201d . \n8. Click the  button under the Obs. Trans. Head  column to open the XY Series \nEditor  dialog.  \n9. Click the Import button to bring up the Open File  dialog.  \n10. Browse to the directory for the tutorial files and select the \u201cobs_trans_head.xys\u201d \nfile. \n11. Click Open  to imp ort the observation transient head values.  \nThe MODFLOW simulation does not use a starting date so the observation data does not \neither. The times are in da ys. \n\nGMS Tutorials   MODFLOW 6 \u2013 PEST Observations  \n \n Page 5 of 10 \u00a9 Aquaveo 2024   \nFigure 2      The observation transient head data  \n12. Click OK to close the XY Series Editor  dialog.  \n13. Click OK to close the Attribute Table  dialog.  \n5 Adding Transient Flow Observation Data  \nThis tutorial seeks  to know how much flow is passing through the CHD cells. To enable  \nthe CHD arc to be used as a flow observation a rc: \n1. Select the \u201c  sources and sinks \u201d coverage to make it active.  \n2. Double -click on the \u201c  sources and sinks \u201d coverage to open the Coverage \nSetup  dialog.  \n3. Under the Source/Sinks/BCs  section, turn on the Trans. Observed Flow  option.  \n4. Click OK to close the Coverage Setup  dialog.  \n5. Using the Select Arcs    tool, double -click on the feature arc to open the \nAttribute Table  dialog. The \u201c  sources and sinks \u201d coverage has only one feature \narc. \n6. In the first row of the table, turn on the Obs. flow option.  \n7. Click the  button under the Obs. flow rate (m^3/d)  column to open the XY \nSeries Editor  dialog.  \n8. Click the Import button to bring up the Open File  dialog.  \n9. Browse to the directory for the tutorial files and select the \u201cobs_trans_flow.xys\u201d \nfile. \n10. Click Open  to import the observation transient flow values.  \n\nGMS  Tutorials   MODFLOW 6 \u2013 PEST Observations  \n Page 6 of 10 \u00a9 Aquaveo 2024   \nFigure 3     The observation flow rate data  \n11. Click OK to close the XY Series Editor  dialog.  \n12. Change the Obs. Flow interval  to -2500.0.  \n13. Click OK to close the Attribute Table  dialog.  \n6 Creating the PEST Observations Package  \nTo add the observation data to the MODFLOW  6 model, complete the following:  \n1. Right -click \u201c  ex-gwf-csub -p04\u201d and select the  New Package  | PEST \nObservations  command . \nThis adds a new component in the Project Explorer. It is not a MODFLOW 6 package, but \na GMS component that uses PEST with MODFLOW 6 to determine computed values . \n2. Double -click on the \u201c PEST Observations \u201d package item  to open the \nMODFLOW 6 PEST Observations  dialog . \nThis dialog is somewhat similar to the MODFLOW -USG Observations  dialog. Here the \nPEST input files are created from the MODFLOW 6 simulation . \n3. Click the Generate PEST Observation Data  button  to open the Generate \nObservations  dialog.  \n4. For the Head observation coverages , turn on \u201cobservation wells\u201d.  \n5. For the Flow observation coverages , turn on \u201csources and sinks\u201d.  \n6. Click OK to close the Generate Observations  dialog.  \n7. Click OK to close the error message that appears.  \n8. In the Errors  tab of the MODFLOW 6 PE ST Observations  dialog, review the \nerrors.  \nThere should be one error: \u201cObservation time outside of MODFLOW output time range. \nCoverage: observation wells; Feature type: point; Id: 1; Name: point_1; Time: 45000.0;\u201d \nOne of the observed values occurs after th e end of the simulation. While it is possible to \nremove that observation, for this tutorial ignore it as it won\u2019t affect the results.  \n\nGMS Tutorials   MODFLOW 6 \u2013 PEST Observations  \n \n Page 7 of 10 \u00a9 Aquaveo 2024  9. Click the Files  tab. \nTake a moment to click on the different files in the list of files on the left and examine \nwhat they are and the file contents. These are the files that PEST uses to calculate the \nobserved values. The files can be edited but it is almost never necessary to do so.  \nAlthough the MODFLOW simulation and the observation data is not using dates and \ntimes, PEST a lways uses dates and times. PEST uses January 1, 1950 as time zero if no \nother date is provided.  \n10. Click OK to exit the MODFLOW 6 PEST Observations  dialog.  \n7 Saving and Running the Simulation  \nNow to save and run the simulation again:  \n1. Right -click on \u201c  ex-gwf-csub-p04\u201d and select Save Project, Simulation and \nRun to start the Simulation Run Queue .  \n2. If it appears, click OK on the Info dialog to unload the previous solution.  \n3. Click Load Solution  to import the solution files.  \n4. Click Close  to exit the Simulation Run Queue .  \nSeveral things just happened:  \n\uf0b7 When the simulation was saved, GMS saved the PEST input files with the \nsimulation along with some batch files used to run PEST.  \n\uf0b7 When the simulation was run, MODFLOW calculated the head and flow \nsolutions.  \n\uf0b7 When the solution was read, GMS ran some PEST utilities using the input files \nand batch files. PEST used the model solution to determine the computed values \nat the observation points. GMS read the PEST output and added the data to the \nsolution as it was im ported.  \n8 Examining the Solution  \nNow to examine the results of the PEST observations using statistics tools, whisker plots, \nand observation plots.  \n8.1 Statistics  \nNotice that in addition to the Head dataset, there are some PEST related items including \nlinks to tw o coverages and a \u201cpest_obs_stats.txt\u201d file.  \n1. Expand the \u201c  Solution\u201d item and the \u201c  ex-gwf-csub -p04\u201d item below it.  \n2. Double -click the \u201c  pest_obs_stats.txt\u201d file to open the file in a text editor.  \nThis file contains observation statistics similar to the s tatistics that can be found by right -\nclicking on a MODFLOW -USG solution.  \n8.2 Solution Coverages and Whisker Plots  \nNow look at the solution coverages and whisker plots:  \n1. In the Project Explorer, turn off the \u201c  UGrid\u201d to see the coverages better  \n\nGMS  Tutorials   MODFLOW 6 \u2013 PEST Observations  \n Page 8 of 10 \u00a9 Aquaveo 2024  2. Under \u201c  Map Dat a\u201d, expand both the \u201c  ex-gwf-csub -p04 (MODFLOW 6)\u201d \nitem and the \u201c ex-gwf-csub -p04\u201d item.  \n3. Select the \u201c  PEST obs arcs\u201d coverage to make it active.  \nThe whisker plot gives an indication of how well the observed flow to or from the river \nsystem matches the co mputed value. The \u201cMODFLOW \u2013 Model Calibration\u201d tutorial \nexplains whisker plots.  \n4. Using the Select Arcs   tool, click anywhere on the arc to select it.  \nNotice the data in the status bar at the bottom of the GMS window.  \n5. Select the \u201c  PEST obs points\u201d coverag e. \nAgain, the whisker plots indicate how well the computed and observed values match.  \n6. In the Project Explorer, select the \u201c  Head\u201d dataset.  \n7. Scroll through the different time steps in the Time Step Window.  \nNotice how the whisker plot changes with the time steps.  \n8.3 Observation Plots  \nTo view an observation plot from the calibration data, complete the following:  \n1. Right -click the \u201c  PEST obs points\u201d coverage and select the Observations  \ncommand to open the Observations  dialog.  \nIn the Observations  dialog ( Figure 4) the observation data is shown on the left, and a plot \nof the data is shown on the right.  \n2. Select the different plot types and examine the plots.  \n3. Turn off Show null values  and see how it changes the plots.  \n4. Click OK to exit the Observations  dialog .  \n \nFigure 4     The Observations dialog  \n\nGMS Tutorials   MODFLOW 6 \u2013 PEST Observations  \n \n Page 9 of 10 \u00a9 Aquaveo 2024  9 Using Dates/Times  \nIf wanting the  model to use dates/times, use the steps in this section to change  the TDIS \npackage and the observation XY series . \n9.1 TDIS P ackage  \nStart with making changes to the TDIS package.  \n1. In the Project Explorer, right -click on the \u201c TDIS\u201d package and select Unlock . \n2. Double -click on the \u201c TDIS\u201d package to open the Temporal Discretizat ion \n(TDIS) Package  dialog.  \n3. Under the Sections  area of the dialog, t urn on OPTIONS . \n4. Turn on the START_DATE_TIME  option . \nEnter a date of \u201cMarch 28, 2022 \u201d, or use the Date/Time  button to select this date and \ntime.  \nNotice how the START_DATE_TIME  option affects the ENDDATE column.  \n5. Click OK to close the Temporal Discretization  (TDIS) Package  dialog . \n9.2 Observations  \nNow to turn on the date/time options for the observations by doing the following:  \n1. Select the \u201c  observation wells\u201d coverage to make it active.  \n2. Using the Select Points/Nodes    tool, double -click on the feature point to \nopen the Attribute Table  dialog.  \n3. Click the  button under the Obs. Trans. Head  column to open the XY Series \nEditor  dialog.  \n4. Turn on  the Use dates/times  option to bring up the Reference Time  dialog.  \n5. Enter the same date and time used in the TDIS package: March 28, 2022, at \n12:00:00 AM.  \n6. Click Select  to close the Reference Time  dialog  \n7. Click OK to close the XY Series Editor  dialog.  \n8. Click OK to close the Attribute Table  dialog.  \nIn a similar manner, convert the XY series for the CHD observed flow arc to use \ndates/times.  \n9. Select the \u201c  source and sinks\u201d coverage to make it active.  \n10. Using the Select Arcs    tool, double -click on the feature arc to open the \nAttribute Table  dialog.  \n11. Click the  button under the Obs. flow rate  column to open the XY Series \nEditor  dialog.  \n12. Turn on  the Use dates/times  option to bring up the Reference Time  dialog.  \n13. Enter the same date and time used in the TDIS package: March 28, 2022, at \n12:00:00 AM.  \n\nGMS  Tutorials   MODFLOW 6 \u2013 PEST Observations  \n Page 10 of 10 \u00a9 Aquaveo 2024  14. Click Select  to close the Reference Time  dialog  \n15. Click OK to close the XY Series Editor  dialog.  \n16. Click OK to close the Attribute Table  dialog.  \n9.3 PEST Observations  \nThe PEST files now need to be regenerated . \n1. Double -click on the \u201c PEST Observation s\u201d package item to open the \nMODFLOW 6 PEST Observations  dialog . \n2. Click the Generate PEST Observation Data  button  to open the Generate \nObservations  dialog.  \n3. For the Head observation coverages , turn on \u201cobservation wells\u201d.  \n4. For the Flow observation c overages , turn on \u201csources and sinks\u201d.  \n5. Click OK to close the Generate Observations  dialog . \n6. Click OK to close the error message that appears.  \n7. In the Errors  tab of the MODFLOW 6 PEST Observations  dialog, review the \nerrors.  \nThis is  the same error that was seen before but now reported using a date/time.  \n8. Click OK to close the MODFLOW 6 PEST Observations  dialog . \n9. Right -click on \u201c  ex-gwf-csub -p04\u201d and select Save Project, Simulation and \nRun to start the Simulation Run Queue .  \n10. If it appe ars, click OK on the Info dialog to unload the previous solution.  \n11. Click Load Solution  to import the solution files.  \n12. Click Close  to exit the Simulation Run Queue . \n13. In the Project Explorer, select the \u201c Head \u201d dataset  to make it  active.  \n14. Turn on Show dates/times  in the T ime Step window.  \nNotice the time steps start at March 28, 2022. Examine the observation data in the \nsolution coverages as before and notice that now the dates start at March 28, 2022.  \n10 Conclusion  \nThis concludes the \u201cMODFLOW 6 \u2013 PEST Obs ervations, Transient\u201d tutorial. The \nfollowing topics were discussed and demonstrated:  \n\uf0b7 Adding transient head and transient flow observation data.  \n\uf0b7 Adding the PEST Observation Package to MODFLOW 6.  \n\uf0b7 Running MODFLOW 6 with PEST.  \n\uf0b7 Reviewing the PEST solution.  \n\uf0b7 Adding dates and times to show in the model.  \n \n\n", "filename": "MODFLOW6_PEST_Obs_Trans.pdf", "pages": 10}, "MODPATH": {"text": "GMS Tutorials   MODPATH  \n Page 1 of 13 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODPATH  \nThe MODPATH Interface in GMS   \nObjectives   \nThis tutorial shows how to setup a MODPATH simulation in GMS and view the results. It instructs about \nassigning porosity, creating starting locations, displaying pathlines in different ways, and displaying \ncapture zones.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach I  Required  Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 MODPATH/MP3DU \nInterface  Time  \n\uf0b7 20\u201340 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MODPATH  \n Page 2 of 13 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Description of the Problem  ................................ ................................ ...........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  2 \n2.1 Importing the Project  ................................ ................................ ................................ ..... 3 \n2.2 Turning on the MODPATH Menu  ................................ ................................ ..................  3 \n3 Assigning the Porosities  ................................ ................................ ................................ ..... 3 \n4 Defining the Starting Locations ................................ ................................ ..........................  4 \n4.1 Viewing the Pathlines in Cross Section View  ................................ ................................  5 \n5 Display Options  ................................ ................................ ................................ ...................  6 \n6 Particle Sets  ................................ ................................ ................................ .........................  6 \n6.1 Particle Sets Dialog  ................................ ................................ ................................ ...... 6 \n6.2 Duplicating Particle Sets  ................................ ................................ ...............................  7 \n6.3 Changing the Display Order  ................................ ................................ .........................  7 \n7 Tracking Particles from the Landfill  ................................ ................................ ...................  8 \n7.1 Creating a New Particle Set  ................................ ................................ ..........................  8 \n7.2 Defining the New Starting Locations  ................................ ................................ .............  8 \n7.3 Capturing Landfill Particles at the Well  ................................ ................................ ....... 10 \n8 Color by Zone Code ................................ ................................ ................................ ...........  10 \n9 Pathline Length/Time  ................................ ................................ ................................ ........  11 \n10 Capture Zones by Zone Code  ................................ ................................ ...........................  12 \n11 Conclusion  ................................ ................................ ................................ .........................  13 \n \n1 Introduction  \nThis tutorial describes the steps involved in setting up a MODPATH simulation in GMS. \nMODPATH is a particle -tracking post -processing model developed by the U.S. \nGeological Survey. It tracks the trajectory of a set of particles from user -defined starting \nlocations using the MODFLOW solution as the flow field. The particles can be tracked \neither forward or backward in time. Particle tracking solutions have a variety of \napplica tions, including the determination of zones of influence for injection and extraction \nwells.  \nThis tutorial covers how to open a MODFLOW Conceptual Model project, create \npathlines from various starting locations, edit the particle sets, edit zone codes, and  view \ncapture zones.  \n1.1 Description of the Problem  \nThe problem discussed in this tutorial is an extension of the one described in the \n\u201cMODFLOW \u2013 Conceptual Model Approach \u201d tutorial. In that  tutorial, a site in East Texas \nwas modeled. The solution from that mo del is used as the flow field for the particle \ntracking simulation. The model includes a proposed landfill.  \nFor this tutorial, two particle tracking simulations will be performed to analyze the long -\nterm effects of contamination from the landfill. First, one simulation will use reverse \nparticle tracking from the well on the east side of the model to see if the zone of influence \nof the well overlaps the landfill. Another simulation will use forward tracking using an \narray of particles starting at the landfi ll to analyze the region of potential contamination for \nthe landfill.  \n2 Getting Started  \nTo get started, do the following:  \n1. Launch GMS.  \nGMS Tutorials   MODPATH  \n \n Page 3 of 13 \u00a9 Aquaveo 2024  2. If GMS is already running, select File | New\u2026  to ensure the program settings are \nrestored to their default state.  \n2.1 Importing the Project  \nTo import the project, which includes the MODFLOW model and solution, as well as all \nother files associated with the model, do the following:  \n1. Click Open   to bring up the Open  dialog.  \n2. Browse to the MODPATH \\start directory and select \u201c modfmap2.g pr\u201d. \n3. Click Open  to import the project file and close the Open  dialog .  \nThe Graphics Window should appear similar to Figure 1. \n \n      Figure 1      Initial appearance of the Graphics Window  \n2.2 Turning on the MODPATH Menu  \nIf the MODPATH menu is not visible, do the following:  \n1. Select Edit | Model Interfaces\u2026  to bring up the Model Interfaces  dialog.  \n2. Turn on MODPATH  below Models to use in project . \n3. Click OK to close the Model Interfaces  dialog.  \nThe menu should now be visible.  \n3 Assigning the Porosities  \nAt this point, it is possible to create particles. A porosity value must first be defined for \neach of the cells in the grid in order to cal culate the tracking times. By default, GMS \n\nGMS Tutorials   MODPATH  \n \n Page 4 of 13 \u00a9 Aquaveo 2024  automatically assigns a porosity of \u201c0.3\u201d to all the cells in the grid. This value is \nacceptable, so nothing needs to be done.  \nIf a different porosity is desired, the value can be set three different ways:  \n\uf0b7 Porosi ties can be assigned to the polygons in the conceptual model, followed by \nright-clicking and selecting Map To  | MODFLOW/ MODPATH .  \n\uf0b7 When in the 3D Grid module, select MODPATH | Porosity\u2026 to bring up the \nAquifer Layer Porosity  dialog . This dialog allows for editing a spreadsheet of \nvalues.  \n\uf0b7 When in the 3D Grid module, select one or more grid cells, then right -click and \nselect Properties\u2026  to bring up the 3D Grid Cell Properties  dialog. This dialog \nallows  editing of various values, incl uding the porosity of the selected cells.  \n4 Defining the Starting Locations  \nIt is necessary to create a set of particle starting locations surrounding the cell containing \nthe well on the east (right) side of the model.  \nTo generate the starting locations:  \n1. Right-click \u201c  3D Grid Data \u201d in the Project Explorer  and select Expand All  so \neverything within the folder is visible . \n2. Select MODPATH | Create Particles at Wells\u2026  to bring up the Generate \nParticles at Wells dialog.  \n3. Enter \u201c 20\u201d as the Number of particles per well. \n4. In the Well Type  section, select Extraction wells . \n5. Click OK to close the Generate Particles at Wells dialog.  \nAt this point, GMS does the following:  \n\uf0b7 Creates particles at every cell that contains an extraction well.  \n\uf0b7 Extends a set of pathlines from ea ch well in the direction the particles will flow. \nNotice that the pathlines from the east well extend to the northeast and miss the \narea covered by the proposed landfill (the gray square to the northwest of the \neast well, see Figure 1). \nThe particles and pathlines extending from the west (left) well are not needed and can be \ndeleted by doing the following:  \n6. Using the Select Particle Starting Locations   tool, drag a box surrounding the \nwest well.  \nThis selects all the particle and pathlines from that well.  \n7. Press the Delete  key to delete these particles and pathlines.  \n8. Frame   the project.  \nThe Graphics Window will appear similar to Figure 2. \n\nGMS Tutorials   MODPATH  \n \n Page 5 of 13 \u00a9 Aquaveo 2024   \n      Figure 2       After west well pathlines and particles are deleted  \n4.1 Viewing the Pathlines in Cross Section View  \nThe 3D nature of the pathlines is best seen in cross section view.  \n1. Using  the Select Cells   tool, select a cell near the right  side of the landfill.  \n2. Switch to  Side View  .  \nThe project should appear similar to Figure 3. If desired,  move back and forth through the \ncolumns using the arrows  in the Mini -Grid Toolbar . \n3. When finished, switch back to Plan View   to return to the top -down view.  \n4. Click anywhere outside the grid  to deselect the cell.  \n \n      Figure 3      Particle path lines in side view near the landfill  \n\nGMS Tutorials   MODPATH  \n \n Page 6 of 13 \u00a9 Aquaveo 2024  5 Display Options  \nIn addition to displaying the pathlines, GMS can draw a closed boundary around the \npathlines connected to the well. Thi s boundary is referred to as a \u201ccapture zone.\u201d Capture \nzones can only be displayed in plan view. GMS has a number of options for the display of \npathlines and capture zones.  \n1. Select MODPATH  | Display Options\u2026  to open the Display Options dialog.  \n2. Select \u201c3D Gr id Data\u201d from the list on the left.  \n3. On the Particles  tab, turn on Direction arrows . \n4. Enter \u201c 2000.0 \u201d in the Time interval  field.  \n5. In the Capture zones  section, turn on Boundary  and Poly fill . \n6. Click OK to close the Display Options  dialog.  \nThere are now arrows on the pathlines pointing in the direction of flow, and the capture \nzone is filled with a solid color.  \n6 Particle Sets  \nGMS organizes starting locations into \u201cparticle sets\u201d. When the starting locations at the \nwells were created, GMS auto matically created a particle set and put the new starting \nlocations in it.  \n1. If it is not already expanded, expand the \u201c  Particle Sets\u201d  folder  in the Project \nExplorer  under the  \u201c 3D Grid Data \u201d folder and \u201c  grid\u201d item . \n2. Right -click on \u201c particle se t\u201d and s elect Properties \u2026 to bring up the Particle \nSets dialog.  \n6.1 Particle Sets Dialog  \nIn this dialog, changes are made to the particle set properties, including the tracking \ndirection and the tracking duration. One particle set is always designated as the active \nparticle set. Whenever new points are created, they are added only to the active particle \nset. Similarly, only points from the active particle set can be deleted.  \nBy default, the tracking duration is set to track to the end, meaning MODPATH will track \nthe particles until they run into something (e.g., a sink, the water table, the edge of the \nmodel). Now change the tracking duration to a specific value.  \n1. In the Track  column, select \u201c Duration \u201d from the drop -down.  \n2. In the Duration  column, enter  \u201c3000 .0\u201d. \n3. Click OK to close the Particle Sets  dialog . \n4. Notice that the capture zone is much smaller now.  \nThe capture field should appear similar to Figure 4. \n\nGMS Tutorials   MODPATH  \n \n Page 7 of 13 \u00a9 Aquaveo 2024   \n      Figure 4      Capture field is greatly reduced in size  \n6.2 Duplicating Particle Sets  \nThe next step is to display a 1,500 -day capture zone as well as a 3,000 -day capture \nzone. First, turn the arrows off so they don\u2019t obscure the display of the capture zo nes: \n1. Select MODPATH | Display Options \u2026 to open the Display Options dialog . \n2. Select \u201c3D Grid Data\u201d from the list on the left.  \n3. On the Particles  tab, turn off Direction arrows . \n4. Click OK to close the Display Options  dialog.  \n5. Right -click \u201c  particle se t\u201d and select Rename . \n6. Enter \u201c 3000 days \u201d and press the Enter  key to set the new name.  \nCreate another particle set by copying the existing one, do the following:  \n7. Right -click \u201c  3000 days\u201d and select Duplicate  to create a new \u201c  Copy of \n3000 days (2)\u201d partic le set.  \n8. Right -click \u201c  Copy of 3000 days (2)\u201d and select Rename . \n9. Enter  \u201c1500 days \u201d and press Enter  to set the new name.  \nWhen there are multiple particle sets, it is recommended to give each set an appropriate \nname in order to differentiate between the re sults.  \n10. Right -click \u201c 1500 days \u201d and select Properties \u2026 to bring up the Particle Sets \ndialog . \n11. On row 2, enter \u201c 1500 .0\u201d in the Duration  column.  \n12. Click OK to close the Particle Sets  dialog . \n6.3 Changing the Display Order  \nThe order of the particle sets in the Project Explorer  is the top -down order in which they \nare displayed. The \u201c  1500 days \u201d set should be dragged above the \u201c  3000 days \u201d set \nbecause it is smaller and currently hidden below the \u201c  3000 days \u201d set.  \n1. Drag the \u201c  1500 days \u201d particle set above the \u201c  3000 days \u201d particle set.  \n\nGMS Tutorials   MODPATH  \n \n Page 8 of 13 \u00a9 Aquaveo 2024  Two capture zones are now visible: the larger 3,000 -day capture zone, and the small er \n1,500 -day capture zone ( Figure 5). \n \n      Figure 5      Both particle sets visible  \n7 Tracking Particles from the Landfill  \nNext, perform forward tracking from a set of starting locations which coincide with the site \nof the proposed landfill.  \n7.1 Creating a New Particle Set  \nCreate a new part icle set for the particles that will be created at the landfill by doing the \nfollowing:  \n1. In the Project Explorer , right -click on the \u201c  Particle Sets \u201d folder and select New \nParticle Set  to create a new \u201c  particle set\u201d.  \n2. Right -click \u201c  particle set\u201d and sele ct Rename .  \n3. Enter \u201c Landfill \u201d and press Enter  to set the new name.  \n4. Right -click \u201c  Landfill \u201d and select Properties \u2026 to bring up the Particle Sets \ndialog.  \n5. Select \u201c Forward \u201d from the Direction  column drop -down on row 3. \n6. Click OK to close the Particle Sets  dialog.  \n7.2 Defining the New Starting Locations  \nA new set of starting locations must be created at the site of the proposed landfill. The \nparticles will be placed on the top of the ground water table to simulate leachate entering \nfrom the surface.  \nFirst, turn  off the boundary fill option so the new pathlines are easier to see:  \n1. Select MODPATH  | Display Options\u2026  to open the Display Options dialog.  \n2. Select \u201c3D Grid Data\u201d from the list on the left.  \n\nGMS Tutorials   MODPATH  \n \n Page 9 of 13 \u00a9 Aquaveo 2024  3. On the Particles  tab in the Capture zones  section, turn off the Poly fill  option.  \n4. Click OK to close the Display Options  dialog.  \nBefore selecting the cells, make the recharge coverage the active coverage so that the \nlandfill polygon is clearly visible.  \n5. In the Project Explorer , expand the \u201c  Map Data\u201d folder and the \u201c  East Texas \u201d \nconceptual module.  \n6. Select the \u201c  Recharge \u201d coverage to make it active.  \nTo select the cells:  \n7. Using the Select Polygons   tool, select the landfill polygon ( Figure 6). \n \n      Figure 6      Landfill polygon  \n8. Right -click on the selected polygon and choose Select Intersecting Objects \u2026 \nto bring up the Select Objects of Type  dialog.  \n9. Select OK to accept the defaults and close the Select Objects of Type  dialog.  \nThe 3D grid cells should now be selected.  \n10. Select MODPATH | Create Particles at Selected Cells  to bring up the Generate \nParticles  dialog.  \n11. Select \u201c On water table surface \u201d from the Distribute particles  drop-down.  \n12. Turn off More options . \n13. Click OK to close the Generate Particles  dialog.  \n14. Click anywhere outside the grid to deselect the cells.  \nThe model now has a set of pathlines starting at the landfill and terminating at the river \n(Figure 7). \n\nGMS Tutorials   MODPATH  \n \n Page 10 of 13 \u00a9 Aquaveo 2024   \n      Figure 7      Pathlines from the landfill to the river  \n7.3 Capturing Landfill Particles at the Well  \nCurrently, no particles from the landfill are captured by the well. It\u2019s necessary to increase \nthe pumping rate in the well so that some of the particles from the landfill are captured.  \n1. Select \u201c  Sources&Sinks \u201d in the Project Explorer  to make it active.  \n2. Using the Select Point/Node   tool, double -click on the well on the right side of \nthe model to open the Attribute Table dialog.  \n3. Enter \u201c -600.0 \u201d in the Flow rate (m^3/d)  column.  \n4. Click OK to close the Attribute Table dialog.  \n5. Select Feature Objects | Map \u2192 MODFLOW  to bring up the Map \u2192 Mo del \ndialog.  \n6. Click OK to accept the defaults and close the Map \u2192 Model  dialog.  \n7. Select File | Save As\u2026  to bring up the Save As  dialog.  \n8. Enter \u201c modpath .gpr\u201d in the File name  field.  \n9. Click Save  to save the project and close the Save As  dialog.  \n10. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \nThis shows the progress of MODFLOW.  \n11. When MODFLOW is finished, turn on Read solution on exit  and Turn on \ncontours . \n12. Click Close  to exit the MODFLOW  dialog.  \nAfter the MODFLOW computed heads are importe d into GMS, MODPATH will run again \nwith the new MODFLOW solution. Notice that the capture zones for the well are larger \nthan before and some of the particles from the landfill terminate at the well.  \n8 Color by Zone Code  \nTo easily identify the particles from the landfill that terminate at the well, it is useful to \nmake them a different color.  \n\nGMS Tutorials   MODPATH  \n \n Page 11 of 13 \u00a9 Aquaveo 2024  First, turn off the display of the particles coming from the well.  \n1. In the Project Explorer , turn off \u201c  1500 days \u201d and \u201c  3000 days \u201d. \n2. Switch to the 3D Grid   module.  \nNow change the zone code for the cell containing the well:  \n3. In the Mini-Grid Toolbar , enter \u201c2\u201d in the Lay (k)  field.  \n4. Using  the Select Cells   tool, select the cell with the well in it.  Zoom  in if \nneeded . \n5. Right -click on the selected cell and select Properti es\u2026 to open the 3D Grid Cell \nProperties dialog . \n6. On the MOD FLOW  tab, enter\u201d2\u201d in the MODPATH Z one code  field.  \n7. Click OK to close the 3D Grid Cell Properties dialog . \n8. Select MODPATH | Display Options \u2026 to open the Display Options dialog . \n9. Select \u201c3D Grid Data\u201d from the list on the left.  \n10. On the Particles  tab, select  \u201cEnding code \u201d from the Color  drop-down.  \n11. Click  OK to close the Display Options  dialog . \nThe pathlines that go from the landfill to the well should now be drawn in a different color \n(Figure 8). \n \n      Figure 8      Pathlines going to well are different color  \n9 Pathline Length/Time  \nOne reason to do particle tracking is to find out how long it w ill take for particles to travel \nfrom one place to another. In this case, it is desirable to know how long it will take for \nparticles to travel from the landfill to the well. GMS reports the length and travel time of \nselected pathlines.  \n1. Using the Select Pa rticle Starting Locations   tool, click on one of the \npathlines that go es from the landfill to the well.  \nSome statistics for the selected pathline  are in the status bar at the bottom of the GMS \nwindow. One of the items is the time. Note the minimum time. Clicking on different \n\nGMS Tutorials   MODPATH  \n \n Page 12 of 13 \u00a9 Aquaveo 2024  pathlines one at a time and comparing their times could be done, but there\u2019s an easier \nway. \n2. Select all the pathlines that go from the landfill to the well by dragging a box \naround their starting locations ( Zoom   in if needed).  \nIn the status bar at the bottom of the GMS window, notice the maximum, minimum, and \naverage lengths and times for all the selected pathlines.  \n10 Capture Zon es by Zone Code  \nThere is no closed boundary surrounding the pathlines originating from the landfill. By \ndefault, GMS only identifies capture zones for particles originating from wells. However, \ncapture zones can be associated with particles originating fro m all cells with the same \nzone code.  \nThis feature can be used to group several wells together in the same capture zone. For \nexample, to know what the combined capture zone is for all the wells if there were \nseveral wells located close together in a well f ield. \nThis feature can also be used to show the \u201ccapture zone\u201d for the landfill.  \n1. Select MODPATH  | Display Options \u2026 to open the Display Options dialog.  \n2. Select \u201c3D Grid Data\u201d from the list on the left.  \n3. On the Particles  tab in the Capture zones  section, selec t Delineate by zone code . \n4. Turn on Poly fill . \n5. Click OK to close the Display Options  dialog.  \nThe capture zone for the landfill pathlines is now visible ( Figure 9). Notic e that the \ncapture zone includes areas where there are no pathlines.  \n \n      Figure 9      Capture zones including areas with no pathlines  \nTo fix this, do as follows:  \n6. Select MODPATH  | Display Options \u2026 to open the Display Options dialog.  \n7. Select \u201c3D Grid Data\u201d from the list on the left.  \n\nGMS Tutorials   MODPATH  \n \n Page 13 of 13 \u00a9 Aquaveo 2024  8. On the Particles  tab in the Capture zones  section, enter \u201c0.9\u201d in the Thin triangle \nratio field.  \n9. Click OK to close the Display Options  dialog.  \nThe capture zone area should now appear similar to Figure 10. \n \n      Figure 10      Modified capture zones  \nNotice how the boundary of the capture zone has been \u201csucked in\u201d so that it corresponds \nmore closely to the pathlines. This is what the thin triangle ratio  does . If it is decreased \ntoo much, the capture zone will begin to look bad. The default was appropriate for the \nwell capture zone seen earlier, but not for the landfill capture zone. This v alue may need \nadjusting to get a good -looking capture zone.  \n11 Conclusion  \nThis concludes the \u201c MODPATH \u201d tutorial. The following key concepts were discussed and \ndemonstrated in this tutorial:  \n\uf0b7 MODPATH is available whenever a MODFLOW model is in memory. MODPATH \nrequires a flow solution before pathlines can be computed.  \n\uf0b7 It is possible to create particle starting locations by using the Generate Particles \nat Wells  or Generate Particles at Selected Cells  commands.  \n\uf0b7 Particles are grouped into particle sets. Particle sets are used to control the \ntracking direction, the duration, and the display order.  \n\uf0b7 A number of different display options are available for pathlines, including \ndisplaying arrows, coloring by zone code, and displaying filled polygons \nrepresenting capture  zones (in plan view only).  \n \n\n", "filename": "MODPATH.pdf", "pages": 13}, "MT3D-USGS-Keating": {"text": "GMS Tutorials   MT3D -USGS \u2013 Keating Example  \n Page 1 of 6 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMT3D -USGS \u2013 Keating Example  \nCreate an MT3D -USGS model using the Keating Example Problem  \n \nObjectives   \nThis tutorial will show constructing a MT3D -USGS model using the Keating example problem from the \nMT3D -USGS documentation.  \n \nPrerequisite Tutorials  \n\uf0b7 MT3DMS \u2013 Grid Approach  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 MT3D  \n Time  \n\uf0b7 15\u201325 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MT3D -USGS \u2013 Keating Example  \n Page 2 of 6 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  3 \n2 The Flow  Model  ................................ ................................ ................................ ....................  3 \n3 MT3DMS Transport Simulation  ................................ ................................ ..........................  4 \n4 Mt3d -USGS Transport Simulation  ................................ ................................ ......................  5 \n5 Conclusion  ................................ ................................ ................................ ...........................  6 \n \n1 Introduction  \nThis tutorial describes how to perform a MT3D -USGS simulation within GMS. It is highly \nrecommended to have completed the \u201cMT3DMS \u2013 Grid Approach\u201d tutorial prior to starting  \nthis tutorial in order to understand how to create a transport simulation in GMS.  \nThe problem in this tutorial ( Figure 1) corresponds to a sample prob lem described in the \nMT3D -USGS  documentation.1 The following is a description of the problem from the \ndocument:  \nThe model first published in Keating and Zyvoloski (2009) and described under \nthe heading, \u201cExtension to Mixed Vadose/Saturated Zone Simulations ,\u201d is solved \nwith MODFLOW -NWT and MT3D -USGS to demonstrate the routing of solute \nmass through dry cells. In this problem, an aquitard above the underlying \nregional flow intercepts recharge and forms a perched aquifer. Under steady -\nstate flow conditions, pe rched groundwater flows over the edges of the aquitard, \nand MODFLOW -NWT instantaneously applies this water to the top of the \nunderlying aquifer. In the transport problem, the initial concentration is zero \nthroughout the entire domain. Water entering and ex iting the domain through the \nleft and right boundaries, respectively, are assigned a concentration of 0. Only \nthe recharge, specified in layer 1 (note that the highest active layer is 8) is \nspecified with a non -zero concentration equal to 100 mg/L for the first 730 days \nof the simulation. Thus, the solute arrives first in the perched aquifer before \neventually spilling over the sides of the aquitard and entering the lower aquifer. It \nis the new DRYCELL keyword functionality in MT3D -USGS that makes this type \nof simulation possible. Once in the lower aquifer, the solute is transported toward \nthe right boundary in response to groundwater flow patterns and in this way is \nrouted through the perched and lower regional aquifers.  \n \n      Figure 1      Keating Example Problem from MT3D -USGS Documentation  \nThis tutorial will illustrate functionality in MT3D -USGS that does not exist in MT3DMS. \nMT3D -USGS can route concentrations through \u201cdry cells\u201d from a MODFLOW -NWT \nsimulation. The tutorial will demonstrate the following:  \n                                                      \n1 Bedekar, V., Morway, E.D., Langevin, C.D., and Tonkin, M., 2016, MT3D -USGS version 1: A U.S. \nGeological Survey Release of MT3DMS Updated with New and Expanded Transport Capabilities \nfor Use with MODFLOW (No. 6 -A53) . U.S. Geological Survey, pp. 36 \u201337. Available at: \nhttp://dx.doi.org/10.3133/tm6A53   \nThis is the initial report that describes the theory and use of MT3D -USGS.  \n\nGMS Tutorials   MT3D -USGS \u2013 Keating Example  \n \n Page 3 of 6 \u00a9 Aquaveo 2024  \uf0b7 Importing a project with an existing MODFLOW -NWT simulation.  \n\uf0b7 Examining the outputs of the simulation.  \n\uf0b7 Using MT3DMS to simulate transport and examine the results.  \n\uf0b7 Using MT3D -USGS to simulate transport and examine the resul ts. \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2 The Flow Model  \nTo start the tutorial, import an existing MODFLOW -NWT project by doing the following:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the keating \\ directory and select \u201cstart.gpr\u201d.  \n4. Click Open  to import the project and exit the Open  dialog.  \nThe display should look like Figure  2. \n \nFigure  2  View of initial model  \n5. Select the \u201c  Head\u201d dataset under the \u201c  start (MODFLOW)\u201d item in the \nProject Explorer.  \nThe display should match Figure 3. Notice that the computed heads show a perched \naquifer above regional groundwater flowing from left to right.  \n \nFigure 3  Computed Head from MODFLOW -NWT model  \n\nGMS Tutorials   MT3D -USGS \u2013 Keating Example  \n \n Page 4 of 6 \u00a9 Aquaveo 2024  6. Select \u201c  elevation\u201d from the Project Explorer to return the display t o the full grid \nwith the materials visible.  \n3 MT3DMS Transport Simulation  \nThe next step is to simulate transport with MT3DMS. To save time, this tutorial starts with \nan existing MT3DMS model.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cModel Super Fil es (*.mfs;*.rsp;*.mts;*.rts;*.sms; *.fws; *.sps)\u201d from the \nFiles of type  drop-down.  \n3. Browse to the keating \\mt3dms \\ directory and select \u201cmt3dms.mts\u201d.  \n4. Click Open  to import the project and exit the Open  dialog.  \nA MT3DMS simulation should now appear in the Project Explorer below the MODFLOW \nitem. This model should simulate concentration entering the model from the recharge \nzone near the top middle of the grid. The simulation includes advection and dispersion; \nthe properties for these packages can be examined  by opening the package dialogs.  \nBefore running MT3DMS, the MT3DMS model run options need to be set.  \n5. Select the MT3DMS  | Run Options\u2026  command to open the Run Options  dialog.  \n6. Select the Single run with selected MODFLOW solution  option.  \n7. Select OK to exit the  Run Options  dialog.  \nWith the run option for MT3DMS specified, it is now possible to save a copy of the \nproject.  \n8. Select the File | Save As\u2026  command to open the Save As  dialog.  \n9. Select \u201cProject Files (*.gpr)\u201d for Save as type . \n10. Enter \u201cmt3d\u201d as the File name . \n11. Select the Save  button to close the Save As  dialog and save a new project file.  \nThe MT3DMS model can now be run.  \n12. Select the MT3DMS | Run MT3DMS\u2026  command to bring up the MT3DMS  \nmodel wrapper.  \n13. When the simulation finishes running, make certain Read solution on exit  is \nturned on.  \n14. Select the Close  button to exit the MT3DMS  model wrapper.  \nThe solution from the model run will automatically be loaded into the project.  \n15. Select the \u201c  tracer\u201d dataset under the \u201c  mt3d (MT3DMS)\u201d folder in the \nProject Explorer.  \nThe dis play will update to the computed concentrations from MT3DMS ( Figure 4).  \nNotice the values are 0.0 everywhere in the grid for every time step of the \u201c  tracer\u201d \ndataset. MT3DMS is unable to simulate transport with dry cells from MODFLOW -NWT. \nThe concentrations that come from the recharge area never enter the MT3DMS model.  \n\nGMS Tutorials   MT3D -USGS \u2013 Keating Example  \n \n Page 5 of 6 \u00a9 Aquaveo 2024   \nFigure 4  Concentrations from MT3DMS Simulation (all valu es are 0.0)  \n4 Mt3d -USGS Transport Simulation  \nNext to change the transport model to be MT3D -USGS and use the DRYCELL option so \nthat transport will occur with dry cells from the MODFLOW simulation. To do this, use the \nfollowing steps:  \n1. Select MT3DMS  | Basic Transport Package  to open the Basic Transport \nPackage  dialog.  \n2. Under the Model  section, select MT3D -USGS  as the model.  \n3. Select the check box next to the DRYCELL: MT3D -USGS mass transfer through \ndry cells  item to turn it on.  \n4. Click OK to close the Basic Transport Package dialog.  \nWith the transport model changed to MT3D -USGS, the MT3DMS  menu has changed to \nthe MT3D -USGS  menu. Before continuing, it is recommended to save the project.  \n5. Select the File | Save As\u2026  command to open the Save As  dialog.  \n6. Selec t \u201cProject Files (*.gpr)\u201d for Save as type . \n7. Enter \u201cmt3d_usgs\u201d as the File name . \n8. Select the Save  button to close the Save As  dialog and save a new project file.  \nNow to run the MT3D -USGS simulation:  \n9. Select MT3D -USGS  | Run MT3D -USGS\u2026  to launch the MT3D -USGS  model \nwrapper dialog.  \n10. When the simulation finishes running, make certain Read solution on exit  is \nturned on.  \n11. Select the Close  button to exit the MT3D -USGS  model wrapper.  \nThe display will update to the computed concentrations from MT3D -USGS.  \n12. Select the \u201c  tracer\u201d dataset under the \u201c  mt3d_usgs (MT3D -USGS)\u201d folder \nfrom the Project Explorer.  \n13. Change the selected time step to 10730.0 in the Time Step window below the \nProject Explorer.  \n14. Cycle through the time steps to step how the plume migrates.  \nAt time step 1250 0.0 the display will look like Figure 5. \n\nGMS Tutorials   MT3D -USGS \u2013 Keating Example  \n \n Page 6 of 6 \u00a9 Aquaveo 2024   \nFigure 5  Plume at time step 12500.0  \n5 Conclusion  \nThis concludes the \u201c MT3D -USGS \u2013 Keating  Example\u201d  tutorial. The following key \nconcepts were discussed and demonstrated in this tutorial:  \n\uf0b7 MT3D -USGS has all of the simulation capabilities of MT3DMS plus additional \ncapabilities.  \n\uf0b7 MT3D -USGS can simulate transport in MODFLOW -NWT models with dry  cells.  \n \n\n", "filename": "MT3D-USGS-Keating.pdf", "pages": 6}, "MT3DMS-AdvancedTransport": {"text": "GMS Tutorials   MT3DMS \u2013 Advanced Transport  \n Page 1 of 13 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMODFLOW \u2013 Advanced Transport  \nMT3DMS dispersion, sorption, and dual domain options  \n \nObjectives   \nLearn about the dispersion, sorption, and dual domain options in MT3DMS.  \n \nPrerequisite Tutorials  \n\uf0b7 MT3DMS \u2013 Grid Approach  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 MT3D  \n Time  \n\uf0b7 25\u201340 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MT3DMS \u2013 Advanced Transport  \n Page 2 of 13 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 GMS User Interface ................................ ................................ ................................ ..............  3 \n2.1 The Flow Model  ................................ ................................ ................................ ............  3 \n3 Building the Transport Model  ................................ ................................ .............................  4 \n3.1 The Basic Transport Package ................................ ................................ .......................  4 \n3.2 Saving the Project with a New Name  ................................ ................................ ............  5 \n3.3 Defining the Initial Concentration  ................................ ................................ ..................  5 \n3.4 The Advection Package  ................................ ................................ ................................  6 \n3.5 Run Options  ................................ ................................ ................................ ..................  6 \n3.6 Run Options  ................................ ................................ ................................ ..................  6 \n3.7 Viewing the Solution  ................................ ................................ ................................ ..... 7 \n4 Adding Dispersion  ................................ ................................ ................................ ...............  8 \n4.1 The Dispersion Package  ................................ ................................ ...............................  8 \n4.2 Saving the Simulation and Running MT3DMS  ................................ ..............................  8 \n4.3 Viewing the Solution  ................................ ................................ ................................ ..... 9 \n5 Adding Sorption ................................ ................................ ................................ ...................  9 \n5.1 Editing the Chemical Reaction Package  ................................ ................................ ..... 10 \n5.2 Saving the Simulation and Running MT3DMS  ................................ ............................  10 \n5.3 Viewing the Solution  ................................ ................................ ................................ ... 10 \n6 Simulating Dual Domain Transport  ................................ ................................ ..................  11 \n6.1 Viewing the Solution  ................................ ................................ ................................ ... 11 \n6.2 Saving the Simulation and Running MT3DMS  ................................ ............................  12 \n6.3 Viewing the Solution  ................................ ................................ ................................ ... 12 \n7 Conclusion  ................................ ................................ ................................ .........................  13 \n \n1 Introduction  \nThis tutorial describes how to include some of the advanced transport options when \nperforming an MT3DMS simulation within GMS. It also illustrates dispersion, sorption, \nand dual -domain transport.  \nThe problem to be solved in this tutorial is a modification of the problem used in the \n\u201cMT3DMS \u2013 Grid Approach\u201d tutorial. However, the low K zone and the injection and \nextraction wells have been removed, leaving only a simple north -to-south, one -\ndimensional flow field as shown in Figure 1. The sides of the region are no -flow \nboundaries. The top and bottom  are constant head boundaries. The initial condition for \nthe plume consists of a small contaminant source zone near the upstream end of the \nmodel.  \nFor this tutorial, four transport simulations will be run representing the following \nconditions:  \n1. Tracer trans port: A simple advective flow.  \n2. Dispersion : Add dispersion and note the effect on the plume shape.  \n3. Sorption : Add dispersion , turn on sorption,  and note the effect on the plume \nshape.  \n4. Dual domain : A dual domain simulation run where a separate set of transpor t \noptions is specified for the mobile phase and the immobile phase.  \nGMS Tutorials   MT3DMS \u2013 Advanced Transport  \n \n Page 3 of 13 \u00a9 Aquaveo 2024  \n \nConstant head boundary (H=250 m) (flow model)  \nNo mass flux boundary (transport model)  \nConstant head boundary (H = 36.25 m)  Number of rows = 40  \nNumber of columns = 32  \nAquifer thickness = 10 m  \nK = 1.5x10-4 m/s \nPorosity = 0.3  \nLongitudinal dispersivity = 20 m  \nDispersiv ity ratio = 0.2  \nSimulation time = 1.0 yr  \nDX = 1600 m  DY = 2000 m  \nNo flow boundary \n(flow model)  \nNo mass flux \nboundary  \n(transport model)  No flow boundary \n(flow model)  \nNo mass flux \nboundary  \n(transport model)  Contaminant \nsource zone  \nGround water \nflow direction   \n      Figure 1      Sample flow and transport problem  \n2 GMS User Interface  \nDo the following to get started:  \n1. If you have not yet done so, launch GMS.  \n2. If you have already been using GMS, select File | New  to ensure the program \nsettings are restored to the default state.  \n2.1 The Flow Model  \nBefore setting up the MT3DMS simulation, it is necessary to have a MODFLOW solution \nto be used as the flow field for the transport simulation. In the interest of time, import a \npreviously created MODFLOW simulation.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the mt3dadv \\mt3dadv \\ directory and select \u201cflowmod.gpr\u201d.  \n4. Click Open  to import the project and exit the Open  dialog.  \nNote that the head contours indicate a linear decrease in head from the north to the south \n(Figure 2). \n\nGMS Tutorials   MT3DMS \u2013 Advanced Transport  \n \n Page 4 of 13 \u00a9 Aquaveo 2024   \n      Figure 2      Initial model showing linear decrease in head  \n3 Building the Transport Model  \nWith a flow solution imported, it is possible to set up the MT3DMS tracer transport \nsimulation.  \n3.1 The Basic Transport Package  \nFirst, initialize the MT3DMS simulation and set up the species:  \n1. Select MT3DMS | New Simulation\u2026  to open the Basic Transport Package \ndialog.  \n2. Click Define Species\u2026  to open the Define Species dialog.  \n3. Click New to create a new species in the spreadsheet.  \n4. Enter \u201ctracer\u201d in the Name  column and click OK to close the Define Species  \ndialog.  \nNext, select which packages to use.  \n5. Click Packages\u2026  to open the MT3DMS/RT3D Packages dialog.  \n6. Turn on Advection package , Dispersion package , and Source/sink mixing \npackage . \n7. Click OK to close the MT3DMS/RT3D Packages  dialog.  \n\nGMS Tutorials   MT3DMS \u2013 Advanced Transport  \n \n Page 5 of 13 \u00a9 Aquaveo 2024  The next step is to set up the stress periods. The flow simulation is steady state but the \ntransport simulation will be transient. The simulation will be run for a one -year time \nperiod. To do this, use a single stress period (since the input values are constant) and \nallow MT3DMS to determine the appropriate transport step size.  \n8. Click Stress Periods\u2026  to bring up the Stress Periods  dialog.  \n9. On row 1, enter \u201c365.0\u201d in the Length  column.  \n10. Scroll to the right and enter \u201c0.0\u201d in the Trans. step size .  \nA value of zero indicates that MT3DMS will automatically compute the appropriate \ntransport step size.  \n11. Click OK to exit the Stress Periods  dialog.  \nSpecify the output options next:  \n12. Click Output Control\u2026  to open the Output Control dialog.  \n13. Select the Print or save at specified times  option.  \n14. Click Times\u2026 to open the Variable Time Steps dialog.  \n15. Click Initialize Values \u2026 to open the Initialize Time Steps dialog.  \n16. Enter \u201c18.25\u201d as the Initial tim e step size . \n17. Enter \u201c18.25\u201d as the Maximum time step size . \n18. Enter \u201c365\u201d as the Maximum simulation time . \n These values will result in 20 output time steps.  \n19. Click OK to close the Initialize Time Steps  dialog.  \n20. Click OK to close the Variable Time Steps  dialog.  \n21. Click OK to close the Output Control  dialog.  \nFinally, it is necessary to define the porosity for the cells. This problem has a constant \nporosity of \u201c0.3\u201d. This is the default value in GMS, so no changes need to be made. The \nremaining options should remain a t the default values for this tutorial.  \n22. Click OK to exit the Basic Transport Package  dialog.  \n3.2 Saving the Project with a New Name  \nBefore continuing, save the project with a different name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProjec t Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201ctracer.gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n3.3 Defining the Initial Concentration  \nNext, edit the initial concentration for four of the cells near the top end of the model to \ndefine the initial state of the contaminant plume.  \n1. Hold the ctrl key down and select the cells \u201c5,16,1\u201d, \u201c5,17,1\u201d, \u201c6,16,1\u201d, and \n\u201c6,17,1\u201d (see Figure 3).  \nGMS Tutorials   MT3DMS \u2013 Advanced Transport  \n \n Page 6 of 13 \u00a9 Aquaveo 2024  The cell indices (I,J,K) are displayed at the bottom of the GMS window.  \n2. Select MT3DMS | Cell Properties\u2026  to open the 3D Grid Cell Properties dialog.  \n3. On the MT3DMS tab, in the lower section, enter \u201c100.0\u201d in the tracer (mobile)  \ncolumn on the Starting conc.  row. \n4. Click OK to close the 3D Grid Cell Properties  dialog.  \n \n      Figure 3      The four cells with initial contaminant concentrations  \n3.4 The Advection Package  \nNow tell MT3DMS to always use  the same MODFLOW solution to define the flow field. \nThis allows saving the transport simulation under a different name without having to re -\nrun MODFLOW.  \n1. Select MT3DMS | Run Options\u2026  to bring up the Run Options  dialog.  \n2. Select Single run with selected MODFL OW solution  and click OK to close the \nRun Options  dialog.  \n \n3.5 Run Options  \nThe next step is to enter the data for the Advection package. This tutorial will use the \nThird Order TVD scheme (ULTIMATE)  solution scheme. This is the default, so nothing \nneeds to be c hanged.  \n3.6 Run Options  \nIt is now possible to save the simulation and run MT3DMS.  \n1. Save   the project.  \n2. Select MT3DMS | Run MT3DMS\u2026  to bring up the MT3DMS  dialog.  \n3. When the simulation is finished, turn on Read solution on exit  and click Close  to \nexit the MT3DMS  dialog.  \nThe model should appear similar to Figure 4. \n\nGMS Tutorials   MT3DMS \u2013 Advanced Transport  \n \n Page 7 of 13 \u00a9 Aquaveo 2024   \n      Figure 4      After the first MT3DMS run  \n3.7 Viewing the Solution  \nTo view the imported solution, do the following:  \n1. Fully expand the \u201c  3D Grid Data\u201d folder in the Project Explorer.  \n2. Select the \u201c  tracer\u201d dataset under the \u201c  tracer (MT3DMS)\u201d solution.  \n3. Select the first time step (\u201c18.25\u201d) in the Time Step Window, then use the up and \ndown arrows on the keyboard to step through the range of  time steps associated \nwith the solution.  \nNote that the plume does not spread out, but instead stays together as a concentrated \nslug of contaminant ( Figure 5). \n\nGMS Tutorials   MT3DMS \u2013 Advanced Transport  \n \n Page 8 of 13 \u00a9 Aquaveo 2024   \n      Figure 5      Last time step, showing contaminants still concentrated together  \n4 Adding Dispersion  \nNow add dispersion to the simulation to see how it affects the results.  \n4.1 The Dispersion Package  \nDo the following to enter the data for the Dispersion package:  \n1. Select MT3DMS | Dispersion Package\u2026  to open the Dispersion Package \ndialog.  \n2. Click Longitudinal Dispersivity\u2026  to open the Longitudinal Dispersivity dialog.  \n3. Click Constant \u2192 Grid\u2026  to open the Grid Value dialog.  \n4. Enter  \u201c20.0\u201d as the Constant value for grid  and click OK to close the Grid Value  \ndialog.  \n5. Click OK to exit the Longitudinal Dispersivity  dialog.  \n6. In the spreadsheet on row 1, enter \u201c0.2\u201d in both the TRPT  and TRVT  columns.  \n7. Click OK to exit the Dispersion Package  dialog.  \n4.2 Saving the Simulation and Running MT3DMS  \nSave the simulation under a different name and run MT3DMS.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cdispersion.gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n5. Click Run MT3DMS   to bring up the MT3DMS  model wrapper dialog.  \n6. When MT3DMS finishes, turn on Read solution on exit .  \n7. Click Close  to import the solution and exit the MT3DMS  dialog.  \n\nGMS Tutorials   MT3DMS \u2013 Advanced Transport  \n \n Page 9 of 13 \u00a9 Aquaveo 2024  4.3 Viewing the Solution  \nOnce again, do the following after reading in the solution:  \n1. Select the \u201c  tracer\u201d dataset under the \u201c  dispersion (MT3DMS)\u201d folder  \n2. Select the first time step (18.25) in the Time Step Window.  \n3. Use the up and down arrows on the keyboard to step through the range of time \nsteps associated with the solution.  \nNote that the plume still stays together as before, but spreads out a little more and \ndissipates more ( Figure 6). \n \n      Figure 6      The contaminants dissipate more with dispersion (last time step)  \n5 Adding Sorption  \nWith the simple linear sorption option, the  sorption and de -sorption of the contaminant is \nassumed to be a simple function of the contaminant concentration. The relationship \nbetween concentration and sorbed mass is defined by a linear isotherm. This theory \nassumes that the sorption is instantaneous . By contrast, a rate -limited sorption option is \nalso available.  \nTurning on sorption has the effect of slowing the rate that the plume moves through the \nsystem. This effect can be expressed as a retardation factor that represents the ratio of \nthe ground wa ter flow rate to the plume migration rate. The retardation factor is computed \nas follows:  \nnK1Rd\uf072\uf02b\uf03d\n \nwhere:  \n\uf072 = bulk density  \nKd = distribution coefficient (slope of the isotherm)  \nn = porosity  \nd do not necessarily need to match the units used for \nd. The only place \nthat these values are used is in the calculation of R.  \n\nGMS Tutorials   MT3DMS \u2013 Advanced Transport  \n \n Page 10 of 13 \u00a9 Aquaveo 2024  5.1 Editing the Chemical Reaction Package  \nThe sorption options ar e specified in the Chemical Reaction package. Before editing the \npackage data, it must first be turned on:  \n1. Select MT3DMS | Basic Transport Package\u2026  to open the Basic Transport \nPackage dialog.  \n2. Click Packages\u2026  to open the MT3DMS/RT3D Packages dialog.  \n3. Turn on  Chemical reaction package  and click OK to exit the MT3DMS/RT3D \nPackages dialog.  \n4. Click OK to exit the  Basic Transport Package dialog.  \nNow enter the sorption parameters:  \n5. Select MT3DMS | Chemical Reaction Package\u2026  to open the Chemical \nReaction Package dialog . \n6. In the first section, select \u201cLinear isotherm\u201d from the Sorption  drop-down.  \n7. In the second section, enter \u201c1600.0\u201d as the Bulk density .  \nThese units represent [kg/m3]. Note that this does not agree with the standard units for \nthe model, but these units only need to agree with the K d (first sorption constant) units.  \n8. In the spreadsheet, enter \u201c0.0001154\u201d in the tracer  column of the 1st sorption \nconst.  row. \n9. Click OK to exit the Chemical Reaction Package  dialog.  \nNote that these two values should result in a retardation factor of \u201c2.0\u201d.  \n5.2 Saving the Simulation and Running MT3DMS  \nNow save the simulation under a different name and run MT3DMS.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201csorption.gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n5. Click  Run MT3DMS   to bring up the MT3DMS  model wrapper dialog.  \n6. When MT3DMS finishes, turn on Read solution on exit . \n7. Click Close  to import the solution and close the MT3DMS  dialog.  \n5.3 Viewing the Solution  \nReview the times steps in the solution by doing the following:  \n1. Select the \u201c  tracer\u201d dataset under the \u201c  sorption (MT3DMS)\u201d folder.  \n2. Select the first time step (18.25) in the Time Step Window and use the up and \ndown arrows on the keyboard to step through the range of time steps associated \nwith the solution.  \n\nGMS Tutorials   MT3DMS \u2013 Advanced Transport  \n \n Page 11 of 13 \u00a9 Aquaveo 2024  Note that the plume sti ll stays together as before, but spreads out a little more and \ndissipates more. The final step should be similar to the previous solution in Figure 6. \n6 Simulating Dual Domain Transport  \nFinally, turn on the dual domain transport option. The theory behind dual domain \ntransport is that there are two distinct domains in a transport simulation: the mobile \ndomain (the cracks and fissures where the majority of a dvective flow occurs) and the \nimmobile domain (the unfractured mass of the aquifer where the primary transport \nmechanism is dispersion/diffusion). The dual domain option makes it possible to specify \nseparate transport parameters for each of these domains. Numerous case studies have \nshown that a dual domain simulation may improve calibration and better represent field \nconditions.  \nTo better illustrate the effect of the dual domain option, turn off the sorption option.  \n6.1 Viewing the Solution  \nThe dual domain opti on is accessed by editing the options in the Chemical Reaction \npackage.  \n1. Select MT3DMS | Chemical Reaction Package\u2026  to bring up the Chemical \nReaction Package  dialog.  \n2. In the first section, select \u201cDual -domain mass transfer (without sorption)\u201d from the \nSorpti on drop-down.  \n3. Select Cell by cell  for the Variable input  option.  \nThis allows specifying a unique value for the immobile phase initial condition in the four \ncells where the plume is initially defined. Next, edit the porosity for the immobile phase. \nThis por osity is generally smaller than the porosity used in the mobile phase.  \n4. In the second section, click the Edit\u2026  button to the right of Immobile porosity  to \nbring up the Immobile Porosity Array  dialog.  \n5. Click Constant \u2192 Grid\u2026 to open the Grid Value dialog.  \n6. Enter \u201c0.1\u201d as the Constant value for grid  and click OK to close the Grid Value  \ndialog.  \n7. Click OK to exit the Immobile Porosity Array  dialog.  \nNow specify the initial concentration of the immobile phase.  \n8. In the first section, turn on Specify IC of sorbed phase . \n9. In the second section on the IC sorbed phase  row, click the Edit\u2026  button in the \ntracer  column to open the IC of Phase Array  dialog.  \n10. In the array, select cell \u201c5,16\u201d (row 5, column 16) and enter \u201c100.0\u201d.  \n11. Repeat step 10 for cells \u201c5,17\u201d, \u201c6,16\u201d, and \u201c6,17\u201d.  \n12. Click OK to exit the IC of Phase Array  dialog.  \nFinally, enter a value for the coefficient defining the mass transfer rate between the \nmobile and immobile phases.  \n13. Click the Edit\u2026  button in the tracer  column of the 2nd sorption const.  row to \nbring up the Second Sorption Constant Array  dialog.  \nGMS Tutorials   MT3DMS \u2013 Advanced Transport  \n \n Page 12 of 13 \u00a9 Aquaveo 2024  14. Click Constant \u2192 Grid\u2026  to open the Grid Value dialog.  \n15. Enter \u201c0.0005\u201d as the Constant value for grid  and click OK to exit the Grid Value  \ndialog.  \n16. Click OK to exit the Second Sorption Constant Array  dialog.  \n17. Click OK to exit the Chemical Reactions Package  dialog.  \n6.2 Saving the Simulation and Running MT3DMS  \nNow save the simulation under a different name and run MT3DMS.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d f rom the Save as type  drop-down.  \n3. Enter \u201cdualdomain.gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n5. Select MT3DMS | Run MT3DMS\u2026  to bring up the MT3DMS  dialog.  \n6. When MT3DMS finishes, turn on Read solution on exit . \n7. Click Close  to import the solution and close the MT3DMS  dialog.  \n6.3 Viewing the Solution  \nTo review the solution:  \n8. Select the \u201c  tracer\u201d dataset under the \u201c  dual domain (MT3DMS)\u201d folder.  \n9. Select the first time step (18.25) in the Time Step Window and use the up and \ndown arrows to view the different time steps.  \nThe result should show a prolonged tail indicating a \u201cbleeding pattern\u201d due to the \ncontaminant migrating from the immobile phase ( Figure 7). \n \n      Figure 7      Prolonged contaminant tail on last time step of tracer dataset  \nFeel free to review the time steps for both the \u201c  tracer\u201d and the \u201c  tracer (sorbed)\u201d  \ndatasets to see how the simulation is affected over time. If desired, change the value of \nrate constant (second sorption constant) from 0.0005 to 0.0009 and compare the profiles \nfor various mass -transfer constants  \n\nGMS Tutorials   MT3DMS \u2013 Advanced Transport  \n \n Page 13 of 13 \u00a9 Aquaveo 2024  7 Conclusion  \nThis concludes the \u201c MT3DMS \u2013 Advanced Transport \u201d tutorial. The following key concepts \nwere demonstrated and discussed in this tutorial:  \n\uf0b7 How to do a simple tracer simulation with MT3DMS.  \n\uf0b7 How to add dispersion to a transport simula tion. \n\uf0b7 How to add sorption to a transport simulation , and how to compute the \nretardation factor for a particular set of sorption coefficients.  \n\uf0b7 How to perform a dual -domain transport simulation.  \n \n", "filename": "MT3DMS-AdvancedTransport.pdf", "pages": 13}, "MT3DMS-ConceptualModelApproach": {"text": "GMS Tutorials   MT3DMS \u2013 Conceptual Model Approach  \n Page 1 of 13 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMT3DMS \u2013 Conceptual Model Approach  \nUsing MT3DMS  with a conceptual model  \n \nObjectives   \nLearn how to use a conceptual model when using MT3DMS. Perform two transport simulations, analyzing \nthe long -term potential for migration of leachate from a landfill.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach I  \n\uf0b7 MT3DMS \u2013 Grid Approach  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 MT3D  \n Time  \n\uf0b7 30\u201350 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MT3DMS \u2013 Conceptual Model Approach  \n Page 2 of 13 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 Importing the Project  ................................ ................................ ................................ ..... 3 \n2.2 Defining the Units  ................................ ................................ ................................ .........  3 \n3 Initializing the MT3DMS Simulation  ................................ ................................ ...................  4 \n3.1 Defining the Species  ................................ ................................ ................................ ..... 4 \n3.2 Defining the Stress Periods  ................................ ................................ ..........................  4 \n3.3 Setting the Output Control  ................................ ................................ ............................  4 \n3.4 Selecting the Packages  ................................ ................................ ................................  5 \n4 Assigning the Aquifer Properties  ................................ ................................ .......................  5 \n4.1 Turning on Transport  ................................ ................................ ................................ .... 5 \n4.2 Assigning the Parameters to the Polygons  ................................ ................................ ... 6 \n4.3 Assigning the Parameters to the Polygons  ................................ ................................ ... 6 \n5 Converting the Conceptual Model ................................ ................................ ......................  7 \n6 Additional Options for MT3DMS  ................................ ................................ .........................  7 \n6.1 Layer Thicknesses  ................................ ................................ ................................ ........  7 \n6.2 The Advection Package  ................................ ................................ ................................  7 \n6.3 The Dispersion Package  ................................ ................................ ...............................  7 \n6.4 The Transport Observation Package  ................................ ................................ ............  7 \n6.5 The Source/Sink Mixing Package Dialog  ................................ ................................ ...... 8 \n7 Saving and Running MODFLOW and MT3DMS  ................................ ................................ . 8 \n7.1 Running MODFLOW  ................................ ................................ ................................ ..... 8 \n7.2 Running MT3DMS  ................................ ................................ ................................ ........  8 \n8 Viewing the Solution  ................................ ................................ ................................ ...........  8 \n8.1 Generating a Mass vs Time Plot  ................................ ................................ ...................  9 \n8.2 Viewing an Animation  ................................ ................................ ................................ . 10 \n9 Modeling Sorption and Decay  ................................ ................................ ..........................  10 \n9.1 Turning on the Chemical Reactions Package  ................................ .............................  10 \n9.2 Entering the Sorption and Biodegradation Data  ................................ .........................  11 \n9.3 Run Options  ................................ ................................ ................................ ................  11 \n10 Saving and Running MT3DMS  ................................ ................................ ..........................  11 \n11 Viewing the Solution  ................................ ................................ ................................ .........  12 \n11.1  Run Options  ................................ ................................ ................................ ................  12 \n12 Conclusion  ................................ ................................ ................................ .........................  13 \n \n1 Introduction  \nMT3DMS simulations can be constructed using the grid approach, where data are \nentered on a cell -by-cell basis. They can also be constructed using the conceptual model \napproach, where the data are entered via points, arcs, and polygons. This  tutorial \ndescribes how to use the conceptual model approach.  \nThe problem for this tutorial is an extension of the problem described in the tutorial \nentitled \u201c MODFLOW \u2013 Conceptual Model Approach  I\u201d. It is recommended that tutorial be \ncompleted before conti nuing.  \nIn that tutorial, a site in East Texas was modeled. This tutorial uses the solution from that \nmodel as the flow field for the transport simulation. This model included a proposed \nlandfill. For this tutorial, two transport simulations will be run to analyze the long -term \npotential for migration of leachate from the landfill. The first simulation will be modeling \ntransport due to advection and dispersion only. The second simulation will include \nsorption and decay in addition to advection.  \nThis tutorial  will discuss and demonstrate opening a MODFLOW model and solution, \ndefining conditions for an MT3DMS simulation, converting the conceptual model to \nMT3DMS, running MODFLOW, and running MT3DMS. It will then demonstrate creating \nan animation, defining addit ional parameters and rerunning MT3DMS, and creating a \ntime series plot.  \nGMS Tutorials   MT3DMS \u2013 Conceptual Model Approach  \n \n Page 3 of 13 \u00a9 Aquaveo 2024  2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their defau lt state.  \n2.1 Importing the Project  \nThe first step is to import the East Texas project, which includes the MODFLOW model \nand solution and all other files associated with the model.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from t he Files of type  drop-down.  \n3. Browse to the mt3dmap \\mt3dmap \\ directory and select \u201cstart.gpr\u201d.  \n4. Click Open  to import the project and exit the Open  dialog.  \nThe imported model should appear similar to Figure 1. \n \n      Figure 1      Initial model after importing  \n2.2 Defining the Units  \nNext, define the units for mass and concentration. Do not change the length and time \nunits as these must be consistent with the flow model.  \n1. Select Edit | Units\u2026  to open the Units dialog.  \n2. Select \u201ckg\u201d from the Mass  drop-down.  \n3. Select \u201cppm\u201d from the Concentra tion drop-down.  \n4. Click OK to close the Units  dialog.  \n\nGMS Tutorials   MT3DMS \u2013 Conceptual Model Approach  \n \n Page 4 of 13 \u00a9 Aquaveo 2024  3 Initializing the MT3DMS Simulation  \nNow that the MODFLOW model imported, initialize the MT3DMS simulation.  \n1. Fully expand the \u201c  3D Grid Data\u201d folder if necessary.  \nRight -click on \u201c  grid\u201d and select New MT3DMS \u2026 to open the Basic Transport Package \ndialog.  \n3.1 Defining the Species  \nMT3DMS is a multi -species model, so define the number of species and name each one. \nIn this case, there is only one species.  \n1. Click Define Species\u2026  to open the Define Species dialog.  \n2. Click New to add a new species to the spreadsheet.  \n3. Enter \u201cleachate\u201d in the Name  column.  \n4. Click OK to close the Define Species  dialog.  \n3.2 Defining the Stress Periods  \nNext, define the stress periods.  \n1. Click Stress Periods\u2026  to open the Stress Periods dialog.  \nIn this case, the flow solution computed by MODFLOW is steady state. Therefore, any \ndesired sequence of stress periods and time steps could be defined. For this tutorial, only \none stress period is needed because the leachate from the landfill will be released  at a \nconstant rate. Enter the length of the stress period (i.e., the length of the simulation) and \nlet MT3DMS compute the appropriate transport time step length by leaving the transport \nstep size at zero.  \n2. On row 1, enter \u201c15000.0\u201d in the Length  column.  \n3. Enter \u201c10\u201d in the Num Time Steps  column.  \nClick OK to exit the Stress Periods  dialog.  \n3.3 Setting the Output Control  \nBy default, MT3DMS outputs a solution at every transport step. This results in a large \noutput file, so change the output to write a solution every  time step (every 300 days).  \n1. Click Output Control\u2026  to open the Output Control dialog.  \n2. Select Print or save at specified times.  \n3. Click Times\u2026  to open the Variable Time Steps dialog.  \n4. Click Initialize Values\u2026  to open the Initialize Time Steps dialog.  \n5. Enter \u201c50 0.0\u201d as the Initial time step size . \n6. Enter \u201c1.0\u201d as the Bias. \n7. Enter \u201c500.0\u201d as the Maximum time step size . \n8. Enter \u201c15000.0\u201d as the Maximum simulation time . \n\nGMS Tutorials   MT3DMS \u2013 Conceptual Model Approach  \n \n Page 5 of 13 \u00a9 Aquaveo 2024  9. Click OK to close the Initialize Time Steps  dialog.  \n10. Click OK to close the Variable Time Steps  dialog.  \n11. Click OK to close the Output Control  dialog.  \n3.4 Selecting the Packages  \nNext, specify which of the MT3DMS packages to use.  \n1. Click Packages\u2026  to open the MT3DMS/RT3D Packages dialog.  \n2. Turn on Advection package, Dispersion package, Source/sink mixing package, \nand T ransport observation package.  \n3. Click OK to close the MT3DMS/RT3D Packages  dialog.  \nNote that the Basic Transport Package  dialog also includes some layer data. This tutorial \nwill address the data for these arrays at a latter point.  \n4. Click OK to exit the Basic Transport Package  dialog.  \n4 Assigning the Aquifer Properties  \nMT3DMS requires that a porosity and dispersion coefficient be defined for each of the \ncells in the grid. While these values can be assigned directly to the cells, it is sometimes \nconvenient to assi gn the parameters using polygonal zones defined in the conceptual \nmodel. The parameters are converted to the grid cells using the Map \u2192 MT3DMS  \ncommand.  \n4.1 Turning on Transport  \nDo the following to assign the porosities and dispersion coefficients to the polygo ns: \n1. Fully expand the \u201c  Map Data\u201d folder, if necessary.  \n2. Right -click on the \u201c  East Texas\u201d conceptual model and select Properties\u2026  to \nopen the Conceptual Model Properties  dialog.  \n3. In the spreadsheet, check the box to the right of Transport .  \n4. Select \u201cMT3DMS / MT3D -USGS\u201d from the Transport model  drop-down.  \n5. Click Define Species\u2026  on the Species  row to open the Define Species dialog.  \n6. Click New to create a new species.  \n7. Enter \u201cleachate\u201d in the Name  column.  \n8. Click OK to close the Define Species  dialog.  \n9. Click OK to exit the Conceptual Model Properties  dialog.  \n10. Right -click on \u201c  Layer 1\u201d and select Coverage Setup\u2026  to open the Coverage \nSetup dialog.  \n11. In the Areal Properties section, turn on Porosity and Long. dispersivity.  \n12. Click OK to close the Coverage Setup  dialog . \n13. Repeat steps 10 \u201312 for the \u201c  Layer 2\u201d coverage.  \n\nGMS Tutorials   MT3DMS \u2013 Conceptual Model Approach  \n \n Page 6 of 13 \u00a9 Aquaveo 2024  4.2 Assigning the Parameters to the Polygons  \nTo assign the porosities and dispersion coefficients to the polygons:  \n1. Select \u201c  Layer 1\u201d to make it active.  \n2. Using the Select Polygons   tool, double -click on the layer polygon to open \nthe Attribute Table dialog.  \n3. On row 1, enter \u201c0.3\u201d in the Porosity  column.  \n4. Enter \u201c20.0\u201d in the Long. disp.  column.  \n5. Click OK to close the Attribute Table  dialog.  \n6. Select \u201c  Layer 2\u201d to make it active.  \n7. Repeat st eps 2 \u20135, but enter \u201c0.2\u201d in the  Porosity  column.  \nClick anywhere outside the model to deselect the highlighted polygon . \n4.3 Assigning the Parameters to the Polygons  \nThe purpose of this model is to simulate the transport of contaminants emitted from the \nlandfill. When the flow model was constructed, a separate, reduced value of recharge \nwas assigned to the landfill site. This recharge represents leachate from the landfill, and \na concentration needs to be assigned to this recharge. The concentration can be  \nassigned directly to the recharge polygon in the conceptual model.  \n1. Right -click on the \u201c  Recharge\u201d coverage and select Coverage Setup\u2026  to \nopen the Coverage Setup dialog.  \n2. In the Areal Properties column, turn on Recharge conc.  \n3. Click OK to close the Coverag e Setup  dialog.  \n4. Select \u201c  Recharge\u201d to make it active.  \n5. Using the Select Polygons   tool, double -click on the landfill polygon (shown in \nFigure 2 below ) to open the Attribute Table dialog.  \n \n\nGMS Tutorials   MT3DMS \u2013 Conceptual Model Approach  \n \n Page 7 of 13 \u00a9 Aquaveo 2024  Figure 2      Landfill polygon selected  \n6. Enter \u201c20000.0\u201d in the leachate Recharge conc.  column.  \n7. Click OK to close the Attribute Table  dialog.  \nClick anywhere outside the model to deselect the polygon.  \n5 Converting  the Conceptual Model  \nAt this point, it is possible to assign the aquifer parameters and the recharge \nconcentration to the cells using the conceptual model.  \n1. Select Feature Objects | Map \u2192 MT3DMS  to bring up the Map \u2192 Model  dialog.  \n2. Select All applicable coverages and click OK to close the Map \u2192 Model  dialog.  \n6 Additional Options for MT3DMS  \n6.1 Layer Thicknesses  \nMT3DMS requires an HTOP array defining the top elevations of the uppermost aquifer to \ndefine the aquifer geometry. A thickness arr ay must then be entered for each layer. With \nthe layer geometry defined in the MODFLOW model, no further input is necessary.  \n6.2 The Advection Package  \nThis tutorial uses the Third Order TVD scheme (ULTIMATE)  solver for the Advection \npackage . This is the defaul t, so nothing needs to be done.  \n6.3 The Dispersion Package  \nThe longitudinal dispersivity values were automatically assigned from the conceptual \nmodel. Only the remaining three parameters need to be entered.  \n1. Select MT3DMS  | Dispersion Package\u2026  to open the Dispersion Package \ndialog.  \n2. On both rows 1 and 2, enter \u201c0.2\u201d in the TRPT  column.  \n3. On both rows 1 and 2, enter \u201c0.1\u201d in the TRVT  column.  \n4. On both rows 1 and 2, enter \u201c0.0\u201d in the DMCOEF  column.  \n5. Click OK to exit the Dispersion Package  dialog.  \n6.4 The Transport Obs ervation Package  \nThis package determines the mass flux into the river source/sink.  \n1. Select MT3DMS  | Transport Observation Package\u2026  to open the Transport \nObservation Package  dialog.  \n2. Turn off Compute concentrations at observation points . \n3. Turn on Compute mass flux at source/sinks . \nGMS Tutorials   MT3DMS \u2013 Conceptual Model Approach  \n \n Page 8 of 13 \u00a9 Aquaveo 2024  4. Click OK to exit the Transport Observation Package  dialog.  \n6.5 The Source/Sink Mixing Package Dialog  \nThe only data for the source/sink mixing package required in this package for this \nsimulation are the concentrations assigned to the recharge from the landfill. These values \nwere automatically assigned to the appropriate cells from the conceptual model, so the \ninput data for this package are complete.   \n7 Saving and Running MODFLOW and MT3DMS  \nNow that the MT3DMS data has been completely en tered, save the model before running \nthe simulations.  \n1. Select File | Save As\u2026 to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201crun1.gpr\u201d as the File name . \n4. Click Save  to save it under the new name and close the Save As  dialog.  \n7.1 Running MODFLOW  \nMT3DMS requires the HFF file generated by MODFLOW. Because the project was saved \nin a different folder than the one where the MODFLOW simulation was opened, the HFF \nfile does not exist in the new location. MODFLOW must be rerun to create the HFF file in \nthe current folder.  \nTo run MODFLOW, do the following:  \n1. Click  Run MODFLOW  to bring up the MODFLOW  model wrapper dialog . \n2. When the simulation finishes, turn on Read solution on exit a nd Turn on contours \n(if not on already).  \n3. Click Close  to import the solution and close the MODFLOW  dialog.  \n4. Save   the project.  \n7.2 Running MT3DMS  \nNow to run MT3DMS:  \n1. Click Run MT3DMS   to bring up the MT3DMS  model wrapper dialog.  \n2. When the simulation is finished,  turn on Read solution on exit . \n3. When the simulation is finished, click Close  to import the solution and close the \nMT3DMS  dialog.  \n4. Save   the project.  \n8 Viewing the Solution  \nNow view the results of the MT3DMS model run.  \n\nGMS Tutorials   MT3DMS \u2013 Conceptual Model Approach  \n \n Page 9 of 13 \u00a9 Aquaveo 2024  1. Expand \u201c  run1 (MT3DMS)\u201d and select the \u201c  leachate\u201d dataset.  \n2. Select time step \u201c30 (15000.0)\u201d in the Time Step Window.  \nA display of color -shaded contours confined to the area adjacent to the landfill should be \nvisible ( Figure 3).  \n \n      Figure 3      Leachate dispersion from the landfill at the end of the simulation  \nDo the following to view the solution for layer two in cross section v iew: \n3. Select a cell that has some leachate dispersion in the vicinity of the landfill.  \n4. Switch to Side View  . \n5. Use the up and down arrows in the Mini Grid Toolbar to view the \nsolution along different columns.  \n6. When finished, switch to Plan View  . \nNote that the leachate eventually reaches the river and the well. Now view the mass flux \nof leachate into the river that was computed with the transport observation package.  \n7. Select the \u201c  Sources&Sinks\u201d coverage to make it active.  \n8. Using the Select Arcs   tool, select the specified head arc along the bottom of \nthe model. The computed mass flux is reported along the bottom of the window.  \n8.1 Generating a Mass vs Time Plot  \nA plot of Mass vs. Time for a selected feature object can be created and viewed by doing \nthe foll owing:  \n1. Make sure that you still have the head arc at the bottom -right of the model \nselected. If it is not selected, use the  Select Arcs  tool to select it.  \n1. Click Plot Wizard   to bring up the Step 1 of 2  page of the Plot Wizard  dialog . \n2. Select \u201cMass vs. Ti me\u201d from the list on the left.  \n3. Click Finish  to create the plot and close the Plot Wizard  dialog.  \n\nGMS Tutorials   MT3DMS \u2013 Conceptual Model Approach  \n \n Page 10 of 13 \u00a9 Aquaveo 2024  The plot shows the mass flux that leaves the model through the selected river arc.  \n4. Close  the plot window and maximize  the GMS Graphics Window.  \n5. Frame   the project to resize the view of the model grid.  \n8.2 Viewing an Animation  \nNext, observe how the solution changes over the course of the simulation by generating \nan animation. Do the following to set up the animation:  \n1. Select the \u201c  leachate\u201d dataset in the Pr oject Explorer.  \n2. Select Display | Animate\u2026  to bring up the Options  page of the Animation Wizard \ndialog.  \n3. In the Options  section, turn on Dataset . \n4. Next to Animation file , click the browser button  to open the Save  dialog.  \n5.  Enter \u201crun1.mp4\u201d as the File name . \n6.  Make certain the Save as type  is set to \u201cAnimation files (*.mp4,8.avi)\u201d.  \n7. Select Save  to exit the Save  dialog.  \n8. Click Next  to go to the Datasets  page of the Animation Wizard  dialog.  \n9. Turn on Display clock . \n10. Click Finish  to close the Animation Wizard  dialog  \nIf desired, open the MP4 file in an media player application outside of GMS.  \n9 Modeling Sorption and Decay  \nThe solution that was just computed can be thought of as a worst -case scenario because \nsorption and decay were neglected. Sorption will retard the movem ent of the plume and \ndecay (due to biodegradation) will reduce the concentration. For the second part of the \ntutorial, modify the model so that sorption and decay are simulated. Then compare this \nsolution with the first solution.  \n9.1 Turning on the Chemical Re actions Package  \nSorption and decay are simulated in the Chemical Reactions Package . This package \nmust be turned on before it can be used.  \n1. Select MT3DMS | Basic Transport Package\u2026  to open the Basic Transport \nPackage dialog.  \n2. Click Packages\u2026  to open the MT3DM S/RT3D Packages dialog.  \n3. Turn on Chemical reaction package.  \n4. Click OK to exit the MT3DMS/RT3D Packages  dialog.  \n5. Click OK to exit the Basic Transport Package  dialog.  \n\nGMS Tutorials   MT3DMS \u2013 Conceptual Model Approach  \n \n Page 11 of 13 \u00a9 Aquaveo 2024  9.2 Entering the Sorption and Biodegradation Data  \nNext, enter the sorption and biodegradation data in the Chemical Reactions  Package  \ndialog.  \n1. Select MT3DMS | Chemical Reaction Package\u2026  to bring up the Chemical \nReaction Package  dialog.  \n2. Select \u201cLinear isotherm\u201d from the Sorption  drop-down.  \n3. Select \u201cFirst -order irreversible kinetic reaction\u201d from the Kinetic rate reaction  \ndrop-down.  \n4. Enter \u201c1\u201d as the Layer . \n5. Enter \u201c53500.0\u201d as the Bulk density . \n6. In the spreadsheet, enter \u201c5.85e -006\u201d in the leachate  column of the 1st sorption \nconst.  row. \n7. Enter \u201c0. 0001\u201d in the leachate  column on both the Rate const. (dissolved)  and \nthe Rate const. (sorbed)  rows.  \n8. Enter \u201c2\u201d as the Layer . \n9. Enter \u201c51500.0\u201d as the Bulk density . \n10. In the spreadsheet, enter \u201c5.85e -006\u201d in the leachate  column of the 1st sorption \nconst.  row. \n11. Enter \u201c0.00005\u201d in the leachate  column on both the Rate const. (dissolved)  and \nthe Rate const. (sorbed)  rows.  \n12. Click OK to exit the Chemical Reaction Package  dialog.  \n9.3 Run Options  \nIt is nearly time to save the project under a new file name. However, the problem  \ndescribed earlier with the HFF file will be an issue because MT3DMS will look for a HFF \nfile with the same name as the one about to be used to save the project. Because that file \ndoes not exist, MODFLOW could be rerun to create it. Another way to address the issue \nis by doing the following:  \n1. Select MT3DMS | Run Options\u2026  to bring up the Run Options  dialog.  \n2. Select Single run with selected MODFLOW  solution.  \n3. Select \u201crun1 (MODFLOW)\u201d from the drop -down.  \n4. Click OK to close the Run Options  dialog  \nWith this option, GMS tells MT3DMS to use the HFF file that was generated previously.  \n10 Saving and Running MT3DMS  \nIt is now possible to save the new simulation.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201crun2.gpr\u201d as the File name . \n4. Click Save  to save the project with the new name and close the Save As  dialog.  \nGMS Tutorials   MT3DMS \u2013 Conceptual Model Approach  \n \n Page 12 of 13 \u00a9 Aquaveo 2024  5. Select MT3DMS | Run MT3DMS\u2026  to bring up the MT3DMS  model wrapper \ndialog.  \n6. When the simulation is finished, turn on Read solution on  exit. \n7. Click Close to import the solution and close the MT3DMS  dialog.  \nNotice again that it is possible to view the sorbed dataset.  \n11 Viewing the Solution  \nAfter the simulation finishes and the solution is read into GMS:  \n1. Select the \u201c  leachate\u201d dataset under the \u201c  run2 (MT3DMS)\u201d in the Project \nExplorer.  \n2. In the Time Step list below the Project Explorer , select the last time step.  \nNotice that at the end of the simulation the plume is smaller and less advanced than the \nsame time step in the first simulation ( Figure 4). \n \n      Figure 4      Last time step in run2  \n11.1 Run Options  \nA useful way to compare two transient solutions is to generate a time history plot. The \nfastest way to do this is to create an \u201cActive Dataset Time Series\u201d plot.  \n1. Click  Plot Wizard   to bring up the Step 1 of 2  page of the Plot Wizard  dialog . \n2. Select \u201cActive Dataset Time Series\u201d from the list on the left.  \n3. Click Finish  to generate the plot and close the Plot Wizard  dialog.  \n4. Move the Active Dataset Time Series  window so the main GMS window is not \nhidden.  \n5. Select a cell in the grid near the landfill. Notice that the plot shows the \nconcentration v. time.  \n6. Select a  different cell and notice that the plot updates. If no cell is selected, then \nthe plot will not show any data. However, if a selection was made and then is \ndeselected, the data for the last selection will remain in the plot.  \n\nGMS Tutorials   MT3DMS \u2013 Conceptual Model Approach  \n \n Page 13 of 13 \u00a9 Aquaveo 2024  To export the plot data and pu t it into a spreadsheet program:  \n7. Right -click on the plot and select View Values\u2026  to bring up the View Values  \ndialog.  \n8. Select the desired data and press Ctrl-C. \n9. Go into the desired spreadsheet program, select a cell, and press Ctrl-V to paste \nthe copied data.  \n10. Back in GMS, click Close  to exit the View Values  dialog.  \n \n \n \n12 Conclusion  \nThis concludes the \u201cMT3DMS \u2013 Conceptual Model Approach\u201d tutorial. The following key \nconcepts were discussed and demonstrated in this tutorial:  \n\uf0b7 If starting wit h a MODFLOW conceptual model and wanting to do a transport \nmodel, first turn on transport in the conceptual model properties.  \n\uf0b7 It is possible to use the MT3D MS | Run Options \u2026 command  to tell MT3DMS \nwhich MODFLOW solution to use.  \nContinue experimenting with MT3DMS or close the program.  \n \n", "filename": "MT3DMS-ConceptualModelApproach.pdf", "pages": 13}, "MT3DMS-GridApproach": {"text": "GMS  Tutorials   MT3DMS \u2013 Grid Approach  \n \n Page 1 of 10 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMT3DMS \u2013 Grid Approach  \nCreate an MT2DMS model using the grid approach  \n \nObjectives   \nConstruct a MT3DMS model using the grid approach. Values are manually assigned to the grid. Simple \nmodels can be easily constructed using the grid approach.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Grid \nApproach  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 MT3D  \n Time  \n\uf0b7 15\u201325 minutes  \n \nGMS 10. 8 \n\nGMS  Tutorials   MT3DMS \u2013 Grid Approach  \n \n Page 2 of 10 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 The Flow Model  ................................ ................................ ................................ ............  3 \n3 The MT3DMS Basic Transport Package  ................................ ................................ ............  4 \n3.1 Species  ................................ ................................ ................................ .........................  5 \n3.2 Packages  ................................ ................................ ................................ ......................  5 \n3.3 Stress Periods  ................................ ................................ ................................ ..............  5 \n3.4 Output Control  ................................ ................................ ................................ ..............  5 \n3.5 ICBUND Array  ................................ ................................ ................................ ..............  6 \n3.6 Starting  Concentration Array ................................ ................................ .........................  6 \n3.7 HTOP and Thickness Arrays  ................................ ................................ ........................  6 \n3.8 Porosity Array  ................................ ................................ ................................ ...............  6 \n4 Setting up the Packages  ................................ ................................ ................................ ..... 6 \n4.1 The Advection Package  ................................ ................................ ................................  6 \n4.2 The Dispersion Package  ................................ ................................ ...............................  6 \n4.3 The Source/Sink Mixing Package  ................................ ................................ .................  7 \n5 Saving and Running MT3DMS  ................................ ................................ ............................  7 \n6 Viewing the Solution  ................................ ................................ ................................ ...........  8 \n6.1 The Source/Sink Mixing Package  ................................ ................................ .................  8 \n6.2 Setting Up an Animation  ................................ ................................ ...............................  9 \n6.3 Calculating the Mass of the Contaminant  ................................ ................................ ... 10 \n7 Conclusion  ................................ ................................ ................................ .........................  10 \n \n1 Introduction  \nThis tutorial describes how to perform an MT3DMS  simulation within GMS. An MT3DMS \nmodel can be constructed in GMS using one of two approaches: the conceptual model \napproach or the grid approach.  \nWith the conceptual model approach, the sources/sinks and zones in the model are \ndefined with GIS objects and  automatically assigned to the grid. With the grid approach, \nvalues are manually assigned to the grid. While the conceptual model approach is \ngenerally preferable for large, complicated models, simple models can be easily \nconstructed using the grid approac h. The grid approach is described in this tutorial.  \nThe problem in this tutorial ( Figure 1) corresponds to a sample problem described in the \nMT3DMS  documentation.1 The problem consists of a low K zone inside a larger zone. \nThe sides of the region are no flow boundaries. The top and bottom are constant head \nboundaries that cause the flow to move from the top to the bottom of the region. An \ninjection well with a specifie d concentration provides the source of the contaminants. A \npumping well serves to withdraw contaminated water migrating from the injection well. A \nsteady state flow solution will be computed, and a transient transport simulation will be \nperformed over a on e-year period.  \nThis tutorial discusses and demonstrates opening a MODFLOW simulation and running \nMODFLOW, initializing MT3DMS and entering the data for several MT3DMS packages, \nrunning MT3DMS and importing the solution, setting up an animation to visualize  the \nsolution, and calculating the mass of the contaminant.  \n                                                      \n1 Zheng, Chunmiao and Wang, P. Patrick (December 1999). \u201cA Two -Dimensional  Application \nSample\u201d in MT3DMS: A Modular Three -Dimensional Multispecies Transport Model for Simulation of \nAdvection, Dispersion, and Chemical Reactions of Contaminants in Groundwater Systems; \nDocumentation and User\u2019s Guide , Strategic Environmental Research and Development Program \n(SERDP), U.S. Ar my Corps of Engineers, Contract Report SERDP -99-1, pp. 152 -154. \nhttp://hydro.geo.ua.edu/mt3d/mt3dmanual.pdf  \nGMS Tutorials   MT3DMS \u2013 Grid Approach  \n \n Page 3 of 10 \u00a9 Aquaveo 2024  \nConstant head boundary (H=250 m) (flow model)\nNo mass flux boundary (transport model)\nHyd. Cond. =\n1.474x10-7m/s\nLOW K ZONEINJECTION WELL\nQ = 0.001 m3/s\nC = 57.87 ppm\nPUMPING WELL\nConstant head boundary (H = 36.25 m)Number of rows = 40\nNumber of columns = 32\nAquifer thickness = 10 m\nK = 1.474x10-4 m/s\nPorosity = 0.3\nLongitudinal dispersivity = 20 m\nDispersivity ratio = 0.2\nSimulation time = 1.0 yr\nDX = 1600 mQ = -0.0189 m3/sDY = 2000 mNo flow boundary\n(flow model)\nNo mass flux\nboundary\n(transport model)No flow boundary\n(flow model)\nNo mass flux\nboundary\n(transport model) \n      Figure 1      Sample flow and transport problem  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is  already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2.1 The Flow Model  \nBefore setting up an MT3DMS simulation, a MODFLOW simulation must exist. The \nMODFLOW solution is used as the flow field for the transport simulation. In the interest of \ntime, import a previously created MODFLOW simulation.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the mt3dgrid \\mt3dgrid \\ directory and select \u201c mt3dgrid.gpr \u201d. \n4. Click Open  to import the project and exit the Open  dialog.  \nNow save the project under a new name. Because the name is changing, MODFLOW \nmust be run again to compute solution files with the new name. Otherwise, when \nMT3DMS runs, it will look for solution files with the new name and not find any.  \n5. Select File | Save As\u2026  to bring up the Save As  dialog.  \n\nGMS Tutorials   MT3DMS \u2013 Grid Approach  \n \n Page 4 of 10 \u00a9 Aquaveo 2024  6. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n7. Enter  \u201ctransport.gpr \u201d as the File name . \n8. Click Save  to save the project with a new name and close the Save As  dialog.  \n9. Select \u201c  3D Grid Data\u201d in the Project Explorer to make it active.  \n10. Click Run MODFLOW   to bring up the MODFLOW  model wrapper dialog.  \n11. When it finishes running, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n12. Click Close  to import the solution and exit the MODFLOW  dialog.   \n13. Click Contour Options   to open the Dataset Contour Options \u2013 3D Grid \u2013 \ntracer dialog.  \n14. Select \u201cLinear\u201d from the first drop -down in the Contour method  section.  \nThe model  should appear similar to Figure 2. \n \n      Figure 2      Model contours after MODFLOW run  \n3 The MT3DMS Basic Transport Package  \nWith a flow solution, it is possible to set up the MT3DMS transport simulat ion. Like \nMODFLOW , MT3DMS  is structured in a modular fashion and uses a series of packages \nas input. Consequently, the GMS interface to MT3DMS  is similar to the interface to \nMODFLOW and will follow a similar sequence of steps to enter the input data.  \nFirst, initialize the MT3DMS simulation.  \n1. Fully expand the \u201c  3D Grid Data\u201d folder.  \n\nGMS Tutorials   MT3DMS \u2013 Grid Approach  \n \n Page 5 of 10 \u00a9 Aquaveo 2024  2. Right -click on \u201c  grid\u201d and select New MT3DMS \u2026 to open the Basic Transport \nPackage dialog.A  warning dialog will appear saying, that this action will delete all \ncurrent MT3DMS data. Select OK. \nThe MT3DMS options in the  Basic Transport Package  dialog are always required to be \nset. They define basic information such as stress periods, active/inacti ve regions, and \nstarting concentration values.  \n3.1 Species  \nSince MT3DMS is a multi -species model, it is necessary to define the number of species \nand name each species.  \n1. Click Define Species\u2026  to open the Define Species dialog.  \n2. Click New to create a new species.  \n3. Enter \u201ctracer\u201d in the Name  column.  \n4. Click OK to close the Define Species  dialog.  \n3.2 Packages  \nNext, select which packages to use.  \n1. Click Packages\u2026  to open the MT3DMS/RT3D Packages dialog.  \n2. Turn on Advection package , Dispersion package , and Source/sink mixing \npackage.  \n3. Click OK to close the MT3DMS/RT3D Packages  dialog.  \n3.3 Stress Periods  \nThe next step is to set up the stress periods. The flow simulation was steady state, but \nthe transport simulation will be transient and will run for a one -year period. To do this, u se \na single stress period (since the input values are constant) and allow MT3DMS  to \ndetermine the appropriate transport step size.  \n1. Click Stress Periods\u2026  to open the Stress Periods dialog.  \n2. In row 1, enter \u201c365.0\u201d in the Length  column.  \n3. Enter \u201c0.0\u201d in the Trans. step size  column.  \nA value of zero signifies that MT3DMS  will automatically compute the appropriate \ntransport step size.  \n4. Click OK to exit the Stress Periods  dialog.  \n3.4 Output Control  \nNext, specify the output options.  \n1. Click Output Control\u2026  to open the Outp ut Control dialog.  \n2. Select Print or save at specified interval  and enter \u201c10\u201d in that field.  \nThis outputs a solution at every tenth transport step.  \n3. Click OK to exit the Output Control  dialog.  \n\nGMS Tutorials   MT3DMS \u2013 Grid Approach  \n \n Page 6 of 10 \u00a9 Aquaveo 2024  3.5 ICBUND Array  \nThe ICBUND array is similar to the IBOUND array in MODFLOW. The ICBUND array is \nused to designate active transport cells (ICBUND>0), inactive transport cells \n(ICBUND=0), and constant concentration cells (ICBUND<0). For this problem, all the \ncells are activ e, therefore, no changes are necessary. It is accessible via the ICBUND\u2026  \nbutton.  \n3.6 Starting Concentration Array  \nThe starting concentration array defines the initial condition for the contaminant \nconcentration. In the current problem, the starting concentrati ons are all zero, so the \ndefault is adequate. It is accessible via the  button in the Starting Conc. Per Cell  \ncolumn in the spreadsheet to the right of the Starting Conc. (mg/l)  column.  \n3.7 HTOP and Thickness Arrays  \nMT3DMS uses the HTOP array and a thickness array to determine the layer geometry. \nHowever, the values for these arrays are determined by GMS automatically from the \nMODFLOW layer data, so no input is necessary. They are accessible via the HTOP\u2026  \nbutton.  \n3.8 Porosity Array  \nFinally, define the porosity for  the cells. This problem has a constant porosity of 0.3. This \nis the default value in GMS, so no changes need to be made. It is accessible via the \nPorosity\u2026  button.  \nThis completes the definition of the Basic Transport package data.  \n1. Click OK to exit the Basic Transport Package  dialog.  \n4 Setting up the Packages  \n4.1 The Advection Package  \nThe next step is to enter the data for the Advection package. This tutorial will use the \nThird Order TVD scheme (ULTIMATE)  solution scheme.  This is the default, so nothing \nneeds to be done.  \n4.2 The Dispersion Package  \nNext, enter the data for the Dispersion package.  \n2. Select MT3DMS  | Dispersion Package\u2026  to open the Dispersion Package \ndialog.  \n3. Click Longitudinal Dispersivity\u2026  to bring up the Longitudi nal Dispersivity  \ndialog.  \n4. Click Constant \u2192 Grid\u2026  to open the Grid Value dialog.  \n\nGMS Tutorials   MT3DMS \u2013 Grid Approach  \n \n Page 7 of 10 \u00a9 Aquaveo 2024  5. Enter \u201c20.0\u201d as the Constant value for grid  and click OK to close the Grid Value  \ndialog.  \n6. Click OK to exit the Longitudinal Dispersivity  dialog.  \n7. Enter \u201c0.2\u201d in the TRPT  column of  the spreadsheet . \n8. Click OK to exit the Dispersion Package  dialog.  \n4.3 The Source/Sink Mixing Package  \nFinally, define the data for the Source/Sink Mixing package. For this problem, only one \nsource/sink exists: the injection well. To define the source at the injection well, select the \nwell and assign a concentration.  \n1. Using the Select Cells   tool, select the cell containing the injection well (the \nupper well, cell ID 304).  \n2. Right -click on the selected cell and select Sources/Sinks\u2026  to bring up the \nMODFLOW/MT3DM S Sources/Sinks  dialog.  \n3. Select \u201cMT3DMS: Point SS\u201d from the list on the left.  \n4. Click Add BC  to create a new entry in the spreadsheet.  \n5. Select \u201cwell (WEL)\u201d from the drop -down in the Type (ITYPE)  column.  \n6. Enter \u201c57.87\u201d in the tracer column.  \nThis is the concentration of the tracer species in that cell.  \n7. Click OK to exit the MODFLOW/MT3DMS Sources/Sinks  dialog.  \n8. Click anywhere outside the grid to deselect the cell.  \n5 Saving and Running MT3DMS  \nNow save the simulation and run MT3DMS.  \n1. Save   the project.  \n2. Click Run MT3DMS   to bring up the MT3DMS  model wrapper dialog.  \n3. When the simulation is finished, turn on Read solution on exit . \n4. Click Close  to import the solution and close the MT3DMS  dialog.  \nThe model should appear similar to Figure 3. \n\nGMS Tutorials   MT3DMS \u2013 Grid Approach  \n \n Page 8 of 10 \u00a9 Aquaveo 2024   \n      Figure 3      After MT3DMS is run  \n6 Viewing the Solution  \n6.1 The Source/Sink Mixing Package  \nWhen displaying plume data, the color fill option often provides excellent results.  \n1. Click Contour Options   to open the Dataset Contour Options \u2013 3D Grid \u2013 \ntracer dialog.  \n2. Select \u201cColor Fill\u201d from the first drop -down in the Contour method  section.  \n3. Click OK to close the Dataset Contour Options \u2013 3D Grid \u2013 tracer  dialog.  \nThe model should appear similar to Figure 4. \n\nGMS Tutorials   MT3DMS \u2013 Grid Approach  \n \n Page 9 of 10 \u00a9 Aquaveo 2024   \n      Figure 4      Using color fill contours  \n6.2 Setting Up an Animation  \nObserve how the solution changes over the one -year simulation by generating an \nanimation. Do the following to set up the animation:  \n1. Select Display | Animate\u2026  to bring up the Options  page of the Animation Wizard  \ndialog.  \n2. Next to Animation file , click on the  browser  button to open the Save  dialog.  \n3. Enter \u201ctransport.mp4\u201d as the File name . \n4. Be certain that the Save as type  is set to \u201cAnimation (*.mp4, *.avi)\u201d.  \n5. Select Save  to close the Save  dialog.  \n6. Turn on Dataset  and click Next  to go to the Datasets  page of the Animation \nWizard  dialog.  \n7. Select Use constant interval  and enter \u201c36.5\u201d as the Time interval . \nThis will result in 11 frames.  \n8. Turn on Display clock . \n9. Click Finish  to generate the animation, close the Animation Wizard  dialog and  \nlaunch an animati on application of your choice outside of GMS.  \nThe frames of the animation which are being generated will appear.  \nFeel free to experiment with some of the other playback controls if desired.  \n\nGMS Tutorials   MT3DMS \u2013 Grid Approach  \n \n Page 10 of 10 \u00a9 Aquaveo 2024  10. When finished, close the animation application  window and return to GMS.  \n6.3 Calculating the Mass of the Contaminant  \nFinally, calculate the mass of the contaminant in the aquifer at various times during the \nsimulation.  \n1. Using the Select Cells   tool, select the cell containing the well in the lower \nportion of the model (cell  ID 752).  \n2. Select MT3DMS | Calculate Mass\u2026  to open the Calculate Mass dialog.  \nThis dialog allows calculation of the mass of a contaminant in the entire model domain or \nin the selected cell(s). The Definition  section of the dialog explains the formula that is \nused to calculate the mass. Basically, the volume of water in each cell is calculated and \nthen multiplied by the concentration computed by MT3DMS. Simply supply a conversion \nfactor so that the calculated mass will be computed in the correct units. The Unit \nconversion factor  section shows an example of a conversion factor. The Concentration \nrange  section allows specifying a range over which the mass will be calculated. This is \nmost useful to ignore negative  concentrations that result in MT3DMS simulations.  \n3. In the Concentration range section, turn on Specify range in calculation . \n4. Enter \u201c0.0\u201d as the Min. \n5. Enter \u201c9.0\u201d as the Max. \n6. In the Unit conversion factor  section, enter \u201c0.0283\u201d as the Factor.  \nThis means the  resulting mass will be displayed in units of grams.  \n7. Select Use only selected cells in calculation . \n8. Click Calculate.   \nNotice that the mass values are shown in the spreadsheet on the right side of the dialog.  \n9. Now select Use all cells in calculation  and clic k Calculate  again.  \nThe total mass in the aquifer for each time step of the solution should now be visible. \nReview the results in the spreadsheet.  \n10. When finished, select Done  to close the Calculate Mass  dialog  \n7 Conclusion  \nThis concludes the \u201c MT3DMS  \u2013 Grid App roach \u201d tutorial. The following key concepts were \ndiscussed and demonstrated in this tutorial:  \n\uf0b7 MT3DMS is available only if a MODFLOW model HFF file is in the current \nlocation of the project files. If MODFLOW files are moved or renamed, they will \nneed to be regenerated by running MODFLOW to create the solution files so that \nMT3DMS can find them.  \n\uf0b7 GMS gives MT3DMS the top and bottom elevation data it requires for each layer \nfrom the MODFLOW model.  \n\uf0b7 It is possible to use the Animation Wizard  to create an animatio n in GMS.  \n\uf0b7 It is possible to calculate the mass of a contaminant in the 3D grid using the \nMT3D MS | Calculate Mass \u2026 command.  \n\n", "filename": "MT3DMS-GridApproach.pdf", "pages": 10}, "MT3DMS-HeatTransport": {"text": "GMS Tutorials   MT3DMS \u2013 Heat Transport  \n Page 1 of 13 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nMT3DMS \u2013 Heat Transport  \nSimulate heat transport using MT3DMS  \n \nObjectives   \nThis tutorial shows how to construct an MT3DMS model using the grid approach and how to simulate \nheat transport using MT3DMS.  \n \nPrerequisite Tutorials  \n\uf0b7 MT3DMS \u2013 Grid Approach  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 MT3D  \n Time  \n\uf0b7 20\u201335 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   MT3DMS \u2013 Heat Transport  \n Page 2 of 13 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Heat Transport Coefficients  ................................ ................................ ..........................  3 \n2 Getting Started  ................................ ................................ ................................ .....................  5 \n2.1 The Flow Model  ................................ ................................ ................................ ............  5 \n3 The MT3DMS Basic Transport Package  ................................ ................................ ............  6 \n3.1 Species  ................................ ................................ ................................ .........................  6 \n3.2 Packages  ................................ ................................ ................................ ......................  6 \n3.3 Packages  ................................ ................................ ................................ ......................  6 \n3.4 Output Control  ................................ ................................ ................................ ..............  6 \n3.5 ICBUND Array  ................................ ................................ ................................ ..............  7 \n3.6 Starting  Concentration Array ................................ ................................ .........................  7 \n3.7 HTOP and Thickness Arrays  ................................ ................................ ........................  7 \n3.8 Porosity Array  ................................ ................................ ................................ ...............  7 \n4 Setting up the Packages  ................................ ................................ ................................ ..... 8 \n4.1 The Advection Package  ................................ ................................ ................................  8 \n4.2 The Dispersion Package  ................................ ................................ ...............................  8 \n4.3 The Chemical Reaction Package  ................................ ................................ ..................  8 \n4.4 The Source/Sink Mixing Package  ................................ ................................ .................  9 \n5 Saving the Simulation and Running MT3DMS  ................................ ................................  10 \n6 Viewing the Solution  ................................ ................................ ................................ .........  11 \n6.1 The Source/Sink Mixing Package  ................................ ................................ ...............  11 \n6.2 Setting Up an Animation  ................................ ................................ .............................  12 \n7 Conclusion  ................................ ................................ ................................ .........................  13 \n8 Additional Reading  ................................ ................................ ................................ ............  13 \n \n1 Introduction  \nThe problem to be solved in this tutorial is an MT3DMS  simulation within GMS of heat \ntransport ( Figure 1). This is similar to one of the sample problems described in the \nMT3DMS  documentation.1 It consists of a low K zone inside a larger zone. The sides of \nthe region are no flow boundaries. The t op and bottom are constant head boundaries that \ncause the flow to move from the top to the bottom of the region. A well injects into the \naquifer warm water with an initial temperature of about 5\u02daC. This occurs for 3 months, \nafter which it is turned off for  8 months.  \nThis cycle is repeated for 3 years and then the simulation runs for an additional 3 years. \nA pumping well serves to withdraw some water migrating from the injection well. A \ntransient flow solution will be provided and a transient transport simu lation will be \nperformed over a 6 -year period.  \nThis tutorial demonstrates and discusses opening a MODFLOW simulation and running \nMODFLOW, initializing MT3DMS and entering the data for several MT3DMS packages, \nrunning MT3DMS and importing the solution, and setting up an animation to visualize the \nsolution.  \n                                                      \n1 Zheng, Chunmiao and Wang, P. Patrick ( December 1999). \u201cA Two -Dimensional  Application \nSample\u201d in MT3DMS: A Modular Three -Dimensional Multispecies Transport Model for Simulation of \nAdvection, Dispersion, and Chemical Reactions of Contaminants in Groundwater Systems; \nDocumentation and User\u2019s Gui de, Strategic Environmental Research and Development Program \n(SERDP), U.S. Army Corps of Engineers, Contract Report SERDP -99-1, pp. 152 -154. \nhttp://hydro.geo.ua.edu/mt3d/mt3dmanual.pdf  \nGMS Tutorials   MT3DMS \u2013 Heat Transport  \n \n Page 3 of 13 \u00a9 Aquaveo 2024  \n \nFixed head (H=250 m) + Temperature (T=2 78 K \nor 5o C) \nHyd. Cond. =  \n1.474x10-7m/s \nLOW K ZONE  INJECTION WELL  \nQ = 5000 m3/day \nT = 298 K or 25o C \nPUMPING WELL  \nConstant head boundary (H = 240 m) Number of rows = 40  \nNumber of columns = 32  \nAquifer thickness = 10 m  \nK = 1.474x10-4 m/s \nPorosity = 0.3  \nLongitudinal dispersivity = 0.5 m \nDispersivity ratio = 0. 1 \nSimulation time = 1 0.0 yr \nDX = 1600 m  Q = -1000  m3/day DY = 2000 m  No flow boundary \n(flow model)  \nNo mass flux \nboundary  \n(transport m odel)  No flow boundary \n(flow model)  \nNo mass flux \nboundary  \n(transport model)  Flow Direction   \n      Figure 1      Sample flow and transport problem  \n1.1 Heat Transport Coefficients  \nHeat transport and solute transport are very similar. The following is a general form of the \nsolute transport equation solved by MT3MDS:  \nk\nssk k k\nmk k\nd bCq qC CqDtC K/) ( ] ) ([) () 1( \uf02d\uf0d7\uf0d1\uf02d\uf0d1\uf0d7\uf02b\uf0d7\uf0d1\uf03d\uf0b6\uf0b6\uf02b\uf071\uf061\uf071\uf071\n\uf071\uf072\n  (1) \nWhere:  \nb\uf072\n is the bulk density (mass of the solids divided by the total volume) [ML-3]  \nk\ndK\n is the distribution  coefficient of species k [L3M\u22121]  \n\uf071\n is porosity   \nkC\n is the concentration of species k [ML\u22123]  \nt is time [T]   \nk\nmD\n is the molecular diffusion coefficient [L2T\u22121] for species k  \n\uf061\n is the dispersivity tensor [L]   \nq\n is specific discharge [LT\u22121]  \nsq/\n is a fluid source or sink [T\u22121]  \nGMS Tutorials   MT3DMS \u2013 Heat Transport  \n \n Page 4 of 13 \u00a9 Aquaveo 2024  \nk\nsC is the source or sink concentration [ML\u22123] of species k \nThe similarity between heat transport and solute transport is shown in the following heat \ntransport equation:2 \nss\nPfluidTbulk\nPfluidPsolid sTq qT Tq\nck\ntT\ncc/) ( ] ) ([) ()11( \uf02d\uf0d7\uf0d1\uf02d\uf0d1\uf0d7\uf02b \uf0d7\uf0d1\uf03d\uf0b6\uf0b6 \uf02d\uf02b\uf071\uf061\uf071\uf072\uf071\uf071\n\uf072\uf072\n\uf071\uf071\n  (2) \nWhere:  \ns\uf072\n is the density of the solid (mass of the solid  divided by the volume of the \nsolid) [ML\u22123] \n\uf072\nis fluid density [ML\u22123]  \nPsolidc\n is the specific heat capacity of   the solid [L2T\u22122\n\uf051 \u22121]  \nPfluidc\n is the specific heat capacity  of the fluid [L2T\u22122\n\uf051 \u22121]  \nT is temperature [\n\uf051 ] \nTbulkk\n is the bulk thermal conductivity of the aquifer material  [MLT\u22123\n\uf051 \u22121]  \nTs is source temperature [\n\uf051 ]  \nNote that\nb\uf072 ,\ns\uf072, and \u03b8 are related by  \nb\uf072\n= \ns\uf072  (1 \u2212 \u03b8) (3) \nAdditionally, there are retardation terms on the left side of both equations 1 and 2. For \nsolute transport, retardation is caused by adsorption  of solutes by the aquifer matrix \nmaterial.  With heat  transport, retardation is caused by heat transfer between  the fluid and \nsolid aquifer matrix. MT3DMS can be  used to represent thermal retardation by calculating \nthe distribution coefficient ( Kd) for the temperature species  as a function of thermal \nproperties:  \nPfluidPsolid T\ndccK\uf072\uf03d\n (4) \nTherefore, substituting equations 3 and 4 into the left side of equation 2 will yield the \nfollowing:  \ntT KT\nd b\n\uf0b6\uf0b6\uf02b) () 1(\uf071\n\uf071\uf072\n (5) \nInspection of equations 1 and 2 also shows that  heat conduc tion is mathematically \nequivalent to molecular  solute diffusion. To represent heat conduction with  MT3DMS, \nthermal diffusivity for the temperature species  is calculated as follows:  \nPfluidTbulk T\nmckD\uf071\uf072\uf03d\n (6) \n                                                      \n2 Thorne, Danny; Langevin, Christian D.; and Sukop, Michael C. (2006). \u201cAddition of simultaneous \nheat and solute transport and variable fluid viscosity to SEAWAT\u201d in Computers & Geosciences, \n32(10) , pp. 1758 -1768. http://plaza.ufl.edu/clang001/papers/thorne_et_al_2006.pdf  \nGMS Tutorials   MT3DMS \u2013 Heat Transport  \n \n Page 5 of 13 \u00a9 Aquaveo 2024  In GMS, \nT\ndK  and \nT\nmD  can be specified in the MT3DMS interface. \nT\ndK is the distribution \ncoefficient (slope of the isotherm), which can be specified in the Chemical Reaction \nPackage. \nT\nmD is the molecular diffusion coeffic ient (DMCOEF), which can be specified in \nthe Dispersion Package.  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2.1 The Flow Model  \nBefore setting up the MT3DMS simulation, a MODFLOW solution must exist to be used \nas the flow field for the transport simulation. In the interest of time, import a pre viously \ncreated MODFLOW simulation.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the heat_transport \\heat_transport \\ directory and select \u201cstart.gpr\u201d.  \n4. Click Open  to import the project and exit the Open  dialog.  \nThe model should appear similar to Figure 2. \n \nFigure 2      The initial mod el \n\nGMS Tutorials   MT3DMS \u2013 Heat Transport  \n \n Page 6 of 13 \u00a9 Aquaveo 2024  3 The MT3DMS Basic Transport Package  \nWith a flow solution, it is possible to set up the MT3DMS transport simulation. Like \nMODFLOW , MT3DMS  is structured in a modular fashion and uses a series of packages \nas input. Consequently, the GMS interface to MT3DMS  is similar to the interface to \nMODFLOW  and follows a similar sequence of steps to enter the input data.  \nFirst, initialize the MT3DMS simulation.  \n1. Fully expand \u201c  3D Grid Data\u201d in the Project Explorer.  \n2. Right -click on \u201c  grid\u201d and select New MT3DMS\u2026  to bring  up the Basic \nTransport Package  dialog.  \nThe MT3DMS options in the  Basic Transport Package  dialog are always required to be \nset. They define basic information such as stress periods, active/inactive regions, and \nstarting concentration values.  \n3.1 Species  \nSince MT3DMS is a multi -species model, it is necessary to define the number of species \nand a name for each species.  \n1. Click Define Species\u2026  to open the Define Species dialog.  \n2. Click New to create a new species.  \n3. Enter \u201cWarmWater\u201d in the Name  column for the new species.  \n4. Click OK to close the Define Species  dialog.  \n3.2 Packages  \nNow to select which packages to use by doing the following:  \n1. Click Packages\u2026  to open the MT3DMS/RT3D Packages dialog.  \n2. Turn on  Advection package , Dispersion package , Source/sink mixing package ,  \nand Chemical reaction package  \n3. Click OK to close the MT3DMS/RT3D Packages  dialog  \n3.3 Packages  \nSince the flow simulation is transient, the transport simulation must match the stress \nperiods defined for the flow simulation. Therefore,  it is possible to use the stress periods \nas defined by the MODFLOW simulation. No changes need to be made here at this time. \nThe stress periods can be defined via the Stress Periods \u2026 button.  \n3.4 Output Control  \nNext, specify the output options:  \n1. Click Output Co ntrol\u2026  to open the Output Control dialog.  \n2. Select Print or save at specified times.  \n3. Click Times\u2026  to open the Variable Time Steps dialog.  \n\nGMS Tutorials   MT3DMS \u2013 Heat Transport  \n \n Page 7 of 13 \u00a9 Aquaveo 2024  4. Click Initialize Values\u2026  to open the Initialize Time Steps dialog.  \n5. Enter \u201c25.0\u201d as the Initial time step size.  \n6. Enter \u201c1. 0\u201d as the Bias. \n7. Enter \u201c25.0\u201d as the Maximum time step size . \n8. Enter \u201c2200.0\u201d as the Maximum simulation time . \nThese values will provide 100 output time steps.  \n9. Click OK to close the Initialize Time Steps  dialog.  \n10. Click OK to close the Variable Time Steps  dialog.  \n11. Click OK to close the Output Control  dialog.  \n3.5 ICBUND Array  \nThe ICBUND array is similar to the IBOUND array in MODFLOW. The ICBUND array is \nused to designate active transport cells (ICBUND> 0), inactive transport cells \n(ICBUND=0), and constant concentration cells (ICBUND<0). For this problem, all of the \ncells are active, so no changes are necessary. It is accessible via the ICBUND\u2026  button.  \n3.6 Starting Concentration Array  \nThe starting concentrati on array defines the initial condition for the contaminant \nconcentration.  \n1.  In the spreadsheet to the right of the column of buttons, check the box in the Edit \nPer Cell  column of the WarmWater  row. \n2. Click the  button in the Starting Conc. Per Cell  column  to open the Starting \nConcentrations \u2013 WarmWater dialog .  \n3. Click Constant \u2192 Grid\u2026  to open the Grid Value dialog.  \n4. Enter \u201c278.0\u201d as the Constant value for grid . \nThis is the starting temperature of the warm water species in degrees Kelvin  (about 5 \u02daC). \n5. Click OK to exit the Grid Value  dialog.  \n6. Click OK to exit the Starting Concentrations \u2013 WarmWater dialog.  \n3.7 HTOP and Thickness Arrays  \nMT3DMS uses the HTOP array and a thickness array to determine the layer geometry. \nHowever, the values for these arrays are determined b y GMS automatically from the \nMODFLOW layer data, so no input is necessary. They are accessible via the HTOP\u2026  \nbutton.  \n3.8 Porosity Array  \nFinally, define the porosity for the cells. The problem has a constant porosity of \u201c0.3\u201d. \nThis is the default value in GMS, so no changes need to be made. It is accessible via the \nPorosity\u2026  button.  \n\nGMS Tutorials   MT3DMS \u2013 Heat Transport  \n \n Page 8 of 13 \u00a9 Aquaveo 2024  This completes the setting of the definitions and options in the Basic Transport Package  \ndialog.  \n1. Click OK to exit the Basic Transport Package  dialog.  \n4 Setting up the Packages  \n4.1 The Advection Package  \nThe next step is to enter the data for the Advection package. This tutorial will use the \nThird Order TVD scheme (ULTIMATE)  solution scheme.  This is the default, so nothing \nneeds to be done.  \n4.2 The Dispersion Package  \nThe molecular diffusion coefficient (DMCOEF) is specified in the Dispersion Package; in \na heat transport simulation, DMCOEF represents thermal diffusivity \nT\nmD .  \n1. Select MT3DMS  | Dispersion Package\u2026  to bring up the Dispersion Package  \ndialo g. \n2. Click Longitudinal Dispersivity\u2026  to open the Longitudinal Dispersivity dialog.  \n3. Click Constant \u2192 Grid\u2026  to open the Grid Value dialog.  \n4. Enter \u201c0.5\u201d as the Constant value for grid  and click OK to close the Grid Value  \ndialog.  \n5. Click OK to exit the Longitudina l Dispersivity  dialog.  \n6. Enter \u201c0.1\u201d in both the TRPT  and TRVT  columns on row 1 in the spreadsheet.  \n7. Enter \u201c2.15e -11\u201d in the DMCOEF  column .3 \n8. Click OK to exit the Dispersion Package  dialog.  \n4.3 The Chemical Reaction Package  \nThe sorption options are specified in the Chemical Reaction package. In a heat transport \nsimulation, the sorption option represents thermal retardation. To enter the sorption \nparameters:  \n1. Select MT3DMS | Chemical Reaction Package\u2026  to open the Chemical \nReaction Package dialog.  \n2. Select \u201cLinear iso therm\u201d from the Sorption  drop-down.  \n3. In the second section, enter \u201c1961.0\u201d as the Bulk density .  \nNote that these units actually represent [kg/m3]. Once again, this does not agree with the \nstandard units for the model, but these units only need to agree with  the K d (first sorption \nconstant) units.  \n4. In the spreadsheet, enter \u201c0.00021\u201d in the WarmWater  column on the 1st \nsorption const. row. \n                                                      \n3 This value is based on reference values from the German Engineer Association guidelines for \nthermal use of the underground (VDI -Richtlinie 4640 2001).  \nGMS Tutorials   MT3DMS \u2013 Heat Transport  \n \n Page 9 of 13 \u00a9 Aquaveo 2024  5. Click OK to exit the Chemical Reaction Package  dialog.  \nNote that these two values should result in a retardation factor of \u201c1.41\u201d. The retardation \nfactor is calculated using the following formula:  \nnKRd\uf072\uf02b\uf03d1\n \nWhere:  \n \nKd = distribution coefficient (slope of the isotherm)  \nn = porosity  \n4.4 The Source/Sink Mixing Package  \nNow define the data for the Source/Sink Mixing  package so that the temperature of the \nwater at the injection well can be specified.  \n1. Using the Select Cells   tool, select the cell containing the injection well (the \nupper well, cell ID 304).  \n2. Right -click on the selected cell and select Sources/Sinks\u2026  to open the \nMODFLOW/MT3DMS Sources/Sinks dialog.  \n3. Select \u201cMT3DMS: Point SS\u201d from the list on the left.  \n4. Click Add BC  to create a new entry in the spreadsheet.  \n5. Select \u201cwell (WEL)\u201d from the drop -down in the Type (ITYPE)  column.  \n6. Enter \u201c298.0\u201d  in the WarmWater  column.  \n7. Click OK to exit the MODFLOW/MT3DMS Sources/Sinks  dialog.  \n8. Click outside the grid to deselect the cell.  \nFinally, it is necessary to define the constant temperature at the boundaries of the model.  \n9. Using the Select Cells   tool, select all cells with the constant head BCs \n(orange diamond symbols) along the top and bottom boundaries of the grid. Do \nthis by dragging a box around the cells at the top of the model and then holding \ndown the Shift key and dragging a second box aro und the cells at the bottom of \nthe model (see red boxes in Figure 3). \n\nGMS Tutorials   MT3DMS \u2013 Heat Transport  \n \n Page 10 of 13 \u00a9 Aquaveo 2024   \n      Figure 3      Selecting cells on the model bound ary \n10. Right -click on one of the selected cells and select Sources/Sinks\u2026  to open the \nMODFLOW/MT3DMS Sources/Sinks dialog.  \n11. Select \u201cMT3DMS: Point SS\u201d from the list on the left.  \n12. Click Add BC  to create new entries in the spreadsheet for all the selected cells.  \n13. In the All row, enter \u201c278\u201d in the WarmWater  column.  \nThis applies this concentration to all of the boundary conditions.  \n14. Click OK to close the MODFLOW/MT3DMS Sources/Sinks  dialog.  \nClick anywhere outside the grid to unselect the cells.  \n5 Saving the Simulation and Running MT3DMS  \nNow save the simulation and run MT3DMS.  \n1. Select File |  Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cheat.gpr\u201d as the File name . \n4. Click Save  to save the project with the new  name and close the Save As  dialog.  \n5. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n6. When MODFLOW finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n7. Click Close  to import the solution and close the MODFLOW  dialog.  \n8. Save   the project.  \n\nGMS Tutorials   MT3DMS \u2013 Heat Transport  \n \n Page 11 of 13 \u00a9 Aquaveo 2024  9. Select MT3DMS | Run MT3DMS\u2026  to bring up the MT3DMS  model wrapper \ndialog.  \n10. When MT3DMS finishes, turn on Read solution on exit . \n11. Click Close  to import the solution and close the MT3DMS  dialog.  \nThe model should appear similar  to Figure 4. \n \n      Figure 4      After MT3DMS is run  \n6 Viewing the Solution  \n6.1 The Source/Sink Mixing Package  \nWhen displaying plume data, the color fill option often provides excellent results.  \n1. Click Contour Options   to open the Dataset Contour Options \u2013 3D Grid \u2013 \nWarmWater dialog.  \n2. In the Contour method  section, select \u201cColor Fill\u201d from the first drop -down.  \n3. In the Contour interval  section, turn on Fill Continuous color range.  \n4. Click OK to close the Dataset Contour Options \u2013 3D Grid \u2013 WarmWater  dialog.  \n5. Select the \u201c  WarmWater\u201d dataset under \u201c  heat (MT3DMS)\u201d in the Project \nExplorer.  \n6. Select the last time step (step 93) in the Time Step Window.  \n\nGMS Tutorials   MT3DMS \u2013 Heat Transport  \n \n Page 12 of 13 \u00a9 Aquaveo 2024  The model should appear similar to Figure 5. \n \n      Figure 5      Contours on the last time step  \nFeel free to review other time steps to see how the temperature changes over time. \nWhen finished , notice  the \u201c  WarmWater  (sorbed) \u201d dataset as well. Feel free to review \nthe time steps for this dataset as well.  \n6.2 Setting Up an Animation  \nIt is possible to observe how the solution changes over the one -year simulation by \ngenerating an animation. To set up the animation, d o the following:  \n1. Select Display | Animate\u2026  to open the Options  page of the Animation Wizard  \ndialog.  \n2. Next to Animation file , click on the browser  button to open the Save  dialog.  \n3. Enter \u201cheat.gpr\u201d as the File name . \n4. Be certain that Save as type  is set to \u201cAnimation file (*mp4, *avi)\u201d.  \n5. Select Save  to close the Save  dialog.  \n6. In the Options  section, turn on Dataset . \n7. Click Next  to go to the Datasets  page of the Animation Wizard  dialog.  \n8. Turn on Display clock . \n9. Click Finish  to generate the animation, c lose the Animation Wizard  dialog.  \n\nGMS Tutorials   MT3DMS \u2013 Heat Transport  \n \n Page 13 of 13 \u00a9 Aquaveo 2024  If desired, open the MP4 file a media player application outside of GMS. Feel free to \nexperiment with some of the other playback controls as desired.  \n7 Conclusion  \nThis concludes the \u201c MT3DMS  \u2013 Heat Transport\u201d  tutorial. The following key concepts were \ndiscussed and demonstrated in this tutorial:  \n\uf0b7 It is possible to perform a heat transport analysis using MT3DMS in GMS.  \n\uf0b7 The important inputs in a heat transport simulation are \nT\ndK  and \nT\nmD . \n\uf0b7 \nT\ndK  is the distribution coefficient (slope of the isotherm), which can be specified \nin the Chemical Reaction Package.  \n\uf0b7 \nT\nmD is the molecular diffusion coefficient (DMCOEF), which can be specified i n \nthe Dispersion Package.  \n8 Additional Reading  \n\uf0b7 Hecht -M\u00e9ndez, J., Molina -Giraldo, N., Blum, P. and Bayer, P. (2010), \u201cEvaluating \nMT3DMS for Heat Transport Simulation of Closed Geothermal Systems\u201d in \nGround Water , 48: 741 \u2013756. doi: 10.1111/j.1745 -6584.2010.006 78.x \n\uf0b7 Langevin, C. D., Dausman, A. M. and Sukop, M. C. (2010), \u201cSolute and Heat \nTransport Model of the Henry and Hilleke Laboratory Experiment\u201d in Ground \nWater , 48: 757 \u2013770. doi: 10.1111/j.1745 -6584.2009.00596.x  \n \n", "filename": "MT3DMS-HeatTransport.pdf", "pages": 13}, "OnlineMaps": {"text": "GMS Tutorials   Online Maps  \n Page 1 of 6 \u00a9 Aquaveo 2024  z \n GMS 10. 8 Tutorial  \nOnline Maps  \nUsing free, dynamic, online map data in GMS  \n \nObjectives   \nLearn how free online map data can quickly and easily be used to dynamically update background maps \nand aerial photography in GMS.  \n \nPrerequisite Tutorials  \n\uf0b7 Getting Started  Required Components  \n\uf0b7 An internet connection  \n Time  \n\uf0b7 10\u201320 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   Online Maps  \n Page 2 of 6 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Adding Online Maps  ................................ ................................ ................................ ............  2 \n3 Appearance  ................................ ................................ ................................ ..........................  4 \n3.1 Changing the  Display Order  ................................ ................................ .........................  4 \n3.2 Transparency  ................................ ................................ ................................ ................  4 \n4 Exporting an Image File  ................................ ................................ ................................ ...... 4 \n5 Image Properties and Save Location  ................................ ................................ .................  5 \n6 Map Locator  ................................ ................................ ................................ .........................  5 \n7 Other Online Maps  ................................ ................................ ................................ ...............  6 \n8 Conclusion  ................................ ................................ ................................ ...........................  6 \n \n1 Introduction  \nOnline maps are free maps, aerial photos, and DEMs that can be downloaded from the \ninternet and displayed in the background in plan view. When zooming in and out or \npanning the view, online maps download the required image data from the internet and \nupdate  automatically. Depending on the speed of the internet connection, this usually \ntakes just a few moments. Online maps can be saved locally as image files. Online maps \ncan be helpful in the initial stages of setting up a groundwater model.  \nIn this tutorial,  the following topics will be covered:  \n\uf0b7 Add an online map showing an aerial photo of the area around Moab, Utah.  \n\uf0b7 Zoom and pan to see how the image updates automatically.  \n\uf0b7 Add a second online map and explore image order and transparency.  \n\uf0b7 Create a local image file from the online map.  \n\uf0b7 Use the Map Locator  to reposition the display.  \n1.1 Getting Started  \nTo get started, do the following:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New\u2026  to ensure that the program settings \nare restored to their de fault state.  \n2 Adding Online Maps  \nTo start, add an online map. Before adding the map, notice the current projection \ndisplayed in the bottom right of the Graphics Window. It should say \u201cNo projection, Feet \n(U.S. Survey).\u201d This means that no global projection has been defined.  \n1. Click the Add Online Map   macro to bring up the Virtual Earth Map Locator  \ndialog.  \n2. In the Search section, enter \u201cMoab, Utah\u201d in the Place to search for  field and click \nJump to Search Location . \n3. Click OK to close the Virtual Earth Map Locat or dialog.  \nA warning will appear stating that a new global projection needs to be set. Had a \nmatching projection already been set, then this warning would not have appeared.  \n\nGMS Tutorials   Online Maps  \n \n Page 3 of 6 \u00a9 Aquaveo 2024  4. Click OK to close the warning dialog and open the Display Projection  dialog.  \nBy default, the global projection of the image location selected in the Virtual Earth Map \nLocator  is populated in the Display Projection  dialog.  \n5. Click OK to close the Display Projection  dialog and open the Get Online Maps  \ndialog.  \n6. Select World Imagery  and clic k OK to exit the Get Online Maps dialog.  \nAfter a few moments (depending on speed of the internet connection), an aerial photo of \nthe city of Moab, Utah will appear in the Graphics Window. Notice the projection \ndisplayed in the bottom right of the Graphics Window now says \u201cUTM\u201d and \u201cNAD83...\u201d \nBecause the project had no data, GMS switched the display projection to UTM.  \n7. Using the scroll wheel on the mouse or the Zoom  tool, zoom out repeatedly. \nNotice that the image updates with different resolution images as  the zoom level \nchanges.  \n8. Use the Pan  tool to pan around the area. Notice how the image updates.  \nNotice the icon for the online map item in the Project Explorer looks like the typical image \nitem icon but with the addition of a globe in the bottom right co rner , indicating it is an \nonline map. As the image is downloading from the internet, the text next to the item in the \nProject Explorer will change to \u201c(processing) World Imagery\u201d. Once the download is \ncomplete, the \u201c(processing)\u201d is removed.  \n \n      Figure 1      Online satellite map of Moab, Utah  \nThe next step is to add a second online map.  \n9. Click the Add Online Map   macro to bring up the Get Online Maps  dialog.  \nThe Virtual Earth Map Locator  dialog does not open this time because  data already exists \nin the project.  \n10. Select World Street Map  and click OK to close the Get Online Maps  dialog.  \nAfter a few moments, a street map of the area will appear in the Graphic s Window \n(Figure 2). \n\nGMS Tutorials   Online Maps  \n \n Page 4 of 6 \u00a9 Aquaveo 2024   \n      Figure 2      Online street map of Moab, Utah  \n3 Appearance  \nGMS provides tools for how online maps are displayed in the Graphics Window.  \n3.1 Changing the Display Order  \nImages are displayed top to bottom, in the order they appear in the Project Explorer. To \nchange the order, do the following:  \n1. In the Project Explorer, select and drag the \u201c  World Street Map\u201d item so that it \nis underneath the \u201c  World Imagery\u201d item.  \nNotice that the aerial photo is visible once again.  \n2. Place the \u201c  World Street Map\u201d back on top by dragging it so it is above \u201c  \nWorld Imagery\u201d.  \n3.2 Transparency  \nThe transparency of online maps can be set just as with other images.  \n1. Right -click on the \u201c  World S treet Map\u201d item in the Project Explorer and select \nTransparency\u2026  to bring up the Layer Transparency  dialog.  \n2. Use the slider to change the Transparency  to around \u201c40%\u201d.  \n3. Click OK to close the Layer Transparency  dialog.  \nThe \u201c  World Imagery\u201d will now be visible through the \u201c  World Street Map\u201d image.  \n4 Exporting an Image File  \nA copy of the online map currently displayed in the Graphics Window can be saved as an \nimage file. The image file is saved locally  so it is accessible witho ut an internet \nconnection.  \n\nGMS Tutorials   Online Maps  \n \n Page 5 of 6 \u00a9 Aquaveo 2024  1. In the Project Explorer, right -click on \u201c  World Street Map\u201d and select Export\u2026  \nto bring up the Resample and Export Raster  dialog.  \nIt is often desirable to save the image at a higher resolution than is currently displayed on \nscreen. Because the exported image is limited to the resolution at which it was saved, it \nwill not update with higher resolution online imagery when zooming in.  \n2. Enter \u201c2.0\u201d in the Resampling ratio  field.  \n3. Turn on Add to project after saving . \n4. Click OK to close t he Resample and Export Raster  dialog and bring up the Save \nAs dialog.  \n5. Enter \u201cMoabStreetmap.tif\u201d in the File name  field.  \n6. Select \u201cGeoTIFF Files (*.tif)\u201d from the Save as type  drop-down.  \n7. Click Save  to export the file and close the Save As  dialog.  \nOnce the dow nload and export is complete, a third image titled \u201c  MoabStreetmap.tif\u201d \nwill appear in the Project Explorer.  \n5 Image Properties and Save Location  \nTo view the folder where the exported TIFF is located, do the following:  \n1. Right -click on the newly created \u201c  MoabStreetmap.tif\u201d and select Open \nContaining Folder  to bring up the directory where the image file was saved.  \nThe folder containing the exported image file will open in Windows Explorer.  \nTo review the properties of the image that was just created, return  to GMS and do the \nfollowing:  \n2. Right -click on \u201c  MoabStreetmap.tif\u201d and select Projection  | Projection\u2026  to \nbring up the Projection  dialog.  \nThis dialog displays the projection for the image that was saved with the image when it \nwas exported.  \n3. Click Cancel  to close the Projection  dialog.  \n6 Map Locator  \nWhen the first online map was downloaded, GMS opened the Virtual Earth Map Locator  \ndialog so that the desired map location could be entered because there was no project \ndata. The Virtual Earth Map Locator  dialog ca n be used at any time to change the \nGraphics Window view to show different places on the globe.  \n1. Click the Map Locator   macro to bring up the Virtual Earth Map Locator  dialog. \nThe current location in Moab will be shown.  \n2. Use the mouse scroll wheel or the Zoom Out   macro to zoom out as far as \npossible.  \nA map of the entire world should now be visible. From this point, it is possible to Zoom In  \n on any location in the world.  \n\nGMS Tutorials   Online Maps  \n \n Page 6 of 6 \u00a9 Aquaveo 2024  3. Zoom in   on a new location.  \n4. When done, click OK to close the Virtual Earth Map Loc ator dialog.  \nTwo warning dialogs will appear stating the new location is outside of the current \nprojection.  \n5. Click OK to close both warnings and open the Display Projection  dialog.  \n6. Accept the new projection and click OK to close the Display Projection  dialog.  \nNotice the \u201c  World Street Map\u201d and \u201c  World Imagery\u201d will update to show the new \nlocation.  \n7 Other Online Maps  \nAt this point, the user may want to experiment with the other online map types available \nin the Get Online Maps dialog.  \n8 Conclusion  \nThis c oncludes the \u201cOnline Maps\u201d tutorial. The following key concepts were discussed \nand demonstrated:  \n\uf0b7 Importing and using different free online maps  \n\uf0b7 Changing the appearance of the imported maps  \n\uf0b7 Saving an online map to be used offline  \n\uf0b7 Using the Map Locator   to view any location in the world  \n \n\n", "filename": "OnlineMaps.pdf", "pages": 6}, "PHT3D-IonExchangeAndSurfaceComplexation": {"text": "GMS Tutorials   PHT3D \u2013 Ion exchange and Surface Complexation  \n Page 1 of 10 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nPHT3D \u2013 Ion Exchange and Surface Complexation   \nPHT3D Sorption processes  \n \nObjectives   \nThis tutorial demonstrates ion exchange and surface complexation in PHT3D.  \n \nPrerequisite Tutorials  \n\uf0b7 MT3DMS \u2013 Grid Approach  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 MT3D  \n\uf0b7 PHT3D  \n Time  \n\uf0b7 15\u201330 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   PHT3D \u2013 Ion exchange and Surface Complexation  \n Page 2 of 10 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Description of the Problem  ................................ ................................ ...........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n3 Importing the Flow Model  ................................ ................................ ................................ ... 3 \n3.1 Saving the Project with a New Name  ................................ ................................ ............  3 \n4 Building the Transport Model  ................................ ................................ .............................  3 \n4.1 Initializing the Simulation  ................................ ................................ ..............................  3 \n4.2 PHT3D Reaction Definition  ................................ ................................ ...........................  4 \n4.3 Initial Concentrations  ................................ ................................ ................................ .... 4 \n4.4 Packages  ................................ ................................ ................................ ......................  5 \n4.5 Porosity Array  ................................ ................................ ................................ ...............  5 \n4.6 Run Options  ................................ ................................ ................................ ..................  6 \n5 Advection Package  ................................ ................................ ................................ ..............  6 \n6 Dispersion Package ................................ ................................ ................................ .............  6 \n7 Adding  Inflow Concentration  ................................ ................................ ..............................  6 \n7.1 Assigning Inflow Concentrations from Flushing Water  ................................ ..................  6 \n7.2 Assigning Inflow Concentrations from Contaminated Water  ................................ .........  7 \n8 Saving the Simulation and Running PHT3D  ................................ ................................ ...... 8 \n9 Viewing the Solution  ................................ ................................ ................................ ...........  8 \n9.1 Time Series Data Plot  ................................ ................................ ................................ ... 9 \n10 Ion Exchange Reactions  ................................ ................................ ................................ ..... 9 \n10.1  Defining Exchange Species  ................................ ................................ ..........................  9 \n10.2  Defining Exchange Species Initial Concentrations  ................................ ........................  9 \n11 Saving the Simulation and Running PHT3D  ................................ ................................ .... 10 \n12 Viewing the Solution  ................................ ................................ ................................ .........  10 \n13 Conclusion  ................................ ................................ ................................ .........................  10 \n \n1 Introduction  \nSorption of species on the surface of solids is an important regulating mechanism for \nconcentrations of dissolved ions in natural waters. Natural substances whose surfaces \ncan act as sorbers include clay minerals, organic particles and oxides/hydroxides. T he \ncapability of reactive transport models to simulate sorption processes is essential to the \nsuccessful application of these models.  \nWhen dealing with sorption processes, a distinction is often made between surfaces with \na constant exchange capacity (ion exchange) and surfaces with a variable charge \n(surface complexation). In ion exchange problems, ions are adsorbed and released in \nequivalent proportions. The exchange capacity of the exchanging surface is assumed \nconstant and the net charge of the surface does not change during the exchange on clay \nand organic surfaces.  \nIn surface complexation, on the other hand, the charge of the surface is variable and \ndependent on the amount and kind of ions sorbed. It applies, for example, to sorption of \nheavy metals o n the surface of oxides and hydroxides. PHT3D can simulate sorption \nthrough ion exchange and surface complexation.  \n1.1 Description of the Problem  \nThis modeling example is based on a field site contamination problem near Mansfield, \nEngland, where ammonium liquo r, a by -product of smokeless fuel production, has \npolluted groundwater over several decades. One of the key features observed at the site \nis the strongly retarded migration of ammonium and the geochemical footprint that was \nleft behind as a result of the c ation exchange of ammonium.  \nFor simplicity, a two -dimensional reactive transport problem is set up. The simulation \nperiod is divided into two different stress periods. The first stress period represents the \nGMS Tutorials   PHT3D \u2013 Ion exchange and Surface Complexation  \n \n Page 3 of 10 \u00a9 Aquaveo 2024  period of active contamination during which the p lume grows successively, while the \nsecond stress period represents the period after the source was exhausted.  \n2 Getting Started  \nDo the following to get started:  \n1. If GMS is not running, launch GMS.  \n2. If GMS is already open, select File | New to ensure the progr am settings are \nrestored to the default state.  \n3 Importing the Flow Model  \nBefore setting up the PHT3D simulation, it is necessary to have a MODFLOW solution \nthat will be used as the flow field for the transport simulation. In the interest of time, \nimport a p reviously created MODFLOW simulation.  \n1. Click Open   to bring up the Open  dialog.  \n2. Browse to the IonExchange  directory and select \u201cstart.gpr\u201d.  \n3. Click Open  to exit the Open  dialog and import the project.  \nThe flow model has already been created in this example ( Figure 1).  \n \n      Figure 1      Flow model  \n3.1 Saving the Project with a New Name  \nBefore continuing, save the project with a ne w name.  \n1. Select File | Save As\u2026  to open the Save As  dialog.  \n2. Enter  \u201cpht3d_run1.gpr\u201d as the File name  and click Save  to close the Save As  \ndialog.  \nIt is recommended to periodically save the project.  \n4 Building the Transport Model  \nWith a flow solution, it is poss ible to set up the PHT3D transport simulation.  \n4.1 Initializing the Simulation  \nFirst, initialize the simulation.  \n1. Right -click in the Project Explorer and select Expand All . \n\nGMS Tutorials   PHT3D \u2013 Ion exchange and Surface Complexation  \n \n Page 4 of 10 \u00a9 Aquaveo 2024  2. Right -click on \u201c  grid\u201d and select New MT3DMS\u2026  to bring up the Basic \nTransport Package  dialog.  \n3. In the Model  section, select PHT3D.   \n4. Continue to the next section.  \n4.2 PHT3D Reaction Definition  \nIn this tutorial, use an existing PHREEQC -2 database to define the reaction.  \n1. Click Define Species\u2026  to open the PHT3D Options dialog.  \nThis dialog contains PHT3D general options and also allows for the defining of the \nspecies to be used. Notice that the first item available in the list box is General Options .  \n2. Select \u201cEquilibrium Species\u201d from the list on the left.  \nBecause a PHREEQC database has not yet been selected, candidate equilibrium \nspecies cannot be viewed. A PHREEQC database can be selected by doing the \nfollowing:  \n3. Click the Open   button next to PHREEQC database  to bring up the Open  \ndialog.  \n4. Select \u201cpht3d_datab.dat\u201d and click Open  to close the Open dialog and import the \ndatabase.  \nGMS has now imported the PHREEQC database and made available the different \ncomponents included in the file. Now select the components to model.  \n5. In the Active  column in the spreadsheet, turn on: O(0), Ca, Mg, Na, K, Cl, C(4), \nC(-4), S(6), N(5), N(3),  and N(0).  \nNote that pH and pe species are automatically included in all simulations.  \n6. Select \u201cKinetic Species\u201d from the list on the left.  \n7. In the Active column, turn on Amm . \n8. Select \u201cEquilibrium Minerals/Phases\u201d from the list on the left. \n9. In the Active columns, turn on Calcite . \nThe selection of species to include in the simulation is now completed.  \n10. Click OK to close the PHT3D Options  dialog.  \nIn the spreadsheet, scroll down and notice that the pH and pe species are in the list of \nspecies.  \n4.3 Initial Concentrations  \nThe next step is to specify the initial concentrations that define the hydrogeochemistry of \nthe aquifer at the start of the simulation (Time = 0).  \n1. In the spreadsheet, on the O(0) row, enter \u201c0.000 251\u201d in the Starting Conc. \n(moles/liter)  column.  \n2. Repeat step 1 for each of the species listed in Table 1and Table 2, respectively . \nThis specifies the initial concentrations for all the aqueous components and minerals \nused in this tutorial project.  \n      Table 1      Initial aqueous concentrations used in this tutorial  \n\nGMS Tutorials   PHT3D \u2013 Ion exchange and Surface Complexation  \n \n Page 5 of 10 \u00a9 Aquaveo 2024  Aqueous  Background and flushing \nwater  \nCbackgr , Cflush (mol/l)  \nAmm  0.0 \nO(0) 0.000251  \nCa 0.00183  \nMg 0.00138  \nNa 0.000862  \nK 0.000124  \nCl 0.00174  \nC(4) 0.00282 \nC(-4) 0.0 \nS(6) 0.000989  \nN(5) 0.000888 \nN(3) 0.0 \nN(0) 0.0 \npH 7.9 \npe 13.5 \n      Table 2      Initial mineral concentration  \nMineral  Cinit (mol/l b) \nCalcite  0.1 \n4.4 Packages  \nNext, select which packages to be used.  \n1. Click Packages\u2026  to open the MT3DMS/RT3D Packages dialog.  \n2. Turn on  Advection package , Dispersion package , and Source/Sink mixing \npackage . \n3. Click OK to close the MT3DMS/RT3D Packages  dialog.  \n4.5 Porosity Array  \nFinally, define the porosity for the cells. The problem has a constant porosity of 0.32.  \n1. Click Porosity \u2026 to open the Porosity dialog.  \n2. In the Porosity dialog, select Constant \u2192 Grid\u2026  to open the Grid Value dialog.  \n3. Enter \u201c0.32\u201d for the Constant value for grid  option then click OK to close the Grid \nValue  dialog.  \n4. Click OK t o exit the Porosity dialog.  \nThis compl etes the definition of the basic transport package data. Leave the other options \nat the default values.  \n5. Click OK to exit the Basic Transport Package  dialog.  \nGMS Tutorials   PHT3D \u2013 Ion exchange and Surface Complexation  \n \n Page 6 of 10 \u00a9 Aquaveo 2024  4.6 Run Options  \nNext, tell MT3DMS to always use the same MODFLOW solution to define the flow field. \nThis allows for the saving of the transport simulation under a different name without \nhaving to re -run MODFLOW.  \n1. Select PHT3D | Run Options\u2026  to open the Run Options  dialog.  \n2. Select Single run with selected MODFLOW solution . \n3. Click OK to close the Run Options  dialog.  \n5 Advection Package  \nThe simulation in this tutorial uses the default settings for the advection package, so \nnothing needs to be edited in the Advection Package  dialog.  \n6 Dispersion Package  \nNow edit the inputs to the dispersion package. To enter the data for the dispersion \npackage:  \n1. Select PHT3D | Dispersion Package\u2026  to open the Dispersion Package dialog.  \n2. Click Longitudinal Dispersivity\u2026  to open the Longitudinal Dispersivity  dialog.  \n3. Click Constant \u2192 Grid\u2026  to open the Grid Value dialog.  \n4. Enter \u201c0 .0067\u201d  for the Constant value for grid  option and click OK to close the \nGrid Value  dialog.  \n5. Click OK to exit the Longitudinal Dispersivity  dialog.  \n6. Click OK to exit the  Dispersion Package  dialog.  \n7 Adding Inflow Concentration  \nThe flow model has been set up with a cons tant head of 12 feet on the left of the model \nand a constant head of 10 feet on the right. The flow should move from left to right \nthrough the model grid. For the first stress period, contaminated water should only be \nentering the model from the top 3 left -most cells. The water from the bottom 7 left -most \ncells, called flushing water, should have the same concentrations with the initial \nconcentration in the model.  \n7.1 Assigning Inflow Concentrations from Flushing Water  \n1. Using the Select Cells   tool, select the bottom seven cells in the leftmost \ncolumn ( Figure 2). \n2. Right -click on one of the cells and select Properties\u2026  to open the 3D Grid Cell \nProperties dialog . \n3. On the PHT3D tab, in the first spreadsheet, enter \u201c -1\u201d in the Value  column on the \nICBUND  row. \n4. Click OK to exit the 3D Grid Cell Properties  dialog.  \n\nGMS Tutorials   PHT3D \u2013 Ion exchange and Surface Complexation  \n \n Page 7 of 10 \u00a9 Aquaveo 2024   \n      Figure 2      Select the bottom seven cells in the leftmost column  \n7.2 Assigning Inflow Concentrations from Contaminated Water  \nNow, assign the inflow concentrations of the contaminated water.  \n1. Using the Select Cells   tool, select the top three cells in the leftmost column \n(Figure 3). \n \n      Figure 3      Select the top three cells in the leftmost column  \n2. Right -click on a cell and select Sources/Sinks\u2026  to open the MODFLOW/PHT3D \nSources/Sinks dialog. \n3. Select \u201cPHT3D: Point SS\u201d from the list on the left.  \n4. Click Add BC  to create entries in the spreadsheet.  \nIt is now possible to assign the inflow concentrations of the contaminated water for the \nfirst stress period. However, this is more easily accomplish ed using the Source/Sink \nMixing Package dialog.  \n5. Click OK to exit the MODFLOW/PHT3D Source/Sinks  dialog.  \n6. Deselect the three cells by clicking anywhere outside the project cells.  \n7. Select PHT3D | Source/Sink Mixing Package\u2026  to Source/Sink Mixing Package  \ndialog.  \nThe Stress period  in the  Point sources/sinks  section defaults to \u201c1\u201d. Notice the three new \nboundary conditions listed in the spreadsheet.  \n8. Enter the contaminated water concentration, listed in Table 3, for each species in \nall three rows.  \n9. Change the Stress Period  to \u201c2\u201d.  \n10. Enter the flushing water concentration, listed in Table 1 in section 4.3, for each \nspecies in all three rows. Do not enter the Calcite  concentration from Table 2.  \n\nGMS Tutorials   PHT3D \u2013 Ion exchange and Surface Complexation  \n \n Page 8 of 10 \u00a9 Aquaveo 2024  11. Click OK to exit the Source/Sink Mixing Package  dialog.  \n      Table 3      Aqueous component concentrations in contaminated water  \nAqueous  Contaminated water  \nCcont (mol/l)  \nAmm  0.00687 \nO(0) 0 \nCa 0.00015  \nMg 0.00005  \nNa 0.0013  \nK 0.00013  \nCl 0.00323  \nC(4) 0.00292 \nC(-4) 0 \nS(6) 0.00156  \nN(5) 0 \nN(3) 0 \nN(0) 0 \npH 8.3 \npe 0 \n8 Saving the Simulation and Running PHT3D  \nIt is now possible to save the simulation and run PHT3D.  \n1. Save   the project.  \n2. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n3. When MODFLOW  finishes the simulation, turn on Read solution on exit and Turn \non contours (if not on already)  and click Close  to exit the MODFLOW  model \nwrapper dialog.  \n4. Save   the project.  \n5. Select PHT3D | Run PHT3D\u2026  to bring up the PHT3D  model wrapper dialog.  \n6. When PHT3D  finishes, turn on Read solution on exit  and click Close to exit the \nPHT3D  model wrapper dialog.  \n9 Viewing the Solution  \nAfter PHT3D finished running, GMS automatically imported the computed concentrations, \nmass files, and output file produced by PHT3D.  \n1. If necessary, expand the \u201c  pht3d_run1 (PHT3D)\u201d folder in the Project Explorer.  \n2. Select the \u201c  Amm\u201d dataset.  \n3. Select the first time step in the Time Steps window  below the Project Explorer.  \n\nGMS Tutorials   PHT3D \u2013 Ion exchange and Surface Complexation  \n \n Page 9 of 10 \u00a9 Aquaveo 2024  4. Use the up and down arrows to view the different time steps.  \nNotice that the ammonium is flushed out of the system by time step 68.  \n9.1 Time Series Data Plot  \nNext, generate the time series data plot related to the concentrations.  \n1. Select the \u201c  N(5)\u201d dataset.  \n2. Click Plot Wizard   to open the Step 1 of 2  page of the Plot Wizard  dialog.  \n3. Select \u201cActive  Dataset Time Series\u201d from the Plot Type  list on the left.  \n4. Click Finish  to close the Plot Wizard  dialog and bring up the Active Dataset Time \nSeries  dialog.  \n5. Using the Select Cells   tool, select a cell in one of the top three layers near \nthe middle of the m odel.  \nSelect different species from the Project Explorer to see how the concentration of each \nspecies varies with time.  \n6. When finished reviewing the various species, close  the Active Dataset Time \nSeries  dialog.  \n10 Ion Exchange Reactions  \nSo far, this tutorial  has not considered ion exchange reactions. To include ion exchange, \nit is necessary to include the cation species in the reaction network and define the initial \nconcentrations on the exchanger site.  \n10.1 Defining Exchange Species  \n1. Select PHT3D | Basic Transport  Package\u2026  to open the Basic Transport \nPackage  dialog.  \n2. Click Define Species\u2026  to open the PHT3D Options  dialog.  \n3. Select \u201cExchange Species\u201d from the list on the left.  \n4. Turn off Only show active species so all species show in the spreadsheet.  \n5. In the Active column, turn on NaX, KX, AmmHX, CaX2,  and MgX2 . \n6. Click OK to close the PHT3D  Options  dialog.  \n10.2 Defining Exchange Species Initial Concentrations  \nThe next step is to specify the initial concentrations of these exchange species.  \n1. In the spreadsheet, scroll down to the CaX2  row and enter \u201c0.03363\u201d in the \nStarting Conc. (moles/liter)  column.  \n2. Repeat step 1 for each of the species in Table 4. \nThis specifies the initial concentrations for these exchange species.  \n3. Click OK to close the Basic Transport Package  dialog.  \n\nGMS Tutorials   PHT3D \u2013 Ion exchange and Surface Complexation  \n \n Page 10 of 10 \u00a9 Aquaveo 2024        Table 4      Exchange Species  \nExchange \nSpecies  Concentration  \nCinit (mol/l)  \nKX 0.00000266 \nAmmHX  0 \nNaX 0.000006276  \nMgX2  0.02637  \n11 Saving the Simulation and Running PHT3D  \nIt is now possible to save the simulation under a different name and run PHT3D.  \n1. Select File | Save As\u2026  to open the Save As  dialog.  \n2. Enter \u201cpht3d_run2.gpr\u201d as the File name  and c lick Save  to close the Save As  \ndialog.  \n3. Select PHT3D | Run PHT3D\u2026  to bring up the PHT3D  model wrapper dialog.  \n4. When the PHT3D  simulation is finished, turn on Read solution on exit  and click \nthe Close  to exit the PHT3D  model wrapper dialog.  \n12 Viewing the Solution  \nAfter PHT3D finished running, GMS imported the computed concentrations, mass files, \nand output file produced by PHT3D. To view the solution data, do the following:  \n1. If necessary, expand the \u201c  pht3d_run2 (PHT3D)\u201d folder in the Project Explorer.  \n2. Select the \u201c  AmmHX\u201d dataset.  \n3. Select the first time step in the Time Steps window  below the Project Explorer.  \n4. Use the up and down arrows to view the different time steps.  \nFeel free to select different exchange species datasets from the Project Explorer to see \nhow the concentrations vary with time.  \n13 Conclusion  \nThis concludes the \u201c PHT3D \u2013 Ion Exchange and Surface Complexation \u201d tutorial. The \nfollowing key concepts were discussed and demonstrated in this tutorial:  \n\uf0b7 How to define species in PHT3D using the origina l PHREEQC -2 database . \n\uf0b7 How to specify the concentrations for a particular species.  \n\uf0b7 How to create boundary conditions with different concentrations for different \nstress periods.  \n\uf0b7 How to define exchange species.  \n \n\n", "filename": "PHT3D-IonExchangeAndSurfaceComplexation.pdf", "pages": 10}, "PHT3D-TransportAndMineralReactions": {"text": "GMS Tutorials   PHT3D \u2013 Transport and Mineral Reactions  \n Page 1 of 8 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nPHT3D \u2013 Transport and Mineral Reactions  \nPHT3D Geochemical Reactions  \n \nObjectives   \nThis tutorial demonstrates transport and mineral reactions in PHT3D.  \n \nPrerequisite Tutorials  \n\uf0b7 MT3DMS \u2013 Grid Approach  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 MT3D  \n\uf0b7 PHT3D  \n Time  \n\uf0b7 20\u201330 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   PHT3D \u2013 Transport and Mineral Reactions  \n Page 2 of 8 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Description of Problem  ................................ ................................ ................................ . 2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n3 Importing the Flow Model  ................................ ................................ ................................ ... 3 \n3.1 Saving the Project with a New Name  ................................ ................................ ............  3 \n4 Building the Transport Model  ................................ ................................ .............................  3 \n4.1 Initializing the Simulation  ................................ ................................ ..............................  4 \n4.2 Specifying PHT3D Reaction Definitions  ................................ ................................ ........  4 \n4.3 Specifying Initial Concentrations  ................................ ................................ ...................  4 \n4.4 Selecting Packages  ................................ ................................ ................................ ...... 5 \n4.5 Defining the Porosity Array  ................................ ................................ ...........................  5 \n4.6 Setting Run Options  ................................ ................................ ................................ ...... 5 \n5 Advection Package  ................................ ................................ ................................ ..............  6 \n6 Dispersi on Package ................................ ................................ ................................ .............  6 \n7 Adding Inflow Concentrations  ................................ ................................ ............................  6 \n7.1 Assigning Inflow Concentrations  ................................ ................................ ...................  6 \n8 Saving the Simulation and Running PHT3D  ................................ ................................ ...... 7 \n9 Viewing the Solution  ................................ ................................ ................................ ...........  8 \n9.1 Time Series Data Plot  ................................ ................................ ................................ ... 8 \n10 Conclusion  ................................ ................................ ................................ ...........................  8 \n \n1 Introduction  \nPHT3D is a multi -component transport model for three -dimensional reactive transport in \nsaturated porous media . It is  developed and maintained by Henning Prommer and \nVincent Post (2010) .1 PHT3D is a combination of MT3DMS and PHREEQC -2. \nPHREEQC -2 allows for a variety of low temperature , aqueous -geochemical reactions.  \nThe simulation of mineral dissolution and precipitation  reactions is one of the key features \nof PHT3D , and one or more of them will be  included in many typical model applications. \nThe case described in this tutorial was originally presented by Engesgaard and Kipp \n(1992)2 for a model verification of  their MST1D code against the CH MTRNS model by \nNoorishad et al. (198 7).3  \nIt involves a one -dimensional , model domain in which an aqueous water composition  that \nis in equilibrium with two minerals, calcite and dolomite, is successively  replaced, that is,  \nflushed by water of a different chemical composition, leading to  multiple precipitation -\ndissolution fronts. Dolomite is not present initially , but is  formed temporally.  \n1.1 Description of Problem  \nIn order to follow the discretization  chosen by Engesgaard and Kipp  (1992), the project \nwill create a model domain of 0.5 m lengt h divided into 50 grid cells of 0.01 m  length, 1 m \nwidth and 1 m height (50 columns, 1 row and 1 layer). A steady -state  flow rate Q well of \n0.259 m3 /d is required to achieve a pore -velocity of 0.083 m /d for the given porosity of \n0.32.  The total  simulation t ime is 0.2430 days. It is divided into 210 time steps.  \n                                                      \n1 Prommer, H., and Post, V. (2010). A reactive multicomponent transport model for saturated \nporous media. User\u2019s Manual v2.10.  \n2 Engesgaard, P., and Kipp, K.L. (1992). A geochemical transport model for redox -controlled \nmovement of mineral fronts in groundwater flow systems: A case of nitrate removal by oxidation of \npyrite. Water Resource Research 28: 2829 \u20132843 . \n3 Noorishad, J., Carnahan, C.L., and Benson, L.V. (1987). A report on the development of the non -\nequilibrium reactive chemical transport code CHMTRNS. (Berkeley, CA: Lawrence Berkeley \nLaboratory).  \nGMS Tutorials   PHT3D \u2013 Transport and Mineral Reactions  \n \n Page 3 of 8 \u00a9 Aquaveo 2024  2 Getting Started  \nDo the following to get started:  \n1. If GMS is not running, launch GMS.  \n2. If GMS is already running, select File | New to ensure the program settings \nare restored to the default state.  \n3 Impor ting the Flow Model  \nBefore setting up the PHT3D simulation, a MODFLOW solution must exist to be used as \nthe flow field for the transport simulation. In the interest of time, import a previously \ncreated MODFLOW simulation.  \n1. Click Open   to bring up the Open  dialog.  \n2. Browse to the MineralReactions  folder and select \u201cstart.gpr\u201d.  \n3. Click Open  to import the file.  \nThe flow model has already been created in this example ( Figure 1). \n \n      Figure 1      Flow model  \n3.1 Saving the Project with a New Name  \nBefore continuing, save the project with a new name.  \n1. Select File | Save As\u2026  to bring up the Save  As dialog.  \n2. Enter  \u201cmineral_dis_pre.gpr\u201d as the File name  and click Save  to exit the Save As  \ndialog.  \nIt is recommended to periodically save the project . \n4 Building the Transport Model  \nWith a flow solution, it is possible to set up the PHT3D transport simulat ion. \n\nGMS Tutorials   PHT3D \u2013 Transport and Mineral Reactions  \n \n Page 4 of 8 \u00a9 Aquaveo 2024  4.1 Initializing the Simulation  \nFirst, initialize the simulation.  \n1. Right -click in the Project Explorer and select Expand All . \n2. Right -click on \u201c  grid\u201d and select New MT3DMS\u2026  to open the Basic Transport \nPackage dialog.  \n3. In the Model  section, select PHT3D.  \n4.2 Specifying PHT3D Reaction Definitions  \nIn some cases, the next step would be to prepare a problem -specific reaction module. \nHowever, for simple problems, such as those that only include equilibrium reactions, this \nis not the case. All of the aqueous species , components, and minerals needed to \nsimulate this LEA -based reactive transport problem are already included in the original \nPHREEEQC -2 database. This means that a user -defined set of equilibrium reactions \ndoes not need to be created. Instead, use the PHRE EQC -2 database.  \nTo specify the reaction definitions, do the following:  \n1. Click Define Species\u2026  to open the PHT3D Options dialog.  \nNotice that the first item in the list on the left is General Options . This dialog allows for the \ndefinition the species uses as  well as PHT3D general options.  \n2. Select \u201cEquilibrium Species\u201d from the list box on the left of the dialog.  \nBecause a PHREEQC database has not yet been selected, it is not yet possible to view \nany candidate equilibrium species. To select a PHREEQC database,  do the following:  \n3. Click the Open   button next to PHREEQC database  to bring up an Open  \ndialog.  \n4. Select \u201cpht3d_datab.dat\u201d and click Open  to import the file.  \nGMS has now imported the PHREEQC database and made available the different \ncomponents included in th e file. Now select the components to model by doing the \nfollowing:  \n5. In the Active  column in the spreadsheet, turn on  Ca, Mg, Cl and C(4).  \nNote that pH and pe species are automatically included in all simulations.  \n6. Select \u201cEquilibrium Minerals/Phases\u201d from the list on the left.  \n7. In the Active column in the spreadsheet, turn on Calcite  and Dolomite . \nThe selection of species to include in the simulation is now completed.  \n8. Click OK to close the PHT3D Options  dialog.  \n4.3 Specifying Initial Concentrations  \nThe next step is to specify the initial concentrations that define the hydrogeochemistry of \nthe aquifer at the start of the simulation (Time = 0).  \n1. In the Starting Conc. (moles/liter) column in the spreadsheet, enter \u201c0.000123\u201d on \nthe Ca row. \n2. Repeat step 1 for each of the components listed in Table 1 and Table 2. \n\nGMS Tutorials   PHT3D \u2013 Transport and Mineral Reactions  \n \n Page 5 of 8 \u00a9 Aquaveo 2024  Note that the aqueous concentrations are always defined in units of mol/l . In contrast, the \nunit for the initial concentrations of minerals is not mass per volume of water, i.e., mol/l, \nbut is defined as mass per bulk volume, mol/l volume . \n      Table 1      Aqueous concentrations used in this tutorial  \nAqueous \ncomponent  Cinit \n(mol/l w) \nCa 0.000123  \nMg 0.0 \nCl 0.0 \nC(4) 0.000123  \npH 9.91 \npe 4.0 \n      Table 2      Mineral concentrations used in this tutorial  \nMineral  Cinit (mol/l v) \nCalcite ( CaCO 3) 0.00003906 \nDolomite \n(CaMg(CO 3)2) 0.0 \n4.4 Selecting Packages  \nNext, select which packages to use.  \n1. Click Packages\u2026  to open the MT3DMS/RT3D Packages dialog.  \n2. Turn on Advection package , Dispersion package , and Source/Sink mixing \npackage . \n3. Click OK to close the MT3DMS/RT3D Packages  dialog.  \n4.5 Defining the Porosity Array  \nFinally, define the porosity for the cells. The problem has a constant porosity of 0.32.  \n1. Click Porosity\u2026  to open the Porosity  dialog.  \n2. Click Constant \u2192 Grid  to open the Grid Value dialog.  \n3. Enter \u201c0.32\u201d as the Constant value for grid  and click OK to close the Grid Value  \ndialog.  \n4. Click OK to exit the Porosity dialog.  \nThis completes the def inition of the Basic Trans port P ackage  data. Leave the other \noptions at the default values.  \n5. Click OK to exit the Basic Transport Package  dialog.  \n4.6 Setting Run Options  \nNext, tell MT3DMS to always use the same MODFLOW solution to define the flow field. \nThis will allow the transport sim ulation to be saved under a different name without having \nto re-run MODFLOW.  \nGMS Tutorials   PHT3D \u2013 Transport and Mineral Reactions  \n \n Page 6 of 8 \u00a9 Aquaveo 2024  1. Select PHT3D | Run Options\u2026  to open the Run Options  dialog.  \n2. Select Single run with selected MODFLOW solution  and click OK to close the \nRun Options  dialog.  \n5 Advection Package  \nThe Advection Package  has been included in the simulation. The default settings in the \npackage will be used, so nothing needs to be changed.  \n6 Dispersion Package  \nNow edit the inputs to the dispersion package by doing the following:  \n1. Select PHT3D | Dispersion Package\u2026  to open the Dispersion Package  dialog.  \n2. Click Longitudinal Dispersivity\u2026  to open the Longitudinal Dispersivity  dialog.  \n3. Click Constant \u2192 Grid\u2026  to open the Grid Value dialog.  \n4. Enter \u201c0 .0067\u201d as the Constant value for grid  and click OK to close the Grid \nValue  dialog.  \n5. Click OK to exit the Longitudinal Dispersivity  dialog.  \n6. Click OK to exit the Dispersion Package  dialog.  \n7 Adding Inflow Concentrations  \nThe flow model has been set up with an injection well on the left of the model and a \nconstant head boundary condition on the right. The flow should move from left to right \nthrough the model grid. By default, water entering the model from the well will have a \nconcentration of \u201c0.0\u201d for each of the species in the model. It is necessary to change the \nconcentrations  in the water from the injection well.  \n7.1 Assigning Inflow Concentrations  \n1. Using the Select Cells   tool, right -click on the left -most cell and select \nSources/Sinks\u2026  to open the MODFLOW/PHT3D Sources/Sinks dialog . \n2. Select \u201cPH3TD: Point SS\u201d  from the list on the left. \n3. Click Add BC  to an entry in the spreadsheet.  \n4. Select \u201cwell (WEL)\u201d from the drop -down on row 1 in the Type (ITYPE)  column.  \n5. Using Table 3, enter the values for each component in the corresponding \ncolumn.  \n6. Click OK to exit the MODFLOW/PHT3D Sources/Sinks  dialog.  \n      Table 3      Inflow Concentrations  \nAque ous \ncomponent  Cinflow \n(mol/l w) \nCa 0.0 \n\nGMS Tutorials   PHT3D \u2013 Transport and Mineral Reactions  \n \n Page 7 of 8 \u00a9 Aquaveo 2024  Mg 0.001  \nCl 0.002  \nC(4) 0.0 \npH 7.0 \npe 4.0 \n8 Saving the Simulation and Running PHT3D  \nBefore running PHT3D, the project needs to be saved.  \n1. Save   the project.  \n2. Select MODFLOW | Run MODFLOW  to bring up the MODFLOW  model wrapper \ndialog.  \n3. When the MODFLOW  simulation finishes, turn on Read solution on exit  and Turn \non contours (if not on already) . \n4. Click Close  to exit the MODFLOW  model wrapper dialog.  \n5. Save   the project . \n6. Select PHT3D | Run PHT3D\u2026  to bring up the PHT3D  model wrapper dialog.  \n7. When the PHT3D  simulation finishes, turn on Read solution on exit  and click \nClose  to exit the PHT3D  model wrapper dialog.  \nThe project should appear similar to Figure 2. \n \n      Figure 2      After PHT3D is run  \n\nGMS Tutorials   PHT3D \u2013 Transport and Mineral Reactions  \n \n Page 8 of 8 \u00a9 Aquaveo 2024  9 Viewing the Solution  \nAfter PHT3D finished running, GMS automatically imports the computed concentrations, \nmass files, and output file produced by PH T3D. All of this data is under a new folder in \nthe Project Explorer  called \u201c mineral_dis_pre (PHT3D) \u201d. \n1. Expand the \u201c  mineral_dis_pre (PHT3D) \u201d folder  in the Project Explorer  (if \nnecessary) and select the \u201c  Ca\u201d dataset.  \n2. Select the first time step  in the Time  Step Window  below the Project Explorer . \n3. Use the up and down arrows to view the different time steps.  \n9.1 Time Series Data Plot  \nNext, generate the time series data plot related to the concentrations.  \n1. Select the \u201c  Dolomite\u201d dataset.  \n2. Click Plot Wizard   to open  the Step 1 of 2  page of the Plot Wizard  dialog.  \n3. Select \u201cActive Dataset Time Series\u201d from the list on the left.  \n4. Click Finish  to close the Plot Wizard  and generate the plot.  \n5. Using the Select Cells   tool, select any cell on the model.  \nThe concentration of d olomite over time should now be visible. Note that dolomite  is not \npresent initially but is formed temporally.  \n10 Conclusion  \nThis concludes the \u201cPHT3D \u2013 Transport and Mineral Reactions\u201d tutorial. The following \nkey concepts were discussed and demonstrated in this tutorial:  \n\uf0b7 How to define species in PHT3D using the original PHREEQC -2 database.  \n\uf0b7 How to specify the concentrations for a particular species.  \n \n\n", "filename": "PHT3D-TransportAndMineralReactions.pdf", "pages": 8}, "PrintingAndExportingImages": {"text": "GMS Tutorials   Printing and Exporting Images  \n Page 1 of 6 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nPrinting and Exporting Images  \nPrint and export images for use in reports and pres entations  \n \nObjectives   \nGMS has a number of ways to print or export images for use in reports and presentations. This tutorial \nteaches about these different options.  \n \nPrerequisite Tutorials  \n\uf0b7 None  Required Components  \n\uf0b7 None  \n Time  \n\uf0b7 10\u201315 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   Printing and Exporting Images  \n Page 2 of 6 \u00a9 Aquaveo 2024  1 Introduction and Getting Started  ................................ ................................ .......................  2 \n2 Graphical Output  ................................ ................................ ................................ .................  2 \n2.1 Printing  ................................ ................................ ................................ .........................  2 \n2.2 Saving Images  ................................ ................................ ................................ ..............  4 \n2.3 Completing a Screen Capture ................................ ................................ .......................  5 \n3 Conclusion  ................................ ................................ ................................ ...........................  6 \n \n1 Introduction and Getting Started  \nThis GMS tutorial discusses printing, exporting an image to a file, and copying the GMS \nscreen to the clipboard and pasting it into another program  \nTo get started, do the following:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2 Graphical Output  \nAfter creating a GMS project, the user may want to include some  images of the project in \na printed report or on a web site. Graphical output can be obtained from GMS in multiple \nways. Users will often want to export graphics from GMS and import them into another \nprogram in order to add things like titles, borders, and  other embellishments.  \n2.1 Printing  \nPrinting from GMS can require multiple steps, all of which are described here. The File \nmenu has two commands related to printing: Print  and Page Setup . These two \ncommands can be used to send whatever is currently displayed in the graphics window \nto a printer.  \nPage Setup Dialog  \n1. Select File | Page Setup\u2026  to bring up the Page Setup  dialog ( Figure 1). \n2. On the Margins  tab, mak e any necessary adjustments to the top, bottom, left, \nand right margins of the document before printing.  \n3. On the Paper Size tab, choose the desired size of paper (letter, legal, etc.) on \nwhich to print.  \n4. If the printer has multiple paper sources, select the desired source from the \nPaper Source  drop-down.  \n5. In the Orientation section, choose either Portrait  or Landscape for the page \norientation.  \n6. On the Options  tab in the Scale/Legend  section, set the scale of the image, \nwhether to display a scale legend, and which font and font color are to be used \nfor the legend.  \n7. The Units  section allows setting of the units to be used for the scale and legend.  \n8. Click OK to close the Page Setup  dialog .  \nGMS Tutorials   Printing and Exporting Images  \n \n Page 3 of 6 \u00a9 Aquaveo 2024   \n      Figure 1      Page Setup dialog on the Margins tab  \nPrint  Dialog  \n1. Select File | Print\u2026 to bring up the Print dialog ( Figure 2).  \n2. From the  Name  drop-down, select the desired printer.  \n3. In the Print Range section, specify how many pages of the document should be \nprinted. Choosing the Selection  radio button will print only what is selected in the \nGraphics Window.  \n4. In the Copies section, specify  the number of copies and whether or not those \ncopies should be collated.  \n5. Click on the Properties  button to bring up the Document Properties  dialog for the \nselected printer. Different tabs and options will be available depending on the \nselected printer. Co mmon options include page orientation (portrait or \nlandscape), paper size, and others. Make any desired changes.  \n6. Click OK to close the Document  Properties  dialog.  \n7. Click OK to print the document or selection, or Cancel  to close the Print dialog \nwithout printing.  \nThe defaults in the Print dialog will often be the desired settings. This simplifies the \nprocess of printing a document or selection.  \n\nGMS Tutorials   Printing and Exporting Images  \n \n Page 4 of 6 \u00a9 Aquaveo 2024   \n      Figure 2      Print dialog  \n2.2 Saving Images  \nGMS allows exporting  the current display as one of the following types of image file:  \n\uf0b7 BMP  \n\uf0b7 JPG/JPEG  \n\uf0b7 KMZ (raster or vector)  \n\uf0b7 PNG  \n\uf0b7 TIF/TIFF  \nFirst, import a project file:  \n1. Click Open   to bring up the Open  dialog.  \n2. Browse to the basics  directory and select \u201csurface.gpr\u201d.  \n3. Click Open  to import the project and close the Open  dialog.  \n \n      Figure 3    The TIN contained in the \"surface.g pr\" project file  \nTo export the screen as an image, do the following:  \n\nGMS Tutorials   Printing and Exporting Images  \n \n Page 5 of 6 \u00a9 Aquaveo 2024  4. Select File | Save As\u2026  to bring up the Save As  dialog.  \n5. Select \u201cBitmap Files (*.bmp)\u201d from the Save as type  drop-down.  \n6. Click Options  to bring up the Save Options  dialog.  \nBy default, the image scale factor is \u201c1.0\u201d, meaning the size of the bitmap is the same as \nthe current size of the graphics window.  Depending  on the use for the image, this may \nbe adequate; however, if the image is to be used on a large poster, for instance, then the \nindividual pixels will become apparent and distracting.  \nImprove the quality of the image by increasing the size of the window to  which the image \nis pasted. To do that, either increase the resolution of the computer screen or increase \nthe bitmap scale factor in this dialog. The following step will accomplish the latter option.  \n7. Enter \u201c1.5\u201d in the Image scale factor  field.  \nA value of  \u201c1.5\u201d instructs GMS to scale the exported image to a size one -and-a-half times \nlarger than what is visible in the Graphics Window.  \n8. Click OK to close the Save Options  dialog.  \n9. Enter \u201cBiggerSurface.bmp\u201d in the File name  field.  \n10. Click Save  to export the image  and close the Save As  dialog.  \nThe \u201cBiggerSurface.bmp\u201d file can now be opened in another program.  \n2.3 Completing a Screen Capture  \nGMS includes a screen capture command that takes whatever is currently displayed in \nthe Graphics Window and copies it as a bitmap to the clipboard. The image can then be \npasted into another program.  \n1. Select Edit | Screen Capture\u2026  to bring up the Copy to Clipboard  dialog.  \nNotice that it is possible to specify a Bitmap scale factor  here also. However, the \nclipboard has a limited amount of memory available to it; thus, GMS may not be able to \nscale the image up as much as it could when saving the file to disk. If a screen capture \nwill not paste into another program, try reducing the s cale factor.  \n2. Enter \u201c1.0\u201d in the Bitmap scale factor  field.  \n3. Click OK to finish the screen capture and close the Copy to Clipboard  dialog.  \n4. Open a word processing program and paste (usually accomplished by pressing \nCtrl-V) the image from the clipboard into th e program.  \nIn this example, a word processing document was used to show how to paste from the \nclipboard. These same instructions can be generally applied to any program which allows \npasting of images from the clipboard. Please refer to the documentation f or the program \nbeing used for more specific instructions.  \n  \nGMS Tutorials   Printing and Exporting Images  \n \n Page 6 of 6 \u00a9 Aquaveo 2024  3 Conclusion  \nThis concludes the GMS \u201cPrinting and Exporting Images\u201d tutorial. The following topics \nwere discussed in this tutorial:  \n\uf0b7 GMS allows printing and exporting images in a number of ways.  \n\uf0b7 Bitmaps and other types of image files can be saved at various resolutions using \nthe scale factor options.  \n\uf0b7 The Graphics Window can be copied at various resolutions to the clipboard and \npasted into other programs.  \n \n", "filename": "PrintingAndExportingImages.pdf", "pages": 6}, "PrintLayout": {"text": "GMS Tutorials   Getting Started  \n Page 1 of 13 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nGMS Layout Editor  \nCreate and save layouts for printing model data from GMS  \n \nObjectives   \nLearn how to use the Layout Editor to create printed reports from GMS.  \n \nPrerequisite Tutorials  \n\uf0b7 Getting started  Required Components  \n\uf0b7 None  \n Time  \n\uf0b7 15\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   Getting Started  \n Page 2 of 13 \u00a9 Aquaveo 2024  1 Introduction and Getting Started  ................................ ................................ .......................  2 \n2 GMS User Interface ................................ ................................ ................................ ..............  2 \n3 Creati ng a Layout  ................................ ................................ ................................ ................  3 \n3.1 Inserting a Map  ................................ ................................ ................................ .............  4 \n3.2 Insert ing a Scale Bar  ................................ ................................ ................................ .... 5 \n3.3 Inserting a North Arrow  ................................ ................................ ................................ . 7 \n4 Adding Another Map to the Layout  ................................ ................................ ....................  9 \n5 Printing the Layout  ................................ ................................ ................................ ............  11 \n6 Exporting and Importing Layouts  ................................ ................................ ....................  12 \n7 Conclusion  ................................ ................................ ................................ .........................  13 \n \n1 Introduction and Getting Started  \nThe Layout tool can be used to create print layouts of GMS project data. Layouts may \ncontain multiple maps/views of project data as well as annotations, north arrows, and \nscale bars. The layout tool provides a mechanism for quickly preparing model outputs for \nreports. A layout template can also be created and used in multiple projects.  This tutorial \ngoes over the options available for creating layouts in GMS.  \nThis tutorial will discuss importing a GMS project, creating a layout, printing that layout, \nexporting a layout template for use in other projects, and importing and using a \npreviously -exported layout  template.  \nTo get started:  \n1. If necessary, launch GMS.   \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2 GMS User Interface  \nBegin by importing a GMS project.  \n1. Click Open   to bring up the Open dialog.  \n2. Browse to the PrintLayout folder and select \u201cstart.gpr\u201d . \n3. Click Open  to import the file and close the Open  dialog.  \nThe GMS graphics window should look similar to Figure 1. This project contains a single \nshapefile of the United States of America.  \n\nGMS Tutorials   Getting Started  \n \n Page 3 of 13 \u00a9 Aquaveo 2024   \n      Figure 1      Shape file loaded into GMS  \n3 Creating a Layout  \nTo create a print layout, do the following:  \n1. Select File | Layout (Beta)\u2026  to bring up the Layout Editor dialog ( Figure 2). \n \n      Figure 2      Layout Editor dialog  \nThe Layout Editor dialog is similar to the page setup in a word processor. The default \npage is the typical 8\u201d X 11\u201d in portrait. Choose a different paper size or use landscape by \nchanging the settings through File | Page Setup\u2026  and the Page Setup  dialog. The \ntutorial uses t he default settings for this exercise.  \nThere are 5 basic components that can be added to a layout:  \n\uf0b7 Map  \u2013 A view of the GMS data. Multiple maps (different views) may be \ninserted into a layout.  \n\nGMS Tutorials   Getting Started  \n \n Page 4 of 13 \u00a9 Aquaveo 2024  \uf0b7 North Arrow   \u2013 A north arrow associated with a particular map . \n\uf0b7 Scale Bar   \u2013 A scale bar associated with a particular map.  \n\uf0b7 Text  \u2013 A text box for adding textual information to the layout; multiple text \nitems may be included in a layout.  \n\uf0b7 Rectangle   \u2013 Multiple rectangles may be included in a layout.  \n\uf0b7 Bitmap   \u2013 A bitmap to insert an image into the layout.  \n3.1 Inserting a Map  \nBegin by inserting a map into the layout.  \n1. Select the  Insert Map   tool from the toolbar.  \n2. Click and drag a rectangle as shown in Figure 3. \n \n      Figure 3      Location of inserted map in Layout Editor dialog  \nAfter inserting the map, the layout should look similar to Figure 4. \n\nGMS Tutorials   Getting Started  \n \n Page 5 of 13 \u00a9 Aquaveo 2024   \n       Figure 4      Layout Editor dialog  with newly i nserted m ap \nOn the upper right side of the Layout Editor dialog is a thumbnail of the map image \nlabelled \u201cMap  1\u201d. This objects list will show all of the items that are inserted into the \nlayout. Below the objects list is the properties section, showing the properties for the item \nselected in the objects list. In this case, the field shows the properties of \u201cMap 1\u201d : \nLocation , Name , Size, Scale , and XMS . \n3. In the properties section, enter \u201cUS Extents\u201d in the field to the right of Name .  \n4. Select \u201cMap 1\u201d in the objects list above the properties window to update the \nname.  \nThis map stores the view from GMS in the View Properties  portion of the properties. This \nincludes the zoom level and maximum/minimum coordinates that are visible in the current \nGMS view.  \n3.2 Inserting a Scale Bar  \nNow, insert a scale bar that will be associated with the \u201cUS Extents\u201d map.  \n1. Select the Insert  Scale Bar   tool, then click and drag a rectangle as shown in \nFigure 5. \n\nGMS Tutorials   Getting Started  \n \n Page 6 of 13 \u00a9 Aquaveo 2024   \n      Figure 5      Inserting a scale b ar \nOnce the scale bar is created, the layout should appear similar to Figure 6: \n \n      Figure 6      Scale bar inserted into l ayout  \nLook at the properties for the scale bar. Notice that one of the properties is Map. This \nindicates that the scale bar is associated with the \u201cUS Extents\u201d map. When more than \none map is included in the layout, this property is used to assure that the scale bar is \nassoc iated with the appropriate map. Another important property for the scale bar is the \nUnit. Currently the Unit is set to \u201cKilometers\u201d. To see the effect on the scale bar, change \nthe unit to miles.  \n2. Select \u201cScale Bar 1\u201d in the objects section.  \n3. Select \u201cMiles\u201d f rom the Unit drop-down in the properties section.  \n4. Enter \u201cmiles\u201d in the Unit Text  field.  \n\nGMS Tutorials   Getting Started  \n \n Page 7 of 13 \u00a9 Aquaveo 2024  The scale bar also has options for changing the color, font and adjusting the background. \nFeel free to explore those options.  \n3.3 Inserting a North Arrow  \nTo insert a north arrow into the layout, do the following:  \n1. Select the Insert North Arrow  tool, then click and drag a rectangle as shown \nin Figure 7. \n \n      Figure 7      Inserting a north arrow  \nOnce the north arrow is created, the layout should appear similar to Figure 8. Like the \nscale bar, the north arrow is associated with a particular map, where Map is one of the \nproperties of the north arrow. The style of north arrow can be changed by selecting the \nNorth ArrowStyle  property and choosing one of the items in the list.  \n2. Select \u201cNorth Arrow 1\u201d in the objects section.  \n3. Select \u201cCenterStar\u201d from the NorthArrowStyle  drop-down in the properties \nsection.  \nIf the north arrow is on top of part of the map, it may be hard to see. The background \ncolor for the arrow can be changed using the  button to the right of Background  in the \nproperties section. The color and pattern style of the background, as well as the  opacity \nof the background and outline, can be adjusted in the Polygon Symbolizer Properties  \ndialog that appears when the  button is clicked.  \n\nGMS Tutorials   Getting Started  \n \n Page 8 of 13 \u00a9 Aquaveo 2024   \n      Figure 8      North arrow inserted into l ayout  \n4. Click in the Background  property field, then click on the  button to bring up the \nPolygon Symbolizer Properties  dialog . \n5. On the Simple  tab under the Pattern Type  drop-down, click the large colored \nbutton to bring up the Color  dialog.  \n6. Select cyan (the top color in the blue column) and clic k OK to close the Color  \ndialog.  \n7. Move the Fill Color  slider all the way to the right to make the color fully opaque \n(Figure 9). \n8. Click OK to exit the Polygon Symbolizer Properties  dialog.  \n \n      Figure 9      Polygon Symbolizer Properties dialog  \n\nGMS Tutorials   Getting Started  \n \n Page 9 of 13 \u00a9 Aquaveo 2024  Notice that the north arrow now has a cyan background. Inserting text boxes, rectangles, \nand bitmaps is very similar to the steps desc ribed above for north arrows and scale bars, \nso this tutorial will not go through those steps. Feel free to explore those options later.  \n9. Click OK to close the Layout  Editor  dialog.  \n4 Adding Another Map to the Layout  \nNow to make a second map in the layout. Be fore adding a second map to the layout, \nsome of the view and display options should be changed. Choosing a different Display \nTheme will change the view and display options quickly.  \n1. Expand the \u201c  Display Themes\u201d folder in the Project Explorer and select \n\u201cOblique View\u201d. The Graphics Window should appear similar to Figure 10. \n \n      Figure 10       Oblique view of shapefile with new display options  \n2. Select File | Layout (Beta)\u2026  to bring up the Layout Editor  dialog.  \nThe layout will now look similar to Figure 10. Notice that the shapefile is now displayed in \nan orange color in the existing map in the layout. Any map saved in the layout is updated \nwith the current display options.  \nTo add another map to the layout:  \n3. Select the Insert Map   tool from the toolbar.  \n4. Click and drag a rectangle as shown in Figure 11. There are now two maps \nincluded in the layout.  \n\nGMS Tutorials   Getting Started  \n \n Page 10 of 13 \u00a9 Aquaveo 2024   \n      Figure 11       Creating a second map  \nAfter the new map is inserted, the Layout  Editor  window will look like Figure 12: \n \n      Figure 12      Layout with two maps  \n5. Select the Insert Scale Bar   tool. \nAn error message displays stating that scale bars are only supported for plan view maps. \nHowever, a north arrow can be inserted with this map control.  \n6. Select OK to close the error message.  \n7. Select the Insert North Arrow   tool then click and drag a rectangle as shown \nin Figure 13. \n\nGMS Tutorials   Getting Started  \n \n Page 11 of 13 \u00a9 Aquaveo 2024   \n      Figure 13       Inserting a north arrow for the second map  \nAfter inserting the north arrow the layout should look similar to Figure 14. Notice that the \nnorth arrow is rotated to match the north direction in the map.  \n \n      Figure 14       North arrow with oblique view map  \n5 Printing th e Layout  \nTo print the layout, do the following:  \n1. Select Layout  | Print\u2026  to bring up the Print dialog.  \n\nGMS Tutorials   Getting Started  \n \n Page 12 of 13 \u00a9 Aquaveo 2024  2. In the Print section, select the desired printer from the Name drop-down menu.  \n3. Click OK to print the layout and close the Print dialog.  \n6 Exporting and Importing Layouts  \nLayouts can be reused in different projects. Exporting a layout allows it to be used later or \nin other projects. To export a layout:  \n1. Select Layout | Export\u2026  to bring up the Export Layout  dialog.  \n2. Browse to the Basics \\PrintLayout  directory.  \n3. Enter \u201cDemo.mwl\u201d in the File name  field.  \n4. Click Save  to export the layout and close the Export Layout  dialog.  \nTo import a previously -created layout:  \n1. Select Layout  | Import\u2026  to bring up the Load Print Layout  dialog.  \n2. Select  No if the  DotSpatial Print Layout  dialog pops up.  \n3. Browse to the Basics \\PrintLayout  directory and select \u201cTemplateLayout.mwl\u201d.  \n4. Click Open  to import the layout and close the  Load Print Layout  dialog.  \nThe layout should appear as in Figure 15. \n  \n      Figure 15      Imported layout  \nThis layout contains a title block with text and a logo as well as a map and a north arrow. \nTo update the map to match the current view in GMS, do the following:  \n1. Select \u201cMap 1\u201d from the objects list and click the Update Current View   tool. \nThe layout should now look like Figure 16. Notice that the north arrow updated to reflect \nthe changes made to the map.  \n\nGMS Tutorials   Getting Started  \n \n Page 13 of 13 \u00a9 Aquaveo 2024   \n      Figure 16      Updated map with north arrow updated  \n2. Click OK to close the Layout Editor  window and return to the Main Graphics \nWindow in GMS.  \n7 Conclusion  \nThis concludes the \u201cLayout Editor \u201d tutorial.   The following topics were discussed:  \n\uf0b7 How to create print layouts in GMS.  \n\uf0b7 Inserting multiple maps into a layout.  \n\uf0b7 Inserting scale bars and north arrow objects in a layout, including that scale bars \ncan only be used with maps in Plan view.  \n\uf0b7 Exporting layouts for use in other GMS projects.  \n \n \n\n", "filename": "PrintLayout.pdf", "pages": 13}, "Projections": {"text": "GMS Tutorials   Projections / Coordinate Systems  \n Page 1 of 11 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nProjections / Coordinate Systems  \nWorking with map projections in GMS  \n \nObjectives   \nLearn how to work with projections in GMS, and how to combine data from different coordinate systems \ninto the same GMS project.   \n \nPrerequisite Tutorials  \n\uf0b7 Feature Objects  \n\uf0b7 Rasters  Required Components  \n\uf0b7 GMS Core  \n Time  \n\uf0b7 20\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   Projections / Coordinate Systems  \n Page 2 of 11 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n3 Importing an Image ................................ ................................ ................................ ..............  3 \n3.1 Setting the Projection  ................................ ................................ ................................ .... 3 \n3.2 Setting Transparency  ................................ ................................ ................................ .... 4 \n4 Importing a CAD File  ................................ ................................ ................................ ...........  5 \n5 Importing a Shapefile  ................................ ................................ ................................ ..........  7 \n6 Impo rting Elevation Data  ................................ ................................ ................................ .... 8 \n6.1 Editing the Scatter Points  ................................ ................................ ...........................  10 \n7 Creating a Coverage  ................................ ................................ ................................ ..........  10 \n8 Creating a 3D Grid  ................................ ................................ ................................ .............  10 \n9 Conclu sion ................................ ................................ ................................ .........................  11 \n \n1 Introduction  \nCoordinate systems and map projections provide information for locating data on the \nEarth (georeferencing ). There are two types of coordinate systems: geographic and \nprojected.  \nA geographic coordinate system uses a three dimensional sphere to locate data on the \nEarth. Data in a geographic coordinate system is referenced using latitude and longitude. \nLatitude  and longitude are angles measured from the Earth's center to a point on the \nEarth's surface.  \nA projected coordinate system is two dimensional based on a sphere or spheroid. Unlike \na geographic coordinate system, projected coordinate systems have constant  lengths, \nangles, and areas across the two dimensions.1 \nA PRJ file is a text file containing information describing the type coordinate system and \nother relevant data to position the related data on the Earth. This tutorial provides an \noverview of working with projected data in GMS through the following steps:   \n\uf0b7 Importing a TIFF file and assigning a projection  \n\uf0b7 Learning about the Display Projection  \n\uf0b7 Importing a CAD file and assigning a different projection  \n\uf0b7 Learning about \u201cProject on the fly\u201d  \n\uf0b7 Importing a shapef ile with an associated projection  \n\uf0b7 Importing elevation data and edit points  \n\uf0b7 Creating a coverage and a 3D grid  \n \n \n \n \n \n \n                                                      \n1 Information summarized from ESRI:  \nhttp://webhelp.esri.com/arcgisdesktop/9.2/index.cfm?TopicName=projection_basics_the_gis_profe\nssional_needs_to_know  \nGMS Tutorials   Projections / Coordinate Systems  \n \n Page 3 of 11 \u00a9 Aquaveo 2024  2 Getting Started  \nTo get started, do the following:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n3 Importing an Image  \nStart by importing an image of an area where the model will be built. The image was \ndownloaded from the state of Massachusetts.  \n1. Click Open   to bring up the Open  dialog.  \n2. Navigate to the Projections  folder for this tutorial.  \n3. Select \u201cImages (*.tif, *.tiff;\u2026)\u201d from the Files of type  drop-down.  \n4. Select \u201cq233914.tif\u201d and click Open  to import the image and close the Open  \ndialog.  \n5. Move the mouse around in the Graphics Wind ow. \nNotice that the lower right corner of the image is at x=233,000 and y=914,000 (which is \nwhere the file name \u201cq233914\u201d comes from). This image came with a TFW file (TIFF \nworld file); the world file gives the location and size of the pixels in the image file. \nHowever, this image did not come with a PRJ (projection) file. Notice in the bottom right \ncorner of the GMS window the text \u201cNo projection, Feet (U.S. Survey)\u201d ( Figure 1). \n \n      Figure 1      Projection information from GMS Window  \nNo PRJ file was included with this image, so while GMS is able to read the world file and \nposition the image at the correct coordinates, GMS is  not able to georeference the \nlocation of the image. The projection of the image must be specified in order to \ngeoreference the image.  \n3.1 Setting the Projection  \nTo set the projection in GMS:  \n1. Right -click on \u201c  q233914.tif\u201d in the Project Explorer and select Projection  | \nProjection\u2026  to bring up the Projection  dialog.  \n2. In the Horizontal  section, select Global projection  to bring up the Horizontal \nProjection  dialog.  \nThis dialog is used to select a projection and can also be used to export or import PRJ \nfiles. \n3. Enter \u201c1983 Meters Massachusetts\u201d in the Filter strings  field.  \n4. Select \u201cNAD 1983 StatePlane Massachusetts FIPS 2001 (Meters)\u201d from the list.  \n\nGMS Tutorials   Projections / Coordinate Systems  \n \n Page 4 of 11 \u00a9 Aquaveo 2024  \n5. Click OK to exit the Horizontal Projection  dialog.  \n6. Click OK to exit the Projection  dialog.  \n7. At the prompt explaining  that a new TIFF file will be created, click OK to bring up \nthe Save As  dialog.  \n8. Click Save  to accept the default File name  and close the Save As  dialog.  \n9. If an error comes up advising that the global projection needs to be set, continue \nto step 10. Otherwi se, skip to step 15 . \n10. Click OK to close the error message and bring up the Display Projection  dialog.  \n11. Click Set Projection\u2026  to bring up the Display Projection  dialog.  \n12. Select \u201cNAD 1983 StatePlane Massachusetts FIPS 2001 (Meters)\u201d from the list \nat the top.  \n13. In the Vertical  section, select \u201cMeters\u201d from the Units  drop-down.  \n14. Click OK to close the Display Projections  dialog.  \nA new TIFF file named \u201cq233914_exported.tif\u201d is created in the same directory as the \n\u201cq233914.tif\u201d file, then imported into GM S, replacing \u201cq 233914.tif\u201d in the Project Explorer. \nThe projection information is saved inside the new TIFF file. Any time this TIFF file  is \nimported into GMS (or any GIS application) the image will be georeferenced.  \n Any time the projection is set on an image,  a new im age will be \nexported from GMS with the projection information stored in that image.  \n15. Move the mouse around the Graphics Window.  \nNotice that the coordinates are the same as before , but now the latitude and longitude \nare displayed as the mouse moves. The current projection, also called the \u201cdisplay \nprojection\u201d, is visible in the bottom right corner of the GMS window ( Figure 2). \n \n      Figure 2      GMS Window with georeferenced data  \nWhen data that includes projection information is imported GMS, it will set the display \nprojection to match the information in the file. The display projection can be changed to \nany supported projection, though some projections are not compatible. For example, data \nin State Plane, Massachusetts Mainland will not display in the Philippines Grid.  \n3.2 Setting Transparency  \nThe transpar ency of the image must now be changed so that the other data brought into \nthe project will be easier to see.  \nTo do this:  \n1. Right -click on \u201c  q233814_exported.tif\u201d in the Project Explorer and select \nTransparency\u2026  to bring up the Layer Transparency  dialog.  \n2. Use the slider to set Transparency  to \u201c60%\u201d.  \n3. Click OK to exit the Layer Transparency  dialog.  \nThe project should appear similar to Figure 3. \n\nGMS Tutorials   Projections / Coordinate Systems  \n \n Page 5 of 11 \u00a9 Aquaveo 2024   \n      Figure 3      Map image with 60% transparency applied  \n4 Importing a CAD File  \nTo import a CAD file with the roads in the study area, do the following:  \n1. Click Open  to bring up the Open  dialog.  \n2. Select \u201cDWG/DXF Files (*.dwg, *.dxf)\u201d from the Files of type  drop-down.  \n3. Select \u201croads.dwg\u201d and click Open  to import the file and close the Open  dialog.  \n4. If the window now appears blank, right -click on \u201croads.dwg \u201d in the Project \nExplorer and select Zoom To Extents.  \nAfter importing the CAD file, the Graphics Window should appear as in Figure 4. \n \n      Figure 4      Imported CAD data  \n\nGMS Tutorials   Projections / Coordinate Systems  \n \n Page 6 of 11 \u00a9 Aquaveo 2024  \nNotice that the background image has disappeared. By moving the mouse around in the \nGraphics Window, the displayed coordinates vary from ( -71.15, 42.46) to ( -71.09, 42.52), \nand the latitude/longitude values have changed.  \nBecause there was no PRJ file associated with this CAD file, the data is drawn at the \ncoordinates specified in the file. A projection for the CAD data must be specified so that it \nwill be drawn in the correct location. This particular file h as coordinates in \nlatitude/longitude.  \nTo set the projection:  \n5. Right -click on \u201c  roads.dwg\u201d in the Project Explorer and select Projection  | \nProjection\u2026  to bring up the Projection  dialog.  \n6. In the Horizontal  section, select Global projection  and click Set Proje ction\u2026  to \nbring up the Horizontal Projection  dialog.  \nWhen opening the Horizontal Projection  dialog, notice that a list of recently used \nprojections is shown. This can be useful when assigning the same projections to multiple \nobjects. Likewise, frequently u sed projections can be saved by right -clicking on the \nprojection and selecting Add to Favorites  which will then show the projection under the \nfavorite projections folder.  \nInstead of searching the tree for the correct projection, enter the EPSG code to ass ign a \ngeographic projection to the CAD data.  \n7. Click EPSG code\u2026  button to open the Projection from EPSG code  dialog . \n8. Enter \u201c4269\u201d as the New EPSG code . \n9. Click OK to exit the Projection from EPSG code  dialog.  \n10. Click OK to exit the Horizonatal Projection  dialog.  \n11. Click OK to exit the Projection  dialog.  \n12. Click OK at the warning about changing projections.  \n13. Right -click on \u201c  roads.dwg\u201d in the Project Explorer and select Zoom to \nExtents . \nThe image should now be visible behind the CAD data ( Figure 5). Even though the CAD \ndata is in a different projection from the display projection, it is positioned in the correct \nlocation. The CAD data i s \u201cprojected on the fly\u201d, which involves transforming the \ncoordinates of the CAD data from latitude and longitude to State Plane meters.  \n Items with a projection different from the display projection are \u201cprojected on \nthe fly\u201d so that they are positioned correctly.  \n\nGMS Tutorials   Projections / Coordinate Systems  \n \n Page 7 of 11 \u00a9 Aquaveo 2024   \n      Figure 5      CAD data correctly positioned after specifying the projection  \nIf the CAD file had initially had an associated PRJ file, then the data would have already \nbeen correctly positioned in the current dis play projection.  \n5 Importing a Shapefile  \nA shapefile of the Aberjona River will now be imported. This shapefile uses a different \nprojection than the display projection.  \nTo import the shapefile:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cShapefiles (* shp)\u201d from the Files of type  drop-down.  \n3. Select \u201cAberjonaRiver_Clip.shp\u201d and click Open  to import the file and close the \nOpen  dialog.  \nThe Graphics Window should appear as in Figure 6. \n\nGMS Tutorials   Projections / Coordinate Systems  \n \n Page 8 of 11 \u00a9 Aquaveo 2024  \n \n      Figure 6      Aberjona River shapefile  \n4. Right -click on \u201c  AberjonaRiver_Clip.shp\u201d in the Project Explorer and select \nProjection  | Projection\u2026  to bring up the Projection  dialog.  \nNote the horizo ntal projection is \u201cNAD_1983_2011_UTM_Zone_18N\u201d, which was \nimported from the PRJ file associated with the shapefile. This allowed GMS to place the \nshapefile in the correct location.  \n5. Click Cancel  to exit the Projection  dialog.  \n If a file is imported into GMS, and the file has an associated PRJ, \nthen the projection is imported with the file.  \n6 Importing Elevation Data  \nNext, import surface elevations into the project from a text file by doing the following:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cText Files (*.txt, *.csv)\u201d from the Files of type  drop-down.  \n3. Select \u201celev.txt\u201d and click Open  to close the Open  dialog and open the Step 1 of \n2 page of the Text Import Wizard dialog.  \n4. Below the File import options  section, turn on Heading row . \n5. Click  Next  to go to the Step 2 of 2  page of the Text Import Wizard dialog.  \n6. Select \u201c2D scatter points\u201d for the GMS data type . \n\nGMS Tutorials   Projections / Coordinate Systems  \n \n Page 9 of 11 \u00a9 Aquaveo 2024  7. Click Finish  to close the Text Import Wizard dialog.  \n8. Click OK at the prompt that says that a projection must be specified for the \nimport ed data to bring up the Projection \u2013 Project \\Scatter Data \\elev dialog.  \n1. In the Horizontal  section, select Global projection  and click Set Projection\u2026  to \nbring up the Horizontal Projection  dialog.  \n2. Click the .prj file\u2026  button to bring up the Projection from . prj File  dialog.  \n3. Select \u201celev.prj\u201d and click Open  to exit the Open  dialog.  \n4. Click OK to close the Horizontal Projection  dialog.  \n5. Click OK to close the Projection  dialog.  \n6. Click the Display Options   macro to bring up the Display Options  dialog.  \n7. Select \u201c2D Scatter Data\u201d from the list on the left.  \n8. On the 2D Scatter Point Set  tab, click on the color selector button to the right of \n\u201celev\u201d in the list below the Contours  checkbox to bring up the Symbol Attributes  \ndialog.  \n9. Enter \u201c2\u201d in the Size field and click OK to close the Symbol Attributes  dialog.  \n10. Click OK to close the Display Options  dialog.  \nThe Graphics Window should appear as in Figure 7. \n \n      Figure 7      Imported elevation data  \n\nGMS Tutorials   Projections / Coordinate Systems  \n \n Page 10 of 11 \u00a9 Aquaveo 2024  \n6.1 Editing the Scatter Points  \nThe elevations that are in the project can be edited as follows:  \n1. Select \u201c  elev\u201d in the Project Explorer to make it active.  \n2. Using the Select Scatter Point   tool, select one of the scatter points in the \nGraphics Window by clicking on it.  \n3. Press the Delete  key to delete the selected point.  \nA prompt appears that explains that the projection of the \u201celev\u201d scatter set does not \nmatch the display projection. In ord er to edit the points, the scatter set\u2019s projection must \nbe the same as the display projection.  \n4. Select Yes at the prompt to change the display projection to match that of the \u201c\n elev\u201d scatter set projection.  \n5. Frame   the project.  \n6. Press the Delete  key again  to delete the selected point.  \n An item in a project can be edited only if its projection matches the \ndisplay projection.  \n \n7 Creating a Coverage  \nA coverage can be created by doing the following:  \n1. Right -click in a blank space in the Project Explorer and select New | Coverage\u2026  \nto add a \u201c new coverage\u201d  under the \u201c Map Data\u201d folder . \n2. Right -click on \u201c new coverage\u201d and select Coverage Setup\u2026  to bring up the \nCoverage Setup  dialog.  \nNotice that this is where Sources/Sinks/BCs, Areal Properties, and Observation Point \n attributes can be t urned on and off.  For this project, all options should be grayed out.  \n3. Click Cancel  to close the Coverage Setup dialog and retain the default settings. \nThe use of this dialog is not needed for this tutorial.  \n4. Right -click on \u201c  new coverage\u201d and select Projection  | Projection\u2026  to bring up \nthe Projection  dialog.  \n5. Notice that the projection for this coverage is the same as the display projection. \nClick OK to exit the Projection  dialog.  \n When a new item is created in a GMS project, the projection of the \nnew item will be set to match the Display Projection.  \n8 Creating a  3D Grid  \nMODFLOW simulations are common components of GMS projects. Some versions of \nMODFLOW use a structured grid for computations. 2D and 3D grids and grid frames in \nGMS are not \u201cprojected on the fly\u201d because they must retain their rectilinear shape and \ncannot be  warped.  \n\nGMS Tutorials   Projections / Coordinate Systems  \n \n Page 11 of 11 \u00a9 Aquaveo 2024  \nTherefore, when a grid is created in a GMS project, the grid will be set to use the display \nprojection; as long as the grid is part of the project, the display projection cannot be \ndifferent than the grid\u2019s projection.  \nTo create the 3D grid, do t he following:  \n1. Right -click in a blank space in the Project Explorer and select New | 3D Grid\u2026  to \nbring up the Create Finite Difference Grid  dialog.  \n2. Click OK to accept the defaults and exit the Create Finite Difference Grid  dialog.  \nA grid will appear over the other items in the Graphics Window.  \n3. Right -click on \u201c  grid\u201d in the Project Explorer and select Projection  | \nProjection\u2026  to bring up the Projection  dialog.  \n4. Notice  that the projection for this grid is the same as the Display Projection. Click \nOK to exit the Projection  dialog.  \n5. Right -click on \u201c  AberjonaRiver_Clip.shp\u201d in the Project Explorer and select \nProjection  | Set As Display Projection . \n6. An Error  dialog appears explaining that the display projection must match the \ngrid projection. Click OK to close the  dialog.  \n If a grid is included in a project, the display projection must match the \ngrid\u2019s projection.  \n9 Conclusion  \nThis concludes the \u201cGMS Projections / Coordinates Systems\u201d tutorial.  The following \nitems were discussed in the tutorial:  \n\uf0b7 GMS supports many different projections.  \n\uf0b7 GMS has a user -defined display projection.  \n\uf0b7 An item\u2019s projection can be specified in GMS and a PRJ file will be created or \noverwritten.  \n\uf0b7 All georeferenced data in a GMS project is drawn in the display projection; this \nrequires \u201cProject ing on the fly\u201d.  \n\uf0b7 Newly created items in a GMS project are assigned the display projection by \ndefault.  \n\uf0b7 To edit an item in a GMS project, the item\u2019s projection must match the display \nprojection.  \n\uf0b7 If a grid is included in a GMS project then the display project ion must match the \ngrid\u2019s projection.  \n \n\n", "filename": "Projections.pdf", "pages": 11}, "Rasters": {"text": "GMS Tutorials   Rasters  \n Page 1 of 14 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nRasters  \nUsing rasters for interpolation and visualization in GMS  \n \nObjectives   \nThis tutorial teaches how GMS uses rasters to support all kinds of digital elevation models and how \nrasters  can be used for interpolation in GMS.  \n \nPrerequisite Tutorials  \n\uf0b7 Geostatistics \u2013 2D \n Required Components  \n\uf0b7 None  \n Time  \n\uf0b7 15\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   Rasters  \n Page 2 of 14 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Opening a Starting Project  ................................ ................................ ................................ . 2 \n3 Importing Using Drag and Drop  ................................ ................................ .........................  3 \n4 Viewing the Raster Properties  ................................ ................................ ............................  4 \n5 Raster Shaders  ................................ ................................ ................................ ....................  5 \n6 Downloading Elevation Data  ................................ ................................ ..............................  5 \n7 Manipulating Rasters  ................................ ................................ ................................ ..........  6 \n7.1 Resampling  ................................ ................................ ................................ ...................  6 \n7.2 Merging Rasters  ................................ ................................ ................................ ...........  6 \n7.3 Trimming  ................................ ................................ ................................ .......................  7 \n8 Converting and Interpolating Rasters  ................................ ................................ ................  8 \n8.1 Converting a Raster to 2D Scatter Points  ................................ ................................ ..... 8 \n8.2 Convert Scatter Points to Rasters  ................................ ................................ .................  9 \n8.3 Interpolate to a TIN  ................................ ................................ ................................ ..... 10 \n8.4 Raster Catalogs  ................................ ................................ ................................ ..........  11 \n8.5 Interpolate to Feature Objects  ................................ ................................ ....................  12 \n8.6 Interpolate to MODFLOW Layers  ................................ ................................ ...............  13 \n9 Conclusion  ................................ ................................ ................................ .........................  14 \n \n1 Introduction  \nRasters are regularly spaced, gridded data. In GMS, the term \u201craster\u201d is typically used to \nrefer to an image containing elevation data. A Digital Elevation Model, or DEM, i s one \ntype of a raster and is used to represent the surface of a terrain. DEM data is useful when \nbuilding a groundwater model because it can be used to determine the ground surface \nelevation and the elevation of surface features such as drains and streams . DEMs can be \nused to represent the geologic layers beneath the surface, or they can be used like \nscatter points to represent any 2D dataset such as concentration of a contaminant in X \nand Y, flow rates, and so on.  \nIn this tutorial, some DEM files representing the area around Park City, Utah, will be \nimported and used in various ways. Topics covered include importing DEMs, changing \nthe display options, interpolating scatter points, MODFLOW layers, and feature objects, \nconverting DEMs to scatter poin ts, and creating a raster from scatter points.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2 Opening a Starting Project  \nStart with opening a project which contains some existing data.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the Tutorials \\GIS\\rasters  directory and select \u201cstart.gpr\u201d . \n4. Click Open  to import the file and close the Open  dialog.  \n\nGMS Tutorials   Rasters  \n \n Page 3 of 14 \u00a9 Aquaveo 2024  This project contains a TIN and a coverage, but they are both turned off so nothing \nappears in the Graphics Window.  \n3 Importing Using Drag and Drop  \nIt is often easier to drag and drop DEM files int o GMS.  \n1. Browse to the Tutorials \\GIS\\rasters  folder in Windows Explorer.  \n2. Select the following files (pay close attention to the file extensions as they aren't \nall the same), then drag and drop them into the GMS Graphics Window:  \n\uf0b7 \u201cBrighton.tif\u201d  \n\uf0b7 \u201cHeberCity.tif\u201d  \n\uf0b7 \u201cPkCityE.asc\u201d  \n\uf0b7 \u201cPkCityW.bil\u201d  \nThe display should appear similar to Figure 1: \n \n      Figure 1      Multiple DEMs loaded into GMS  \nNotice the raster  icon in the Project Explorer  which indicates the files contain \nelevation data. The DEMs were created in a geographic projection, meaning latitude and \nlongitude, but GMS projects them on the fly to the UTM projection that GMS is already \nusing so that they are displayed in the right pla ce. The four rasters are located  as shown \nin Figure 2.  \n\nGMS Tutorials   Rasters  \n \n Page 4 of 14 \u00a9 Aquaveo 2024   \n      Figure 2      Placement of rasters  \n4 Viewing the Raster Properties  \nReview the ra ster properties by doing the following:  \n1. In the Project Explorer , right-click on \u201c  PkCityW.bil\u201d and select Properties\u2026  to \nbring up the Properties  dialog ( Figure 3). \nNotice that the pixel resolution and size is shown in addition to elevation data. In this \ncase, the type is \u201cEHdr\u201d and the pixel size is about 30 meters (in the Y direction).  \n2. Click Cancel  to exit the  Properties  dialog.  \n3. Repeat steps 1 \u20132 for e ach of the remaining three rasters under \u201c  GIS Layers\u201d.  \nNotice that the results are two different DEM types (EHdr, GTiff) with two different pixel \nsizes (either approximately 10m or approximately 30m).  \n \n      Figure 3      Properties dialog  \n\nGMS Tutorials   Rasters  \n \n Page 5 of 14 \u00a9 Aquaveo 2024  5 Raster Shaders  \nNow review the raster display options again.  \n1. Frame Image   to see all the raster data.  \n2. In the Project Explorer, right -click on \u201c  PkCityW.bil\u201d and select Display \nOptions  to bring up the Raster Display Options  dialog.  \n3. Click on Contour Options  button to open the Raster Contour Options  dialog.  \n4. Click the Color Ramp  button to open the Choose color ramp  dialog.  \n5. Select  the \u201cHSV Shader\u201d option.  \n6. Click OK to close the Choose color ramp  dialog.  \n7. Click OK to close the Raster Contou r Options  dialog.  \n8. Click OK to close the Raster Display Options  dialog.  \n9. Repeat steps 2 \u20138 to try the \u201cColor Ramp Shader\u201d and the \u201cGlobal Shader  (feet) \u201d. \nThe options in the Rasters  section are currently the only display options available for \nrasters  in GMS. Now to reset the display options to what they were previously:  \n10. In the Project Explorer, right -click on \u201c  PkCityW.bil\u201d and select Display \nOptions  to bring up the Raster Display Options  dialog.  \n11. Click on Contour Options  button to open the Raster Contour Options  dialog.  \n12. Click the Color Ramp  button to open the Choose color ramp  dialog.  \n13. Select  the \u201cAtlas Shader\u201d option.  \n14. Click OK to close the Choose color ramp  dialog.  \n15. Click OK to close the Raster Contour Options  dialog.  \n16. Click OK to close the Raster Di splay Options  dialog.  \n6 Downloading Elevation Data  \nElevation data for the area can be downloaded using the Online Maps feature. An \ninternet connection is required for this next section to work correctly. A separate tutorial \nexplains more about this feature.  \n1. Using the Import From Web   tool, click and drag a square over the raster files \nin the Graphics Window to bring up the Data Services Options  dialog.  \n2. Scroll to the right and select the thumbnail entitled \u201cWorldwide Elevation Data \n(Variable Resolution)\u201d.  \n3. Click OK to close the Data Services Options  dialog and bring up the Save Web \nServices Data File(s)  dialog.  \n4. Enter \u201cElevation\u201d as the File Name  and click Save . \n5. Click Yes when asked to confirm creating the new file.  \n6. Click OK to accept the default in the Zoom le vel dialog.  \nAfter a few moments, a new item will appear in the Project Explorer indicating that an \nonline map is being downloaded. This map is different from the other available maps \n\nGMS Tutorials   Rasters  \n \n Page 6 of 14 \u00a9 Aquaveo 2024  because it contains elevation data. It is not required for this tutorial,  so it can be deleted \nby doing the following:  \n7. Right -click on \u201c  Elevation_elev.tif\u201d in the Project Explorer and select Remove .  \n7 Manipulating Rasters  \nRasters can be manipulated in several ways, including through resampling, merging, and \ntrimming.  \n7.1 Resampling  \nRasters can be resampled to different resolutions. The Heber City raster is a higher \nresolution than the adjacent rasters, so it will be resampled to a lower resolution to \ndemonstrate this feature.  \n1. In the Project Explorer, right -click on \u201c  HeberCity.tif\u201d  and select Export\u2026  to \nbring up the Resample and Export Raster  dialog.  \n2. Enter \u201c450\u201d in both the Num pixels X  and Num pixels Y  fields.  \n3. Click OK to close the Resample and Export Raster  dialog and open the Save As  \ndialog.  \n4. Enter \"HeberCity2.tif\" in the File name  field.  \n5. Select \u201cGeoTIFF Files (*.tif)\u201d from the Save as type  drop-down.  \n6. Click Save  to export the resampled raster and close the Save As  dialog.  \nThe new \"  HeberCity2.tif\" raster should appear in the Project Explorer.  \n7. Right -click on the new \"  HeberCity 2.tif\" and select Properties\u2026  to bring up \nthe Properties  dialog.  \n8. Notice the Num pixels X  and Num pixels Y  are now both \u201c450\u201d.  \n9. Click OK to close the Properties  dialog.  \n7.2 Merging Rasters  \nMultiple rasters can be combined into one raster by first selecting multi ple rasters in the \nProject Explorer:  \n1. In the Project Explorer, select \u201c  Brighton.tif\u201d and \"  HeberCity.tif\" while \nholding the Ctrl key. \n2. Right -click on either selected raster and select Convert To  | Merged Raster  to \nbring up the Save As  dialog.  \n3. Enter \"Brigh ton_merge.tif\" in the File name  field.  \n4. Select \u201cGeoTIFF Files (*.tif)\u201d from the Save as type  drop-down.  \n5. Click Save  to save the merged raster and close the Save As  dialog.  \n6. Uncheck all the rasters except \"  Brighton_merge.tif\" to verify it covers the area \ncovered by the individual \u201c  Brighton.tif\u201d and \u201c  HeberCity.tif\u201d rasters ( Figure \n4). \n\nGMS Tutorials   Rasters  \n \n Page 7 of 14 \u00a9 Aquaveo 2024   \n      Figure 4      Area covered by th e merged rasters  \n7.3 Trimming  \nA smaller raster can be created from a larger raster. This is called trimming.  \n1. In the Project Explorer, expand the   \u201c  Map Data\u201d folder, check the box next to \n\u201c default coverage\u201d, and select it to make it active.  \n2. Using the Select Polygons  tool, select all the polygons in the coverage by \npressing Ctrl-A (or using Edit | Select All ). \n3. Right -click \u201c  Brighton_merge.tif\u201d and select Convert To  | Trimmed Raster  to \nbring up the Trim Raster  dialog.  \n4. For Coverage with polygons , select \u201cMap Data/default coverage\u201d.  \n5. Enter \u201cBrighton_merge_trim.tif\u201d as the Output raster . \n6. Click OK to close the Trim Raster  dialog and run the tool . \n7. When the tool finishes running, click OK. \n8. Turn off all rasters except for the new one (\u201c  Brighton_merge_trim.tif\u201d).  \nNotice that the new raster was trimmed to fit within the area of the selected polygons in \nthe coverage ( Figure 5). \n\nGMS Tutorials   Rasters  \n \n Page 8 of 14 \u00a9 Aquaveo 2024  \n \n      Figure 5      The TIF trimmed to the area of the coverage  \n Rasters are trimmed to the area of the selected polygons.  \n \n8 Converting and Interpolating Rasters  \nRaster data can be converted into 2D scatter points, 2D grids, TINs, and UGrids. Scatter \npoints can be converted into a raster.  \n8.1 Converting a Raster to 2D Scatter Points  \nConvert a raster to 2D scatter points by doing the following:  \n1. Uncheck all rasters in the Project Explorer and press Ctrl-U to unselect all \npolygons.  \n2. In the Project Explorer, right -click on the \u201c  PkCityE.asc\u201d item and select \nConvert To  | 2D Scatter  to bring up the Raster \u2192 Scatter  dialog.   \n3. Click OK to create a new scatter point set and close the Raster \u2192 Scatter  dialog.  \n4. Switch to Oblique View    to see the ps uedo -3D view of the scatter points \n(Figure 6). Using Zoom   will reveal the surface is made of a large number of \npoints.  \n\nGMS Tutorials   Rasters  \n \n Page 9 of 14 \u00a9 Aquaveo 2024   \n      Figure 6      Scatter points in oblique view  \nThe process for converting to a 2D grid or UGrid is similar to the steps above, but will not \nbe covered in this tutorial.  \n8.2 Convert Scatter Points to Rasters  \nScatter points can be converted to one or more rasters by doing the following:  \n1. Switch to Plan View  . \n2. In the Project Explorer, right -click on the \u201c PkCityE.asc\u201d 2D scatter set and \nselect Convert To  | New Raster\u2026  to bring up the Scatter \u2192Raster  dialog.  \nIn this dialog, the interpolation scheme, the cell size of the raster, and how to define the \nboundary of the raster can all be set.  \n3. In the Current interpolation options  section, click Interpolation Options\u2026  to \nbring up the 2D Interpolation Options  dialog.  \nThis dialog is always used to specify 2D interpola tion options in GMS, though these \noptions are not used in this case.  \n4. Click Cancel  to close the 2D Interpolation Options  dialog.  \nIf more than one dataset is associated with the scatter set, then the Create rasters for  \ndrop-down can be used to specify all da tasets or just the active dataset. If choosing all \ndatasets, a separate raster will be created for each dataset.  \nThe raster that these scatter points were created from had a cell size around 30 meters. \nThe next steps will create a raster that is less dense  by specifying a bigger cell size.  \n5. Enter \u201c100.0\u201d for the Cell size . \n6. In the Raster extents  section, select \u201cScatter set extents\u201d from the drop -down.  \nIt is possible to limit the extents of the new raster(s) by using polygons defined in a \ncoverage. The raster  will always be created as a rectangle, but if a polygon is used to \ndefine the extents, it is possible to optionally mask (or inactivate) the areas of the raster \noutside the polygon. For this tutorial, just use the extents of the scatter points.  \n7. Click OK to close the Scatter \u2192Raster  dialog and bring up the Save As dialog.  \n8. Enter \u201cdefault_idw_grad.tif\u201d in the File name  field.  \n\nGMS Tutorials   Rasters  \n \n Page 10 of 14 \u00a9 Aquaveo 2024  \n9. Select \u201cTiff Files (*.tif)\u201d from the Save as type  drop-down.  \n10. Click Save  to close the Save As  dialog.  \nA new raster file is created on di sk and automatically loaded into GMS. Compare it to the \noriginal raster it is derived from.  \n11. Uncheck the \u201c PkCityE.asc\u201d 2D scatter dataset.  \n12. Turn on the \u201c PkCityE.asc\u201d raster.  \n13. Turn on and off the new \u201c  default_idw_grad.tif\u201d raster.  \nNotice that the new raster is a lot less sharp than the original \u201c PkCityE.asc\u201d raster \nbecause when the \u201c PkCityE.asc\u201d raster was converted to scatter points, every other \nrow was skipped and a larger cell size was used when interpolating the scatter points \nback to a raster.  \n8.3 Interpolate to a TIN  \nThe elevations of the raster can be interpolated to several other GMS data types. The \nnext step is to interpolate to a TIN.  \n1. In the Project Explorer, expand and turn on the \u201c  TIN Data\u201d folder to reveal the \n\u201c watershed\u201d TIN.  \nThe \"waters hed\" TIN is in a canyon that covers two rasters: \u201c  Brighton.tif\u201d and \u201c  \nHeberCity.tif\u201d. Notice it has a default dataset in which all the values are zero.  \n2. Uncheck all GIS layers  except for \u201c  HeberCity.tif\u201d and \u201c  Brighton.tif\u201d.  \n3. While pressing the Ctrl key, select both the \u201c  Brighton.tif\u201d raster and the \u201c  \nHeberCity.tif\u201d raster.  \n4. Right -click one of the selected rasters and select Interpolate To | TIN. \nTwo new datasets were created on the TIN, one for each raster that was selected. From \nthe TIN contours, not ice that for the \u201cBrighton.tif\u201d dataset, only the eastern portion is \nactive, up to the edge of the \u201cBrighton\u201d raster ( Figure 7). \n When interpolating from multiple rasters, multiple datasets are created.  \n5. Select the new \u201c  HeberCity.tif\u201d dataset under the \u201c  watershed\u201d TIN.  \nNotice that only the western portion of the dataset is active, up to the edge of the \n\u201cHeberCity.tif\u201d raster.  \n\nGMS Tutorials   Rasters  \n \n Page 11 of 14 \u00a9 Aquaveo 2024  \n \n      Figure 7      Interpolated TIN dataset with inactive points outside the raster boundary  \n8.4 Raster Catalogs  \nInstead of two TIN datasets, one dataset that spans both the Brighton.tif and HeberCity.tif \nrasters is desired. For this use a raster catalog. A raster catalog is simply multiple rasters \ngrouped together for purposes of interpolation or for use with the Horizons \u2192 Solids  \ncommand.  \n1. Select all the rasters  in the Project Explorer by selecting the first one, and \nselecting the l ast one while holding down the Shift key. \n2. Right -click on any of the selected rasters and select New Raster Catalog  to \nbring up the Raster Catalog  dialog.  \n3. Notice that all of the selected rasters are part of the catalog. Click OK to close \nthe Raster Catalog  dialog.  \nNow interpolate to the TIN again, but this time use the raster catalog.  \n4. Right -click on the \u201c  Raster Catalog\u201d and select Interpolate To | TIN to create a \nnew \u201cdefault_idw_grad.tif\u201d TIN dataset.  \nThe contours on the new TIN match the elevations of t he rasters. The TIN also crosses \nover the boundaries of two rasters and GMS uses all the selected rasters to interpolate to \nthe TIN ( Figure 8). \n When interpolating from a raster catalog, one dataset is created.  \n\nGMS Tutorials   Rasters  \n \n Page 12 of 14 \u00a9 Aquaveo 2024   \n      Figure 8      Interpolated TIN based on raster catalog  \n8.5 Interpolate to Feature Objects  \nIt is also possible to interpolate from rasters to the Z values of feature objects.  \n1. In the Project Explorer , right -click in the empty space and select Uncheck All  to \nhide everything.  \n2. Turn on the \u201c  Map Data \u201d folder.  \n3. Switch to Front View  . \nNotice that the feature objects in the coverage are all at an elevation of zero.  \n4. Select all the rasters  in the Project Explorer  by selecting the first one, and \nselecting the last one while holding down the Shift key. \n5. Right -click on any of the selected rasters and select Interpolate To  | Active \nCoverage . \n6. Click Frame  Image  . \nNotice that the elevations of the feature objects in the coverage have been changed to \nmatch the elevation data from the rasters ( Figure 9). In this case the raster c atalog wasn't \nused, although it could have been and the results would have been the same. Since \ncoverages cannot have multiple datasets like TINs can, there is no need to use the raster \ncatalog in this case.  \n \n      Figure 9      Interpolated from rasters to Z values  \n\nGMS Tutorials   Rasters  \n \n Page 13 of 14 \u00a9 Aquaveo 2024  8.6 Interpolate to MODFLOW Layers  \nScatter point data can be interpolated to MODFLOW top and bottom layer elevation \narrays. This is covered in more detail in the \u201cMODFLOW \u2013 Interpolating Layer Data\u201d \ntutorial. Raster data can  also be interpolated to MODFLOW elevation arrays, which will \nbe done in this case:  \n1. Select New  and click Don\u2019t Save  when asked to save the current project.  \n2. Click Open   to bring up the Open  dialog.  \n3. Browse to the Tutorials \\GIS\\rasters  directory and selec t \u201cProject Files (*.gpr)\u201d \nfrom the Files of type  drop-down.  \n4. Select \u201cpoints.gpr\u201d and click  Open  to import the project file and close the Open  \ndialog.   \nThis project is similar to the one from the \u201cMODFLOW \u2013 Interpolating Layer Data\u201d tutorial, \nbut instead of scatter points, it uses rasters. Notice that the MODFLOW model layers are \ncompletely flat ( Figure 10). \n \n      Figure 10      MODFLOW layers  \n5. Expand the \u201c  GIS Layers\u201d folder to see the rasters.  \n6. Select all the rasters  in the Project Explorer by selecting the first one, and \nselecting the last one while holding down the Shift key. \n7. Right -click on a selected raster and select Interpolate To  | MODFLOW Layers\u2026  \nto bring up the Interpolate to MODFLOW Layers  dialog.  \nThe mapping in the lower part of the dialog should already be set up. GMS automatically \nmapped the appropriate raster to the appropriate MODFLOW layer array based on the  \nnames of the rasters. For more information on this dialog, refer to the \u201cMODFLOW \u2013 \nInterpolating Layer Data\u201d tutorial.  \n8. Click OK to close the Interpolate to MODFLOW Layers  dialog.  \n9. Click Frame Image  .The layer elevations are no longer flat ( Figure 11). \nThe raster catalog could have been used and the results would have been the same.  \n\nGMS Tutorials   Rasters  \n \n Page 14 of 14 \u00a9 Aquaveo 2024   \n      Figure 11      MODFLOW layers after interpolating elevation data  \n9 Conclusion  \nThis concludes the GMS \u201cRasters\u201d tutorial. The following topics were discussed:  \n\uf0b7 Rasters are images with elevation data.  \n\uf0b7 Rasters, like images, are 2D and only drawn in the background when in  plan \nview, but they can appear 3D if hill shading is enabled.  \n\uf0b7 Rasters can be downloaded using the Online Maps feature.  \n\uf0b7 Rasters can be converted to 2D scatter sets and 2D grids.  \n\uf0b7 2D scatter points can be converted into rasters.  \n\uf0b7 Rasters can be interpolated t o many other GMS object types.  \n\uf0b7 When interpolating from multiple rasters, multiple datasets are created.  \n\uf0b7 When interpolating from a raster catalog, one dataset is created.  \n \n\n", "filename": "Rasters.pdf", "pages": 14}, "RT3D-BTEXDegradationWithMultipleElectronAcceptors": {"text": "GMS Tutorials   RT3D \u2013 BTEX Degradation with Multiple Electron Acceptors  \n Page 1 of 12 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nRT3D \u2013 BTEX Degradation with Multiple Electron \nAcceptors  \n \nObjectives   \nThis tutorial shows how to use GMS and RT3D to model BTEX degradation using a multiple electron \nacceptor model.  \n \nPrerequisite Tutorials  \n\uf0b7 RT3D \u2013 Instantaneous \nAerobic Degradation  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 RT3D  \n Time  \n\uf0b7 20\u201335 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   RT3D \u2013 BTEX Degradation with Multiple Electron Acceptors  \n Page 2 of 12 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Description of the Reaction Model  ................................ ................................ ................  2 \n1.2 Description of Problem  ................................ ................................ ................................ . 5 \n1.3 Getting Started  ................................ ................................ ................................ ..............  5 \n2 Importing the MODFLOW Model ................................ ................................ .........................  6 \n3 Building the TransportModel  ................................ ................................ ..............................  6 \n4 Initializing the Model  ................................ ................................ ................................ ...........  6 \n5 The BTN Package  ................................ ................................ ................................ ................  6 \n5.1 Starting Concentrations  ................................ ................................ ................................  7 \n5.2 Porosity  ................................ ................................ ................................ .........................  7 \n5.3 Stress Perio ds ................................ ................................ ................................ ..............  7 \n5.4 Output Options  ................................ ................................ ................................ ..............  7 \n6 Assigning Concentrations to the Left Boundary  ................................ ..............................  8 \n7 The Advection Package  ................................ ................................ ................................ ...... 8 \n8 The Dispersion Package  ................................ ................................ ................................ ..... 8 \n9 The Source/Sink Mixing Package  ................................ ................................ .......................  9 \n10 The Chemical Reaction Package  ................................ ................................ ........................  9 \n11 Running RT3D  ................................ ................................ ................................ ....................  10 \n12 Viewing the Results  ................................ ................................ ................................ ...........  10 \n12.1  Overlaying Contours  ................................ ................................ ................................ ... 11 \n13 Other Post -Processing Options  ................................ ................................ .......................  12 \n14 Conclusion  ................................ ................................ ................................ .........................  12 \n \n1 Introduction  \nThis tutorial illustrates the steps involved in using GMS and RT3D to model BTEX \ndegradation using a multiple electron acceptor model. Since the flow model used in this \nsimulation is similar to the flow model used in the \u201c RT3D \u2013 Instantaneous Aerobic \nDegradation \u201d tutorial, the steps involved in building the flow model will not be described in \nthis tutorial. A predefined ve rsion of the flow model will be used.  \nThis tutorial will begin with i mport ing a MODFLOW model followed by defining  RT3D \ninputs and boundary conditions, running RT3D, and v iewing results by overlaying the \ncontours.  \n1.1 Description of the Reaction Model  \nThe reaction that will be simulated is biodegradation of BTEX compounds via different \naerobic/anaerobic pathways using multiple electron acceptors. Five different processes \nconsidered in this model are Aerobic Respiration (AR), Denitrification (DN), Iron ( III) \nReduction (IR), Sulfate Reduction (SR), and Methanogenesis (MG). All of these \nbiochemical reactions are assumed to occur in the aqueous phase, mediated by the \nexisting subsurface microbes, and are expected to happen in the following sequence:  \nMG SR IR DN AR \uf0ae\uf0ae\uf0ae\uf0ae\n ................................ ................................ .............  (1) \nThe following reaction kinetic framework is used to model the degradation rate of \nhydrocarbon via different electron acceptor pathways:  \n\uf05b\uf05d\uf05b\uf05d\n\uf05b\uf05dr k HCO\nK OHCO HCO\nO, ,2 2\n22\n2\uf03d\uf02d\n\uf02b\n ................................ ................................ ... (2) \n\uf05b\uf05d\uf05b\uf05d\n\uf05b\uf05d\uf05b\uf05dr k HCNO\nK NOK\nK OHCNO HCNO\nNOiO\niO, ,,\n,3 3\n32\n23\n3 2\uf03d\uf02d\n\uf02b\uf0b7\n\uf02b\n ................................ . (3) \nGMS Tutorials   RT3D \u2013 BTEX Degradation with Multiple Electron Acceptors  \n \n Page 3 of 12 \u00a9 Aquaveo 2024  \n\uf05b\uf05d\uf05b\uf05d\n\uf05b\uf05d\uf05b\uf05d\n\uf05b\uf05dr k HCFe\nK FeK\nK O\nK\nK NOHCFE HCFe\nFeiO\niO\niNO\niNO, ,,\n,\n,\n,3 3\n32\n2\n3\n33\n3\n2\n3\uf02b \uf02b\n\uf02b\uf03d\uf02d\uf02b\uf0b7\uf02b\n\uf0b7\uf02b\uf02b\n\uf02b ................................ .. (4) \n\uf05b\uf05d\uf05b\uf05d\n\uf05b\uf05d\uf05b\uf05d\n\uf05b\uf05d\uf05b\uf05dr k HCSO\nK SOK\nK O\nK\nK NOK\nK FeHCSO HCSO\nSOiO\niO\niNO\niNOiFe\niFe, ,,\n,\n,\n,,\n,4 4\n42\n2\n3\n33\n34\n4 2\n33\uf03d\uf02d\uf02b\uf0b7\uf02b\n\uf0b7\uf02b\uf0b7\uf02b\uf02b\n\uf02b\uf02b\n ................................ .... (5) \n\uf05b\uf05d\uf05b\uf05d\n\uf05b\uf05d\uf05b\uf05d\n\uf05b\uf05d\uf05b\uf05d\uf05b\uf05dr k HCCO\nK COK\nK O\nK\nK NOK\nK FeK\nK SOHCCH HCCH\nCHiO\niO\niNO\niNOiFe\niFeiSO\niSO, ,,\n,\n,\n,,\n,,\n,4 4\n42\n2\n3\n33\n34\n42\n2 2\n33\n4\uf03d\uf02d\uf02b\uf0b7\uf02b\n\uf0b7\uf02b\uf0b7\uf02b\uf0b7\uf02b\uf02b\n\uf02b\uf02b\n ................................ ... (6) \nWhere:  \n\uf0b7 rHC,O2 is the rate at which hydrocarbon is destroyed by utilizing oxygen,  \n\uf0b7 rHC,NO3 is the rate at which hydrocarbon is destroyed by utilizing Nitrate,  \n\uf0b7 rHC,Fe2+ is the rate at which hydrocarbon is destroyed by prod ucing Fe2+ (or \nutilizing Fe3+),  \n\uf0b7 rHC,SO4 is the rate at which hydrocarbon is destroyed by utilizing sulfate,  \n\uf0b7 rHC,CH4 is the rate at which hydrocarbon is destroyed by producing methane,  \n\uf0b7 [O2] is the oxygen concentration [ML-3],  \n\uf0b7 kO2 is the first -order rate  constant [T-1],  \n\uf0b7 Ko2 is the Monod half saturation constant [ML-3] (by setting all the half -saturation \nconstants to a small value, zero -order dependency can be simulated with respect \nto the electron donor and hence a first -order degradation model with resp ect to \nhydrocarbon; the default values simulate this option),  \n\uf0b7 and K i,o2 is the oxygen inhibition constant [ML-3] (by setting all inhibition constants \nto a small value, reactions can be forced to occur in a sequential fashion; the \ndefault values simulate t his process).  \nSimilar nomenclature is used to identify other Monod constants and inhibition coefficients.  \nSince the concentrations of Fe3+ and CO 2 are not readily measurable under normal field \nconditions, these terms were replaced with the \u201cassimilative c apacity\u201d for iron reduction \nand methanogenesis, defined as the following:  \n]Fe[] Fe[]Fe[2\nmax2 3 \uf02b \uf02b \uf02b\uf02d \uf03d\n ................................ ................................ ................  (7) \n]CH[] CH[]CO[]MC[4 max,4 2 \uf02d \uf03d\uf03d\n................................ ................................ ... (8) \nwhere [Fe2+\nmax] and [CH 4 max] are the maximum possible aquifer levels of these species \nthat represent the aquifer\u2019s maximum capacity for iron reduction and methanogenesis. \nNote: the concentration of CO 2 used here is the CO 2 evolved while the hydrocarbon is \nGMS Tutorials   RT3D \u2013 BTEX Degradation with Multiple Electron Acceptors  \n \n Page 4 of 12 \u00a9 Aquaveo 2024  destroyed via methanogenesi s, which may be thought of as the \u201cMethanogenic Capacity\u201d \n(MC) of the aquifer. Using these relations, iron (III) reduction and methanogenesis \nprocesses may be related back to measurable Fe2+ and CH 4 concentration levels.  \nThe total rate of hydrocarbon destr uction, via all the above described processes, is the \nsum of each of the individual rates and is given as the following:  \n4 423 2 CH,HC SO,HC Fe,HC NO,HC O,HC r r r r rdt]HC[d\uf02b\uf02b\uf02b\uf02b\uf03d \uf02b\n ................................ ....... (9) \nRates of electron acceptor utilization are given as the corresponding rate of hydrocarbon \ndestruction multiplied by the appropriate yield coefficient (Y):  \n2 2 O,HC HC/O2r Ydt]O[d\uf03d\n ................................ ................................ ......................  (10) \n3 3 NO,HC HC/NO3r Ydt]NO[d\uf03d\n ................................ ................................ ...............  (11) \n\uf02b \uf02b\uf02d\uf03d\uf02b\n2 2Fe,HC HC/ Fe2\nr Ydt]Fe[d\n ................................ ................................ ..............  (12) \n4 4 SO,HC HC/SO4r Ydt]SO[d\uf03d\n ................................ ................................ ..................  (13) \n4 4 CH,HC HC/CH4r Ydt]CH[d\uf02d\uf03d\n ................................ ................................ ..............  (14) \nThe yield values (the mass ratio of electron acceptors removed or metabolic byproducts \nproduced to total BTEX degraded) are as follows:  \n\uf0b7 Y02/HC = 3.14,  \n\uf0b7 YNO3/HC  = 4.9  \n\uf0b7 YFe2+/HC  = 21.8  \n\uf0b7 YSO4/HC  = 4.7  \n\uf0b7 YCH4/HC = 0.78  \nTypical values of all inhibition coefficients, except for K iFe3+, should be in the range of 1.0 \nto 0.01 mg/L. K iFe3+\n should always be set around 40% to 80% of the max Fe2+ value. \nMonod half -saturation constants should be in the range of 1.0 to 0.1 mg/L.  \nAs pointed out in Lu et al.,1 it is important to note that this model is based on several \nassumptions. Th e model should be used with caution only at sites where these \nassumptions are valid.  \nIn summary, the key assumptions used in the model are:  \n1. The fuel chemical species benzene, toluene, ethylbenzene, and xylene are \nassumed to degrade at similar rates and, hence, are combined and modeled as a \nsingle electron donor species BTEX;  \n                                                      \n1 Lu, G., Clement, T.P., Zheng, C., and Wiedemeier, T.H. (1999). Natural attenuation of BTEX \ncompounds: Model development and field -scale application. Ground Water . 37(5):707 \u2013717. \nGMS Tutorials   RT3D \u2013 BTEX Degradation with Multiple Electron Acceptors  \n \n Page 5 of 12 \u00a9 Aquaveo 2024  2. Production of Fe2+ and methane are restricted at a node to a \u201cmaximum -\nobserved level\u201d; however, the model assumes that an infinite supply of electron \nacceptors will be available for iron-reduction and methanogenic reactions;  \n3. More complex processes are not considered; these include processes such as \nthe rate -limited interaction of bioavailable, solid -phase Fe3+ and aqueous -phase \nFe2+, interaction of oxygen and Fe2+, and/or variations in the spatial pattern of \nmethanogenic activity and CO 2 availability;  \n4. Growth and decay of various microbial populations and their interactions with \ncontaminants and aquifer solids are assumed to be negligible; and  \n5. All BTEX decay reactions are approximate d as first -order reactions, and, hence, \nthe model ignores the Monod limitation due to the electron donor (BTEX) \navailability.  \nFortunately, these assumptions are expected to be reasonable approximations for most \nfield sites. However, there will always be s ome exceptions.  \n1.2 Description of Problem  \nThe problem in this tutorial is the same as the problem described in \u201cRT3D \u2013 \nInstantaneous Aerobic Degradation\u201d tutorial. The site is a 510 m x 310 m section of a \nconfined aquifer with a flow gradient from left to rig ht. An underground storage tank is \nleaking fuel hydrocarbon contaminants at 2 m3/day at the location shown. Concentration \nof BTEX is 1000 mg/L. Initial levels of hydrocarbon, oxygen, nitrate, Fe2+, sulfate, and \nmethane in the aquifer are assumed to be as f ollows: 0.0, 4.0, 20.0, 0.0, 10.0, and 0.0 \nmg/L, respectively. The reaction constants to be used are as follows:  \nConstant  Value  \nMax Fe2+ 25.0 mg/L  \nMax \nMethane  30.0 mg/L  \nkHC,O2 0.1 day-1 \nk HC,No3  0.008 day-1 \nk HC,Fe3+  0.0005 day-1 \nk HC,SO4  0.00025 \nday-1 \nk HC,CH4  0.0001 day-1 \nValues of all inhibition coefficients, except K iFe3+, are assumed to be 0.01 mg/L and all \nMonod constants are assumed to 0.5 mg/L. The value of K iFe3+ is set at 12.5 mg/L (50% \nof max Fe). The yield values are the same as those described in the previous section.  \nThe first part of the problem will be to import a previously computed MODFLOW flow \nmodel of the site. Using this flow field, a reactive transpor t model will then be defined \nusing RT3D.  \n1.3 Getting Started  \nDo the following to get started:  \n1. If GMS is not running, launch GMS.  \n2. If GMS is already running, select the File | New command to ensure the program \nsettings are restored to the default state.  \nGMS Tutorials   RT3D \u2013 BTEX Degradation with Multiple Electron Acceptors  \n \n Page 6 of 12 \u00a9 Aquaveo 2024  2 Importi ng the MODFLOW Model  \nThe first part of the simulation is to import the MODFLOW flow model. A steady state flow \nmodel has been previously computed and is supplied with the tutorial files.  \n1. Select the File | Open \u2026 command to bring up the Open  dialog.  \n2. Locate the directory entitled flowmod \\flowmod . \n3. Select the file entitled \u201c flowmod.gpr \u201d. \n4. Click Open to import the project file.  \n \nFigure 1      The MODFLOW flow model  \n3 Building the TransportModel  \nNow that the flow model is imported, the next step is to set up the RT3D simulation. For \nthis part of the simulation, select the reaction, define the reaction data, define the \nsupplemental layer data needed by RT3D, and assign concentrations to the well.  \n4 Initializing the Model  \nThe first step is to initialize the RT3D data.  \n1. Expand the \u201c  3D Grid Data\u201d folder in the Project Explorer.  \n2. Right -click on the \u201c  grid\u201d item in the Project Explorer.  \n3. Select the New MT3DMS \u2026 command to open the Basic Transport Package  \ndialog.  \n5 The BTN Package  \nThe next step is to initialize the data in the Basic Transport Package. First, initialize the \ndata, select RT3D as the transport model, and select the appropriate packages.  \n1. In the Model  section, select the RT3D  option.  \n2. Select Packages\u2026  to open the MT3DMS/RT3D Packages dialog.  \n3. Select the following packages:  \n\nGMS Tutorials   RT3D \u2013 BTEX Degradation with Multiple Electron Acceptors  \n \n Page 7 of 12 \u00a9 Aquaveo 2024  \uf0b7 Advection package  \n\uf0b7 Dispersion package  \n\uf0b7 Source/sink mixing package  \n\uf0b7 Chemical reaction package  \n4. For the RT3D reactions , select the \u201cKinetic -Limited Deg. of BTEX w/ MEA\u201d \noption.  \n5. Select OK to exit the MT3DMS/RT3D Packages  dialog. \n5.1 Starting Concentrations  \nNote that in the Layer Data  section of the dialog, the species associated with the reaction \nbeing modeled are listed by name. The next step is to define the starting concentration \nfor each of these species. The default starting concentration is zero. Use the default \nvalue for BTEX, Fe2+, and methane, but use non -zero values for oxygen (4.0 mg/L), \nnitrate (20.0 mg/L), and sulfate (10.0 mg/L).  \n1. Enter a value of \u201c4.0\u201d  for the Starting Conc. (mg/l)  for Oxygen .  \n2. Enter a Starting Conc. (mg/l) value of \u201c20.0\u201d for Nitrate . \n3. Enter a Starting Co nc. (mg/l)  value of \u201c10.0\u201d for S ulfate . \n5.2 Porosity  \nThe porosity to be used is 0.3. Since this is the default in GMS, nothing needs to be \nchanged.  \n5.3 Stress Periods  \nThe next step is to define the stress periods. Since the injection rate of the well and the \nother  boundary conditions do not change, a single stress period will be used.  \n1. Select Stress Periods\u2026  to open the Stress Periods dialog.  \n2. Enter a value of \u201c 730\u201d for the Length . \n3. Enter a value of \u201c 10\u201d for Num Time Steps . \n4. Select OK to exit the Stress Periods  dialog.  \n5.4 Output Options  \nThe next step is to define the output options. One binary solution file is created by RT3D \nfor each of the species. By default, RT3D saves a solution at each transport step for each \nspecies. Since this results in large files contain ing more solutions than needed for the \nsimple post -processing, it would be better to specify that a solution be saved every 73 \ndays (every time step).  \n1. Select Output Control\u2026  to open the Output Control  dialog.  \n2. Select the Print or save at specified times  option. \n3. 3. Select Times \u2026 to open the Variable Time Steps dialog.  \n4. 4. Select Initialize Values \u2026 to open the Initialize Time Steps dialog.  \nGMS Tutorials   RT3D \u2013 BTEX Degradation with Multiple Electron Acceptors  \n \n Page 8 of 12 \u00a9 Aquaveo 2024  5. 5. Enter \u201c73.0\u201d for the Initial time step size.  \n6. 6. Enter \u201c73.0\u201d for the Maximum time step size.  \n7. 7. Enter \u201c730.0\u201d for the Ma ximum simulation time.  \n8. 8. Select OK to exit the Initialize Time Steps dialog.  \n9. 9. Select OK to exit the Variable Time Steps dialog.  \n10. 10. Select OK to exit the Output Control dialog.  \nThis completes the input for the Basic Transport package.  \n11. Select OK to exit the Basic Transport Package dialog.  \n6 Assigning Concentrations to the Left Boundary  \nThe left boundary of the model is a constant head boundary. Since the head at the left \nboundary is greater than the head at the right boundary, the left boundary act s as a \nsource and water enters the model from the left. Thus, the concentrations of the species \nat the left boundary must be defined. The simplest way to do this is to mark the cells as \nspecified concentration cells. : \n1. Using the Select Cells   tool, select  the column of cells on the left \nboundary by dragging a box that just surrounds the cells . \n2. Right -click on any of the selected cells and select the Properties \u2026 \ncommand from the pop -up menu to open the 3D Grid Cell Properties dialog. \nSelect \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down list.  \n3. Switch to the RT3D  tab.  \n4. Change the ICBUND  value to \u201c \u20131\u201d.  \n5. Select OK to close the 3D Grid Cell Properties  dialog.  \n7 The Advection Package  \nThe next step is to initialize the data for the Advection package.  \nTo de fine the model boundary with an arc , do the following:  \n1. Select the RT3D  | Advection Package \u2026 command to open the Advection \nPackage dialog.  \n2. Select the \u201cStandard finite -difference method\u201d solver from the Solution \nscheme  drop-down menu of the dialog.  \n3. Select OK to close the Advection Package  dialog.  \n8 The Dispersion Package  \nThe next step is to enter the data for the Dispersion package. The aquifer has a \nlongitudinal dispersivity of 10.0 m and a transverse (horizontal) dispersivity of 3.0 m. The \nvertical dispersivi ty is assumed to be equal to the longitudinal dispersivity : \n1. Select the RT3D | Dispersion Package\u2026  command to open the Dispersion \nPackage dialog.  \n\nGMS Tutorials   RT3D \u2013 BTEX Degradation with Multiple Electron Acceptors  \n \n Page 9 of 12 \u00a9 Aquaveo 2024  2. Select Longitudinal Dispersivity \u2026 to open the Longitudinal Dispersivity \ndialog. . \n3. Select Constant \uf0d2 Grid\u2026  to open the Grid Value  dialog.  \n4. Enter a value of \u201c10.0\u201d.  \n5. Select OK to close the Grid Value  dialog.  \n6. Select OK to exit the Longitudinal Dispersivity  dialog.   \n7. Enter a value of \u201c0.3\u201d for the TRPT  value.  \n8. Select OK to exit the Dispersion Package  dialog.   \n9 The Source/Sink Mixing Package  \nNext to define the concentration at the spill location:   \n1. Using the Select Cells   tool, select the cell containing the injection well (spill \nlocation) by clicking anywhere in the interior of the cell. . \n2. Select the RT3D | Point So urces/Sinks\u2026  command to open the \nMODFLOW/RT3D Source/Sinks  dialog.  \n3. Click the Add BC  button near the bottom of the dialog.  \n4. Change the Type  (ITYPE) to \u201cwell (WEL)\u201d.  \n5. In the BTEX  column, enter a concentration of \u201c1000\u201d (mg/L).  \n6. Select the OK button to exit the MODFLOW/RT3D Source/Sinks  dialog.  \n10 The Chemical Reaction Package  \nNext to initialize the Chemical Reaction package and define appropriate reaction rate \nconstants:  \n1. Select the RT3D | Chemical Reaction Package\u2026  command to open the \nRT3D Chemical Reaction Pack age dialog. . \n2. In the Reaction parameters  section, click on the Max_Fe2+  item and set its \nvalue to \u201c25.0\u201d.  \n3. Set the value of Max Methane  to \u201c30.0\u201d.  \n4. Set the value of kHCO2  to \u201c0.1\u201d.  \n5. Set the value of kHCNO3  to \u201c0.008\u201d.  \n6. Set the value of kHCFE3+  to \u201c0.0005\u201d.  \n7. Set the value of kHCSO4  to \u201c0.00025\u201d.  \n8. Set the value of kHCCH4  to \u201c0.0001\u201d.  \nAll monod constants, inhibition coefficients, and yield values, except KiFe 3+, will be left \nat the default values. The value of KiFe 3+ will be set at 12.5 mg/L (50% of max Fe).  \n9. Set the value of kiFE3+  to \u201c12.5\u201d.  \n10. Select OK to exit the RT3D Chemical Reaction Package  dialog.  \n\nGMS Tutorials   RT3D \u2013 BTEX Degradation with Multiple Electron Acceptors  \n \n Page 10 of 12 \u00a9 Aquaveo 2024  11 Running RT3D  \nAt this point, it is possible to save the model and run RT3D.  \n1. Select the File | Save As\u2026 command to bring up the Save As dialog. Enter \n\"tahoe.g pr\" in the File name  field.  \n2. Locate and open the directory entitled flowmod \\flowmod . \n3. Enter \u201cbtmod\u201d for the File name . \n4. Select Save to exit the Save As dialog. .  \nSince the name of the project has changed, it is necessary to either use the Run Options \ncommand to tell RT3D where the MODFLOW solution is, or re -run MODFLOW.  \n5. Select the MODFLOW  | Run MODFLOW  command to start the MODFLOW  \nmodel wrapper.  \n6. When the simulation is finished, select Close  to exit the MODFLOW  model \nwrapper. The solution will automatically be imported .  \nTo run RT3D:  \n7. Select the RT3D  | Run RT3D\u2026  command to start the RT3D  model wrapper.  \n8. Select Yes at the prompt to save the changes.  \n9. When the simulation is finished, select Close  to exit the RT3D  model \nwrapper.  \nGMS reads in the solution automatically.  \n12 Viewing the Results  \nFirst, to view the BTEX solution at 730 days: . \n1. Select the \u201c  BTEX\u201d dataset from the Project Explorer. (if needed, expand \nthe \u201cbtmod (RT3D)\u201d solution in the Project Explorer.)   \n2. Select the time step at 730 days from the Time Steps Window . \n \n      Figure 2  BTEX solution at 730 days  \n\nGMS Tutorials   RT3D \u2013 BTEX Degradation with Multiple Electron Acceptors  \n \n Page 11 of 12 \u00a9 Aquaveo 2024  12.1 Overlaying Contours  \nNext, it is possible to view concentration contours for the other species. When working \nwith multiple species, it is often convenient to overlay contours of one species on top of \ncontours from another species. As an example, this tutorial will overlay the contours of \nthe other species on top of the BTEX contours. To do this, the display of the BTEX \ncontours will need to be set to be in t he background as a CAD layer.   \nBefore creating the CAD layer, it is first necessary to turn off most of the display options \nother than the contours (to avoid saving the grid cell lines to the CAD file).  \n1. Select the Display Options   macro to open the Display Options dialog.  \n2. Turn off the  Cells edges option . \n3. Switch to the RT3D  tab.  \n4. Select the Check None  button.  \n5. Switch to the MODFLOW  tab. \n6. Select the Check None  button.  \n7. Select OK to close the Display Options  dialog.  \nTo create the CAD lay er: \n8. In the Project Explorer, right -click on the empty space then, from the pop -up menu, \nselect the Convert to CAD  command to open the Save CAD  data dialog.  \n9. Enter \u201cBTEX_contours\u201d as the File name . \n10. Select Save  to create the CAD data.  \nNow to reset the displa y options and view the oxygen solution at 730 days:  \n11. Select the Display Options   macro to open the Display Options dialog . \n12. Turn on the Layer Borders  option.  \n13. Select the OK button to close the Display Options  dialog.     \n14. Select the \u201c  Oxygen\u201d dataset from th e Project Explorer.   \nNow to turn on a color ramp and a legend:  \n15. Select the Contour Options   macro to open the Dataset Contour Options \u2013 3D \nGrid \u2013 Oxygen dialog .  \n16. Select the \u201cColor Fill\u201d option for the Contour method . \n17. Change the Transparency  value to \u201c50\u201d .  \n18. Select OK to exit the Dataset Contour Options \u2013 3D Grid \u2013 Oxygen  dialog.  \n19. Select the time step at 730 days from the Time Steps Window . \n\nGMS Tutorials   RT3D \u2013 BTEX Degradation with Multiple Electron Acceptors  \n \n Page 12 of 12 \u00a9 Aquaveo 2024    \nFigure 3  The Oxygen solution at 730 days  \nNext to view the nitrate solution at 730 days:  \n20. Select the \u201c  Nitrate\u201d data set from the Project Explorer.  \n21. Select the time step at 730 days from the Time Steps Window . \nFinally, view the iron solution at 730 days.  \n22. Select the \u201c  Iron (Fe2+)\u201d dataset from the Project Explorer.  \n23. Select the time step at 730 days from the Time Steps Window .  \n13 Other Post -Processing Options  \nAt this point, feel free to experiment with the other post -processing options, including film \nloop animation   \n14 Conclusion  \nThis concludes the tutorial. Continue to explore RT3D applications or close the program.  \n\n", "filename": "RT3D-BTEXDegradationWithMultipleElectronAcceptors.pdf", "pages": 12}, "RT3D-DoubleMonodModel": {"text": "GMS Tutorials   RT3D \u2013 Double Monod Model  \n Page 1 of 12 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nRT3D \u2013 Double Monod Model   \n \nObjectives   \nThis tutorial shows how to use GMS and RT3D to model the reaction between an electron donor and an \nelectron acceptor, mediated by an actively growing microbial population that exists in both soil and \naqueous phases . \n \nPrerequisite Tutorials  \n\uf0b7 RT3D \u2013 Instantaneous \nAerobic Degradation  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 RT3D  \n Time  \n\uf0b7 25\u201340 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   RT3D \u2013 Double Monod Model  \n Page 2 of 12 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Description of the Reaction Model  ................................ ................................ ................  2 \n1.2 Description of Problem  ................................ ................................ ................................ . 5 \n1.3 Getting Started  ................................ ................................ ................................ ..............  5 \n2 Importing the MODFLOW Model ................................ ................................ .........................  6 \n3 Building the Transport Model  ................................ ................................ .............................  6 \n4 Initializing the Model  ................................ ................................ ................................ ...........  6 \n5 The Basic Transport Package  ................................ ................................ ............................  7 \n5.1 Starting Concentration  ................................ ................................ ................................ .. 7 \n5.2 Porosity  ................................ ................................ ................................ .........................  7 \n5.3 Stress Perio ds ................................ ................................ ................................ ..............  7 \n5.4 Output Options  ................................ ................................ ................................ ..............  8 \n6 Assigning Concentrations to the Left Boundary  ................................ ..............................  8 \n7 The Advection Package  ................................ ................................ ................................ ...... 9 \n8 The Dispersion Package  ................................ ................................ ................................ ..... 9 \n9 The Source/Sink Mixing Package  ................................ ................................ .......................  9 \n10 The Chemical Reaction Package  ................................ ................................ ......................  10 \n11 Run MODFLOW  ................................ ................................ ................................ ..................  10 \n12 Running RT3D  ................................ ................................ ................................ ....................  10 \n13 Viewing the Results  ................................ ................................ ................................ ...........  10 \n13.1  Electron Donor  ................................ ................................ ................................ ............  10 \n13.2  Electron Acceptor  ................................ ................................ ................................ ....... 11 \n13.3  Aqueous -Phase Bacteria  ................................ ................................ ............................  11 \n13.4  Solid -Phase Bacteria  ................................ ................................ ................................ .. 12 \n13.5  Other Post -Processing Options  ................................ ................................ ..................  12 \n14 Conclusion  ................................ ................................ ................................ .........................  12 \n \n1 Introduction  \nThis tutorial illustrates the steps involved in using GMS and RT3D to model the reaction \nbetween  an electron donor and an electron acceptor, mediated by an actively growing \nmicrobial population that exists in both soil and aqueous phases. Since the flow model \nused in this simulation is the same as the flow model used in the \u201c RT3D \u2013 Instantaneous \nAero bic Degradation \u201d tutorial, the steps involved in building the flow model will not be \ndescribed in this tutorial. A predefined version of the flow model will be used.  \nThis tutorial will begin with importing a MODFLOW model then defining  RT3D inputs and \nboundary conditions, running MODFLOW, running RT3D, and viewing the results.  \n1.1 Description of the Reaction Model  \nMethods for enhancing in situ bioremediation of subsurface soil and groundwater involve \ninjection or infiltration of a carbon source (or electron  donor), nutrients, and other electron \nacceptors to stimulate the growth of native microbes. In addition, bioengineered \nsuspension cultures of contaminant degrading organisms may be also added to increase \nthe amount of attached and suspended biomass in the  subsurface. These two types of \nactive remediation techniques can be used to bioremediate contaminated source zones \nor to establish a biobarrier to prevent plume migration and/or to enhance plume \nattenuation. The successful use of subsurface microbes for b ioremediation requires an \nunderstanding of coupled flow, transport, and reaction processes that control bacterial \ngrowth and migration patterns. The Dual -Monod model, available in the RT3D code, can \nbe used to develop such understanding by simulating the c oupled reactive transport and \nmicrobial growth. The model is developed in a general format; therefore, the interaction \nbetween any electron donor and acceptor mediated by any type of microbial population \ncan be simulated by varying appropriate kinetic cons tants. Advanced users can modify \nthis basic formulation and couple it with other packages, such as the sorption package, to \nGMS Tutorials   RT3D \u2013 Double Monod Model  \n \n Page 3 of 12 \u00a9 Aquaveo 2024  simulate more realistic bioremediation scenarios (any such modified reaction models can \nbe easily implemented via the user -defined r eaction option).  \nAssuming the linear -equilibrium model for modeling sorption, and the Dual -Monod model \nfor modeling bacterial growth, the fate and transport equation for an electron donor \n(hydrocarbon, for example) in a multi -dimensional saturated porous m edia can be written \nas follows:  \n\uf028\uf029\n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf066\uf072\uf06d\uf066 \uf0b6\uf0b6\n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf0b6\uf0b6\n\uf0b6\uf0b6\n\uf0b6\uf0b6\n]A[+K]A[\n]D[+K]D[ X~\n+]X[- ]D[q + ]D[vx - \nx]D[\nx = t]D[R\nA Dmss\ni\ni jij\niD D\n ................................ ............  (1) \nWhere:  \n\uf0b7 [D] is the electron donor concentration in the aqueous phase [ML-3]  \n\uf0b7 [Ds] is the donor concentration in the sources/sinks [ML-3]  \n\uf0b7 Dij is the dispersion coefficient  \n\uf0b7 [X] is the aqueous phase bacterial cell concentration [ML-3]  \n\uf0b7 \n~X is the solid -phase cell concentration (mass of bacterial cells per unit mass of \nporous media [MM-1]) \n\uf0b7 [A] is the electron acceptor concentration in the aqueous phase [ML-3]  \n\uf0b7 RH is the retardation co efficient of the hydrocarbon, K D is the half -saturation \ncoefficient for the electron donor [ML-3] \n\uf0b7 KA is the half -saturation coefficient for the electron acceptor [ML-3]  \n\uf0b7 \uf06dm is the contaminant utilization rate [T-1]  \nThe model assumes that the degradation r eactions occur only in the aqueous phase, \nwhich is usually a conservative assumption.  \nThe fate and transport of the electron donor (oxygen, for example) can be modeled using \nthis equation:  \n\uf028\uf029\n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf066\uf072\uf06d\uf066 \uf0b6\uf0b6\n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf0b6\uf0b6\n\uf0b6\uf0b6\n\uf0b6\uf0b6\n]A[+K]A[\n]D[+K]D[ X~\n+]X[ Y - ]A[q + ]A[vx - \nx]A[\nx = t]A[R\nA Dm D/Ass\ni\ni jij\niA D\n ................................ .........  (2) \nwhere Y A/D is the stoichiometric yield c oefficient, and R A is the retardation coefficient of \nthe electron acceptor.  \nThe fate and transport of bacteria in the aqueous phase can be described using this \nequation:  \n\uf028\uf029\n]X[K-]A[+K]A[\n]D[+K]D[]X[ Y+X~K+]X[K-]X[q+]X[vx-t]X[\nx = t]X[\ne\nA Dm D/Xdet\natt ss\ni\niij\ni\n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\uf06d\uf066\uf072\n\uf066 \uf0b6\uf0b6\uf0f7\n\uf0f8\uf0f6\uf0e7\n\uf0e8\uf0e6\n\uf0b6\uf0b6\n\uf0b6\uf0b6\n\uf0b6\uf0b6D\n................................ .. (3) \nGMS Tutorials   RT3D \u2013 Double Monod Model  \n \n Page 4 of 12 \u00a9 Aquaveo 2024  where K att is the bacterial attachment coefficient [T-1], K det is the bacterial detachment \ncoefficient [T-1], and K e is the endogenous cell death or decay coefficient [T-1]. \nThe growth of attached -phase bacteria can be described using an ordinary differential \nequation of the form:  \nX~Ke-]A[+K]A[\n]D[+K]D[X~\nmY + X~Kdet - ]X[ Katt = dtX~d\nA DD/X \uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\uf06d\uf072\uf066\n ..........................  (4) \nThe conceptual model used here for representing attached bacteria cells is similar to the \nmacroscopic model described by Baveye and Valocchi (1989).1 The model also assumes \nfirst-order kinetic expressions for representing bacterial attachment and detachmen t \nprocesses (Taylor and Jaff\u00e9, 1990; and Hornberger et al., 1992).2 Permeability and \nporosity changes caused by bacterial growth are ignored in this formulation. However, if \nrequired, macroscopic models for biomass -affected porous -media properties describe d \nby Clement et al. (1996) may be integrated within this modeling approach.3 It should be \nnoted that a lot of active research is currently underway to gain an increased \nunderstanding of bacteria transport in porous media because currently available bacteri al \ntransport models (including the model used here) are arguably approximate. Therefore, \napplication of this model to real situations should be always supported by field - or \nlaboratory -scale data.  \nThe reactive -transport model discussed above was set up as a RT3D reaction package \nwith three mobile species (to represent electron donor, electron acceptor, and aqueous \nbacteria) and one immobile species (to represent attached soil bacteria). After employing \nthe reaction -operator splitting strategy, the reaction package for the problem reduces to \nthe following:  \n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf066\uf072 \uf06d\n]A[+ K]A[\n]D[+K]D[ X~\n+]X[Rm- = dt]D[d\n]A[ D D\n ................................ .............  (5) \n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf066\uf072 \uf06d\n]A[+K]A[\n]D[+K]D[ X~\n+]X[RmY- = dt]A[d\nA D AD/A\n ................................ ..... (6) \n]X[K]X[KX~K]A[+K]A[\n]D[+K]D[ X~\n+]X[ Y- = dt]X[d\ne attdetA Dm D/X\n\uf02d\uf02d\uf066\uf072\uf02b\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf066\uf072\uf06d\n ................................ .... (7) \n                                                      \n1 Baveye, P. and Valocchi, A.J. (1989). An Evaluation of Mathematical Models of the Transport of \nBiologically Reacting Solutes in Saturated Soils and Aquifers.  Water  Resources  Research , 25(6): \n1413 \u20131421.  \n2. Taylor, S.W., and Jaff\u00e9, P.R. (1990). Substrate and Biomass Transport in a Porous Medium. \nWater Resources Research , 26(9): 2181 \u20132194;  and Hornberger, G.M., Mills, A.L., and Herman, \nJ.S. (1992). Bacterial Transport in Porous Media: Evaluation of a Model Using Laboratory \nObservations. Water Resources Research , 28(3): 915 -938. \n3. Clement, T.P., Hooker, B.S., and Skeen, R.S. (1996). Macrosc opic Models for Predicting \nChanges in Saturated Porous Media Properties Caused by Microbial Growth. Ground Water, 34(5): \n934\u2013942. \nGMS Tutorials   RT3D \u2013 Double Monod Model  \n \n Page 5 of 12 \u00a9 Aquaveo 2024  \nX~Ke-]A[+K]A[\n]D[+K]D[X~\nmY + X~Kdet - ]X[ Katt = dtX~d\nA DD/X \uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\uf06d\uf072\uf066..............  (8) \nThese four equations are coded into the double -monod reaction module.  \n1.2 Description of Problem  \nThe p roblem in this tutorial is similar to the problem described in the \u201c RT3D \u2013 BTEX \nDegradation with Multiple Electron Acceptors \u201d tutorial. The site is a 510 m X 310 m \nsection of a confined aquifer with a flow gradient from left to right. An underground \nstorag e tank is leaking fuel hydrocarbon contaminants at 2 m3/day at the location shown. \nSource concentration of BTEX is 500 mg/L. It will be assumed that the aquifer is initially \nclean and has very low levels of aerobic bacterial activity. The fuel hydrocarbon \ncompounds are expected to serve as the carbon source, resuscitating the bacterial cells \nand activating them into a growth mode. This is a common subsurface phenomenon that \noccurs in most fuel -contaminated sites. Several field studies have observed the pres ence \nof enhanced levels of microbial activity near a source region, and low background levels \noutside the plume. This example will simulate the transient changes in hydrocarbon, \noxygen, and bacterial concentrations levels within the contaminated area.  \nInitial levels of hydrocarbon, oxygen, aqueous bacteria, and attached bacteria are \nrespectively assumed to be as follows: 0.0 mg/L, 9.0 mg/L, 2 x 10-17 (value for X in mg/L), \nand 3.0 x 10-9 (value for \nX~  in mg of bacteria/mg of soil). Note the mass fraction unit used \nfor representing soil bacterial cells will always yield small numbers. Using the value of soil \nporosity and bulk density, these numbers can be converted into standard mg/L units \n(liquid -volume basis) to get a better feel for bac terial concentration levels. For example, \nassuming \uf072 = 1.6 x 106 mg/L and \uf066 = 0.3, the initial value of soil bacterial concentration \ncan be expressed (when converted to a liquid volume basis using the formula \nX~ \uf072/\uf066) as \n0.016 mg/L. While  post-processing output concentration in GMS, the data calculator will \nbe used to perform this unit conversion. This is recommended because extremely small \nnumbers may not be displayed correctly in GMS.  \nAssumed values for other kinetic reaction constants a re given below:  \nConstant  GMS Display  Value  \n\uf06dm umax  0.125 day-1 \nKD Ked 0.12 mg/L  \nKA Kea 0.1 mg/L  \nYx/D Yx/ed 0.05 \nYA/D Yea/ed 3.0 \nKdecay Kdecay 0.001 day-1 \nKatt Katt 70.0 day-1 \nKdet Kdet 1.0 day-1 \nSorption is assumed to be negligible for this site, hence the values of all retardation \ncoefficients are assumed to be unity.  \nThe first part of the problem will be to import a previously computed MODFLOW flow \nmodel of the site. Using this flow field, a reactive transport model will be then be defined \nusing RT3D.  \n1.3 Getting Started  \nDo the following to get started:  \nGMS Tutorials   RT3D \u2013 Double Monod Model  \n \n Page 6 of 12 \u00a9 Aquaveo 2024  1. If GMS is not running, launch GMS.  \n2. If GMS is already running, select File |  New to ensure the program settings are \nrestored to the default state.  \n2 Importing the MODFLOW Model  \nThe first part of the simu lation is to import the MODFLOW flow model. A steady state flow \nmodel has been previously computed and is supplied with the tutorial files.  \n1. Click the Open   button to bring up the Open  dialog.  \n2. Locate and open the file entitled flowmod \\flowmod . \n3. Select the file entitled \u201cflowmod.gpr \u201d. \n4. Click Open  to import the file  and exit the Open  dialog.  \nAt this point, a grid should appear.  \n \nFigure 1 The grid imported with the flowmod.gpr file  \n3 Building the Transport Model  \nNow that the flow model is imported, the next step is to perform the RT3D simulation. For \nthis part of the simulation: select the reaction, define the reaction data, define the \nsupplemental layer data needed by RT3D, define the boundary conditions, and assign \nconcentra tions to the well.  \n4 Initializing the Model  \nTo initialize the RT3D data:  \n1. Expand the \u201c  3D Grid Data\u201d folder in the Project Explorer.  \n2. In the Project Explorer , right -click on the \u201c  grid\u201d item and select the New \nMT3D MS\u2026  command. This initializes MT3DMS/RT3D an d brings up the Basic \nTransport Package  dialog.  \n\nGMS Tutorials   RT3D \u2013 Double Monod Model  \n \n Page 7 of 12 \u00a9 Aquaveo 2024  5 The Basic Transport Package  \nThe next step is to set up the data in the Basic Transport Package. This will be \ncompleted by selecting RT3D as the transport model, selecting the appropriate \npackages, and initial izing the starting concentrations.  \n1. Select the RT3D  option in the Model  section of the dialog.  \n2. Select Packages \u2026 to open the MT3DMS/RT3D Packages dialog.  \n3. Turn on the following packages:  \n\uf0b7 Advection package  \n\uf0b7 Dispersion package  \n\uf0b7 Source/sink mixing package  \n\uf0b7 Chemical  reaction package.  \n4. For the RT3D reaction s type, select the \u201c Double Monod Model \u201d option.  \n5. Select OK to exit the MT3DMS/RT3D Packages  dialog.  \n5.1 Starting Concentration  \nNote that in the Starting Concentration  section of the dialog, the species associated with \nthe reaction being modeled are listed by name. The next step is to define the starting \nconcentration for each of these species. The default starting concentration is zero. This \ntutorial will use the defau lt value for the electron donor, but will use non -zero values for \nthe electron acceptor (9.0 mg/L), the aqueous phase bacteria (2x10-17 mg/L), and the \nsolid phase bacteria (3x10-9 mg bacteria/mg of soil).  \n1. In the Basic Transport Package  dialog, select Elect ron Acceptor  from the list of \nspecies and enter a value of \u201c 9.0\u201d for the Starting Conc. (mg/l) . \n2. Enter a Starting Conc. (mg/l)  value of \u201c 2e-17\u201d for the Aqueous -phase bacteria . \n3. Enter a Starting Conc. (mg/l)  value of \u201c 3e-9\u201d for the Soil-phase bacteria . \n5.2 Porosity  \nNext, it is necessary to consider the porosity, which should be set as 0.3. Since this is the \ndefault supplied by GMS, no changes need to be made.  \n5.3 Stress Periods  \nNext to define the stress periods. Since the injection rate and the boundary conditio ns do \nnot change, a single stress period with a length of 730 days (two years) will be used.  \n1. Select Stress Periods\u2026  to open the Stress Periods  dialog.  \n2. Enter a value of \u201c 730\u201d for the Length . \n3. Enter a value of \u201c 10\u201d for the Num Time Steps . \n4. Select OK to exit th e Stress Periods  dialog.  \nGMS Tutorials   RT3D \u2013 Double Monod Model  \n \n Page 8 of 12 \u00a9 Aquaveo 2024  5.4 Output Options  \nIt is now possible to define the output options. One binary solution file is created by RT3D \nfor each of the species. By default, RT3D saves a solution at each transport step for each \nspecies. Since this results in l arge files containing more solutions than are needed for \nsimple post -processing options, it would be good to specify that a solution be saved \nevery 73 days (every time step).  \n1. Select Output Control\u2026  to open the Output Control dialog.  \n2. Select the Print or sav e at specified times  option.  \n3. Select Times \u2026 to open the Variable Time Steps  dialog.  \n4. Select Initialize Values \u2026 to open the Initialize Time Steps  dialog.  \n5. Enter \u201c 73.0\u201d for the Initial time step size . \n6. Enter \u201c 73.0\u201d for the Maximum time step size . \n7. Enter \u201c 730.0 \u201d for the Maximum simulation time . \n8. Select OK to exit the Initialize Time Steps  dialog.  \n9. Select OK to exit the Variable Time Steps  dialog.  \n10. Select OK to exit the Output Control  dialog.  \nThis completes the input for the Basic Transport package.  \n11. Select OK to exit the Basic Transport Package  dialog.  \n6 Assigning Concentrations to the Left Boundary  \nThe left boundary of the model is a constant head boundary. Since the head at the left \nboundary is greater than the head at the right boundary, the left boundary act s as a \nsource and water enters the model from the left. Thus, the concentrations of the species \nat the left boundary must be defined. The simplest way to do this is to mark the cells as \nspecified concentration cells.  \n1. Using the Select Cells   tool, select t he cells on the left boundary by dragging \na box that just surrounds the cells.  \n \nFigure 2 Selecting the cells on the left side of the grid  \n\nGMS Tutorials   RT3D \u2013 Double Monod Model  \n \n Page 9 of 12 \u00a9 Aquaveo 2024  2. Select the RT3D | Cell Properties \u2026 command to open the 3D Grid Cell \nProperties  dialog.  \n3. Chang e the ICBUND  value to \u201c -1\u201d. \n4. Select OK to close the 3D Grid Cell Properties  dialog.  \n7 The Advection Package  \nThe next step is to initialize the data for the Advection Package.  \n1. Select the RT3D  | Advection Package\u2026  command to open the Advection \nPackage dialog.  \n2. Select the \u201c Method of characteristics (MOC) \u201d option in the drop -down menu for \nSolution scheme . \n3. Select OK to exit the Advection Package dialog.  \n8 The Dispersion Package  \nThe next step is to enter the data for the Dispersion package. The aquifer has a \nlongitudinal dispersivity of 10.0 m and a transverse (horizontal) dispersivity of 3.0 m.  \n1. Select the RT3D  | Dispersion Package\u2026  command to open the Dispersion \nPackage  dialog.  \n2. Enter a value of \u201c 0.3\u201d for TRPT . \n3. Select Longitudinal Dispersivity \u2026 to open the Longitudinal Dispersivity  dialog.  \n4. Select Constant \uf0d2 Grid to open the Grid Value dialog.  \n5. Enter a value of \u201c 10.0\u201d. \n6. Select OK to close the Grid Value  dialog.  \n7. Click OK to exit the Longitudinal Dispersivity  dialog.  \n8. Select OK to exit the Dispersion Package  dialog.  \n9 The Source/Sink Mixing Package  \nNext, to define the concentration at the spill location:  \n1. Using the Select Cell   tool, select the cell containing the injection well (spill \nlocation) by clicking anywhere in the interior of the cell.  \n2. Select the RT3D  | Point Sources/Sinks \u2026 command to open the \nMODFLOW/RT3D Sources/Sinks  dialog.  \n3. Click the Add BC  button near the bottom of the dialog.  \n4. Change the Type (ITYPE)  to \u201cwell (WEL) \u201d. \n5. In the Electron Donor  column,  enter a concentration of \u201c 500\u201d (mg/L).   \n6. Select OK to exit the MODFLOW/RT3D Sources/Sinks  dialog.  \n\nGMS Tutorials   RT3D \u2013 Double Monod Model  \n \n Page 10 of 12 \u00a9 Aquaveo 2024  10 The Chemical Reaction Package  \nNext, to initialize the Chemical Reaction package and define appropriate reaction rate \nconstants:  \n1. Select t he RT3D | Chemical Reaction Package\u2026  command to open the RT3D \nChemical Reaction Package dialog.  \n2. In the Reaction parameters  section, set umax  to \u201c0.125 \u201d. \n3. Likewise, set the value of Yea/ed  to \u201c3.0\u201d. \nThe rest of the constants will all be left at the default v alues.  \n4. Select OK to close the RT3D Chemical Reaction Package dialog.  \n11 Run MODFLOW  \nBefore running RT3D, it is necessary to first regenerate the MODFLOW solution.  \n1. Select the File | Save As  command to open the Save As  dialog.  \n2. Enter \u201c bacteria \u201d for the File name . \n3. Select Save  to save the files and exit the Save As  dialog.  \nTo run MODFLOW:  \n4. Select the MODFLOW  | Run MODFLOW  command to launch the MODFLOW  \nmodel wrapper.  \n5. When the MODFLOW simulation is finished, select Close to exit the MODFLOW  \ndialog.  \n12 Running RT3D  \nAt this point, it is possible to save the model and run RT3D.  \nTo run RT3D:  \n1. Select the RT3D  | Run RT3D\u2026  command to launch the RT3D  model wrapper.  \n2. Select Yes at the prompt to save the changes.  \n3. When the RT3D  simulation is finished, select Close  to exit the RT3D  dialog.  \n13 Viewing the Results  \n13.1 Electron Donor  \n1. Select the \u201c  Electron Donor \u201d dataset from the Project Explorer . (If needed, \nexpand the \u201c bacteria (RT3D) \u201d solution folder.)  \n2. Select the time step at t = 730 days from the Time Ste p Window . \nTo display color -filled contours:  \n3. Select the Contour Options   button to open the Dataset Contour Options \u2013 \n3D Grid \u2013 Electron Donor  dialog.  \n\nGMS Tutorials   RT3D \u2013 Double Monod Model  \n \n Page 11 of 12 \u00a9 Aquaveo 2024  4. Change the Contour method  to \u201cColor fill \u201d. \n5. Select OK to close the Dataset Contour Options \u2013 3D Grid \u2013 Electron Donor  \ndialog.  \nRecall that th e electron donor solution represents the contaminant. The plume is moving \nfrom the left side to the right side, as expected.  \n \nFigure 3      Electron Donor at 730 days  \n13.2 Electron Acceptor  \nNext, to view the electron acceptor solution:  \n1. Select the \u201c  Electron Acceptor \u201d dataset from the Project Explorer . \nNote that the electron acceptor solution is the inverse of the electron donor solution. The \nminimum value (the blue region) corresponds to the location of the plume.  \n \nFigure 4     Electron Acceptor at 730 days  \n13.3 Aqueous -Phase Bacteria  \nNext, to view the solution for the aqueous -phase bacteria:  \n1. Select the \u201c  Aqueous -phase bacteria \u201d dataset from the Project Explorer . \nNote that the bacteria are flourishing at the left end and around the edges of the plume \nwhere there is a combination of electron donors and electron acceptors.  \n\nGMS Tutorials   RT3D \u2013 Double Monod Model  \n \n Page 12 of 12 \u00a9 Aquaveo 2024   \nFigure 5      Aqueous -phase bacteria at 730 days  \n13.4 Solid -Phase Bacteria  \nFinally, to view the solution for the solid -phase  bacteria:  \n1. Select the \u201c  Solid -phase bacteria \u201d dataset from the Project Explorer . \nNote that the distribution of the soil bacteria is similar to the distribution of the aqueous -\nphase bacteria.  \n13.5 Other Post -Processing Options  \nAt this point, feel free to exper iment with the other post -processing options, including film \nloop animation and time series plots.  \n14 Conclusion  \nThis concludes the \u201cRT3D \u2013 Double Monod Model\u201d tutorial.  \n \n\n", "filename": "RT3D-DoubleMonodModel.pdf", "pages": 12}, "RT3D-InstantaneousAerobicDegradation": {"text": "GMS Tutorials   RT3D \u2013 Instantaneous Aerobic Degradation  \n Page 1 of 12 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nRT3D \u2013 Instantaneous Aerobic Degradation  \n \nObjectives   \nThis tutorial demonstrates how to simulate the reaction for instantaneous aerobic degradation of \nhydrocarbons using a predefined user reaction package . \n \nPrerequisite Tutorials  \n\uf0b7 MT3DMS \u2013 Grid Approach  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 RT3D  \n Time  \n\uf0b7 15\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   RT3D \u2013 Instantaneous Aerobic Degradation  \n Page 2 of 12 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Description of Problem  ................................ ................................ ................................ . 2 \n1.2 Description of Reaction  ................................ ................................ ................................ . 3 \n1.3 Getting Started  ................................ ................................ ................................ ..............  3 \n2 Building the MODFLOW Model  ................................ ................................ ...........................  4 \n2.1 Conceptual Model Approach vs. Grid Approach  ................................ ...........................  4 \n2.2 Units  ................................ ................................ ................................ .............................  4 \n2.3 Creating the Grid  ................................ ................................ ................................ ..........  4 \n2.4 Initializing the Model  ................................ ................................ ................................ ..... 4 \n2.5 The Global Package  ................................ ................................ ................................ ..... 5 \n2.6 The LPF Package  ................................ ................................ ................................ .........  5 \n2.7 Defining the Spill Well  ................................ ................................ ................................ ... 5 \n2.8 Assigning the Head BC  ................................ ................................ ................................ . 6 \n2.9 Running MODFLOW  ................................ ................................ ................................ ..... 7 \n3 Building the Transport Model  ................................ ................................ .............................  7 \n3.1 Initializing the Model  ................................ ................................ ................................ ..... 7 \n3.2 The Basic Transport Package ................................ ................................ .......................  7 \n3.3 Assigning Concentrations to the Left Boundary  ................................ ............................  9 \n3.4 The Advection Package  ................................ ................................ ..............................  10 \n3.5 The Dispersion Package  ................................ ................................ .............................  10 \n3.6 The Source/Sink Mixing Package  ................................ ................................ ...............  10 \n3.7 The Chemical Reactions Package  ................................ ................................ ..............  10 \n3.8 Running RT3D  ................................ ................................ ................................ ............  11 \n3.9 Viewing the Results  ................................ ................................ ................................ .... 11 \n3.10  Viewing a Film Loop Animation ................................ ................................ ...................  12 \n4 Conclusion  ................................ ................................ ................................ .........................  12 \n \n1 Introduction  \nThis tutorial illustrates the steps involved in performing a reactive transport simulation \nusing  the RT3D model. Several types of contaminant reactions can be simulated with \nRT3D by using a predefined or user -defined reaction package. The reaction simulated in \nthis tutorial is instantaneous aerobic degradation of hydrocarbons using a predefined \nuser reaction package.  \nThe tutorial will review:  \n\uf0b7 Creating a 3D grid  \n\uf0b7 Defining MODFLOW inputs and boundary conditions  \n\uf0b7 Running MODFLOW  \n\uf0b7 Defining the transport model  \n\uf0b7 Running RT3D  \n\uf0b7 Viewing a film -loop animation  \n1.1 Description of Problem  \nThe problem in this tutorial is shown in Figure 1. The site is a 510 m x 310 m section of a \nconfined aquifer with a flow gradient from left to right. An underground storage tank is \nleaking fuel hydrocarbon contaminants at 2 m3/day at the location shown. Concentration \nof the hydrocarbons is 1000 mg/L and the spill may be assumed to be devoid of oxygen. \nDetails of the aquifer hydrology and geometry are given below. Initial levels of \nhydrocarbon and oxygen in the aquifer are 0.0 and 9.0 mg/L, respectively. This tutorial \nwill simulate a continuous spill event  and compute the resulting hydrocarbon and oxygen \ncontours after one year using instantaneous degradation kinetics.  \nGMS Tutorials   RT3D \u2013 Instantaneous Aerobic Degradation  \n \n Page 3 of 12 \u00a9 Aquaveo 2024  The first part of the problem will be to compute a flow model of the site using MODFLOW. \nUsing the flow field computed by MODFLOW, a reactiv e transport model will then be \ndefined using RT3D.  \n \nConfined Aquifer  \nThickness = 10 m  \nK = 50 m/day  Spill Location  \n H = 100 m  H = 99 m  510 m  \n310 m  \n \nFigure 1 Sample problem to be modeled with RT3D  \n1.2 Description of Reaction  \nThe reaction model used here simulates the instantaneous degradation of fuel  \nhydrocarbons under aerobic conditions based on the following reaction (benzene basis):  \nCH O CO HO66 2 2 2 75 6 3 \uf02b\uf0ae\uf02b .\n ................................ ................................ . (1) \nTherefore, the mass ratio of benzene to oxygen, F, is 3.08 (i.e., 3.08 g of oxygen to 1 g of \nbenzene). The instantaneous removal of either co ntaminant (H) or oxygen (O) is dictated \nby the following algorithm, where t refers to a particular time step:  \nHt HtOtF ( ) () ()/ \uf02b\uf03d\uf02d 1\n and \nOt( )\uf02b\uf03d10 , when \nHtOtF () ()/\uf03e  .............  (2) \nOt OtHtF ( ) () () \uf02b\uf03d\uf02d\uf0b7 1\n and \nHt( )\uf02b\uf03d10 , when \nOtHtF () ()\uf03e\uf0b7  ............  (3) \nGiven this algorithm, either hydrocarbon or oxygen concentration in a given grid cell will \nbe reduced to zero at each time step, depending on which component is \nstoichiometrically limiting in the prior time step.  \n1.3 Getting Started  \nDo the following to get started:  \n1. If GMS is not open, launch GMS.  \n2. If GMS is already open, select the File | New command to ensure the program \nsettings are restored to the default state.  \n3. If asked to save changes, click Don\u2019t Save  to close the dialog and restore GMS \nto a default state.  \nGMS Tutorials   RT3D \u2013 Instantaneous Aerobic Degradation  \n \n Page 4 of 12 \u00a9 Aquaveo 2024  2 Building the MODFLOW Model  \nThe first part of the simulation is to build a MODFLOW flow model. In this case, a steady \nstate flow model will be used with the transport simulation.  \n2.1 Conceptual Model Appr oach vs. Grid Approach  \nIn many cases, the most efficient way to create a MODFLOW simulation is to build a \nconceptual model of the site using the feature objects in the Map module. However, since \nthis problem is a simple rectangular model, use the grid appr oach and edit values directly \non the cells.  \n2.2 Units  \nFirst to define the units:  \n1. Select the Edit | Units \u2026 command to open the Units  dialog.  \n2. For the Length  unit, click the  button to open the Display Projection  dialog.  \n3. Change the vertical and horizontal Units  to \u201cM eters \u201d. \n4. Click OK to close the Display Projection  dialog.  \n5. For the Time  unit, ensure that \u201c d\u201d is selected.  \n6. For the Mass  unit, ensure that \u201c mg\u201d is selected.  \n7. For the Force  unit, ensure that \u201c N\u201d is selected.  \n8. For the Concentration  unit, ensure that \u201c mg/l\u201d is selected.  \n9. Select OK to close the Units  dialog.  \n2.3 Creating the Grid  \nThe first step in defining the MODFLOW simulation is to create a single layer grid.  \n1. In the Project Explorer,  right-click on the empty space and select New | 3D \nGrid\u2026  to bring up the Create  Finite Difference Grid  dialog.  \n2. In the X-Dimension  section, enter \u201c 510\u201d for the length  and \u201c 51\u201d for Number cells . \n3. In the Y-Dimension  section, enter \u201c 310\u201d for the length  and \u201c 31\u201d for Number cells . \n4. In the Z-Dimension  section, enter \u201c 1\u201d for Number cells  (the length in Z does not \nmatter).  \n5. Select OK to close the Create Finite Difference Grid  dialog and create the 3D \ngrid. \nAt this point, a simple grid should appear in the Graphics Window.  \n2.4 Initializing the Model  \nNow to initialize the MODFLOW data:  \n1. In the Project Explorer , right -click on the \u201c  grid\u201d item and select New \nMODFLOW\u2026 to open the MODFLOW Global/Basic Package dialog.  \n\nGMS Tutorials   RT3D \u2013 Instantaneous Aerobic Degradation  \n \n Page 5 of 12 \u00a9 Aquaveo 2024  2.5 The Global Package  \nThe next step is to define the data in the MODFLOW Global Package.  \nStarting Head  \nFirst, define an initial head of 10 0 meters everywhere in the grid:  \n1. Turn off the Starting heads equal grid top elevations  option.  \n2. Select the Starting Heads \u2026 button to open the Starting Heads  dialog.  \n3. Select the Constant \uf0d2 Grid\u2026 button to open the Grid Value dialog.  \n4. Enter a value of \u201c 100\u201d. \n5. Select OK to close the Grid Value  dialog.  \n6. Select OK to exit the Starting Heads  dialog.  \nFor the layer elevations, there is a value of 10.0 m for the top elevation. The bottom \nelevation is at zero. The existing grid already has these values, so these values do not \nneed to be entered.  \nIt is necessary to change some values in the IBOUND array to designate the constant \nhead boundaries. Do this later by selecting the cells and using the Cell Properties  \ncommand.  \n7. Select OK to exit the MODFLOW Global/Basic Package  dialog.  \n2.6 The LPF Package  \nNext to define the data in the LPF package:  \n1. In the Project Explorer , expand the \u201c  MODFLOW \u201d item.  \n2. Right -click on the \u201c  LPF\u201d package and select Properties \u2026 to open the LPF \nPackage  dialog.  \n3. Under Layer type , select the Confined  option.  \nNext to enter a horizontal hydraulic conductivity value of 50 m/day.  \n4. Select the Horizontal Hydraulic Conductivity \u2026 button to open the Horizontal \nHydraulic Conductivity  dialog.  \n5. Select the Constant \uf0d2 Grid\u2026 button to open the Grid Value dialog.  \n6. Enter  a value of \u201c 50\u201d. \n7. Select OK to close the Grid Value  dialog.  \n8. Select OK to exit the Horizontal Hydraulic Conductivity  dialog.  \nThe rest of the default options in the package should be sufficient.  \n9. Select OK to exit the LPF Package  dialog.  \n2.7 Defining the Spill We ll \nThe spill will be simulated by defining an injection well at the location of the spill with a \nsmall injection rate. During the transport simulation, a concentration will be assigned to \nthe well. Do the following to define the well:  \n\nGMS Tutorials   RT3D \u2013 Instantaneous Aerobic Degradation  \n \n Page 6 of 12 \u00a9 Aquaveo 2024  1. Select the Select Cel ls  tool then, while watching the I, J, K fields in the status \nbar, locate the cell at I=16, J=16, K=1.  \n2. Right -click on the selected cell and select the Sources/Sinks \u2026 command from \nthe pop -up menu to open the MODFLOW Sources/Sinks dialog.  \n3. Select the Wells  (WEL) item in the list box . \n4. Select the Add BC  button.  \n5. Enter a value of \u201c 2.0\u201d (m^3/d) for the Q (flow) . \n6. Select OK to exit the MODFLOW Sources/Sinks dialog.  \n2.8 Assigning the Head BC  \nThe final step before running MODFLOW is to assign the constant head boundary \nconditions (BC) on the left and right sides of the model. First, assign the head BC on the \nleft side.  \n1. Using the Select j   tool, select the leftmost column in the grid.  \n2. Right -click on any of the cells in the leftmost column in the grid and select the  \nProperties \u2026 command to open the 3D Grid Cell Properties dialog.  \n3. In the IBOUND  row, switch the option to \u201c Specified head\u201d in the drop-down list . \n4. Leave the Starting head  value at \u201c 100.0 \u201d. \n5. Select OK to close the 3D Grid Cell Properties  dialog.  \nNext to assign the head boundary condition on the right side.  \n6. Using the Select j  tool, select the rightmost column in the grid.  \n7. Right -click on any of the cells in the rightmost column in the grid and select the  \nProperties \u2026 command to open the 3D Grid Cell Properties dialog.  \n8. In the IBOUND  row, switch the option to \u201c Specified head\u201d in the drop-down list . \n9. Enter \u201c 99\u201d for the Starting head  value.  \n10. Select OK to close the 3D Grid Cell Properties  dialog.  \n \nFigure 2     The MODFLOW grid  \n\nGMS Tutorials   RT3D \u2013 Instantaneous Aerobic Degradation  \n \n Page 7 of 12 \u00a9 Aquaveo 2024  2.9 Running MODFLOW  \nAt this point, it is possible to save the model and run MODFLOW.  \n1. Select the File | Save As\u2026  command to open the Save As  dialog.  \n2. Create or locate a folder where the model can be saved.  \n3. Enter \u201c flowmod \u201d for the name of the simulation.  \n4. Select the Save  button.  \nTo run MODFLOW:  \n5. Select the MODFLOW  | Run MODFLOW  command to start the MODFLOW  \nmodel wrapper.  \n6. When the simulation is finished, select the Close button to exit the MODFLOW  \nmodel wrapper.  \nGMS imports the solution automatically, showing a series of contours indicating a flow \nfrom left to right. Note: The color ramp may need to be reversed to match Figure 3.  \n \nFigure 3     The MODFLOW solution  \n3 Building the Transport Model  \nNow that the flow model is established, the next step is to perf orm the RT3D simulation. \nFor this part of the simulation, select the reaction, define the reaction data, define the \nsupplemental layer data needed by RT3D, and assign concentrations to the well.  \n3.1 Initializing the Model  \nThe first step is to initialize the RT 3D data.  \n1. Right -click on the \u201c  grid\u201d item in the Project Explorer  and select the New \nMT3DMS \u2026 command to open the Basic Transport Package dialog.  \n3.2 The Basic Transport Package  \nNow, enter the data for the Basic Transport Package. Start with selecting RT3D as t he \ntransport model and selecting the appropriate packages.  \n\nGMS Tutorials   RT3D \u2013 Instantaneous Aerobic Degradation  \n \n Page 8 of 12 \u00a9 Aquaveo 2024  1. In the Model  section, select the RT3D  option.  \n2. Select Packages \u2026 to open the MT3DMS/RT3D Packages  dialog.  \n3. Select the following packages:  \n\uf0b7 Advection package  \n\uf0b7 Dispersion package  \n\uf0b7 Source/ sink mixing package  \n\uf0b7 Chemical reaction package  \n4. Under RT3D reactions , select the \u201c Inst. Aerobic Deg. of BTEX \u201d option.  \n5. Select OK to exit the MT3DMS/RT3D Packages  dialog.  \nStarting Concentrations  \nNote that in the l ayer data section of the dialog, the species associated with the reaction \nbeing modeled are listed by name. The next step is to define the starting concentration \nfor each of these species. By default, all of the starting concentrations are zero. This is \nthe correct concentration for BTEX. For oxygen, define an ambient concentration of 9.0 \nmg/L.  \n1. Select the Oxygen  species in the Species  list. \n2. Enter a value of \u201c 9.0\u201d (mg/l) in the Starting Conc. column.  \nPorosity  \nNext, porosity must be considered. The aquifer is a uniform horizontal aquifer with a top \nelevation of 10  m, a thickness of 10 m, and a porosity of 0.3. Since 0.3 is the default \nporosity assigned by GMS, no changes need to be made.  \nStress Periods  \nNext to define the stress periods. Since the injection rate and the boundary conditions do \nnot change, set a singl e stress period with a length of 730 days (two years).  \n1. Select Stress Periods\u2026  to open the Stress Periods dialog.  \nSince there is already one stress period by default, simply change the length of the stress \nperiod  \n2. Enter a value of \u201c 730\u201d for the Length . \n3. Enter  a value of \u201c 10\u201d for the Num Time Steps . \n4. Select OK to exit the Stress Periods  dialog.  \nOutput Options  \nFinally, define the output options. One binary solution file is created by RT3D for each of \nthe species. By default, RT3D saves a solution at each transport step for each species. \nSince this results in large files containing more solutions than are needed for the simple \npost-processing intended here, simply specify that a solution be saved every 73 days \n(every time step).  \n1. Select Output Control\u2026  to op en the Output Control dialog.  \n2. Select the Print or save at specified times  option.  \n3. Select Times \u2026 to open the Variable Time Steps  dialog.  \nGMS Tutorials   RT3D \u2013 Instantaneous Aerobic Degradation  \n \n Page 9 of 12 \u00a9 Aquaveo 2024  4. Select Initialize Values \u2026 to open the Initialize Time Steps  dialog.  \n5. Enter \u201c 73.0\u201d (d) for the Initial time step size . \n6. Enter \u201c73.0\u201d (d) for the Maximum time step size . \n7. Enter \u201c 730.0 \u201d (d) for the Maximum simulation time . \n8. Select OK to exit the Initialize Time Steps  dialog  \n9. Select OK to exit the Variable Time Steps  dialog.  \n10. Select OK to exit the Output Control  dialog.  \nThis completes the input for the Basic Transport package.  \n11. Select OK to exit the Basic Transport Package  dialog.  \n3.3 Assigning Concentrations to the Left Boundary  \nThe left boundary of the model is a constant head boundary. Since the head at the left \nboundary is grea ter than the head at the right boundary, the left boundary acts as a \nsource and water enters the model from the left. Thus, the concentrations of the species \nat the left boundary must be defined. Otherwise, the water entering the model will have \nthe defaul t concentration (zero) for each of the species. This is often true for most \nspecies, but there are exceptions. For this model, the incoming fluid should have an \nambient oxygen concentration of 9.0 mg/L. The oxygen concentration can be assigned \none of two w ays: \n1. The cells at the boundary can be marked as specified concentration cells by \nchanging the ICBUND value at the cells to -1. \n2. The concentration of the incoming fluid at the boundary can be defined using the \nSource/Sink Mixing  package.  \nThe first method requires the fewest number of steps to set up. As long as the boundary \nacts as a source throughout the simulation, either of these approaches will achieve the \nsame result. However, if the boundary acts as a sink during any part of the simulation, \nthe secon d option should be used. With the second option, if the boundary switches to a \nsink due to changing heads in the interior of the model, the concentrations at the cells \nwould be computed by RT3D. With the first option, the concentrations at the cells are \nfixed, regardless of the flow direction.  \nFor this problem, the flow field is steady state and the boundary acts as a source. Thus, \nthe first option is the most appropriate here. To mark the cells as specified concentration \ncells, do the following:  \n3. Use the Select Cells   tool to select the cells on the left boundary by dragging \na box that just surrounds the cells.  \n4. Select the RT3D  | Cell Properties \u2026 command to open the 3D Grid Cell \nProperties  dialog.  \n5. Change the ICBUND  value to \u201c -1\u201d. \n6. Select OK to close the 3D Gr id Cell Properties  dialog.  \nNote that the starting concentration values do not need to be changed since the values \nare already assigned via the starting concentration arrays.  \n\nGMS Tutorials   RT3D \u2013 Instantaneous Aerobic Degradation  \n \n Page 10 of 12 \u00a9 Aquaveo 2024  3.4 The Advection Package  \nThe next step is to initialize the data for the Advection pa ckage. This tutorial will be using \nthe MOC method.  \n1. Select the RT3D | Advection Package\u2026  command to open the Advection \nPackage  dialog.  \n2. In the Solution scheme  drop-down menu, select the \u201c Method of characteristics \n(MOC) \u201d method.  \n3. Select OK to close the Advecti on Package  dialog.  \n3.5 The Dispersion Package  \nNext, enter the data for the Dispersion package. The aquifer has a longitudinal \ndispersivity of 10.0 m and a transverse dispersivity of 3.0 m. The vertical dispersivity is \nassumed equal to the longitudinal dispersi vity. \n1. Select the RT3D  | Dispersion Package\u2026  command to open the Dispersion \nPackage  dialog.  \n2. Select Longitudinal Dispersivity \u2026 to open the Longitudinal Dispersivity  dialog.  \n3. Select Constant \uf0d2 Grid\u2026 to open the Grid Value dialog.  \n4. Enter a value of \u201c 10.0\u201d. \n5. Select OK to close the Grid Value  dialog.  \n6. Select OK to exit the Longitudinal Dispersivity  dialog.  \n7. Enter a value of \u201c 0.3\u201d for the TRPT  value.  \n8. Select OK to exit the Dispersion Package  dialog.  \n3.6 The Source/Sink Mixing Package  \nNext to define the concentration at  the spill location. To define the source at the spill \nlocation, select the well and assign a concentration.  \n1. Use the Select Cells   tool to select the cell containing the injection well (spill \nlocation) by clicking anywhere in the interior of the cell.  \n2. Select the RT3D  | Point Sources/Sinks \u2026 command to open the MODFLOW/ \nRT3D Sources/Sinks dialog.  \n3. Click the Add BC  button near the bottom of the dialog.  \n4. In the All column, change the Type (ITYPE)  to \u201cwell (WEL) \u201d. \n5. In the BTEX  column,  enter a concentration of \u201c 1000 \u201d (mg/L).   \n6. Leave the oxygen at the default value of \u201c 0.0\u201d. \n7. Select OK to exit the MODFLOW/RT3D Sources/Sinks  dialog.  \n3.7 The Chemical Reactions Package  \nThe final step is to initialize the data for the Chemical Reactions package. In this case, \nthe default va lues are adequate, so no changes are necessary.  \n\nGMS Tutorials   RT3D \u2013 Instantaneous Aerobic Degradation  \n \n Page 11 of 12 \u00a9 Aquaveo 2024  3.8 Running RT3D  \nIt is now possible to save the model and run RT3D. Before running RT3D, save the \ncurrent project under a different name than the MODFLOW model. Because this is done, \nit is necessary to explicitly  tell RT3D the name of the MODFLOW model.  \n1. Select the RT3D  | Run Options\u2026  command to open the Run Options  dialog.  \n2. Select the Single run with selected MODFLOW solution option. Confirm that the \n\u201cflowmod (MODFLOW) \u201d solution is selected.  \n3. Click OK to close the Run Options  dialog.  \n4. Select the File |  Save As \u2026 command to open the Save As  dialog.  \n5. Check to make sure the directory is the same one the model was saved in \ninitially.  \n6. Enter \u201c btexmod \u201d for the File name . \n7. Select Save  to save the new project file and close the Save As dialog.  \nTo run RT3D:  \n8. Select the RT3D |  Run RT3D \u2026 command to launch the RT3D  model wrapper.  \n9. When the simulation is finished, select Close  to exit the RT3D  model wrapper.  \nGMS will read in the solution automatically.  \n3.9 Viewing the Results  \nThe visible contours are for BTEX at the end of the first time step (73.0 days). To view \nthe BTEX solution at 730 days, do the following:  \n1. Expand the \u201c  btexmod (RT3D) \u201d solution in the Project Explorer . \n2. Select the \u201c BTEX \u201d dataset . \nThe Time Step Window  should now appea r below the Project Explorer . The Time Step \nWindow  is set to appear when a transient dataset is selected in the Project Explorer . \n3. Select the 730.0  time step in the Time Step  Window . \nTo get a better plot of the concentration contours:  \n4. Select Contour Options   from the main toolbar to open the Dataset Contour \nOptions \u2013 3D Grid \u2013 BTEX  dialog.  \n5. Select the \u201c Color Fill \u201d option from the first Contour method drop-down.  \n6. Select OK to exit the Dataset Contour Options \u2013 3D Grid \u2013 BTEX  dialog.  \nNext, view the Oxygen solution at 730 days.  \n7. Select the \u201c  Oxygen \u201d dataset in the Project Explorer . \nFeel free to use the Project Explorer  and Time Step  Window to view the solution at other \ntime steps.  \n\nGMS Tutorials   RT3D \u2013 Instantaneous Aerobic Degradation  \n \n Page 12 of 12 \u00a9 Aquaveo 2024   \nFigure 4    The BTEX solution set at 730 days  \n3.10 Viewing a Film Loop Animation  \nThe most effective post -processing tool for transient data is to set up a film loop \nanimation showing the fate of the BTEX through the entire duration of the simulation.  \n1. Select  the \u201c BTEX \u201d dataset  in the Project Explorer . \nTo set up the animation:  \n2. Select the Display | Animate \u2026 command to open the Animation Wizard \u2013 \nOptions  dialog.  \n3. Make sure the Dataset  option is turned on then click Next  > to go to the \nAnimation Wizard \u2013 Datasets page of the dialog.  \n4. Turn on the Display clock  option.  \n5. Select the Finish  button to generate the animation and close the Animation \nWizard  dialog.  \nThe generated animation file can be viewed in a media player application if desired.  \n4 Conclusion  \nThis concludes the tutorial. Continue to explore using RT3D o r close the program.  \n \n\n", "filename": "RT3D-InstantaneousAerobicDegradation.pdf", "pages": 12}, "RT3D-Rate-LimitedSorptionReaction": {"text": "GMS Tutorials   RT3D \u2013 Rate -Limited Sorption Reaction  \n Page 1 of 15 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nRT3D \u2013 Rate -Limited Sorption Reaction  \n \nObjectives   \nThis tutorial illustrates the steps involved in using GMS and RT3D to model sorption reactions under \nmass -transfer limited conditions . \n \nPrerequisite Tutorials  \n\uf0b7 RT3D \u2013 Instantaneous \nAerobic Degradation  \n Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 RT3D  \n Time  \n\uf0b7 35\u201350 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   RT3D \u2013 Rate -Limited Sorption Reaction  \n Page 2 of 15 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Description of the Reaction Model  ................................ ................................ ................  2 \n1.2 Description of Problem  ................................ ................................ ................................ . 4 \n1.3 Getting Started  ................................ ................................ ................................ ..............  5 \n2 Building the Flow Model  ................................ ................................ ................................ ..... 5 \n2.1 Reading in the Map File  ................................ ................................ ................................  5 \n2.2 Units  ................................ ................................ ................................ .............................  5 \n2.3 Creating the Grid  ................................ ................................ ................................ ..........  6 \n2.4 Initializing the MODFLOW Data  ................................ ................................ ....................  6 \n2.5 The Global Package  ................................ ................................ ................................ ..... 6 \n2.6 Specified Head Boundaries  ................................ ................................ ..........................  7 \n2.7 The LPF Package  ................................ ................................ ................................ .........  7 \n2.8 Creating the Wells  ................................ ................................ ................................ ........  8 \n2.9 Saving and Running the Flow Model  ................................ ................................ ............  9 \n3 Building the Transport Model  ................................ ................................ .............................  9 \n3.1 Initializing the Model  ................................ ................................ ................................ ..... 9 \n3.2 The Basic Transport Package ................................ ................................ .......................  9 \n3.3 The Advection Package  ................................ ................................ ..............................  11 \n3.4 The Dispersion Package  ................................ ................................ .............................  11 \n3.5 The Source/Sink Mixing Package  ................................ ................................ ...............  12 \n3.6 The Reaction Package  ................................ ................................ ...............................  12 \n3.7 Saving and Running the Simulation  ................................ ................................ ............  13 \n3.8 Viewing the Solution  ................................ ................................ ................................ ... 13 \n4 Comparison to Other Solutions ................................ ................................ ........................  14 \n4.1 Importing the Solutions  ................................ ................................ ...............................  14 \n4.2 MT3DMS Solution  ................................ ................................ ................................ ....... 14 \n4.3 Comparing the Solid Phase Concentrations  ................................ ...............................  15 \n5 Conclusion  ................................ ................................ ................................ .........................  15 \n \n1 Introduction  \nThis tutorial will start by building a MODLFLOW model by using a map file, creating a 3D \ngrid, defining the MODFLOW inputs and boundary conditions, and finally running \nMODFLOW. After the MODFLOW model solutions have been created, the RT3D inputs \nand boundary condition will be entered  and the RT3D model will be executed. Finally, the \nsolutions from the RT3D model run will be imported and compared.  \n1.1 Description of the Reaction Model  \nThe fate and transport of an organic pollutant in subsurface environments is often highly \ndependent on its  sorption characteristics. Under most natural groundwater flow \nconditions, the partitioning of contaminants between the solid and aqueous phases can \nbe assumed to be at a local equilibrium. Thus, the more widely used retardation \napproach for modeling sorpt ion may provide an adequate description for the overall \ntransport. However, the equilibrium assumption may fail when external pumping and \ninjection stresses are imposed on an aquifer (e.g. using a pump -treat system). This would \nlead to some well -known cond itions such as the plume tailing effect (i.e., low contaminant \nlevels always observed at the extraction well) and/or the rebounding effect (i.e., the \naquifer seems to be clean but the aqueous concentrations start to increase immediately \nafter stopping the treatment system). These conditions cannot be simulated using the \nstandard linear retardation approach since they require a mass -transfer description for \nthe sorption reactions.  \nIn the mass -transfer limited sorption model, the exchange of contaminants betw een the \nsoil and groundwater is assumed to be rate limited. The rate of exchange is dictated by \nthe value of the mass -transfer coefficient. When the mass -transfer rate is high (relative to \nthe overall transport), the rate -limited model relaxes to the retar dation model. On the \nGMS Tutorials   RT3D \u2013 Rate -Limited Sorption Reaction  \n \n Page 3 of 15 \u00a9 Aquaveo 2024  other end of the spectrum, a very low mass -transfer coefficient would mimic fully \nsequestered conditions where the contaminants in the soil phase are assumed to be \nirreversibly adsorbed and trapped into the soil pores. Under this extre me condition, it \nmight be possible to simply clean the groundwater plume and leave the sequestered soil \ncontaminant in the aquifer because the sorbed contaminants may not pose any potential \nrisk to the environment. In either of the extreme conditions, pump -and-treat is the best \noption to remediate the groundwater plume. Unfortunately, in most instances, the mass -\ntransfer coefficient is expected to lie in an intermediate range, causing the well -known \nlimitations to the pump -and-treat system.  \nWhen sorption is  assumed to be rate limited, it is necessary to track contaminant \nconcentrations in both mobile (groundwater) and immobile (soil) phases. Following \nHaggerty and Gorelick\u2019s (1994) approach,1 the fate and transport of a sorbing solute at \naqueous and soil pha ses can be predicted using the following transport equations:  \n\uf028\uf029\uf0b6\n\uf0b6\uf02b\uf0b6\n\uf0b6\uf0b6\n\uf0b6\uf0b6\n\uf0b6\uf0e6\n\uf0e8\uf0e7\uf0e7\uf0f6\n\uf0f8\uf0f7\uf0f7\uf0b6\n\uf0b6C\nt C\nt= \nixijDC\njx-\nixivC+sq\nsC\uf072\n\uf066 \uf066~\n ................................ ................  (1) \n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf06c\uf02d\uf078\uf0b6\uf0b6\n\uf066\uf072 C~\nC = tC~\n ................................ ................................ ..............................  (2) \nWhere:  \n\uf0b7 C is the concentration of the contaminant in the mobile -phase [ML-3],  \n\uf0b7 \n~C  is the concentration of the contaminan t in the immobile phase (mass of the \ncontaminants per unit mass of porous media,  \n\uf0b7 [MM-1]), r is the bulk density of the soil matrix, \uf066 is the soil porosity,  \n\uf0b7 \uf078 is the first -order, mass -transfer rate parameter [T-1] \n\uf0b7 \uf06c is the linear partitioning coefficient (which is equal to the linear, first -order \nsorption constant K d) [L3M-1].  \nIt can be mathematically shown that the above model formulation relaxes to the \nretardation model when the value of \uf078 becomes high.2 \nThe mass -transfer model discussed above has been implemented as an RT3D reaction \npackage (one mobile species and one immobile species). After employing reaction -\noperator splitting, the reaction package for the problem reduces to the following:  \n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf06c\uf02d\uf078\uf02dC~\nC  = dtdC\n ................................ ................................ ...............................  (3) \n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\n\uf06c\uf02d\uf072\uf066\uf078 C~\nC = dtC~d\n ................................ ................................ ...............................  (4) \n                                                      \n1  Haggerty, R., and Gorelick, S.M. (1994). Design of Multiple Contaminant Remediation: Sensitivity \nto Rate -Limited Mass Transport. Water Resource Research , 30(2), 435 \u2013446. \n2 See Clement, T.P. , Sun., Y., Hooker, B.S., and Petersen, J.N. (Spring 1998). Modeling Multi -\nspecies Reactive Transport in Groundwater Aquifers,  Groundwater Monitoring & Remediation \nJournal , 18(2), 79 \u201392. \nGMS Tutorials   RT3D \u2013 Rate -Limited Sorption Reaction  \n \n Page 4 of 15 \u00a9 Aquaveo 2024  These two differential equations are coded into the model #4 designated as the rate -\nlimited sorption reaction module.  \n1.2 Description of Problem  \nThe example problem in this tutorial is shown in Figure 1. The site is a 304 m x 152 m \nsection of an unconfined aquifer with flow gradient from left to right. A spill at the center of \nthe site has created a contaminant plume as  shown in the figure. A pump -and-treat \nsystem, using three injection wells and three extraction wells at the constant rate of 115 \nm3/day, will be used to clean the contaminant plume. The aqueous concentration of \ncontaminant level throughout the plume is as sumed to be at 300 mg/L. The linear \npartitioning coefficient (K d or \uf06c) for the contaminant is assumed to be 1.0x10-7 (L/mg), soil \ndry bulk density, \uf072, is assumed to be 1.5x106 (mg/L), and porosity is assumed to be 0.3. \nNote these parameters yield an effect ive retardation coefficient value of 1.5 (\n\uf066\uf072\uf06c\uf02b\uf03d / 1R\n). Assuming equilibrium conditions exist before starting the pump -and-treat \nsystem, the initial soil -phase contaminant concentration levels, \nC C~\uf06c\uf03d , can be \nestimated to be at 3 x10-5 (mg of contaminant / mg of soil). The objective of the treatment \nsystem is to clean both dissolved and soil -phase contamination. The model will simulate \nthe effectiveness of the system under different mass transfer conditions. A 3000 day \nsimulation w ill be performed. The mass -transfer coefficient values will be varied to \nsimulate retardation conditions (using \uf078 = 0.1 day-1), intermediate conditions (using \uf078 = \n0.002 day-1), and sequestered conditions (using 0.0001 day-1). Time series plots and \ncontour plots will be used to visualize the treatment scenarios under different field \nconditions.  \n \n300 m \n150 m Spill \nInjection  \nWells  \nQ=25 m3/d Extraction  \nWells  \nQ=-25 m3/d \nHead = 8 m Head = 7 m \nK = 3.0 m/day \nOne unconfined layer  \nBottom elevation = 0  \nPorosity = 0.3  \nLongitudinal dispersivity = 3.0 m  \nRatio of transverse to longitudinal dispersivity = 0.1  \nBulk density = 1.5e+6 mg/L  \n \nFigure 1 Sample problem  \nGMS Tutorials   RT3D \u2013 Rate -Limited Sorption Reaction  \n \n Page 5 of 15 \u00a9 Aquaveo 2024  1.3 Getting Started  \nDo the following to get started:  \n1. If GMS is not running, launch GMS.  \n2. If GM S is already running, select the File |  New command to ensure the program \nsettings are restored to the default state.  \n2 Building the Flow Model  \nThe first step in setting up the problem is to build the MODFLOW flow model. The model \nwill be a steady state, one -layer unconfined model with 6.1 m x 6.1 m cells. The flow \nsolution will then be used to drive the transport model.  \n2.1 Reading in the Map File  \nBefore creating the flow model, first import a map file that contains some drawing objects \nfor background display th at will aid in building the model.  \n1. Select the File | Open  command to bring up the Open  dialog.  \n2. Locate and open the directory entitled Tutorials \\RT3D \\rlimsorp . \n3. Select the file entitled \u201c site.gpr \u201d. \n4. Click Open  to import the file.  \nThe blue rectangle is the mod el boundary and the red rectangle is the spill location.  \n \nFigure 2      The site boundary and spill location  \n2.2 Units  \nTo define the units:  \n1. Select the Edit | Units  command to open the Units  dialog.  \n2. For the Length  units, select the   button to the right of the length field to open \nthe Display Projection  dialog.  \n3. Change the Unit for both Vertical  and Horizontal  to \u201cMeters \u201d. \n4. Click OK to close the  Display Projection  dialog.  \n\nGMS Tutorials   RT3D \u2013 Rate -Limited Sorption Reaction  \n \n Page 6 of 15 \u00a9 Aquaveo 2024  5. For the Time  units, ensure that \u201c d\u201d is selected.  \n6. For the Mass  units, ensure that \u201c mg\u201d is selected.  \n7. For the Force  units, ensure that \u201clb\u201d is selected.  \n8. For the Concentration  units, ensure that \u201c mg/l\u201d is selected.  \n9. Select OK to close the Units  dialog.  \n2.3 Creating the Grid  \nTo create the grid:  \n1. In the Project Explorer , right -click on the empty space then, from the pop -up \nmenu, select the New | 3D Grid  command. The Create Finite Difference Grid  \ndialog will appear.  \n2. Change the values to match the following table.  \n X-Dimension  Y-Dimension  Z-Dimension  \nOrigin  0.0 0.0 0.0 \nLength  300.0  150.0  10.0 \nNumber cells  50 25 1 \n3. Select OK to close the Create Finite Difference Grid  dialog and create the grid.  \nThe grid should line up with the image imported earlier.  \n2.4 Initializing the MODFLOW Data  \nTo initialize the MODFLOW data:  \n1. In the Project  Explorer , right -click on the \u201c  grid\u201d item and select the New \nMODFLOW  command to bring up the MODFLOW Global/Basic Package  dialog.  \n2.5 The Global Package  \nNext to review the data in the Global package.  \nIBOUND  \nThe IBOUND array is used to designate the constant head boundaries. However, the \nboundaries will be marked later in the tutorial by directly selecting the cells.  \nStarting Head  \nA starting head of 10 m will be assigned everywhere in the grid. Since the top grid \nelevation is 10, it is possible to sim ply make sure that the Starting heads equal grid top \nelevations toggle is on, which will automatically set a constant of 10 for the starting head.  \nGrid Elevations  \nThe top elevation is a constant value of 10 m throughout the grid; the bottom elevation is \na constant value of zero throughout the grid. The grid that was created already has these \nvalues, so no changes need to be made.  \n1. Select OK to exit the MODFLOW Global/Basic Package  dialog.  \n\nGMS Tutorials   RT3D \u2013 Rate -Limited Sorption Reaction  \n \n Page 7 of 15 \u00a9 Aquaveo 2024  2.6 Specified Head Boundaries  \nNext to define the specified head boundaries . \n1. Using the Select J   tool, select the leftmost column of cells in the grid.  \n2. Right -click and select the Properties \u2026 command to open the 3D Grid Cell \nProperties dialog.  \n \nFigure 3 Changing the properties of the cells on the left of  the grid  \n3. In the IBOUND  row, switch the option to \u201c Specified Head \u201d in the pull -down list . \n4. Change the Starting head  value to \u201c 8\u201d. \n5. Select OK to close the 3D Grid Cell Properties  dialog.  \n6. Using the Select J   tool, select the rightmost column of cells.  \n7. Right -click and select the Properties \u2026 command  to open the 3D Grid Cell \nProperties dialog.  \n8. In the IBOUND  row, switch the option to \u201c Specified Head \u201d in the pull -down list . \n9. Change the Starting head  value to \u201c 7\u201d. \n10. Select OK to close the 3D Grid Cell Properties  dialog.  \n11. Click anywhere outside the grid to unselect the cells.  \n2.7 The LPF Package  \nNext to define the input for the LPF package. Enter a hydraulic conductivity that is \nconstant throughout the grid.  \n1. In the Project Explorer , expand the \u201c  MODFLOW \u201d item.  \n2. Expand  the \u201c  LPF Package \u201d. \n3. Right -click on the \u201c  HK\u201d dataset and select the Properties  command  to open \nthe Horizontal Hydraulic Conductivity dialog.  \n\nGMS Tutorials   RT3D \u2013 Rate -Limited Sorption Reaction  \n \n Page 8 of 15 \u00a9 Aquaveo 2024  4. Select Constant \uf0d2 Layer  to open the Layer Value dialog.  \n5. Enter a value of \u201c 3.0\u201d. \n6. Click OK to close the Layer Value  dialog.  \n7. Select OK to close the Horizontal Hydraulic Conductivity dialog.  \n2.8 Creating the Wells  \nDo the following to create the injection wells:  \n1. Using the Select Cell   tool and holding down the Ctrl key, select the cells on \nthe left side of the model wit h the three yellow circles.  \n \nFigure 4 Location of injection and extraction well cells  \n2. Right -click one of the selected cells and select the Sources/Sinks \u2026 command \nto open the MODFLOW Sources/Sinks dialog.  \n3. Make sure that Wells  (WEL)  is selected in the list box on the left of the dialog.  \n4. Select the Add BC  button.  \n5. Enter a value of \u201c 25\u201d for the Q (Flow)  of each well . \n6. Select OK to close the MODFLOW Sources/Sinks dialog.  \n7. Click anywhere outside the grid to unselect the cells.  \nTo create the  extraction wells:  \n8. While holding down the Ctrl key, select the cells on the right side of the model \nwith the three yellow circles.  \n9. Right -click one of the selected cells and select the Sources/Sinks\u2026  command.  \n10. Make sure that Wells  (WEL)  is selected in the li st box on the left of the dialog.  \n11. Select the Add BC  button.  \n12. Enter a value of \u201c -25.5\u201d for the Q (Flow)  for each well . \n13. Select OK to open the MODFLOW Sources/Sinks dialog.  \n14. Click anywhere outside the grid to unselect the cells.  \n\nGMS Tutorials   RT3D \u2013 Rate -Limited Sorption Reaction  \n \n Page 9 of 15 \u00a9 Aquaveo 2024  2.9 Saving and Running the Flow Mode l \nAt this point, it is possible to save the model and run MODFLOW.  \n1. Select the File | Save As  command to open the Save As  dialog.  \n2. Make sure the path is still set to Tutorials \\RT3D \\rlimsorp . \n3. Enter \u201c rlimsorp \u201d for the File name . \n4. Select Save . \nTo run MODFLOW:  \n5. Select the MODFLOW  | Run MODFLOW  command to launch the MODFLOW  \nsimulation.  \n6. When the MODFLOW  simulation is finished, select Close . \nGMS will automatically read in the solution and display a series of contours indicating a \nflow from left to right with mounds around the injection wells and cones of depression \naround the extraction wells.  \n3 Building the Transport Model  \nNext to build the RT3D transport model that simulates retardation conditions. Then \ncompare that solution to a solution from MT3DMS. Finally, compare the retardation \nsolution to a solution representing intermediate and sequestered conditions.  \n3.1 Initializing the Model  \nTo initialize the RT3D model:  \n1. In the Project  Explorer,  right-click on the \u201c  grid\u201d item and  select the New \nMT3DMS  command to open th e Basic Transport Package dialog.  \n3.2 The Basic Transport Package  \nFirst, define the data for the Basic Transport package:  \n1. In the Model  section, select RT3D . \nPackages  \nNext to select which packages to use:  \n1. Select Packages  to open the MT3DMS/RT3D Packages dialog.  \n2. Turn on the following packages:  \n\uf0b7 Advection package  \n\uf0b7 Dispersion package  \n\uf0b7 Source/sink mixing package  \n\uf0b7 Chemical reaction package  \n3. In the RT3D Reactions  drop-down menu, select the reaction titled \u201c Rate -Limited \nSorption Reactions \u201d. \n4. Select OK to exit the MT3DMS/RT3D  Packages  dialog.  \n\nGMS Tutorials   RT3D \u2013 Rate -Limited Sorption Reaction  \n \n Page 10 of 15 \u00a9 Aquaveo 2024  Stress Periods  \nNext to define a single stress period with a length of 3000 days.  \n1. Select Stress Periods  to open the Stress Periods dialog.  \n2. Change the Length  value to \u201c 3000.0 \u201d. \n3. Select OK to close the Stress Periods  dialog.  \nOutput Control  \nBy default, RT3D outputs a solution at every transport step. Change this so that a \nsolution is output every 200 days.  \n1. Select Output Control  to open the Output Control  dialog.  \n2. Select the Print or save at specified times  option.  \n3. Select Times  to open the Variab le Time Steps  dialog.  \n4. Select the Initialize Values  button to open the Initialize Time Steps  dialog.  \n5. Enter \u201c 200.0 \u201d for the Initial time step size . \n6. Enter \u201c 200.0 \u201d for the Maximum time step size . \n7. Enter \u201c 3000.0 \u201d for the Maximum simulation time . \n8. Select OK to exi t the Initialize Time Steps  dialog.  \n9. Select OK to exit the Variable Time Steps  dialog.  \n10. Select OK to exit the Output Control  dialog.  \nPorosity  \nNext, consider the porosity, which should be set as 0.3. Since this is the default supplied \nby GMS, no changes need to be made.  \nStarting Concentrations  \nA starting concentration must be defined for both the aqueous phase concentration and \nthe solid phase concentration. The default starting concentrations are zero. It is \nnecessary to change the starting concentrations at the plume location. While this can be \naccomplished with the Starting Concentration  dialog, it is more convenient to select the \ncells and directly assign the values.  \n1. Select OK to exit the Basic Transport Package  dialog.  \n2. Using the Select Cell   tool, drag a box that just encloses the red rectangle \ndefining the spill location.  \nBefore assigning the values, unselect the cells in the four corners of the grid. This will \ngive the plume a slightly more rounded shape.  \n3. While holding down the Ctrl key, select each of the cells in the four corners of the \nspill location to unselect them.  \n\nGMS Tutorials   RT3D \u2013 Rate -Limited Sorption Reaction  \n \n Page 11 of 15 \u00a9 Aquaveo 2024   \nFigure 5 Cells where starting concentration will be assigned  \n4. Select the RT3D | Cell Properties  command to open the 3D Grid Cell Properties  \ndialog.  \n5. Enter a value of \u201c 300\u201d for the starting concentration in the Aqueous conc.  column.  \n6. Enter a value of \u201c 3e-5\u201d for the starting concentration in the Solid conc. column.  \n7. Select OK to close the 3D Grid Cell Properties  dialog.  \n8. Click anywhere outside the grid to unselect the cells.  \nThis completes the input for the Basic Transport package.  \n3.3 The Advection Package  \nNext to define the input data for the Advection package.  \n1. Select the RT3D  | Advection Package  command to open the Advection \nPackage  dialog.  \n2. For the Solution scheme  drop-down menu, select the \u201c Modified method of \ncharacteristics (MMOC) \u201d. \n3. Select Particles  to open the Particles dialog.  \n4. At the top of the dialog, change the Max. number of cells any particle will be \nallowed to move per transport step (PERCEL)  value to \u201c 2\u201d. \n5. Select OK to exit the Particles dialog.  \n6. Select OK to exit the Advection Package  dialog.  \n3.4 The Dispersion Package  \nNext to enter the data for the Dispersion package.  \n1. Select the RT3D  | Dispersion Package  command to open the Dispersion \nPackage  dialog.  \n2. Enter a value of \u201c 0.1\u201d for the TRPT value.  \n3. Select Longitudinal Dispersivity  to open the Longitudinal Dispersivity dialog.  \n\nGMS Tutorials   RT3D \u2013 Rate -Limited Sorption Reaction  \n \n Page 12 of 15 \u00a9 Aquaveo 2024  4. Select Constant \uf0d2 Layer  to open the Layer Value dialog.  \n5. Enter a value of \u201c 3.0\u201d. \n6. Select OK to exit the Layer Value  dialog.  \n7. Select OK to exit the Longitudinal Dispersivity dialog.  \n8. Select OK to exit the Dispersion Package  dialog.  \n3.5 The Source/Sink Mixing Package  \nFor the Source/Sink Mixing package, assign a zero concentration to the incoming fluid \nfrom the injection wells.   \n1. Using t he Select Cell   tool and holding the Ctrl key, select each of the three \ninjection wells (the wells on the left).  \n2. Right -click on a selected cell and select the Sources/Sinks  menu command to \nopen the MODFLOW/RT3D Sources/Sinks dialog.  \n3. On the left side of th e dialog, select the RT3D: Point SS  item.  \n4. Now click the Add BC  button near the bottom of the dialog.  \n5. Change the Type (ITYPE)  to \u201cwell (WEL) \u201d. \n6. Make sure that the concentration is \u201c 0\u201d. \n \nFigure 6 Point Source/Sink BC dialog  \n7. Select OK to exit the MODFLOW/RT3D Sources/Sinks dialog.  \n8. Click anywhere outside the grid to unselect the cells.  \n3.6 The Reaction Package  \nThe last step in setting up the transport model is to enter the data for the Reaction \npackage.  \n1. Select the RT3D | Chemical Reaction P ackage  command to open the RT3D \nChemical Reaction Package dialog.  \n2. For the Bulk Density  enter a value of \u201c 1.5e6 \u201d. \n3. In the Reaction Parameters  section, enter a value of \u201c 0.1\u201d for mass transfer coeff . \n\nGMS Tutorials   RT3D \u2013 Rate -Limited Sorption Reaction  \n \n Page 13 of 15 \u00a9 Aquaveo 2024  4. Enter a value of \u201c 1e-7\u201d for the partitioning coeff . \n5. Select OK to exit the RT3D Chemical Reaction Package dialog.  \n3.7 Saving and Running the Simulation  \nAt this point, it is time to save the model and run RT3D.  \n1. Select the File |  Save  command.  \nTo run RT3D:  \n2. Select the RT3D  | Run RT3D  command to launch the RT3D  simulatio n. \n3. When the RT3D simulation is finished, select Close . \n3.8 Viewing the Solution  \nFirst to view the solid phase concentration solution at 600 days:  \n1. Expand the \u201c  rlimsorp (RT3D) \u201d solution in the Project Explorer . \n2. Select the \u201c  Solid conc \u201d dataset to make it acti ve. \n3. Select the \u201c 600.0\u201d time step from the Time Step  window.  \nTo better illustrate the variations, turn on the color ramp.  \n4. Select the Contour Options   macro to open the Dataset Contour Options \u2013 \n3D Grid \u2013 Solid conc  dialog.  \n5. Change the Contour method  to \u201cColor Fill \u201d. \n6. Select OK to exit the Dataset Contour Options \u2013 3D Grid \u2013 Solid conc  dialog.  \n7. Turn off  Annotation Data . \nNext to view the aqueous phase concentration solution at 600 days.  \n8. Select the \u201c  Aqueous conc \u201d dataset from the Project Explorer . \nNotice t hat, although the magnitudes of the concentration values are different, the spatial \ndistribution of the plume is identical for the solid and aqueous phase.   \n \nFigure 7      Solid conc solution at 600 days  \n\nGMS Tutorials   RT3D \u2013 Rate -Limited Sorption Reaction  \n \n Page 14 of 15 \u00a9 Aquaveo 2024  4 Comparison to Other Solutions  \nNext to compare the initial solution to other solutions with different mass transfer \ncoefficients. To save time, these solutions have already been computed. Simply import \nthem into GMS.  \n4.1 Importing the Solutions  \nAlthough the solutions were original ly created as separate solutions, the solutions have \nbeen combined into a single solution set for convenience.  \n1. Select the RT3D  | Read Solution  command to bring up the Open  dialog.  \n2. Go to the Tutorials \\RT3D \\rlimsorp  directory.  \n3. Select the file entitled \u201c other sol.rts \u201d. \n4. Select Open  to import the solution file.  \nThe solution just imported contains the following datasets:  \nName  Description  \nAqueous (mt3d)  Solution from an MT3DMS simulation  \nSolid (interm)  Solution from an RT3D simulation with the mass transfer coeff . = 0.002. \nThis represents an intermediate condition between the retardation \ncondition and the sequestered condition.  \nSolid (sequest)  Solution from an RT3D simulation with the mass transfer coeff. = 0.0001. \nThis represents the sequestered condition.  \n4.2 MT3D MS Solution  \nFirst to examine the MT3DMS simulation. The solution that has been computed has a \nlarge mass transfer rate and simulates retardation conditions. Therefore, it should be very \nsimilar to a solution computed using MT3DMS. To confirm this, do the f ollowing:  \n1. Select \u201c  Aqueous (mt3d) \u201d from the Project Explorer . \n2. Select Options  in the Time Step  window to open the Time Settings  dialog.  \n3. Change Relative  to be \u201cdays(decimal)\u201d.  \n4. Click OK to close the Time Settings   dialog.  \n5. Using the Time Step  window, select the time step at t = 600 days.  \nNote that the spatial distribution of the plume appears to be identical to the plume \ncomputed earlier by RT3D; however, the concentration is much lower.  \n\nGMS Tutorials   RT3D \u2013 Rate -Limited Sorption Reaction  \n \n Page 15 of 15 \u00a9 Aquaveo 2024   \nFigure 8      Aqueous (mt3d) solution  at 600 days  \n4.3 Comparing the Solid Phase Concentrations  \nNext to look at the solid phase concentrations and analyze the effect of the mass transfer \ncoefficients.  \n1. If necessary, expand the \u201c  rlimsorp (RT3D)\u201d  solution in the Project Explorer . \n2. Select the \u201c  Solid conc \u201d dataset and use the arrow keys to scroll through the \ntime steps.  \nNotice that after 600 days the bulk of the sorbed plume has moved over to the vicinity of \nthe extraction wells.  \nNext, look at the intermediate solution. This solution was computed usi ng a mass transfer \ncoefficient of 0.002. This is partway between the retarded condition and the sequestered \ncondition.  \n3. Using the Project Explorer , expand the \u201c  othersol (RT3D) \u201d solution.  \n4. Select the  \u201c Solid (interm) \u201d dataset and use the arrow keys to scroll through \nthe time steps.  \nNotice that some of the sorbed plume has moved toward the extraction wells but much of \nthe plume is still in the original location.  \nNext, examine the sequestered solution. This solution was computed using a mass \ntransfer coef ficient of 0.0001.  \n5. Using the Project Explorer , select the \u201c  Solid (Sequest) \u201d dataset and use the \narrow keys to scroll through the time steps.  \nNotice that the sorbed contaminants are still in the original location.  \n5 Conclusion  \nThis concludes the \u201cRT3D \u2013 Rate-Limited Sorption Reaction\u201d tutorial. Continue to explore \nthe RT3D model or exit the program.  \n\n", "filename": "RT3D-Rate-LimitedSorptionReaction.pdf", "pages": 15}, "RT3D-SequentialAnaerobicDegradation": {"text": "GMS Tutorials   RT3D \u2013 Sequential Anaerobic Degradation  \n Page 1 of 9 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nRT3D \u2013 Sequential Anaerobic Degradation: PCE \uf0d2 TCE \uf0d2 \nDCE \uf0d2 VC \nUse RT3D  to model  sequential anaerobic degradation  \nObjectives   \nThis tutorial illustrates the steps involved in modeling sequential anaerobic degradation of \ntetrachloroethene (PCE) using the RT3D model . \n. \n \nPrerequisite Tutorials  \n\uf0b7 RT3D \u2013 Instantaneous \nAerobic Degradation  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Model & \nInterface  \n\uf0b7 RT3D  Model & Interface  Time  \n\uf0b7 10\u201325 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   RT3D \u2013 Sequential Anaerobic Degradation  \n Page 2 of 9 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Description of Problem  ................................ ................................ ................................ . 2 \n1.2 Description of Reaction  ................................ ................................ ................................ . 2 \n1.3 Getting Started  ................................ ................................ ................................ ..............  3 \n2 Importing the MODFLOW Model ................................ ................................ .........................  3 \n3 Building the Transport Model  ................................ ................................ .............................  4 \n4 Initializing the Model  ................................ ................................ ................................ ...........  4 \n5 The Basic Transport Package  ................................ ................................ ............................  4 \n5.1 Starting Concentrations  ................................ ................................ ................................  5 \n5.2 Porosity  ................................ ................................ ................................ .........................  5 \n5.3 Stress Perio ds ................................ ................................ ................................ ..............  5 \n5.4 Output Options  ................................ ................................ ................................ ..............  5 \n6 The Advection Package  ................................ ................................ ................................ ...... 6 \n7 The Dispersion Package  ................................ ................................ ................................ ..... 6 \n8 The Source/Sink Mixing Package  ................................ ................................ .......................  6 \n9 The Chemical Reaction Package  ................................ ................................ ........................  6 \n10 Run MODFLOW  ................................ ................................ ................................ ....................  7 \n11 Running RT3D  ................................ ................................ ................................ ......................  7 \n12 Viewing the Results  ................................ ................................ ................................ .............  7 \n12.1  Creating a Time Series Plot  ................................ ................................ ..........................  8 \n12.2  Other Post -Processing Options  ................................ ................................ ....................  9 \n13 Conclusion  ................................ ................................ ................................ ...........................  9 \n \n1 Introduction  \nThis tutorial will use the problem described below. It will start with importing a MODFLOW \nmodel. Then the RT3D inputs and boundary conditions will be defined followed by \nrunning simulations for both MODFLOW and RT3D. Finally, a time series plot will be \ncreated to review the results.  \n1.1 Description of Problem  \nThe problem in this tutorial is similar to the problem described in the \u201c RT3D \u2013 \nInstantaneous Aerobic Degradation \u201d tutorial. The site is a 510 m x 310 m section of a \nconfined aquifer with a flow gradient from left to right. An underground storage tank is \nleaking fuel hydrocarbon contaminants at 2 m3/day at the location shown. Concentration \nof tetrachloroethene (PCE) is 1000 mg/L. This high hypothetical concentration was \nselected to simulate a plume with considerable PCE mass and with a relatively low \ninjection flow rate. Initial levels of PCE and its degradation products in the aquifer are \nassumed to be 0.0 mg/L. The tutorial will simulate a continuous spill event and compute \nthe resulting PCE, trichloroethene (TCE), dichloroethene (DCE), and vinyl chloride (VC) \ncontours after two years.  \nThe first part of the problem will be to import a previously computed MODFLOW flow  \nmodel of the site. Using this flow field, RT3D will then define a reactive transport model.  \n1.2 Description of Reaction  \nThe reaction being simulated is anaerobic PCE dechlorination with sequential, first -order, \ndegradation kinetics. Degradation of PCE all the  way to VC is assumed to be \nanaerobically favorable and the degradation kinetics are assumed to be first order in \nnature.  \nVC DCE TCE PCE \uf0ae\uf0ae\uf0ae\n ................................ ................................ .................  (1) \nThe following set of equations describes the reaction kinetics framework:  \nGMS Tutorials   RT3D \u2013 Sequential Anaerobic Degradation  \n \n Page 3 of 9 \u00a9 Aquaveo 2024  \n\uf05b\uf05dPCEk r1 PCE\uf02d\uf03d ................................ ................................ ................................ .... (2) \n\uf05b\uf05dTCEk]PCE[ Yk r2 PCE/ TCE1 TCE \uf02d \uf03d\n ................................ ................................ .........  (3) \n\uf05b\uf05d DCEk]TCE[ Yk r3 TCE/ DCE2 DCE \uf02d \uf03d\n ................................ ................................ ....... (4) \n\uf05b\uf05dVCk] DCE[ Yk r4 DCE/VC3 DCE \uf02d \uf03d\n ................................ ................................ ..........  (5) \nKinetic Constants (to be manually entered):  \nConstant  Value  Designation  \nk1 0.005 day-1 PCE anaerobic constant  \nk2 0.003 day-1 TCE anaerobic constant  \nk3 0.002 day-1 DCE anaerobic constant  \nk4 0.001 day-1 VC anaerobic constant  \nThe following constants (yields in mg/mg basis) are fixed internally:  \nConstant  Value  Designation  \nYTCE/PCE  0.7920  TCE:PCE stoichiometric yield  \nYDCE/TCE  0.7377  DCE:TCE stoichiometric yield  \nYVC/DCE  0.6445  VC:DCE stoichiometric yield  \n1.3 Getting Started  \nDo the following to get started:  \n1. If GMS is not running, launch GMS.  \n2. If GMS is already running, select the File | New command to ensure the program \nsettings are restored to the default state.  \n2 Importing th e MODFLOW Model  \nThe first part of the simulation is to import the MODFLOW flow model. A steady state flow \nmodel has been previously computed and is supplied with the tutorial files.  \n1. Select the File | Open  command to bring up the Open  dialog.  \n2. Navigate to flowmod \\flowmod . \n3. Select the file entitled \u201c flowmod.gpr \u201d. \n4. Click Open  to import the project file and exit the Open  dialog.  \nAt this point, a grid will appear.  \nGMS Tutorials   RT3D \u2013 Sequential Anaerobic Degradation  \n \n Page 4 of 9 \u00a9 Aquaveo 2024   \nFigure 1     The MODFLOW grid  \n3 Building the Transport Model  \nNow that the flow model is imported, the next step is to perform the RT3D simulation. For \nthis part of the simulation, select the reaction, define the reaction data, define the \nsupplemental layer data needed by RT3D, and assign concentrations to the well.  \n4 Initializing the Model  \nThe first step is to initialize the RT3D data.  \n1. In the Project Explorer , expand the \u201c  3D Grid Data \u201d folder . \n2. Right -click on the \u201c  grid\u201d item.  \n3. Select the New MT3D MS\u2026  command from the pop -up menu to open the Basic \nTransport Package  dialog.  \n5 The Basi c Transport  Package  \nThe next step is to initialize the data in the Basic Transport Package. First, it is necessary \nto select RT3D as the transport model and to select the appropriate packages.  \n1. In the Model  section, select the RT3D  option.  \n2. Select Packages \u2026 to open the MT3DMS/RT3D Packages dialog.  \n3. Turn on the following packages:  \n\uf0b7 Advection package  \n\uf0b7 Dispersion package  \n\uf0b7 Source/ sink mixing package  \n\uf0b7 Chemical reaction p ackage  \n\nGMS Tutorials   RT3D \u2013 Sequential Anaerobic Degradation  \n \n Page 5 of 9 \u00a9 Aquaveo 2024  4. For the RT3D reactions  drop-down menu, select the \u201c Sequential Decay \nReactions \u201d option.  \n5. Select OK to exit the MT3DMS/RT3D Packages  dialog.  \n5.1 Starting Concentrations  \nNote that in the Layer Data  section of the dialog, the species associated with the reaction \nbeing modeled are listed by name. The next step is to define the starting concentration \nfor each of these species. By default, all of the starting concentrations are zero. Since the \naquifer is assumed to be initially clean, accept the default values for starting \nconcentrations.  \n5.2 Porosity  \nNext, consider the porosity, which should be set as 0.3. Since this is the default supplied \nby GMS, no changes need to be made.  \n5.3 Stress Periods  \nThe next step is to define the stress periods. Since the injection rate of the well and the \nother boundary conditions do not change, a single stress period will be used.  \n1. Select Stress Periods\u2026  to open the Stress Periods dialog.  \n2. Enter a value of \u201c 730\u201d for the Length . \n3. Enter a value of \u201c 10\u201d for the Num time steps . \n4. Select OK to exit the Stress Periods  dialog.  \n5.4 Output Options  \nThe next step is to define the output options. One bi nary solution file is created by RT3D \nfor each of the species. By default, RT3D saves a solution at each transport step for each \nspecies. Since this results in large files containing more solutions than needed for the \nsimple post -processing, it would be be tter to specify that a solution be saved every 73 \ndays (every time step).  \n1. Select Output Control\u2026  to open the Output Control dialog.  \n2. Select the Print or save at specified times  button.  \n3. Select Times \u2026 to open the Variable Time Steps  dialog.  \n4. Select Initialize Values \u2026 to open the Initialize Time Steps  dialog.  \n5. Enter \u201c 73.0\u201d for the Initial time step size . \n6. Enter \u201c 73.0\u201d for the Maximum time step size . \n7. Enter \u201c 730.0 \u201d for the Maximum simulation time . \n8. Select OK to exit the Initialize Time Steps  dialog  \n9. Select OK to exit the Variable Time Steps  dialog.  \n10. Select OK to exit the Output Control  dialog.  \nThis completes the input for the Basic Transport package.  \n11. Select OK to exit the Basic Transport Package  dialog.  \nGMS Tutorials   RT3D \u2013 Sequential Anaerobic Degradation  \n \n Page 6 of 9 \u00a9 Aquaveo 2024  6 The Advection Package  \nThe next step is to initialize the d ata for the Advection package.  \n1. Select the RT3D | Advection Package\u2026  command to open the Advection \nPackage  dialog.  \n2. In the Solution scheme drop-down menu, select \u201c Standard finite difference \nmethod \u201d. \n3. Select OK to close the Advection Package  dialog.  \n7 The Disper sion Package  \nThe next step is to enter the data for the Dispersion package. The aquifer has a \nlongitudinal dispersivity of 10.0 m and a transverse (horizontal) dispersivity of 3.0 m. The \nvertical dispersivity is not used since this is a one layer model.  \n1. Select the RT3D  | Dispersion Package\u2026  command to open the Dispersion \nPackage  dialog.  \n2. Enter a value of \u201c 0.3\u201d for the TRPT  value.  \n3. Select the Longitudinal Dispersivity \u2026 button to open the Longitudinal \nDispersivity  dialog.  \n4. Select the Constant \uf0d2 Grid button to open the Grid Value dialog.  \n5. Enter a value of \u201c 10.0\u201d.  \n6. Select OK to exit the Grid Value  dialog.  \n7. Select OK to exit the Longitudinal Dispersivity  dialog.  \n8. Select OK to exit the Dispersion Package  dialog.  \n8 The Source/Sink Mixing Package  \nNext, to defin e the concentration at the spill location:  \n1. Using the Select Cells   tool, select the cell containing the injection well (spill \nlocation) by clicking anywhere in the interior of the cell.  \n2. Select the RT3D  | Point Sources/Sinks \u2026 command to open the \nMODFLOW/RT3D Source/Sinks  dialog.  \n3. Click the Add BC  button near the bottom of the dialog.  \n4. Change the Type (ITYPE)  to \u201cwell (WEL) \u201d. \n5. In the PCE column,  enter a concentration of \u201c 500\u201d (mg/L).   \n6. Select OK to exit the MODFLOW/RT3D Source/Sinks  dialog.  \n9 The Chemical Reaction Package  \nNext, to initialize the chemical reaction package and define appropriate reaction rate \nconstants:  \n\nGMS Tutorials   RT3D \u2013 Sequential Anaerobic Degradation  \n \n Page 7 of 9 \u00a9 Aquaveo 2024  1. Select the RT3D | Chemical Reaction Package\u2026  command to open the RT3D \nChemical Reaction Package dialog.  \n2. In the Reaction Parameters  section, change the Kpce value to \u201c 0.005 \u201d. \n3. Set the value of Ktce to \u201c0.003 \u201d. \n4. Set the value of Kdce to \u201c0.002 \u201d. \n5. Set the value of Kvc to \u201c0.001 \u201d. \n6. Select OK to exit the RT3D Chemical Reaction Package  dialog.  \n10 Run MODFLOW  \nBefore running RT3D, it is necessary to regenerate the MODFLOW solution.  \n1. Select the File | Save As\u2026  command to open the Save As  dialog.  \n2. Enter \u201c rtmod \u201d for the File name . \n3. Select Save  to save the files and exit the Save As  dialog.  \nTo run MODFLOW:  \n4. Select the MODFLOW  | Run MODFLOW  command to launch the MODFLOW  \nsimulation.  \n5. When the MODFLOW  simulation is finished, select Close to exit the MODFLOW  \ndialog.  \nThe MODFLOW solution is imported and displayed as contours on the grid.  \n11 Running RT3D  \nIt is now possible to save the model and run RT3D.  \nTo run RT3D:  \n1. Select the RT3D  | Run RT3D\u2026  command to launch the RT3D  simulation.  \n2. Select Yes at the prompt to save the changes.  \n3. When the RT3D  simulation is finished, select Close  to exit the RT3D  dialog.  \nGMS automatically reads in the RT3D solution.  \n12 Viewing the Results  \n1. Select the \u201c  PCE\u201d  dataset from the Project Explorer . (if needed, expand the \n\u201crtmod (RT3D) \u201d solution)  \n2. Select the \u201c 730.0 \u201d time step from the Time Steps  Window . \nTo view color -fill contours:  \n3. Select the Contour Options   macro to open the Dataset Contour Options \u2013 \n3D Grid \u2013 PCE dialog.  \n4. Change the Contour method  to \u201cColor Fill \u201d. \n5. Select OK to exit the Dataset Contour Options \u2013 3D Grid \u2013 PCE dialog.  \n\nGMS Tutorials   RT3D \u2013 Sequential Anaerobic Degradation  \n \n Page 8 of 9 \u00a9 Aquaveo 2024   \nFigure 2      The PCE solution at 730 days  \nNext, view the other solutions at 730 days.  \n6. Select the \u201c  TCE\u201d dataset from the Project Explorer . If necessary, select the \n730.0  time step from the Time Steps  Window . \n7. Select the \u201c  DCE \u201d dataset from the Project Explorer . \n8. Select the \u201c  VC\u201d dataset from the Project Explorer . \n12.1 Creating a Time Series Plot  \nAnother highly effective tool for viewing RT3D solutions is a time series plot. A time \nseries plot is used to display the variation of concentration vs. time for one or more \nspecies at a particular point in the model.  \n1. Select the Plot Wizard   macro to open the Plot Wizard . \n2. Select the Active Datas et Time Series  option.  \n3. Select Finish  to close the Plot Wizard  and open a plot window.  \n4. Use the Select Cell s  tool to select any cell in the grid downstream from the \ncontaminant source.  \n5. The plot now shows the variation of VC concentration vs. time at the specified \nlocation in the grid. To view the concentrations for any contaminant at a different \nlocation, change the active dataset in the Project Explorer  and the selected grid \ncell. \n\nGMS Tutorials   RT3D \u2013 Sequential Anaerobic Degradation  \n \n Page 9 of 9 \u00a9 Aquaveo 2024   \nFigure 3      Active dataset time series plot for the VC solution  \n12.2 Other Post -Processing Options  \nAt this point, feel free to experiment with the other post -processing options, including film \nloop animation s.  \n13 Conclusion  \nThis concludes the \u201cRT3D \u2013 Sequential Anaerobic Degradation\u201d tutorial. Continue to \nexplore the RT3D model or exit the program.  \n\n", "filename": "RT3D-SequentialAnaerobicDegradation.pdf", "pages": 9}, "SEAM3D-BTEX": {"text": "GMS Tutorials   SEAM3D \u2013 BTEX  \n Page 1 of 14 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nSEAM3D \u2013 BTEX  \nUsing SEAM3D with BTEX  \nObjectives   \nThis tutorial shows how to use the SEAM3D Biodegredation and NAPL Dissolution packages.  \n \nPrerequisite Tutorials  \n\uf0b7 MT3DMS \u2013 Grid Approach  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 SEAM3D  Time  \n\uf0b7 25\u201340 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   SEAM3D \u2013 BTEX  \n Page 2 of 14 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ............  2 \n1.1 Getting Started  ................................ ................................ ................................ . 3 \n2 Importin g the Flow Model  ................................ ................................ .....................  3 \n3 Defining the Units  ................................ ................................ ................................ .. 4 \n4 Initializing the SEAM3D Simulation  ................................ ................................ ..... 4 \n4.1 Setting up the Stress Periods  ................................ ................................ ..........  5 \n4.2 Package Selection  ................................ ................................ ...........................  5 \n4.3 Defining the Species  ................................ ................................ ........................  5 \n4.4 Output Control ................................ ................................ ................................ .. 6 \n4.5 Entering the Porosity  ................................ ................................ .......................  6 \n4.6 Starting Concentrations  ................................ ................................ ...................  6 \n5 Advection Package  ................................ ................................ ................................  7 \n6 Dispersion Package  ................................ ................................ ...............................  7 \n7 Source/Sink Mixing Package  ................................ ................................ ................  7 \n8 Chemical Reaction Package  ................................ ................................ .................  8 \n9 NAPL Dissolution Package  ................................ ................................ ...................  8 \n9.1 Selecting the Cells  ................................ ................................ ...........................  8 \n9.2 Assigning the Concentration  ................................ ................................ ............  9 \n9.3 Entering the NAPL Data  ................................ ................................ ..................  9 \n10 Biodegradation Package  ................................ ................................ .....................  10 \n10.1  Minimum Concentrations  ................................ ................................ ...............  10 \n10.2  Electron Acceptor Coefficients  ................................ ................................ ....... 10 \n10.3  Generation Coefficients  ................................ ................................ .................  11 \n10.4  Use Coefficients  ................................ ................................ .............................  11 \n10.5  Saturation Constants  ................................ ................................ .....................  11 \n10.6  Rates  ................................ ................................ ................................ ..............  12 \n10.7  Starting Concentrations  ................................ ................................ .................  12 \n11 Saving the Simulation  ................................ ................................ .........................  12 \n12 Running MODFLOW  ................................ ................................ ............................  13 \n13 Running SEAM3D  ................................ ................................ ................................  13 \n14 Setting  the Contouring Options  ................................ ................................ .........  13 \n15 Viewing the Concentration Contours  ................................ ................................  13 \n16 Generating a Time History Plot  ................................ ................................ ..........  14 \n16.1  Creating a Time Series Plot  ................................ ................................ ...........  14 \n17 Other Viewing Options  ................................ ................................ ........................  14 \n18 Conclusion  ................................ ................................ ................................ ...........  14 \n \n1 Introduction  \nSEAM3D is a reactive transport model used to simulate complex biodegradation \nproblems involving multiple substrates and multiple electron acceptors. It is based on the \nMT3DMS code. In addition to the regular MT3DMS modules, SEAM3D includes a \nBiodegration  package and NAPL Dissolution  package. This tutorial illustrates how to use \nboth of these packages to set up a reactive transport simulation.  \nThe problem in this tutorial is illustrated in Figure 1. The site represents a shallow \nunconfined aquifer with a uniform flow field from left to right. A NAPL plume is located on \nthe left side of the model. The NAPL plume contains two primary hydr ocarbons, benzene \nand toluene. The benzene and toluene are dissolving into the groundwater and are being \ntransported to the right.  \nSet up a SEAM3D simulation that models the transport and sequential degradation of the \ncontaminants via aerobic degradation a nd sulfate reduction over a 2000 -day period. The \nmodel will include dispersion and retardation due to sorption. The reactions will be \nmodeled using the Biodegradation  package. The gradual release of contaminants from \nGMS Tutorials   SEAM3D \u2013 BTEX  \n \n Page 3 of 14 \u00a9 Aquaveo 2024  the NAPL plume will be modeled as a sou rce term using the NAPL Dissolution package. \nFor comparison purposes, the model will include a conservative (no sorption) tracer and \na non -conservative tracer.  \n \nLNAPL Plume  \nGW Flow  Specified  \nHead  \nBoundary  \n \nH = 5 m \nBottom elevation = 0 m  \nK = 5 m/d  \nSimulation time = 3650 d 250 m 500 m \nSpecified  \nHead  \nBoundary  \n \nH = 4 m  \n \nFigure 1      Problem to be solved in SEAM3D  tutorial  \nThis tutorial will review i mport ing a MODFLOW model, defining  SEAM3D conditions, \nrunning MODFLOW and SEAM3D then finally creating  a time series plot.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If GMS is not open, launch GMS.  \n2. If GMS is alre ady open, select the File | New command to ensure the program \nsettings are restored to the default state.  \n2 Importing the Flow Model  \nThe first step in setting up the SEAM3D simulation is to import the MODFLOW flow \nmodel. A steady state flow model has been pr eviously computed and is supplied with the \ntutorial files.  \n1. Select the Open   button to bring up the Open  dialog.  \n2. Navigate to the BTEX \\BTEX  folder . \n3. Select the file entitled \u201c flowmod.gpr \u201d and click Open  to exit the Open  dialog.  \nAt this point, a grid should  appear with contours indicating a uniform flow field from the \nleft side to the right side ( Figure 2). \n\nGMS Tutorials   SEAM3D \u2013 BTEX  \n \n Page 4 of 14 \u00a9 Aquaveo 2024   \nFigure 2     Grid with uniform flow field \n3 Defining the Units  \nFirst it is necessary to define the units. The length and time units will already be set by \nthe MODFLOW model, so it is only necessary to specify the mass and concentration \nunits.  \n1. Select the Edit | Units\u2026  command to open the Units  dialog.  \n2. Make sure the following units are selected:  \nLength  ft \nTime  d \nMass  g \nForce  N \nConcentration  mg/l \n3. Select the OK button to exit the Units  dialog.  \nThe units entered here are for convenience only and do not affect the calculations. GMS \ndisplays these units next to the input fields as a reminder of the proper units for each \nitem. It is still necessary to enter consistent units.  \n4 Initializing the SEAM3D Simulation  \nTo create a new SEAM3D simulation:  \n1. Expand the \u201c  3D Grid Data\u201d folder.  \n2. Right -click on  the \u201c  grid\u201d item  in the Project Explorer.  \n3. Select the New MT3D MS\u2026  command to open the Basic Transport Package  \ndialog.  \n4. In the Model  section, select the SEAM3D  option.  \n\nGMS Tutorials   SEAM3D \u2013 BTEX  \n \n Page 5 of 14 \u00a9 Aquaveo 2024  4.1 Setting up the Stress Periods  \nThe next step is to set up the stress periods. Since none of the sources change over the \nsimulation, it is possible to use a single stress period with a single time step of 2000 \ndays. For the transport step size, use the default value of zero. This forces SEAM3D to \ncompute the appropriate transport step size auto matically.  \n1. Select the Stress Periods\u2026  button to open the Stress Periods dialog.  \n2. Change the Length  of the stress period to \u201c 3650 \u201d. \n3. Select the OK button to exit the Stress Periods  dialog.  \n4.2 Package Selection  \nNext, to select the packages for the simulation:  \n1. Select the Model Setup\u2026  button to open the MT3DMS/RT3D Packages dialog.  \n2. Make sure the following packages are selected:  \n\uf0b7 Advection package  \n\uf0b7 Dispersion package  \n\uf0b7 Source/ sink mixing package  \n\uf0b7 Chemical reaction package  \n\uf0b7 Biodegradation package  \n\uf0b7 NAPL dissolution package  \n3. Select the Next  button to open the Define Species dialog.  \n4.3 Defining the Species  \nNext, to define the species used in the simulation:  \n1. Change the Number of nondegradable tracers  to \u201c1\u201d. \n2. Change the Number of hydrocarbon substrates  to \u201c3\u201d. \n3. In the Microbial Processes  section, turn on the Fe(III) reduction  and \nMethanogenesis  options.  \n4. In the Products to track  section of the dialog, turn on the Fe(II) option.  \nNotice while making changes in the left side of the dialog, the species names are listed \non the right si de of the dialog. Some of these names are fixed, but some are user -\ndefined. Supply more meaningful names to the tracers and hydrocarbons:  \n5. In the Names  list, double -click the \u201ct racer s1\u201d item, and change the name to \n\u201cMTBE \u201d. \n6. Double -click the \u201cs ubstrate s1\u201d item, and change the name to \u201c Benzene \u201d. \n7. Double -click the \u201cs ubstrate s2\u201d item, and change the name to \u201c TEX\u201d. \n8. Double -click the \u201cs ubstrate s3\u201d item, and change the name to \u201c Aliphatics \u201d. \n9. Select the Finish  button to close the Define Species  dialog.  \nGMS Tutorials   SEAM3D \u2013 BTEX  \n \n Page 6 of 14 \u00a9 Aquaveo 2024  4.4 Output Control  \nNow to edit the Output Control  data to specify how frequently the solution data should be \nsaved for post -processing:  \n1. Select the Output Control\u2026  button to open the Output Control  dialog.  \n2. Select the Print or save at specified times  option.  \n3. Select the Times \u2026 button to open the Variable Time Steps  dialog.  \n4. Select the Initialize Values \u2026 button to open the Initialize Time Steps  dialog.  \n5. Enter \u201c 182.5 \u201d for the Initial time step size . \n6. Enter \u201c 182.5 \u201d for the Maximum time step size . \n7. Enter \u201c 3650 \u201d for the Maximum simulati on time . \n8. Select the OK button to exit the Initialize Time Steps  dialog.  \n9. Select the OK button to exit the Variable Time Steps  dialog.  \n10. Select the OK button to exit the Output Control  dialog.  \n4.5 Entering the Porosity  \nSEAM3D requires a porosity value for each cell in order to compute a correct seepage \nvelocity for transport. This tutorial will use a constant porosity for the entire grid. To enter \nthe porosity:  \n1. Select the Porosity\u2026  button to open the Porosity dialog.  \n2. Select the Constant \uf0d2 Grid button to open the  Grid Value dialog.  \n3. Enter a value of \u201c 0.25\u201d.  \n4. Select OK to close the Grid Value  dialog.  \n5. Select the OK button to exit the Porosity  dialog.  \n4.6 Starting Concentrations  \nThe mobile species are listed in the lower right corner of the Basic Transport Package  \ndialog.  It is necessary to define a set of starting concentrations for each of the species. \nThe default concentration is zero. This will be the correct starting concentration for the \nhydrocarbon substrates and the tracers. However, it\u2019s necessary to set the start ing \nconcentrations of the O2, SO4, and H2S to the correct background values.  \n1. Select O2 in the spreadsheet then enter a value of \u201c 3.0\u201d (mg/L) for the Starting \nConc.(mg/l) . \n2. Select Fe(II)  in the spreadsheet then enter a value of \u201c 0.002 \u201d (mg/L) for the \nStartin g Conc .(mg/l) . \nThis concludes the input for the Basic Transport package.  \n3. Select the OK button to exit the Basic Transport Package  dialog.  \nGMS Tutorials   SEAM3D \u2013 BTEX  \n \n Page 7 of 14 \u00a9 Aquaveo 2024  5 Advection Package  \nTypically, the next step at this point would be to enter the data for the Advection package. \nHowever, the default solution scheme ( Third Order TVD \u2013 ULTIMATE ) is adequate for \nthis problem, so no changes need to be made.  \n6 Dispersion Package  \nThe next step is to enter the data for the Dispersion  package. The aquifer has a \nlongitudinal dispersivity of 3 m and a transverse (horizontal) dispersivity of 0.15 m. The \nvertical dispersivity is assumed equal to the longitudinal dispersivity.  \n1. Select the SEAM3D  | Dispersion Package\u2026  command to open the Dispersion \nPackage dialog.  \n2. Select the Longitudinal Dispersivi ty\u2026 button to open the Longitudinal \nDispersivity  dialog.  \n3. Select the Constant \uf0d2 Grid button to open the Grid Value dialog.  \n4. Enter a value of \u201c 5.0\u201d. \n5. Select OK to close the Grid Value  dialog.  \n6. Select the OK button to exit the Longitudinal Dispersivity  dialog.  \n7. Enter a value of \u201c 0.1\u201d for the TRPT value.  \n8. Select the OK button to exit the Dispersion Package  dialog.  \n7 Source/Sink Mixing Package  \nThe next step is to enter the data for the Source/Sink Mixing  package. This package is \nused to establish the concentration of water entering the system. For this problem, water \nis entering the system on the left side of the model through the specified head boundary. \nIt is needful to enter the correct \u201cbackground\u201d concentrations for fresh water entering \nthrough this boundary.  \n1. Use the Select j   tool to select the leftmost column of cells.  \n2. Select the SEAM3D  | Point Sources/Sinks  command to open the \nMODFLOW/SEAM3D Sources/Sinks dialog.  \n3. Click the Add BC  button near the bottom of the dialog.  \n4. Change the Type (ITYPE)  to \u201cconstant head (CHD) \u201d in the All row; this will apply \nthe type to all the selected cells.  \nOnce again, the default value is zero. That is the correct value for most of the species.  \n5. In the O2 column,  enter a concentration of \u201c 3.0\u201d (mg/L)  in the All row.  \n6. In the Fe(II) column,  enter a concentration of \u201c 0.002 \u201d (mg/L)  in the All row.  \n7. Select the OK button to exit the MODFLOW/SEAM3D Sources/Sinks  dialog.  \n\nGMS Tutorials   SEAM3D \u2013 BTEX  \n \n Page 8 of 14 \u00a9 Aquaveo 2024  8 Chemical Reaction Package  \nThe next step is to enter the data for the Chemical Reaction  package. This package is \nthe standard  MT3DMS package that is used to simulate sorption and first order decay. \nThe biodegradation reactions are simulated in the Biodegradation  package that is unique \nto SEAM3D. This tutorial uses the Chemical Reaction  package to simulate retardation \ndue to sorp tion. \n1. Select the SEAM3D | Chemical Reaction Package\u2026  command to open the \nChemical Reaction Package dialog.  \n2. Select the \u201cLinear isotherm\u201d option in the Sorption  combo box.  \nThe default sorption constant is zero. This is the correct value for the Aliphatics an d for \nO2 and CH4. However, it is necessary to enter a non -zero value for Fe(II) and for the two \nsubstrates.  \n3. Enter \u201c1800000000.0\u201d for Bulk density .  \n4. Enter the following values for 1st sorption const . \nMTBE  3.36e -009 \nBenzene  3.36e -008 \nTEX 6.72e -008 \nAliphatics  1.34e -007 \n5. Select OK to exit the Chemical Reaction Package  dialog.  \n9 NAPL Dissolution Package  \nIt is now possible to enter the data for the NAPL Dissolution  package. This tutorial will \nsimulate the gradual dissolution of contaminants from a plume i nto the groundwater. In \nMT3DMS, such a situation could be simulated using constant concentration cells, \ninjection wells, or recharge. None of these options results in a realistic simulation of \ndissolution from a plume. The SEAM3D NAPL Dissolution  package p rovides a more \nrealistic representation of a contaminant plume. With this package, it is possible to \nidentify the cells containing the plume and enter the initial concentration and dissolution \nrate for the contaminants. It is also possible to enter the ini tial mass fraction and solubility \nof each species in the plume. SEAM3D then simulates the release of the each of the \nspecies over the duration of the simulation.  \n9.1 Selecting the Cells  \nThe first step is to select the cells where the plume is located.  \n1. Select the Select Cells   tool. \n2. Select the Grid | Find Cell \u2026 command to open the Find Grid Cell  dialog.  \n3. Enter \u201c 11\u201d for I, \u201c6\u201d for J, and \u201c1\u201d for K values.  \n4. Select OK to close the Find Grid Cell  dialog.  \n5. Drag a rectangle to select a 5x2 rectangular region of cells as shown in Figure 3. \nThe currently selected cell represents the cell in the upper left corner of the grid \nof cells.  \n\nGMS Tutorials   SEAM3D \u2013 BTEX  \n \n Page 9 of 14 \u00a9 Aquaveo 2024  \n  \nClick here  \nDrag to here   \nFigure 3  Selecting the cells defining the plume  \n9.2 Assigning the Concentration  \nNow that the plume cells are selected, the next step is to assign the concentrations to the \ncells.  \n1. Select the SEAM3D  | Point Sources/Sinks\u2026  command to open the \nMODFLOW/SEAM3D Sourc es/Sinks dialog.  \n2. Select the SEAM 3D: NAPL  in the left window.  \n3. Check the box in the NAPL  column in the All row. \n4. Enter a value of \u201c 0.001 \u201d for the Initial conc.(mg/l) for all cells . \n5. Enter a value of \u201c 0.5\u201d for the Rate dissolved (1/d ) for all cells . \n6. Select OK to exit the MODFLOW/SEAM3D Sources/Sinks dialog.  \n7. Click anywhere outside the grid to unselect the cells.  \n9.3 Entering the NAPL Data  \nThe next step is to enter the remaining NAPL plume data using the NAPL Dissolution \nPackage  dialog.  \n1. Select the SEAM3D | NAPL Dissol ution Package\u2026  command to open the \nNAPL Dissolution Package  dialog.  \n2. Change the Number of tracers in NAPL  value to \u201c 1\u201d. \n3. Change the Number of hydrocarbons in NAPL  value to \u201c3\u201d. \n4. At the bottom of the dialog, enter \u201c 150\u201d for the Inert fraction molecular weight . \n5. Enter the values shown in the table for all four species.  \n Initial Mass \nFraction  Solubility  Molecular \nWeight  \nMTBE  0.04 48.0 88.2 \nGMS Tutorials   SEAM3D \u2013 BTEX  \n \n Page 10 of 14 \u00a9 Aquaveo 2024  Benzene  0.01 1750.0  78.1 \nTEX 0.3 250.0  105.0  \nAliphatics  0.55 12.0 97.0 \n6. Select OK to exit the NAPL Dissolution Package  dialog.  \n10 Biodegradation Package  \nThe last package to set up is the Biodegradation  package. It is possible to enter the yield \ncoefficients, inhibition coefficients, and other reaction parameters controlling the \ndegradation of benzene and toluene.  \n1. Select the SEAM3D | Biodegradation Package\u2026  command  to open the \nBiodegradation Package dialog.  \n10.1 Minimum Concentrations  \nNotice that the input for the dialog is broken up into a series of property sheets.  \n1. Verify that the Min. Conc . tab is selected.  \n2. Enter \u201c2\u201d for Number  of bio steps per transport step . \n3. Enter \u201c0.001\u201d for Microcolony minimum concentration .  \n4. For the Minimum Concentration enter the values in the following table for each of \nthe species.  \nBenzene  0.002  \nTEX 0.005  \nAliphatics  0.1 \nO2 0.0 \nFe(III)  5.0 \n10.2 Electron Acceptor Coefficients  \nNext, to enter the electron acceptor data:  \n1. Select the Elec. Acc . tab in the dialog.  \n2. Enter the following values for Inhibition coefficient. \nFe(III) -O2 0.5 \nMethane -O2 0.2 \nMethane -Fe 25 \n3. Enter the following values for Yield coefficient . \nGMS Tutorials   SEAM3D \u2013 BTEX  \n \n Page 11 of 14 \u00a9 Aquaveo 2024  O2-Benzene  0.4 \nO2-TEX 0.5 \nO2-Aliphatics  0.2 \nFe(III) -Benzene  0.15 \nFe(III) -TEX 0.20 \nFe(III) -Aliphatics  0 \nMethane -Benzene  0.01 \nMethane -TEX 0.02 \nMethane -Aliphatics  0 \n \n10.3 Generation Coefficients  \nDo the following to enter the generation coefficient for H2S:  \n1. Select the Gen. Coeff.  tab. \n2. Enter \u201c 0.10\u201d in the Product coefficient value for Fe(II) . \n3. Enter the following values for the Methane coefficient : \n\uf0b7 Benzene :  \u201c0.77\u201d \n\uf0b7 TEX:  \u201c0.8\u201d \n\uf0b7 Aliphatics:  \u201c0.7\u201d \n10.4 Use Coefficients  \nDo the following to enter the electron acceptor use coefficients:  \n1. Select the Use Coeff.  tab in the dialog.  \n2. Enter the following values for the Electron acceptor use coefficient : \nO2-Benzene  3.1 \nO2-TEX 3.0 \nO2-Aliphatics  3.0 \nFe(III) -Benzene  41 \nFe(III) -TEX 42 \nFe(III) -Aliphatics  0 \n10.5 Saturation Constants  \nDo the following to enter the saturation constants:  \n1. Select the Sat. Const.  tab. \n2. Enter a value of \u201c 50\u201d for the Hydro. half saturation constant  for all species except \nthe following:  \n\uf0b7 O2-Benzene : \u201c15\u201d \n\uf0b7 O2-TEX: \u201c10\u201d \n\uf0b7 Fe(III) -TEX: \u201c30\u201d \nGMS Tutorials   SEAM3D \u2013 BTEX  \n \n Page 12 of 14 \u00a9 Aquaveo 2024  3. Under Electron acceptor half saturation Constant , enter \u201c 1\u201d for O2. \n10.6 Rates  \nDo as follows to enter the rate data:  \n1. Select the Rates  tab. \n2. Make sure that, in the Death rate  portion of the dialog, the Calculated by model  \noption is selected.  \n3. Enter the following values for the Max. specific rate of substrate utilization : \nO2-Benzene  0.4 \nO2-TEX 0.5 \nO2-Aliphatics  0.2 \nFe(III) -Benzene  0.001  \nFe(III) -TEX 0.02 \nFe(III) -Aliphatics  0 \nMethane -Benzene  0.002  \nMethane -TEX 0.01 \nMethane -Aliphatics  0.002  \n10.7 Starting Concentrations  \nAt this point, the only remaining data for the Biodegradation package are the starting \nconcentrations for the microcolonies and Fe(III). To enter the starting concentration data, \ndo the following:  \n1. Select the Start. Conc . tab.  \n2. For the Fe(III)  entry on the l ist, select the Edit\u2026 button to open the Starting \nConcentration Array dialog.  \n3. Select the Constant \uf0d2 Grid button to open the Grid Value dialog.  \n4. Enter a value of \u201c 50\u201d (mg/kg).  \n5. Select OK to close the Grid Value  dialog.  \n6. Select OK to close the Starting Concentration Array  dialog.  \n7. Repeat steps 2 \u20136 for the remaining species with the following grid values:  \nAerobes  0.25 \nFe(III)  Reducers  0.025  \nMethan ogens  0.025  \n8. Select the OK button to exit the Biodegradation Package  dialog.  \n11 Saving the Simulation  \nAt this point, it is possible to save the model and run SEAM3D.  \n1. Select the File | Save As  command to open the Save As  dialog.  \n2. Locate and open the directory entitled BTEX \\BTEX . \nGMS Tutorials   SEAM3D \u2013 BTEX  \n \n Page 13 of 14 \u00a9 Aquaveo 2024  3. Enter \u201c run1.gpr\u201d for the File name . \n4. Select the Save  button to save the files and exit the Save As  dialog.  \n12 Running MODFLOW  \nSEAM3D requires the HFF file generated by MODFLOW. Since the project is saved in a \ndifferent folder than the one where the MODFLOW simulation was opened, the HFF file \ndoes not exist in  the new location. It\u2019s necessary to rerun MODFLOW so that it will \nrecreate the HFF file in the current folder.  \nDo the following to run MODFLOW:  \n1. Select the MODFLOW  | Run MODFLOW  command to bring up the MODFLOW  \ndialog.  \n2. Select OK at the prompt if it appears.  \n3. When the simulation is finished, click the Close  button to exit the MODFLOW  \ndialog. The solution is imported automatically.  \n13 Running SEAM3D  \nTo run SEAM3D:  \n1. Select the SEAM3D  | Run SEAM3D\u2026  command to open the SEAM3D  dialog.  \n2. Select Yes at the prompt to save c hanges.  \n3. When the simulation is finished, hit the Close  button to exit the SEAM3D  dialog.  \n14 Setting the Contouring Options  \nNow to turn on color shaded contours and set up a color legend:  \n1. Select the Contour Options   button to open the Dataset Contour Options  \u2013 \n3D Grid \u2013 MTBE dialog.  \n2. Change the Contour method  to \u201cColor fill\u201d.  \n3. Make sure the Legend  option is turned on.  \n4. Select OK to close the Dataset Contour Options \u2013 3D Grid \u2013 MTBE dialog.  \n15 Viewing the Concentration Contours  \n1. Select the \u201c  MTBE \u201d dataset in the Project Explorer.  \n2. Select the last time step listed in the Project Explorer.  \nThis plot illustrates the concentration contours corresponding to no sorption and no \nreactions. This is a useful benchmark to consider when viewing the other datasets.  \nTo quickly sw itch between datasets, do as follows:  \n3. Click on the \u201c  MTBE \u201d dataset.  \nThis plot (non -conservative tracer) represents sorption but no reactions.  \n\nGMS Tutorials   SEAM3D \u2013 BTEX  \n \n Page 14 of 14 \u00a9 Aquaveo 2024  4. Use the down arrow key to view the other datasets.  \nWhile viewing the datasets, note the relationship between the substrates and the electron \nacceptors. If desired, use the Time Steps  list to view the solution at different time steps.  \n16 Generating a Time History Plot  \nA useful way to compare two transient solutions is to create an observation point and \ngenerate a time history plot. The fastest way to do this is to create an \u201cActive Dataset \nTime Series\u201d plot.  \n16.1 Creating a Time Series Plot  \n1. Click on the \u201c  O2\u201d dataset.  \n2. Select the Plot Wizard   button to open the  Plot Wizard  dialog.  \n3. Select the Active Da taset Time Series  option for the plot type.  \n4. Select the Finish  button to close the Plot Wizard  dialog and generate the plot.  \n5. Use the Select Cells   tool to select a cell in the grid near the contaminant \nsource. Notic e that the plot shows the concentration v. time.  \n6. Select a different cell and notice that the plot updates.  \nIf desiring to take the plot data and put it into Excel, right -click on the plot and select the \nview values option. This brings up a spreadsheet that  can be copied into Excel.  \n17 Other Viewing Options  \nAt this point, experiment with other viewing options if desired. For example, try setting up \nan animation using the Animate  command in the Display  menu.  \n18 Conclusion  \nThis concludes this tutorial. Continue to e xplore the SEAM3D options or exit the program.  \n \n \n\n", "filename": "SEAM3D-BTEX.pdf", "pages": 14}, "SEAM3D-ChlorinatedEthenes": {"text": "GMS Tutorials   SEAM3D \u2013 Chlorinated Ethenes  \n Page 1 of 15 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nSEAM3D \u2013 Chlorinated Ethenes  \nUsing SEAM3D with reductive dechlorination  \nObjectives   \nThis tutorial illustrates how to use the Biodegration , Reductive Dechlorination, and NAPL Dissolution  \npackages to set up a transport problem for simulating reductive dechlorination  under variable redox \nconditions along the groundwater flowpath.  \n \nPrerequisite Tutorials  \n\uf0b7 MT3DMS \u2013 Grid Approach  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW In terface  \n\uf0b7 SEAM3D  Time  \n\uf0b7 25\u201340 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   SEAM3D \u2013 Chlorinated Ethenes  \n Page 2 of 15 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ............  2 \n1.1 Getting Started  ................................ ................................ ................................ . 3 \n2 Importin g the Flow Model  ................................ ................................ .....................  3 \n3 Defining the Units  ................................ ................................ ................................ .. 4 \n4 Initializing the SEAM3D Simulation  ................................ ................................ ..... 4 \n4.1 Setting up the Stress Periods  ................................ ................................ ..........  5 \n4.2 Package Selection  ................................ ................................ ...........................  5 \n4.3 Defining the Species  ................................ ................................ ........................  5 \n4.4 Output Control ................................ ................................ ................................ .. 5 \n4.5 Entering the Porosity  ................................ ................................ .......................  6 \n4.6 Starting Concentrations  ................................ ................................ ...................  6 \n5 Advection Package  ................................ ................................ ................................  6 \n6 Dispersi on Package  ................................ ................................ ...............................  6 \n7 Source/Sink Mixing Package  ................................ ................................ ................  7 \n8 Chemical Reaction Package  ................................ ................................ .................  7 \n9 NAPL Dissolution Package  ................................ ................................ ...................  8 \n9.1 Selecting the Cells  ................................ ................................ ...........................  8 \n9.2 Assigning the Concentration  ................................ ................................ ............  8 \n9.3 Entering the NAPL Data  ................................ ................................ ..................  9 \n10 Biodegradation Package  ................................ ................................ .......................  9 \n10.1  Minimum Concentrations  ................................ ................................ .................  9 \n10.2  Electron Acceptor Coefficients  ................................ ................................ ....... 10 \n10.3  Generation Coefficients  ................................ ................................ .................  10 \n10.4  Use Coefficients  ................................ ................................ .............................  10 \n10.5  Saturation Constants  ................................ ................................ .....................  10 \n10.6 Rates  ................................ ................................ ................................ ..............  10 \n10.7  Starting Concentrations  ................................ ................................ .................  11 \n11 Reductive Dechlorination Package  ................................ ................................ .... 11 \n11.1  Minimum and Starting Concentrations  ................................ ..........................  11 \n11.2  Saturation Constants  ................................ ................................ .....................  12 \n11.3  Rates  ................................ ................................ ................................ ..............  12 \n11.4  Coefficients  ................................ ................................ ................................ .... 12 \n11.5  Reductive Dechlorination Factors  ................................ ................................ .. 13 \n12 Saving the Simulation  ................................ ................................ .........................  13 \n13 Running MODFLOW  ................................ ................................ ............................  13 \n14 Running  SEAM3D  ................................ ................................ ................................  13 \n15 Setting the Contouring Options  ................................ ................................ .........  14 \n16 Viewing the Concentration Contours  ................................ ................................  14 \n17 Generating a Time History Plot  ................................ ................................ ..........  14 \n17.1  Creating a Time Series Plot  ................................ ................................ ...........  14 \n18 Other Viewing Options  ................................ ................................ ........................  15 \n19 Conclusion  ................................ ................................ ................................ ...........  15 \n \n1 Introduction  \nSEAM3D also simulates the transport and attenuation of chlorinated ethenes in \ngroundwater systems in which either tetrachloroethene (PCE) or trichloroethene (TCE) \nare source compounds. Because the rate and extent of the biodegradation of chlorinated \nethenes is dependent on the redox condition, SEAM3D is ideally suited to simulate this \nproblem by combining the features  of the Biodegration  package with the Reductive \nDechlorination  package. The source compounds (PCE and/or TCE) serve as electron \nacceptors, and the daughter products of reductive dechlorination , cis-1,2-dichloroethene \n(cis-DCE) and vinyl chloride (VC), may serve as either electron acceptors or electron \ndonors. Source terms for chlorinated ethene problems may be implemented using the \nGMS Tutorials   SEAM3D \u2013 Chlorinated Ethenes  \n \n Page 3 of 15 \u00a9 Aquaveo 2024  SEAM3D NAPL Dissolution  package. This tutorial illustrates how to use these three \npackages to set up a transport problem for si mulating reductive dechlorination  under \nvariable redox conditions along the groundwater flowpath.  \nThe site in the sample problem represents a shallow unconfined aquifer with a uniform \nflow field from left to right. A NAPL plume is located on the left side of the model. The \nNAPL source is comprised of 15% TCE, 15% non -reactive tracer, 25% biodegradable \nsubstrate, and 45% inert substances. The tracer, substrate, and TCE are dissolving into \nthe ground water and are transported downgradient.  \nSet up a SEAM3D sim ulation to simulate TCE degradation in an aerobic aquifer. With the \nintroduction of the substrate, iron -reducing and methanogenic conditions will develop. \nThe model will include biodegradation, dispersion, and retardation due to sorption. The \nelectron acce ptors (oxygen and Fe(III)) and end products (Fe(II) and methane) will be \nmodeled using the Biodegradation  package. The gradual release of mass from the NAPL \nplume will be modeled as a source term using the NAPL Dissolution  package. The \ndegradation of TCE r esulting from reductive dechlorination  and the subsequent \ngeneration and biodegradation of cis -DCE and VC will be modeled using the Reductive \nDechlorination  package.  \n \nDNAPL Source  \nGW Flow  Specified  \nHead  \nBoundary  \n \nH = 8 m \nBottom elevation = 0 m  \nK = 2.5 m/d  \nSimulation period = 730 0 d 100 m 250 m \nSpecified  \nHead  \nBoundary  \n \nH = 7.9 m \n \nFigure 1 Problem to be solved in SEAM3D  tutorial  \n1.1 Getting Started  \nDo the following to get started:  \n1. If GMS is not open, launch GMS.  \n2. If GMS is already open, select the File | New command to ensure the program \nsettings are restored to the default state.  \n2 Importing the Flow Model  \nThe first step in setting up the SEAM3D simulation is to import the MODFLOW flow \nmodel. A steady state flow model has been previously computed and is supplied with the \ntutorial files.  \n1. Select the Open   button to bring up the Open  dialog.  \n\nGMS Tutorials   SEAM3D \u2013 Chlorinated Ethenes  \n \n Page 4 of 15 \u00a9 Aquaveo 2024  2. Find the directory  entitled Chlorinated_Ethenes \\Chlorinated_Ethenes . \n3. Select the file entitled \u201ctce -flowmod.gpr\u201d.  \n4. Click Open to import the project file and exit the Open  dialog.  \nAt this point, a grid should appear with contours indicating a uniform flow field from the \nleft side to th e right side.  \n \nFigure 2      Grid with uniform flow field  \n3 Defining the Units  \nThe first step is to define the units. The length and time units will already be set by the \nMODFLOW model, all that is needed is to specify the mass and concentration units.  \n1. Select the Edit | Units \u2026 command  to open the Units dialog . \n2. Ensure that the  following units  are selected : \nLength  ft \nTime  d \nMass  g \nForce  N \nConcentration  mg/l \n3. Select the OK button to exit the Units  dialog.  \nThe entered units are for convenience only and do not affect the calculations. GMS \ndisplays these units next to the input fields to remind us of the proper units for each item. \nIt is still necessary to enter consistent units.  \n4 Initializing the SEAM3D Simulation  \nDo the following to create a new SEAM3D simulation:  \n1. Expand the \u201c  3D Grid Data\u201d folder in the Project Explorer.  \n\nGMS Tutorials   SEAM3D \u2013 Chlorinated Ethenes  \n \n Page 5 of 15 \u00a9 Aquaveo 2024  2. Right -click on the \u201c  grid\u201d item  in the Project Explorer  and select the New \nMT3D MS\u2026  command to open the Basic Transport Package  dialog.  \n3. In the Model  section , selec t the SEAM3D  option.  \n4.1 Setting up the Stress Periods  \nThe next step is to set up the stress periods. Since none of the sources change over the \nsimulation, it is possible to use a single stress period with a length of 7300 days. For the \ntransport step size, 36 .5 days will be used. This forces SEAM3D to compute the \nappropriate transport step size automatically.  \n1. Select the Stress Periods\u2026  button  to open the Stress Periods dialog . \n2. Change the Length  of the stress period to \u201c7300 \u201d. \n3. Select the OK button to exit the Stress Periods  dialog.  \n4.2 Package Selection  \nNext, select the packages to use in the simulation:  \n1. Select the Model Setup\u2026  button to open  the MT3DMS/RT3D Packages  dialog.  \n2. Make sure the following packages are selected:  \n\uf0b7 Advection package  \n\uf0b7 Dispersion package  \n\uf0b7 Source/ sink mixing package  \n\uf0b7 Chemical reaction package  \n\uf0b7 Biodegradation package  \n\uf0b7 NAPL dissolution package  \n\uf0b7 Reductive dechlorination package  \n3. Select the Next  button  to open the Define Species dialog . \n4.3 Defining the Species  \nNext, define the species used in the simulation:  \n1. Set the Number of nondegradable tracers  to \u201c1\u201d. \n2. In the Microbial Processes  section of the dialog , turn on the Fe(III) reduction  and \nMethanogenesis  options.  \n3. In the Products to track  section of the dialog , turn on the Fe(II) option . \n4. Select the Finish  button  to exist the Define Species  dialog . \n4.4 Output Control  \nThe next step is to edit the Output Control  data to specify how frequently the solution \ndata should be saved for post -processing. This tutorial will save once every 182.5 days \nfor a total of 20 time steps  over each 3650 -day stress period.  \n1. Select the Output Control\u2026 button  to open the Output Control dialog . \n\nGMS Tutorials   SEAM3D \u2013 Chlorinated Ethenes  \n \n Page 6 of 15 \u00a9 Aquaveo 2024  2. Enter \u201c20\u201d for Print or save at specified interval . \n3. Select the OK button to exit the Output Control  dialog.  \n4.5 Entering the Porosity  \nSEAM3D requires a poro sity value for each cell in order to compute a correct seepage \nvelocity for transport. This tutorial will use a constant porosity for the entire grid. To enter \nthe porosity, do as follows:  \n1. Select the Porosity\u2026  button  to open the Porosity dialog . \n2. Select the  Constant \uf0d2 Grid button  to open the Grid Value dialog . \n3. Enter a value of  \u201c0.25\u201d.  \n4. Select OK to close the Grid Value  dialog.  \n5. Select the OK button to exit the Porosity  dialog . \n4.6 Starting Concentrations  \nThe mobile species are listed in the lower right corner of the Basic Transport Package  \ndialog. It is necessary to define a set of starting concentrations for each of the species. \nThe default concentration is zero. This will be the correct starting concentr ation for the \ntracer, substrate, chlorinated compounds, ethene, and methane. However, it\u2019s necessary \nto set the starting concentrations of the O2, Fe(II), and chloride to the correct background \nvalues.  \n1. Select O2 in the spreadsheet and e nter a value of \u201c4.0\u201d for the Starting Conc. \n(mg/l) .  \n2. Repeat this process to enter the following Starting Conc. (mg/l) : \n\uf0b7 Fe(II)  \u201c0.001 \u201d mg/L  \n\uf0b7 Chloride  \u201c0.2\u201d mg/L  \nThis concludes the input for the Basic Transport package.  \n3. Select  the OK button to exit the Basic Transport Package  dialog.  \n5 Advection Package  \nTypically, the next step at this point would be to enter the data for the Advection package. \nHowever, the default solution scheme ( Third Order TVD \u2013 ULTIMATE ) is adequate for \nthis problem, and no changes need to be made.  \n6 Dispersi on Package  \nThe next step is to enter the data for the Dispersion  package. The aquifer has a \nlongitudinal dispersivity of 5 feet and a transverse (horizontal) dispersivity of 0.50 feet. \nThe vertical dispersivity is assumed equal to the longitudinal dispersivity.  \n1. Select the SEAM3D | Dispersion Package\u2026  command  to open the Dispersion \nPackage  dialog . \n2. Select the Longitudinal Dispersivity \u2026 button  to open the Longitudinal \nDispersivity  dialog.  \nGMS Tutorials   SEAM3D \u2013 Chlorinated Ethenes  \n \n Page 7 of 15 \u00a9 Aquaveo 2024  3. Select the Constant \uf0d2 Grid button  to open the Grid Value dialog . \n4. Enter a value of \u201c5.0\u201d.  \n5. Select OK to close the Grid Value  dialog.  \n6. Select the OK button to exit the Longitudinal Dispersivity  dialog.  \n7. Ensure that  a value of \u201c0.10\u201d is entered for  the TRPT  value.  \n8. Select the OK button to exit the Dispersion Package  dialog.  \n7 Source/Sink Mixing Package  \nThe next step is to enter the data for the Source/Sink Mixing  package. This package is \nused to establish the concentration of water entering the system. For this problem, water \nis entering the system on the left side of the model through the specified head boundary. \nIt is necessary to enter the correct \u201cbackground\u201d concentrations for fresh water entering \nthrough this boundary.  \n1. Using  the Select j   tool, select the leftmost column of cells.  \n2. Select the SEAM3D  | Point Sources/Sinks  command to open the \nMODFLOW/SEAM3D Sources/Sinks dialog.  \n3. Click the Add BC  button near the  bottom of the dialog.  \n4. Change the Type (ITYPE)  to \u201cconstant head (CHD) \u201d in the All row. This will apply \nthe type to all the selected cells.  \nOnce again, the default value is zero. That is the correct value for most of the species. \nBut it is necessary to change the values for O2, Fe(II), and Chloride . \n5. In the O2 column,  enter a concentration of \u201c 4.0\u201d (mg/L)  in the All row.  \n6. In the Fe(II) column,  enter a concentration of \u201c 0.001 \u201d (mg/L)  in the All row.  \n7. In the Chloride  column,  enter a concentration of \u201c 0.2\u201d (mg/L)  in the All row.  \n8. Select the OK button to exit the MODFLOW/SEAM3D Sources/Sinks dialog.  \n8 Chemical Reaction Package  \nThe next step is to ent er the data for the Chemical Reaction  package. This package is \nthe standard MT3DMS package that is used to simulate sorption and first -order decay. \nThe biodegradation reactions are simulated in the Biodegradation  package that is unique \nto SEAM3D. Use the Chemical Reaction  package to simulate retardation due to sorption.  \n1. Select the SEAM3D | Chemical Reaction Package\u2026  command  to open the \nChemical Reaction Package  dialog . \n2. Select the \u201cLinear isotherm \u201d option in the Sorption  combo box.  \n3. Enter \u201c1850000.0\u201d for Bulk density .  \n4. Enter the values in the following table for the 1st sorption const . \n 1st sorption const.  \nTCE 3.1e-008 \nDCE  6.0e-009 \nVC 1.4e-009 \n\nGMS Tutorials   SEAM3D \u2013 Chlorinated Ethenes  \n \n Page 8 of 15 \u00a9 Aquaveo 2024  5. Select  OK to exit the Chemical Reaction Package  dialog.  \n9 NAPL Dissolution Package  \nIt is now possible to enter the data for the NAPL Dissolution  package. For this problem, \nsimulate the gradual dissolution of contaminants from a plume into the groundwater. In \nMT3DMS, such a situation could be simulated using constant concentration cells, \ninjection wells, or recharge. None of these options results in a realistic simulation of \ndissolution from a plume. The SEAM3D NAPL Dissolution  package provides a more \nrealistic representation of a contaminant plume. With this package, identify the cells \ncontaining the NAPL source and enter the initial concentration and dissolution rate. Also \nthe initial mass fraction and solubility of TCE will be entered. SEAM3D then simulates the \nrelease of the each of the species over the duration of the simulation.  \n9.1 Selec ting the Cells  \nThe first step is to select the cells where the plume is located.  \n1. Select the Select Cells   tool. \n2. Select the Grid | Find Cell \u2026 command to open the Find Grid Cell  dialog.  \n3. Enter \u201c9\u201d for I, \u201c5\u201d for J, and \u201c1\u201d for K. \n4. Select OK to close the Find Grid Cell  dialog.  \n5. Drag a rectangle to select a 2x4 rectangular region of cells as shown in  Figure 3. \nThe currently selected cell represents the cell in the upper lef t corner of the grid \nof cells.  \n  \nClick here  \nDrag to here  \n \nFigure 3     Selecting the cells defining the plume  \n9.2 Assigning the Concentration  \nWith the plume cells selected, the next step is to assign the concentrations to the cells.  \n\nGMS Tutorials   SEAM3D \u2013 Chlorinated Ethenes  \n \n Page 9 of 15 \u00a9 Aquaveo 2024  1. Select the SEAM3D | Point Sources/Sinks\u2026  command  to open the \nMODFLOW/SEAM3D Sources/Sinks dialog . \n2. Select SEAM3D: NAPL  in the left window.  \n3. Check the All row in the NAPL  column in the right window.  \n4. Enter a value of \u201c 0.1\u201d for the Initial conc.(mg/l)  for all cells. \n5. Enter a value of \u201c 1.0\u201d for the Rate dissolved  (1/d) for all cells . \n6. Select the OK button to exit the MODFLOW/SEAM3D Sources/Sinks dialog.  \n7. Click anywhere outside the grid to unselect the cells.  \n9.3 Entering the NAPL Data  \nThe next step is to enter the rema ining NAPL plume data using the NAPL Dissolution \nPackage  dialog.  \n1. Select the SEAM3D | NAPL Dissolution Package\u2026  command  to open the \nNAPL Dissolution Package  dialog . \n2. Enter \u201c1\u201d for Number of tracers in NAPL , Number of hydrocarbons in NAPL , and \nNumber of chlorinated solvents in NAPL . \n3. Enter the values in the following table . \n Initial Mass \nFraction  Solubility  Molecular \nWeight  \nTracers1  0.15 1100.0  131.5  \nSubstrate1  0.25 200.0  150.0  \nTCE 0.15 1100.0  131.5  \n4. Enter \u201c82.0\u201d for the Inert fraction molecular weight . \n5. Select OK to exit the NAPL Dissolution Package  dialog.  \n10 Biodegradation Package  \nThe next package to set up is the Biodegradation  package. It\u2019s necessary to enter the \nyield coefficients, inhibition coefficients, and other reaction parameters controlling the \ndegradation of the substrate.  \n1. Select the SEAM3D | Biodegradation Package\u2026  command  to open the \nBiodegradation Package dialog . \n10.1 Minimum Concentrations  \nNotice that the input for the dialog is broken up into a series of property sheets. This \ntutorial will first, enter the data for the Min. Conc . section. The default concentration is \nzero. This will be the correct starting concentrati on for O2 and Substrate1 . \n1. Select the Min. Conc.  tab. \n2. Enter \u201c2\u201d for the Number of bio steps per transport step . \n3. Enter \u201c0.001 \u201d for the Microcolony minimum concentration . \n4. Enter \u201c5.0\u201d for the Minimum Concentration of Fe(III).  \nGMS Tutorials   SEAM3D \u2013 Chlorinated Ethenes  \n \n Page 10 of 15 \u00a9 Aquaveo 2024  10.2 Electron Acceptor Coefficients  \nNext, to enter the Electron Acceptor data:  \n1. Select the Elec. Acc.  tab in the Biodegradation Package  dialog.  \n2. For the Inhibition coefficient , enter the following values:  \nFe-O2 0.1 \nMethane -O2 0.1 \nMethane -Fe 25 \n3. Enter the following values for the Yield coefficient : \nO2-Substrate1  0.1 \nFe(III) -Substrate1  0.02 \nMethane -Substrate1  0.01 \n10.3 Generation Coefficients  \nDo as follows to enter the Generation Coefficient for Fe(II)  and Methane : \n1. Select the Gen. Coeff.  tab. \n2. Enter \u201c0.10\u201d in the Product coefficient  value for Fe(II).  \n3. Enter \u201c0.7\u201d in the Methane coefficient  for Substrate1 . \n10.4 Use Coefficients  \nDo as follows to enter the electron acceptor Use Coefficients:  \n1. Select the Use Coeff.  tab. \n2. Enter the following values for the Electron acceptor use coefficient : \n\uf0b7 O2-Substrate1 : \u201c3.5\u201d \n\uf0b7 Fe(III) -Substrate1 : \u201c35\u201d \n10.5 Saturation Constants  \nTo enter the Saturation Constants:  \n1. Select the Sat. Const. tab. \n2. Enter the following values for the Hydro. half saturation constant : \n\uf0b7 O2-Substrate1 : \u201c10\u201d \n\uf0b7 Fe(III) -Substrate1 : \u201c25\u201d \n\uf0b7 Methane -Subst rate1 : \u201c50\u201d \n3. Enter  the following value  for the Electron acceptor half saturation Constant : \n\uf0b7 O2: \u201c1.0\u201d \n10.6 Rates  \nTo enter the Rate data:  \nGMS Tutorials   SEAM3D \u2013 Chlorinated Ethenes  \n \n Page 11 of 15 \u00a9 Aquaveo 2024  1. Select the Rates  tab. \n2. Make sure that , in the Death rate portion of the dialog , the Calculated by model  \noption is selected.  \n3. Enter the following values for the Max. specific rate of substrate utilization : \n\uf0b7 O2-Substrate1 : \u201c0.5\u201d \n\uf0b7 Fe(III) -Substrate1 : \u201c0.05\u201d \n\uf0b7 Methane -Substrate1 : \u201c0.01\u201d \n10.7 Starting Concentrations  \nAt this point, the only remaining data for the Biodegradation package are the  starting \nconcentrations for the microcolonies and Fe(III). To enter the Starting Concentration data, \ndo the following:  \n1. Select the Start. Conc.  tab. \n2. Select the Edit\u2026 button next to Fe(III)  to open the Starting Concentration Array \ndialog . \n3. Select the Constant \uf0d2 Grid button  to open the Grid Value dialog . \n4. Enter a value of \u201c50\u201d. \n5. Select the OK button  to close the Grid Value  dialog . \n6. Select the OK button to close the Starting Concentration Array dialog . \n7. Repeat steps 2 \u20136 with the following values.  \n\uf0b7 Aerobes : \u201c0.25\u201d \n\uf0b7 Fe(III) Reducers : \u201c0.025 \u201d \n\uf0b7 Methanogens : \u201c0.025 \u201d \n8. Select the OK button to exit the Biodegradation Package  dialog.  \n11 Reductive Dechlorination Package  \nThe last package to set up is the Reductive Dechlorination  package. It is necessary to \nenter the reaction p arameters controlling the degradation of chlorinated ethenes (TCE, \nDCE and VC) and production of end products (ethene and chloride).  \n1. Select the SEAM3D | Reductive Dechlorination Package\u2026  command  to open \nthe Reductive Dechlorination Package dialog . \n11.1 Minimum and Starting Concentrations  \nNotice that the input for the dialog is broken up into a series of property sheets. This \ntutorial will first enter the data for the minimum starting concentrations. The default \nconcentration is zero. This will be the correct min imum concentration for the chlorinated \ncompounds, ethane, and chloride.  \n1. Make sure the Concentrations  tab is selected . \n2. Enter \u201c0.001 \u201d for the Min. concentration for microbe populations . \nGMS Tutorials   SEAM3D \u2013 Chlorinated Ethenes  \n \n Page 12 of 15 \u00a9 Aquaveo 2024  3. Select the Edit\u2026 button next to PCE/TCE Reducers  in the Starting \nConcent ration  list to open the Starting Concentration Array dialog . \n4. Select the Constant \uf0d2 Grid button  to open the Grid Value dialog . \n5. Enter a value of \u201c0.25\u201d (mg/kg) . \n6. Select the OK button to close the Grid Values  dialog.  \n7. Select the OK button to exit the Starting C oncentration Array dialog.  \n8. Repeat steps 3 \u20137 for DCE/VC Reducers  with a value of  \u201c0.025 \u201d (mg/kg).  \n11.2 Saturation Constants  \nDirect oxidation will not be simulated in this problem. To enter the saturation constants for \nreductive dechlorination:  \n1. Select the Saturation Constants  tab. \n2. Enter the  following values for the Half Sat. Constant for Reductive \nDechlorination : \n\uf0b7 TCE: \u201c10\u201d \n\uf0b7 DCE : \u201c20\u201d \n\uf0b7 VC: \u201c15\u201d \n11.3 Rates  \nDo the following to enter the Rate data  for reductive dechlorination:  \n1. Select the Rates  tab. \n2. Make sure that , in the Death Rate  portion of the dialog , the Calculated by model  \noption is selected.  \n3. Enter the following values for the Max Specific Rate of Reductive Dechlorination : \n\uf0b7 TCE: \u201c0.1\u201d \n\uf0b7 DCE : \u201c0.05\u201d \n\uf0b7 VC: \u201c0.04\u201d \n11.4 Coefficients  \nThe default values for the electron acceptor use and methane generation coefficients are \nzero. These default values will be used, and no data entry is required for these two \nparameter sets.  \n1. Select the Coefficients  tab. \n2. Enter the following values for the Yield Coefficient : \n\uf0b7 TCE: \u201c0.02\u201d \n\uf0b7 DCE : \u201c0.01\u201d \n\uf0b7 VC: \u201c0.01\u201d \nGMS Tutorials   SEAM3D \u2013 Chlorinated Ethenes  \n \n Page 13 of 15 \u00a9 Aquaveo 2024  11.5 Reductive Dechlorination Factors  \nThe chlorinated ethane stoichiometric factors are preset. The last parameter to enter is \nthe chlorinated ethene data.  \n1. Select the Reductive Dechlorination Factors  tab. \n2. Enter the following values for Chlorinated Ethen e Inhibition  Terms : \nTCE-O2 0.1 \nTCE-Fe(III)  25 \nDCE -O2 0.1 \nDCE -Fe(III)  25 \nDCE -TCE 10 \nVC-O2 0.1 \nVC-Fe(III)  25 \nVC-TCE 10 \nVC-DCE  1 \n3. Select the OK button  to exit the Reductive Dechlorination Package  dialog.  \n12 Saving the Simulation  \nAt this point, it is possible to save the model and run SEAM3D.  \n1. Select the File | Save As\u2026  command to open the Save As  dialog.  \n2. Enter \u201cTCE-run1\u201d for the File name . \n3. Select  the Save  button to save the file  and exit the Save As  dialog.  \n13 Running MODFLOW  \nSEAM3D requires the HFF file  generated by MODFLOW. Since the project has been \nsaved in a different folder than the one where the MODFLOW simulation was opened \nfrom, the HFF file does not exist in the new location. It\u2019s necessary to rerun MODFLOW \nso that it will recreate the HFF file in the current folder.  \nDo the following to run MODFLOW:  \n1. Select the MODFLOW | Run MODFLOW  command  to open the MODFLOW  \ndialog.  \n2. When the simulation is finished, select the Close button  to exit the  MODFLOW  \ndialog. The solution is imported automatically.  \n14 Running SEAM3D  \nTo run SEAM3D:  \n1. Select the SEAM3D | Run SEAM3D\u2026  command.  \n2. Select Yes at the prompt  to save all changes and open the SEAM3D  dialog . \nGMS Tutorials   SEAM3D \u2013 Chlorinated Ethenes  \n \n Page 14 of 15 \u00a9 Aquaveo 2024  3. When  the simulation is fin ished, click  the Close  button  to exit the SEAM3D  \ndialog.  \n15 Setting the Contouring Option s \nNow to turn on color shaded contours and set up a color legend:  \n1. Select the Contour Options   button to open the Dataset Contour Options \u2013 \n3D Grid \u2013 Tracers1  dialog.  \n2. Change the Contour method  to \u201cColor Fill\u201d. \n3. Make sure  the Legend  option  is on . \n4. Select th e OK button to close the Dataset Contour Options \u2013 3D Grid \u2013 Tracers1  \ndialog.  \n16 Viewing the Concentration Contours  \n1. Expand the \u201c TCE-run1 (SEAM3D) \u201d folder in the Project Explorer . \n2. Select the \u201c Tracers1 \u201d dataset.  \n3. At the bottom of the Project Explorer , select t he time step at t= 7300  days . \nThis plot illustrates the concentration contours corresponding to no sorption and no \nreactions. This is a useful benchmark to consider when viewing the other datasets. To \nquickly switch between datasets, do the following:  \n4. Click  on the \u201c Tracers1 \u201d dataset.  \nThis plot (\u201c Tracers1 \u201d) represents sorption but no reactions.  \n5. Use the down  arrow key to view the other datasets.  \nWhile viewing the datasets, compare the travel distance of the tracer to TCE and the \nproduction of DCE, VC, ethane, and chloride as well as the consumption of electron \nacceptors and generation of Fe(II) and Methane. If desired, use the Time Steps  list to \nview the solution at the initial and final time step.  \n17 Generating a Time History Plot  \nA useful way to compare two transient solutions is to create an observation point and \ngenerate a time history plot. The fastest way to do this is to create an \u201cActive Datas et \nTime Series\u201d plot.  \n17.1 Creating a Time Series Plot  \n1. Select the Plot Wizard   button  to open the Plot Wizard  dialog.  \n2. Select the Active Datas et Time Series  option for the Plot Type . \n3. Select the Finish  button.  \n4. Using the Select Cell s  tool, select a cell in the grid near the contaminant \nsource. Notice that the plot shows the concentration v. time.  \n\nGMS Tutorials   SEAM3D \u2013 Chlorinated Ethenes  \n \n Page 15 of 15 \u00a9 Aquaveo 2024  5. Select  a different cell and notice that the plot updates.  \nIf wanting to take the plot data and put it into Excel, right -click on the plot and select the \nView V alues  option. This brings up a spreadsheet that can be copied into a spreadsheet \napplication . \n18 Other Viewing Options  \nAt this point, experiment with other viewing options if desired. For example, try setting up \nan animation using the Animate  command in the Display  menu. \n19 Conclusion  \nThis concludes the tutorial. Continue to explore the SEAM3D options or exit the program.  \n \n", "filename": "SEAM3D-ChlorinatedEthenes.pdf", "pages": 15}, "SEAWAT-ConcentrationAndTemperatureEffects": {"text": "GMS Tutorials   SEAWAT \u2013 Concentration and Temperature Effects  \n Page 1 of 7 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nSEAWAT  \u2013 Concentration and Temperature Effects  \nExamine Concentration and Temperature Impacts on Fluids Density \nwith SEAWAT  \nObjectives   \nThe tutorial demonstrates how to simulate the effects of concentration and temperature on fluid density \nwith SEAWAT . \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Grid \nApproach  \n\uf0b7 MT3DMS \u2013 Grid Approach  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 MT3D  \n\uf0b7 SEAWAT  Time  \n\uf0b7 15\u201325 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   SEAWAT \u2013 Concentration and Temperature Effects  \n Page 2 of 7 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ............  2 \n2 Getting Started  ................................ ................................ ................................ ....... 3 \n2.1 Importing the Existing Model  ................................ ................................ ...........  3 \n3 First SEAWAT Scenario  ................................ ................................ ........................  3 \n3.1 Initializing the SEAWAT Simulation  ................................ ................................ . 3 \n3.2 Saving the Model with a New Name and Running SEAWAT  ..........................  4 \n3.3 Viewing the Solution  ................................ ................................ ........................  4 \n4 Second SEAWAT Scenario  ................................ ................................ ...................  5 \n4.1 Saving the model with a new name  ................................ ................................ . 5 \n4.2 Adding Temperature Effects on Fluid Density  ................................ .................  5 \n4.3 Saving and running SEAWAT  ................................ ................................ ..........  6 \n4.4 Viewing the Solution  ................................ ................................ ........................  6 \n5 Conclusion  ................................ ................................ ................................ .............  7 \n \n1 Introduction  \nThis tu torial describes how to simulate the effects of concentration and temperature on \nfluid density using SEAWAT . This problem is shown in Figure 1. This problem has a \nconfined aquifer with an initial temperature of 5 \u02daC. Warm freshwater is injected from the \nwest side of the model at a 1 m3/day. The initial concentration of salt in the model is 35 \nkg/m3. This example problem is very similar to the problem described in the SEAWAT \ndocumentation.1  \nThis tutorial demonstrates and discusses:  \n\uf0b7 Importing an existing MODFLOW/MT3D simulation.  \n\uf0b7 Setting up a SEAWAT simulation.  \n\uf0b7 Running SEAWAT with d ifferent scenarios.  \n\uf0b7 Comparing SEAWAT results for density effects caused by concentration and \ntemperature.  \n \n      Figure 1      Site to be modeled with SEAWAT  \n                                                      \n1 Lange vin, Christian. D.; Thorne, Daniel T., Jr.; Dausman, Alyssa M.; Sukop, Michael C.; and Guo, \nWeixing. (2007). \u201cSEAWAT Version 4: A Computer Program for Simulation of Multi -Species Solute \nand Heat Transport\u201d in U.S. Geological Survey  Techniques and Methods B ook 6 , Chapter A22, 39 \np. https://pubs.usgs.gov/tm/tm6a22/pdf/tm6A22.pdf . \n\nGMS Tutorials   SEAWAT \u2013 Concentration and Temperature Effects  \n \n Page 3 of 7 \u00a9 Aquaveo 2024  2 Getting Started  \nDo the following to get started:  \n1. If GMS is not running, launch GMS.  \n2. If GMS is already running, select File | New to ensure the program settings are \nrestored to the default state.  \n2.1 Importing the Existing Model  \nStart with a model that has already been created.  \n1. Click  Open   to bring up the Open dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the Case_Studies  folder  and select \u201cstart.gpr\u201d.  \n4. Click Open  to import the project and exit the Open  dialog . \nA grid similar to Figure 2 should appear. Notice the symbols representing well and \nspecified head boundary conditions on the left and right sides of the model.  \n \n      Figure 2      Initial model  \n3 First SEAWAT Scenario  \n3.1 Initializing the SEAWAT Simulation  \nSEAWAT uses a combination of MODFLOW and MT3DMS.  Start with turning on the \nSEAWAT menu.  \n1. Fully expand the \u201c  3D Grid Data \u201d folder in the Project Explorer.  \n2. Right -click on \u201c  grid\u201d and select New SEAWAT \u2026 to bring up the Global \nOptions  dialog.  \n3. Turn on Include transport in simulation . \n\nGMS Tutorials   SEAWAT \u2013 Concentration and Temperature Effects  \n \n Page 4 of 7 \u00a9 Aquaveo 2024  4. In the Packages  section, turn on Variable -Density Flow (VDF) . \n5. Click OK to exit the Global Options  dialog.  \nModifying the VDF Package  \nThe first scenario will simulate the effect of s alinity on the fluid density.  \n1. Select SEAWAT | VDF Package\u2026  to open the SEAWAT VDF Package dialog.  \n2. In the Fluid density calculation  section, enter \u201c1\u201d in the Fluid density calc \n(MT3DRHOFLG)  field.  \nThis indicates that the fluid density calculation will be done using the salt species.  \n3. Enter \u201c1000.0\u201d in the Reference fluid density (DENSEREF)  field.  \nThis indicates that the reference fluid density (freshwater, in this case) at 25\u02daC is 1000 \nkg/m3. \n4. Enter \u201c0.7\u201d in the Density/conc. Slope (DRHODC) field.  \nThis DRHODC  value indicates that the density will vary linearly between 1000 kg/m3 for \nfreshwater and 1024.5 kg/m3 for saltwater. DRHODC can be estimated by dividing the \ndensity difference by the concentration difference. In this case, the result is the followi ng: \n1024.5(kg/m3)  \u2013 1000(kg/m3)  \n= 0.7  \n35(kg/m3) \u2013 0(kg/m3)  \nThis means that 35 kg/m3 is the concentration of salt in saltwater and 0 kg/m3 is the \nconcentration of salt in freshwater.  \n5. Click  OK to close the SEAWAT VDF Package  dialog . \n3.2 Saving the Model with  a New Name and Running SEAWAT  \nNow to save the changes and run SEAWAT:  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c case1 .gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n5. Click  Run SEAWAT   to bring up the SEAWAT  model wrapper dialog.  \n6. When SEAWAT finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n7. Click Close  to import the so lution and close the SEAWAT  model wrapper dialog.  \n3.3 Viewing the Solution  \nNow to view the results of the SEAWAT model run:  \n1. Select the \u201c  Salt\u201d dataset below the \u201c  case1 (MT3DMS) \u201d solution in the \nProject Explorer . \n\nGMS Tutorials   SEAWAT \u2013 Concentration and Temperature Effects  \n \n Page 5 of 7 \u00a9 Aquaveo 2024  The contour options will change because a display theme has been associated with the \nsalt species. To learn more about display themes, see the \u201cDisplay Themes\u201d tutorial.  \n2. Compare different time steps in the time step window by selecting various time \nsteps.  \nNotice the movement of the freshwater (the  light blue section). Select time step \u201c10\u201d (it \nhas a value of \u201c5000.0\u201d. The model should appear similar to the one in Figure 3. \n \n      Figure 3      Concentration of salt species at 5000 days \nThis simulation also includes a temperature species. The \u201c  Temperature \u201d dataset has \nno effect on the salinity in this scenario. The effect of temperature on the model is \nexamined in the next scenario.  \n4 Second SEAWAT Scenario  \n4.1 Saving the model with a new name  \nFirst, save the model with a new name:  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cc ase2 .gpr\u201d as the File name . \n4. Click Save to save the project under the new name and close the Save As  \ndialog.  \n4.2 Adding Temperature Effects on Fluid Density  \nNow, look at the effect of temperature on the density for this case.  \nModifying the VDF Package  \nThe temperature effects can be activated in the VDF Package . \n\nGMS Tutorials   SEAWAT \u2013 Concentration and Temperature Effects  \n \n Page 6 of 7 \u00a9 Aquaveo 2024  1. Select SEAWAT | VDF Package\u2026  to open the SEAWAT VDF Package dialog.  \n2. In the Fluid density calculation  section, enter \u201c -1\u201d for Fluid density calc. \n(MT3DRHOFLG) . \nThis value means that the fluid density will be calculated using one or more MT3DMS \nspecies. In this case, they are Salt and Temperature . \n3. Below the spreadsheet at the bottom, click Insert Row   twice to generate two \nspecies in the spreadsheet.  \n4. In the Speci es ID  column, enter \u201c 1\u201d in the top row and \u201c 2\u201d in the bottom row.  \nNotice that the species names have changed to \u201c Salt\u201d and \u201cTemperature \u201d, respectively . \n5. On the Salt row, enter \u201c 0.7\u201d in the DRHODC  column and \u201c 0.0\u201d in the CRHOREF  \ncolumn.  \n6. On the Temperature , enter \u201c -0.375 \u201d in the DRHODC  column and \u201c 25.0\u201d for \nCRHOREF  column.  \nThe negative value for DRHODC  means that the fluid density decreases as the \ntemperature increases. CRHOREF  is the reference (freshwater) \nconcentration/temperature for the species. The refere nce concentration of Salt in \nfreshwater is \u201c0.0\u201d and the reference Temperature  of freshwater is \u201c25.0\u201d.  \n7. Leave all other settings at their defaults, and click OK to exit the SEAWAT VDF \nPackage  dialog.  \n4.3 Saving and running SEAWAT  \nNow to save the changes and run SEAWAT:  \n1. Save   the project.  \n2. Select SEAWAT | Run SEAWAT \u2026 to bring up the SEAWAT  model wrapper \ndialog.  \n3. When SEAWAT finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and close the SEAWAT  dialog.  \n4.4 Viewing the Solution  \nNext to compare the differences between two scenarios:  \n1. View time step 16 (value of \u201c8000\u201d) in the \u201c  Salt\u201d dataset in \u201c  case1 \n(MT3DMS) \u201d (Figure 4). \n2. View the same dataset and time step in \u201c  case2 (MT3DMS) \u201d (Figure 5).  \nThe light blue portion in the figures represents fresh water and the dark red represents \nsalt water. In \u201c  case2 (MT3DMS) \u201d, notice that the salt water is slightly lower from the \ntop along the left boundary (by about one grid row) and slightly closer to the right \nboundary along the bottom of the model (by  about 10 grid columns). More of the fresh \nwater is \u201cfloating\u201d on top of the salt water in \u201c case2 \u201d because the fresh water is less \ndense. This is because SEAWAT is considering temperature in the density calculations.  \n\nGMS Tutorials   SEAWAT \u2013 Concentration and Temperature Effects  \n \n Page 7 of 7 \u00a9 Aquaveo 2024   \n      Figure 4      Salt concentration at time step 16 in case1  \n \n      Figure 5      Salt concentration at time step 16 in case2  \n5 Conclusion   \nThis concludes the \u201cSEAWAT \u2013 Concentration and Temperature Effects\u201d tutorial.  The \nfollowing key conc epts were discussed and demonstrated in this tutorial:  \n\uf0b7 SEAWAT combines MODFLOW and MT3DMS to solve variable density \ngroundwater flow and solute transport problems.  \n\uf0b7 SEAWAT simulates the effect of concentration and temperature on fluid density.   \n \n\n", "filename": "SEAWAT-ConcentrationAndTemperatureEffects.pdf", "pages": 7}, "SEAWAT-ConceptualModelApproach": {"text": "GMS Tutorials   SEAWAT \u2013 Conceptual Model Approach  \n Page 1 of 14 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nSEAWAT  \u2013 Conceptual Model Approach  \nCreate a SEAWAT model in GMS using the conceptual model \napproach  \nObjectives   \nThis tutorial demonstrates how to create a SEAWAT model in GMS using t he conceptual model \napproach . It will use  the GIS tools in the Map module to develop a conceptual model of the site being \nmodeled , including  sources/sinks, layer parameters (such as hydraulic conductivity ), model boundaries, \nand all other data necessary for the simulation. Finally it will generate a grid.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Conceptual \nModel Approach  \n\uf0b7 MT3DMS \u2013 Conceptual \nModel  Approach  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 MT3D  \n\uf0b7 SEAWAT  Time  \n\uf0b7 25\u201340 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   SEAWAT \u2013 Conceptual Model Approach  \n Page 2 of 14 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  4 \n2.1 Importing an Existing MODFLOW Model  ................................ ................................ ...... 4 \n2.2 Viewing the Initial Concentration  ................................ ................................ ...................  4 \n2.3 Saving the Project  ................................ ................................ ................................ .........  6 \n3 Setting Up the SEAWAT Simulation ................................ ................................ ...................  6 \n3.1 Editing the MODFLOW simulation  ................................ ................................ ................  6 \n3.2 Initializing MT3DMS  ................................ ................................ ................................ ...... 7 \n3.3 Initializing SEAWAT Simulation  ................................ ................................ ....................  8 \n3.4 Editing the Conceptual Model  ................................ ................................ .......................  9 \n3.5 Saving and Running SEAWAT  ................................ ................................ ...................  10 \n4 Viewing the Solution  ................................ ................................ ................................ .........  11 \n4.1 Creating an Animation  ................................ ................................ ................................  12 \n4.2 Creating a Time Series Plot of Concentration  ................................ .............................  12 \n4.3 Animating the Fresh -Water Surface  ................................ ................................ ............  13 \n5 Conclusion  ................................ ................................ ................................ .........................  14 \n5.1 Further Reading  ................................ ................................ ................................ ..........  14 \n \n1 Introduction  \nSEAWAT is described on  the official website as:  \n\u201c\u2026a generic MODFLOW/MT3DMS -based computer program designed \nto simulate three -dimensional variable -density groundwater flow coupled \nwith multi -species solute and heat transport. The program has been used \nfor a wide variety of groun dwater studies including those focused on \nbrine migration in continental aquifers as well as those focused on \nsaltwater intrusion in coastal aquifers. SEAWAT uses the familiar \nstructure of MODFLOW and MT3DMS. \u201d1  \nThis model is used to simulate the effect of  the pumping wells on salt water intrusion. The \ninitial heads and concentrations were created by running a SEAWAT model for a very \nlong time with a steady state flow model.  \nThe site in this model is a small coastal aquifer with three production wells with variable \npumping rates ( Figure 1). The no -flow boundary on the upper left corresponds to a \nparallel flow boundary , and the no -flow boundary on the left corresponds to  a thinning of \nthe aquifer due to a high bedrock elevation. A stream provides a specified head boundary \non the lower left . The remaining boundary is a coastal boundary simulated with a \nspecified head boundary condition.  \n                                                      \n1 SEAWAT: A Computer Program for Simulation of Three -Dimensional Variable -Density Ground -\nWater Flow and Transport . U.S. Geological Survey. October 7, 2015. \nhttp://water.usgs.gov/ogw/seawat/ . Accessed July 6, 2017.  (Archived by WebCite at \nhttp://www.webcitation.org/6ioGQwVBw ) \nGMS Tutorials   SEAWAT \u2013 Conceptual Model Approach  \n \n Page 3 of 14 \u00a9 Aquaveo 2024   \n      Figure 1      Site map of SEAWAT model  \nThe stratigraphy of the site  (Figure 2) consists  mainly  of an upper and lower aquifer. The \nupper aquifer  has a hydraulic conductivity of 1.5 m/day, and the lower aquifer h as a \nhydraulic conductivity of 5.0  m/day. The model also has some areas with confining units. \nThe production wells extend to the lower aquifer.  \n \n      Figure 2      Cross section through model domain  \nThis tutorial explains how to perform a SEAWAT simulation within GMS using the \nconceptual model approach. The tutorial demonstrates:  \n\uf0b7 Importing an existing MODFLOW simulation and conceptual model.  \n\uf0b7 Creating a SEAWAT model  to simulate the effects of pumping on salt water \nintrusion.  \n\uf0b7 Running the simulation.  \n\uf0b7 Viewing the results in 3D.  \nIt is recommended to complete the \u201c MODFLOW \u2013 Conceptual Model Approach  1\u201d and \nthe \u201cMT3DMS \u2013 Conceptual Model Approach \u201d tutorials prior to begi nning this tutorial.  \n\nGMS Tutorials   SEAWAT \u2013 Conceptual Model Approach  \n \n Page 4 of 14 \u00a9 Aquaveo 2024  2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2.1 Importing an Existing MODFLOW Model  \nThis tutorial will start with an existing MODFLOW model then make the necessary \nmodifications to run SEAWAT.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the  coastal  directory and select \u201ccoastal.gpr\u201d.  \n4. Click Open  to import the project and exit the Open  dialog.  \nThe imported model shows a MODFLOW grid on top of a background topographic map \n(Figure 3). The contours on the grid are the heads computed by the long SEAWAT run \nwith a steady state flow model.  \n \n      Figure 3      Initial model  \n2.2 Viewing the Initial Concentration  \nNow to view the initial concentration that will be assigned to the SEAWAT model.  \n1. Right -click on \u201c  3D Grid Data \u201d and select Expand All . \n2. Select \u201c  Salt Initial Concentration \u201d under \u201c  grid\u201d. \n3. Right -click on \u201c  Display Themes \u201d and select Expand All. \n\nGMS Tutorials   SEAWAT \u2013 Conceptual Model Approach  \n \n Page 5 of 14 \u00a9 Aquaveo 2024  4. Select \u201c  Fresh -water Isosurface \u201d. \nCross sections should be visible through the stratigraphy at the site ( Figure 4).  \n5. Use the Rotate   tool to see different angles of the fresh water interface.  \n \n      Figure 4      Display of the fresh -water isosurface  \n6. Select \u201c  Isosurface Animation \u201d. \nThis theme only shows the isosurface and the 3D grid faces ( Figure 5). \n \n      Figure 5      Isosurface and 3D grid faces are visible  \n7. Select the \u201c  Head Contours \u201d display theme.  \nThis theme shows the model in Plan View   (Figure 6). \n\nGMS Tutorials   SEAWAT \u2013 Conceptual Model Approach  \n \n Page 6 of 14 \u00a9 Aquaveo 2024   \n      Figure 6      View using Head Contours display theme  \n2.3 Saving the Project  \nIt is a good idea to save often. Save the projec t under a new name so that it can be \nsaved periodically.  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c seawat .gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n3 Setting Up the SEAWAT Simulation  \nNow, create a SEAWAT model by modifying the existing MODFLOW model. Do this by \nediting the conceptual model as well as setting up some options in the MOD FLOW, \nMT3D, and SEAWAT interfaces.  \n3.1 Editing the MODFLOW simulation  \nThe heads computed by SEAWAT simulation are different than the heads computed by a \nMODFLOW simulation.2 The SEAWAT simulation will be transient, so set the starting \nheads to be those comput ed by the prior long -term SEAWAT run. It is also necessary to \nchange the MODFLOW model to be transient and to set up the stress periods. The model \nwill run for 730 days, and each stress period will be 10 days long.  \n1. Select MODFLOW | Global Options \u2026 to open the MODFLOW Global/Basic \nPackage dialog.  \n2. Below the Run options  section, turn off Starting heads equal grid top elevation . \n                                                      \n2 For more details, see Langevin, Christian. D.; Thorne, Daniel T., Jr.; Dausman, Alyssa M.; Sukop, \nMichael C.; and Guo, Weixing. (2007). \u201cSEAWAT Version 4: A Computer Program for Simulation of \nMulti -Species Solute and Heat Transport\u201d in U.S. Geological Survey  Techniques and Methods \nBook 6 , Chapter A22, p. 13. https://pubs.usgs.gov/tm/tm6a22/pdf/tm6A22.pdf . \n\nGMS Tutorials   SEAWAT \u2013 Conceptual Model Approach  \n \n Page 7 of 14 \u00a9 Aquaveo 2024  3. Click Starting Heads \u2026 to open the Starting Heads dialog.  \n4. Click 3D Datas et \u2192 Grid\u2026 to open the Select Dataset dialog.  \n5. Select \u201c  Startin g Heads \u201d in the Solution  section and click OK to close the \nSelect Dataset  dialog.  \n6. Click OK to exit the Starting Heads dialog.   \n7. In the Model type  section, select Transient . \n8. Click Stress Periods \u2026 to open the Stress Periods dialog.  \n9. Click the Initialize \u2026 button.  \n10. Click Yes to bring up the Initialize Stress Periods  dialog when asked to overwrite \nall current MODFLOW boundary condition data assigned to stress periods.  \n11. Enter \u201c15\u201d as the Number of stress periods . \n12. Enter \u201c10.0\u201d as the Length . \n13. Enter \u201c1\u201d as the Number of time steps . \n14. Leave the remaining settings at their defaults ( Figure 7) and click OK to close the \nInitialize Stress Periods  dialog.  \n15. Click OK to exit the Stress Periods dialog.  \n16. Click OK to exit the MODFLOW Global/Basic Package dialog.  \n \n      Figure 7      Initialize Stress Periods dialog  \n3.2 Initializing MT3DMS  \nAs stated earlier, SEAWAT uses a combination of MODFLOW and MT3DMS.  It is \nnecessary to turn on the MT3DMS and SEAWAT menus, then initialize MT3DMS.  \n1. Right -click on \u201c  grid\u201d and select New MT3D MS\u2026  to bring up the Basic \nTransport Package  dialog.  \n2. Click Output Control \u2026 to open the Output Control dialog.  \n3. Enter \u201c 40\u201d for the Print or save at specified interval . \n\nGMS Tutorials   SEAWAT \u2013 Conceptual Model Approach  \n \n Page 8 of 14 \u00a9 Aquaveo 2024  4. Click OK to exit the Output Control  dialog.  \n5. Click Packages \u2026 to open the MT3DMS/RT3D Packages dialog.  \n6. Turn on Advection package  and Source/sink mixing package . \n7. Click OK to exit the MT3DMS /RT3D Packages  dialog.  \nNow to define a species and set the starting concentration for the salt species:  \n8. Click Define Species \u2026 to open the Define Species dialog.  \n9. Click New to create a new species in the spreadsheet on the left.  \n10. Enter \u201c Salt\u201d in the Name  column.  \n11. Click OK to exit th e Define Species  dialog.  \n12. Above the spreadsheet on the right bottom of the dialog, turn on Use materials \nfor porosity and long. dispersivity . \n13. In the spreadsheet, check the box in the Edit Per Cell  column of the Salt row. \n14. Click the   button in the Starting C onc. Per Cell  column to open the Starting \nConcentrations \u2013 Salt dialog.  \n15. Click 3D Datas et \u2192 Grid to open the Select Dataset  dialog.  \n16. Select \u201c  Salt Initial Concentration \u201d in the Solution  section and click OK to close \nthe Select Dataset  dialog.  \n17. Click OK to exit the  Starting Concentrations \u2013 Salt dialog.  \n18. Click OK to exit the Basic Transport Package  dialog.  \n3.3 Initializing SEAWAT Simulation  \nWith the MODFLOW and MT3DMS models ready, it is possible to initialize the SEAWAT \nsimulation  \n1. Right -click on \u201c  grid\u201d and sel ect New SEAWAT \u2026 to open the Global Options \ndialog.  \n2. Turn on Include transport in simulation . \n3. In the Packages  section, turn on Variable -Density Flow  (VDF) . \n4. Click OK button to exit the Global Options  dialog.  \nModifying the VDF Package  \nNow, enter the data necessary for the VDF package. The inputs to the VDF package \ncontrol the density calculations performed by SEAWAT. In the example problem, the \nconcentration of seawater was defined as 19 g/l. Based on the units of the MODFLOW \nmodel, the reference density w ill be 1000 kg/m3. If the density of seawater is 1025 kg/m3, \nthen the linear relationship between concentration and density is defined with a factor of \n1.315.3 \n1. Select SEAWAT | VDF Package \u2026 to open the SEAWAT VDF Package dialog.  \n2. Enter \u201c10.0\u201d for Length of f irst transport time step (FIRSTDT) . \n                                                      \n3 For more information, see Langevin, et al (2007), pp. 20 \u201321. \n\nGMS Tutorials   SEAWAT \u2013 Conceptual Model Approach  \n \n Page 9 of 14 \u00a9 Aquaveo 2024  3. In the Fluid density calculation  section, enter \u201c1000.0\u201d for Reference fluid density \n(DENSEREF) . \n4. For Density/conc. slope (DRHODC) , enter \u201c1.315\u201d . \nThe dialog should appear as in Figure 8. \n5. Click OK to exit the SEAWAT VDF Package  dialog.  \n \n      Figure 8      SEAWAT VDF Package  inputs  \n3.4 Editing the Conceptual Model  \nNow, adjust the conceptual model by assigning a concentration to the arc defining the \ncoastline. In order to assign concentrations in the conceptual model, it\u2019s necessary to turn \non the transport option and define a species.  \n1. Fully expand the \u201c  Map Data \u201d folder in the Project Explorer . \n2. Right-click on \u201c  MODFLOW_SEAWAT \u201d and select Properties \u2026 to open the \nConceptual Model Properties dialog.  \n3. In the lower section , turn on Transport . \n4. Select \u201cMT3DMS / MT3D -USGS\u201d from the Transport model  drop-down.  \n5. Click Define Species \u2026 to open the Define Species  dialog.  \n\nGMS Tutorials   SEAWAT \u2013 Conceptual Model Approach  \n \n Page 10 of 14 \u00a9 Aquaveo 2024  6. Click New to create a new species in the spreadsheet.  \n7. Enter \u201cSalt\u201d in the name column and click OK to close the Define Species  dialog.  \n8. Click OK to exit the Conceptual Model Properties dialog.  \nAssigning Salt Concentration at the Coastline  \nNow that a species has been defined, assign a concentration to the coast line arc.  \n1. Select \u201c  Sources & Sinks \u201d in the Project Explorer  to make it active.  \n2. Using the Select Arcs   tool, double -click on the coastline arc to bring up the \nAttribute Table  dialog.  \n3. Enter \u201c 19.0\u201d in the Salt conc  (g/l) column.  \n4. Click OK to exit the Attribute Table dialog.  \nMapping to MT3DMS  \nNow to convert the conceptual model to the numerical model:  \n1. Select Feature Objects | Map \u2192 MT3DMS  to bring up the Map \u2192 Model  dialog.  \n2. Click OK to accept the  defaults and close the Map \u2192 Model  dialog.  \n3. Click Display Options   to open the Display Options dialog . \n4. Select \u201c3D Grid Data\u201d from the list on the left.  \n5. On the MODFLOW  tab, turn on Transient head .  \n6. Click OK to close the Display Options  dialog.  \nNotice that all the cells at the coastline now have new symbols representing the boundary \ncondition in the MT3DMS source/sink mixing package (detail in Figure 9). \n \n      Figure 9      Detail showing the new boundary condition symbols  \nMapping to MODFLOW  \nAt this point, it is also necessary to map over the wells and their pumping schedules.  \n1. Select the \u201c  Wells \u201d coverage to make it active.  \n2. Right -click on \u201c  Wells \u201d and select Map To  | MODFLOW /MODPATH .  \n3.5 Saving and Running SEAWAT  \nNow to save the changes and run SEAWAT:  \n1. Save   the project.  \n\nGMS Tutorials   SEAWAT \u2013 Conceptual Model Approach  \n \n Page 11 of 14 \u00a9 Aquaveo 2024  2. Select SEAWAT | Run SEAWAT \u2026 to bring up the SEAWAT  model wrapper \ndialog.  \n3. When SEAWAT finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and close the SEAWAT  dialog.  \n4 Viewing the Solution  \nNow, view the results of the SEAWAT model run. Examine how the fresh -water contour \nline changes with time.  \n1. Select the \u201c  MCL contour \u201d display theme.  \nThis display theme is set up to show one contour at a value of 0.25 g/l ( Figure 10). \n \n      Figure 10      Initial appearance after turning on MCL contour display theme  \n2. Select the \u201c  Salt\u201d dataset under the \u201c  seawat (MT3DMS) \u201d solution in the \nProject Explorer.  \n3. In the time step window, select time step 12 (it has a value of \u201c 120.0 \u201d). \nNotice that the MCL  contour moves inland slightly from time step 1 to time step 12 \n(Figure 11). \n\nGMS Tutorials   SEAWAT \u2013 Conceptual Model Approach  \n \n Page 12 of 14 \u00a9 Aquaveo 2024   \n      Figure 11      Time step 12  \n4.1 Creating an Animation  \nNext t o create an animation of the change in concentration over time. This helps show \nwhen the northernmost well begins pumping lower quality water.  \n1. Select Display | Animate \u2026 to bring up the Options  page of the Animation Wizard  \ndialog.  \n2. Click on the Browser  button . \n3. Enter \u201cseawat.mp4\u201d as the File name . \n4. Be certain that the file type is an Animation file.  \n5. Select Save . \nThe defaults work fine for this animation.  \n6. Click Next  to go to the Datasets  page of the Animation Wizard  dialog.  \n7. Click Finish  to close the Animation Wizard  dialog.  \n8. Open an external animation application.  \nAn animation should begin playing after a few moments (depending on the speed of the \ncomputer being used). Notice how the MCL contour line eventually surrounds the \nnorthernmost pumping well. Also see how the MCL contour line is moving near the \nsouthernmost well.  \n9. When finished viewing the animation, close  the Animation and return to \nGMS.  \n4.2 Creating a Time Series Plot of Concentration  \nNext to make a plot of concentration versus time at the north ernmost well.  \n1. Zoom   in around the northernmost well.  \n2. Select \u201c  grid\u201d in the Project Explorer  to make it active.  \n\nGMS Tutorials   SEAWAT \u2013 Conceptual Model Approach  \n \n Page 13 of 14 \u00a9 Aquaveo 2024  3. Using the Select Cell   tool, select the cell containing the well by clicking on the \nwell.  \nNotice that the selected cell number is indicated i n the status bar at the bottom left of the \nGMS window (\u201cCell ID: 13035\u201d).  \n4. Click Plot Wizard   to bring up the Step 1 of 2  page of the Plot Wizard  dialog.  \n5. Select \u201c Active Dataset Time Series \u201d from the Plot Type  list on the left.  \n6. Click Finish  to close the Plot Wizard  dialog.  \nA plot similar to Figure 12 should appear. See how the concentration increases when the \nwell is pumping and then drops off when the well is turned off.  \n7. Close  the plot window and maximize the Graphics Window before \ncontinuing.  \n \n      Figure 12      Time series plot of concentration  \n4.3 Animating the Fresh -Water Surface  \nNow to animate the fresh -water isosurface over time:   \n1. Select the \u201c  Isosurface Animation \u201d display theme.  \n2. Select the Select Material Zones   tool. \n3. Select Edit | Select From List  to bring up the Select  dialog.  \n4. Turn on \u201c lower_aquifer \u201d and click OK to close the Select  dialog.  \nThe lower aquifer and the fresh -water is osurface should now be visible. There will also be \nsome circles that are visible. Those can be used to select material zones. To avoid \nhaving the circles in the animation, change the tool.  \n5. Select the Select Cell   tool.  \n\nGMS Tutorials   SEAWAT \u2013 Conceptual Model Approach  \n \n Page 14 of 14 \u00a9 Aquaveo 2024  6. Select Display  | Animate \u2026 to bring up the Options  page of the Animation Wizard  \ndialog.  \n7. Click on the browser  button to open the Save  dialog.  \n8. Enter \u201cloweraquifer.mp4\u201d as the File name . \n9. Be certain that the Save as type  is set to \u201cAnimation file (*.mp4, *.avi)\u201d.  \n10. Select Save  to close  the Save  dialog.  \nThe defaults will work fine for this animation.  \n11. Click Next  to go to the Datasets  page of the Animation Wizard  dialog.  \n12. Click Finish  to close the Animation Wizard  dialog.  \nView the animation file in an external media player application. An a nimation should \nbegin playing after a few moments. Notice how the fresh -water surface is affected by the \npumping wells. See how the fresh -water surface passes the northernmost well.  \n5 Conclusion  \nThis concludes the \u201cSEAWAT \u2013 Conceptual Model Approach\u201d tutoria l.  The following key \nconcepts were discussed and demonstrated in this tutorial:  \n\uf0b7 SEAWAT combines MODFLOW and MT3DMS to solve variable density \ngroundwater flow and solute transport problems.  \n\uf0b7 Use the conceptual model approach with SEAWAT models.  \n\uf0b7 SEAWAT resul ts can be visualized three dimensionally in GMS.  \n5.1 Further Reading  \nLangevin, Christian D.; Shoemaker, W. Barclay; and Guo, Weixing (2003). \u201cMODFLOW -2000, the \nU.S. Geological Survey Modular Ground -Water Model \u2013Documentation of the SEAWAT -2000 \nVersion with the Variable -Density Flow Process (VDF) and the Integrated MT3DMS Transport \nProcess (IMT)\u201d: U.S. Geological Survey Open -File Report 03 -426, 43 p. \nhttp://fl.water.usgs.gov/PDF_files/ofr03 _426_langevin.pdf .  \n \n \n\n", "filename": "SEAWAT-ConceptualModelApproach.pdf", "pages": 14}, "SEAWAT-GoswamiClementExperiment": {"text": "GMS Tutorials   SEAWAT \u2013 Goswami/Clement Experiment  \n Page 1 of 15 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nSEAWAT \u2013 Goswami/Clement Experiment  \nSimulate transient movement of a saltwater wedge using SEAWAT  \nObjectives   \nThis tutorial shows how to simulate a transient saltwater intrusion dataset as presented in the \nGoswami/Clement experiment.  \n. \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Grid \nApproach  \n\uf0b7 MT3DMS \u2013 Grid Approach  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 MT3D  \n\uf0b7 SEAWAT  Time  \n\uf0b7 30\u201345 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   SEAWAT \u2013 Goswami/Clement Experiment  \n Page 2 of 15 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 Importing the MODFLOW Project  ................................ ................................ .................  3 \n2.2 Saving the Model with a New Name  ................................ ................................ .............  4 \n3 Setting Up MT3DMS ................................ ................................ ................................ .............  4 \n3.1 Basic Transport Package  ................................ ................................ ..............................  4 \n3.2 MT3DMS, Species, and Porosity  ................................ ................................ ..................  5 \n3.3 Dispersion Package  ................................ ................................ ................................ ...... 5 \n4 First SEAWAT Scenario (SS -1) ................................ ................................ ...........................  6 \n4.1 Initializing SEAWAT  ................................ ................................ ................................ ...... 6 \n4.2 Modifying the VDF Package  ................................ ................................ .........................  7 \n4.3 Saving and Running SEAWAT  ................................ ................................ .....................  7 \n4.4 Viewing the SS -1 Solution  ................................ ................................ ............................  7 \n5 Second SEAWAT Scenario (SS -2) ................................ ................................ ......................  8 \n5.1 Saving the Model with a New Name  ................................ ................................ .............  8 \n5.2 Initial Conditions for SS -2 ................................ ................................ .............................  9 \n5.3 Saving and Running SEAWAT  ................................ ................................ ...................  10 \n5.4 Viewing the SS -2 Solution  ................................ ................................ ..........................  10 \n6 Third SEAWAT Scenario (SS -3) ................................ ................................ ........................  12 \n6.1 Saving the Model with a New Name  ................................ ................................ ...........  12 \n6.2 Initial Conditions for SS -3 ................................ ................................ ...........................  12 \n6.3 Saving and Running SEAWAT  ................................ ................................ ...................  13 \n6.4 Viewing the SS -3 Solution  ................................ ................................ ..........................  13 \n7 Conclusion  ................................ ................................ ................................ .........................  15 \n8 Further Readin g ................................ ................................ ................................ .................  15 \n \n1 Introduction  \nThis tutorial describes how to simulate the transient movement of a saltwater wedge in \nand out of an aquifer.  This example problem is very similar to the experimental problem \ndescribed in the 2007 Goswami an d Clement article.1 The experimental setup used for \nthis problem is shown in Figure 1. Although this is an unconfined flow problem, the \ngroundwater gradients used are small and hence the problem can be simplified and \nmodeled as a confined flow saltwater intrusion problem.   \nThe experimental system has a constant saltwater bo undary in the left and constant \nfreshwater boundary in the right.  The salt concentration used was 37 kg/m3 (or 0.037 \ng/cm3) and the density was 1026 kg/m3 (or 1.026 g/cm3). This tutorial demonstrates the \nsteps used to define MODFLOW, MT3DMS , and SEAWAT inp ut data creating this \nsimulation .  \n                                                      \n1 Goswami, Rohit R. and Clement, T. Prabhakar, (2007). \u201cLaboratory -scale investigation \nof saltwater intrusion dynamics\u201d in Water Resources Research , Volume 43, W04418, \ndoi:10.1029/2006WR005151 , 2007. \nhttp://onlinelibrary.wiley.com/doi/10.1029/2006WR005151/abstract . \nGMS Tutorials   SEAWAT \u2013 Goswami/Clement Experiment  \n \n Page 3 of 15 \u00a9 Aquaveo 2024   \n      Figure 1      Experimental setup used  \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2.1 Importing the MODFLOW Project  \nA MODFLOW simulation with the correct units, a 3D grid, the correct LPF options, and \ncell properties has been created for this tutorial. The grid is 53. 5 by 2.7 by 25.5 cm ( xyz \ndimensions). MODFLOW has been run to generate the vertical contour lines.  \nImport it by doing the following:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the saltwater  directory and select \u201cstart.gpr\u201d.  \n4. Click Open  to import the project and exit the Open  dialog.  \nThe project should appear similar to Figure 2. \n\nGMS Tutorials   SEAWAT \u2013 Goswami/Clement Experiment  \n \n Page 4 of 15 \u00a9 Aquaveo 2024   \n      Figure 2      The imported MODFLOW project  \n2.2 Saving the Model with a New Name  \nBefore proceeding with the tutorial, save the project under a new name:  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from th e Save as type  drop-down.  \n3. Enter \u201cGC1.gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n3 Setting Up MT3DMS  \n3.1 Basic Transport Package  \nTo start this process, first create a new MT3DMS simulation  \n1. Select \u201c  grid\u201d, then right -click on it and select New MT3DMS\u2026  to bring up the \nBasic Transport Package  dialog.  \n2. Click Stress Periods\u2026  to bring up the Stress Periods  dialog.  \n3. On row 1 of the spreadsheet, enter \u201c80.0\u201d in the Length  column and \u201c8\u201d in the \nNum Time Steps  column.  \n4. Click OK to close the Stress Periods  dialog.  \n5. Click Output Control\u2026  to bring up the Output Control  dialog.  \n6. In the section below the Retardation factor  section, select Print or save at \nspecified times . \n7. Click Times\u2026  to bring up the Variable Time Steps  dialog.  \n8. Click Initialize Values\u2026  to bring up the Initialize Time Steps  dialog.  \n9. Enter \u201c1.0\u201d as the Initial time step size . \n10. Enter \u201c4.0\u201d as the Bias. \n\nGMS Tutorials   SEAWAT \u2013 Goswami/Clement Experiment  \n \n Page 5 of 15 \u00a9 Aquaveo 2024  11. Enter \u201c5.0\u201d as the Maximum time step size . \n12. Enter \u201c80.0\u201d as the Maximum simulation time . \n13. Click OK to close th e Initialize Time Steps  dialog.  \nNotice that the spreadsheet in the Variable Time Steps  dialog has been populated with \ntime steps ranging from \u201c1.0\u201d up to \u201c80.0\u201d.  \n14. Click OK to close the Variable Time Steps  dialog.  \n15. Click OK to close the Output Control  dialog.  \n3.2 MT3DMS, Species, and Porosity  \nDo the following to set up the MT3DMS options:  \n1. Click Packages\u2026  to bring up the MT3DMS/RT3D Packages  dialog.  \n2. Turn on Advection package , Dispersion package , and Source/sink mixing \npackage  and click OK to close the MT3DMS/RT3D P ackages  dialog.  \n3. Click Define Species\u2026  to bring up the Define Species  dialog.  \n4. Click New to add a new species to the spreadsheet.  \n5. Enter \u201cSalt\u201d in the Name  column and click OK to close the Define Species  dialog.  \n6. Click Porosity\u2026  to bring up the Porosity  dialog.  \n7. Click Constant \u2192 Grid\u2026  to bring up the Grid Value  dialog.  \n8. Enter \u201c0.385\u201d as the Constant value for grid  and click OK to close the Grid Value  \ndialog.  \n9. Click OK to close the Porosity  dialog.  \n10. Click OK to close the Basic Transport Package  dialog.  \n3.3 Disper sion Package  \n1. Select MT3DMS  | Dispersion Package\u2026  to bring up the Dispersion Package  \ndialog.  \n2. Click Longitudinal Dispersivity\u2026  to bring up the Longitudinal Dispersivity  \ndialog.  \n3. Click Constant \u2192 Grid\u2026  to bring up the Grid Value  dialog.  \n4. Enter \u201c0.1\u201d as the Cons tant value for grid  and click OK to close the Grid Value  \ndialog.  \n5. Click OK to close the Longitudinal Dispersivity  dialog.  \n6. Click OK to close the Dispersion Package  dialog.  \n7. Using the Select j   tool, click on the top left cell to select the all boundary cells  \nin the leftmost column.  \n8. Right -click and select Sources/Sinks\u2026  to bring up the MODFLOW/MT3DMS \nSources/Sinks  dialog.  \n9. Select \u201cMT3DMS: Point SS\u201d from the list on the left.  \n10. Click Add BC  to create a new set of entries in the spreadsheet on the right.  \n\nGMS Tutorials   SEAWAT \u2013 Goswami/Clement Experiment  \n \n Page 6 of 15 \u00a9 Aquaveo 2024  11. In the All row of the spreadsheet, select \u201cconstant concentration\u201d from the drop -\ndown in the Type (ITYPE)  column.  \n12. In the All row, enter \u201c0.037\u201d in the Salt column.  \n13. Click OK to close the MODFLOW/MT3DMS Sources/Sinks  dialog.  \n14. Select MT3DMS  | Check Simulation\u2026  to bring  up the Model Checker  dialog.  \n15. Click Run Check . \nThere should be no errors or warnings.  \n16. Click Done  to close the Model Checker  dialog.  \n4 First SEAWAT Scenario (SS -1) \n4.1 Initializing SEAWAT  \nThe objecti ve of the Goswami/Clement experiment  was to generate three st eady -state \nprofiles  and two sets of transient simulations described by the boundary conditions \nshown in Figure 3.2 The saltwater head is fixed at 25.5 in all of the s imulation s. The \nfreshwater head varies slightly in each simulation .  \nSEAWAT simulations use a combination of MODFLOW and MT3DMS packages along \nwith VDF , a SEAWAT -specific package . \n1. Right -click on \u201c  grid\u201d and select New SEAWAT\u2026  to bring up the Global \nOption s dialog.  \n2. Turn on Include transport in simulation . \n3. In the Packages  section, turn on Variable -Density Flow (VDF) . \n4. Click OK to exit the Global Options  dialog.  \n \n      Figure 3      Boundary conditions simulated in the experimental study3 \n                                                      \n2 Goswami and Clement (2007), p. 1.  \n3 Goswami and Clement (2007), p. 6.  \n\nGMS Tutorials   SEAWAT \u2013 Goswami/Clement Experiment  \n \n Page 7 of 15 \u00a9 Aquaveo 2024  4.2 Modifying the VDF Package  \nFor the first scenario, simulate the effect of salinity on the fluid density.  \n1. Select SEAWAT  | VDF Package\u2026  to open the SEAWAT VDF Package  dialog.  \n2. Enter \u201c1.0\u201d as the Minimum fluid density (DENSEMIN) . \n3. Enter \u201c1.026\u201d as the Maximum fluid density (DENSEMAX) . \nThis helps convergence, especially when starting with freshwater as the initial condition . \n4. In the Fluid density calculation  section, enter \u201c 1\u201d in the Fluid density calc \n(MT3DRHOFLG)  field.  \nThis indicates that the fluid density calculation will be done using the \u201cSalt\u201d spec ies. \n5. Enter \u201c1.0\u201d in the Reference fluid density (DENSEREF)  field.  \nThis mean s the reference fluid density (freshwater, in this case) at 25\u02daC is 1000 kg/m 3. \n6. Enter \u201c0.7\u201d in the Density/conc. slope (DRHODC) field.  \nThis DRHODC value indicates that the density will vary linearly between 1.0 g/cm3 for \nfreshwater and 1.026 g/cm3 for saltwater.  DRHODC is estimated by dividing the density \ndifference by the concent ration difference. In this case, the result is the following:  \n1.026(g/cm3) - 1.0(g/cm3) \n= 0.7  \n0.037(g/cm3) - 0.0(g/cm3) \n7. Click OK to close the SEAWAT VDF Package  dialog.  \n4.3 Saving and Running SEAWAT  \nNow, save the changes and run SEAWAT:  \n1. Save   the project . \n2. Click Run SEAWAT   to bring up the SEAWAT  model wrapper dialog.  \n3. When SEAWAT finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and close the SEAWAT  dialog.  \n4.4 Viewing the SS-1 Solution  \nNow, view the results of the SEAWAT model run:  \n1. Select the \u201c  Salt\u201d dataset below the \u201c  GC1 (MT3DMS)\u201d solution in the \nProject Explorer.  \n2. Click Contour Options   to bring up the Dataset Contour Options \u2013 3D Grid \u2013 \nSalt dialog.  \n3. In the Contour method  section, select \u201cLinear\u201d from the first drop -down and \n\u201cSpecify each color\u201d from the second drop -down.  \n4. Enter \u201c4\u201d as the Line thickness . \n5. In the Contour interval  section, select \u201cSpecified Values\u201d from the drop -down and \nenter \u201c5\u201d in the field to the right.  \n\nGMS Tutorials   SEAWAT \u2013 Goswami/Clement Experiment  \n \n Page 8 of 15 \u00a9 Aquaveo 2024  6. In the spreadsheet, enter \u201c0.01\u201d in the Start Value  column of row 1. \n7. Enter \u201c0.015\u201d in the Start Value  column of row 2. \n8. Enter \u201c0.02\u201d in the Start Value  column of row 3. \n9. Enter \u201c0.03\u201d in the Start Value  column of row 4. \n10. Enter \u201c0.035\u201d in the Start Value  column  of row 5. \n11. Click OK to close the Dataset Contour Options \u2013 3D Grid \u2013 Salt dialog.  \n12. Select time step 7 in the time step window.  \nThe contours should appear similar to Figure 4. Feel free to review the other time steps \nas well.  \n \n      Figure 4      Contours showing steady state concentration of salt at 30 minutes  \nNotice that the system reach es a steady  state at around 30 mins , when the toe of the \nwedge has moved about 15.5 cm to the right . Now check the water budget:  \n1. Select the \u201c  Head\u201d dataset under the \u201c  GC1 (MODFLOW)\u201d folder in the \nproject explorer.  \n2. Select time step 3 in the time step window . \n3. Using the Select j   tool, select the top left cell, then right -click and select Flow \nBudget\u2026  to bring up the Flow Budget  dialog.  \nNotice that the Total Zone Flow  in the Flow In  column is about \u201c83.14\u201d (this is in cm3/min).  \n4. When done, click OK to close the Flow Budget  dialog.  \n5. Save   the project.  \n5 Second SEAWAT Scenario (SS -2) \n5.1 Saving the Model with a New Name \nFirst, save  the model with a new name:  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n\nGMS Tutorials   SEAWAT \u2013 Goswami/Clement Experiment  \n \n Page 9 of 15 \u00a9 Aquaveo 2024  3. Enter \u201cGC2.gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n5.2 Initial Condition s for SS -2  \nThe MODFLOW heads simulated in the SS -1 scenario will be used as the initial head \ncondition for the SS -2 scenario.  The steady  state salt concentrations simulated for SS -1 \nwill be used as the initial concentration condition.  The freshwater head on the right will  be \ndecreased to 26.2 cm to allow the wedge to intrude further into the system.  \nFirst, app ly the head values to the grid.  \n1. Select the \u201c  Head \u201d dataset  under the \u201c GC1 (MODFLOW) \u201d folder . \n2. Select MODFLOW  | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage  dialog.  \n3. Turn off Starting heads equal grid top elevations . \n4. Click Starting Heads\u2026  to bring up the Starting Heads  dialog.  \n5. Click 3D Dataset \u2192 Grid\u2026  to bring up the Constant to Layer  dialog.  \n6. Select Apply to variable head cells only  and click OK to bring up the Select \nDataset  dialog.  \n7. In the Solution  section, select \u201c  Head \u201d under the \u201c  GC1 (MODFLOW) \u201d \nfolder.  \n8. In the Time steps  section, select step 8 (value of \u201c80.0\u201d) and click OK to close the \nSelect Dataset  dialog.  \n9. Click OK to close the Starting Heads  dialog.  \n10. Click OK to close the MODFLOW Global/Basic Package  dialog.  \nNext, adjust the salt dataset values for use in the new simulation.  \n1. Select the \u201c  Salt\u201d dataset  under the \u201c GC1 (MT3DMS )\u201d folder.  \n2. Select MT3DMS  | Basic Transport Package\u2026  to bring up the Basic Transport \nPackage  dialog.  \n3. In the spreadsheet in the bottom right, check the box in t he Edit Per Cell  column.  \n4. Click on the  button in the Starting Conc. Per Cell  column to bring up the \nStarting Concentrations \u2013 Salt dialog.  \n5. Click 3D Dataset \u2192 Grid\u2026  to bring up the Select Dataset  dialog.  \n6. In the Solution  section, select \u201c  Salt\u201d under the \u201c  GC1 (MT3DMS )\u201d folder.  \n7. In the Time steps  section, select step 17 (value of \u201c80.0\u201d) and click OK to close \nthe Select Dataset  dialog.  \n8. Click OK to close the Starting Concentrations \u2013 Salt dialog.  \n9. Click OK to close the Basic Transport Package  dialog.  \n10. Using the Select j   tool, select the top right cell in order to select the right \ncolumn boundary cells.  \n\nGMS Tutorials   SEAWAT \u2013 Goswami/Clement Experiment  \n \n Page 10 of 15 \u00a9 Aquaveo 2024  11. Right -click on one of the selected cells and select Properties\u2026  to bring up the \n3D Grid Cell Properties  dialog.  \n12. On the MODFLOW  tab in the Starting head  row, enter \u201c26.2\u201d.  \n13. Click OK to close the 3D Grid Cell Properties  dialog.  \nThe SEAWAT global options and VDF Package settings do not need to be adjusted for \nthis scenario.  \n5.3 Saving and Running SEAWAT  \n1. Save   the project.  \n2. Click Run SEAWAT   to bring up the SEAWAT  model wrapper dialog.  \n3. When SEAWAT finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and close the SEAWAT  dialog.  \n5.4 Viewing the SS -2 Solution  \n1. Select the \u201c  Salt\u201d dataset below the \u201c  GC2 (MT3DMS)\u201d solution in the \nProject Explorer.  \n2. Select time step 2 in the time step window ( Figure 5). \n \n      Figure 5      Time step 2 (after 5 minutes)  \n3. Select time step 4 in the time step window ( Figure 6). \n \n      Figure 6      Time step 4 (after 15 minutes)  \n\nGMS Tutorials   SEAWAT \u2013 Goswami/Clement Experiment  \n \n Page 11 of 15 \u00a9 Aquaveo 2024  4. Select time step 12 in the time step window ( Figure 7). \n \n      Figure 7      Time step 12 (after 55 minutes)  \nThe figures above match the data from the Goswami/Clement experiment ( Figure 8). \n \n      Figure 8      Transient salt wedge intrusion profiles from Goswami/Clement experiment4 \nThe toe of the salt wedge predicted after 5, 15 , and 55 min utes of si mulation is at 22, 30, \nand 40 cm (respectively ). It match es the data from the Goswami/Clement experiment. \nCompare the figures above to Figure 9, which shows the actual wedges from that \nexperiment.  The system is close to reaching steady -state conditions at about  60 to 80 \nminutes into the experiment . \n  \n      Figure 9      Actual wedges from the Goswami/Clement experiment5 \n5. Save   the project.  \n                                                      \n4 Goswami and Clement (2007),  p. 8. \n5 Goswami and Clement (2007), p. 5.  \n\nGMS Tutorials   SEAWAT \u2013 Goswami/Clement Experiment  \n \n Page 12 of 15 \u00a9 Aquaveo 2024  6 Third SEAWAT Scenario (SS -3) \n6.1 Saving the Model with a New Name \nNow save the model with a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Fil es (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201cGC 3.gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n6.2 Initial Condition s for SS -3  \nThe MODFLOW heads simulated inthe SS -2 scenario will be used as the initial head \ncondition for the SS -3 scenario.  The steady  state salt concentrations simulated for SS -2 \nwill be used as the initial concentration condition.  The freshwater head on the right will be \nchanged  to 26. 55 cm to allow t he wedge to recede from  the system.  \nFirst, apply the head values to the grid:  \n1. Select the \u201c  Head \u201d dataset  under the \u201c GC2 (MODFLOW) \u201d folder . \n2. Select MODFLOW  | Global Options\u2026  to bring up the MODFLOW Global/Basic \nPackage  dialog.  \n3. Turn off Starting heads equa l grid top elevations . \n4. Click Starting Heads\u2026  to bring up the Starting Heads  dialog.  \n5. Click 3D Dataset \u2192 Grid\u2026  to bring up the Constant to Layer  dialog.  \n6. Select Apply to variable head cells only  and click OK to bring up the Select \nDataset  dialog.  \n7. In the Solution  section, select \u201c  Head\u201d under the \u201c  GC2 (MODFLOW) \u201d \nfolder.  \n8. In the Time steps  section, select step 8 (value of \u201c80.0\u201d) and click OK to close the \nSelect Dataset  dialog.  \n9. Click OK to close the Starting Heads  dialog.  \n10. Click OK to close the MODFLOW Glo bal/Basic Package  dialog.  \nNext, adjust the salt dataset values for use in the new simulation.  \n1. Select the \u201c  Salt\u201d dataset  under the \u201c GC2 (MT3DMS )\u201d folder.  \n2. Select MT3DMS  | Basic Transport Package\u2026  to bring up the Basic Transport \nPackage  dialog.  \n3. In the spr eadsheet in the bottom right, check the box in the Edit Per Cell  column.  \n4. Click on the  button in the Starting Conc. Per Cell  column to bring up the \nStarting Concentrations \u2013 Salt dialog.  \n5. Click 3D Dataset \u2192 Grid\u2026  to bring up the Select Dataset  dialog.  \n6. In the Solution  section, select \u201c  Salt\u201d under the \u201c  GC2 (MT3DMS )\u201d folder.  \n\nGMS Tutorials   SEAWAT \u2013 Goswami/Clement Experiment  \n \n Page 13 of 15 \u00a9 Aquaveo 2024  7. In the Time steps  section, select step 17 (value of \u201c80.0\u201d) and click OK to close \nthe Select Dataset  dialog.  \n8. Click OK to close the Starting Concentrations \u2013 Salt dialog.  \n9. Click OK to close the Basic Transport Package  dialog.  \n10. Using the Select j   tool, select the top right cell in order to select the right \ncolumn boundary cells.  \n11. Right -click on one of the selected cells and select Properties\u2026  to bring up the \n3D Grid Cell Properties  dialog. \n12. On the MODFLOW  tab in the Starting head  row, enter \u201c26.55\u201d.  \n13. Click OK to close the 3D Grid Cell Properties  dialog.  \nThe SEAWAT global options and VDF Package settings do not need to be adjusted for \nthis scenario.  \n6.3 Saving and Running SEAWAT  \n1. Save   the pr oject.  \n2. Click Run SEAWAT   to bring up the SEAWAT  model wrapper dialog.  \n3. When SEAWAT finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and close the SEAWAT  dialog.  \n6.4 Viewing the SS -3 Solution  \n1. Select the \u201c  Salt\u201d dataset below the \u201c  GC3 (MT3DMS)\u201d solution in the \nProject Explorer.  \n2. Select time step 3 in the time step window ( Figure 10). \n \n      Figure 10      Time step 3 (after 10 minutes)  \n3. Select time step 4 in the time step window ( Figure 11). \n\nGMS Tutorials   SEAWAT \u2013 Goswami/Clement Experiment  \n \n Page 14 of 15 \u00a9 Aquaveo 2024   \n      Figure 11      Time step 4 (after 1 5 minutes)  \n4. Select time step 6 in the time step window ( Figure 12). \n \n      Figure 12      Time step 6 (after 25 minutes)  \nNotice that the figures above match the data from the Goswami/Clement experiment \n(Figure 13). \n \n      Figure 13      Transient salt wedge receding profiles from Goswami/ Clement experiment6 \n                                                      \n6 Goswami and Clement (2007), p. 8.  \n\nGMS Tutorials   SEAWAT \u2013 Goswami/Clement Experiment  \n \n Page 15 of 15 \u00a9 Aquaveo 2024  Compare the figures above to Figure 14, showing the actual receding wedges from that \nexperiment. Notice that t he wedge recedes much more quickly than it intrudes.  \n \n      Figure 14      Actual receding wedges from the Goswami/ Clement experiment  \n7 Conclusion   \nThis concludes the \u201cSEAWAT \u2013 Goswami/Clement Experiment \u201d tutorial.  The following \nkey concepts were discussed and demonstrated in this tutorial:  \n\uf0b7 SEAWAT combines MODFLOW and MT3DMS to solve variable density \ngroundwater flow and solute transport problems.  \n\uf0b7 SEAWAT can be used to simulate the transient movement of transient saltwater \nwedges.  \n\uf0b7 Both model results and experimental data show that it takes more time to intrude \nthan to recede.  \n8 Further Reading  \nIn addition to the Goswami and Clement (2007) article referenced in the tutorial, r efer to \nthe following journal articles to learn more about this topic.  All the articles use SEAWAT \nto set up  different types of experimental datasets involving density -coupled flows.  \n\uf0b7 Chang S.W.,  and T.P. Clement, (2013). \u201cLaboratory and numerical investigation of \ntransport processes occurring beneath a saltwater wedge\u201d in Journal of Contaminant \nHydrology , 147, pp. 14 -24. \n\uf0b7 Chang, S.W. and T.P. Clement, (2012). \u201cExperimental and numerical investigat ion of \nsaltwater intrusion dynamics in flux controlled groundwater systems\u201d in Water Resources \nResearch, Vol. 48 , W09527.10 PP., doi:10.1029/2012WR012134, 2012.  \n\uf0b7 Goswami, R.R., T. P. Clement, and J. H. Hayworth, (2012). \u201cComparison of numerical \ntechniques u sed for simulating variable -density flow and transport experiments\u201d in ASCE \nJournal of Hydrologic Engineering , v.17 (2), pp.272 -282. \n\uf0b7 Chang, S. W, T. P. Clement, M. J. Simpson, and K. K Lee, (2011). \u201cDoes sea -level rise \nhave an impact on saltwater intrusion ?\u201d in Advances in Water Resources , 34 (10), pp. \n1283 -1291.  \n \n\n", "filename": "SEAWAT-GoswamiClementExperiment.pdf", "pages": 15}, "SEAWAT-HeleShawExperiment": {"text": "GMS Tutorials   SEAWAT \u2013 Hele-Shaw  Experiment  \n Page 1 of 8 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nSEAWAT  \u2013 Hele -Shaw  Experiment  \nSimulate the Hele -Shaw salt lake experiment using SEAWAT in GMS  \nObjectives   \nThis tutorial demonstrates how to construct and run a SEAWAT model in GMS using the grid approach. \nThe model will mimic the Hele -Shaw salt lake experiment . \n. \n \nPrerequisite Tutorials  \n\uf0b7 MT3DMS \u2013 Grid Approach  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 MT3D  \n\uf0b7 SEAWAT  Time  \n\uf0b7 10\u201320 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   SEAWAT \u2013 Hele-Shaw  Experiment  \n Page 2 of 8 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  4 \n2.1 Importing the existing model  ................................ ................................ .........................  4 \n3 The SEAWAT Model  ................................ ................................ ................................ ............  5 \n3.1 Viewing the SEAWAT Inputs  ................................ ................................ ........................  5 \n3.2 Saving and running the model  ................................ ................................ ......................  6 \n4 Viewing the Solution  ................................ ................................ ................................ ...........  6 \n4.1 Creating an Animation  ................................ ................................ ................................ .. 7 \n5 Conclusion  ................................ ................................ ................................ ...........................  8 \n \n1 Introduction  \nThe SEAWAT model is described as:  \n...a generic MODFLOW/MT3DMS -based computer program designed to simulate \nthree -dimensional variable -density groundwater flow coupled with multi -species \nsolute and heat transport. The program has been used for a wide variety of \ngroundwater studies including those focused on brine migration in continental \naquifers as well as those focused on saltw ater intrusion in coastal aquifers. \nSEAWAT uses the familiar structure of MODFLOW and MT3DMS .1  \nThis tutorial explains how to perform a SEAWAT simulation within GMS by importing an \nexisting SEAWAT simulation, running the simulation, and viewing the results . The first \nproblem  being solved in this tutorial is the salt l ake problem used in the SEAWAT \nmanual.2  \nThe design for the Hele -Shaw experiment is shown in [ Figure 1]. Uniform \nevaporation of pure water occurs along line segment AB, leaving behind a salt -\nsaturated fluid with a concentration of 110 grams per liter. Fluid with a potassium \nsulfate concentrati on of 84 grams per liter is injected at a constant head along \nsegment CD. The remaining boundaries are impermeable. To prevent the fingers \nfrom forming too rapidly, the clear plates were tilted at an angle ( \uf066) of 5 degrees \nfrom the horizontal. This tilt is  represented in SEAWAT -2000 by calculating input \nvariables (hydraulic conductivity and specific storage) with the component of \ngravity ( g) that is parallel with the plate ( g sin \uf066). [Figure 2] contains a list of the \ninput variables for the salt lake problem.3  \n                                                      \n1 SEAWAT: A Co mputer Program for Simulation of Three -Dimensional Variable -Density Ground -\nWater Flow and Transport . U.S. Geological Survey. October 7, 2015. \nhttp://water.usgs.gov/ogw/seawat/ . Accessed July 6, 2017.   (Archived by WebCite at \nhttp://www.webcitation.org/6ioGQwVBw ) \n2 Langevin, Christian D.; Shoemaker, W. Barclay; and Guo, Weixing (2003). MODFLOW -2000, the \nU.S. Geological Survey Modular Ground -Water Mod el\u2013Documentation of the SEAWAT -2000 \nVersion with the Variable -Density Flow Process (VDF) and the Integrated MT3DMS Transport \nProcess (IMT) : U.S. Geological Survey Open -File Report 03 -426, 43 p. \nhttp://fl.water.usgs.gov/PDF_files/ofr03_426_langevin.pdf.  \n3 Ibid, p. 24.  \nGMS Tutorials   SEAWAT \u2013 Hele-Shaw  Experiment  \n \n Page 3 of 8 \u00a9 Aquaveo 2024   \n      Figure 1      Flow model from SEAWAT manua l4  \n \n      Figure 2      Input parameters  and value s for Salt Lake Hele -Shaw experiment and SEAWAT \n2000 simulation5 \n                                                      \n4 Langevin, et al (2003), p. 25.  \n5 Ibid, p. 25.  \n\nGMS Tutorials   SEAWAT \u2013 Hele-Shaw  Experiment  \n \n Page 4 of 8 \u00a9 Aquaveo 2024  \u201cThe SEAWAT -2000 model was run for 24,000 seconds (400 minutes) using 60 \nsecond transport time steps. The variable -density flow equation was solved using \nthe PCG solver, and the implicit finite -difference method was used with the GCG \nPackage to solve the transport equation.\u201d6 \n2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare resto red to their default state.  \n2.1 Importing the existing model  \nStart with a SEAWAT model that has already been created.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cMODFLOW Name Files (*.mfn;*.nam)\u201d from the Files of type  drop-down.  \n3. Browse to the saltlake folder and select \u201c seawat.nam \u201d. \n4. Click Open to exit the Open  dialog and open the SEAWAT Translator  dialog.  \n5. Click OK to begin importing the model.   \nThe SEAWAT Translator  should run and end with a message saying that SEAWAT \nterminated successfully.  \n6. Click Done  to finish importing the file and close the SEAWAT Translator  dialog.  \nA grid should appear in the Main Graphics Window.  \n7. Switch to Front View . \n8. Frame   the project.  \nThe view of the grid should appear with symbols representing specified head boundary \ncondit ions ( Figure 3). SEAWAT uses a combination of MODFLOW and MT3DMS inputs; \nthe MODFLOW and MT3DMS portions of the SEAWAT inputs are edited in GMS through \nthe MODFLOW and MT3DMS interfaces, respectively. The SEAWAT interface includes \nthe inputs that are specific to SEAWAT.  \n                                                      \n6 Langevin, et al (2003), p. 28.  \n\nGMS Tutorials   SEAWAT \u2013 Hele-Shaw  Experiment  \n \n Page 5 of 8 \u00a9 Aquaveo 2024   \n      Figure 3      Front view of imported SEAWAT  model  \n3 The SEAWAT Model  \n3.1 Viewing the SEAWAT Inputs  \nNow to examine the inpu ts to the SEAWAT model:  \n1. Select SEAWAT | Global Options \u2026 to open the Global Options dialog.  \nNotice that this SEAWAT simulation includes transport and that Variable Density Flow \n(VDF)  is turned on.  \n2. Click OK to exit the Global Options  dialog.  \n3. Select SEAWAT | VDF Package \u2026 to open the SEAWAT VDF Package dialog.  \nThe VDF package controls how density is calculated by SEAWAT.  \n4. In the Fluid density calculation  section, notice that Fluid density calc \n(MT3DRHOFLG)  is set to \u201c1\u201d.  \nThis indicates that the concentration of \"species_1\" is used in the density calculations. \nReference fluid density (DENSREF)  is set to the value of the incoming fluid density \nshown in Figure 2. Density/conc. slope (DRHODC)  is set to the value of density change \nper concentration change shown in Figure 2.  \n5. Notice that Flow/transport coupling (NSWTCPL)  is set to \u201c1\u201d.  \nThis indicates that the flow and transport are explicitly coupled. Refer to the SEAWAT \ndocumentation for more information on how these inputs affect the SEAWAT model.7 \n6. Click OK to exit the SEAWAT VDF Package  dialog.  \n                                                      \n7 Langevin, Christian. D.; Thorne, Daniel T., Jr.; Dausman, Alyssa M.; Sukop, Michael C.; and Guo, \nWeixing.  (2007). \u201cSEAWAT Version 4: A Computer Program for Simulation of Multi -Species Solute \nand Heat Transport\u201d in U.S. Geological Survey Techniques and Methods  Book 6 , Chapter A22, p. \n13. https://pubs.usgs.gov/tm/tm6a22/pdf/tm6A22.pdf.  \n\nGMS Tutorials   SEAWAT \u2013 Hele-Shaw  Experiment  \n \n Page 6 of 8 \u00a9 Aquaveo 2024  3.2 Savin g and running  the model  \nNow to save the model with a new name and run the model:  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c Saltlake .gpr\u201d as the File name . \n4. Click Save  to sav e the project under the new name and close the Save As  \ndialog.  \n5. Select SEAWAT | Run SEAWAT \u2026 to bring up the SEAWAT  model wrapper \ndialog.  \n6. When the simulation is finished, turn on Read solution on exit  and Turn on \ncontours (if not on already) . \n7. Click Close to import the solution and close the SEAWAT  dialog.  \n4 Viewing the Solution  \nNow to view the results of the SEAWAT  model run :  \n1. Select \u201c  species_1 \u201d under \u201c  SaltLake (MT3DMS) \u201d in the Project Explorer.  \n2. Select time step 8 (it has a value of \u201c23215.0\u201d).  \nThe solution should appear similar to Figure 4. \n \n      Figure 4      SEAWAT solution  \nThe model results look very similar to the result from the real experiment ( Figure 5). \n\nGMS Tutorials   SEAWAT \u2013 Hele-Shaw  Experiment  \n \n Page 7 of 8 \u00a9 Aquaveo 2024   \n      Figure 5      Result from Hele -Shaw experiment of the Salt Lake problem at time step 23215s8 \nIf desire d, step through the other time steps of the solution.  \n4.1 Creating an Animation  \nNow to create an animation of the concentration over time:  \n1. Select  Display | Animate ... to bring up the Options  page of the Animation Wizard  \ndialog.  \nThe defaults should work fine for creating an animation.  \n1. Next to Animation file , click on the browser  to open the Save  dialog.  \n2. Enter \u201cseawat.mp4\u201d as the File name . \n3. Be certain that the Save as type  is set to \u201cAnimation file (*mp4, *avi)\u201d.  \n4. Select Save  to close the Save  dialog.  \n2. Click Next to go to the Dataset  page of the Animation Wizard  dialog.  \n3. Click Finish  to close the Animation Wizard  dialog and create the animation.  \nWhen the animation has  finished rendering, open an external animation application to \nview the file.  \nFeel free to chan ge the contour options or rerun SEAWAT with different options and \nanimate the results.  \n                                                      \n8 Langevin, et al (2003),  p. 26.  \n\nGMS Tutorials   SEAWAT \u2013 Hele-Shaw  Experiment  \n \n Page 8 of 8 \u00a9 Aquaveo 2024  5 Conclusion  \nThis concludes the \u201cMODFLOW \u2013 SEAWAT Hele -Shaw Experiment\u201d tutorial.  The \nfollowing key concepts were discussed and demonstrated in this tutorial:  \n\uf0b7 SEAWAT, com bining both MODFLOW and MT3D, can be used to solve variable \ndensity groundwater flow and solute transport equations.  \n\uf0b7 Import existing SEAWAT models into GMS easily.  \n\uf0b7 GMS has multiple options for viewing the results of a SEAWAT model run.  \n \n", "filename": "SEAWAT-HeleShawExperiment.pdf", "pages": 8}, "SEAWAT-ThermalEffects": {"text": "GMS Tutorials   SEAWAT \u2013 Thermal Effects  \n Page 1 of 11 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nSEAWAT  \u2013 Thermal Effects  \nExamine Thermal Effects on a SEAWAT Model  \nObjectives   \nThis tutorial demonstrates how to simulate thermal effects in SEAWAT . \n. \n \nPrerequisite Tutorials  \n\uf0b7 SEAWAT  \u2013 Conce ntration \nand Temperature Effects  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 MT3D  \n\uf0b7 SEAWAT  Time  \n\uf0b7 30\u201345 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   SEAWAT \u2013 Thermal Effects  \n Page 2 of 11 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 Importing the Existing Model ................................ ................................ .........................  3 \n2.2 Saving the Model with a New Name  ................................ ................................ .............  3 \n3 Heat Conduction  ................................ ................................ ................................ ..................  4 \n3.1 Editing the Dispersion Package  ................................ ................................ ....................  4 \n3.2 Saving and Running SEAWAT  ................................ ................................ .....................  5 \n3.3 Viewing the Solution  ................................ ................................ ................................ ..... 5 \n4 Thermal Equilibrium  ................................ ................................ ................................ ............  6 \n4.1 Saving the Model with a New Name  ................................ ................................ .............  6 \n4.2 Enabling the Chemical Reaction Package  ................................ ................................ .... 6 \n4.3 Editing the Chemical Reaction Package  ................................ ................................ ....... 6 \n4.4 Saving and Running SEAWAT  ................................ ................................ .....................  7 \n4.5 Viewing the Solution  ................................ ................................ ................................ ..... 7 \n5 Boundary Heat Conduction  ................................ ................................ ................................  8 \n5.1 Saving the Model with a New Name  ................................ ................................ .............  8 \n5.2 Modifying the Boundary Conditions  ................................ ................................ ..............  9 \n5.3 Saving and Running SEAWAT  ................................ ................................ ...................  10 \n5.4 Viewing the Solution  ................................ ................................ ................................ ... 10 \n6 Conclusion  ................................ ................................ ................................ .........................  10 \n \n1 Introduction  \nThis tutorial describes how to  simulate heat conduction, thermal equilibrium , and \nboundary heat conduction using SEAWAT. The example problem ( Figure 1) is very \nsimilar to the problem described in the SEAWAT documentation.1  \nThis is a confined aquifer with an initial temperature of 5\u02daC. Warm freshwater is injected \nfrom the west side of the model at 1 m3/day. The initial concentration of salt in the model \nis 35 kg/m3. \n \n      Figure 1      Site to be modeled with SEAWAT  \nThis tutorial discusses and demonstrates importing an existing MODFLOW/MT3D \nsimulation, running SEAWAT with different scenarios, and examining the results.  \n                                                      \n1 Langevin, Christian. D.; Thorne, Daniel T., Jr.; Dausman, Alyssa M.; Sukop, Michael C.; and Guo, \nWeixing. (2007). \u201cSEAWAT Version 4: A Com puter Program for Simulation of Multi -Species Solute \nand Heat Transport\u201d in U.S. Geological Survey Techniques and Methods  Book 6 , Chapter A22, p. \n13. https://pubs.usgs.gov/tm/tm6a22/pdf/tm6A22.pdf.  \n\nGMS Tutorials   SEAWAT \u2013 Thermal Effects  \n \n Page 3 of 11 \u00a9 Aquaveo 2024  2 Getting Started  \nDo the following t o get started:  \n1. If GMS is not running, launch GMS.  \n2. If GMS is already running, select File | New to ensure the program settings are \nrestored to the default state.  \n2.1 Importing the Existing Model  \nStart with a model that has already been created.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the Case_Studies \\Sample \\Case2 folder and select \u201c case2.gpr \u201d. \n4. Click Open  to import the project and exit the Open  dialog.  \n5. Select the \u201c  Head\u201d dataset to m ake it active.  \nA model similar to Figure 2 should appear.  \n \n      Figure 2      Initial model appearance  \n2.2 Saving the Model with a New Name  \nBefore making changes, save the model with a new name.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c case3 .gpr\u201d as the File name . \n4. Click Save  to save the project under the new name  and close the Save As  \ndialog.  \n\nGMS Tutorials   SEAWAT \u2013 Thermal Effects  \n \n Page 4 of 11 \u00a9 Aquaveo 2024  3 Heat Conduction  \nThe existing model simulates the effect of concentration and temperature on fluid density. \nHeat conduction is included in the simulation by specifying a value for bulk thermal \ndiffusivity (\ntempmD_ ). Calculate\ntempmD_  by using the following formula:  \nPfluidTbulk\ntempmckD\uf071\uf072\uf03d_\n (1) \nwhere \n\uf071  is the porosity, \n\uf072 is the reference fluid density, \nPfluidc  is the specific heat \ncapacity of the reference fluid,  and \nTbulkk  is the bulk thermal conductivity from solid (\nTsolidk\n) and fluid (\nTfluidk ) thermal conductivities. Estimate \nTbulkk  by using the following \nequation:  \nTsolid Tfluid Tbulk k k k ) 1(\uf071 \uf071 \uf02d\uf02b\uf03d\n (2) \nThe bulk thermal conductivity for a solid (calcite) is 3.59(1) (W/[m \u02daK]). The bulk thermal \nconductivity for a fluid (freshwater) is 0.58(1) (W/[m \u02daK]). The porosity in this model is 0.3. \nUsing equation (2), \nTbulkk  is estimated to b e around 2.69 (W/[m \u02daK]). \nThe specific heat capacity of freshwater (\nPfluidc ) is about 4186 (J/kg \u02daK). Freshwater \ndensity is about 1000 (kg/m3). Using equation (1), the bulk thermal diffusivity (\ntempmD_ ) \nis estimated to be arou nd 0.185 m2/day (2.14 x 10-6 m2/s). \n3.1 Editing the Dispersion Package  \nThe bulk thermal diffusivity (\ntempmD_ ) can be specified within the Dispersion Package \n(DSP input file).  \n1. Select MT3D MS | Dispersion Package\u2026  to open the Dispersion Package \ndialog . \n2. Turn on Specify DMCOEF for each species . \n3. Click on the  button in row 1 of the DMCOEF \u2013 Temperature column  of the \nspreadsheet (scroll to the right if necessary) to open the DMCOEF \u2013 Effective \nMolecular Diffusion Coefficient dialog . \n4. Click Constant \u2192 Grid to open the Grid Value  dialog.  \n5. Enter \u201c 0.185 \u201d as the Constant value for grid . \n6. Click OK to close the Grid Value  dialog . \n7. Click OK to exit the DMCOEF \u2013 Effective Molecular Diffusion Coefficient dialog . \nThe bulk thermal diffusivity of \u201c0.185\u201d has been assigned to all the cells in the model. \nNow assign the DMCOEF for Salt.  \n8. Click on the  button in row 1 of the DMCOEF \u2013 Salt column in the \nspreadsheet to open the DMCOEF \u2013 Effective Molecular Diffusion Coefficient \ndialog . \n9. Click Constant \u2192 Grid to open the Grid Value  dialog.  \n\nGMS Tutorials   SEAWAT \u2013 Thermal Effects  \n \n Page 5 of 11 \u00a9 Aquaveo 2024  10. Enter \u201c1e -10\u201d as the Constant value for grid . \n11. Click OK to close the Grid Value  dialog . \n12. Click OK to exit the DMCOEF \u2013 Effective Molecular Diffusion Coefficient dialog . \n13. Click OK to exit the Dispersion Package  dialog . \n3.2 Saving and Running SEAW AT \nNow to save the changes and run SEAWAT:  \n1. Save   the project.  \n2. Select SEAWAT | Run SEAWAT \u2026 to bring up the SEAWAT  model wrapper \ndialog.  \n3. When SEAWAT finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and close the SEAWAT  dialog.  \n3.3 Viewing the Solution  \nNow to view the results of the SEAWAT model run:  \n1. Fully expand the \u201c  3D Grid Data\u201d folder.  \n2. Select the \u201c  Salt\u201d dataset below the \u201c  case3 (MT3DMS) \u201d solution in the \nProject Explorer . \n3. Select time step 8 (it has a value of \u201c 4000.0 \u201d) in the time step window.  \nThe model should appear similar to Figure 3. \n \n      Figure 3      Salt dataset  \n4. Select the \u201c  Temperature \u201d dataset below the \u201c  case3 (MT3DMS) \u201d solution in \nthe Project Explorer . \nThe salinity and temperature fields no longer have the same shape. The temperature \nfield is much more diffuse than the salinity field ( Figure 4). Also notice that the contouring \noptions change when selecting either the \u201c Salt\u201d or \u201c Temperature \u201d datasets. This happens \nbecause display themes are being used. Please refer to the \u201cGMS \u2013 Display Themes\u201d \ntutorial for more details on how to use them.  \n\nGMS Tutorials   SEAWAT \u2013 Thermal Effects  \n \n Page 6 of 11 \u00a9 Aquaveo 2024   \n      Figure 4      Temperature dataset  \n4 Thermal Equilibrium  \nIn this scenario, simulate the thermal equilibrium effect between the fluid (freshwater ) and \nthe solid (calcite). This effect can be simulated using the MT3DMS Reactions (RCT) \nPackage.  \n4.1 Saving the Model with a New Name  \nNow it\u2019s time to start a new scenario. First, save the model with a new name.  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c case4 .gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n4.2 Enabling the Chemical Reaction Package  \nEnable the Chemical Reaction  Package  \n1. Select MT3D MS | Basic Transport Package \u2026 to open the Basic Transport \nPackage dialog.  \n2. Click Packages \u2026 to open the MT3DMS/RT3D Packages dialog.  \n3. Turn on Chemical reaction package . \n4. Click OK to exit the MT3DMS/RT3D Packages dialog.  \n5. Click OK to exit the  Basic Transport Package dialog.  \n4.3 Editing the Chemical Reaction Package  \nThe thermal equilibrium effect is activated only for the Temperature  species by entering \n1.7x10-4 [m3/kg] for K d_temp  (Distribution Coefficient \u2013 slope of the isotherm).  \n1. Select MT3D MS | Chemical Reaction Package \u2026 to open the Chemical \nReaction Package dialog . \n\nGMS Tutorials   SEAWAT \u2013 Thermal Effects  \n \n Page 7 of 11 \u00a9 Aquaveo 2024  2. Select \u201cLinear isotherm\u201d from the  Sorption  drop-down.  \n3. Change Variable Input  to Cell by cell . \n4. Click the Edit\u2026 button to the right of Bulk Density to open the Bulk Density Array \ndialog. \n5. Click Constant \u2192 Grid\u2026 to open the Grid Value dialog.  \n6. Enter \u201c1760.0\u201d as  the Constant value for grid . \n7. Click OK to close the Grid Value  dialog.  \n8. Click OK to exit the Bulk Density Array dialog.  \nThis sets t he Bulk density  to \u201c1760 .0\u201d. Note that these units actually represent [kg/m3]. \nThese units do not agree with the standard units for the model, but these units only need \nto agree with the K d (first sorption constant) units.  \n9. Click the Edit\u2026 button in the Temperature  column on the 1st sorption const.  row \nto open the First Sorption Constant Array  dialog.  \n10. Click Constant \u2192 Grid\u2026 to open the Grid Value  dialog.  \n11. Enter \u201c0 .00017 \u201d as the Constant value for grid .  \n12. Click OK to close the Grid Value  dialog.  \n13. Click OK to exit the First Sorption Constant Array  dialog.  \nThis sets the 1st sorption constant  to \u201c0.00017 \u201d (actual units = [m3/kg]).  \n14. Click OK to exit the Chemical Reaction Package  dialog.  \nNote that these two values should result in a retardation factor of \u201c 2.0\u201d. The retardation \nfactor is calculated using the following formula:  \nnKRd\uf072\uf02b\uf03d1\n \nWhere \uf072 = bulk density, Kd = distribution coefficient (slope of the isotherm), and n = \nporosity.  \n4.4 Saving and Running SEAWAT  \nNow it is possible to run SEAWAT.  \n1. Save   the project.  \n2. Select SEAWAT | Run SEAWAT \u2026 to bring up the SEAWAT  model wrapper \ndialog.  \n3. When SEAWAT finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and close the SEAWAT  dialog.  \n4.5 Viewing the Solution  \nNow view the results of the SEAWAT model run.  \n1. Select the \u201c  Temperature \u201d dataset below the \u201c  case4 (MT3DMS) \u201d solution in \nthe Project Explorer . \n\nGMS Tutorials   SEAWAT \u2013 Thermal Effects  \n \n Page 8 of 11 \u00a9 Aquaveo 2024  2. Select time step 8 (it has a value of \u201c 4000.0 \u201d) in the time step window.  \n3. Alternate between the \u201c  Temperature \u201d datasets in \u201c  case4 (MT3DMS) \u201d and \u201c\n case3 (MT3DMS) \u201d. \nNotice that the temperature front in \u201c case4 \u201d (Figure 5) is moving about half as fast as the \ntemperature front in \u201c case3 \u201d (Figure 6).  \n \n      Figure 5      Time step 8 after thermal equilibrium SEAWAT run  \n \n      Figure 6      Time step 8 after heat conduction SEAWAT run  \n5 Boundary Heat Conduction  \nNow, look at the effect of boundary heat conduction in this case. Heat conduction at a \nseawater boundary is simulated using the MT3DMS constant concentration boundary \ncondition (IT YPE = -1). This boundary condition allows advective and dispersive transport \nacross the boundary. Without a dispersive flux, there is no heat conduction. The \nconstant -head boundary (ITYPE = 1) does not allow dispersive transport to occur.  \n5.1 Saving the Model with a New Name  \nBefore making changes, save the model with a new name.  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c case5 .gpr\u201d as the File name . \n\nGMS Tutorials   SEAWAT \u2013 Thermal Effects  \n \n Page 9 of 11 \u00a9 Aquaveo 2024  4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n5.2 Modifying the Boundary Conditions  \nChange the boundary condition of all the cells in the rightmost column of the model.  \n1. Using the Select Cells  tool, select all the cells in the rightmos t column ( Figure \n7) by dragging a box around them.  \n \n      Figure 7     Select the rightmost column of cells in  the model  \n2. Select MT3DMS  | Point Sources/Sinks \u2026 to open the MODFLOW/MT3DMS \nSources/Sinks dialog.  \nFirst, adjust the constant head boundary condition and add a new boundary condition.  \n3. Select \u201cMT3DMS: Point SS\u201d from the list on the left.  \n4. Enter \u201c 0.0\u201d in the Temperature  column of the All row. \n5. Click Add BC . \nThis causes GMS to generate 50 additional rows corresponding to the 50 cells selected \non the east side of the model. Identify these new rows by the \u201c0.0\u201d value in the Salt \ncolumn.  \n6. For each of the 50 new rows, select \u201cconstant concentra tion\u201d from the Type \n(ITYPE)  drop-down. Each row must be entered individually.  \n7. For each of the 50 new rows, enter \u201c -1.0\u201d in the Salt column . Each row must be \nentered individually.  \nEntering \u201c -1.0\u201d in the Salt column with the \u201c constant concentration \u201d Type  inactivates Salt \nfor those rows.   \n8. For each of the 50 new rows, enter \u201c 5.0\u201d in the Temperature  column. Each row \nmust be entered individually.  \n9. Click OK button to exit the MODFLOW/MT3DMS Sources/Sinks  dialog.  \n10. Click anywhere outside the model to deselect the righ tmost cells.  \nThe heat boundary condition has been successfully set up for the model.  \n\nGMS Tutorials   SEAWAT \u2013 Thermal Effects  \n \n Page 10 of 11 \u00a9 Aquaveo 2024  5.3 Saving and Running SEAWAT  \nNow to save the changes and run SEAWAT:  \n1. Save   the project.  \n2. Select SEAWAT | Run SEAWAT \u2026 to bring up the SEAWAT  model wrapper \ndialog.  \n3. When SEAWAT finishes, turn on Read solution on exit  and Turn on contours (if \nnot already on) . \n4. Click Close  to import the solution and close the SEAWAT  dialog.  \n5.4 Viewing the Solution  \nView the results of the SEAWAT model run and compare the differences between the \nscenarios.  \n1. Select the \u201c  Temperature \u201d dataset below the \u201c  case5 (MT3DMS) \u201d solution in \nthe Project Explorer . \n2. In time step window, select the last time step.  \n3. Expand the \u201c  Display Themes\u201d folder and select \u201c  Temperature_24 \u201d. \nNotice the boundary heat co nduction has some effect on the temperature near the \nvertical ocean boundary ( Figure 8). In this example, the boundary heat conduction only \nslightly affects the simul ated salinity.  \n \n      Figure 8      Boundary heat conduction effect  \nFeel free to explore the various display themes with the \u201c  Salt\u201d and \u201c  Temperature\u201d \ndatasets.  \n6 Conclusion   \nThis concludes the \u201cSEAWAT \u2013 Thermal Effects Case Studies\u201d tutorial. The following key \nconcepts were discussed and demonstrated in this tutorial:  \n\uf0b7 SEAWAT combines MODFLOW and MT3DMS to solve variable density \ngroundwater flow and solute transport problems.  \n\nGMS Tutorials   SEAWAT \u2013 Thermal Effects  \n \n Page 11 of 11 \u00a9 Aquaveo 2024  \uf0b7 SEAWAT can simulate heat conduction.  \n\uf0b7 SEAWAT can sim ulate thermal equilibrium between a solid (aquifer) and a fluid.  \n\uf0b7 SEAWAT can simulate boundary heat conduction.  \n", "filename": "SEAWAT-ThermalEffects.pdf", "pages": 11}, "SEAWAT-ViscosityAndPressureEffects": {"text": "GMS Tutorials   SEAWAT \u2013 Viscosity and Pressure Effects  \n Page 1 of 8 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nSEAWAT  \u2013 Viscosity and Pressure Effects  \nExamine the Effects of Pressure on Fluid Density with SEAWAT  \nObjectives   \nThis tutorial demonstrates how to simulate the effects of viscosity and how pressure impacts the fluid \ndensity in SEAWAT . \n. \n \nPrerequisite Tutorials  \n\uf0b7 SEAWAT  \u2013 Thermal  Effects  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 MODFLOW Interface  \n\uf0b7 MT3D  \n\uf0b7 SEAWAT  Time  \n\uf0b7 15\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   SEAWAT \u2013 Viscosity and Pressure Effects  \n Page 2 of 8 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  3 \n2.1 Importing the Existing Model ................................ ................................ .........................  3 \n3 Adding the Effects on Fluid Viscosity  ................................ ................................ ...............  3 \n3.1 Modifying the VSC Package  ................................ ................................ .........................  3 \n3.2 Saving the Model with a New Name and Running SEAWAT  ................................ ........  5 \n3.3 Viewing the Solution  ................................ ................................ ................................ ..... 6 \n4 Adding the Effects of Pressure on Fluid Density ................................ ..............................  7 \n4.1 Saving the model with a new name  ................................ ................................ ..............  7 \n4.2 Modifying the VDF Package  ................................ ................................ .........................  7 \n4.3 Saving and running SEAWAT  ................................ ................................ .......................  8 \n4.4 Viewing the Solution  ................................ ................................ ................................ ..... 8 \n5 Conclusion  ................................ ................................ ................................ ...........................  8 \n \n1 Introduction  \nThis tu torial describes how to simulate the impact of concentration and temperature on \nfluid viscosity using SEAWAT . Then it examines the effects of pressure on fluid density.  \nThe problem is a confined aquifer with an initial temperature of 5\u02daC (Figure 1). Warm \nfreshwater is injected from the west side of the model at a 1 m3/day. The initial \nconcentration of salt in the model is 35 kg/m3. \nThe tutorial looks at the effects of salinity and temperature on viscosity, and the effects of \npressure on fluid density in this example. This example problem is very similar to the \nproblem descri bed in the SEAWAT documentation.1  \nThis tutorial will discuss and demonstrate importing an existing SEAWAT simulation, \nrunning SEAWAT with different scenarios, and examining the results.  \n \n      Figure 1      Site to be modeled wit h SEAWAT  \n                                                      \n1 Langevin, Christian. D.; Thorne, Daniel T., Jr.; Dausman, Alyssa M.; Sukop, Michael C.; and Guo, \nWeixing.  (2007). \u201cSEAWAT Version 4: A Computer Program for Simulation of Multi -Species Solute \nand Heat Transport\u201d in U.S. Geological Survey Techniques and Methods  Book 6 , Chapter A22, p. \n13. https://pu bs.usgs.gov/tm/tm6a22/pdf/tm6A22.pdf . \n\nGMS Tutorials   SEAWAT \u2013 Viscosity and Pressure Effects  \n \n Page 3 of 8 \u00a9 Aquaveo 2024  2 Getting Started  \nDo the following to get started:  \n1. If GMS is not running, launch GMS.  \n2. If GMS is already running, select File | New to ensure the program settings are \nrestored to the default state.  \n2.1 Importing the Existing Model  \nStart with a model that has already been created.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the Case_Studies \\Sample \\Case5 folder and select \u201c case5.gpr \u201d. \n4. Click Open  to import the project and exit the Open dialog.  \nThe model should appear similar to Figure 2. \n \n      Figure 2      Initial model appearance  \n3 Adding the Effects on Fluid Viscosity  \nUse the VSC package to simulate changes to the fluid viscosity.  \n1. Select SEAWAT | Global Options \u2026 to open the Global Options dialog.  \n2. Turn on  Viscosity  (VSC) . \n3. Click OK to exit the Global Options  dialog.  \n3.1  Modifying the VSC Package  \nFor the first scenario, simulate the effect of salinity on fluid viscosity in the simulation.  \n1. Select SEAWAT | VSC Package \u2026 to open the SEAWAT VSC Package dialog.  \n\nGMS Tutorials   SEAWAT \u2013 Viscosity and Pressure Effects  \n \n Page 4 of 8 \u00a9 Aquaveo 2024  2. Enter \u201c -1\u201d as the Fluid viscosity calc. ( MT3DMUFLG).  \nThis value means that the fluid viscosity will be calculated usin g one or more MT3DMS \nspecies. In this case, they are \u201c Salt\u201d and \u201c Temperature \u201d. \n3. Enter \u201c 0.0008904 \u201d as the Reference viscosity (VISCREF) . \n4. Select \u201c(1) eq. 18  A1*A2^[A3/(T+A4)]\u201d from the Temp. affect on visc. \n(MUTEMPOPT)  drop-down.  \n5. Enter \u201c 2\u201d as the Temp. specie s id (MTMUTEMPSPEC) . \nThe reference viscosity ( VISCREF ) is the viscosity of the reference fluid (warm \nfreshwater).  \nMUTEMPOPT  indicates which method (equation) is used to solve the fluid viscosity.  \nMTMUTEMPSPEC  indicates the temperature species. In this project, the temperature  \nspecies ID is \u201c2\u201d.  \n6. Turn on Use default values for A1 \u2013A5. \nThe default coefficients for this equation are specified according to SUTRA.2 These \ndefault values are only valid for temperature in Celsius. Notice that GMS automatically \nfills in the values.  \n7. Click Insert Row   to insert a species row into the spreadsheet.  \n8. Enter \u201c1\u201d in Species ID  column.  \nNotice that the Species Name  changed to \u201c Salt\u201d. \n9. Enter \u201c 1.923e -6\u201d in the DMUDC  column.  \n10. Enter \u201c0.0\u201d in the CMUREF column.  \nDMUDC  indicates the slope of the linear equation, which relates fluid viscosity to solute \nconcentration.  \nCMUREF  indicates the reference concentration for species. The entries sh ould match \nthose in Figure 3.  \n11. Click OK to exit the SEAWAT VSC Package  dialog.  \n                                                      \n2 Voss, Clifford I. (1984). A Finite -Element Simulation Model for Saturated -Unsaturated, Fluid -\nDensity -Dependent Ground -Water Flow with Energy Transport or Chemically -Reactive Single -\nSpecies Solute Transport : U.S. Geol ogical Survey Water -Resources Investigations Report 84 -\n4369, 407 p.  \n\nGMS Tutorials   SEAWAT \u2013 Viscosity and Pressure Effects  \n \n Page 5 of 8 \u00a9 Aquaveo 2024   \n      Figure 3      VSC Inputs  \n3.2 Saving the Mo del with a New Name and Running SEAWAT  \nNow to save changes and run SEAWAT:  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c case6 .gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n5. Select SEAWAT | Run SEAWAT  to bring up the SEAWAT  model wrapper dialog.  \n6. When SEAWAT finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n7. Click Close  to impor t the solution and close the SEAWAT  dialog.  \n\nGMS Tutorials   SEAWAT \u2013 Viscosity and Pressure Effects  \n \n Page 6 of 8 \u00a9 Aquaveo 2024  3.3 Viewing the Solution  \nNow to view the results of the SEAWAT model run:  \n1. Fully expand the \u201c  3 D Grid Data\u201d folder in the Project Explorer.  \n2. Select the \u201c  Salt\u201d dataset below the \u201c  case6 (MT3DMS) \u201d. \n3. Select time step  10 (it has a value of \u201c5000.0\u201d) in the time step window.  \nThe results from \u201c case6 \u201d (Figure 4) and \u201c case5\u201d  (Figure 5) are very similar. This suggests \nthat viscosity variation has minimal effect on the simulated salinity and temperature in this \ncase.  \nThe figures show salt concentration at 5000 days.  \n \n      Figure 4      Time step 10 in case 6  \n \n      Figure 5      Time step 10 in case 5  \n\nGMS Tutorials   SEAWAT \u2013 Viscosity and Pressure Effects  \n \n Page 7 of 8 \u00a9 Aquaveo 2024  4 Adding the Effects of Pressure on Fluid Density  \nFor the next scenario, look at how pressure affects the fluid density.  \n4.1 Saving the model with a new name  \nNow it is possible to start making changes for another scenario. First, save the model \nwith a new name.  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n3. Enter \u201c case7 .gpr\u201d as the File name . \n4. Click Save  to save the project under the new name and close the Save As  \ndialog.  \n4.2 Modifying the VDF Package  \nThe pressure effects can be activated using the DRHODPRHD  parameter.  \n1. Select SEAWAT | VDF Package \u2026 to open the SEAWAT VDF Package dialog.  \n2. Enter  \u201c0.00 446\u201d as the Density/press. slope (DRHODPRHD) . \n3. Enter \u201c0.0\u201d as the Reference press. head (PRHDREF) . \nThe VDF inputs should be the same as those in Figure 6. \n4. Click OK to exit the SEAWAT VDF Package  dialog.  \n \n      Figure 6      SEAWAT VDF Package dialog detail  \n\nGMS Tutorials   SEAWAT \u2013 Viscosity and Pressure Effects  \n \n Page 8 of 8 \u00a9 Aquaveo 2024  4.3 Saving and running SEAWAT  \nNow to save the changes and run SEAWAT:  \n1. Save   the project  \n2. Select SEAWAT | Run SEAWAT \u2026 to bring up the SEAWAT  dialog.  \n3. When SEAWAT finishes, turn on Read solution on exit  and Turn on contours (if \nnot on already) . \n4. Click Close  to import the solution and exit the SEAWAT  dialog.  \n4.4 Viewing the Solution  \nNow to view the results of the SEAWAT model ru n: \n1. Select the \u201c  Salt\u201d dataset below the \u201c  case7 (MT3DMS) \u201d solution.  \n2. Select time step 10 (value of \u201c5000.0\u201d) in the time step window.  \nThe compressibility of water due to pressure has very little effect on salinity and \ntemperature ( Figure 7) due to the shallow depth (500 m) of the aquifer in this case. The \neffect of pressure on fluid density is negligible for shallow aquifers.  \nFeel free to review and compare time step s for the \u201c  Salt\u201d and \u201c  Temperature\u201d \ndatasets in the various solutions.  \n \n      Figure 7      Time step 10 in case 7  \n5 Conclusion   \nThis concludes the \u201cSEAWAT Viscosity and Pressure Effects\u201d tutorial.  The following key \nconcepts were discussed and demonstrated in this tutorial:  \n\uf0b7 SEAWAT combines MODFLOW and MT3DMS to solve variable density \ngroundwater flow and solute transport problems.  \n\uf0b7 SEAWAT can simulate the effect of concentration and temperature on fluid \nviscosity.  \n\uf0b7 SEAWAT can si mulate the effect of pressure on fluid density.   \n \n\n", "filename": "SEAWAT-ViscosityAndPressureEffects.pdf", "pages": 8}, "SEEP2D-EarthDam": {"text": "GMS Tutorials   SEEP2D \u2013 Earth Dam  \n Page 1 of 11 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nSEEP2D \u2013 Earth Dam  \nUse SEEP2D to complete seepage through an earth dam  \nObjectives   \nThis tutorial will show how to use the SEEP2D interface in  GMS to compute seepage through an earth \ndam. The tutorial will use different material properties for the shell and core of the dam. It will also use the \nexit-face boundary condition on the downstream slope.  \n. \n \nPrerequisite Tutorials  \n\uf0b7 Feature Objects  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 SEEP2D  Time  \n\uf0b7 25\u201340 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   SEEP2D \u2013 Earth Dam  \n Page 2 of 11 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Setup  ................................ ................................ ................................ ................................ ..... 2 \n2.1 Program Mode  ................................ ................................ ................................ ..............  2 \n2.2 Getting Started  ................................ ................................ ................................ ..............  3 \n2.3 Settin g the Units  ................................ ................................ ................................ ...........  3 \n2.4 Saving the Project  ................................ ................................ ................................ .........  4 \n3 Creating the Conceptual Model Features  ................................ ................................ ..........  4 \n3.1 Defining a Coordinate System  ................................ ................................ ......................  4 \n3.2 Creating the Corner Points  ................................ ................................ ...........................  5 \n3.3 Creating the Arcs  ................................ ................................ ................................ ..........  5 \n3.4 Creating the Polygons  ................................ ................................ ................................ .. 6 \n3.5 Assigning the Material Properties and Zones  ................................ ...............................  6 \n4 Assigning Boundary Conditions  ................................ ................................ ........................  7 \n4.1 Specified -Head Boundary Conditions  ................................ ................................ ...........  7 \n4.2 Exit-Face Boundary Conditions  ................................ ................................ ....................  8 \n4.3 Building the Finite Element Mesh  ................................ ................................ .................  8 \n5 Setting the Analysis Options  ................................ ................................ ............................  10 \n6 Running SEEP2D  ................................ ................................ ................................ ...............  10 \n7 Viewing the Solution  ................................ ................................ ................................ .........  11 \n8 Conclusion  ................................ ................................ ................................ .........................  11 \n \n1 Introduction  \nThis tutorial describes the steps involved in performing a SEEP2D simulation for an earth \ndam with an unsaturated zone.  \nThe problem in this tutorial is shown in Figure 1. The problem consists of an earth dam \nwith anisotropic soil and a low permeability core in the interior.  \n \n110 m 18 m  \n17 m  8 m \n22 m \nCore  Shell  Shell  \n  kx = 46 m/yr \n  ky = 18 m/yr \nCore  \n  kx = 4.5 m/yr \n  ky = 1.8 m/yr \n2 m 18 m \n \n      Figure 1      Earth dam problem   \nThis tutorial will discuss and demonstrate creating a SEEP2D conceptual model, \nmapping the model to a 2D mesh, defining conditions for both a saturated and \nunsaturated zone, converting the model to SEEP2D, and running  SEEP2D.  \n2 Setup  \n2.1 Program Mode  \nThe GMS interface can be modified by selecting a Program Mode . When GMS is first \ninstalled and runs, it is in the standard or \u201cGMS\u201d mode, which provides access to the \ncomplete GMS interface, including all of the MODFLOW tools. T he \u201cGMS 2D\u201d mode \nGMS Tutorials   SEEP2D \u2013 Earth Dam  \n \n Page 3 of 11 \u00a9 Aquaveo 2024  provides a greatly simplified interface to the SEEP2D code. This mode hides all of the \ntools and menu commands not related to SEEP2D. This tutorial can only be completed in \nthe GMS 2D mode.  \nOnce the mode is changed, GMS can be exited and restarted repeatedly and the \ninterface stays in the same mode until changed. Thus, it\u2019s only necessary to change the \nmode once if intending to repeatedly solve SEEP2D problems. If already in GMS 2D \nmode, skip ahead to the Getting Started  section. If not already in GMS 2D mode, do the \nfollowing:   \n1. Launch GMS.  \n2. Select Edit | Preferences \u2026 to bring up the Preferences  dialog.  \n3. Select \u201c Program Mode \u201d from the list on the left.  \n4. Select \u201cGMS 2D\u201d from the Program Mode  drop-down.  \n5. Click OK to close the Preferences  dialog.  \n6. Click Yes in response to the warning about all data being deleted. After a \nmoment, the New Project  dialog will appear.  \n7. Click OK to close the New Project  dialog.  \n8. Select File | Exit to exit GMS.  \n2.2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \nThe New Project  dialog will ap pear. This dialog is used to set up a GMS conceptual \nmodel. A conceptual model is organized into a set of layers or groups called \u201c coverages \u201d. \nGMS 2D allows quickly and easily defining all of the coverages needed for the conceptual \nmodel using the New Proj ect dialog. Most of the options seen in the window are related \nto UTEXAS. For SEEP2D models, the only coverage needed is the Profile lines  \ncoverage. This allows defining the geometry of the mesh, the boundary conditions, and \nthe material zones.  \n3. Select Crea te a new project  and enter \u201c Earth Dam Model \u201d as the Conceptual \nmodel name . \n4. In the Numerical models  section, turn off UTEXAS  and make certain SEEP2D  is \nturned on.  \n5. In the Create coverages  section, select only Profile lines . \n6. Click OK to close the New Project  dialog.  \nA new \u201c  Earth Dam Model \u201d conceptual model should appear in the Project Explorer.  \n2.3 Setting the Units  \nBefore continuing, it is necessary to establish the units to be used. GMS will display the \nappropriate units label next to each of the input fields  as a reminder to be consistent.  \n1. Select Edit | Units\u2026  to open the Units dialog . \n2. Click the  button to the right of Length  to open  the Display Projection  dialog.  \n\nGMS Tutorials   SEEP2D \u2013 Earth Dam  \n \n Page 4 of 11 \u00a9 Aquaveo 2024  3. In both the Horizontal  and Vertical  sections, select \u201cM eters \u201d from the Units  drop-\ndown.  \n4. Click OK to close the Display Projection  dialog  \n5. Select \u201cyr\u201d from the Time  drop-down . \n6. Select \u201ckg\u201d from the Mass  drop-down . \n7. Select \u201cN\u201d from the Force  drop-down . \n8. Click  OK to close the Units dialog . \n2.4 Saving the Project  \nBefore continuing, it is necessary to save the p roject to a GMS project file.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Browse to the s2unc \\s2unc  directory.  \n3. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n4. Enter \u201c s2uncon .gpr\u201d as the File name . \n5. Click Save  to create the project file and close the Save As  dialog.  \nIt is recommended to use the Save   macro frequently while working on any project.  \n3 Creating the Conceptual Model Features  \nThe first step in setting up the problem is to create the GIS features defin ing the problem \ngeometry. This process starts with entering a set of points corresponding to the key \nlocations in the geometry. Then connect the points with lines called \u201carcs\u201d to define the \noutline of the problem. Next, convert the arcs to a closed polygo n defining the problem \ndomain. Once this is complete, the arcs and the polygon will be used to build the finite \nelement mesh and define the boundary conditions to the problem.  \n3.1 Defining a Coordinate System  \nBefore constructing the conceptual model features, first establish a coordinate system. \nThe tutorial will use a coordinate system with the origin at the lower left corner of the dam \nas shown in Figure 2. \n \n      Figure 2      Coordinate system  \nx \ny \n(0,0) \n(46,0)  \n (63,0)  \n(51,18)  \n (59,18)  \n(42,18)  \n(51,22)  \n(59,22)  \n(105,2)  \n(110,0)  \nGMS Tutorials   SEEP2D \u2013 Earth Dam  \n \n Page 5 of 11 \u00a9 Aquaveo 2024  3.2 Creating the Corner Points  \nWith the units set, it is now possible to create some points at key corner locations. These \npoints will then be used to guide the construction of a set of arcs defining the model \nboundary. If desired, create points one at a time using the Create Points   tool, but it is \nusually easier to enter the point coordinates in a spreadsheet.  \n1. Right -click on the \u201c  Profile lines \u201d coverage in the Project \nExplorer  and select Attribute Table\u2026  to open the Attribute \nTable dialog.  \n2. Enter the coordinates as in the spreadsheet to the right.  \n3. Click OK to exit the Attribute Table dialog.  \n4. Click Display Options   to bring up the Display Options  \ndialog.  \n5. Select \u201cMap Data\u201d from t he list on the left.  \n6. Turn on Labels  to the right of Points . \n7. Click OK to close the Display Options  dialog.  \n8. Click  Frame  Image   to center the view on the new points \n(Figure 3). \nThe node coordinates can be edited using the Select Points/Nodes   tool. If needed, \nselect the desired point and change the coordinates using the XYZ edit fields at the top of \nthe Graphics Window. Extra points can be deleted by selecting them and pressing the \nDelete  key on the keyboard (or selecting Edit | Delete ). \n \n      Figure 3      Points created in the profile lines cover age \n3.3 Creating the Arcs  \nNow that the corner nodes are created, it is possible to create the arcs defining the \nboundaries of both the shell and the core of the dam. This can be accomplished as \nfollows:  \n1. Select the \u201c Profile lines \u201d coverage to make it active.  \n2. Using  the Create Arc   tool, create a connected series of arcs around the \nperimeter of the dam by clicking on the following points in order: A \u2013B\u2013C\u2013D\u2013I\u2013J\u2013\nH\u2013G\u2013A. As the points are changed to nodes (with the creation of the arcs), the \nlabel for each point wil l disappear.  \n3. Create the remaining arcs around the core boundary by clicking on t he following \npoints in order : G\u2013E\u2013F\u2013H. The arc between H and G was created in step 2, and \ntherefore does not need to be created again.  \nPoint \nName  X Y \nA 0 0 \nB 42 18 \nC 51 22 \nD 59 22 \nE 51 18 \nF 59 18 \nG 46 0 \nH 63 0 \nI 105 2 \nJ 110 0 \nGMS Tutorials   SEEP2D \u2013 Earth Dam  \n \n Page 6 of 11 \u00a9 Aquaveo 2024  3.4 Creating the Polygons  \nNow that the arcs a re created, it is necessary to use the arcs to build polygons \nrepresenting the regions enclosed by the arcs. Then use the polygons to assign the \nmaterial zones. To build the polygon, do the following:  \n1. Select Feature Objects | Build Polygons . \nThe polygons will have a gray background ( Figure 4). \n \n      Figure 4      Polygons with a gray background  \n3.5 Assigning the Material Properties and Zones  \nThe next step is to assign the material properties and zones. This is done by creating a \nmaterial for each of the two zones in the problem and giving each material a unique \nname, color, and set of hydraulic properties.  \n1. Click Materials   to bring up the Materia ls dialog.  \n2. Rename \u201cmaterial_1\u201d to \u201c Shell \u201d in the Name  column of the spreadsheet.  \n3. In the Color/Pattern  column in row 1, click the down arrow to the right of the wide \ncolor button and select \u201clight orange\u201d from the list of swatches.  \n4. On row 1: \n\uf0b7 Enter \u201c46\u201d in t he k1 column.  \n\uf0b7 Enter \u201c18\u201d in the  k2 column . \n\uf0b7 Enter \u201c -0.3\u201d in the Sat/Unsat linear front ho  column.  \n\uf0b7 Enter \u201c0.001\u201d in the Sat Unsat linear front kro  column.  \n5. Create a new material by entering \u201cCore\u201d in the Name  column of the blank row \n(marked with a \u201c*\u201d) at the bottom of the spreadsheet. The row is now numbered \n\u201c2\u201d. \n6. In the Color/Pattern  column in row 2, select \u201cpale green\u201d from the list of \nswatches.  \n7. On row 2: \n\uf0b7 Enter \u201c4.6\u201d in the k1 column.  \n\uf0b7 Enter \u201c1.8\u201d in the k2 column.  \n\uf0b7 Enter \u201c -1.2\u201d in the Sat/Unsat linear front ho  column.  \n\uf0b7 Enter \u201c0.001\u201d in the Sat Unsat linear front kro  column.  \n8. Click OK to close the Materials  dialog.  \nNote that both polygons are currently associated with the \u201cShell\u201d material ( Figure 5). \nChange the material assigned to the core polygon to the new \u201cCore\u201d material.  \n\nGMS Tutorials   SEEP2D \u2013 Earth Dam  \n \n Page 7 of 11 \u00a9 Aquaveo 2024   \n      Figure 5      Both polygons are the same material  \n9. Using  the Select Po lygons   tool, double -click inside the core polygon  to bring \nup the Attribute Table  dialog . \n10. In the Material  column of the spreadsheet, select \u201c Core \u201d from the drop -down.  \n11. Click  OK to close the Attribute Table  dialog . \n12. Click anywhere outside the polygons i n the Graphics Window  to unselect the \npolygon.   \nThe \u201cCore\u201d is now colored to reflect the materials assignment ( Figure 6). \n \n      Figure 6      Showing the different material assignments  \n4 Assigning Boundary Conditions  \nThe next step in defining the model is to assign boundary conditions to the conceptual \nmodel. For the problem being modeled, there are three types of boundary conditions: no -\nflow bo undary (flow is parallel to the boundary), specified -head boundary, and exit -face \nboundary. Boundaries without an explicit condition are no -flow by default. This type is not \ncovered in detail in this tutorial.  \n4.1 Specified -Head Boundary Conditions  \nTo enter th e specified -head boundary conditions, do the following:  \n1. Using the Select Arcs   tool, double -click on the A \u2013B arc on the left side \n(Figure 7) to bring up the Attribute Table dialog.  \n2. In the Type  column in the spreadsheet, select \u201c head \u201d from the drop -down.  \n3. Enter \u201c 18.0\u201d in the Head  (m) column.  \n4. Click OK to close the Attribute Table dialog.  \n5. Repeat steps 1 \u20134 with the I \u2013J arc on the lower right side ( Figure 7), entering \n\u201c2.0\u201d in the Head  (m) column.  \n6. Click anywhere outside of the polygons to unselect  the arc.  \nThe arcs will now be blue, indicating they have specified -head boundary conditions \n(Figure 7). \n\nGMS Tutorials   SEEP2D \u2013 Earth Dam  \n \n Page 8 of 11 \u00a9 Aquaveo 2024   \nFigure 7      Specified -head boundaries  \n4.2 Exit-Face Boundary Conditions  \nThe remaining boundary condition is an exit face. Since the project is modeling an \nunconfined condition, SEEP2D will iterate to find the location of the phreatic surface. To \nguide the iteration pr ocess, it is good to mark all of the nodes on the mesh where the \nphreatic surface may exit as exit -face nodes.  \nDo the following to define the exit -face boundary conditions:  \n1. Using the Select Arcs  tool, double -click on the D \u2013I arc on the upper right \n(Figure 8) to bring up the Attribute Table dialog.  \n2. In the Type  column in the spreadsheet, select \u201cexit face\u201d from the drop -down.  \n3. Click OK to exit the Attribute Table dialog.  \n4. Click anywhere outside the polygons to unselect the arc.  \nThe arc will now be red, indicating it has an exit face boundary condition ( Figure 8). \n \n      Figure 8      Exit-face boundary  \n4.3 Building the Finite Element Mesh  \nIt is now possible to build the finite element mesh used by SEEP2D. The mesh is \nautomatically constructed from arcs and polygons in the conceptual model. The arcs are  \ncomposed of both nodes and vertices. The nodes are the two end points of the arc. The \nvertices are intermediate points between the nodes. The gaps between vertices are \ncalled edges.  \nAt this point, all of the arcs have one edge and zero vertices. When map ping to a 2D \nmesh, the density of the elements in the interior of the mesh is controlled by the edge \nspacing along the arcs. Thus, it is necessary to subdivide the arcs to create appropriately \nsized edges.  \n1. Using  the Select Arcs   tool, select all of the ar cs by dragging a box that \nencloses all of the arcs.  \n2. Select Feature Objects | Redistribute Vertices\u2026  to bring up the Redistribute \nVertices  dialog . \n3. Select \u201c Specified spacing \u201d from the Specify  drop-down . \n4. Enter \u201c2.5\u201d for the Average spacing . \nD\u2013I arc A\u2013B arc  \nI\u2013J arc  \nGMS Tutorials   SEEP2D \u2013 Earth Dam  \n \n Page 9 of 11 \u00a9 Aquaveo 2024  5. Click  OK to close the Redistribute Vertices  dialog . \n6. Switch to the Select Vertices   tool. \nNotice the vertex spacing ( Figure 9). The vertices are turned off by default but beco me \nvisible when the Select Vertices   tool is active.  \n \n      Figure 9      Evenly -spaced vertices  \nTo make the vertices always visible, do the following:  \n7. Click Display Options   to bring up the Display Options  dialog.  \n8. Select \u201cMap Data\u201d from the list on the left.  \n9. On the Map tab, turn on Vertices  and click OK to close the Display Options  \ndialog.  \nIn this particular problem, most of the head loss will occur in the core of the dam. To \nmore accurately model the core, it is necessary to m ake the mesh denser in the core of \nthe dam.  \n10. Using  the Select Arcs   tool, hold down the Shift key and s elect the arcs that \nmake up the core of the dam (G \u2013E, E\u2013F, F\u2013H, H\u2013G).  \n11. Select Feature Objects | Redistribute Vertices \u2026 to bring up the Redistribute \nVertices  dialog . \n12. Select \u201c Specified spacing \u201d from the Specify  drop-down . \n13. Enter \u201c1.0\u201d for the Average spacing . \n14. Click  OK to close the Redistribute Vertices  dialog . \nAt this point, it is possible to construct the mesh.  \n15. Click the Map \u2192 2D Mesh   macro  at the top  of the GMS window (or select \nFeature Objects | Map \u2192 2D Mesh ) to create the 2D mesh ( Figure 10). \n \n      Figure 10      The 2D mesh has been created  \nFinally, convert the conceptual model to the SEEP2D numerical model. This will assign \nall of the boundary condit ions defined on the feature objects to the node -based boundary \nconditions required by SEEP2D.  \n16. Click the Map \u2192 SEEP2D   macro at the top of the GMS window (or select \nFeature Objects | Map \u2192 SEEP2D ). \nA set of blue and red symbols should appear indicating tha t the boundary conditions have \nbeen assigned ( Figure 11). \n\nGMS Tutorials   SEEP2D \u2013 Earth Dam  \n \n Page 10 of 11 \u00a9 Aquaveo 2024   \n      Figure 11      SEEP2D boundary conditions assigned  \n5 Setting the Analysis Opti ons \nBefore running the model, it is necessary to adjust the analysis options.  \n1. Save the model by clicking the Save   macro.  \n2. Select SEEP2D | Analysis Options \u2026 to open the SEEP2D Analysis Options \ndialog . \n3. Enter \u201c9810.0\u201d as the Unit weight of wate r. The current  units are N/m^3.  \nTwo methods are provided in SEEP2D for computing the relative conductivity in the \nunsaturated zone: the linear front method and the Van Genuchten  method. With the \nlinear front method, the relative conductivity varies linearly from the saturated value down \nto a user -specified minimum at a given negative pressure head. With the Van Genuchten \nmethod, the Van Genuchten parameters are used to define the  variation of the relative \nconductivity in the unsaturated zone. Both methods are described in detail in the \n\u201cSEEP2D Primer \u201d. For this tutorial, use the linear front option.  \n4. In the Model type  section, select Saturated/Unsaturated with linear front . \n5. Click  OK to exit the SEEP2D Analysis Options dialog . \n6 Running SEEP2D  \nIt is now possible to run SEEP2D. Before running SEEP2D, it is important to make sure \nall of the changes have been saved:  \n1. Click Save  . \n2. Click the Run SEEP2D   macro (or select SEEP2D  | Run SEEP2D ) to bring up \nthe Seep2d  model wrapper dialog.  \n3. When the solution is finished, turn on Read solution on exit  and click Close  to \nclose the Seep2d model wrapper dialog.  \nGMS will automatically import the SEEP2D solution when this dialog is closed. A set of \ncontour lines will also appear on the model of the dam ( Figure 12). \n \n      Figure 12      Contour lines after SEEP2D model run  \n\nGMS Tutorials   SEEP2D \u2013 Earth Dam  \n \n Page 11 of 11 \u00a9 Aquaveo 2024  7 Viewing the Solution  \nA plot of the flow net should now be visible. To better view the flow net, it is possible to \nturn off the display of nodes and elements.  \n1. Click Display Options   to bring up the Display Options  dialog.  \n2. Select \u201c  2D Mesh Data \u201d from the list on the l eft. \n3. On the 2D Mesh  tab, turn off Nodes  and Element  edges  and turn on Mesh \nboundary . \n4. Click OK to close the Display Options  dialog.  \nNote that there are only a small number of flow lines ( Figure 13). GMS determines the \nnumber of flow lines to display based on how closely spaced the equipotential lines are in \none of the materials. By default, the interval is computed based on the \u201cShell\u201d material.  \n \n      Figure 13      Less cluttered view with nodes and elements off and mesh on  \nTo base the number of flow lines on the Core material, do the following:  \n5. Click Display Options   to bring up the Display Options  dialog.  \n6. Select \u201c  2D Mesh Data \u201d from the list on the left.  \n7. On the SEEP2D  tab, select \u201cCore\u201d from the Base Material drop-down . \n8. Make sure Phreatic surface  is turned on.  \n9. Click OK to close the Display Options  dialog.  \nFlow lines are now visible through the model as well as the phreatic surface ( Figure 14). \n \n      Figure 14      Flow lines and phreatic surface visible  \n8 Conclusion  \nThis concludes the \u201cSEEP2D \u2013 Earth Dam\u201d tutorial. The follow ing topics were discussed \nand demonstrated:  \n\uf0b7 SEEP2D can perform 2D unconfined flow modeling.  \n\uf0b7 SEEP2D problems can be set up quickly and easily using the conceptual model \napproach.  \n\uf0b7 Display a flow net and the phreatic surface in GMS.  \n \n\n", "filename": "SEEP2D-EarthDam.pdf", "pages": 11}, "SEEP2D-SheetPile": {"text": "GMS Tutorials   SEEP2D  \u2013 Sheet Pile  \n Page 1 of 12 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nSEEP2D \u2013 Sheet Pile  \nUse SEEP2D to create a flow net around a sheet pile  \nObjectives   \nThis tutorial shows how to set up and solve a seepage problem involving flow around a sheet pile using \nthe SEEP2D interface in GMS . \n. \n \nPrerequisite Tutorials  \n\uf0b7 Feature Objects  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 SEEP2D  Time  \n\uf0b7 30\u201345 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   SEEP2D  \u2013 Sheet Pile  \n Page 2 of 12 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Setup  ................................ ................................ ................................ ................................ ..... 3 \n2.1 Program Mode  ................................ ................................ ................................ ..............  3 \n2.2 Getting Started  ................................ ................................ ................................ ..............  3 \n2.3 Setting the Units  ................................ ................................ ................................ ...........  4 \n2.4 Saving the Project  ................................ ................................ ................................ .........  4 \n3 Creating the Conceptual Model Features  ................................ ................................ ..........  4 \n3.1 Defining a Coordinate System  ................................ ................................ ......................  4 \n3.2 Creating the Corner Points  ................................ ................................ ...........................  5 \n3.3 Creating the Arcs  ................................ ................................ ................................ ..........  6 \n3.4 Creating the Polygons  ................................ ................................ ................................ .. 7 \n3.5 Assigning the Material Properties and Zones  ................................ ...............................  8 \n4 Assigning Boundary Conditions  ................................ ................................ ........................  9 \n4.1 Constant -Head Boundaries  ................................ ................................ ..........................  9 \n4.2 Building the Finite -Element Mesh  ................................ ................................ ...............  10 \n5 Running SEEP2D  ................................ ................................ ................................ ...............  11 \n6 Conclusion  ................................ ................................ ................................ .........................  12 \n \n1 Introduction  \nSEEP2D  is a 2D, finite -element, steady -state flow model. It is typically used for profile \nmodels (i.e., cross -section models representing a vertical slice through a flow system that \nis symmetric in the third dimension). Examples of profile models include earth d ams, \nlevees, sheet piles, etc.  \nThe problem in this tutorial involves a partially penetrating sheet pile wall with an \nimpervious clay blanket on the upstream side ( Figure 1). The sheet pile is driven into a \nsilty sand deposit underlain by bedrock at a depth of 10 meters.  \nKx = Ky = 30 m/yr10 m\n30 m 20 m3 m10 m3 m\n \n      Figure 1      Confined flow problem  \nFrom a SEEP2D viewpoint, this problem is a \u201cconfined\u201d pr oblem. For SEEP2D, a problem \nis confined if it is completely saturated. A problem is unconfined if it is partially saturated.  \nThis tutorial discusses and demonstrates c reating a SEEP2D c onceptual model, m apping \nthe model to a 2D mesh, r unning SEEP2D , and v iewing the solution.  \nGMS Tutorials   SEEP2D  \u2013 Sheet Pile  \n \n Page 3 of 12 \u00a9 Aquaveo 2024  2 Setup  \n2.1 Program Mode  \nThe GMS interface can be modified by selecting a Program Mode . When GMS is first \ninstalled and runs, it is in the standard or \u201cGMS\u201d mode, which provides access to the \ncomplete GMS interface, including all of the MODFLOW tools. The \u201cGMS 2D\u201d mode \nprovides a greatly simplified interface to the SEEP2D code. This mode hi des all of the \ntools and menu commands not related to SEEP2D. This tutorial can only be completed in \nthe GMS 2D mode.  \nOnce the mode is changed, GMS can be exited and restarted repeatedly and the \ninterface stays in the same mode until changed. Thus, it\u2019s o nly necessary to change the \nmode once if intending to repeatedly solve SEEP2D problems. If already in GMS 2D \nmode, skip ahead to the Getting Started  section. If not a lready in GMS 2D mode, do the \nfollowing:   \n1. Launch GMS.  \n2. Select Edit | Preferences \u2026 to bring up the Preferences  dialog.  \n3. Select \u201c Program Mode \u201d from the list on the left.  \n4. Select \u201cGMS 2D\u201d from the Program Mode  drop-down.  \n5. Click OK to close the Preferences  dialog.  \n6. Click Yes in response to the warning about all data being deleted. After a \nmoment, the New Project  dialog will appear.  \n7. Click OK to close the New Project  dialog.  \n8. Select File | Exit to exit GMS.  \n2.2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \nThe New Project  dialog will appear. This dialog is used to set up a GMS conceptual \nmodel. A conceptual model is orga nized into a set of layers or groups called \u201c coverages \u201d. \nGMS 2D allows quickly and easily defining all of the coverages needed for the conceptual \nmodel using the New Project  dialog. Most of the options seen in the window are related \nto UTEXAS.  \nFor SEEP2D models, the only coverage needed is the Profile lines  coverage. This allows \ndefining the geometry of the mesh, the boundary conditions, and the material zones.  \n3. Select Create a new project  and enter \u201cSheetpile  Model \u201d as the Conceptual \nmodel name . \n4. In the Num erical models  section, turn off UTEXAS  and make certain that \nSEEP2D  is turned on . \n5. In the Create coverages  section, select only Profile lines . \n6. Click OK to close the New Project  dialog.  \nGMS Tutorials   SEEP2D  \u2013 Sheet Pile  \n \n Page 4 of 12 \u00a9 Aquaveo 2024  A new \u201c  Sheetpile  Model \u201d conceptual model object should appear in the P roject \nExplorer.  \n2.3 Setting the Units  \nBefore continuing, it is necessary to establish the units to be used. GMS will display the \nappropriate unit label next to each of the input fields as a reminder to be consistent.  \n1. Select Edit | Units\u2026  to open the Units dialog . \n2. Click the  button to the right of Length  to bring up the Display Projection  \ndialog.  \n3. In both the Horizontal  and Vertical  sections, select \u201cM eters \u201d from the Units  drop-\ndown.  \n4. Click OK to close the Display Projection  dialog  \n5. Select \u201cyr\u201d from the Time  drop-down . \n6. Select \u201ckg\u201d from the Mass  drop-down . \n7. Click  OK to close the Units dialog . \n2.4 Saving the Project  \nBefore continuing, it is best to save the project to a GMS project file.  \n1. Select File | Save As\u2026  to bring up the Save As  dialog.  \n2. Browse to the s2con \\s2con \\ directory.  \n3. Select \u201cProject Files (*.gpr)\u201d from the Save as type  drop-down.  \n4. Enter \u201cs2 con.gpr\u201d as the File name . \n5. Click Save  to create the project file and close the Save As  dialog.  \nIt is recommended to use the Save   macro frequently while working on any project.  \n3 Creating the Conceptual Model Features  \nThe first step in setting up the problem is to create the GIS features defining the problem \ngeometry. The tutorial will begin by entering a set of points corresponding t o the key \nlocations in the geometry. Then the points will be connected with lines called \u201carcs\u201d to \ndefine the outline of the problem. The next step is to convert the arcs to a closed polygon \ndefining the problem domain. Once this is complete, the arcs and the polygon can be \nused to build the finite element mesh and define the boundary conditions to the problem.  \n3.1 Defining a Coordinate System  \nBefore constructing the conceptual model features, it is first necessary to establish a \ncoordinate system. This tutoria l will use a coordinate system with the origin 30 meters \nupstream of the sheet pile at the top of the bedrock as shown in Figure 2. \n\nGMS Tutorials   SEEP2D  \u2013 Sheet Pile  \n \n Page 5 of 12 \u00a9 Aquaveo 2024  \n(0, 10)\n(0, 0)(20, 10)(30, 10)\n(30, 7)(50, 10)\n(50, 0) \n      Figure 2      Coordinate system  \n3.2 Creating the Corner Points  \nIt is now possible to create some points at key corner locations. These points will then be \nused to guide the construction of a set of arcs defining the model boundar y. \n1. Right -click on the \u201c  Profile lines \u201d coverage in the \nProject Explorer  and select Attribute Table\u2026  to open \nthe Attribute Table dialog.  \n2. Change the Feature type  to \u201cPoints\u201d.  \n3. Enter into the spreadsheet the X and Y coordinates \nfrom the table to the right. The names of the points will \nbe automati cally generated by GMS as the \ncoordinates are entered for each.  \n4. Click OK to exit the Attribute Table dialog.  \n5. Click  Frame  Image   to center the view on the new \npoints ( Figure 3). \nThe points at 30, 10 and at 30.3, 10 have been entered in order to model the sheet pile, \nwhich is about 0.3 m thick. If the coordinates of an individual point need to be edited, use \nthe Select Points/Nodes  tool and double -click on the desired node to bring up the \nAttribute Table dialog for that point. Points can be deleted by selecting the desired points \nand pressing the Delete  key on the keyboard or by selecting Edit | Delete . \n \n      Figure 3      Points created in the profile lines coverage.  \nName  X Y \nnew_point_1  0.0 0.0 \nnew_point_2  0.0 10.0 \nnew_point_3  20.0 10.0 \nnew_point_4  30.0 10.0 \nnew_point_5  30.0 7.0 \nnew_point_6  30.3 10.0 \nnew_point_7  30.3 7.0 \nnew_point_8  50.0 10.0 \nnew_point_9  50.0 0.0 \nGMS Tutorials   SEEP2D  \u2013 Sheet Pile  \n \n Page 6 of 12 \u00a9 Aquaveo 2024  3.3 Creating the Arcs  \nNow that the corner nodes are created, the next step is to create the arcs. This can be \naccomplished as follows:  \n1. Click on the \u201c  Profile lines \u201d coverage to make it active.  \n2. Using  the Create Arc   tool, create the arcs indicated with arrows in Figure 4. \n \n      Figure 4      Initial arcs  \n3. Using the Zoom   tool, drag a box similar to that shown by the red box in       \nFigure  4. \n4. Using  the Create Arc   tool, create the arcs indicated with arrows in Figure 5. \nNotice that there is no arc created at the top of the sheet pile.  \n5. Click  Frame Image  . \n \n      Figure 5      Arcs inc luding the sheet pile  \n6. Using the Zoom   tool, drag a box as shown by the red box in Figure 6. \n\nGMS Tutorials   SEEP2D  \u2013 Sheet Pile  \n \n Page 7 of 12 \u00a9 Aquaveo 2024   \n      Figure 6      Zoom in to this area  \n7. Using  the Create Arc   tool, create the arc indicated by the arrow in Figure 7. \nNotice there is no arc across the top of the sheet pile.  \n \n      Figure 7      Create the final arc  \n8. Click the  Frame Image   macro.  The model should now look like  Figure 8. \n \n      Figure 8      Final view with all the arcs created  \n3.4 Creating the Polygons  \nNow that the arcs are created, it is possible to use  the arcs to build a polygon \nrepresenting the region enclosed by the arcs. For problems with multiple materials, use \nthe polygons to assign the material zones. There is only one material in this case, but it is \nstill necessary to create a polygon. To build  the polygon, do the following:  \n1. Select Feature Objects | Build Polygons . \n\nGMS Tutorials   SEEP2D  \u2013 Sheet Pile  \n \n Page 8 of 12 \u00a9 Aquaveo 2024  The polygon will have a gray background ( Figure 9). \n \n      Figure 9      The polygon is indicated by the gray background  \n3.5 Assigning the Material Properties and Zones  \nThe next step is to assign the material properties and zones. To edit the material \nproperties:  \n1. Click Materials   at the top of the GMS window to bring up the Materials  dialog.  \n2. Select the SEEP2D  tab. \nAt this point, a material for each of the zones in the problem would normally be created \nand given a unique name and color. But since there is only one material, use the default \nname and color and simply edit the pr operties. The material properties are k1, k2, and an \nangle. The values k1 and k2 represent the two principal hydraulic conductivities and the \nangle is the angle from the x-axis to the direction of the major principle hydraulic \nconductivity measured counter -clockwise as shown in Figure 10. \ny\nxak2\nk1\n \n      Figure 10      Definition of hydraulic conductivity angle  \nWith most natu ral soil deposits, the major principal hydraulic conductivity is in the x \ndirection, the minor principal hydraulic conductivity is in the y direction, and the angle is \nzero. The units for hydraulic conductivity are L/T (length/time). The length units shoul d \nalways be consistent with the units used in defining the mesh geometry. Time units can \nbe used in any format. However, small time units (such as seconds) will result in very \nsmall velocity values and may make it difficult to display velocity vectors. It is \nrecommended that time units of days or years be used.  \n3. Enter \u201c30\u201d for both k1 and k2 (assume that the material is isotropic) . \n4. Click  OK to close the Materials  dialog . \n\nGMS Tutorials   SEEP2D  \u2013 Sheet Pile  \n \n Page 9 of 12 \u00a9 Aquaveo 2024  For problems with multiple materials, double -click on the polygons at this point and \nassign the material zones. Since there is only one material in this example, the polygon \ninherits the zone by default.  \n4 Assigning Boundary Conditions  \nThe next step in defining the model is to assign boundary conditions to the conceptual \nmodel. For the problem being modeled, there are two types of boundary conditions: \nconstant head and no -flow (flow is parallel to the boundary). With the finite element \nmethod, not assigning a boundary condition is equivalent to assigning a no -flow boundary \ncondition. Therefore, all of the boundaries have a no -flow boundary condition by default \nand all that is necessary in this case is to assign the constant -head boundary conditions.  \n4.1 Constant -Head Boundaries  \nThe constant -head boundary conditions for the problem are shown in Figure 11. \n \n      Figure 11      Constant -head boundary conditions  \nThe region on the left in Figure 11 represents the top of the mesh on the upstream side \nthat is not  covered with the clay blanket. The region on the right represents the \ndownstream side of the mesh. Using a datum of zero, the total head in either case is \nsimply the elevation of the water. As mentioned above, all other boundaries have a no -\nflow boundary condition by default.  \nTo enter the constant -head boundary conditions for the arc on the left:  \n1. Select the \u201c Profile lines \u201d coverage  in the Project Explorer  to make it active . \n2. Using the Select Arcs   tool, double -click on the top left arc of the model to \nopen the Attribute Table dialog.  \n3. Select \u201chead\u201d from the drop -down in the Type  column.  \n4. Enter \u201c 13.0\u201d in the Head  (m) field.  \n5. Click OK to exit the Attribute Table dialog. Notice that the arc is now blue, \nindicating a constant -head boundary condition ( Figure 12). \nNow to enter the constant -head boundary conditions for the arc on the right:  \n6. Repeat steps 2 \u20135 for the top right arc, entering \u201c10.0\u201d in the Head  (m) field. \nNotice this arc has also changed blue.  \n20 m H = 10 m H = 13 m \nGMS Tutorials   SEEP2D  \u2013 Sheet Pile  \n \n Page 10 of 12 \u00a9 Aquaveo 2024   \n      Figure 12      Constant -head boundaries marked in blue  \n4.2 Building the Finite -Element Mesh  \nIt is now possibl e to build the finite -element mesh used by SEEP2D. The mesh is \nautomatically constructed from the conceptual model. The size of the elements in the \nmesh is controlled by the spacing of vertices along the length of the arcs making up the \nboundary of the mod el domain.  \nArcs are composed of both nodes and vertices. The nodes are the two end points of the \narc. The vertices are intermediate points between the nodes. The gaps between vertices \nare called edges. At this point, all of the arcs have one edge and zero  vertices.  \nTo subdivide the arcs to create appropriately sized edges, do the following:  \n1. After selecting the Select Arcs  tool, select Edit | Select All  to select all the \narcs.  \n2. Select Feature Objects  | Redistribute Vertices\u2026  to bring up the Redistribute \nVertices  dialog.  \n3. Select \u201c Specified spacing \u201d from the Specify  drop-down.  \n4. Enter \u201c 1.2\u201d for the Average spacing . \n5. Click OK to close the Redistribute Vertices  dialog.  \n6. To see the vertices, switch to the Select Vertices   tool. \nTo make the vertices always visible,  do the following:  \n7. Click Display Options   to bring up the Display Options  dialog.  \n8. Select \u201cMap Data\u201d from the list on the left.  \n9. On the Map tab, turn on Vertices  and click OK to close the Display Options  \ndialog.  \nAt this point, it is necessary to construct t he mesh.  \n10. Click the Map \u2192 2D Mesh   macro  at the top of the GMS window (or select \nFeature Objects | Map \u2192 2D Mesh ). \nA 2D mesh should now be visible ( Figure 13). \n \n      Figure 13      The 2D mesh created from the vertices  \n\nGMS Tutorials   SEEP2D  \u2013 Sheet Pile  \n \n Page 11 of 12 \u00a9 Aquaveo 2024  Finally, convert the conceptual model to the SEEP2D numerical model. This will assign \nall of the boundary conditions defined on the feature objects to the node -based boundary \nconditions required by SEEP2D.  \n11. Click the Map \u2192 SEEP2D   macro at the top of the GMS window (or select \nFeature Objects | Map \u2192 SEEP2D ) \nA set of blue symbols should appear along th e constant -head boundaries indicating that \nthe boundary conditions have been assigned.  \n5 Running SEEP2D  \nNow to save the changes and run SEEP2D:  \n1. Click Save  . \n2. Click the Run SEEP2D   macro (or select SEEP2D  | Run SEEP2D ) to open \nthe Seep2d model wrapper dialo g. \n3. When the solution is finished, turn on Read solution on exit  and click Close  to \nclose the Seep2d model wrapper dialog.  \nGMS automatically reads in the SEEP2D solution. The solution should be visible as a \nflow net. The flow net consists of equipotential l ines (total head contours) and flow lines \n(Figure 14). \n \n      Figure 14      Total head contours are visible  \nTo turn on the display of the total flow through the cross section, do the following:  \n4. Click Display Options   to bring up the Display Options  dialog.  \n5. Select \u201c2D Mesh Data \u201d from the list on the left.  \n6. On the 2D Mesh  tab, turn off Nodes  and Element Edges , and turn on Mesh \nBoundary . \n7. On the  SEEP2D  tab, turn on Title and Total flow rate . \n8. Click OK to close the  Display Options  dialog.  \nThe display should appear similar to Figure 15. \n\nGMS Tutorials   SEEP2D  \u2013 Sheet Pile  \n \n Page 12 of 12 \u00a9 Aquaveo 2024   \n      Figure 15      The final view  \n6 Conclusion  \nThis concludes the \u201cSEEP2D \u2013 Sheet Pile\u201d tutorial. The following topics were discussed \nand demonstrated:  \n\uf0b7 SEEP2D is a 2D, finite -element seepage model.  \n\uf0b7 It is possible to use a conceptual model to create a 2D  mesh.  \n \n\n", "filename": "SEEP2D-SheetPile.pdf", "pages": 12}, "StratigraphyModeling-BoreholesAndCrossSections": {"text": "GMS Tutorials   Stratigraphy Modeling \u2013 Boreholes and Cross Sections  \n Page 1 of 13 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nStratigraphy Modeling \u2013 Boreholes and Cross Sections  \nBecome familiar with boreholes and borehole cross sections in GMS  \nObjectives   \nLearn how to import borehole data, construct a set of cross sections between the holes to achieve site \ncharacterization, and edit the cross sections in the Cross Section Editor . \n \nPrerequisite Tutorials  \n\uf0b7 Getting Started  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 Subsurface  Time  \n\uf0b7 15\u201325 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Boreholes and Cross Sections  \n Page 2 of 13 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Importing Borehole Data  ................................ ................................ ................................ ..... 2 \n3 Displaying the Hole Names  ................................ ................................ ................................ . 3 \n4 Editing the Materials ................................ ................................ ................................ ............  4 \n5 Creating Blank Cross Sections  ................................ ................................ ..........................  5 \n5.1 Auto-Create Blank Cross Sections  ................................ ................................ ...............  5 \n5.2 Snapping the Cross Section Tops to a Surface  ................................ ............................  5 \n5.3 Manually Create Blank Cross Sections  ................................ ................................ .........  7 \n6 Auto -Fill Blank Cross Sections  ................................ ................................ ..........................  7 \n7 Manually Fill Cross Sections 7G \u20132G................................ ................................ ..................  8 \n7.1 Building Cross Section 7G \u20132G ................................ ................................ .....................  8 \n8 Manually Editing Multiple Cross Sections  ................................ ................................ .........  9 \n9 Conclusion  ................................ ................................ ................................ .........................  13 \n \n1 Introduction  \nThe Borehole module of GMS visualizes boreholes created from drilling logs and to \nconstruct three -dimensional cross sections between boreholes. These cross sections \nshow the soil stratigraphy between two boreholes. Once a set of cross sections is built, \nthe cross sections can be displayed in 3D space to help characterize and visualize the \nsoil st ratigraphy at a site.  \nThis tutorial illustrates how to construct a set of cross sections for site characterization \nusing borehole data by doing the following:  \n\uf0b7 Importing boreholes  \n\uf0b7 Changing the borehole names and editing the materials  \n\uf0b7 Creating and filling cr oss sections automatically and manually  \n1.1 Getting Started  \nTo get started, do the following:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2 Importing Borehole Da ta \nThe first step in the construction of borehole cross sections is to create some boreholes. \nThe second step is to import a set of previously defined borehole logs.  \n1. Click Open   to bring up the Open  dialog.  \n2. Browse to the Boreholes_and_Cross_Sections  directory for this tutorial . \n3. Select \u201c Text Files (*.txt;*.csv) \u201d from the Files of type  drop-down.  \n4. Select \u201c holes.txt\u201d and cl ick Open  to close the Open  dialog and bring up the Step \n1 of 2  page of the Text Import Wizard  dialog.  \n5. Below the File import options  section, check the Heading row  box and click Next  \nto go to page 2 of 2 of the Text Import Wizard  dialog.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Boreholes and Cross Sections  \n \n Page 3 of 13 \u00a9 Aquaveo 2024  6. Select \u201c Borehole data \u201d (not \u201cBorehole sample data \u201d) from the GMS data type  \ndrop-down.  \nNotice all the column types are automatically assigned based on the header row because \nGMS recognized the headings. Examine the format of the borehole file being imported \nusing a text editor, if desired.  \n7. Click Finish  to close the Text Import Wizard  dialog and import the borehole data.  \n8. Click Oblique View   so the boreho les are more visible ( Figure 1). \n \n      Figure 1      Oblique view showing the imported boreholes  \n3 Displaying the Hole Names  \nThe boreholes currently appear very long and thin, making it difficult to distinguish the \ndifferent materials. The next step is to adjust the borehole display options to improve the \nview.  \n1. Click the Display Options   macro to bring up the Display Options  dialog.  \n2. Select \u201c Borehole Data \u201d from the list on the left.  \n3. In the Stratigraphy  section, enter \u201c 7.0\u201d in the Diameter  field.  \n4. Turn on the Hole names  option.  \n5. Click OK to close the Display Options  dialog.  \nThe boreholes should be more visible now , and the names of the holes should appear at \nthe tops of the holes ( Figure 2). \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Boreholes and Cross Sections  \n \n Page 4 of 13 \u00a9 Aquaveo 2024   \n      Figure 2      The boreholes are now more visible  \n4 Editing the Materials  \nEach of the colors represents a different type of soil. The file that was just imported \nspecified a material ID number for each section of each borehole. GMS also created \nmaterials with those IDs and gave them default names and colors. The  next steps show \nhow to change the material names and colors.  \n1. Click Materials   to bring up the Materials dialog.  \n2. Click on \u201c material_1 \u201d, enter \u201c Clean Sand \u201d, and press the Enter  key to set the new \nname.  \n3. For this same material, click the down arrow in the Color/Pattern  column and \nselect \u201cGreen\u201d from the palette.  \n4. Follow steps 2 \u20133 for \u201c material_2 \u201d, renaming it \u201c Silty or Clayey Fine Sand \u201d and \nchanging its color to blue.  \n5. Follow steps 2 \u20133 for \u201c material_4 \u201d, renaming it \u201c Silty Clay \u201d and changing its color \nto red.  \n6. Click OK to close the Materials  dialog.  \nTo turn on the material legend, do the following:  \n7. Click Display Options   to bring up the Display Options  dialog.  \n8. Select \u201c  Materials \u201d from the list on the left.  \n9. On the Materials  tab, turn on Display material legend . \n10. Click OK to close the Display Options  dialog.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Boreholes and Cross Sections  \n \n Page 5 of 13 \u00a9 Aquaveo 2024  The legend will appear in the bottom  right corner of the Main Graphics Window.  \n5 Creating Blank Cross Sections  \nThe next step is to create a set of blank cross sections. The set of cross sections will be \n\u201cblank\u201d because, at this point, this step indicates where the cross sections should be, not \nwhat they should look like. The blank cross sections will appear as two lines connecting \nthe tops and bottoms of the two boreholes. Cross sections created between two \nboreh oles are named using a combination of the two holes\u2019 names. For example, a cross \nsection created between holes 1G and 7G will be named 1G \u20137G. \n5.1 Auto-Create Blank Cross Sections  \nThe easiest way to create blank cross sections is to do it automatically.  \n1. Select Boreholes | Auto -Create Blank Cross Sections . \nNotice that GMS connects the holes with blank cross sections ( Figure 3). GMS simply \ntriangulates the boreholes to determ ine how to connect them.  \n \n      Figure 3      Blanks cross section between created automatically  \n5.2 Snapping the Cross Section Tops to a Surface  \nThe top and bottom lines that define each cross section can be adjusted to match a TIN \nthat def ines each surface. The next step is to import a TIN and snap the cross section \ntops to the TIN elevations.  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201c All Files (*.*) \u201d from the Files of type  drop-down and select \u201c top_elev.tin \u201d. \n3. Click Open  to import the TIN and close the Open  dialog.  \nA TIN should appear in the graphics window ( Figure 4). \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Boreholes and Cross Sections  \n \n Page 6 of 13 \u00a9 Aquaveo 2024   \n      Figure 4      Imported TIN file  \n4. Select Boreholes  | Advanced  | Snap Cross Sections to TIN \u2026 to bring up the \nSnap Cross Sections to TIN dialog.  \n5. In the Top TIN Selection  section, turn on Snap Top to TIN  and click OK to close \nthe Snap Cross Sections to TIN dialog.  \n6. To hide the TIN, u ncheck the \u201c top elevation \u201d TIN in the \u201c  TIN Data\u201d folder in \nthe Project Explorer . \nThe cross section tops should now be adjusted to match the TIN elevations ( Figure 5).  \n \n      Figure 5      Cross section tops adjusted to match TIN elevation  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Boreholes and Cross Sections  \n \n Page 7 of 13 \u00a9 Aquaveo 2024  5.3 Manually Create Blank Cross Sections  \nThis section demonstrates creating cross sections man ually. Before doing this, it is \nnecessary to delete all the cross sections that were created automatically.  \n1. Click the Select Borehole Cross Sections   tool. \n2. Select Edit | Select All  to highlight all of the cross sections.  \n3. Press the Delete  key.  \nAll of the cross sections in the Project Explorer will disappear.  \nThe set of blank cross sections to be created are as follows: 1G \u20137G, 7G \u20132G, 2G \u20135G, \n4G\u20135G, 5G \u20136G, 6G \u20137G, 3G \u20136G, and 6G \u20138G. \n4. Select the Create Borehole Cross Sections   tool. \n5. Click on hole 1G to begin, th en single -click on hole s 7G, 2G, 5G, and 6G in \nsequence , double -clicking on hole 8G to end.  \n6. Create cross sections 3G \u20136G and 6G \u20137G by clicking on hole 3G to begin, \nclicking on hole 6G, and double -clicking on hole 7G to end . \n7. Create cross section 4G \u20135G by clicking on hole 4G to begin and double -clicking \non hole 5G to end.   \nThe \u201cblank\u201d cross sections should look like those in Figure 6. \n \n      Figure 6      Blank cross sections created manually  \n6 Auto-Fill Blank Cross Sections  \nThe next step is to delineate soil layers for the blank cross sections. This is done using \narcs and polygons, just like the arcs and polygons created in the Map module of GMS. \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Boreholes and Cross Sections  \n \n Page 8 of 13 \u00a9 Aquaveo 2024  Familiarity with the Map module is not necessary for this tutorial, however. The easiest \nway to fill the blank cross sections is to let GMS do it automatically.  \n1. Select Boreholes  | Auto -Fill Blank Cross Sections \u2026 to bring u p the Auto-Fill \nCross Sections dialog.  \nThis dialog has two options: Match using horizon IDs  and Match using materials . It is \ngenerally preferable to assign horizon IDs before using the a uto-fill command , and to \nthen use the horizon IDs to fill the cross sections. This makes the cross sections \nconsistent with the horizon IDs. Horizons are discussed in detail in another tutorial.  \n2. Select the Match using materials  option, and click OK to close the Auto-Fill C ross \nSections dialog.  \nAfter a moment, GMS fills the blank cross sections.  \n7 Manually Fill Cross Sections 7G \u20132G \nGMS cannot automatically fill in the details of the cross section between the two \nboreholes if they are too dissimilar, or if the results of the a utomatic fill may not be \ndesirable. Because of this, it is often necessary to manually fill and edit cross sections.  \nWith this relatively simple set of boreholes, GMS had no problem automatically filling all \nthe cross sections. The next section illustrates  how to do it manually.  \n7.1 Building Cross Section 7G \u20132G \n1. Expand the \u201c Cross Sections\u201d  folder in the Project Explorer and double -click on \ncross section \u201c 7G\u20132G\u201d to bring up the Cross Section Editor dialog.  \n2. Click the Delete All   button to delete the existing i nterior polygons and arcs.  \n3. Using the Create Arc   tool, create all the interior arcs shown in Figure 7. \n \n      Figure 7      Interior arcs created  \n4. Click the Build  Cross Section Polygons   button. The cross section should \nappear similar to before the previous interior arcs and polygons were deleted.  \n5. Click OK to close the Cross Section Editor dialog.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Boreholes and Cross Sections  \n \n Page 9 of 13 \u00a9 Aquaveo 2024  8 Manually Editing Multiple Cross Sections  \nGMS also allows editing multiple cross sections simultaneously in the Cross Section \nEditor . This is useful when considering geologic trends from adjacent cross sections.  \n1. Using the Select Borehole Cross Sections   tool, hold down the Shift key and \nselect 6G\u20138G, 5G\u20136G, and  2G\u20135G in the Graphics Window.  \n2. Select Boreholes  | Cross Section Editor\u2026  to bring up the Cross Section Editor  \ndialog ( Figure 8). \nThe first panel from the left is brighter than the other panels in the dialog. This is the \nactive panel that can be edited. Change the active panel by using the  arrow b uttons.  \n \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Boreholes and Cross Sections  \n \n Page 10 of 13 \u00a9 Aquaveo 2024        Figure 8      Cross Section Editor dialog  \nThe next step is to edit the middle panel.  \n3. Click the Right Arrow   button to make the middle panel active.  \n4. Click Frame Current Cross Section   to see this panel more closely.  \n5. Click Delete All   to delete the existing inter ior polygons and arcs.  \n6. Using the Create Arc   tool, create the cross sections shown in Figure 9. \n7. Click Build Cross Section Polygons   so the materials fill the cross section.  \n8. Click Frame All Cross Sections   to see all of the cross sections.  \nThe Cross Section Editor  dialog allows adjusting the plot that is displayed around the \ncross sections for high quality print outs, including adding titles and grid lines.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Boreholes and Cross Sections  \n \n Page 11 of 13 \u00a9 Aquaveo 2024   \n      Figure 9      Cross section 5G \u20136G being edited  \n9. Click Plot Options   to bring up the Plot Options  dialog.  \n10. On the Options  tab in the Titles  section, enter \u201cSection A -A\u201d in the Title 1  field.  \n11. On the Y-Axis tab below the Left section, turn on Display grid . \n12. Click OK to exit the Plot Options  dialog.  \n13. In the Display Options  section on the left, turn off Nodes , Vertices , and Mark \ninactive . The plot should now look something like Figure 10. \n14. Click OK to exit the Cross Section Editor  dialog.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Boreholes and Cross Sections  \n \n Page 12 of 13 \u00a9 Aquaveo 2024   \n \n      Figure 10      Multi -panel cross section ready for printing  \nBuilding the cross sections is now complete, and they should appear as in Figure 11. \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Boreholes and Cross Sections  \n \n Page 13 of 13 \u00a9 Aquaveo 2024   \n      Figure 11      Final appearance  of cross sections and boreholes  \n9 Conclusion  \nThis concludes the \u201cStratigraphy Modeling \u2013 Boreholes and Cross Sections\u201d tutorial. The \nfollowing topics were demonstrated and discussed:  \n\uf0b7 Boreholes can be imported via the Text Import Wizard . \n\uf0b7 The display options for boreholes can be changed to aid in visualization.  \n\uf0b7 Borehole names and materials can be edited.  \n\uf0b7 When borehole cross sections are first created, they are blank.  \n\uf0b7 The boreholes can be manually connected to create cross sections.  \n\uf0b7 Cross  sections can also be c reated automatically using the Auto -Create Blank \nCross Sections  command.  \n\uf0b7 Cross sections can be automatically filled using the Auto -Fill Blank Cross \nSections command.  \n\uf0b7 Cross sections can be manually filled by creating the desired arcs between the \ntwo borehol es and then selecting the Build Cross Section Polygons   button \nin the Cross Section Editor .  \n\uf0b7 The Cross Section Editor  can be used to define how the soil layers are \nconnected.  \n\uf0b7 Cross section arcs can be matched to a TIN.  \n \n\n", "filename": "StratigraphyModeling-BoreholesAndCrossSections.pdf", "pages": 13}, "StratigraphyModeling-HorizonCoverages": {"text": "GMS Tutorials   Stratigraphy Modeling \u2013 Horizon Coverages  \n Page 1 of 12 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nStratigraphy Modeling \u2013 Horizon Coverages  \nUse horizon coverages to help control the Horizon \u2192 Solids  \noperation  \nObjectives   \nLearn how to constrain the areal extent of the solids created using the Horizons \u2192 Solids  command.  \n \nPrerequisite Tutorials  \n\uf0b7 Stratigraphy Modeling \u2013 \nHorizons and Solids  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 Subsurface  \n\uf0b7 Geostatistics  Time  \n\uf0b7 20\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizon Coverages  \n Page 2 of 12 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Creating  Solids using Horizons \u2192 Solids  ................................ ................................ .........  3 \n2.1 Viewing the Clean Sand Solid ................................ ................................ .......................  4 \n3 Creating the Horizon Conceptual Model  ................................ ................................ ............  5 \n3.1 Horizon Coverage 4  ................................ ................................ ................................ ...... 5 \n3.2 Defining the Polygon  ................................ ................................ ................................ ..... 6 \n3.3 Marking the Outside -Boundary Arcs  ................................ ................................ .............  6 \n3.4 Building and Deleting Polygons  ................................ ................................ ....................  7 \n4 Horizons \u2192 Solids Command  ................................ ................................ ............................  8 \n4.1 Comparing the results  ................................ ................................ ................................ ... 8 \n5 Automatically Build the Horizon Coverages  ................................ ................................ ..... 9 \n6 Building Solids  ................................ ................................ ................................ ..................  10 \n6.1 Creating Solids from the Horizon Coverage ................................ ................................  10 \n6.2 Comparing the results  ................................ ................................ ................................ . 10 \n7 Conclusion  ................................ ................................ ................................ .........................  12 \n \n1 Introduction  \nThis tutorial builds on the concepts taught in the \u201c Stratigraphy Modeling \u2014Horizons and \nSolids \u201d tutorial. In that tutorial, solids were created using horizons and cross sections. \nGMS uses 2D interpolation in an algorithm to define the solids. Sometimes, the 2D \ninterpolation continues trends in the data that cause the areal extent of the solids to \nextend beyond what is desired.  \nThis tutorial illustrates a way to constrain the areal extent of the created solids through \nthe following.  \n1. Creating horizon coverages manually.  \n2. Creating horizon coverages automatically.  \n3. Creating solids from the horizon concep tual model.  \n4. Comparing the solids made from a horizons conceptual model to the solids \ncreated without a horizons conceptual model.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select the File | New command to ensure that the \nprogram settings are restored to their default state.  \nNext, import the same set of boreholes that were used in the \u201c Stratigraphy Modeling \u2014\nHorizons and Solids \u201d tutorial:  \n3. Click Open   to bring up the Open  dialog.  \n4. Select \u201cAll Files (*.*)\u201d from the Files of type  drop-down.  \n5. Browse to the Horizon_Coverages \\Horizon_Coverages \\ directory and select \n\u201cxsects.gpr \u201d. \n6. Select Open  to import the project ( Figure 1) and close the Open  dialog.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizon Coverages  \n \n Page 3 of 12 \u00a9 Aquaveo 2024   \nFigure 1      Imported project  \n2 Creating Solids using Horizons \u2192 Solids  \nNext, create solids as outlined in the \u201c Horizons and Solids \u201d tutorial. The horizon IDs have \nalready been as signed and the cross sections have already been created, so all that is \nnecessary is to run the Horizons \u2192 Solids  command.  \n1. In the Project Explorer , select the  \u201c Borehole Data \u201d folder  to switch to the \nBorehole module.  \n2. Select Boreholes | Horizons \u2192 Solids \u2026 to bring up the Horizons to Solids \u2013 \nHorizon Elevations  dialog.   \n3. Accept the default settings by  clicking  Next  to bring up the Top and Bottom \nElevations  page of the Horizons to Solids  dialog . \n4. In the Top elevation  section, select Top of boreholes . \n5. In the Bottom elevation  section, select Constant elevation  and enter \u201c -37.0\u201d in the \nfield below that.  \n6. Click Finish  to close the Horizons to Solids  dialog. GMS will now create the \nsolids and the Main Graphics Window should appear similar to Figure 2. \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizon Coverages  \n \n Page 4 of 12 \u00a9 Aquaveo 2024   \n      Figure 2      After solids have been created  \n2.1 Viewing the Clean Sand Solid  \nDo the following to look at the clean sand layer.  \n1. In the Project Explorer  under the \u201c  Solid Data \u201d folder, expand the \u201c  solids \u201d \nfolder to see the solids that were just created.  \n2. Turn off all the solids except for \u201c  Clean_Sand 4 \u201d. \n3. Click Display Options   to bring up the Display Options dialog.  \n4. Select \u201c Borehole Data \u201d from the list on the left.  \n5. On the Borehole  tab in the Stratigraphy  section, turn on Hole names . \n6. Select \u201c Solid Data \u201d from the list on the left.  \n7. On the Solid  tab, turn on Solid faces .  \n8. Click OK to close the Display Options  dialog.  \nNotice how the \u201c  Clean_Sa nd 4\u201d layer intersects with cross section 5G \u20132G even \nthough there is no clean sand material in that cross section ( Figure 3). \n9. Using the Rotate   tool, rotate the view to get a feel for the extent of this solid. \nFor example, notice how it passes through cross section 6G \u20138G outside of the \nclean sand area in the cross section.  \nThis is the result of the interpolation that the Horizons \u2192 Solids  command used. The \ninterpolatio n identifies the trends in the data and continues the trends \u2014sometimes further \nthan is desirable. Using horizon coverages allows the interpolation to be constrained.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizon Coverages  \n \n Page 5 of 12 \u00a9 Aquaveo 2024   \nFigure 3      Clean sand material passing through cross section  \n3 Creating the Horizon Conceptual Model  \nNow to create a horizon conceptual model:  \n1. Right -click on the \u201c  Map Data \u201d folder and select New Conceptual Model\u2026  to \nbring up the Conceptual Model Properties dialog.  \n2. Enter \u201c Horizons \u201d for the Name . \n3. Select \u201c Horizons \u201d from the Type  drop-down.  \n4. Click OK to exit the Conceptual Model Properties dialog.  \n3.1 Horizon Coverage 4  \nCreate a new coverage and set up the attributes by doing the following:  \n1. In the Project Explorer , right -click on \u201c default coverage\u201d  and select Duplicate  \nto create a new coverage called \u201cCopy of default coverage\u201d.  \n2. Drag the new coverage on top of the \u201c  Horizons\u201d conceptual model. Click Yes \nto dismiss the warning regarding moving the coverage. The new coverage will \nnow be under the \u201c  Horizons\u201d conceptual m odel ( Figure 4).  \n \n      Figure 4      New coverage after moving it  \n3. Right -click on \u201c  Copy of default coverage \u201d and select Coverage Setup \u2026 to \nbring up the Coverage Setup  dialog.  \n4. Enter \u201c4\u201d in the Coverage name  field. This is the horizon ID corresponding to the \nclean sand material.  \n5. Enter \u201c4\u201d for the Horizon ID . \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizon Coverages  \n \n Page 6 of 12 \u00a9 Aquaveo 2024  6. Click OK to exit the Coverage Setup  dialog.  \n3.2 Defining the Polygon  \nNow it is necessar y to create the polygon which will constrain the clean sand material.  \n1. In the Project Explorer , turn off the \u201c  Clean_Sand 4 \u201d solid.  \n2. Turn on the \u201c  4\u201d coverage, then select it to make it active.  \n3. Click Plan View  . \nNotice how part of the cross section lines  are highlighted in red. The red portion \nrepresents the part of the cross sections where the clean sand material exists. This red \nhighlighting only appears when in plan view and the active coverage is a horizon \ncoverage.  \n4. Using the Create Arc   tool, create  two arcs similar to those identified by the \narrows shown in Figure 5. Notice that the arcs surround the red highlighting on \nthe cross sections.  \nEach of the vertices o n the arcs will be used when interpolating the horizon, so create \narcs with more vertices to more strongly control the interpolation.  \n \nFigure 5      Arcs created in the Horizon 4 coverage  \n3.3 Marking the Outside -Boundary Arcs  \nIt is ne cessary to tell GMS which arcs are outside boundary arcs. GMS uses this \ninformation to decide where the solid should end and where it should be allowed to \ncontinue. The vertices on the outside boundary arcs are not used when interpolating the \nhorizon.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizon Coverages  \n \n Page 7 of 12 \u00a9 Aquaveo 2024  1. Using the Select Arcs   tool, hold down the Shift key and select the two arcs \nidentified by the arrows shown in Figure 6. \n2. Right -click on one of the selected arcs and select Attribute Table \u2026 to bring up \nthe Attribute Table dialog.  \n3. In the Outside Boundary  column in the table, check the box in the All row to mark \nthe two selected arcs as outside boundaries.  \n4. Click OK to exit the Attribute Table dialog.  \n5. Click anywhere in the background to deselect the arcs.  \n \nFigure 6      Outside -boundary arcs  \n3.4 Building and Deleting Polygons  \nThe next step i s to build the polygons.  \n1. Select Feature Objects | Build Polygons  to build the new polygons.  \n2. Using the Select Polygons   tool, hold down the Shift key and select the two \nhighlighted polygons (to the left and right of the center polygon, Figure 7).  \n3. Press the Delete  key to delete the select polygons. Solids will only be created \nwhere a polygon exists.  \nCreating the horizon coverage for the clean sand material is now done.  At this point, the \nhorizon coverages for the other horizons could be defined. For the purposes of this \ntutorial, it is only necessary to define this one.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizon Coverages  \n \n Page 8 of 12 \u00a9 Aquaveo 2024   \nFigure 7      Polygons to delete (highlighted in green)  \n4 Horizons \u2192 Solids  Command  \nThe horizons conceptual model is all set up now and ready to use in creating solids.  \n1. In the Project Explorer , click on the \u201c  Borehole Data\u201d folder to  switch to the \nborehole module.  \n2. Select Boreholes | Horizons \u2192 Solids \u2026 to bring up the Horizon Elevations  page \nof the Horizons to Solids dialog.  \n3. In the Conceptual model section, turn on Use horizons conceptual model . \n4. Click Finish . GMS will now create the new solids.  \n4.1 Comparing the results  \nThe newly created solids were added to the Project Explorer  in a new folder that should \nbe called \u201c solids (2) \u201d.  \n1. Expand the \u201c  solids (2) \u201d folder and turn off all the new solids except the \u201c  \nClean_Sand 4 \u201d solid.  \nNotice that the boundary of the new solid is almost entirely inside the polygon that was \ndefined in the horizons coverage, with only a few parts of the solid overlapping beyond \nthe edge of the new polygon ( Figure 8). Also notice that only one horizon coverage exists \nper horizon ID.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizon Coverages  \n \n Page 9 of 12 \u00a9 Aquaveo 2024   \nFigure 8      Clean sand material with correct boundary  \n2. Turn off and on the original \u201c  Clean_Sand 4 \u201d solid in the original \u201c  solids\u201d \nfolder to see how the area of the new solid differs from the original.  \nThe bounda ries of the other new solids are identical to the other old solids because this \ntutorial only defined the horizon 4 coverage. If desired, verify that the boundaries for the \nother solids are indeed the same as before.  \n5 Automatically Build the Horizon Coverag es \nAnother way to create horizon coverages is to build them automatically using the Build \nHorizon Coverages  option. When automatically building the coverages, it is possible to \nchoose whether or not to include cross sections. Typically, if the model has cross \nsections, it is natural to want to use them.  \n1. In the Project Explorer , right -click on the \u201c  Horizons \u201d conceptual model  and \nselect Duplicate to create a conceptual model named \u201c  Horizons (2)\u201d.  \n2. Right -click on \u201c  Horizons (2)\u201d and select Properties \u2026 to bring up the \nConceptual Model Properties dialog.  \n3. Enter \u201c Horizons Auto \u201d in the Name  field and click OK to close the Conceptual \nModel Properties dialog.  \n4. Right -click on coverage \u201c  4\u201d under the \u201c  Horizons Auto \u201d conceptual model \nand select Delete . \n5. Turn off both the \u201c  Horizons\u201d conceptual model and coverage \u201c  4\u201d. \n6. Right -click on the \u201c  Horizons Auto \u201d conceptual mo del and select Build \nHorizon Coverages \u2026 to bring up the Boreholes  page of the Build Horizon \nCoverages  dialog.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizon Coverages  \n \n Page 10 of 12 \u00a9 Aquaveo 2024  7. Select Use all boreholes  and click Next  to close the  Boreholes  page and go to \nthe Boundary  page.  \n8. Select \u201c default coverage \u201d and click Next  to close the  Boundary  page and go to \nthe Horizons  page.  \n9. Turn on Use cross sections  and select Generate for each horizon . \n10. Click Finish  to close the Build Horizon Coverages  dialog and create five new \ncoverages under the \u201c  Horizons  Auto\u201d  conceptual model . \n11. Turn on \u201c  Horizons  Auto\u201d in the Project Explorer.  \n12. Examine the new coverages by selecting each of them in turn in the Project \nExplorer .  \n6 Building Solids  \nThe next process is to build solids with the conceptual model and compare the results \nwith the previous ly constructed solids.  \n6.1 Creating Solids from the Horizon Coverage  \n1. Click on the \u201c  Borehole Data \u201d folder in the Project Explorer  to switch to the \nBorehole module.  \n2. Select Boreholes | Horizons \u2192 Solids \u2026 to bring up the Horizon Elevations  page \nof the Horizons to Solids  dialog . \n3. In the Boreholes  section, turn on Use boreholes  and Use borehole cross \nsections , and select the Use all boreholes  radio button.  \n4. In the TINs  section, turn off Use horizon TINS . \n5. In the Raster Catalog  section, select \u201cNONE\u201d from the drop -down. \n6. In the Conceptual model section, turn on Use horizons conceptual model  and \nselect \u201cHorizons Auto\u201d from the list under the \u201cMap Data\u201d folder.  \n7. Click Finish  to close the Horizons to Solids  dialog . \nA new set of solids will be created by GMS and placed in a folder called \u201c  solids (3) \u201d in \nthe Project Explorer . \n6.2 Comparing the results  \nTo compare the results, do the following:  \n1. Turn off all the solids in all three solids folders.  \n2. In the \u201c  solids ( 3)\u201d folder, turn on the \u201c  Silty_Clay 1 \u201d solid. Notice the area \nthat it covers ( Figure 9). \n3. Turn on the corresponding solid (\u201c  Silty_Clay 1 \u201d) in the \u201c  solids ( 2)\u201d folder. \nNotice the area that the solid covers ( Figure 10). \n4. Turn on and off (\u201c  Silty_Clay 1 \u201d) in the \u201c solids ( 2)\u201d folder until comfortable \nwith the difference between the one from \u201c  solids ( 2)\u201d and the one from \u201c  \nsolids ( 3)\u201d.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizon Coverages  \n \n Page 11 of 12 \u00a9 Aquaveo 2024  Notice  that the solids created using the horizon conceptual model are clearly constrained \nby the polygons in the horizon coverages.  \n5. Repeat steps 1 \u20134 for the remaining solids.  \n \nFigure 9      Silty_Clay 1 solid  created with the conceptual  model  \n \nFigure 10      Previous Silty_Clay 1 solid  \n  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizon Coverages  \n \n Page 12 of 12 \u00a9 Aquaveo 2024  7 Conclusion  \nThis concludes the \u201cStratigraphy Modeling \u2013 Horizon Coverages\u201d tutorial. Here are some \nof the key concepts in this tutorial:  \n\uf0b7 Horizon coverages can be created manually  and automatically.  \n\uf0b7 Choose whether or not to use the borehole cross sections when automatically \ncreating horizon coverages.  \n\uf0b7 Solids can be created from the horizon conceptual model.  \n\uf0b7 It is possible to create a horizon conceptual model containing horizon co verages \nthat constrain the areal extent of the solids.  \n\uf0b7 One horizon coverage exists per horizon ID.  \n\uf0b7 In a horizon coverage, the outside boundary arcs must be explicitly identified.  \n\uf0b7 In a horizon coverage, polygons are only defined for the areas where the soli ds \nshould appear.  \n\uf0b7 When selecting a horizon coverage in plan view, GMS highlights in red parts of \nthe cross sections to show where the soil layer with the same horizon ID as the \ncoverage exists on the cross sections.  \n \n", "filename": "StratigraphyModeling-HorizonCoverages.pdf", "pages": 12}, "StratigraphyModeling-HorizonsAndSolids": {"text": "GMS Tutorials   Stratigraphy Modeling \u2013 Horizon s and Solids  \n Page 1 of 17 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nStratigraphy Modeling \u2013 Horizon s and Solids  \nCreate solids from boreholes using the Horizons \u2192 Solids  tool \nObjectives   \nLearn how to construct a set of solid models using the horizon method in GMS. Become familiar with how \nhorizons are numbered and used to create solids. Use borehole cross sections to help control the solid \ngeneration process . \n \nPrerequisite Tutorials  \n\uf0b7 Feature Objects  \n\uf0b7 Stratigraphy Modeling \u2013 \nBoreholes and Cross \nSections  \n\uf0b7 Stratigraphy Modeling \u2013 TIN \nSurfaces  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 Subsurface  \n\uf0b7 Geostatistics  Time  \n\uf0b7 35\u201345 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizon s and Solids  \n Page 2 of 17 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Reading Borehole Data  ................................ ................................ ................................ ....... 3 \n3 Dete rmining Horizons  ................................ ................................ ................................ .........  3 \n3.1 Horizon IDs  ................................ ................................ ................................ ...................  4 \n3.2 Automatically Assigning Horizon IDs  ................................ ................................ ............  4 \n4 Manually Assigning Horizons  ................................ ................................ .............................  6 \n4.1 Selecting Borehole Contacts ................................ ................................ .........................  6 \n4.2 Assigning Horizon ID 2  ................................ ................................ ................................ . 7 \n4.3 Assigning Horizon ID 3  ................................ ................................ ................................ . 7 \n4.4 Assigning Horizon ID 4  ................................ ................................ ................................ . 8 \n4.5 Assigning Horizon ID 5  ................................ ................................ ................................ . 9 \n4.6 Turning off Horizon IDs  ................................ ................................ ...............................  10 \n5 Constructing the TIN  ................................ ................................ ................................ .........  11 \n5.1 Setting up the Coverage  ................................ ................................ .............................  11 \n5.2 Creating the Boundary Polygon  ................................ ................................ ..................  11 \n5.3 Creating a TIN  ................................ ................................ ................................ ............  12 \n6 Creating the Solids  ................................ ................................ ................................ ............  13 \n6.1 Viewing the Solids  ................................ ................................ ................................ ...... 13 \n6.2 Cutting Cross Sections  ................................ ................................ ...............................  13 \n6.3 Using Borehole Cross Section Data  ................................ ................................ ...........  15 \n6.4 Cutting Cross Sections  ................................ ................................ ...............................  16 \n7 Conclusion  ................................ ................................ ................................ .........................  17 \n \n1 Introduction  \nThe Solid s module of GMS is used to construct three -dimensional models of stratigraphy. \nOnce the solids are created, cross sections can be cut anywhere on the model, the \nvolumes of the solids can be computed, and the solid model can be used to define \nelevation data for numerical models such as MODFLOW.  \nThis tutorial illustrates how to construct a set of solid models using the horizon method in \nGMS. A \u201chorizon\u201d refers to the top of each stratigraphic unit represented in the solid. \nHorizons are defined at borehole cont acts: the interface between different materials on a \nborehole log. Each contact included in the construction of the solid must have a horizon \nID. Horizons are numbered consecutively in the order the strata are deposited, from the \nbottom up. A contact with the default value of zero will be ignored.  \nAssigning horizon IDs is useful only if a relationship exists between boreholes. Some \nstratigraphy is so complex that very little, if any, relationship exists between boreholes. In \nsuch cases, the approach outlined in the T -PROGS tutorial should be considered.  \nCreating a solid model of soil stratigraphy using the horizons approach in GMS is quite \nsimple. First, import a set of borehole data. Second, assign horizon IDs to the contacts of \nthe boreholes. Third,  create a TIN that can be used to interpolate and define the \nboundary of the solid. Finally, execute the Horizons \u2192 Solids  command to create a set \nof solids.  \n1.1 Getting Started  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons and Solids  \n \n Page 3 of 17 \u00a9 Aquaveo 2024  2 Reading Borehole Data  \nThe first step in the construction of the solid models is to import a set of borehole logs. \nBorehole data can be entered into GMS manually, or the data can be imported fro m a \nfile. In the interest of time, the next steps will import a previously prepared file. To import \nthe file, do as follows:  \n1. Click Open   to bring up the Open  dialog.  \n2. Browse to the Horizons_and_Solids \\Horizons_and_Solids \\ directory and select \n\u201choles.gpr \u201d. \n3. Click Open  to import the logs and close the Open  dialog.  \nA 3D view of the borehole logs should appear ( Figure 1). Each of the colors represents a \ndifferent type of soil. They are clean sand, silty sand, and silty-clayey -fine sand . \n \n      Figure 1      Boreholes  \n3 Determining Hor izons  \nRemember that horizons are numbered consecutively in the order that the strata are \ndeposited, from the bottom up. Horizon IDs are assigned at borehole contacts (the \ninterface between different materials on a borehole log).  \n1. Look at this set of borehol es and plan how to assign horizon IDs to them.  \n2. Notice what is common among all the boreholes and what is different.   \nFor example, silty -clayey -fine sand is at the top of every borehole. Also, several \nboreholes have a clean sand layer on top of a silty san d layer. But some boreholes have \nmore than one silty -clayey -fine sand layer, and some have more than one silty sand \nlayer.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons and Solids  \n \n Page 4 of 17 \u00a9 Aquaveo 2024  Hole 7G seems to include all the layers that are present on all of the other holes. \nTherefore, it can be used as a guide to show the order in which the layers were \ndeposited. This tutorial will assign horizon IDs to each contact on hole 7G, starting with 0 \nat the bottom and ending with 5 at the top. On the other holes, the numbering will have a \ngap where a layer is missing.  \n3.1 Horizon IDs  \nTo turn on the display of the horizon IDs:  \n1. Click  Display Options   to bring up the Display Options  dialog . \n2. Select \u201cBorehole Data\u201d from the list on the left.  \n3. On the Borehole  tab in the Stratigraphy  section, t urn on Horizon IDs . \n4. Click  OK to close the Display  Options  dialog . \nHorizon IDs should now be displayed next to each contact. As the results show, all the \nhorizon IDs are currently at the default value of 0. Zero is a key value that indicates to \nGMS that it should ignore that horizon when constructing solids.  \n3.2 Automatically Assigning Horizon IDs  \nThe next step in the construction of the stratigraphy model is to assign the horizon IDs to \nthe borehole contacts. The easiest way to assign horizon IDs is to let GMS do it \nautomatically.  \n1. Select Boreholes | Auto -Assign Horizons\u2026  to bring up the Auto-assign \nHorizons dialog . \n2. Select the  Start from scratch  option and click  Run\u2026 to close the Auto-assign \nHorizons dialog and bring up the Horizon Optimizer dialog ( Figure 2). \nSince only a small number of boreholes exist in this example, the optimizer finishes \nquickly. With a bigger and more complex set of boreholes, the optimizer can take a \nsignificant amount of time.  \n3. When it finishes,  turn on Read solution on exit  and click OK to close the Horizon \nOptimizer dialog.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons and Solids  \n \n Page 5 of 17 \u00a9 Aquaveo 2024    \n      Figure 2      The Horizon Optimizer dialog  \nThe horizon IDs should now be assigned, as seen in the close -up in Figure 3. \n \n      Figure 3      Horizon IDs after automatic assignment  \nNote:  The algorithm for automatically assigning horizon IDs is complex and \nbeyond the scope of this tutorial.  \nThe ability to automatically create cross sections and horizon IDs can save a lot of time \nand effort, especially if working with a large set of comple x boreholes. Nevertheless, \nautomatic creation of cross sections and horizon IDs should only be conceptualized as an \ninitial guess at the real solution. Careful examination of the automatic results is essential, \nand it is usually necessary to make manual ad justments.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons and Solids  \n \n Page 6 of 17 \u00a9 Aquaveo 2024  4 Manually Assigning Horizons  \nHorizon IDs can also be assigned manually. To do so here, it is first necessary to set all \nhorizon IDs back to 0.  \n1. Click the Select Contacts   tool and press Ctrl-A (or select Edit | Select All ) to \nselect all the contacts.  \n2. Click the Properties   macro to bring up the Contact horizon ID  dialog.  \n3. Enter \u201c 0\u201d for Horizon ID  and click OK to close the Contact horizon ID  dialog.  \n4. Click anywhere in the background space of the Graphics Window to unselect the \nborehole contacts.  \n4.1 Selecting Borehole Contacts  \nNow it is necessary to select a group of borehole contacts and set the horizon IDs. The \nfirst horizon to be defined will be the top of the lower silty -clay layer as indicated by \narrows in Figure 4. \n1. Using the Select Contacts   tool, select the top of the lower silty sand material \non hole 8G as shown in Figure 4. \n2. While holding down the Shift key, select the same contact on holes 5G and 7G.  \n3. Click the Properties   macro to bring up the Contact horizon ID dialog.  \n4. Enter \u201c 1\u201d for Horizon ID and click OK to close the Contact horizon ID  dialog .  \n5. Click anywhere in the background space of the Graphics Window to unselect the \nborehole contacts.  \n \n      Figure 4      Contacts for Horizon 1  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons and Solids  \n \n Page 7 of 17 \u00a9 Aquaveo 2024  4.2 Assigning Horizon ID 2  \nNext, assign a horizon ID o f \u201c2\u201d to the top of the lower silty -clayey -fine sand layer.  \n1. Using the Select Contacts   tool and the Shift key, select the borehole \ncontacts shown in Figure  5. \n2. Click the Properties   macro to bring up the  Contact horizon ID dialog.  \n3. Enter \u201c 2\u201d for Horizon ID  and click OK to close the Contact horizon ID  dialog .  \n4. Click anywhere in the background space of the Graphics Window to unselect the \nborehole contacts.  \n \n      Figure  5      Contacts for Horizon 2  \n4.3 Assigning Horizon ID 3  \nHorizon ID 3 will be assigned to the top of the upper silty clay layer.  \n1. Using the Select Contacts   tool and the Shift key, select the borehole \ncontacts shown in Figure  6. \n2. Click Properties   to bring up the  Contact horizon ID dialog.  \n3. Enter \u201c 3\u201d for Horizon ID  and click OK to close the Contact horizon ID  dialog .  \n4. Click anywhere in the background space of the Gra phics Window to unselect the \nborehole contacts.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons and Solids  \n \n Page 8 of 17 \u00a9 Aquaveo 2024   \n      Figure  6      Contacts for Horizon 3  \n4.4 Assigning Horizon ID 4  \nThe top of the clean sand layer will be assigned horizon ID of 4.  \n1. Using the Select Contacts   tool and the Shift key, select all of the contacts at \nthe top of the clean sand material as seen in Figure 7. \n2. Click Properties   to bring up the  Contact horizon ID dialog.  \n3. Enter \u201c 4\u201d for Horizon ID  and click OK to close the Contact horizon ID  dialog .  \n4. Click anywhere in the background space of the Graphics Window to unselect the \nborehole contacts.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons and Solids  \n \n Page 9 of 17 \u00a9 Aquaveo 2024   \n      Figure 7      Contacts for Horizon 4  \n4.5 Assigning Horizon ID 5  \nThe top of the upper silty -clayey -fine sand layer is horizon 5.  \n1. Using the Select Contacts   tool and the Shift key, select the top contact on \neach borehole as shown in Figure 8. \n2. Click Properties   to bring up the Contact horizon ID dialog.  \n3. Enter \u201c 5\u201d for Horizon ID  and click OK to close the Contact horizon ID  dialog .  \n4. Click anywhere in the background space of the Graphics Window to unselect the \nborehole contacts.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons and Solids  \n \n Page 10 of 17 \u00a9 Aquaveo 2024   \n      Figure 8      Contacts for Horizon 5  \n4.6 Turning off Horizon IDs  \nIt is beneficial to turn off the display of the hole names so that the display is not cluttered \nbefore constructing the TIN in the next sec tion. \n1. Click Display Options   to bring up the Display Options  dialog.  \n2. Select \u201cBorehole Data\u201d from the list on the left.  \n3. On the Borehole  tab in the Stratigraphy  section, turn off Hole names . \n4. Click OK to close the Display Options  dialog.  \nThe horizon IDs shou ld be assigned as shown in Figure 9. \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons and Solids  \n \n Page 11 of 17 \u00a9 Aquaveo 2024   \n      Figure 9      Completed horizon IDs  \n5 Constructing the TIN  \nIt is possible to construct a TIN using the map module in order to define the boundary of \nthe solid. The horizons will also be interpolated to the TIN to define a surface for each \nhorizon. The solid is created by filling in the space between each of the surfaces defined \nby the interpolation.  \n5.1 Setting up the Coverage  \nFirst, define a polygon that will serve as the boundary for the TIN.  \n1. In the Project Explorer,  right-click on the empty space and select New | \nCoverage\u2026 .  \nA new coverage will appear in the Project Explorer.  \n5.2 Creating the Boundary Polygon  \nTo create a polygonal boundary surrounding the boreholes, do the following:  \n1. Click Display Options   to bring up the Display Options  dialog.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons and Solids  \n \n Page 12 of 17 \u00a9 Aquaveo 2024  2. Select \u201cBorehole Data\u201d from the list on the left.  \n3. Turn on Hole names  and turn off Horizon IDs . \n4. Click OK to close the Display Options  dialog.  \n5. Switch to Plan View  , then click on \u201c  Map Data \u201d in the Project Explorer . \n6. Using the Create Arc   tool, click out a closed arc surrounding all of the \nboreholes, as in Figure 10. Click on the starting point to close the polygon.  \n \n      Figure 10      Map polygon surrounding boreholes  \n7. Select Feature Objects | Build Polygons  to change the closed arc into a \npolygon.  \n8. Using the Select Arcs   tool, select the arc, then right -click on it and select \nRedistribute Vertices \u2026 to bring up the Redistribute Vertices dialog.  \n9. Select \u201cSpecified spacing\u201d from the Specify  drop-down.  \n10. Enter \u201c 50\u201d for the Average  spacing , and click OK to close the Redistribute \nVertices dialog.  \n5.3 Creating a TIN  \nThis polygon will now be used to create a TIN.  \n1. Select Feature Objects  | Map \u2192 TIN  to bring up the Properties  dialog.  \n2. Click OK to accept the default TIN properties and close the Properties  dialog.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons and Solids  \n \n Page 13 of 17 \u00a9 Aquaveo 2024  A TIN should now appear in the GMS graphics window and in the Project Explorer.  \n6 Creating the Solids  \nNow it is possible to create the solids from the borehole horizons.  \n1. In the Project Explorer, select the  \u201c Borehole data \u201d folder.  \n2. Select Boreholes  | Horizons \u2192 Solids  to bring up the Horizon Elevations  page \nof the Horizons to Solids  dialog.  \nThis is where the interpolation scheme used to create the solids is selected. This tutorial \nwill specify how the top and bottom elevation of the stratigraphy model will be \ndetermined.  \n3. Click Next  to proceed to the Top and Bottom Elevations page of the Horizons to \nSolids  dialog.  \n4. In the Top elevation  section, select Top of boreholes . This means that the top of \nevery borehole will be used in interpolating to the top of the solid . \n5. In the Bottom elevation  section, select the Constant elevation  option and enter a \nvalue of \u201c -37\u201d. \n6. Click Next  to move to the Build Solids page of the Horizons to Solids  dialog.  \n7. In the Interpolation method  section, select Inverse distance weighted .  \n8. Click Finish  to close the Horizons to Solids  dialog. After a few moments, a set of \nsolids will appear in the Project Explorer.  \n6.1 Viewing the Solids  \nTo view the solids:  \n1. Switch to Oblique View    to better see the stratigraphy.  \n2. Select the \u201c  Solid data \u201d folder in the Project Explorer.  \n3. Click Display Options   to bring up the Display Options  dialog.  \n4. Select \u201cSolid Data\u201d from the list on the left.  \n5. On the Solid  tab, turn on Solid faces  and click OK to close the Display Options  \ndialog.  \nThe result will be a simple solid model consisting of five different layers of materials.  \n6.2 Cutting Cross Sections  \nTo better view the solids, cut some cross sections . \n1. Switch to Plan View  . \n2. Using the Create Cross  Section   tool, cut three cross sections through the \nsolid, similar to the ones  shown in Figure 11. Single -click to begin making a cross \nsection and double -click to end.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons and Solids  \n \n Page 14 of 17 \u00a9 Aquaveo 2024   \nFigure 11      Cross  sections through stratigraphy model  \n3. In the Project Explorer , expand  the \u201c  Solid Data \u201d folder if necessary.  \n4. Turn off the \u201c  solids\u201d subfolder under the \u201c  Solid Data \u201d folder that contains \nthe solids just created.  \n5. Click  Display Options   to bring up the Display Options  dialog. \n6. Select \u201c Cross Sections \u201d from the list on the left.  \n7. On the Cross Section tab in the first section, turn on Cross section faces  and \nclick OK to close the Display Options  dialog.  \n8. Turn off the \u201c  TIN Data\u201d folder in the Project Explorer . \n9. Switch to Oblique View .  \nNow it is possible to see how the different solid surfaces vary ( Figure 12). \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons and Solids  \n \n Page 15 of 17 \u00a9 Aquaveo 2024   \n      Figure 12      Cross sections in Oblique View  \n6.3 Using Borehole Cross Section Data  \nThe next step is to use borehole cross sections to help guide the creation o f the solids. \nBorehole cross sections are different from cross sections that are cut through solids. \nThey are described in the \u201c Stratigraphy Modeling \u2014Boreholes and Cross Sections \u201d \ntutorial. If borehole cross sections have been created and the Use borehole cross section \ndata option is on in the Horizons to Solids  dialog, GMS will use the borehole cross \nsections to help guide the interpolation as it builds the solids.  \nIf cutting cross sections through the resulting solids, the solid cross sections would more \nclosely resemble the borehole cross sections (although they would not match exactly).  \nTo do this, import a previously defined set of cross sections:  \n1. Click New  to clear the current project from GMS. If asked to save the changes, \nclick Don\u2019t Save . \n2. Click Open   to bring up the Open  dialog.  \n3. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n4. Browse to the Horizons_and_Solids \\Horizons_and_Solids \\ directory  and select \n\u201cxsects.gpr\u201d . \n5. Click Open  to import the project file and close the Open  dialog.  \nIt should now be possible to see the cross sections that have been created between the \nboreholes.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons and Solids  \n \n Page 16 of 17 \u00a9 Aquaveo 2024  6. Click on the \u201c  Borehole Data \u201d folder in the Project Explorer . \n7. Select Boreholes  | Horizons \u2192 Solids  to bring up the Horizons to Solids dialog.  \n8. In the Boreholes  section, turn on Use borehole cross section s and click Finish  to \nclose the Horizons to Solids dialog.  \nAfter a few moments, the solids will appear in the Graph ics Window and in the Project \nExplorer ( Figure 13). \n \n      Figure 13      Solids with the borehole cross sections  \n6.4 Cutting Cross Sections  \nThe next step is to create cross sections through the solids in the same location as the \nborehole cross sections. They can be created in any order.  \n1. Switch to Plan View   and select the \u201c  Solid Data\u201d  folder. \n2. Using the Create Cross Section   tool, create solid cross sections in the \napproximate location where the borehole cross sections are. First, single -click on \nhole 1G, then single -click on holes 7G, 2G, 5G, and 6G, and  then finish by \ndouble -clicking on hole 8G. \n3. Create another cross section  between holes 3G, 6G, and 7G. \n4. Create the final cross section between holes 4G and 5G. \nTo view the newly created solid cross sections, do the following:  \n5. In the Project Explorer  under the \u201c  Borehole Data \u201d folder, turn off the  \u201c \nCross Sections \u201d folder to hide all of the solids.  \n6. In the Project Explorer  under the \u201c  Solid Data \u201d folder , uncheck the box next to \nthe \u201c  solids \u201d folder to hide all of the solids.  \n7. Switch to Oblique View  . \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons and Solids  \n \n Page 17 of 17 \u00a9 Aquaveo 2024  The cross sections created from the solids should now be visible. The solid cross \nsections should look very similar to the borehole cross sections. Feel free to turn the \n\u201cCross Sections\u201d folder on and off to see the difference between the two sets of cross \nsections.  \n7 Conclusion  \nThis concludes the \u201cStratigraphy Modeling \u2013 Horizons a nd Solids\u201d tutorial. The following \nkey topics were discussed and demonstrated:  \n\uf0b7 Solids can be created directly from boreholes if horizon numbers are assigned to \nthe borehole contacts.  \n\uf0b7 If the borehole data is too complex, us e the T -PROGS approach rather than  \ncreate cross sections and assign horizon IDs.  \n\uf0b7 Horizons are numbered consecutively in the order that the strata are deposited, \nfrom the bottom up.  \n\uf0b7 Horizon IDs can be automatically assigned to all boreholes, but it will take a long \ntime for a large, complex  set of boreholes.  \n\uf0b7 Solids can be created from horizons.  \n\uf0b7 Borehole cross sections can be used to further control the Horizons \u2192 Solids  \nprocess.  \n \n", "filename": "StratigraphyModeling-HorizonsAndSolids.pdf", "pages": 17}, "StratigraphyModeling-HorizonsTINsAndMeshes": {"text": "GMS Tutorials   Stratigraphy Modeling \u2013 Horizon s, TINs,  and Meshe s \n Page 1 of 8 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nStratigraphy Modeling \u2013 Horizon s, TINs,  and Meshes  \nUse TINs with horizons to create 3D, finite element meshes  \nObjectives   \nLearn how to use TINs to assign horizon surfaces and how to create three -dimensional, finite -element \nmeshes from the horizon data . \n \nPrerequisite Tutorials  \n\uf0b7 Stratigraphy Modeling \u2013 \nHorizons and Solids  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 Subsurface  \n\uf0b7 Geostatistics  Time  \n\uf0b7 15\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizon s, TINs,  and Meshe s \n Page 2 of 8 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Reading Scatter Data  ................................ ................................ ................................ ...........  2 \n3 Constructing the Meshing Conceptual Model  ................................ ................................ ... 3 \n3.1 Setting up the Conceptual Model  ................................ ................................ ..................  3 \n3.2 Creating the Meshing Polygon  ................................ ................................ ......................  3 \n4 Creating Horizon Surfaces  ................................ ................................ ................................ .. 5 \n4.1 Create the Tins  ................................ ................................ ................................ .............  5 \n4.2 Interp olate  ................................ ................................ ................................ .....................  5 \n4.3 View the Surfaces  ................................ ................................ ................................ .........  6 \n4.4 Organize TINs into a Folder  ................................ ................................ ..........................  6 \n5 Creating the Mesh ................................ ................................ ................................ ................  7 \n5.1 Viewing the 3D Mesh  ................................ ................................ ................................ .... 7 \n6 Conclusion  ................................ ................................ ................................ ...........................  8 \n \n1 Introduction  \nThis tutorial builds on the concepts taught in the tutorial entitled \u201c Stratigraphy Modeling  \u2014\nHorizons and Solids \u201d. In that tutorial, solids were created using horizons defined on \nboreholes and cross sections. This tutorial demonstrates how to use TINs to assign \nhorizon surfaces and how to create three -dimensional, finite element meshes from the \nhorizon data.  \nCreating a three -dimensional mesh of soil stratigraphy using th e horizons approach in \nGMS is accomplished in just a few steps. First, import a set of scatter data. The second \nstep creates a meshing conceptual model. Third, use the conceptual model and scatter \ndata to create the TIN horizon surfaces. Finally, execute t he Horizons \u2192 3D Mesh  \ncommand to create a three -dimensional mesh.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program \nsettings are restored to their default sta te. \n2 Reading Scatter Data  \nThe first step in the construction of the 3D mesh is to import the scatter data. Scatter data \ncan be entered into GMS manually, or the data can be import from a file. In the interest of \ntime, import a previously prepared file by do ing the following:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the Horizons_TINs_and_Meshes \\Horizons_TINs_and_Meshes \\ \ndirectory and select \u201c scatter.gpr \u201d. \n4. Click Open  to import the project and close the Open  dialog.  \nThe Graphics Window should appear similar to Figure 1. \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons , TINs,  and Meshe s \n \n Page 3 of 8 \u00a9 Aquaveo 2024   \n      Figure 1      Scatter set dat a after importing the project file  \n3 Constructing the Meshing Conceptual Model  \nA conceptual model needs to be constructed here by using the map module. The \nconceptual model will contain a coverage that is used to define the TIN layers and a 2D \nmesh. The 2D m esh will then be used to define the topology and boundary of the 3D \nmesh.  \n3.1 Setting up the Conceptual Model  \n1. Right -click on an empty space in the Project Explorer and select New | \nConceptual Model \u2026 to bring up the Conceptual Model Properties  dialog.  \n2. Enter \u201c Case1 \u201d as the Name . \n3. Select \u201c FEMWATER \u201d from the Type  drop-down.  \n4. Click  OK to close the Conceptual Model Properties  dialog.  \nA FEMWATER model is not going to be created here. However, it is necessary to have a \ncoverage that can be used to create a 2D mesh, som ething possible with a FEMWATER \nconceptual model.  \n5. Right -click on the \u201c  Case1\u201d conceptual model and select New Coverage \u2026 \nto bring up the Coverage Setup dialog.  \n6. Enter \u201c mesh1 \u201d as the Coverage name . \n7. In the Areal Properties  section, turn on Meshing options . \n8. Click OK to create the new coverage and exit the Coverage Setup  dialog . \n3.2 Creating the Meshing Polygon  \nDo the following to create a polygonal boundary:  \n1. Select \u201c  mesh1\u201d in the Project Explorer to make it active.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons , TINs,  and Meshe s \n \n Page 4 of 8 \u00a9 Aquaveo 2024  2. Switch to Plan View  . \n3. Using the Create Arc   tool, click out a closed arc as shown in Figure 2. \nClick on the starting point to finish creating the closed arc.  \n \n      Figure 2      Closed  arc enclosing the scatter points  \n4. Select Feature Objects | Build Polygons  to convert the closed arc into a \npolygon.  \n5. Using the Select Arcs   tool, select the arc, right -click on it, and select \nRedistribute Vertices \u2026 to bring up the Redistribute Vertices  dialog.  \n6. Select \u201c Specified Spacing \u201d from the Specify  drop-down.  \n7. Enter \u201c 150\u201d for Average spacing  and click OK to close the Redistribute \nVertices  dialog.  \nThe Graphics Window should appear similar to Figure 3. \n \n      Figure 3      The polygon with redistributed vertices  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons , TINs,  and Meshe s \n \n Page 5 of 8 \u00a9 Aquaveo 2024  4 Creating Horizon Surfaces  \nThe newly defined polygon can now be used to create the TIN horizons.  \n4.1 Create the Tins  \n1. Right -click on th e \u201c  mesh1 \u201d coverage and select Map To | TIN to bring up \nthe Properties  dialog.  \n2. Enter \u201c Case1_Hor4 \u201d for the TIN name . \n3. Select \u201c Fine Sand \u201d from the TIN material  drop-down.  \n4. Enter \u201c 4\u201d as the Horizon ID . \n5. Click OK to close the Properties  dialog.  \n6. Repeat steps 1 \u20135 to create 3 more TINs from the coverage with the following \nproperties:  \n \n 1 2 3 \nTIN Name : Case1_Hor3  Case1_Hor2  Case1_Bot  \nTIN Material : Silty Clay  Silty Sand  Bedrock  \nHorizon ID : 3 2 0 \n4.2 Interpolate  \nThe next step is to interpolate the layer elevations from  the scatter sets to the TINs.  \n1. In the Project Explorer , select \u201c  Case1_Hor4 \u201d to make it active.  \n2. If necessary, expand the \u201c  2D Scatter Data\u201d folder and the \u201c  Case 1\u201d sub -\nfolder in the Project Explorer . \n3. Select \u201c  top1\u201d under the \u201c  Case 1 \u201d scatter set to make it active.  \n4. Right -click on \u201c  Case 1 \u201d and select Interpolate To | Active TIN  to bring up \nthe Interpolate \u2192 Object dialog.  \n5. Click OK to interpolate the values and close the Interpolate \u2192 Object dialog.  \n6. In the Project Explorer , expand the \u201c  Case1_Hor4 \u201d TIN, right -click on the \u201c\n default \u201d dataset,  and select Delete . \n7. Repeat steps 1 \u20136 to interpolate all of the remaining layer elevations to the \ncorresponding TIN horizons as seen in the following table:  \nCase 1  \nScatter Set Dataset  TIN \nbot1 Case1_Hor3  \nbot2 Case1_Hor2  \nbot3 Case1 _Bot \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons , TINs,  and Meshe s \n \n Page 6 of 8 \u00a9 Aquaveo 2024  4.3 View the Surfaces  \nTo view the horizon surfaces:  \n1. Switch to Oblique View  . The Graphics Window should appear similar to \nFigure 4. \n2. Select the  Rotate   tool and drag the mouse  in the graphics window to rotate \nthe view.  \n \n      Figure 4      After interpolating the layer elevations  \n4.4 Organize TINs into a Folder  \nNow it is possible to organize the TINs into a folder to be used in the horizons process.  \n1. In the Project Explorer , right -click on \u201c  Tin Data \u201d and select New Folder . \n2. Enter \u201c Case1 \u201d and press the Enter  key to set the new name.  \n3. In the Project Explore r, drag and drop each of the four TINs into the \u201c  \nCase1 \u201d folder (see Figure 5).  \n \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons , TINs,  and Meshe s \n \n Page 7 of 8 \u00a9 Aquaveo 2024        Figure 5      TINs organized into a folder  \n5 Creating the Mesh  \nDo the following to create the mesh from the T IN horizons:  \n1. Right -click on the \u201c  mesh1 \u201d coverage and select Map To | 2D Mesh . This 2D \nmesh is needed in order to generate the 3D mesh.  \n2. Select the  \u201c TIN Data \u201d folder, then select TINs  | Horizons \u2192 3D Mesh \u2026 to \nbring up the Horizon Elevations  page of the Horizons to Mesh dialog . \nThis allows selection of the interpolation scheme to be used in creating the mesh. The \nnext steps specify how the top and bottom elevations of the stratigraphy model will be \ndetermined.  \n3. In the TINs  section, select the Select TIN  folder  option.  \n4. Select the \u201c Case1 \u201d folder in the tree window, and click the Next  button to close \nthe Horizon Elevations  page and open the Top and Bottom Elevations  page of \nthe Horizons to Mesh dialog . \n5. In the Top elevation  section, select the TIN elevations option. This means that \nthe specified TIN surface will be used in interpolating to the top of the 3D \nMesh.  \n6. Select the \u201c Case1_Hor4 \u201d TIN to be used as the top elevation in the tree \nwindow.  \n7. In the Bottom elevation  section, select the TIN elevations option and  select the \n\u201cCase1_Bot \u201d TIN.  \n8. Click the Next  button to close the Top and Bottom Elevations  page and open \nthe Build Mesh  page of the Horizons to Mesh dialog . \n9. In the Interpolation method  section, select the Inverse distance weighted  \noption.  \n10. Select the Finish  button to close the Horizons to Mesh dialog .  \nA simple 3D Mesh has been created consisting of three different layers of materials.  \n5.1 Viewing the 3D Mesh  \nTo view the mesh:  \n1. Select the \u201c  3D Mesh Data\u201d folder and click Display Options   to bring up \nthe Display Options  dialog.  \n2. Select \u201c3D Mesh Data\u201d from the list on the left.  \n3. On the 3D Mesh  tab in the first section, turn on Element  faces . \n4. Click OK to close the Display Options  dialog. The Graphics Window should \nappear similar to Figure 6. \n5. Using  the Rotate   tool, drag the mouse  to rotate the view.   \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons , TINs,  and Meshe s \n \n Page 8 of 8 \u00a9 Aquaveo 2024   \n      Figure 6      The final view after the 3D mesh is created  \n6 Conclusion  \nThis concludes the \u201cStratigra phy Modeling \u2013 Horizons, TINs, and Meshes\u201d tutorial. \nIncluded in the project file are four other scatter sets that can be used to create different \nlayer elevations. A project could interpolate these values to the TIN horizons and create \ndifferent meshes. F eel free to experiment with those scatter sets.  \nThe key concepts demonstrated in this tutorial  include:  \n\uf0b7 TINs can be used to create horizon surfaces.  \n\uf0b7 A 3D mesh can be created directly from horizon data.  \n\uf0b7 The Horizons  command can operate on just a subset of t he TINs or boreholes in \nthe project.  \n \n\n", "filename": "StratigraphyModeling-HorizonsTINsAndMeshes.pdf", "pages": 8}, "StratigraphyModeling-HorizonsWithRasters": {"text": "GMS Tutorials   Stratigraphy Modeling \u2013 Horizons with Rasters  \n Page 1 of 11 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nStratigraphy Modeling \u2013 Horizons with Rasters  \nCreate UGrids  from rasters using the 3D UGrid from Rasters  tool \nObjectives   \nLearn what a raster  catalog is and how it can be used to create subsurface models.  \n \nPrerequisite Tutorials  \n\uf0b7 Stratigraphy Modeling \u2013 \nHorizons and Solids  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 Subsurface  \n\uf0b7 Geostatistics  Time  \n\uf0b7 20\u201330 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons with Rasters  \n Page 2 of 11 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Importing the Project  ................................ ................................ ................................ ...........  2 \n3 Viewing Raster Elevations  ................................ ................................ ................................ .. 3 \n4 Using the 3D UGrid from Rasters Tool  ................................ ................................ ..............  4 \n4.1 Viewing the UGrid  ................................ ................................ ................................ .........  5 \n5 Changing the Fill and Clip Fields  ................................ ................................ .......................  5 \n5.1 Viewing the UGrid  ................................ ................................ ................................ .........  6 \n5.2 Chan ging the Clip Field  ................................ ................................ ................................  7 \n5.3 Viewing the UGrid  ................................ ................................ ................................ .........  8 \n6 Sacramento Data  ................................ ................................ ................................ .................  8 \n6.1 Creating  the UGrid  ................................ ................................ ................................ ........  9 \n6.2 Viewing the UGrid  ................................ ................................ ................................ ....... 10 \n7 Conclusion  ................................ ................................ ................................ .........................  11 \n \n1 Introduction  \nThis tutorial builds on the concepts taught in the \u201c Stratigraphy Modeling \u2014Horizons and \nSolids \u201d tutorial. In that tutorial, solids were created using horizons defined on boreholes \nand cross sections. In this tutorial, horizons will be assigned to rasters and then used to \ncreate 3D unstructured grids ( UGrids ). This tutorial will begin with a simple problem to \nillustrate the concepts involved in using rasters to create UGrids . Then this tutorial will \napply the method to data from Sacramento, California, USA.  \nThis tutorial will demonstrate the following:  \n1. Import a project with rasters.  \n2. Create a raster catalog and assign horizon IDs.  \n3. Create UGrids  from the horizons.  \n4. Repeat these steps using data from the Sacramento, California region.  \n1.1 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select the File | New command to ensure that the \nprogram settings are restored to their default state.  \n2 Importing the Project  \nThe first step in the construction of the UGrid  is to import a set of borehole logs. Borehole \ndata can be entered into GMS manually, or the data can be read from a file. In the \ninterest of time, import a previously prepared file by doing the following:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to the Horizons_with_Rasters \\Horizons_ with_Rasters  directory and \nselect \u201crasters.gpr \u201d. \n4. Click Open  to import the project and close the Open  dialog.  \nA 2D UGrid  and multiple rasters have been loaded into this GMS project ( Figure 1). \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons with Rasters  \n \n Page 3 of 11 \u00a9 Aquaveo 2024   \n      Figure 1      Tin and rasters displayed in the Graphics Window  \n3 Viewing Raster Elevations  \nThe display options are currently set to view the rasters as points.  \n1. Switch to Oblique View  . \n2. Frame  the project.  \nThe two lower rasters slope upward toward the right of the image. The upper two rasters \nare at constant elevations ( Figure 2). \n \n      Figure 2      Raster surfaces  \nThe next step is to change the display of the raster to background imagery.  \n3. Change to Plan View  . \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons with Rasters  \n \n Page 4 of 11 \u00a9 Aquaveo 2024  4. In the Project Explorer, select \u201c  unit1\u201d then hold the Shift key and select \u201c  \nbottom \u201d to select all of the rasters.  \n5. Right-click on any of the rasters in the Project Explorer  and select Display \nOptions\u2026  to bring up the Raster Display Options  dialog.  \n6. In the All Rasters  section, select Display as 2D image  and click OK to exit the \nRaster Display Options  dialog.  \n7. In the Project Explorer, hide all of the rasters except \u201c unit1\u201d.  \nThe Graphics Window should now appear similar to Figure 3. \n8. When  done , turn on the other rasters in the Project Explorer.  \n \n      Figure 3      Rasters displayed as background imagery  \n4 Using the 3D UGrid from Rasters Tool  \nThe 3D UGrid from Rasters tool create s a 3D UGrid using one or more rasters contained \nin the project. With the  rasters imported in the project, they can now be used to generate  \n3D UGrid.  \n1. Click the Toolbox    macro to open the Toolbox  dialog.  \n2. In the Tools  tab, expand the \u201c  Unstructured Grids\u201d folder.  \n3. Double -click on the 3D UGrid  from Rasters  tool to open the 3D UGrid  from \nRasters  dialog.  \n4. For the 2D UGrid  drop-down, make certain \u201cUGrid Data/ugrid (2)\u201d is selected.  \n5. In the Rasters  section, click the Add Row   button five times so there are five \nrows.  \n6. Using the following table , select the correct raster that matches the Horizon ID: \n \nHorizon ID  Raster  Fill Clip \n5 unit4  \u221a  \n4 unit3  \u221a  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons with Rasters  \n \n Page 5 of 11 \u00a9 Aquaveo 2024  3 unit2 \u221a  \n2 unit1 \u221a  \n1 bottom  \u221a  \n9. For the 3D UGrid  name, enter \u201c3d ugrid\u201d . \n10. Select OK to run the 3D UGrid from R aster  dialog.  \n11. When the tool finishes, click OK to close the 3D UGrid  from Raster  dialog.  \n4.1 Viewing the UGrid  \nThe 3D UGrid from Rasters  process should complete quickly, and a new UGrid will  \nappear in the Project Explorer . \n1. Switch to Oblique View  . \n2. In the Project Explorer, under  the \u201c 3d ugrid\u201d, select \u201c  Cell Bottom Z\u201d.  \n3. Turn off \u201c  ugrid (2)\u201d.  \nThe 3D Ugrid  should look similar to Figure 4. Notice how the lower two layers extend \nupward on the left side of the UGrid  and cut off the upper tw o layers.  \n \n      Figure 4      UGrid  created from raster catalog  \n5 Changing the Fill and Clip Fields  \nNow see the effect of changing the Fill and Clip fields in the raster catalog. When the \nraster catalog was first created and the di alog appeared, the check boxes for the Fill field \nwere on by default. The Fill field indicates to use the raster to create a UGrid layer . It \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons with Rasters  \n \n Page 6 of 11 \u00a9 Aquaveo 2024  means the 3D UGrid from Rasters  operation will Fill between this raster and the lower \nsurfaces. If the Fill field is turned off, then it will not create a layer  that is associated with \nthe particular raster. The Clip field is used to indicate a surface that \u201cClips\u201d or truncates \nany lower surfaces. This process is best illustrated by the following steps:  \n1. Click t he Toolbox    macro to open the Toolbox  dialog.  \n2. In the Tools  tab, expand the \u201c  Unstructured Grids\u201d folder.  \n3. Double -click on the 3D UGrid from Rasters  tool to open the 3D UGrid from \nRasters dialog.  \n4. For the 2D UGrid  drop-down, make certain \u201cUGrid Data/ugrid (2)\u201d is selected.  \n5. In the Rasters  section, click the Add Row   button five times so there are five \nrows.  \n6. Using the table below, select the correct raster that matches the Horizon ID and \nturn off the Fill for the \u201c  unit3\u201d raster : \nHorizon ID  Raster  Fill Clip \n5 unit4  \u221a  \n4 unit3   \n3 unit2 \u221a  \n2 unit1 \u221a  \n1 bottom  \u221a  \n7. For the 3D UGrid  name, enter \u201c3d ugrid fill\u201d.  \n8. Select OK to run the 3D UGrid from R aster  dialog.  \n9. When the tool finishes, click OK to close the 3D UGrid from Raster  dialog.   \n5.1 Viewing the UGrid  \nWhen the 3D UGrid from Rasters  process  is finished, another UGrid will have been \ncreated . To view the new UGrid, do the following:  \n1. In the Project Explorer, hide \u201c  3d ugrid\u201d.  \n2. Under the \u201c  3d ugrid fill\u201d, select \u201c  Cell Bottom Z\u201d . \nThe UGrid  should look like Figure 5 below. Notice that no layer  was created for \u201c unit3 \u201d.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons with Rasters  \n \n Page 7 of 11 \u00a9 Aquaveo 2024   \n      Figure 5      UGrid  created with the \u201cFill\u201d field of f for the unit3  raster  \n5.2 Changing the Clip Field  \nNow it is possible to change the Clip field for the \u201c  unit3 \u201d raster and view the effect.  \n1. Click the Toolbox    macro to open the Toolbox  dialog.  \n2. In the Tools  tab, expand the \u201c  Unstructured Grids\u201d folder.  \n3. Double -click on the 3D UGrid from Rasters  tool to open the 3D UGrid from \nRasters dialog.  \n4. For the 2D UGrid  drop-down, make certain \u201cUGrid Data/ugrid (2)\u201d is selected.  \n5. In the Rasters  section, click the Add Row   button five times so there are five \nrows.  \n6. Using the table below, select the correct raster that matches the Horizon ID and \nchange the Fill and Clip for the \u201c  unit3\u201d raster : \nHorizon ID  Raster  Fill Clip \n5 unit4  \u221a  \n4 unit3  \u221a \n3 unit2 \u221a  \n2 unit1 \u221a  \n1 bottom  \u221a  \n7. For the 3D UGrid  name, enter \u201c3d ugrid  clip\u201d. \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons with Rasters  \n \n Page 8 of 11 \u00a9 Aquaveo 2024  8. Select OK to run the 3D UGrid from R aster  dialog.  \n9. When the tool finishes, click OK to close the 3D UGrid from Raster  dialog.  \n5.3 Viewing the UGrid  \n1. In the Project Explorer, hide \u201c  3d ugrid fill\u201d.  \n2. Under the \u201c  3d ugrid clip\u201d, select \u201c  Cell Bottom Z\u201d . \nThe UGrid  should look like Figure 6 below. Notice that while no layer  was created for \nunit3 , the raster was used to \"clip\" or truncate the units as seen in Figure 6. \n \n      Figure 6      UGrid  created with the \u201cClip\u201d field on for the unit3 raster  \n6 Sacramento Data  \nIt is now possible to use what has been learned to create a UGrid using  data from the \nSacramento Valley.  \n1. Select the File | New command.  \n2. Select Don\u2019t Save when asked to save the project.  \n3. Select the Open   button to bring up the Open  dialog.  \n4. Select \u201cProjec t Files (*.gpr)\u201d from the Files of type  drop-down.  \n5. Browse to the directory entitled Horizons_with_Rasters \\Horizons_with_Rasters \\ \nand select the file named \u201c sacramento.gpr \u201d. \n6. Click Open  to import the project and close the Open  dialog.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons with Rasters  \n \n Page 9 of 11 \u00a9 Aquaveo 2024  The Figure 7 image should be visible in the GMS graphics window. This project contains \ntwo TINs to define the top and bottom of the UGrid , a map coverage with the surface  \ngeology, multiple rasters to define top elevations for stratigraphic units, and an aerial  \nphoto of the Sacramento region.  \n \n      Figure 7      Map view of Sacramento Region  Data  \n6.1 Creating the UGrid  \nIt is now possible to convert th e rasters to a UGrid by doing the following:  \n1. Click the Toolbox   macro to open the Toolbox  dialog.  \n2. In the Tools  tab, expand the \u201c  Unstructured Grids\u201d folder.  \n3. Double -click on the 3D UGrid from Rasters  tool to open the 3D UGrid from \nRasters dialog.  \n4. For the  2D UGrid  drop-down, make certain \u201cUGrid Data/ugrid\u201d is selected.  \n5. In the Rasters  section, click the Add Row   button seven  times so there are \nseven  rows.  \n6. Using the following table, select the correct raster that matches the Horizon ID. \nHorizon ID  Raster  Fill Clip \n7 sacramento top \u221a  \n6 TOP7.bil  \u221a  \n5 TOP6.bil  \u221a  \n4 TOP4.bil  \u221a  \n3 TOP2.bil  \u221a  \n2 TOP1.bil  \u221a  \n1 sacramento bottom  \u221a  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons with Rasters  \n \n Page 10 of 11 \u00a9 Aquaveo 2024  7. For the Minimu m layer  thickness  option , enter a value of  \u201c1.0\u201d. \n8. For the 3D UGrid  name, enter \u201c3d ugrid\u201d.  \n9. Select OK to run the 3D UGrid from R aster  dialog.  \n10. When the tool finishes, click OK to close the 3D UGrid from Raster  dialog . \n6.2 Viewing the UGrid  \nWhen the 3D UGrid from Rasters  process finishes, a new UGrid will appear in the Project \nExplorer . \n1. Switch to Oblique View  . \n2. In the Project Explorer, under the \u201c  3d ugrid\u201d, select \u201c  Cell Bottom Z\u201d.  \n3. Click the Display Options   macro to open the Display Options  dialog.  \n4. From the list on the left,  select \u201cUGrid: 3d ugrid \u2013 [Active]\u201d. \n5. Turn off the Cell edge  option and turn on the Face contours option.  \n6. Click the Options  button to open the Dataset Contour Options  dialog.  \n7. Change the Contour method  to \u201cColor Fill\u201d  \n8. Click OK to close the Dataset Contour Options  dialog.  \n9. Click OK to close the Display Options  dialog.  \nThe UGrid  should appear  like Figure 8 below.  \n  \n      Figure 8      UGrid  of the Sacramento Valley  \nIf desire d, rotate the view, apply lighting, adjust the display o ptions, or cut cross sections \nthrough the UGrids .  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 Horizons with Rasters  \n \n Page 11 of 11 \u00a9 Aquaveo 2024  7 Conclusion  \nThis concludes the \u201cStratigraphy Modeling \u2013 Horizons with Rasters\u201d tutorial. Here are \nsome of the key concepts in this tutorial : \n\uf0b7 Rasters can be used to create UGrids . \n\uf0b7 To use rasters  with the horizons method, it is necessary to use the 3D UGrid \nfrom Rasters  tool. \n", "filename": "StratigraphyModeling-HorizonsWithRasters.pdf", "pages": 11}, "StratigraphyModeling-TINs": {"text": "GMS Tutorials   Stratigraphy Modeling \u2013 TIN Surfaces  \n Page 1 of 12 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nStratigraphy Modeling \u2013 TIN Surface  \nIntroduction to the TIN (T riangulated Irregular Network) s urface object  \nObjectives   \nLearn to create, read, alter, and manage TIN data from within GMS . \n \nPrerequisite Tutorials  \n\uf0b7 None  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 Subsurface  \n\uf0b7 Geostatistics  Time  \n\uf0b7 20\u201335 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   Stratigraphy Modeling \u2013 TIN Surfaces  \n Page 2 of 12 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Getting Started  ................................ ................................ ................................ ..............  2 \n2 Importing Vertices  ................................ ................................ ................................ ...............  2 \n3 Triangulating  ................................ ................................ ................................ ........................  3 \n4 Contouring  ................................ ................................ ................................ ...........................  4 \n5 Lighting  ................................ ................................ ................................ ................................  5 \n6 Editing TINs  ................................ ................................ ................................ ..........................  6 \n6.1 Locking/Unlocking Vertices  ................................ ................................ ...........................  6 \n6.2 Dragging Vertices  ................................ ................................ ................................ .........  7 \n6.3 Dragging in Oblique View  ................................ ................................ .............................  7 \n6.4 Using the Edit Window  ................................ ................................ ................................ .. 7 \n6.5 Adding Vertices  ................................ ................................ ................................ .............  7 \n6.6 Deleting Vertices  ................................ ................................ ................................ ...........  8 \n7 Smoothing a TIN  ................................ ................................ ................................ ..................  8 \n7.1 Deleting  the TIN  ................................ ................................ ................................ ............  8 \n7.2 Copying the Vertices  ................................ ................................ ................................ ..... 9 \n7.3 Subdividing the TIN  ................................ ................................ ................................ ...... 9 \n7.4 Interpolating the Elevations  ................................ ................................ ........................  10 \n7.5 Deleting the Scatter Point Set  ................................ ................................ .....................  11 \n8 Importing TIN  ................................ ................................ ................................ .....................  11 \n9 Changing the Active TIN  ................................ ................................ ................................ ... 11 \n10 Hiding and Showing TINs  ................................ ................................ ................................ . 12 \n11 Conclusion  ................................ ................................ ................................ .........................  12 \n \n1 Introduction  \nThe TIN module in GMS is used for general -purpose surface modeling. TIN is an \nacronym for \u201cTriangulated Irregular Network\u201d. TINs are formed by connecting a set of xyz \npoints with edges to form a network of triangles. The surface varies linearly across each \ntriang le. TINs can be used to represent the surface of a geologic unit or the surface \ndefined by a mathematical function. Elevations or other values associated with TINs can \nbe displayed with contours. TINs are used in the construction of solid models and 3D \nfinite-element meshes.  \nThe tutorial will demonstrate and discuss creating a TIN by importing vertices and \ntriangulating, changing the contour and lighting options, editing the TIN vertices, \nsmoothing the TIN, importing another TIN, and managing multiple TINs.  \n1.1 Getting Started  \nTo get started, do the following:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n2 Importing Vertices  \nIt is first necessary to import a set of vertices from a file into the TIN module to begin \nreviewing the tools available for TIN modeling. To import the vertices, do the following:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n3. Browse to  the TINs \\TINs \\ directory and select \u201c verts.gpr\u201d . \n\nGMS Tutorials   Stratigraphy Modeling \u2013 TIN Surfaces  \n \n Page 3 of 12 \u00a9 Aquaveo 2024  4. Click Open  to import the project and close the Open  dialog.  \nA set of vertices should appear on the screen ( Figure 1). The vertices are not yet \nconnected by triangles.  \n \n      Figure 1      The imported vertices  \n3 Triangulating  \nTo construct a TIN, it is necessary to triangulate the set of imported vertices by doing the \nfollowing:  \n1. In the  Project Expl orer, expand the \u201c  TIN Data\u201d  item so that the \u201c  verts\u201d TIN \ncan be seen.  \n2. Right -click on \u201c  verts \u201d and select Triangulate . \nThe vertices should now be connected with edges forming a network of triangles. The \ntriangulation is performed automatically using the Delaunay criterion. The Delaunay \ncriterion ensures that the triangles are as equiangular as possible. In other words, \nwherever possible, long, thin triangles are avoided. A more complete description of the \ntriangulation algorithm can be found in the GMS User\u2019s Manual . \nSome long, skinny triangles on the border need to be deleted. GMS can find them \nautomatically.  \n3. Select TINs |  Advanced | Select Boundary Triangles  to select the long, skinny \ntriangles.  \n4. Press the Delete  key to remove them.  \nThe long, skinny triangles are now gone. The Main Graphics Window should appear \nsimilar to Figure 2. \n\nGMS Tutorials   Stratigraphy Modeling \u2013 TIN Surfaces  \n \n Page 4 of 12 \u00a9 Aquaveo 2024   \n      Figure 2      The vertices triangulated with the long, skinny triangles deleted  \n4 Contouring  \nNow that the TIN is constructed, it can be used to generate a contour plot of the TIN \nelevations.  \n1. Click Display Options   to bring up the Display Options  dialog.  \n2. Select \u201cTIN Data\u201d from the list on the left.  \n3. In the top section, turn off Vertices and Triangle edges  and turn on TIN boundary . \n4. In the lower section, turn on Contours . \n5. Click OK to close the Display Options  dialog . \nThe contours are generated by assuming that the TIN defines a surface that varies \nlinearly across the face of each triangle (       Figure 3). \n \n      Figure 3      TIN showing the boundary and contours  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 TIN Surfaces  \n \n Page 5 of 12 \u00a9 Aquaveo 2024  5 Lighting  \nAnother way to visualize a TIN is to use a light source.  \n1. Click Display Options   to bring up the Display Options  dialog.  \n2. Select \u201cTIN Data\u201d from the l ist on the left.  \n3. In the top section, turn off TIN boundary  and turn on  Triangle faces . \n4. In the bottom section, turn off Contours . \n5. Select \u201c Lighting Options \u201d from the list on the left.  \n6. Turn on Enable lights . \n7. Drag the selected light sphere so it appears as in Figure 4. \n \n      Figure 4      Lighting Options settings  \n8. Click OK to exit the Display Options  dialog . \n9.  Select the Oblique View   button.  \nThe TIN should now be shaded with a patterned red material as seen in Figure 5. The \nmaterial color and pattern can be adjusted be clicking on the Material   macro, th ough \nthat is not covered in this tutorial.  \n \n      Figure 5      TIN with triangle faces, patterned material, and a light source  \n10. Use the Rotate   tool to drag the mouse  in the graphics window and rotate the \nview.  \nFeel free to experiment with the lighting options to see the different display effects for the \nTIN. \n\nGMS Tutorials   Stratigraphy Modeling \u2013 TIN Surfaces  \n \n Page 6 of 12 \u00a9 Aquaveo 2024  6 Editing TINs  \nA variety of tools are provided in GMS for editing TINs. Before reviewing these tools, it is \nimportant to reset some of the display options.  \n1. Click Display O ptions   to bring up the Display Options  dialog.  \n2. Select \u201cTIN Data\u201d from the list on the left.  \n3. In the top section, turn on Vertices  and Triangle  edges , and turn off Triangle \nfaces . \n4. In the bottom section, turn on Contours . \n5. Click the Options \u2026 button to the ri ght of Contours  to bring up the Dataset \nContour Options \u2013 TIN \u2013 default  dialog . \n6. In Contour interval  section , select \u201c Specified Interval\u201d  from the drop -down and \nenter \u201c 20.0\u201d in the field to the right.  \n7. Click OK to exit the Dataset Contour Options \u2013 TIN \u2013 default  dialog . \n8. Click OK to exit the Display Options  dialog. The Graphics Window should appear \nas in Figure 6. \n \n      Figure 6      The Gra phics Window after the Display Options have been reset  \n6.1 Locking/Unlocking Vertices  \nIn many cases, some of the vertices defining a TIN come from actual measured data \u2014\nsuch as a borehole log \u2014and can be considered \u201chard\u201d data. In other cases, vertices are \nadded  manually and represent \u201csoft\u201d data simply used to fill in gaps. By default, TIN \nvertices are locked and not editable so that a vertex corresponding to an actual \nmeasurement is not accidentally edited. Editing TIN vertices can be accomplished by \nunlocking the vertices.  \n1. Select  TINs  | Lock All Vertices  to unlock the vertices.  \n2. Notice that this removed the check mark next to this menu option by selecting the \nTINs  menu again.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 TIN Surfaces  \n \n Page 7 of 12 \u00a9 Aquaveo 2024  The TIN vertices are now unlocked and can be edited. Unlocked vertices can be locked \nby again selecting the TINs  | Lock All Vertices  menu command.  \n6.2 Dragging Vertices  \nOne of the simplest ways to edit a TIN is to drag the vertices with the mouse. This can be \naccomplished with the Select Vertices   tool. \n1. Select the Plan View   button.  \n2. Using the Select Vertices    tool, choose one of the vertices in the interior of \nthe TIN and drag it to a new location.  \nNotice that it is not possible to drag an interior vertex beyond the boundaries of the \nadjacent triangles. This prevents the triangles f rom becoming inverted.  \n6.3 Dragging in Oblique View  \nWhen dragging in plan view, the vertex is constrained to move in the xy plane. To change \nthe z coordinate, it is necessary to drag the vertices in oblique view (or front or side view).  \n1. Switch to Oblique View  . \n2. Using the Select Vertices   tool, select one of the vertices and drag the vertex \nup and down.  \nNotice that as dragging the vertex in oblique view, the vertex can only be moved along \nthe z axis. \n6.4 Using the Edit Window  \nIn many cases, dragging vertices with the mouse is not adequately precise. It is often \nnecessary to change the vertex coordinates to a specific value. This type of editing can \nbe accomplished with the input fields at the top of the GMS window.  \n1. With the Select Vertices   tool, click on any one of the vertices to select it.  \nNotice that as the vertex is selected, the coordinates of the vertex are displayed in the \nedit fields at the top of the window (see Figure 7). The edit fields can be used to change \nthe x, y, z,  or s coordinates of the selected vertex.  \n \n      Figure 7      XYZS edit fields  \n2. Move the cursor to the z coordinate field and enter a value that is 10 more than \nwhatever the current z value is.  \n3. Hit the Return  or Tab key. \nThe vertex will now move accordingly.  \n6.5 Adding Vertices  \nWhen working with TINs, it is often necessary to edit a TIN by adding supplemental \nvertices to provide more resolution or detail  in an area of interest. Vertices can be added \nto a TIN in GMS simply by pointing and clicking.  \n1. Switch to Plan View  . \n\nGMS Tutorials   Stratigraphy Modeling \u2013 TIN Surfaces  \n \n Page 8 of 12 \u00a9 Aquaveo 2024  2. Using the Create Vertices   tool, place the cursor inside one of the triangles in \nthe TIN.  \n3. Create a vertex by clicking the mouse button.  \nThe new z value for the vertex is computed using a linear interpolation of the surrounding \nvertices. The vertex is selected and can be edited \u2014if unlocked \u2014using the XYZS edit \nfields in the Edit bar. \n6.6 Deleting Vertices  \nIt is also frequently necessary to delet e vertices. To delete the newly created vertex, do \nas follows:  \n1. Using the Select Vertices   tool, select the newly -created vertex.  \n2. Select Edit | Delete  to delete it.  \nNotice that all of the triangles connected to the vertex were deleted. By default, this is \nwhat happens when a vertex is deleted. The resulting void can be filled with triangles by \nusing the Create Triangles   tool to  manually create triangles. Another opt ion is \navailable for deletion that automatically retriangulates the region surrounding a deleted \nvertex.  \n3. Select TINs  | TIN Settings \u2026 to bring up the Preferences  dialog. Notice that \n\u201cTINs\u201d is already selected from the list on the left.  \n4. In the Vertex Options  section, turn on Retriangulate after deleting . \n5. Click OK to close the Preferences  dialog.  \n6. Using the Select Vertices    tool, select a vertex in the interior of the TIN.  \n7. Select Edit | Delete  to delete it.  \nNotice that the triangles next to the deleted vertex are deleted, but the resulting void is \nretriangulated.  \n7 Smoothing a TIN  \nAs mentioned above, a TIN represents a piecewise linear surface. If the vertices defining \nthe TIN are sparse, the linear surface def ined by the triangles may appear excessively \nirregular. A TIN can be smoothed in GMS by copying the TIN vertices to a scatter point \nset, subdividing the TIN into a denser set of triangles, and interpolating the elevations to \nthe new vertices in the TIN. Th e resulting TIN is still a piecewise linear surface , but it \nappears much smoother because the triangles are smaller.  \n7.1 Deleting the TIN  \nThis tutorial will now provide an example of TIN smoothing. First, it is necessary to import \na different TIN since several  changes were made to this one.  \n1. Click New  and select Don\u2019t Save  to avoid saving the changes.  \n2. Click Open   to bring up the Open  dialog.  \n3. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n4. Select \u201csparse.gpr\u201d  and click Open  to import the file and close the Open  dialog . \n\nGMS Tutorials   Stratigraphy Modeling \u2013 TIN Surfaces  \n \n Page 9 of 12 \u00a9 Aquaveo 2024  7.2 Copying the Vertices  \nThe first step in smoothing the TIN is to copy the vertices of the TIN to a scatter point set. \nThis will allow later using the scatter point set to interpolate the z values of the original  \nvertices to the new vertices created while subdividing the TIN.  \n1. Expand the \u201cTIN Data\u201d  folder in the  Project Explorer . \n2. Right -click on \u201c  sparse \u201d TIN, and select Convert To | 2D Scatter Points . A set \nof scatter points should appear ( Figure 8). \n \n      Figure 8      Scatter points appearing at the vertices  \n7.3 Subdividing the TIN  \nThe next step is to increase the resolution of the TIN by uniformly s ubdividing the TIN.  \n1. Right -click on the \u201c  sparse \u201d TIN in the  Project Explorer  and select Subdivide \u2026 \nto bring up the Subdivision Factor  dialog.  \n2. Enter \u201c 8\u201d in the Factor  field. This can also be done by moving the slider to the \nright until \u201c8\u201d appears in the field.  \n3. Click OK to close the Subdivision Factor  dialog. The Graphics Window should \nnow appear similar to Figure 9. \n\nGMS Tutorials   Stratigraphy Modeling \u2013 TIN Surfaces  \n \n Page 10 of 12 \u00a9 Aquaveo 2024   \n      Figure 9      After subdividing  \n7.4 Interpolating the Elevations  \nNotice that the contours of the TIN have not changed. There are more triangles in the \nTIN, but they still define essentially  the same surface. To smooth the TIN, use one of the \ninterpolation schemes and interpolate from the original vertices of the TIN to the new \nvertices created during the subdivision process.  \n1. Switch to Oblique View  . \n2. In the Project Explorer , right -click on t he \u201c  sparse\u201d scatter point set and select \nInterpolate To  | Active TIN  to bring up the Interpolate \u2192 Object  dialog.  \nAt this point, the interpolation options could be chosen manually (through the \nInterpolation Options\u2026  button). In this example, the default options will be used.  \n3. Enter \u201c new elevations \u201d as the Interpolated data set name .  \n4. Click OK to finish the interpolation and close the Interpolate \u2192 Object  dialog.  \nThe TIN now appears smoother ( Figure 10). Switch between the \u201cdefault\u201d and \u201cnew \nelevations\u201d datasets in the Project Explorer to see the difference on the TIN. It may be \nnecessary to expand the \u201c  sparse \u201d TIN in the Project Explorer  to see the datasets.  \n \n      Figure 10      The smoother TIN  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 TIN Surfaces  \n \n Page 11 of 12 \u00a9 Aquaveo 2024  7.5 Deleting the Scatter Point Set  \nThe TIN smoothing process is now completed. Since the scatter point set is no longer \nneeded, it may be deleted.  \n1. Collapse the \u201c  TIN Data\u201d folder in the Project Explorer . \n2. Right -click on the \u201c  sparse\u201d scatter point set  and select Delete . \nThe only folder in the Project Explorer now should be the \u201c  TIN Data\u201d folder.  \n8 Importing TIN  \nIn GMS, several TINs can be modeled at once without having to delete existing TINs. To \nimport a second TIN without first deleting the existing TIN, do the following:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201c All Files [*.*] \u201d from the Files of type  drop-down.  \n3. Select \u201c surface.tin \u201d and click Open  to import the TIN and close the Open  dialog.  \nTwo TINs should now be displayed at the same time ( Figure 11). \n \n      Figure 11      Both TINS  are visible  \n9 Changing the Active TIN  \nWhenever multiple TINs are being modeled, one of the TINs is designated as the active \nTIN. A TIN can be designated as the active TIN by selecting it in the  Project Explorer  or \nby using the Select TINs   tool. Regardless  of the method used to select a TIN (in the \nProject Explorer or using the tool), the Project Explorer  updates to show which TIN is \nactive. Only the active TIN can be edited.  \n1. Expand the \u201c  TIN Data\u201d  folder in the Project Explorer  if necessary.  \n2. Click on the Select TINs  tool . \nNotice the triangular shaped icons at the center of each TIN ( Figure 12). The name of \neach TIN is displayed beneath the icon. Click on the triangular icon using the Select TINs  \n tool to select the desired TIN. The active TIN has a letter \u201cA\u201d displayed in the cen ter of \nthe icon.  \n\nGMS Tutorials   Stratigraphy Modeling \u2013 TIN Surfaces  \n \n Page 12 of 12 \u00a9 Aquaveo 2024  3. Click on the TIN icon named \u201c sparse \u201d. The letter \u201cA\u201d is now displayed in the icon \nfor the \u201csparse\u201d TIN.  \n \n      Figure 12      The sparse TIN and surface TIN  \n4. In the Project Explorer , select the \u201c  surface \u201d TIN. \nNotice that the \u201cA\u201d has switched back to the \u201csurface\u201d TIN.  \n10 Hiding and Showing TINs  \nWhen multiple TINs are taking up memory, it is sometimes useful to hide some of the \nTINs temporarily. This makes the display less cluttered and makes it easier to edit or \nvisualize an individual TIN. For example:  \n1. In the Project Explorer , uncheck the TIN named \u201c  sparse \u201d. \nThat TIN will now be hidden, though the icon will remain in the Graphics Window to show \nwhere the TIN is located. Another way to hide a TIN is to do the following:  \n2. In the Project Explorer, turn on the \u201c  sparse\u201d TIN so that it becomes visible.  \n3. Using the Select TINs   tool, select the \u201csparse\u201d TIN, then click Hide  .. \n11 Conclusion  \nThis concludes the \u201cStratigraphy Modeling \u2013 TIN Surfaces\u201d tutorial. The following topics \nwere demonstrated and discussed:  \n\uf0b7 How to triangulate a set of points.  \n\uf0b7 How to visualize a TIN  in different ways, including using contours, turning on the \ntriangle faces, and adjusting the lighting.  \n\uf0b7 How to edit the TIN by dragging, adding, and deleting vertices.  \n\uf0b7 How to smooth a TIN via interpolation.  \n\uf0b7 How to read in multiple TINs.  \n\uf0b7 How to specify the  active TIN among multiple TINs.  \n\uf0b7 How to hide and show TINs among multiple TINs.  \n \n\n", "filename": "StratigraphyModeling-TINs.pdf", "pages": 12}, "T-PROGS": {"text": "GMS Tutorials   T-PROGS  \n Page 1 of 21 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nT-PROGS  \nUse T -PROGS to generate multiple material sets on a 3D grid from \nborehole data  \nObjectives   \nThis tutorial show how to use the T -PROGS interface in GMS to create multiple material sets on a 3D \ngrid, each equally likely, based on borehole data. It also demonstrates how T -PROGS can create data for \nthe MODFLOW HUF package.  \n \nPrerequisite Tutorials  \n\uf0b7 MODFLOW \u2013 Grid \nApproach  \n\uf0b7 Stratigraphy Modeling \u2013 \nBoreholes and Cross \nSections  Required Components  \n\uf0b7 GMS Core  \n\uf0b7 Geostatistics  \n\uf0b7 MODFLOW Interface  \n\uf0b7 Subsurface  \n\uf0b7 Stochastic & T -PROGS  Time  \n\uf0b7 50\u201370 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   T-PROGS  \n Page 2 of 21 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n1.1 Problem Description  ................................ ................................ ................................ ..... 3 \n1.2 Getting Started  ................................ ................................ ................................ ..............  4 \n2 Phase I \u2013 Multi -Layer Orthogonal Grid  ................................ ................................ ..............  4 \n2.1 Loading the Borehole Data  ................................ ................................ ...........................  5 \n2.2 Saving the Project  ................................ ................................ ................................ .........  6 \n2.3 Viewing the Borehole Data  ................................ ................................ ...........................  6 \n2.4 Building the 3D Grid  ................................ ................................ ................................ ...... 6 \n2.5 Initializing the T -PROGS Simulation  ................................ ................................ .............  8 \n2.6 Developing the Vertical Markov Chains  ................................ ................................ ........  8 \n2.7 Defining the Strike/Dip Transition Trends  ................................ ................................ ... 11 \n2.8 Running TSIM  ................................ ................................ ................................ .............  12 \n2.9 Viewing the Results  ................................ ................................ ................................ .... 13 \n3 Phase II \u2013 Single Layer Grid  ................................ ................................ .............................  14 \n3.1 Saving the Project  ................................ ................................ ................................ ....... 15 \n3.2 Building the Single Layer Grid  ................................ ................................ ....................  15 \n3.3 MODFLOW Layer Elevations ................................ ................................ ......................  15 \n3.4 Running TSIM  ................................ ................................ ................................ .............  15 \n4 Phase III \u2013 Generating Multiple HUF Datasets  ................................ ................................  16 \n4.1 Saving the Project  ................................ ................................ ................................ ....... 16 \n4.2 Turning Off Cell Faces  ................................ ................................ ................................  16 \n4.3 Building the Grid  ................................ ................................ ................................ .........  16 \n4.4 Initializing MODFLOW  ................................ ................................ ................................  17 \n4.5 Interpolating the Layer Elevations  ................................ ................................ ...............  17 \n4.6 Running TSIM  ................................ ................................ ................................ .............  19 \n4.7 Viewing the Results  ................................ ................................ ................................ .... 20 \n5 Conclusion  ................................ ................................ ................................ .........................  21 \n \n1 Introduction  \nT-PROGS is a software package that performs Transition PRObability GeoStatistics  to \ngenerate multiple, equally probable models of aquifer heterogeneity, all of which can be \nconditioned to borehole data. It is generally used in a stochastic modeling approach with \nMODFLOW. T -PROGS can be used to generate multiple material sets which, in  GMS, \ncan be used to create input data for the Layer Property Flow (LPF) package in \nMODFLOW and multiple instances of Hydrogeologic Unit Flow (HUF) data used in the \nHUF package in MODFLOW 2000.  \nT-PROGS was originally developed by Graham Fogg and Steven Ca rle at UC Davis. For \nmore information, consult the T -PROGS User Manual.1 \nThis tutorial describes how to use the T -PROGS interface in GMS. It demonstrates the \napplication of T -PROGS in generating material sets for both single - and multi -layer grids. \nThis tu torial also demonstrates how to generate multiple sets of HUF data.  \nThis tutorial starts by importing borehole data and creating a bounding grid. Vertical \nMarkov chains are then developed before defining additional parameters. TSIM will be \nrun for both 3D and 2D cases. A scatter point set is then imported, interpolated, and used \nto compare data.   \n                                                      \n1 Carle, Steven F. (1999). T-PROGS: Transition Probability Geostatistical Software Version 2.1 , \nHydrologic Sciences Graduate Group, University of California, Davis. \nhttp://gmsdocs.aquaveo.com/t -progs.pdf  \nGMS Tutorials   T-PROGS  \n \n Page 3 of 21 \u00a9 Aquaveo 2024  1.1 Problem Description  \nThe tutorial problem is illustrated in Figure 1. The objective is to set up a stochastic \nsimulation for a local scale model of a site in Texas. The grid for the local scale model will \nbe oriented in the general direction of the ground water flow at the site and the two ends \nof the model will be m arked as constant head boundaries.  \nBoundaryof\nLocalScale\nModelBorehole\nLocationsRegional\nGroundWater\nFlowDirection\n \nFigure 1      Conceptual representation of site to be modelled  \nSeventy -four borehole logs are available in the vicinity of the site. A 3D oblique view of \nthe borehole data is shown in Figure 2. The borehole logs indica te that the geology \ncorresponds to an alluvial system with considerable heterogeneity. One approach for \ndealing with such a site in GMS would be to create a solid model of the site stratigraphy, \nincluding a detailed 3D representation of each of the lenses.   \nHowever, the solid modeling approach will not work at this site since the heterogeneity is \ntoo complex and there is not sufficient correlation between the boreholes to develop \nmeaningful cross sections. By contrast, the transition probability geostatisti cs approach is \nideally suited for this type of situation. With this approach, first analyze the borehole data \nto determine transitional tendencies, proportions, and mean lens lengths. These data will \nthen be used to generate multiple realizations of the si te heterogeneity as input for a \nstochastic simulation. Each of the realizations will preserve the geologic tendencies \ninherent in the borehole data and will be conditioned to the borehole data (the cells \ncoinciding with borehole locations will match the st ratigraphy in the borehole log).  \nGMS Tutorials   T-PROGS  \n \n Page 4 of 21 \u00a9 Aquaveo 2024   \nFigure 2      3D oblique view of borehole data  \nThis tutorial will be completed in three phases. The first phase will develop the input for a \nstochastic MODFLOW model using the LPF package and  a 3D (multi -layer), orthogonal \ngrid. The second phase will again use the LPF package but use a 2D (single -layer) grid. \nThe third phase will use the HUF package with a 3D grid with non -uniform layer \nelevations. The second and third phases of the tutorial c an be completed relatively \nquickly since it is possible to re -use the transition probability data developed during the \nfirst phase.  \nWhile this tutorial illustrates how to use the T -PROGS interface to develop the input data \nfor a stochastic MODFLOW simulati on, the MODFLOW simulation will not actually be \nrun. The steps involved in running a stochastic MODFLOW simulation using either the T -\nPROGS approach or a \u201cMonte Carlo\u201d style approach are described in the \u201c MODFLOW \u2013 \nStochastic Modeling , Indicator Simulation s\u201d tutorial.  \n1.2 Getting Started  \nDo the following to get started:  \n1. If necessary, launch GMS.  \n2. If GMS is already running, select the File | New command to ensure that the \nprogram settings are restored to their default state.  \n2 Phase I \u2013 Multi -Layer Orthogonal Grid  \nThe underlying equations solved by the T -PROGS software require an orthogonal grid \nwith constant cell dimensions ( \uf044X, \uf044Y, and \uf044Z). The \uf044X values can be different from the \n\uf044Y and \uf044Z values, and the \uf044Y values can be different from the \uf044Z values, but all cel ls \nmust have the same \uf044X, \uf044Y, and \uf044Z dimensions. However, GMS can be used with T -\nPROGS with both uniform and non -uniform grids. If a uniform grid is used, the T -PROGS \ncalculations are carried out directly on the grid cells. If a non -uniform grid is used, t he T-\n\nGMS Tutorials   T-PROGS  \n \n Page 5 of 21 \u00a9 Aquaveo 2024  PROGS calculations are carried out on a uniform background grid which bounds the \nuser-defined grid.  \nAfter the calculations are complete, the material IDs are transferred from the background \ngrid to the user -defined grid by comparing the coordinates o f the cell center for each cell \nin the user -defined grid to determine which cell in the background grid contains the cell \ncenter. The material ID for this cell is then inherited by the cell in the foreground grid. \nBest results are obtained when the user -defined grid is uniform. When the HUF package \nis used, a more sophisticated approach is used to handle the stratigraphic layering in the \nvertical direction. The heterogeneity from the background grid is preserved in a set of \nHUF input arrays.  \nThe first phase  of this tutorial will run T -PROGS on a multi -layer orthogonal MODFLOW \ngrid. The MODFLOW model will use the LPF Package  with the Material ID  option for \nassigning aquifer properties. With this option, each cell in the grid is assigned a material \nID and the aquifer properties (Kh, Kv, etc.) associated with each material are \nautomatically assigned to the layer data arrays for the LPF package when  the \nMODFLOW files are saved. The T -PROGS software generates multiple material sets \n(arrays of material IDs), each of which represents a different realization of the aquifer \nheterogeneity.  \nWhen running a MODFLOW simulation in stochastic mode, GMS automati cally loads \neach of the n material sets generated by the T -PROGS software and saves n different \nsets of MODFLOW input files. The n solutions resulting from these simulations can be \nread into GMS and used to perform risk analyses such as probabilistic captu re zone \ndelineation.  \n2.1 Loading the Borehole Data  \nThe first step in setting up the T -PROGS simulation is to import the borehole data.  \n1. Click Open   to bring up the Open  dialog.  \n2. Browse to the t-progs  folder for this tutorial and select \u201c LH 3D.gpr \u201d. \n3. Click Open  to import the file and exit the Open  dialog.  \nThe project should appear similar to Figure 3, showing a set of boreholes displayed in \nplan view.  \n \nFigure 3      The imported boreholes  \n\nGMS Tutorials   T-PROGS  \n \n Page 6 of 21 \u00a9 Aquaveo 2024  2.2 Saving the Project  \nBefore proceeding, save the project under a new name by doing the following:  \n1. Select File | Save As \u2026 to bring up the Save As  dialog.  \n2. Enter \u201ctprob3d.gpr\u201d as the File name  and click Save  to exit the Save As dialog . \nIt is recommended to periodically Save   changes while going through this tutorial.  \n2.3 Viewing the Borehole Data  \nTo view the heterogeneity in the borehole logs, view the boreholes in oblique view.  \n1. Switch to Oblique View  . \nNotice that the most common material at the site is clay and the least common material is \nclean sand. It can also be seen that the site has considerable heterogeneity. It should be \nnoted that the current display has a z magnification factor of 5.0. This fa ctor can be \nadjusted in the Display  Options  dialog.  \n2. Switch to Plan View  . \n2.4 Building the 3D Grid  \nBefore editing the T -PROGS data, first create the 3D grid. For sites, such as this one, \nwhere the grid must be rotated to align it with the regional ground wat er flow direction, the \nbest approach is to use the grid frame to define the grid location. The grid frame is \nlocated in the Map module of GMS, and is used to define the location, size, and \norientation of the grid. Do the following to create the grid frame:  \n1. Right -click on an empty space in the Project Explorer  and select New | Grid \nFrame . \nA grid frame should appear. For more information on creating and modifying grid frames, \nplease see the \u201cFeature Objects\u201d tutorial.  \n2. Switch to the  Map module by selecting \u201c  Map Data \u201d. \n3. Using the Select Grid Frame   tool, double -click on the grid frame to bring up \nthe Grid Frame Properties  dialog.  \n4. Enter the following values for the grid frame:  \nOrigin x:  3313550  \nOrigin y:  6952450  \nOrigin z:  130 \nDimension x:  1710  \nDimension y: 1010  \nDimension z:  80 \nRotation \nAngle:  40 \n5. Click OK to exit the Grid Frame Properties  dialog.  \n6. Frame   the project.  \nThe project should appear similar to Figure 4. \n\nGMS Tutorials   T-PROGS  \n \n Page 7 of 21 \u00a9 Aquaveo 2024   \nFigure 4      Grid frame surrounding the boreholes  \nNow it is possible to create the grid:  \n7. Select Feature Objects | Map \u2192 3D Grid  to open the Create Finite Difference \nGrid dialog.  \n8.  In the X-Dimension  section, enter \u201c70\u201d as the Number cells . \n9. In the Y-Dimension  section, enter \u201c50\u201d as the Number cells . \n10. In the Z-Dimension  section, enter \u201c20\u201d as the Number cells . \n11. Click OK to close the Create Finite Difference Grid  dialog.  \nAfter a few moments, the grid should appear ( Figure 5). \n \nFigure 5      Grid frame with new 3D grid  \n\nGMS Tutorials   T-PROGS  \n \n Page 8 of 21 \u00a9 Aquaveo 2024  2.5 Initializing the T -PROGS Simulat ion \nThe next step is to initialize the T -PROGS simulation and define some general options \nincluding the azimuth angle, background material, and materials included in the \nsimulation.  \n1. Switch to the Boreholes   module by selecting \u201c  Borehole Data \u201d. \n2. Right -click on a empty space in the Project Explorer and select New | T-PROGS  \nto open the T-PROGS Boreholes  dialog.  \n3. Since all of the boreholes will be used, click Next  to close the T-PROGS \nBoreholes  dialog  and open the T-PROGS Materials  dialog.  \nThe T-PROGS  Materials  dialog lists the materials in use on the boreholes and an \nAzimuth angle. The azimuth angle represents the angle corresponding to the Strike (X)  \ndirection. If there is anisotropy in the xy plane, this angle should be set to the principle \ndirectio n of the anisotropy. If anisotropy is not present, this angle should be coincident \nwith the x-axis (the rows or j-direction) of the grid. By default, the azimuth angle is \ndefaulted to a value that aligns it with the x-axis of the grid. This value correspon ds to the \nnegative grid rotation angle that was entered in the grid frame. This is because the grid \nrotation angle is counterclockwise from the x-axis, but the azimuth angle is clockwise \nfrom the y-axis. \nThe upper part of the dialog lists the materials in the boreholes. The first column of \noptions indicates which materials are to be used in the analysis. By default, all materials \nassociated with the boreholes are selected. These options are necessary since it is \npossible that there may be materials defined in the materials list that are not associated \nwith boreholes. Furthermore, a T -PROGS simulation can be performed without borehole \ndata. In such a case, define the mean proportions and lens lengths for each material.  \nThe second column in the top section of the dialog lists the background material. By \ndefault, the material type that had the predominant occurrence (greatest proportion) in \nthe boreholes is marked as the background material. When defining the transition \nprobability data in the next section, the input parameters do not need to be edited for the \nbackground material. The parameters for this material are automatically adjusted to \nbalance the equations.  \n4. Click Next  to close the T-PROGS Materials  dialog and bring up the Vertical (Z) \nMarkov Chains  dialog . \n2.6 Developing the Vertical Markov Chains  \nThe most important step in setting up the T -PROGS data is to define the transition \nprobability data for each material located in the boreholes in the three primary directions: \nvertical, strike, and dip. The vertical transition trends are developed first, based on the \nborehole data. The data in the strike and dip directions can then be derived from the \nvertical data.  \nThe first step in setting up the transition data is to run a utility within T -PROGS called \nGAMEAS that computes a set of transition probability curves as a function of lag distance \nfor each material for a given sampling interval. GAMEAS is launched by doing the \nfollowing:  \n1. In the Measured data  section, click Compute \u2026 to bring up the TPROGS  model \nwrapper dialog.  \nThe TPROGS  model wrapper dialog lists the output from the GAMEAS utility. Depending \non the speed of the computer being used, this can take a few minutes. When it finishes, \n\nGMS Tutorials   T-PROGS  \n \n Page 9 of 21 \u00a9 Aquaveo 2024  \u201cSuccessful Completion\u201d should appear at the bottom of the wi ndow and the Abort  button \nshould change to Close . \n2. When GAMEAS finishes, click Close  to exit the TPROGS  model wrapper dialog.  \nAt this point, the plots in the upper right corner of the dialog should be updated. These \nplots display the transition probabilitie s for each material with respect to each of the other \nmaterials. The rows (top to bottom) correspond to \u201c Clean_Sand ,\u201d \u201cSand_w/_fines ,\u201d \u201cSilt,\u201d \nand \u201c Clay\u201d. Likewise, the columns (left to right) correspond to \u201c Clean_Sand ,\u201d \n\u201cSand_w/_fines ,\u201d \u201cSilt,\u201d and \u201c Clay\u201d. Thus, the plot in the top row and leftmost column \nrepresents the probability of transitioning from clean sand to clean sand. The plot in the \ntop row and second leftmost column represents the probability of transitioning from clean \nsand to sand with fines , etc.  \nThe plots can be better viewed by maximizing them:  \n3. Right -click on any of the plots and select Maximize Plot . \n4. Press Esc to minimize the plot.  \nIf desired, use this feature to view other plots.  \nEach of the plots contains two curves depicting the trans ition probability. The dashed line \nrepresents the transition probability measured from the borehole data by the GAMEAS \nutility. In general, this curve represents the transition probability from material j to material \nk. The transition probability tjk(h) is defined by:  \ntjk(h)= Pr{ k occurs at x + h  | j occurs at x} ................................ ...............  .1 \nwhere x is a spatial location, h is the lag (separation vector), and j,k denote materials. \nThe lag is defined by the Lag spacing item in the upper left corner of the Vertical (Z) \nMarkov Chains  dialog. The curve shown with the solid line is called a Markov chain.  \nThe Markov chains are used to formulate the equations used by T -PROGS to generate \nthe multiple material sets during the simulation stage. The objective of thi s stage of the \nanalysis is to fit the Markov chain curves as accurately as possible to the measured \ntransition probability curves. This process is similar to fitting a model variogram to an \nexperimental variogram in a kriging exercise.  \nMathematically, a M arkov chain model applied to one -dimensional categorical data in a \ndirection \uf066 assumes a matrix exponential form:  \nT(h\uf066) = exp( R\uf066h\uf066) ................................ ................................ ......................  .2 \nwhere \uf066 denotes a lag in the direction h \uf066, and R\uf066 denotes a transition rate matrix  \n\uf0fa\uf0fa\uf0fa\n\uf0fb\uf0f9\n\uf0ea\uf0ea\uf0ea\n\uf0eb\uf0e9\n\uf03d\n\uf066 \uf066\uf066 \uf066\n\uf066\n,kk ,1k,k1 ,11\nr rr r\n\uf04c\uf04d\uf04f\uf04d\uf04c\nR\n ................................ ................................ ..........  .3 \nwith entries rjk,\uf066 representing the rate of change from category j to category k (conditional \nto the presence of j) per unit length in the direction \uf066. The transition rates are adjusted to \nensure a good fit between  the Markov chain model and the observed transition probability \ndata.  \nIt should be noted that the self -transitional curves on the diagonal start at a probability of \n1.0 and decrease with distance, and the off -diagonal curves start at zero probability and \nincrease with distance. In both cases, the curves eventually flatten out at some distance. \nThe probability corresponding to the flat part of the curve represents the mean proportion \nof the material. All curves on a particular column should flatten out to th e same \nGMS Tutorials   T-PROGS  \n \n Page 10 of 21 \u00a9 Aquaveo 2024  proportion. The proportions are displayed in the lower left corner of the dialog. As \nexpected, clay has the highest proportion of the four materials.  \nThe point where a tangent line from the early part of the curves on the diagonal intersects \nthe ho rizontal (lag distance) axis on each curve represents the mean lens length for the \nmaterial. The mean lens lengths are shown just to the right of the mean proportions in the \nlower left part of the dialog. The slope at the beginning of each of the Markov ch ains \nrepresents the transition rate. Together, the proportions, lens lengths, and transition rates \ndefine the Markov chains.  \n \nFigure 6      Markov chain curve diagram  \nSeveral methods are provided for fitting the Markov chains to t he measured transition \nprobability curves. These methods are listed in the Markov chains  section of the dialog. \nBy default, GMS automatically makes an attempt to fit the curves using the Edit \nmaximum entropy factors  option. In many cases, this fit is suffi ciently accurate. However, \nit is often useful to explore the other options for fitting the curves.  \n5. In the Markov chains  section, select Edit the transition rates . \nWith this option, directly edit the transition rates and the mean proportions using the two \nspreadsheets at the bottom of the dialog. The proportion and rates for the background \nmaterial need not be defined. The proportion for the background material is adjusted so \nthat the proportions sum to \u201c1.0\u201d. The transition rates involving the background ma terial \nare adjusted so that the row sums obey:  \nj rK\nkjk \uf022\uf03d\uf0e5\n\uf03d1, 0\uf066\n ................................ ................................ ................  .4 \nand the column sums obey  \n\uf0e5\n\uf03d\uf022\uf03dK\njjkj k rp\n1, 0\uf066\n ................................ ................................ ...........  .5 \nwhere j is the row index, k is the column index, p is the proportion, and r is the transition \nrate. \n6. Select the Edit embedded transition probabilities  option  in the Markov chains  \nsection.  \n\nGMS Tutorials   T-PROGS  \n \n Page 11 of 21 \u00a9 Aquaveo 2024  With both this option and the next option ( Edit embedded transition frequencies ), GMS \nparses the borehole data and computed embedded transition probabilities (or transition \nfrequencies) and displays the results in the matrix in the Transition Rates  section. The \ntransition rates can be computed from the transition probabilities (or fr equencies). This \noption is described in more detail in the T-PROGS Users Guide . \n7. In the Markov chains  section, select Edit maximum entropy factors . \nWith this option, the diagonal terms of the rate matrix are computed from the mean lens \nlengths using the rel ationship:  \n\uf066\uf066\n,,1\nkkkLr\uf02d\uf03d\n ................................ ................................ ..........................  .6 \nwhere L is the mean lens length. The off -diagonal terms represent the ratio of the current \ntransition rate to the transition rate corresponding to maximum entropy.  \nWhen this factor is equal t o \u201c1.0\u201d, the probability that a given material is adjacent to \nanother material is consistent with a random distribution of the materials. In other words, \nthe probability will be dependent only on the proportions of the two materials. Viewing \nthese factors illustrates the juxtapositioning tendencies in the borehole data.  \nFor example, the Silt \u2192 Clean_Sand  factor (in the Silt row and the Clean_Sand  column) \nshould be equal to \u201c0.39\u201d. This factor represents the transition from silt to clean sand \nmoving in the +Z (upwards) direction. The Clean_Sand \u2192 Silt  factor is \u201c1.01\u201d. With \nfactors less than \u201c1.0\u201d, it could be concluded that the type of transition occurs less \nfrequently than possibly expected, given the proportions of the materials.  \nSince the Clean_Sand \u2192 S ilt factor is greater than the Silt \u2192 Clean_Sand  factor,  \nconclude that it is less likely to transition from \u201c Silt\u201d to \u201cClean_Sand \u201d than from \n\u201cClean_Sand \u201d to \u201cSilt\u201d when moving in the +Z direction. In other words, these two \nmaterials exhibit a fining -upwar ds tendency. The maximum entropy factors provide a \nsimple and intuitive way to view and edit the transition rates.  \n8. In the Markov chains  section, select Fit curves to a discrete lag . \nThis option is the simplest to use. With this option, a curve fitting proc ess is used to \nadjust the transition rates and proportions so that the curve coincides exactly with the \nmeasured transition probability at the selected lag interval. By adjusting the lag interval, \nan excellent fit can often be obtained. This option will be  used to fit the curves and \nproceed to the next step.  \n9. Enter \u201c 17\u201d as the Lag #  and press Tab.  \nThis number produces a good fit between the measured transition data and the Markov \nchains.  \n10. Click Next  to close the Vertical (Z) Markov Chains  dialog and open the Strike (X) \nMarkov Chains  dialog.  \n2.7 Defining the Strike/Dip Transition Trends  \nThe next step is to define the Markov chains in the strike and dip directions. In theory, the \nGAMEAS utility could be run in the strike and dip directions to de velop measured \ntransition probability data which could then be modeled with Markov chains. However, \nborehole data are not sufficiently dense in these directions to develop meaningful data. \nTherefore, it is necessary to apply Walther\u2019s Law  to develop the st rike and dip Markov \nchains. Walther\u2019s Law states that vertical successions of deposited facies represent the \nlateral succession of environments of deposition. In other words, the transition rates in \nthe horizontal directions can be derived from the transit ion rates in the vertical direction.  \nGMS Tutorials   T-PROGS  \n \n Page 12 of 21 \u00a9 Aquaveo 2024  To begin with, assume that the proportions are the same in all three directions. The lens \nlength ratios method  is then used to define the transition rate matrix. With this method, \nthe diagonal transition rates are defi ned from the lens lengths using equation 6. The lens \nlengths in the horizontal directions are derived from the lens length ratios entered for \neach material using the spreadsheet on the bottom left of the dialog. These ratios \nrepresent the lens length in th e horizontal direction versus the lens length in the vertical \ndirection. GMS sets up the matrix using a default ratio of approximately \u201c10.0\u201d. The off -\ndiagonal terms in the rate matrix are then inherited from the vertical transition rates and \nthen scaled b y dividing by the lens length ratio.  \nOnce the Markov chains have been defined by the lens length ratios method, the other \nfour methods listed in the Markov Chains section of the dialog can be used to view or edit \nthe Markov chain data. In this case, accept  the default data for both the strike and dip \ndirections.  \n1. Click Next  to exit the Strike (X) Markov Chains  dialog and open the Dip (Y) \nMarkov Chains dialog.  \n2. Click Finish  to close the Dip (Y) Markov Chains dialog.  \n3. Save   the project.  \n2.8 Running TSIM  \nWith the Ma rkov chains defined in all three primary directions, now r un TSIM  to generate \nthe material sets. The Run TSIM  command launches up to three different utilities: \nGAMEAS, MCMOD, and TSIM. If the Fit curve to a discrete lag  option is used (as is the \ncase with this simulation), GAMEAS is launched first to develop the transition trends from \nthe borehole data. GAMEAS only runs if this option is used for the vertical Markov chains. \nMCMOD then takes the one -dimensional Markov chains defined in the three primary \ndirections and formulates a three -dimensional Markov chain. This Markov chain is then \nread into TSIM and TSIM generates the material sets.  \nRunning TSIM can take anywhere from several minutes to several hours depending on \nthe number of materials, the resolution  of the grid, and the number of material sets \ndesired. To ensure that this tutorial can be completed in a reasonable amount of time, \nonly create five material sets.  \n1. Select T-PROGS  | Run TSIM \u2026 to bring up the TSIM  dialog.  \n2. Select Launch TSIM internal in GMS  and click Next  to close the TSIM dialog and \nopen the TSIM Options dialog.  \n3. Enter \u201csim3d\u201d as the Simulation name . \n4. Enter \u201c 5\u201d as the Number of realizations . \n5. Click Finish  to accept the other default settings, closer the TSIM Options  dialog \nand open the TPROGS  model wrapper dialog.  \n6. When the GAMEAS utility finishes, click Close  to exit the TPROGS  model \nwrapper dialog and open a new TPROGS  model wrapper dialog that will run \nMCMOD and TSIM.  \nThe output from MCMOD and TSIM will display until they both successfully co mplete.  \n7. When TSIM finishes, click Close  to exit the TPROGS  model wrapper dialog.  \nThe project should appear similar to Figure 7. \n\nGMS Tutorials   T-PROGS  \n \n Page 13 of 21 \u00a9 Aquaveo 2024   \nFigure 7      After the TSIM run  \n2.9 Viewing the Results  \nThe output from T -PROGS is a series of material sets. The material sets are organized in \nthe Project Explorer  associated with the 3D Grid  Module. The first material set is \nautomatically loaded and the Cell faces  display option is turned on. The material set \nsimulations are organized into a \u201c Material Sets \u201d folder in the Project Explorer . \n1. Right -click on \u201c  Material Sets \u201d and select Expand All . \nAll five material sets are listed under the \u201c  sim3d \u201d folder. The active  material set, \u201c  \nsim3d 1 ,\u201d is bold.  \n2. Change material sets by selecting \u201c  sim3d 2 \u201d and notice that the grid display \nupdates.  \n3. In the Mini -Grid toolbar , change to the second layer.  \n4. Switch to the Front View   to view the grid from the front side.  \n5. Use the ar row buttons in the Mini -Grid toolbar  to view different \ncross -sections.  \n6. Return to plan view by clicking Plan View  . \n7. View the material set properties by right -clicking on any of the material sets and \nselecting Properties \u2026 to open the Material Set Info  dialog. If desired, repeat this \nwith other material sets to confirm that all material sets have the same \nproportions.  \n8. Click OK to exit the Material Set Info  dialog.  \nA probability dataset for each material can also be created and displayed. First, save the \ncurrent display settings and then change the setting to view the probability datasets.  \n9. Right -click in an empty space in the Project Explorer  and select New | Display \nTheme \u2026 to open the Display Theme Properties dialog.  \nA display theme is used to save the current display settings.  \n\nGMS Tutorials   T-PROGS  \n \n Page 14 of 21 \u00a9 Aquaveo 2024  10. Click OK to accept the defaults of the display template and close the Display \nTheme Properties dialog.  \nA new \u201c  Display (1) \u201d display theme should appear in the Project Explorer.  \n11. Right -click on \u201c  sim3d \u201d and select Create Probabili ty Datasets . \nA series of new datasets under a \u201c  sim3d Prob\u201d folder should appear in the Project \nExplorer.  \n12. Select \u201c  Clean_Sand \u201d in the  Project Explorer  and click Display Options   to \nopen the Display Options dialog.  \n13. Select \u201c3D Grid Data\u201d from the list on the left.  \n14. On the 3D Grid  tab, in the Active dataset  section, turn on Contours and click \nOptions\u2026 to open the Dataset Contour Options \u2013 3D Grid \u2013 Clean Sand dialog.  \n15. In the Contour method  section, select \u201cColor Fill\u201d from the first drop -down.  \n16. Turn on Legend . \n17. Click OK to exit  the Dataset Contour Options \u2013 3D Grid \u2013 Clean Sand dialog.  \n18. Click OK to exit the Display Options dialog.  \nThe probability of the \u201c Clean_Sand \u201d material existing in each grid cell is now contoured. \nNow select the other datasets to view the different material probabilities.  \n19. Select \u201c  Display (1) \u201d in the Project Explorer  to reset the display settings.  \n20. Save   the project.  \nThis completes the 3D grid portion of this tutorial.  \n3 Phase II \u2013 Single Layer Grid  \nThis portion of the tutorial demonstrates the generation of multiple material sets for a \nsingle -layer model. When developing a single layer model, the modeler must determine \nhow to distribute the hydraulic conductivity values within the layer. A common approach \nis to delineate zones of hydraulic c onductivity by examining the subsurface stratigraphic \ndata. The modeler often faces a difficult task of trying to determine a reasonable strategy \nfor delineating two -dimensional zones of hydraulic conductivity based on complex 3D \nborehole data.  \nThe 2D T -PROGS approach provides a simple, rational approach to representing \nborehole data in a single layer MODFLOW model. This is similar to the 3D approach. The \nfirst step is to generate the Markov chains in the three principal directions. Since these \ndata have al ready been generated in the first phase of the tutorial, the Markov chain \ninformation will be reused for this phase. The main difference between the two \napproaches is what happens when TSIM is executed.  \nFor the 2D case, GMS determines the predominant mate rial at each borehole and \ncreates a single sample at the xy location of the borehole corresponding to the \npredominant material type. These samples are input to TSIM in the place of the entire \nborehole log that is input to TSIM in the 3D case. TSIM then per forms a 2D indicator \nsimulation in the xy plane and each of the resulting material sets is conditioned to the \nsimplified borehole data.  \n\nGMS Tutorials   T-PROGS  \n \n Page 15 of 21 \u00a9 Aquaveo 2024  3.1 Saving the Project  \nBefore continuing, save the project under a new name:  \n1. Select File | Save As \u2026 to open the Save As  dialog. \n2. Enter \u201ctprob2d.gpr\u201d as the File name  and click Save  to close the Save As  dialog . \n3.2 Building the Single Layer Grid  \nFirst, use the same grid frame created in the first phase of the tutorial to create a single \nlayer grid.  \n1. Right -click on \u201c  Grid Frame \u201d and select Map to | 3D Grid  to bring up the \nCreate Finite Difference Grid dialog.  \n2. Click OK at the prompt to confirm the replacing the existing grid with a new grid.  \n3. In the X-Dimension  section, enter \u201c70\u201d as the Number cells . \n4. In the Y-Dimension  section, enter \u201c50\u201d as the Number cells . \n5. In the Z-Dimension  section, enter \u201c1\u201d as the Number cells . \n6. Click OK to close the Create Finite Difference Grid  dialog.  \n3.3 MODFLOW Layer Elevations  \nGrid layer elevations could be interpolated from scatter point data us ing the To \nMODFLOW Layers  command in the 2D Scatter Point  module. However, for the sake of \nsimplicity, use constant top and bottom elevations with the model.  \n3.4 Running TSIM  \nThe transition probability data developed in the first phase of this tutorial will be  used for \nthe 2D case. Therefore, proceed directly to running TSIM.  \n1. Select T-PROGS  | Run TSIM \u2026 to open the TSIM  dialog.  \n2. Select Launch TSIM internal in GMS  and select Next  to close the TSIM  dialog \nand open the TSIM Options  dialog.  \n3. Enter \u201csim2d\u201d as the Simul ation name . \n4. Enter \u201c 5\u201d as the Number of realizations .  \n5. Accept the other defaults and click Finish  to close the TSIM Options  dialog.  \n6. When asked to confirm that each borehole will be simplified to a single point in \nthe calculations, click OK to bring up the TPROGS  model wrapper dialog.  \n7. When the GAMEAS utility finishes, click Close  to exit the TPROGS  model \nwrapper dialog and bring up another TPROGS  model wrapper dialog.  \nThe MCMOD and TSIM utility will then execute. Helpful information is displayed at the top \nof the dialog including Elapsed Time  and Time Remaining . This simulation runs much \nfaster than the 3D case.  \n8. Click Close  when TSIM finishes to exit the TPROGS  model wrapper dialog.  \n9. Repeat steps 1 \u201320 from section 2.9 to view the results.  \n\nGMS Tutorials   T-PROGS  \n \n Page 16 of 21 \u00a9 Aquaveo 2024  4 Phase III \u2013 Generating Multiple HUF Datasets  \nIn the final phase of this tutorial, generate HUF data using T -PROGS. Using HUF arrays \novercomes the main limitation of T -PROGS : grid cell dimensions must be kept small to \ncapture the heterogeneity. This results in thin cells at the top of the grid that are prone to \nwetting and drying problems. With the HUF approach, larger cell thicknesses can be \nused.  \nWhen using the HUF approach , first create a grid with constant row and column widths. \nThe layer elevations are then interpolated as desired to match aquifer boundaries. When \nTSIM is executed in HUF mode, GMS creates a background grid that has the same \ndimensions as the primary grid in terms of rows and columns, but has a greater number \nof layers than the primary grid, resulting in greater detail or resolution in the vertical \ndirection. The background grid is an orthogonal grid compatible with the T -PROGS \ninterpolation algorithm. The T-PROGS simulation is then performed on the background \ngrid. The heterogeneity resulting from the dense background grid is then translated by \nGMS into a set of grid -independent HUF units.  \nOnce again, reuse the transition probability data created in the fir st phase of the tutorial.  \n4.1 Saving the Project  \nBefore continuing, save the project under a new name.  \n1. Select File | Save As \u2026 to open the Save As  dialog.  \n2. Enter \u201ctprobhuf.gpr\u201d as the File name  and click Save  to exit the Save As  dialog.  \n4.2 Turning Off Cell Faces  \nBefore continuing, turn off the display of the grid cell materials.  \n1. Click Display Options   to open the Display Options  dialog.  \n2. Select \u201c 3D Grid Data \u201d from the list on the left.  \n3. On the 3D Grid  tab, turn off Cell faces . \n4. Click OK to close the Display Options  dialog.  \n4.3 Building the Grid  \nFirst, create a four -layer grid using the grid frame.  \n1. Right -click on \u201c  Grid Frame \u201d and select Map to | 3D Grid  to open the Create \nFinite Difference Grid dialog.  \n2. Click OK when advised the existing grid will be deleted.  \n3. In the X-Dimension  section, enter \u201c70\u201d as the Number cells . \n4. In the Y-Dimension  section, enter \u201c50\u201d as the Number cells . \n5. In the Z-Dimension  section, enter \u201c4\u201d as the Number cells . \n6. Click OK to close the Create Finite Difference Grid  dialog.  \n\nGMS Tutorials   T-PROGS  \n \n Page 17 of 21 \u00a9 Aquaveo 2024  4.4 Initializing MODFLOW  \nBefore interpolating the top and bottom elevations for the grid, initialize the MODFLOW \ndata.  \n1. Select MODFLOW  | New Simulation \u2026 to initialize MODFLOW and open the \nMODFLOW Global/Basic Package dialog . \n2. Click Packages \u2026 to open the MODFLOW Packages/Processes dialog.  \n3. In the Flow package  section, select HUF \u2013 Hydrogeologic Unit Flow . \n4. Click OK to close the MODFLOW Packages/Processes dialog.  \n5. Click OK to exit the MODFLOW Global/Basic Package  dialog.  \n4.5 Interpolating the Layer Elevations  \nNext, import a set of scatter point data and interpolate the top and bottom elevations for \nthe four layers of the MODFLOW grid. To do this, interpolate the elevations for the top of \nthe grid. For the elevations at the bottom of the grid, leave these values  at a constant \nvalue for simplicity. Next, use the Redistribute Layers  command to evenly distribute the \nelevations for the interior layer boundaries.  \nImporting the Scatter Point Data  \nImport the scatter data from a tabular text file:  \n1. Click Open   to bring u p the Open  dialog.  \n2. Select \u201cText Files (*.txt;*.csv)\u201d from the Files of type  drop-down.  \n3. Select \u201c topo.txt \u201d and click Open  to exit the Open  dialog and open the Step 1 of 2  \npage of the Text Import Wizard  dialog . \n4. Below the top section, turn on Heading row  and click Next  to go to the Step 2  of \n2 page of the Text Import Wizard  dialog.  \n5. Select \u201c2D scatter points\u201d from the GMS data type  drop-down.  \nThe spreadsheet at the bottom of the dialog enables specifying what types of data are in \neach column.  \n6. In the first  column, on the Type  row, select \u201cLabel\u201d from the drop -down.  \n7. In the fourth column, on the Type  row, select \u201cDataset\u201d from the drop -down.  \nThis indicates that the fourth column represents an elevation dataset.  \n8. Click Finish  to close Text Import Wizard  dialog.  \nA set of scatter points should appear in the vicinity of the grid ( Figure 8). \n\nGMS Tutorials   T-PROGS  \n \n Page 18 of 21 \u00a9 Aquaveo 2024   \nFigure 8      Scatter set with the grid and boreholes  \nInterp olating the Layer Elevations  \nNext, interpolate the elevations associated with the scatter point set to the top of the \nMODFLOW grid using the default interpolation options.  \n1. Right -click on \u201c  topo\u201d in the Project Explorer  and select Interpolate To  | \nMODFLOW Layers \u2026 to open the Interpolate to MODFLOW Layers  dialog.  \n2. In the Scatter point datas ets section, select \u201c elevation \u201d. \n3. In the MODFLOW data  section, select \u201c Top Elevations Layer 1 \u201d. \n4. Click Map. \n5. Click OK to close the Interpolate to MODFLOW Layers  dialog.  \nTo vie w the results:  \n6. Turn off \u201c  topo\u201d and \u201c Borehole Data \u201d in the Project Explorer . \n7. Select \u201c  3D Grid Data \u201d to switch to the 3D Grid   module . \n8. Using the Select Cells   tool, select a cell near the center of the grid.  \n9. Switch to Front View  . \nThe project should appear similar to Figure 9. \n \nFigure 9      Front view showing the elevations mapped to the top layer  \n10. Switch to Side View  . \nThe project should appear similar to Figure 10. \n\nGMS Tutorials   T-PROGS  \n \n Page 19 of 21 \u00a9 Aquaveo 2024   \nFigure 10      Side view showing the elevations mapped to the top layer  \nRedistributing th e Interior Layer Elevations  \nNow use the Redistribute Layers  command to distribute the elevations of the interior \nlayer boundaries between the current elevations at the top and bottom of the grid. Make \nthe top layer a little larger than the other three laye rs. The other three layers will be \nevenly distributed.  \n1. Select Grid | Redistribute Layers \u2026 to bring up the Redistribute Layers  dialog.  \n2. In the spreadsheet on the right, enter \u201c0.35\u201d on Layer  1 in the Fraction  column.  \nNote how the fractions for the other layers are automatically updated.  \n3. Click OK to close the Redistribute Layers  dialog.  \n4. Click Yes when asked to confirm overwriting the MODFLOW elevations.  \nNote the change in the layer elevations ( Figure 11). Having a thicker layer at the top \nreduces difficulties caused by cell wetting and drying.  \n \nFigure 11      The top layer is now thicker  \n4.6 Running TSIM  \nIt is now p ossible to run TSIM.  \n1. Select T-PROGS  | Run TSIM \u2026 to open the TSIM  dialog.   \n2. Click Next  to close the TSIM  dialog and open the TSIM Options dialog.  \n3. Enter \u201csimhuf\u201d as the Simulation name . \n4. Enter \u201c 5\u201d as the Number of realizations . \n\nGMS Tutorials   T-PROGS  \n \n Page 20 of 21 \u00a9 Aquaveo 2024  5. In the TSIM output  section, select Generate HUF arrays . \n6. In the Background grid  section, enter \u201c 20\u201d as the Num Z .  \nThis defines the number of layers in the background grid and controls the level of detail in \nthe resulting HUF units.  \n7. Click Finish  to close the TSIM Options  dialog and open the TPROGS  model \nwrapper dialog.  \n8. When the GAMEAS utility finishes, click Close  to exit the TPROGS  model \nwrapper dialog and open another TPROGS  model wrapper dialog.  \n9. When MCMOD and TSIM finish, click Close  to exit the TPROGS  model wrapper \ndialog.  \nThe project should appear similar to Figure 12. \n \nFigure 12      Side view after TSIM run  \n4.7 Viewing the Results  \nThe output from T -PROGS is automatically converted to a series of HUF  datasets. The \nHUF datasets are organized in the \u201c  3D Grid Data\u201d folder in the Project Explorer . The \nfirst HUF dataset is automatically loaded and the Display hydrogeologic units  option is \nturned on. Note that the stratigraphic definition is independent o f the MODFLOW grid \nboundaries.  \n1. Expand the \u201c  simhuf \u201d folder\u201d. It is found under the \u201c  HUF Data \u201d folder under \nthe \u201c  3D Grid Data \u201d folder.  \n2. Notice that the \u201c  simhuf 1\u201d dataset is selected.  \nAll five realizations are listed under the \u201c simhuf \u201d folder. The ac tive HUF dataset, \u201c  \nsimhuf 1\u201d , is identified by a bolded name and selected icon. If desired, view other HUF \ndatasets by them from the list, and view different columns and rows of the MODFLOW \ngrid. White viewing the results, the solid lines represent the b oundaries of the MODFLOW \ngrid cells. The filled colors in the background represent the HUF units.  \nWhile viewing the cross sections, keep in mind that the vertical scale is currently \nmagnified by a factor of 5.0. If desired, change back to the true scale in  the Display \nOptions  dialog.  \n\nGMS Tutorials   T-PROGS  \n \n Page 21 of 21 \u00a9 Aquaveo 2024  5 Conclusion  \nThis concludes the \u201cT -PROGS\u201d tutorial. The following  key concepts were discussed and \ndemonstrated in this tutorial : \n\uf0b7 T-PROGS can be used to help create a single or multi -layer MODFLOW model \nthat uses the Material IDs approach with the LPF package.  \n\uf0b7 T-PROGS can also be used with the MODFLOW HUF package.  \n \n", "filename": "T-PROGS.pdf", "pages": 21}, "Toolbox": {"text": "GMS Tutorials   Toolbox Introduction  \n Page 1 of 5 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial  \nToolbox Introduction  \nLearn to use the Toolbox tools in GMS  \nObjectives   \nLearn how to access and use a tool in the Toolbox in GMS. This tutorial will demonstrate how to convert a \nUGrid to a Voronoi UGrid. The tutorial will also demonstrate using the toolbox history . \n \nPrerequisite Tutorials  \n\uf0b7 Getting Started  Required Components  \n\uf0b7 GMS Core  Time  \n\uf0b7 10\u201320 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   Toolbox Introduction  \n Page 2 of 5 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Opening the Starting Project  ................................ ................................ ..............................  2 \n3 Using the Toolbox  ................................ ................................ ................................ ...............  3 \n1.1 Convert to Voronoi UGrid  ................................ ................................ .............................  3 \n4 Rerunning a Tool Using History  ................................ ................................ .........................  4 \n1.2 Using Tools in History  ................................ ................................ ................................ ... 4 \n2 Saving the History  ................................ ................................ ................................ ...............  5 \n3 Conclusion  ................................ ................................ ................................ ...........................  5 \n \n1 Introduction  \nThe Toolbox  in GMS contains \u201ctools\u201d which are routines that can be used to take various \ndata as input in order to create new datasets. This tutorial will provide an introduction to \nusing the Toolbox  by using a previously developed a 2D UGrid. This UGrid will be used in \nthe tutorial to create a Voronoi UGrid. The History  feature of the Toolbox  will also be \ndemonstrated.  \n2 Opening the Starting Project  \nTo open the simulation and solution data:  \n1. Select File | Open\u2026  to bring up the Open dialog.  \n2. Select \u201cProject Files (*.sms)\u201d  from the Files of type  drop-down.  \n3. Browse to the Data Files folder for this tutorial and select \u201cstart.sms\u201d.  \n4. Click Open  to import the project and exit the Open  dialog.  \n5. If asked to delete existing data, click Yes. \nThe project should appear similar to Figure  1. \nThe project contains a 2D UGrid that will be used for creating additional UGrids using the \nToolbox.  \n \nFigure  1     Initial project  \n\nGMS Tutorials   Toolbox Introduction  \n \n Page 3 of 5 \u00a9 Aquaveo 2024  3 Using the Toolbox  \nThe Toolbox contains multiple tools for generating new geometries, rasters, and \ndatasets. It is accessed by doing the following:  \n1. Click the Toolbox    macro to open the Toolbox  dialog.  \nThe Toolbox dialog contains two tabs: Tools and History. The  Tools tab contains a set of \nfolders such as Datasets, Rasters, and Unstructured Grids. These folders can be \nexpanded to show groups of tools available. Double -clicking on a tool name will bring up \na dialog for entering the input for the tool run.  \n1.1 Convert to Voronoi UGrid  \nThe Compare Datasets tool subtracts one dataset, the \u201calternate\u201d, from a base dataset in \norder to create a new dataset. To use this tool, do the following:  \n1. In the Tools  tab, expand the \u201c  Unstructured Grids\u201d folder.  \n2. Double -click on the Voronoi UGrid from UGrid  tool to open the Voronoi UGrid \nfrom UGrid dialog.  \nThis tool takes an existing UGrid and creates a new Voronoi UGrid. The Voronoi UGrid \ncells will be created around the points in the input UGrid.  \nIn the Voronoi UGrid from UGrid  dialog,  notice the dialog is divided into two parts. The \nleft side lists the inputs and outputs of the tool. This tool has only one input, and one \noutput. Some tools have multiple inputs and/or outputs.  \nThe right side of the dialog contains documentation about th e tool. If GMS detects an \ninternet connection and can access https://www.xmswiki.com/ , the documentation comes \nfrom the XMS wiki. If the wiki is unreachable, only minimal documentation is presented.  \n3. For the Input gr id, select \u201cUGrid Data/ start_mesh_tri_quad \u201d. \n4. For the Output grid name , enter \u201cvoronoi\u201d . \n5. Click OK to close the Voronoi UGrid from UGrid  tool dialog and to start the \nprogress window for the tool.  \nThe progress window will show what the tool is doing and repor t any issues during the \nprocess. When the tool finishes, the statement \u201cSuccessfully ran tool\u201d appears at the top \nof the progress window.  \n6. Click OK to close the Voronoi UGrid from UGrid  progress window.  \n7. Click Close  to exit the Toolbox  dialog.  \n8. In the Project Explorer, turn off the \u201ctri -quad\u201d UGrid.  \nThe new \u201c  voronoi\u2019 UGrid will appear similar to Figure  2. \n\nGMS Tutorials   Toolbox Introduction  \n \n Page 4 of 5 \u00a9 Aquaveo 2024   \nFigure  2     The generated Voronoi  UGrid  \n4 Rerunning a Tool Using History  \nThe Toolbox keeps a history of all the tools that are run with a project. The history \nremembers the inputs used when a tool was run and can be used to rerun the tool with \nthe same inputs. This can be a handy time -savin g feature.  \n1. Click the Toolbox    macro to open the Toolbox  dialog.  \n2. Select the History  tab. \nThe History  tab will show one o r more folders depending how often the Toolbox has been \nused with the project. Each folder will be named with the date the tools in the Toolbox \nwere used. Each folder can be expanded to give a list of tools that were used on that \ndate.  \n1.2 Using Tools in Histo ry \nUsing the History  tab, the Voronoi UGrid from UGrid  tool can be r un again. To do this:  \n1. In the History  tab, expand the top folder which should be named with today\u2019s \ndate.  \nNotice the Voronoi UGrid from UGrid  tool is listed along with the date and time that it \nwas run.  \n2. Select the Voronoi UGrid from UGrid  tool.  \n3. Click the Run Tool From History  button to open the Voronoi UGrid from UGrid  \ntool dialog . \nIn the Voronoi UGrid from UGrid dialog, notice the Input grid  is already defined, and is the \nsame one chosen  last time. The output name is also filled in with the name used last \n\nGMS Tutorials   Toolbox Introduction  \n \n Page 5 of 5 \u00a9 Aquaveo 2024  time. For tools with multiple inputs/outputs, having the fields already populated can be a \nnice time -saving feature.  \n4. Change the Output grid name  to \u201cvoronoi 2\u201d.  \n5. Click OK to close the Voronoi UGrid from UGrid  tool dialog and start the progress \nwindow.  \n6. When the tool finishes running successfully, click OK to close the Voronoi UGrid \nfrom UGrid  progress window.  \nNotice a new entry has been added in  the History  tab. \n7. Click Close  to exit the Toolbox  dialog.  \nNotice the new \u201c  voronoi 2\u201d UGrid that was  created . This U Grid should appear identical \nto the previously generated Voronoi UGrid.  \n2 Saving the History  \nThe Toolbox saves a history of tools used with e ach project. To see how this works, \ncomplete the following:  \n1. Select File | Save As  to open the Save As  dialog.  \n2. For the File name, enter \u201cvoronoi.sms\u201d.  \n3. Click Save  to close the Save As  dialog.  \n4. Select File | New. \n5. Select File | Open\u2026  to bring up the Open dialog.  \n6. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n7. Browse to the Data Files folder for this tutorial and select \u201cvoronoi.gpr\u201d.  \n8. Click Open  to import the project and exit the Open  dialog.  \n9. Click the Toolbox    macro to open the Toolbox  dialog.  \n10. Select the History  tab. \nNotice that the History  tab still shows the tools that were run today as well as another \nother tool runs that might have been completed.   \n3 Conclusion  \nThis concludes the \u201cToolbox\u201d  tutorial. The following items were discussed : \n\uf0b7 Tools are routines that take one or more inputs and produce one or more \noutputs.  \n\uf0b7 Tools can help with many different areas in GMS and model building.  \n\uf0b7 The Toolbox History  can be used to rerun a tool and preserve previous field \nentries.  \n\uf0b7 The set of tools is currently limited but will expand greatly in the future.  \nFeel free to continue experimenting with the other tools in the Toolbox, or exit GMS.  \n\n", "filename": "Toolbox.pdf", "pages": 5}, "UGridClipping": {"text": "GMS Tutorials   Ugrid Clipping  \n Page 1 of 9 \u00a9 Aquaveo 2023   \n GMS 10. 8 Tutorial  \nUgrid Clipping  \nUsing the clipping display option to visualize UGrid data  \n \nObjectives   \nThis tutorial describes the UGrid clipping tool. The UGrid clipping tool can be used to cut away a portion \nof a UGrid  to visualize the data inside.  \n \nPrerequisite Tutorials  \n\uf0b7 Getting Started  Required Components  \n\uf0b7 GMS Core  \n Time  \n\uf0b7 10\u201315 minutes  \n \nGMS 10. 8 \n\nGMS Tutorials   Ugrid Clipping  \n Page 2 of 9 \u00a9 Aquaveo 2023  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Using a Clipping Plane  ................................ ................................ ................................ ........  2 \n2.1 Opening the UGrid Stratigraphy Project  ................................ ................................ ....... 2 \n2.2 Manually Setting a Clipping Plane  ................................ ................................ ................  3 \n2.3 Using the Clipping lane Widget  ................................ ................................ .....................  4 \n3 Clipping to Scalar Values  ................................ ................................ ................................ .... 5 \n3.1 Opening the UGrid Project  ................................ ................................ ............................  5 \n3.2 Clipping to UGrid Cells Above a Scalar Value  ................................ ..............................  6 \n3.3 Clipping to Smoothed UGrid Within a Scalar Range  ................................ .....................  7 \n3.4 Removing Additional Cells with Cell Visibility  ................................ ...............................  8 \n4 Conclusion  ................................ ................................ ................................ ...........................  9 \n \n1 Introduction  \nThe UGrid clipping display option can be used to cut away a portion of a UGrid and \nvisualize the data inside the grid. It can be used to cut part of the UGrid using a clipping \nplane or by using scalar dataset values.  \n2 Using a Clipping Plane  \nFor this section  of the tutorial, a UGrid with complex stratigraphy will be opened. A \nclipping plane will then be used to cut away a portion of a UGrid to visualize the inner \nstratigraphy.  \nTo get started, do the following:  \n1. Launch GMS.  \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to the default state.  \n2.1 Opening the UGrid Stratigraphy Project  \nNext, to open the GMS project containing the UGrid:  \n1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cAll Files (*.*)\u201d from the Files of type drop-down.  \n3. Browse to the UGridClip \\UGridClip  directory and select \u201colele.gpr\u201d.  \n4. Click Open to import the project and close the Open  dialog.   \nThe UGrid should appear in the Graphics Window as shown in Figure 1. \n\nGMS Tutorials   Ugrid  Clipping  \n \n Page 3 of 9 \u00a9 Aquaveo 2023   \n      Figure 1      UGrid with outer stratigraphy  \n2.2 Manually Setting a Clipping Plane  \nThe location of the clipping plane can be specified manually by entering a poin t on the \nplane, and the plane's normal vector. This tutorial will display the stratigraphy looking \nfrom the southeast with a plane running through cell ID 613. The first step is to determine \nthe location and normal vector for the clipping plane.  \n1. Make sure  the \u201cquadtree -3d\u201d mesh is active in the Graphics Window.  \n2. Select the Edit | Select by ID  menu item to open the Select  dialog.  \n3. Set the ID to \u201c613\u201d.  \n4. Click OK to exit the Select  dialog.  \nFrom the status bar at the bottom  of the GMS window , notice the centroid of the cell is at \napproximately (1715229, 17428353, 8.7).  \nBy default, the normal vector points away from the portion of the UGrid to be clipped. \nTherefore, to clip away the southwest portion of the UGrid the normal vector should be \nset to (-1, 1, 0).  \n5. Select the Edit | Unselect All menu item to clear the selected cell.  \nNow to turn on the clipping display option:  \n6. Click Display Options   to bring up the Display Options  dialog.  \n7. Select UGrid: quadtree -3d \u2013 [Active]  from the list on the left.  \n8. Turn on the Clip option, and click on the Options... button to open the UGrid Clip \nSettings  dialog.  \n9. The Clip Type  should be set to \u201cPlane\u201d.  \n10. Change the Clip To  setting to \u201cPartial Cells\u201d.  \n \n \n\nGMS Tutorials   Ugrid  Clipping  \n \n Page 4 of 9 \u00a9 Aquaveo 2023   \n11. Enter the following values in the rest of the UGrid Clip Settings  dialog:  \nItem Value  \nPlane Point X  1715229  \nPlane Point Y  17428353  \nPlane Point Z  8.7 \nPlane Normal X  -1.0 \nPlane Normal Y  1.0 \nPlane Normal Z  0.0 \n12. Click OK to close the UGrid Clip Settings  dialog.  \n13. Click OK to close the Display Options  dialog.  \nThe clipped UGrid should appear in the Graphics Window as shown in Figure 2. \n \nFigure 2     UGrid with clipped stratigraphy  \n \n2.3 Using the Clipping lane Widget  \nThe clipping plane widget provides a much easier way to position the clipping plane.  \n1. Select the Edit Clip Plane   tool. \nThe clipping plane widget should appear in the Graphics Window as shown in Figure 3. \nThe widget shows the plane as a translucent rectangle , the point defining the plane is \nshown in the rectangle , and the normal is shown as an arrowed line segment passing \nthrough the plane. A grayed out bounding box is displayed around the UGrid.  \nThe plane, point, and normal can each be edited by clicking on them and dragging them \nwithin the bounding box in the Graphics Window. Dragging the clipping plane moves the \nplane po int back and forth along the plane normal. Dragging the plane point moves it \nabout the surface of the plane. And dragging tail or head of the normal vector changes \nthe normal orientation about the plane point.  \n\nGMS Tutorials   Ugrid  Clipping  \n \n Page 5 of 9 \u00a9 Aquaveo 2023  2. Change the clipping plane location by clicking  in the plane and dragging it toward \nthe back corner of the gray bounding box.  \nExperiment with moving the plane about the UGrid by also adjusting the plane point and \nnormal.  \n \nFigure 3     UGrid with clipping plane widget  \n3 Clipping to Scalar Values  \nIn this section of the tutorial, a GMS project with a UGrid containing a dataset with cell -\nby-cell contaminate concentration values in parts -per-million (ppm) will be loaded in. The \nUGrid clip display option will be used to display the con taminate plume.  \n3.1 Opening the UGrid Project  \nFirst, to open the GMS project containing the UGrid data:  \n1. Select File | New to close the \u201colele.gpr\u201d project and , if desired , save the project \nto different location.  \n2. Click Open   to bring up the Open  dialog.  \n3. Select \u201cAll Files (*.*)\u201d from the Files of type  drop-down.  \n4. Browse to the UGridClip \\UGridClip  directory and select \u201ccontaminate_plume.gpr\u201d.  \n5. Click Open to import the project and close the Open  dialog.  \nThe UGrid with the concentration data should appear in t he Graphics Window as shown \nin Figure 4, with contours of the plume visible on the front left face of the grid.  \n\nGMS Tutorials   Ugrid  Clipping  \n \n Page 6 of 9 \u00a9 Aquaveo 2023   \nFigure 4      UGrid with contaminate concentration contours  \n3.2 Clipping to UGrid Cells Above a Scalar Value  \nNow to use scalar clipping to display the portion of the UGrid with a contaminant value \ngreater than 2000 ppm:  \n1. Click Display Options   to bring up the Display Options  dialog.  \n2. Select UGrid:ugrid \u2013 [Active] in the list on the left.  \n3. Turn on the Clip option, and select the Options  button to open the UGrid Clip \nSettings  dialog.  \n4. Change the Clip Type  to \u201cScalar\u201d.  \n5. The Clip To  option should be set to \u201cWhole Cells\u201d.  \n6. Enter  \u201c2000.0\u201d for the Scalar Value . \n7. Click OK to close the UGrid Clip Settings  dialog.  \n8. Click OK to close the Display Options  dialog.  \nThe Graphics Window should display the plume as shown in Figure 5.  \n\nGMS Tutorials   Ugrid  Clipping  \n \n Page 7 of 9 \u00a9 Aquaveo 2023   \nFigure 5      UGrid con taminate plume with scalar and whole cells  \n3.3 Clipping to Smoothed UGrid Within a Scalar Range  \nThe next step is to use the \u201cScalar Range\u201d clip option to display an outer portion of the \nplume as well as using the \u201cPartial Cells\u201d option to get a smoother view of the plume.  \nTo use the \u201cPartial Cells\u201d option with scalar values , it is necessary to use a  dataset where \nthe dataset values are on the nodes (or points) of the UGrid rather than the cell. To do \nso, it is necessary to convert the cell dataset into a node dataset.  \n1. Right -click on the \u201ccontaminant\u201d dataset and select the Convert to Point \nDataset  menu item to bring up the New Dataset Name dialog.  \n2. Click OK to use the default dataset name and close the New Dataset Name  \ndialog.  \nNow with the new dataset (\u201ccontaminant point data\u201d) selected as the active dataset, \nchange the clip display options:  \n3. Click Disp lay Options   to bring up the Display Options  dialog.  \n4. Click on the Options  button next to the Clip option to open the UGrid Clip \nSettings  dialog.  \n5. Change the Clip Type  to \u201cScalar Range\u201d.  \n6. Change the Clip To  option to \u201cPartial Cells\u201d.  \n7. Enter \u201c2000.0\u201d for the Minimum Scalar Value . \n8. Enter \u201c9000.0\u201d for the Maximum Scalar Value . \n9. Click OK to close the UGrid Clip Settings  dialog.  \n10. Click OK to close the Display Options  dialog.  \nThe Graphics Window should display the plume as shown in Figure 6.  \n\nGMS Tutorials   Ugrid  Clipping  \n \n Page 8 of 9 \u00a9 Aquaveo 2023   \nFigure 6      UGrid contaminate plume with scalar range and partial cells  \n3.4 Removing Additional Cells with Cell Visibility  \nCell visibility can be used along with the clipping display option to remove more of the \nUGrid and see inside the plume. To do so, it is possible to hide the cells near the front -left \nface of the UGrid.  \n1. Switch to Plan View  . \n2. Using the Select Cells   tool, drag a rectangle in the Graphics Window to select \nthe cells of the bottom half of the plume.  \n3. Click on the Hide Cells   command to hide the selected cells.  \n4. Switch to Oblique View  . \nThe Graphics Window should appear similar to Figure 7. The hidden cells can be \nredisplayed using the Show Cells   command.  \n\nGMS Tutorials   Ugrid  Clipping  \n \n Page 9 of 9 \u00a9 Aquaveo 2023   \nFigure 7      UGrid contaminate plume with hidden cells  \n4 Conclusion  \nThis concludes the \u201cUGrid Clipping\u201d tutorial. Topics covered in the tutorial include clipping \nUGrids with a clipping plane, clipping above or below a scalar value, clipping to a scalar \nrange, and using cell visibility to clip additional cells.  \n \n\n", "filename": "UGridClipping.pdf", "pages": 9}, "UGridCreation": {"text": "GMS Tutorials   UGrid Creation  \n Page 1 of 21 \u00a9 Aquaveo 2024   \n GMS 10. 8 Tutorial \nUGrid Creation  \nCreating unstructured grids (UGrids) in GMS  \nObjectives   \nThis tutorial gives an overview about unstructured grids, or UGrids, and several methods for creating \nthem in GMS.  \n \nPrerequisi te Tutorials  \n\uf0b7 Getting Started  Required Components  \n\uf0b7 GMS Core  Time  \n\uf0b7 15\u201330 minutes  \n \nGMS 10.8  \n\nGMS Tutorials   UGrid Creation  \n Page 2 of 21 \u00a9 Aquaveo 2024  1 Introduction  ................................ ................................ ................................ ..........................  2 \n2 Getting Started  ................................ ................................ ................................ .....................  2 \n3 Importing a UGrid  ................................ ................................ ................................ ................  2 \n3.1 Importing a 3D UGrid  ................................ ................................ ................................ .... 2 \n3.2 Cell Faces  ................................ ................................ ................................ .....................  3 \n3.3 Importing a 2D UGrid  ................................ ................................ ................................ .... 4 \n4 Creating a New UGrid  ................................ ................................ ................................ ..........  5 \n4.1 3D UGrid  ................................ ................................ ................................ .......................  5 \n4.2 2D UGrid  ................................ ................................ ................................ .......................  6 \n4.3 Using a Grid Frame  ................................ ................................ ................................ ...... 7 \n4.4 Moving and Resizing the Grid Frame  ................................ ................................ ...........  7 \n5 Converti ng from Other Object Types  ................................ ................................ .................  9 \n5.1 Converting from a 3D Grid  ................................ ................................ ............................  9 \n5.2 Converting from a Shapefile  ................................ ................................ .......................  10 \n5.3 Extruding a 2D UGrid to a 3D UGrid  ................................ ................................ ...........  11 \n6 Using the Map to UGrid Dialog  ................................ ................................ .........................  11 \n6.1 Regular (not refined ) ................................ ................................ ................................ ... 13 \n6.2 Quadtree / Octree  ................................ ................................ ................................ ....... 14 \n7 Horizons to UGrid  ................................ ................................ ................................ ..............  19 \n7.1 Viewing th e 3D Quadtree UGrid  ................................ ................................ .................  20 \n8 Conclusion  ................................ ................................ ................................ .........................  21 \n \n1 Introduction  \nThe UGrid module in GMS makes use of  \u201cunstructured grid \u201d geometric objects. These \nunstructured grid object s are referred to as \u201cUGrids\u201d.  A UGrid is similar to the 3D grids \nand meshes available in GMS but are more flexible. UGrids can use any type of cell, \nmeaning cells with any number of faces and nodes. This flexibility allows for more \nrealistic modeling of g eologic features such as pinchouts. UGrids were added to GMS in \norder to support MODFLOW \u2013USG which uses the finite volume method.  \nThere are several ways to create UGrids in GMS. This tutorial will discuss and \ndemonstrate importing UGrids and using the New UGrid  commands to create UGrids. \nUGrids will be created using multiple methods, including by converting other data types to \nUGrids, by using the Map \u2192 UGrid  command, and by using the Horizons \u2192 UGrid  \ncommand.  \n2 Getting Started  \nDo the following to get started : \n1. If necessary, launch GMS.   \n2. If GMS is already running, select File | New to ensure that the program settings \nare restored to their default state.  \n3 Importing a UGrid  \n3.1 Importing a 3D UGrid  \nThe simplest way to get a UGrid into GMS is to import one that has al ready been created. \nGMS recognizes the VTK unstructured grid file format.  \nTo import a 3D UGrid that has already been created and saved in a file, do the following:  \nGMS Tutorials   UGrid Creation  \n \n Page 3 of 21 \u00a9 Aquaveo 2024  1. Click Open   to bring up the Open  dialog.  \n2. Select \u201cAll Files (*.*)\u201d from the Files of type  drop-down.  \n3. Browse to the UGridCreation \\UGridCreation  directory and select \u201c ugrid.vtu \u201d. \n4. Click Open  to import the file and exit the Open  dialog.  \n5. Switch to Oblique View  . \nA wireframe depiction of the UGrid should appear ( Figure 1). \n \n      Figure 1      Imported UGrid  \n3.2 Cell Faces  \nNow to review some of the UGrid display options:  \n1. Click Display Options   to bring up the Display Options  dialog.  \n2. Select \u201c  Ugrid:ugrid \u2013 [Active]\u201d from the list on the left.  \n3. On the \u201c  Ugrid :ugrid \u2013 [Active]\u201d  tab, turn on Cell faces . \n4. Click OK to exit the Display Options  dialog.  \nThe cell faces should be visible with different colors for different layers ( Figure 2). The \ncolors come from the materials assigned to the cells.  \n\nGMS Tutorials   UGrid Creation  \n \n Page 4 of 21 \u00a9 Aquaveo 2024   \n      Figure 2      UGrid with cell faces turned on  \n5. Use the Rotate   tool to view the UGrid from different angles.  \nOn examination, this UGrid is composed of prismatic, wedge elements. It has an irregular \nboundary, and it appears to be made of three layers. Remember, however, that a UGrid \nis unstructured and need not have continuous layers, or any layers at all. The cells of this \ngrid are 3D cells.  \nTo review the UGrid Properties  dialog, do the following:  \n6. In the Project E xplorer , right -click on \u201c  ugrid \u201d and select Properties \u2026 to open \nthe UGrid Properties dialog.  \nNotice the number of 2D and 3D cells; this UGrid is composed of only 3D cells.  \n7. Click OK to close the UGrid Properties  dialog.  \n3.3 Importing a 2D UGrid  \nNext to review another example of an imported UGrid:  \n1. Click the New  button to start a new project.  \n2. If asked to save, click Don\u2019t Save . \n3. Click Open   to bring up the Open  dialog.  \n4. Select \u201cAll Files (*.*)\u201d from the Files of type  drop-down.  \n5. Select \u201c cow.vtu \u201d and click Open  to import the project and exit the Open  dialog.  \nA UGrid should appear showing a wireframe cow ( Figure 3). This type of unstructured \ngrid is not very useful for groundwater modeling, but it illustrates the flexibility of the \nUGrid m odule in GMS.  \n\nGMS Tutorials   UGrid Creation  \n \n Page 5 of 21 \u00a9 Aquaveo 2024   \n      Figure 3      Imported cow unstructured grid  \n6. Use the  rotate tool to view the UGrid from different angles.  \n7. In the Project Explorer , right -click on the \u201c  cow\u201d UGrid and select Properties\u2026  \nto open the UGrid Pr operties dialog.  \nAgain notice the number of 2D and 3D cells. This UGrid is a hollow shell composed of 2D \ncells. Although this UGrid is not particularly useful for groundwater modeling, 2D UGrids \nare used in GMS as projection grids to create 3D UGrids, as p resented later on.  \n8. Click OK to exit the UGrid Properties  dialog.  \n4 Creating a New UGrid  \nAnother easy way to create a UGrid in GMS is using the UGrid options in the right -click \nNew menus. These commands and their associated dialogs work almost identically to \nthose used to create new 2D and 3D structured grids.  \n4.1 3D UGrid  \n1. Click New  to start a new project.  \n2. If asked to save, click Don\u2019t Save . \n3. Right -click in either the Project Explorer  or the Graphics Window  and select New \n| UGrid 3D\u2026  to bring up the New UGrid  dialog ( Figure 4). \nThis dialog is almost identical to the dialog used to create structured 3D grids. It allows \nspecifying the origin and length of the grid and the number of cells in X, Y and Z \ndimensions. Alternatively, the dialog  can be used to specify the cell sizes and even define \na bias, causing cell sizes to increase or decrease from one side of the grid to the other. A \nbetter way to do cell biasing will be discussed later in this tutorial.  \n\nGMS Tutorials   UGrid Creation  \n \n Page 6 of 21 \u00a9 Aquaveo 2024   \n      Figure 4      New UGrid dialog  \n4. Below the Z-Dimension  section, enter \u201c10.0\u201d as the Rotation about Z -axis. \n5. Click OK to accept the default values  and close the New UGrid  dialog.  \n6. Switch to Oblique View  . \nA 3D UGrid should be visible ( Figure 5). Notice that the cells are all 6 -sided 3D objects, \nor hexahedrons. This method always creates UGrids with hexahedron cells in 3D, and \nquadrilateral cells in 2D. The creation of more exotic cell types will be covered later in the \ntutorial.  \n \n      Figure 5      New 3D UGrid  \n4.2 2D UGrid  \nThe New | UGrid 2D \u2026 command works the same but instead creates a UGrid with only \n2D cells. The dialog is the same except that only the option to specify cells in the Z \ndimension is available. Feel  free to experiment with this command.  \n\nGMS Tutorials   UGrid Creation  \n \n Page 7 of 21 \u00a9 Aquaveo 2024  4.3 Using a Grid Frame  \nAlthough using the New UGrid  dialog is a quick and easy way to create a UGrid, it \nrequires knowing the origin and lengths of the grid in each dimension. An easier way is to \ncreat a grid frame that s urrounds the existing data. This allows for orienting the grid \ngraphically before using the New UGrid  dialog.  \n1. Click New  to start a new project.  \n2. If asked to save, click Don\u2019t Save . \n3. Click Open   to bring up the Open  dialog.  \n4. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n5. Select \u201c biscayne.gpr \u201d and click Open  to import the project and exit the Open  \ndialog.  \nA conceptual model should be visible including well points and arcs representing rivers \nand canals.  \n6. Right -click in either the Project Ex plorer  or the Graphics Window  and select New \n| Grid Frame  to create a new grid frame.  \nNow it is necessary to fit it around the data.  \n7. Right -click on \u201c  Grid Frame\u201d in the Project Explorer and select Fit To Active \nCoverage . \n4.4 Moving and Resizing the Grid Frame  \nAlthough the Fit To Active Coverage  command is convenient, it is possible to rotate the \ngrid frame or resize it to better fit the data.  \n1. Using the Select Grid Frame   tool, rotate, resize, and reposition the grid frame \nto more or less match the image shown  in Figure 6. \n\uf0b7 Drag the corners or sides of the grid frame to resize it.  \n\uf0b7 Click anywhere inside the grid frame, or on an edge \u2014but not on an anchor \npoint \u2014to drag and move the entire grid frame.  \n\uf0b7 Click and drag on the circle in the low er right corner to rotate the grid frame.  \n\nGMS Tutorials   UGrid Creation  \n \n Page 8 of 21 \u00a9 Aquaveo 2024   \n      Figure 6      Grid frame surrounding a conceptual model  \n2. When finished positioning the grid frame, right -click in the Project Explorer  and \nselect New | UGrid 3D \u2026 to bring up the New UGrid  dialog.  \nNotice that the origins, lengths, and rotation are defaulted to values that come from the \ngrid frame.  \n3. Click OK to accept the defaults and close the New UGrid  dialog.  \nGMS creates the UGrid inside the boundary of the grid frame ( Figure 7). If this were a \nreal model, more cells might need to be created.  \n4. Turn off the \u201c  ugrid \u201d in the Project Explorer.  \n \n      Figure 7      The UGrid created inside the grid frame  \n\nGMS Tutorials   UGrid Creation  \n \n Page 9 of 21 \u00a9 Aquaveo 2024  5 Converting from Other Object Types  \nUGrids can be created from several other types of objects in GMS, including TINs, 2D \nand 3D grids and meshes, polygons in a coverage, and polygon shapefiles in the GIS \nmodule. Two example conversions are demonstrated here.  \n5.1 Converting from a 3D Grid  \nThe cur rent project includes a 3D Grid that is turned off. It is possible to convert it to a \nUGrid.  \n1. Fully expand the \u201c  3D Grid Data\u201d folder in the Project Explorer.  \n2. Turn on \u201c grid\u201d, then right -click and select Convert To  | UGrid . \n3. Select Yes at the prompt to on ly convert active cells used by MODFLOW.  \nThere are inactive cells in the 3D grid that can't be seen because they are set to 0 in the \nMODFLOW IBOUND array. By selecting yes, GMS will not include those cells in the \nUGrid.  \n4. Turn o ff \u201c grid\u201d so that the UGrid is visible.  \n5. Click Display Options   to bring up the Display Options  dialog.  \n6. Select \u201c  Ugrid:ugrid (2) \u2013 [Active]\u201d from the list on the left.  \n7. On the UGrid :ugrid (2) \u2013 [Active]  tab, turn on Cell faces . \n8. Click OK to close the Display Options  dialog.  \nThe UGrid should now look just like the 3D grid it came from ( Figure 8). \n \n      Figure 8      UGrid created from the 3D grid  \n\nGMS Tutorials   UGrid Creation  \n \n Page 10 of 21 \u00a9 Aquaveo 2024  5.2 Converting from a Shapefile  \nA UGrid can be created by conversion from a shapefile.  \n1. Turn off \u201c UGrid Data\u201d and \u201c  Map Data\u201d in the Project Explorer.  \n2. Turn on \u201c  GIS Layers\u201d.  \nA shapefile should appear in the form of a quadtree grid ( Figure 9). Quadtree UGrids can \nbe created in GMS or imported and then converted to UGri ds as shown here.  \n \n      Figure 9      Shapefile showing a quadtree grid  \n3. Zoom   in on the shapefile to better see the quadtree refinement.  \n4. When done examining the grid refinement, Frame   the project.  \n5. In the Project Explorer, rig ht-click on \u201c Map Data \u201d and select New Coverage . \n6. Expand \u201c  GIS Layers\u201d, then right -click on \u201c  biscayne.shp \u201d and select \nConvert To | Feature Objects  to open the GIS to Feature Objects Wizard.  \n7. For the Select a coverage for mapping , select the \u201cnew coverage \u201d from the drop -\ndown.   \n8. Select Next  to go to the next step of the GIS to Feature Objects Wizard  dialog.  \n9. Accept the default settings and click Next . \n10. Accept the default settings and click Finish  to close the GIS to F eature Objects \nWizard  dialog . \n11. Right -click o n \u201c  new coverage\u201d and select Map to  | Polygons \u2192 UGrid . \n12. Turn off \u201c biscayne.shp\u201d.  \n13. Zoom   in to see that the quadtree refinement matches the shapefile.  \n\nGMS Tutorials   UGrid Creation  \n \n Page 11 of 21 \u00a9 Aquaveo 2024  5.3 Extrud ing a  2D UGrid to a 3D UGrid  \nNow the UGrid consists of 2D cel ls. To create a MODFLOW model with the grid, a 3D \nUGrid is needed. To extrude the 2D UGrid into a 3D UGrid, do the following:  \n1. Switch to Oblique View  . \n2. Zoom   on one of the edges of the grid to see that the cells have no depth.  \n3. Click the Toolbox    macro t o open the Toolbox  dialog if it is not already open.  \n4. In the Tools  tab, expand the \u201c  Unstructured Grids\u201d folder.  \n5. Double -click on the Extrude UGrid  tool to open the Extrude UGrid dialog.  \n6. For the Input grid , select \u201cUGrid Data/biscayne \u201d. \nNote that the Extrud e UGrid  tool allows defining multiple layers for the new 3D UGrid. For \nthis example, only one layer will be generated.  \n7. For the Layer 1 thickness , enter \u201c100\u201d.  \n8. For the Output grid , enter \u201cbiscayne 3d\u201d.  \n9. Click OK to close the Extrude UGrid  tool dialog and to start the progress window \nfor the tool  \n10. Click OK to close the Extrude UGrid  progress window . \nThe new UGrid is now 3D and therefore has depth ( Figure 10). \n \n      Figure 10      2D UGrid extruded to a 3D UGr id \n6 Using the Map to UGrid Dialog  \nThe next way to create UGrids is by using the Map \u2192 UGrid  dialog. This dialog provides \ntools that are more powerful than the methods seen previously because it creates \nquadtree, octree, and Voronoi UGrids using a conceptual  model. The UGrid boundaries \ncan be made to match the conceptual model boundaries.  \n1. Click the New  button to start a new project.  \n2. If asked to save, click Don\u2019t Save . \n3. Click Open   to bring up the Open  dialog.  \n4. Select \u201cProject Files (*.gpr)\u201d from the Files o f type  drop-down.  \n\nGMS Tutorials   UGrid Creation  \n \n Page 12 of 21 \u00a9 Aquaveo 2024  5. Select \u201c mapToUGrid.gpr \u201d and click Open  to import the project and exit the Open  \ndialog.  \n6. Fully expand \u201c  Map Data\u201d and turn on \u201c  Grid Frame\u201d in the Project Explorer.  \nThis opens a grid frame and conceptual model with two coverages ( Figure 11). \n \n      Figure 11      Conceptual model and grid frame  \nThe conceptual model represents an area of interest where a groundwater model will be \ncreated. The top arc will be a constant head boundary and th e other boundary arcs will \nbe no flow boundaries. The arc in the middle represents a stream. There are two well \npoints, one in a separate coverage. There is also a rectangular area in the lower right \npart of the model where greater refinement is desired.  \nNow to map the feature objects to create a new UGrid and look at the options:  \n7. Right -click on \u201c  Grid Frame\u201d.  \n8. Click the Map \u2192 UGrid   macro to bring up the Map \u2192 UGrid  dialog ( Figure \n12).  \nThe first drop -down is Dimension , which is  either \u201c2D\u201d or \u201c3D\u201d.  The next is UGrid type , \nwhich has four choices: \u201cRegular (not refined),\u201d \u201cQuadtree / Octree,\u201d \u201cNested Grid\u201d, and \n\nGMS Tutorials   UGrid Creation  \n \n Page 13 of 21 \u00a9 Aquaveo 2024  \u201cVoronoi\u201d. The nested grid option is not discussed in this tutorial.1 The best way to \nexplain the other three is to demo nstrate them.  \n \n      Figure 12      Map \u2192 UGrid dialog  \n6.1 Regular (not refined)  \nNotice that the grid will have 10 cells in the X and Y dimensions and three cells in the Z \ndimension. GMS uses the grid frame to determine the size of the grid and the number of \ncells to determine the cell size. Either specify the number of cells like this, or specify the \ncell size and let GMS determine how many cells will fit in each dimension. In that case, \nthe cell size specification is only a target size because the size will almost always need to \nbe adjusted so that  partial cells don\u2019t appear along the edges.  \n1. Click OK to accept the defaults and close the Map \u2192 UGrid  dialog.  \nNotice the rectangular cells. This is what is meant by the \u201cRegular (not refined)\u201d option. \nAlso notice that the cells outside the outer polygon boundary (the grid frame) are not \nincluded in the UGrid. They are not inactive \u2014they simply d on't exist.  \n2. Switch to Oblique View  . \nThe UGrid is 3D with three layers, and its dimensions fit the grid frame. The X and Y \ndimensions are 10 by 10 cells ( Figure 13). \n                                                      \n1 The nested grid option creates a grid with rectangular cells that are  refined like the quadtree \noption, but the surrounding cells are not smoothed.  \n\nGMS Tutorials   UGrid Creation  \n \n Page 14 of 21 \u00a9 Aquaveo 2024   \n      Figure 13      Regular (not re fined) appearance  \n6.2 Quadtree / Octree  \nQuadtree: All Layers the Same  \nNow to see what the quadtree option produces:  \n1. Switch to Plan View   and turn off the new \u201c  ugrid\u201d.  \n2. Click the Map \u2192 UGrid   button to open the Map \u2192 UGrid dialog.  \n3. Select \u201cQuadtree/Octree\u201d from the UGrid type  drop-down.  \n4. Select \u201cUse refine points in active coverage only\u201d from the Refine points  drop-\ndown.  \n5. Select \u201cRefine all layers the same\u201d from both the Point refinement  and Arc/poly \nrefinement drop-downs.  \n6. Click OK to close the Map \u2192 UGrid  dialog.  \nNotice the grid has been refined in a quadtree fashion around the arcs, points, and \npolygons ( Figure 14). With a quadtree grid, each cell has \u2014at most \u2014two neighboring \ncells to the side. The largest cells are the same size as in the regular grid. This means \nthat the number of cells specified in the Map \u2192 UGrid  dialog for the X, Y and Z \ndimensions refers to the unrefined number of cells or the number of cel ls that would exist \nif there was no refinement.  \n7. Turn on the Single layer  option in the UGrid Viewing Mode \n toolbar and change the layer to \u201c 2,\u201d then \u201c 3\u201d. \nThe Single layer  option allows viewing one layer of the UGrid at a time. Notice that all \nlayers are r efined the same. This tutorial will now cover how to define the refinement in \nthe conceptual model.  \n \n\nGMS Tutorials   UGrid Creation  \n \n Page 15 of 21 \u00a9 Aquaveo 2024   \n      Figure 14      Quadtree UGrid  \nRefinement Attributes  \nRefinement is specified as attributes on feature objects in the concep tual model.  \n1. Turn off the new \u201c  ugrid (2)\u201d in the Project Explorer.  \n2. Select \u201c  Map Data \u201d to switch to the Map  module dynamic tools.  \n3. Using the Select Arc   tool, double -click one of the arcs along the top of the \ncoverage to bring up the Attribute Table  dialog. \nNotice that the Refine  attribute is on and the Base size  (ft) is set to \u201c100.0\u201d or \u201c200.0\u201d \n(depending on which arc is clicked on). UGrid cells along this arc will therefore be about \n100 (or 200) feet in size.  \n4. Click Cancel  to close the Attribute Table  dialog.  \n5. Using the Select   tool, double -click on the well point in the upper right area to \nbring up the Attribute Table  dialog.  \nNotice that the Refine  attribute is on and the Base size  (ft) is set to \u201c75.0\u201d. The UGrid cell \nat this location therefore, will be 75 feet in size. The Bias and Max size  options are \nignored when creating quadtree UGrids. These options are only used when creating \nstructured 3D grids.  \n6. Click Cancel  to close the Attribute Table  dialog.  \n7. Using the Select   tool, double -click on the recta ngular polygon in the lower area \nto bring up the Attribute Table  dialog.  \nRefinement is on and Base size (ft)  is set at \u201c100.0\u201d, so all cells in this area of the UGrid \nwill be about 100 feet in size.  \n8. Click Cancel  to close the Attribute Table  dialog . \n\nGMS Tutorials   UGrid Creation  \n \n Page 16 of 21 \u00a9 Aquaveo 2024  9. Double -click somewhere in the main polygonal area to bring up the Attribute \nTable  dialog.  \nNotice that refinement is off. Cells in this area will be allowed to grow to the maximum \nallowed size.  \n10. Click Cancel  to close the Attribute Table  dialog . \n11. Double -click on the \u201c M1\u201d coverage in the Project Explorer  to bring up the \nCoverage Setup  dialog.  \nNotice the Refinement  attribute is on in the list of Sources/Sinks/BCs . This must be on in \norder to have the Refine  attribute available for points, arcs, and polygons.  \n12. Click Cancel to close the Coverage Setup  dialog . \nQuadtree/Octree  \nNow to review the Octree  option for points:  \n1. Using the Select   tool, double -click on the well point in the upper right area to \nbring up the Attribute Table  dialog.  \n2. Enter \u201c3\u201d in both the From layer  and To layer  columns.  \n3. Click OK to close the Attribute Table  dialog . \n4. Click the Map \u2192 UGrid   macro to bring up the Map \u2192 UGrid  dialog.  \n5. Select \u201cOctree\u201d from the Point refinement  drop-down.  \n6. Click OK to accept the defaults and close the Map \u2192 UGrid  dialog.  \n7. Use th e UGrid Viewing Mode  toolbar to view layers 2 \nand 3. \nNotice that each layer has a different refinement, and that layer 3 \u2014where the point is \nlocated \u2014is the most highly refined. The octree option thus refines vertically as well as \nhorizontally. Every cell has at most two neighboring cells to the side, and four \nneighboring cells above or below. This option does not subdivide the layers into smaller \ncells. There are still only three layers of cells throughout the UGrid.  \nThe octree option is also available for  arcs and polygons and works similarly.  \nQuadtree on Assigned Layers  \nNow to look at the q uadtree on assigned layers  option:  \n1. Turn off the new \u201c  ugrid (3)\u201d.  \n2. Click the Map \u2192 UGrid   macro to bring up the Map \u2192 UGrid  dialog.  \n3. Select \u201cQuadtree on assigned layers \u201d from the Arc/poly  refinement  drop-down.  \n4. Click OK to close the Map \u2192 UGrid  dialog.  \n5. Use the UGrid Viewing Mode  toolbar to view layers 2 \nand 3. \nNotice that quadtree refinement around arcs and polygons only occurs in layer 1. The \nQuadtree on assigned layer s option only refines cells in the layer that the arcs or \npolygons are assigned to. The arcs and polygons are all assigned to layer 1 by using the \nLayer range  attribute in the Coverage Setup  dialog and, for each arc or polygon, by \n\nGMS Tutorials   UGrid Creation  \n \n Page 17 of 21 \u00a9 Aquaveo 2024  specifying 1 in the From layer  and To layer  attributes. The transition from layer 2 to layer \n3 is therefore more abrupt and not smoothed like it would be if using the Octree  option.  \nThe Quadtree on assigned layers  option results in fewer cells, which will decrease the \ntime requir ed to get a solution at the tradeoff of computational accuracy. If groundwater \nflow is primarily horizontal, this might be a good tradeoff.  \nFor more practice creating quadtree UGrids, the \u201c MODFLOW -USG \u2013 Quadtree \u201d tutorial \nalso discusses and demonstrates qu adtree creation.  \nVoronoi  \nThe last option to look at in the Map \u2192 UGrid  dialog is the Voronoi option.  \n1. Turn off \u201c ugrid (4)\u201d in the Project Explorer.  \n2. Click the Map \u2192 UGrid   macro to bring up the Map \u2192 UGrid  dialog.  \n3. Select \u201cVoronoi\u201d from the UGrid type  drop-down.  \nNotice that almost all the other options become unavaila ble. This is because Voronoi \nUGrids are very different than the other types presented so far. The number of cells in the \nX and Y dimension cannot be specified with Voronoi UGrids. The cells are created with a \nmeshing and triangulation algorithm that depend s solely on the geometry of the points, \narcs, and, polygons in the active coverage.  \n4. Click OK to accept the defaults and close the Map \u2192 UGrid  dialog.  \n5. Click anywhere in the Graphics Window.  \n6. Switch to Plan View  . \nA Voronoi UGrid has a very different type of cell. The cells are designed such that the \nboundary conditions are located at the cell center and the faces between adjacent cel ls \nare perpendicular to a line connecting the cell centers ( Figure 15). This increases \ncomputational accuracy when using the finite volume method.  \n \n      Figure 15      Voronoi UGrid on layer 1  \n\nGMS Tutorials   UGrid Creation  \n \n Page 18 of 21 \u00a9 Aquaveo 2024  With Voron oi grids, the refinement attributes on the feature objects are ignored and only \nthe geometry of the feature objects matters. This means that in order to have a more \nrefined grid, it is necessary to redistribute vertices along arcs. In this case, redistribu te \nvertices more densely along the arc defining the rectangular polygon in the lower right to \nobtain smaller cells sizes in this area.  \nRefining the Polygon Arc  \n1. Turn off \u201c ugrid (5)\u201d in the Project Explorer.  \n2. Select \u201c  M1\u201d to make it active.  \n3. Using the Select Arcs   tool, right -click the arc forming the rectangular polygon \nin the lower right area of the larger polygon and select Redistribute Vertices \u2026 \nto open the Redistribute Vertices dialog.  \n4. Enter \u201c100.0\u201d for the Average spacing . \n5. Click OK to close the Redis tribute Vertices  dialog.  \n6. Click Map \u2192 UGrid   to bring up the Map \u2192 UGrid  dialog.  \n7. Click OK to accept the defaults and close the Map \u2192 UGrid  dialog.  \nNow the cells in the area of the polygon are much smaller ( Figure 16). \n \n      Figure 16      The area of the rectangular polygon is more refined  \n\nGMS Tutorials   UGrid Creation  \n \n Page 19 of 21 \u00a9 Aquaveo 2024  7 Horizons to UGrid  \nSo far, the methods used to generate UGrids either create 2D UGrids or 3D UGrids that \nhave layers that are continuous and flat in the Z dimension. Ele vation information for the \nlayer boundaries can be used to interpolate to the MODFLOW layer arrays and thus warp \nthe UGrid after it has been created. This is the same procedure used with structured 3D \ngrids and is described in the \u201c MODFLOW \u2013 Interpolating Layer Data \u201d tutorial.  \nAnother way to generate UGrids allows for creating layers that are not flat and may even \npinch out. This method uses the Horizons \u2192 UGrid  command. This method has its own \ntutorial \u2014\u201cMODFLOW -USG \u2013Complex Stratigraphy \u201d\u2014to explain it in d etail.  \nTo briefly look at this method, do the following:  \n1. Click New  to start a new project.  \n2. If asked to save, click Don\u2019t Save . \n3. Click Open   to bring up the Open  dialog.  \n4. Select \u201cProject Files (*.gpr)\u201d from the Files of type  drop-down.  \n5. Select \u201c horizons.g pr\u201d and click Open  to import the project and exit the Open  \ndialog.  \nA project containing a lot of data \u2014including boreholes, cross sections, and TINs - will \nappear ( Figure 17). All of this data is used in the converting from a horizo ns conceptual \nmodel to UGrid.  \n \n      Figure 17      The horizons conceptual model  \n6. Select \u201c  TIN Data\u201d in the Project Explorer  to make it active.  \n7. Select TINs | Horizons \u2192 UGrid \u2026 to bring up the Horizon Elevations  page of \nthe Horizo ns to UGrid  dialog.  \n8. In the Conceptual model  section, turn on Use horizons conceptual model . \n\nGMS Tutorials   UGrid Creation  \n \n Page 20 of 21 \u00a9 Aquaveo 2024  9. Click Next  to go to the Top and Bottom Elevations  page of the Horizons to UGrid  \ndialog.  \n10. In the Primary UGrid  section, select \u201c voronoi \u201d. \n11. In the Top elevation  sectio n, select TIN elevations . \n12. Click Next  to go to the Build UGrid  page of the Horizons to UGrid  dialog.  \n13. In the Meshing options  section, turn on Minimum element thickness  and enter \n\u201c2.0\u201d in the field below that.  \n14. Click Finish  to create the 3D UGrid and close the  Horizons to UGrid  dialog.  \n7.1 Viewing the 3D Quadtree UGrid  \nThe 3D UGrid generation should complete after a few moments, depending on the speed \nof the computer used. It is best practice to rename the new UGrid to a more descriptive \nname. For the purposes of t his tutorial, it will not be renamed.  \n1. Turn off \u201c Borehole Data\u201d and \u201c  Solid Data\u201d in the Project Explorer . \nA 3D UGrid should appear, similar to Figure 18. \n \n      Figure 18      3D Voronoi UGrid made usi ng the Horizons \u2192 UGrid command  \n2. On the UGrid Viewing Mode  toolbar, turn  on Single \nlayer . \n3. Review layers 1 \u20135 using the toolbar . \nNotice that this UGrid has some layers that are discontinuous (or that \u201cpinch out\u201d). The \ntop and bottom elevations of each layer  are irregular and match the solid, borehole and \ncross section data.  \n\nGMS Tutorials   UGrid Creation  \n \n Page 21 of 21 \u00a9 Aquaveo 2024  Feel free to experiment with the Horizons \u2192 UGrid  command. For further practice, refer \nto the \u201c MODFLOW \u2013USG \u2013 Complex Stratigraphy \u201d tutorial . \n8 Conclusion  \nThis concludes the \u201cUGrid Creation\u201d  tutorial.  The following  key concepts were discussed \nand demonstrated in this tutorial:  \n\uf0b7 UGrids can be created in GMS in the following ways:  \n\uf0b7 Importing  \n\uf0b7 New UGrid commands  \n\uf0b7 Conversion from other objects  \n\uf0b7 Map \u2192 UGrid  command  \n\uf0b7 Horizons \u2192 UGrid  command  \n\uf0b7 The Map \u2192 UGrid command can create the following types of UGrids:  \n\uf0b7 Regular (not refined)  \n\uf0b7 Quadtree/Octree  \n\uf0b7 Voronoi  \n\uf0b7 The Horizons \u2192 UGrid  command  can create complex UGrids with layers that \npinch out.  \n \n", "filename": "UGridCreation.pdf", "pages": 21}}